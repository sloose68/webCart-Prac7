const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/ElevationLayer-DjIherZI.js","assets/MultiOriginJSONSupport-CaqF7aws.js","assets/ArcGISCachedService-BJx4XpTR.js","assets/TileInfoTilemapCache-DXVK9qk5.js","assets/TilemapCache-CeuMqqpk.js","assets/ByteSizeUnit-BsxeN7wM.js","assets/ArcGISService-DbN9TSbx.js","assets/OperationalLayer-5tD0PN5k.js","assets/PortalLayer-Co6vzNlT.js","assets/portalItemUtils-Beiwx9a8.js","assets/WorkerHandle-C5MfsF3n.js","assets/layersCreator-DrsNzVZE.js","assets/loadUtils-DvZw9yUl.js","assets/fetchService-CAOwhvE6.js","assets/associatedFeatureServiceUtils-Bd78Y8jm.js","assets/lazyLayerLoader-_QoOXKUU.js","assets/portalLayers-DdegSe-f.js","assets/styleUtils-B2yhE7cZ.js","assets/geometryEngineBase-B9CjWDWD.js","assets/_commonjsHelpers-DCkdB7M8.js","assets/arcgisLayers-0p4GGeHk.js","assets/statsWorker-D0zPvu16.js","assets/utils-BkedrghW.js","assets/utils-DQMqVVDu.js","assets/ClassBreaksDefinition-DcDHCOFy.js","assets/geometryEngineWorker-BeElq9cK.js","assets/geometryEngineJSON-CO8CMyeT.js","assets/json-Wa8cmqdu.js","assets/CSVSourceWorker-8-piIXC2.js","assets/date-DCujAECq.js","assets/OptimizedFeature-BRiTb9Ij.js","assets/executeQueryForSnapping-_P6-YVAn.js","assets/queryUtils-CVnyp2w-.js","assets/QueryEngine-DBNq3l3w.js","assets/featureConversionUtils-Diaz3NGZ.js","assets/OptimizedFeatureSet-BR8EEvDc.js","assets/WhereClauseCache-JX1YmA3Q.js","assets/WhereClause-DSBnK-_w.js","assets/timeSupport-DTr9m4br.js","assets/QueryEngineCapabilities-CsRUnGk7.js","assets/SnappingCandidate-DGkpYqI6.js","assets/FixedIntervalBinParameters-eTXa4F-h.js","assets/NormalizationBinParametersMixin-CZeWOf7T.js","assets/FeatureStore-30Vabs3m.js","assets/BoundsStore-B3YDkzmW.js","assets/PooledRBush-BonQw8wO.js","assets/optimizedFeatureQueryEngineAdapter-BFgu31KA.js","assets/number-B6aGMq4-.js","assets/clientSideDefaults-DcL2w1kI.js","assets/EdgeProcessingWorker-CUuH6ZnC.js","assets/workerHelper-CXEo0K-X.js","assets/InterleavedLayout-CnwoTp3j.js","assets/BufferView-CcUKtSfw.js","assets/types-BKo2foNY.js","assets/edgeProcessing-B8gC_k6e.js","assets/deduplicate-CTCyxVSx.js","assets/Indices-HRVG5CyY.js","assets/VertexAttribute-BfkzOMLV.js","assets/glUtil-QdRpcC_G.js","assets/VertexElementDescriptor-BLyltQyJ.js","assets/Normals-Q5fXSRos.js","assets/ElevationSamplerWorker-BFfRePqi.js","assets/MeshLocalVertexSpace-CEr-dP-c.js","assets/vertexSpaceConversion-DiE2D3QX.js","assets/mat3f64-B5o_lm6j.js","assets/mat4f64-q_b6UJoq.js","assets/spatialReferenceEllipsoidUtils-Dv4Tpcw5.js","assets/computeTranslationToOriginAndRotation-Co29MLiI.js","assets/projectPointToVector-D1jxkH3Q.js","assets/meshVertexSpaceUtils-Y_LAx3tH.js","assets/vec3-CMvs1Nu9.js","assets/vec4-wHUUxhSp.js","assets/FeatureServiceSnappingSourceWorker-BCe-FKt2.js","assets/symbologySnappingCandidates-gvc8DiUn.js","assets/pbfQueryUtils-Di7dfwDw.js","assets/pbf-D5IDxXWF.js","assets/query-DkqYP_IY.js","assets/queryZScale-oYjTlJxk.js","assets/GeoJSONSourceWorker-DKTY3tLv.js","assets/geojson-p7Ntcpr1.js","assets/sourceUtils-B5qK5NDw.js","assets/MemorySourceWorker-CwEyEK5e.js","assets/objectIdUtils-BmFjqQA3.js","assets/PBFDecoderWorker-HbdwxNZo.js","assets/dehydratedFeatures-C8ZQMJCs.js","assets/FeaturePipelineWorker-DrXtjM2D.js","assets/AttributeStore-B7-77xlN.js","assets/Utils-eM5oEcgf.js","assets/UpdateTracking2D-DciXD9FG.js","assets/labelUtils-xrhI_YuC.js","assets/constants-BFLErLYb.js","assets/streamLayerUtils-CKwt2uXH.js","assets/MeshWriterRegistry-BySnZUqb.js","assets/TechniqueType-pk2C5RYg.js","assets/PieChartMeshWriter-CTqwQA-s.js","assets/libtess-DZJt4hCu.js","assets/earcut-D9gy186-.js","assets/QueueProcessor-x30S7ems.js","assets/operatorGeodeticDensify-9ORK2LVZ.js","assets/SimpleGeometryCursor-B92kdZ15.js","assets/geodeticCurveType-CirnHLSB.js","assets/normalizeUtilsSync-DkRhRiTv.js","assets/ogcFeatureUtils-Nep42uFb.js","assets/bundle-B2FM5W1M.js","assets/CircularArray-CujHzHWW.js","assets/createConnection-CsDaJnlb.js","assets/PointCloudWorker-Du4Hk8KH.js","assets/quat-DZtsjC15.js","assets/quatf64-aQ5IuZRd.js","assets/vec3f32-WCVSSNPR.js","assets/PointCloudUniqueValueRenderer-DzigWkHW.js","assets/I3SBinaryReader-CRpicmbA.js","assets/orientedBoundingBox-C19z4-Aj.js","assets/plane-4pZ0EGHW.js","assets/vectorStacks-DnnGOwOV.js","assets/RasterWorker-BP2Loyx8.js","assets/GeographicTransformation-bCweQDAg.js","assets/dataUtils-BLhJKhjn.js","assets/RasterSymbolizer-CeGRfO-f.js","assets/rasterFunctionHelper-CLtPLSA0.js","assets/clipUtils-CDns8WV7.js","assets/rasterProjectionHelper-DX15GqzE.js","assets/PolynomialTransform-CVVot2qw.js","assets/SceneLayerSnappingSourceWorker-B7_qAxj8.js","assets/lineSegment-glaAlEKC.js","assets/sphere-C5msylEj.js","assets/Octree-CpleZMi8.js","assets/SceneLayerWorker-ClqCDr7P.js","assets/projectVectorToVector-DJylFcY0.js","assets/I3SUtil-gawREEdF.js","assets/edgeUtils-BCflaP0E.js","assets/NormalAttribute.glsl-Bjarj0Tp.js","assets/glsl-Cj7KC756.js","assets/ShaderOutput-Bdd80V3g.js","assets/BindType-BBwFZqyN.js","assets/WFSSourceWorker-Ck50zAD4.js","assets/wfsUtils-BmGkUjmt.js","assets/xmlUtils-CtUoQO7q.js","assets/WorkerTileHandler-DbNWTtU6.js","assets/constants-BwsikM5h.js","assets/config-DHajyIwB.js","assets/StyleDefinition-CUS6XBgd.js","assets/SourceLayerData-DZWUk9fQ.js","assets/StyleRepository-DLkmyKzW.js","assets/Feature3DPipelineWorker-SzJAsaXC.js","assets/dehydratedFeatureUtils-D9metH24.js","assets/hydratedFeatures-C9twbdVf.js","assets/OutputColorHighlightOID.glsl-DzI-_NNG.js","assets/videoUtils-Dett8AJJ.js","assets/requestImageUtils-CjrqjyK5.js","assets/basicInterfaces-N86vRvDz.js","assets/TextureFormat-1mYWTFa-.js","assets/triangle-CGWVLARv.js","assets/renderState-6KIuIW1A.js","assets/boundedPlane-DmISpkDK.js","assets/HUDMaterial.glsl-DuCG35vT.js","assets/ShaderBuilder-G_dO87DI.js","assets/HUDMaterial-DCxXadka.js","assets/primitiveObjectSymbolUtils-DOBg7AvG.js","assets/IntersectorType-gQim6TH1.js","assets/RealisticTree.glsl-DzhRMLzx.js","assets/TextureCompressionWorker-Bwoo-IJl.js","assets/Popup-CprH1y5X.js","assets/unitFormatUtils-uo1i3JEW.js","assets/quantityUtils-BjdDOnxI.js","assets/AttachmentInfo-DfFhe1PF.js","assets/labelingInfo-B_JAFYyH.js","assets/featureUtils-C-psBCUu.js","assets/executeQueryJSON-BJJWnKxh.js","assets/FeatureSet-CvltAc3o.js","assets/shared-Dxut9WPQ.js","assets/FeatureLayer-DjZqn0wq.js","assets/FeatureLayerBase-D7S6EtMz.js","assets/LayerFloorInfo-BSHESHAo.js","assets/Relationship-iA25-Pmk.js","assets/serviceCapabilitiesUtils-D_NhzN5b.js","assets/infoFor3D-VMSlSy0z.js","assets/editsZScale-BhYyCbey.js","assets/APIKeyMixin-DFbvM0Dh.js","assets/CustomParametersMixin-CDyaxzvT.js","assets/DisplayFilteredLayer-Cd7LnLff.js","assets/EditBusLayer-MohR6XxG.js","assets/FeatureEffectLayer-DjBRyLL-.js","assets/FeatureEffect-C66kJK_4.js","assets/FeatureFilter-Dx124Zfc.js","assets/FeatureReductionLayer-COG0e47l.js","assets/FeatureReductionSelection-Cp5znuNN.js","assets/OrderedLayer-DvxY4FBb.js","assets/OrderByInfo-CppKUrvh.js","assets/RefreshableLayer-BE14VVV_.js","assets/TemporalLayer-GeYjtTDS.js","assets/TimeInfo-EYJ4o0ml.js","assets/TrackableLayer-BTmqbdvX.js","assets/FeatureTemplate-C8k7_l7R.js","assets/FeatureType-Da-ejSqi.js","assets/fieldProperties-B2QnLU7a.js","assets/TitleCreator-46ef3Imb.js","assets/versionUtils-oVtrlNPT.js","assets/popupUtils-CF_QFtrk.js","assets/interfaces-CL2NbQte.js","assets/NetworkElement-BOqjJ56T.js","assets/ReactiveSet-D2M8AMYg.js","assets/layerViewUtils-7LirAzEv.js","assets/arcadeUtils-DEoDPJY0.js","assets/arcade-DiC6tzAj.js","assets/aiServices-Bsv_p2bQ.js","assets/ImmutableArray-BPVd6ESQ.js","assets/commonProperties-DHiB1uzW.js","assets/unitConversion-BQFS3cO3.js","assets/batchExec-BzNFx7le.js","assets/geometryServiceUtils-DQplkJw6.js","assets/project-kB3CjzUQ.js","assets/webglDeps-Bz7Uqddf.js","assets/ProgramTemplate-DuKm7wPA.js","assets/FramebufferObject-CCZMtxkY.js","assets/NestedMap-wm1q4thl.js","assets/mapViewDeps-B_xX9WE2.js","assets/FeatureCommandQueue-B_cZeoI_.js","assets/GraphShaderModule-BGbPHaS4.js","assets/utils-Cemv36zb.js","assets/WGLContainer-FqqlXR4w.js","assets/Container-BmB3kfi0.js","assets/SDFHelper-Cn-K75tR.js","assets/GridShader-C8rpiUCO.js","assets/testSVGPremultipliedAlpha-BXR99M2G.js","assets/SymbolFader-DedStNUG.js","assets/RenderingContext-BUHhTDlO.js","assets/utils-BVXFON6l.js","assets/utils-ehcGqGxa.js","assets/projectOperator-uF-ETVCt.js","assets/GraphicsView2D-B2pVjBVs.js","assets/GraphicContainer-CiYDJl8Q.js","assets/AGraphicContainer-BRIwWsks.js","assets/TechniqueInstance-DVVC-uuD.js","assets/TileContainer-BekcfWbi.js","assets/gridUtils-OmPPIWrJ.js","assets/TileLayerView2D-C-kci5w2.js","assets/imageUtils-CGcmm1mt.js","assets/BitmapTechnique-DLEgHlyR.js","assets/bitmapUtils-Byed3pw1.js","assets/LayerView-C4qWnKoZ.js","assets/HighlightGraphicContainer-Bmb0qDxn.js","assets/RefreshableLayerView-CFBVFi7F.js","assets/MapServiceLayerViewHelper-Byxsu-AG.js","assets/drapedUtils-BEU06rAe.js","assets/popupUtils-Cs5aD5rv.js","assets/FeatureLayerView2D-cjK-Z-3C.js","assets/timeSupport-DfKIafrl.js","assets/AttributeBinsFeatureSet-WtwH5Wdu.js","assets/AttributeBinsQuery-DRBQwKi8.js","assets/constants-B4mRqufT.js","assets/BaseDynamicLayerView2D-BF_43uTD.js","assets/BitmapContainer-BhNqhiIH.js","assets/ExportStrategy-Bl6Q0nnu.js","assets/CatalogLayerView2D-DTxLk79_.js","assets/CatalogDynamicGroupLayerView2D-DH6aaUE6.js","assets/CatalogFootprintLayerView2D-BQG8smXR.js","assets/GeoRSSLayerView2D-DWHDHUxa.js","assets/GraphicsLayerView2D-CS_Yscos.js","assets/GroupLayerView2D-CSg4nMws.js","assets/ImageryLayerView2D-Cbud-YL0.js","assets/RasterVFDisplayObject-BjtBjsEm.js","assets/ImageryTileLayerView2D-zliRcVi7.js","assets/rasterFieldUtils-BP61mQt9.js","assets/rasterUtils-CUJF4Js_.js","assets/RawBlockCache-DjleAUqH.js","assets/KMLLayerView2D-BM7GLA-j.js","assets/kmlUtils-Cppek3uu.js","assets/KnowledgeGraphLayerView2D-k_LS9W1Y.js","assets/MapImageLayerView2D-DKv4Epf6.js","assets/MapNotesLayerView2D-DRm0CyYv.js","assets/MediaLayerView2D-Lr5NzpzR.js","assets/mediaLayerUtils-Ceh0z8Ck.js","assets/OverlayContainer-5BfoC_cK.js","assets/OGCFeatureLayerView2D-BVqzpcdU.js","assets/RouteLayerView2D-C9QbjRb3.js","assets/Stop-DXPhW_JF.js","assets/networkEnums-DVvTnGgZ.js","assets/StreamLayerView2D-DKALRf3R.js","assets/SubtypeGroupLayerView2D-DA3FsmqP.js","assets/VectorTileLayerView2D-DcFs8aVd.js","assets/VideoLayerView2D-DwXs45kP.js","assets/GraphicsLayer-C2RpHQKq.js","assets/videoUtils-Dkkpk1vW.js","assets/WMSLayerView2D-tcxmkIMR.js","assets/ExportWMSImageParameters-X4oi21xP.js","assets/WMTSLayerView2D-qc8fsRcq.js","assets/apng--pyDaOiO.js","assets/index-vZZaxJvd.js","assets/index-BsvImqiG.js","assets/guid-Bu7NDcrC.js","assets/useT9n-CuLCta1k.js","assets/index-DRsyYTwk.js","assets/dom-CzgIHNTQ.js","assets/observers-ioWenU3R.js","assets/ref-C93BNDt1.js","assets/static-B-utjZQz.js","assets/form-B9wsPJOC.js","assets/interactive-uAEbCcZu.js","assets/label-CcwdI0Mw.js","assets/component-BRUzbOuX.js","assets/index-BkkOStNF.js","assets/index-YwxjFJi2.js","assets/customElement-CF80jTdZ.js","assets/array-CaayCXLe.js","assets/index-CDKqFdmP.js"])))=>i.map(i=>d[i]);
var uq=Object.getPrototypeOf;var cq=Reflect.get;var bI=e=>{throw TypeError(e)};var Gw=(e,t,i)=>t.has(e)||bI("Cannot "+i);var et=(e,t,i)=>(Gw(e,t,"read from private field"),i?i.call(e):t.get(e)),Js=(e,t,i)=>t.has(e)?bI("Cannot add the same private member more than once"):t instanceof WeakSet?t.add(e):t.set(e,i),Xs=(e,t,i,r)=>(Gw(e,t,"write to private field"),r?r.call(e,i):t.set(e,i),i),Tf=(e,t,i)=>(Gw(e,t,"access private method"),i);var wI=(e,t,i)=>cq(uq(e),i,t);(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const s of document.querySelectorAll('link[rel="modulepreload"]'))r(s);new MutationObserver(s=>{for(const n of s)if(n.type==="childList")for(const o of n.addedNodes)o.tagName==="LINK"&&o.rel==="modulepreload"&&r(o)}).observe(document,{childList:!0,subtree:!0});function i(s){const n={};return s.integrity&&(n.integrity=s.integrity),s.referrerPolicy&&(n.referrerPolicy=s.referrerPolicy),s.crossOrigin==="use-credentials"?n.credentials="include":s.crossOrigin==="anonymous"?n.credentials="omit":n.credentials="same-origin",n}function r(s){if(s.ep)return;s.ep=!0;const n=i(s);fetch(s.href,n)}})();function h(e,t,i,r){var s,n=arguments.length,o=n<3?t:r===null?r=Object.getOwnPropertyDescriptor(t,i):r;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")o=Reflect.decorate(e,t,i,r);else for(var a=e.length-1;a>=0;a--)(s=e[a])&&(o=(n<3?s(o):n>3?s(t,i,o):s(t,i))||o);return n>3&&o&&Object.defineProperty(t,i,o),o}function M$e(e,t){return function(i,r){t(i,r,e)}}function T$e(e,t,i,r){function s(n){return n instanceof i?n:new i((function(o){o(n)}))}return new(i||(i=Promise))((function(n,o){function a(c){try{u(r.next(c))}catch(d){o(d)}}function l(c){try{u(r.throw(c))}catch(d){o(d)}}function u(c){c.done?n(c.value):s(c.value).then(a,l)}u((r=r.apply(e,[])).next())}))}function E$e(e,t,i){if(t!=null){if(typeof t!="object"&&typeof t!="function")throw new TypeError("Object expected.");var r,s;if(r===void 0){if(!Symbol.dispose)throw new TypeError("Symbol.dispose is not defined.");r=t[Symbol.dispose]}if(typeof r!="function")throw new TypeError("Object not disposable.");s&&(r=function(){try{s.call(this)}catch(n){return Promise.reject(n)}}),e.stack.push({value:t,dispose:r,async:i})}return t}var hq=typeof SuppressedError=="function"?SuppressedError:function(e,t,i){var r=new Error(i);return r.name="SuppressedError",r.error=e,r.suppressed=t,r};function C$e(e){function t(n){e.error=e.hasError?new hq(n,e.error,"An error was suppressed during disposal."):n,e.hasError=!0}var i,r=0;function s(){for(;i=e.stack.pop();)try{if(!i.async&&r===1)return r=0,e.stack.push(i),Promise.resolve().then(s);if(i.dispose){var n=i.dispose.call(i.value);if(i.async)return r|=2,Promise.resolve(n).then(s,(function(o){return t(o),s()}))}else r|=1}catch(o){t(o)}if(r===1)return e.hasError?Promise.reject(e.error):Promise.resolve();if(e.hasError)throw e.error}return s()}const dq="modulepreload",pq=function(e){return"/webCart-Prac7/"+e},SI={},J=function(t,i,r){let s=Promise.resolve();if(i&&i.length>0){let l=function(u){return Promise.all(u.map(c=>Promise.resolve(c).then(d=>({status:"fulfilled",value:d}),d=>({status:"rejected",reason:d}))))};document.getElementsByTagName("link");const o=document.querySelector("meta[property=csp-nonce]"),a=o?.nonce||o?.getAttribute("nonce");s=l(i.map(u=>{if(u=pq(u),u in SI)return;SI[u]=!0;const c=u.endsWith(".css"),d=c?'[rel="stylesheet"]':"";if(document.querySelector(`link[href="${u}"]${d}`))return;const m=document.createElement("link");if(m.rel=c?"stylesheet":dq,c||(m.as="script"),m.crossOrigin="",m.href=u,a&&m.setAttribute("nonce",a),document.head.appendChild(m),c)return new Promise((y,g)=>{m.addEventListener("load",y),m.addEventListener("error",()=>g(new Error(`Unable to preload CSS for ${u}`)))})}))}function n(o){const a=new Event("vite:preloadError",{cancelable:!0});if(a.payload=o,window.dispatchEvent(a),!a.defaultPrevented)throw o}return s.then(o=>{for(const a of o||[])a.status==="rejected"&&n(a.reason);return t().catch(n)})};let Jl;function N(e){return typeof Jl[e]=="function"?Jl[e]=Jl[e](globalThis):Jl[e]}Jl=globalThis.dojoConfig?.has||globalThis.esriConfig?.has?{...globalThis.dojoConfig?.has,...globalThis.esriConfig?.has}:{},N.add=(e,t,i,r)=>{(r||Jl[e]===void 0)&&(Jl[e]=t),i&&N(e)},N.cache=Jl,N.add("big-integer-warning-enabled",!0),N.add("esri-deprecation-warnings",!0),N.add("esri-tests-disable-screenshots",!1),N.add("esri-tests-use-full-window",!1),N.add("esri-tests-post-to-influx",!0),N.add("esri-cim-animations-enable-status","enabled"),N.add("esri-cim-animations-spotlight",!1),N.add("esri-cim-animations-freeze-time",!1),(()=>{N.add("host-webworker",globalThis.WorkerGlobalScope!==void 0&&self instanceof globalThis.WorkerGlobalScope);const e=typeof window<"u"&&typeof location<"u"&&typeof document<"u"&&window.location===location&&window.document===document;if(N.add("host-browser",e),N.add("host-node",typeof globalThis.process=="object"&&globalThis.process.versions?.node&&globalThis.process.versions.v8),N.add("dom",e),N("host-browser")){const t=navigator,i=t.userAgent,r=t.appVersion,s=parseFloat(r);if(N.add("wp",parseFloat(i.split("Windows Phone")[1])||void 0),N.add("msapp",parseFloat(i.split("MSAppHost/")[1])||void 0),N.add("khtml",r.includes("Konqueror")?s:void 0),N.add("edge",parseFloat(i.split("Edge/")[1])||void 0),N.add("opr",parseFloat(i.split("OPR/")[1])||void 0),N.add("webkit",!N("wp")&&!N("edge")&&parseFloat(i.split("WebKit/")[1])||void 0),N.add("chrome",!N("edge")&&!N("opr")&&parseFloat(i.split("Chrome/")[1])||void 0),N.add("android",!N("wp")&&parseFloat(i.split("Android ")[1])||void 0),N.add("safari",!r.includes("Safari")||N("wp")||N("chrome")||N("android")||N("edge")||N("opr")?void 0:parseFloat(r.split("Version/")[1])),N.add("mac",r.includes("Macintosh")),!N("wp")&&/(iPhone|iPod|iPad)/.test(i)){const n=RegExp.$1.replace(/P/,"p"),o=/OS ([\d_]+)/.test(i)?RegExp.$1:"1",a=parseFloat(o.replace(/_/,".").replaceAll("_",""));N.add(n,a),N.add("ios",a)}N("webkit")||(!i.includes("Gecko")||N("wp")||N("khtml")||N("edge")||N.add("mozilla",s),N("mozilla")&&N.add("ff",parseFloat(i.split("Firefox/")[1]||i.split("Minefield/")[1])||void 0))}})(),(()=>{if(globalThis.navigator){const e=navigator.userAgent,t=/Android|webOS|iPhone|iPad|iPod|BlackBerry|Opera Mini|IEMobile/i.test(e),i=/iPhone/i.test(e);t&&N.add("esri-mobile",t),i&&N.add("esri-iPhone",i),N.add("esri-geolocation",!!navigator.geolocation)}N.add("esri-wasm","WebAssembly"in globalThis),N.add("esri-performance-mode-frames-between-render",20),N.add("esri-force-performance-mode",!1),N.add("esri-shared-array-buffer",(()=>{const e="SharedArrayBuffer"in globalThis,t=globalThis.crossOriginIsolated===!1;return e&&!t})),N.add("wasm-simd",(()=>{const e=[0,97,115,109,1,0,0,0,1,5,1,96,0,1,123,3,2,1,0,10,10,1,8,0,65,0,253,15,253,98,11];return WebAssembly.validate(new Uint8Array(e))})),N.add("esri-atomics","Atomics"in globalThis),N.add("esri-workers","Worker"in globalThis),N.add("web-feat:cache","caches"in globalThis),N.add("esri-workers-arraybuffer-transfer",!N("safari")||Number(N("safari"))>=12),N.add("workers-pool-size",8),N.add("featurelayer-simplify-thresholds",[.5,.5,.5,.5]),N.add("featurelayer-simplify-payload-size-factors",[1,1,4]),N.add("featurelayer-fast-triangulation-enabled",!0),N.add("featurelayer-animation-enabled",!0),N.add("featurelayer-snapshot-enabled",!0),N.add("featurelayer-snapshot-initial-tolerance",0),N.add("featurelayer-snapshot-point-min-threshold",8e4),N.add("featurelayer-snapshot-point-max-threshold",4e5),N.add("featurelayer-snapshot-multipoint-min-threshold",2e4),N.add("featurelayer-snapshot-multipoint-max-threshold",1e5),N.add("featurelayer-snapshot-polygon-min-threshold",1e3),N.add("featurelayer-snapshot-polygon-max-threshold",2e3),N.add("featurelayer-snapshot-polyline-min-threshold",1e3),N.add("featurelayer-snapshot-polyline-max-threshold",2e3),N.add("featurelayer-snapshot-max-vertex-count",25e4),N.add("featurelayer-snapshot-non-hosted-exceedslimit-enabled",!1),N.add("featurelayer-snapshot-concurrency",4),N.add("featurelayer-snapshot-coverage",.1),N.add("featurelayer-query-max-depth",4),N.add("featurelayer-query-pausing-enabled",!1),N.add("featurelayer-query-tile-concurrency",4),N.add("featurelayer-query-tile-max-features",6e5),N.add("featurelayer-advanced-symbols",!1),N.add("featurelayer-pbf",!0),N.add("featurelayer-pbf-statistics",!1),N.add("feature-layers-workers",!0),N.add("feature-polyline-generalization-factor",1),N.add("mapview-transitions-duration",200),N.add("mapview-essential-goto-duration",200),N.add("mapview-srswitch-adjust-rotation-scale-threshold",24e6),N.add("mapserver-pbf-version-support",10.81),N.add("mapservice-popup-identify-max-tolerance",20),N.add("request-queue-concurrency-hosted",16),N.add("request-queue-concurrency-non-hosted",4),N.add("curve-densification-coarse-segments",128),N.add("curve-densification-max-segments",2e3),N.add("curve-densification-min-segments",3),N.add("curve-densification-pixel-deviation",.5),N.add("view-readyState-waiting-delay",1e3),N.add("gradient-depth-bias",.01),N.add("gradient-depth-epsilon",1e-8),N.add("enable-feature:esri-compress-textures",!0),N("host-webworker")||N("host-browser")&&(N.add("esri-csp-restrictions",(()=>{try{new Function}catch{return!0}return!1})),N.add("esri-image-decode",(()=>{if("decode"in new Image){const e=new Image;return e.src='data:image/svg+xml;charset=UTF-8,<svg version="1.1" xmlns="http://www.w3.org/2000/svg"></svg>',void e.decode().then((()=>{N.add("esri-image-decode",!0,!0,!0)})).catch((()=>{N.add("esri-image-decode",!1,!0,!0)}))}return!1})),N.add("esri-url-encodes-apostrophe",(()=>{const e=window.document.createElement("a");return e.href="?'",e.href.includes("?%27")})))})();function P$e(e){}function fq(e){return()=>e}function I$e(e){return e}var Fr;let pE=(Fr=class{constructor(t=1){this._seed=t}set seed(t){this._seed=t??Math.random()*Fr._m}getInt(){return this._seed=(Fr._a*this._seed+Fr._c)%Fr._m,this._seed}getFloat(){return this.getInt()/(Fr._m-1)}getIntRange(t,i){return Math.round(this.getFloatRange(t,i))}getFloatRange(t,i){const r=i-t;return t+this.getInt()/Fr._m*r}},Fr._m=2147483647,Fr._a=48271,Fr._c=0,Fr);const mq=1.5,A$e=1/mq,L$e=.5;function k$e(e,t){return t?e.filter(((i,r,s)=>s.findIndex(t.bind(null,i))===r)):Array.from(new Set(e))}function yq(e,t,i,r,s,n,o){if(e==null&&r==null)return!0;t=Math.max(0,t),s=Math.max(0,s),i=Math.max(0,i<0?(e?.length??0)+i:i),n=Math.max(0,n<0?(r?.length??0)+n:n);const a=i-t;if(e==null||r==null||a!==n-s)return!1;if(o){for(let l=0;l<a;l++)if(!o(e[t+l],r[s+l]))return!1}else for(let l=0;l<a;l++)if(e[t+l]!==r[s+l])return!1;return!0}function Cb(e,t,i){return yq(e,0,e?.length??0,t,0,t?.length??0,i)}function xI(e,t,i){let r,s;return i?(r=t.filter((n=>!e.some((o=>i(o,n))))),s=e.filter((n=>!t.some((o=>i(o,n)))))):(r=t.filter((n=>!e.includes(n))),s=e.filter((n=>!t.includes(n)))),{added:r,removed:s}}function R$e(e){return e&&typeof e.length=="number"}let LN=class{constructor(){this.last=0}};const kN=new LN;function CS(e,t,i,r){r=r||kN;const s=Math.max(0,r.last-10);for(let o=s;o<i;++o)if(e[o]===t)return r.last=o,o;const n=Math.min(s,i);for(let o=0;o<n;++o)if(e[o]===t)return r.last=o,o;return-1}function gq(e,t,i,r){const s=e.length,n=CS(e,t,s,r);if(n!==-1)return e[n]=e[s-1],e.pop(),t}const Ks=new Set;function _q(e,t,i=e.length,r=t.length,s,n){if(r===0||i===0)return i;Ks.clear();for(let a=0;a<r;++a)Ks.add(t[a]);s=s||kN;const o=Math.max(0,s.last-10);for(let a=o;a<i;++a)if(Ks.has(e[a])&&(n?.push(e[a]),Ks.delete(e[a]),e[a]=e[i-1],--i,--a,Ks.size===0||i===0))return Ks.clear(),i;for(let a=0;a<o;++a)if(Ks.has(e[a])&&(n?.push(e[a]),Ks.delete(e[a]),e[a]=e[i-1],--i,--a,Ks.size===0||i===0))return Ks.clear(),i;return Ks.clear(),i}function N$e(e,t,i){const r=e.length;if(t>=r)return e.slice();const s=fE(i),n=new Set,o=[];for(;o.length<t;){const a=Math.floor(s()*r);n.has(a)||(n.add(a),o.push(e[a]))}return o}function fE(e){return e?($I.seed=e,()=>$I.getFloat()):Math.random}const $I=new pE;function RN(e,t){if(!e)return e;const i=fE(t);for(let r=e.length-1;r>0;r--){const s=Math.floor(i()*(r+1)),n=e[r];e[r]=e[s],e[s]=n}return e}function mE(e,t){const i=e.indexOf(t);return i!==-1?(e.splice(i,1),t):null}function rr(e,t){return e!=null}const D$e=[];function F$e(e){return e instanceof ArrayBuffer}function yE(e){return e?.constructor?.name==="Int8Array"}function ON(e){return e?.constructor?.name==="Uint8Array"}function NN(e){return e?.constructor?.name==="Uint8ClampedArray"}function gE(e){return e?.constructor?.name==="Int16Array"}function DN(e){return e?.constructor?.name==="Uint16Array"}function _E(e){return e?.constructor?.name==="Int32Array"}function FN(e){return e?.constructor?.name==="Uint32Array"}function vq(e){return e?.constructor?.name==="Float16Array"}function Pb(e){return e?.constructor?.name==="Float32Array"}function Ib(e){return e?.constructor?.name==="Float64Array"}function zN(e){return"buffer"in e}const VN=1024;function z$e(e){return Ib(e)||Pb(e)||_E(e)||gE(e)||yE(e)}function V$e(e){return Ib(e)||Pb(e)}function U$e(e){return Ib(e)?179769e303:vq(e)?65504:Pb(e)?3402823e32:FN(e)?4294967295:DN(e)?65535:ON(e)||NN(e)?255:_E(e)?2147483647:gE(e)?32767:yE(e)?127:256}const j$e=-32768,G$e=-2147483648;function bq(e,t){let i;for(i in e)e.hasOwnProperty(i)&&e[i]===void 0&&delete e[i];return e}function V(e){if(!e||typeof e!="object"||typeof e=="function")return e;const t=GN(e);if(t!=null)return t;if(z1(e))return e.clone();if(UN(e))return e.map(V);if(jN(e))throw new Error("Trying to clone an unclonable Accessor instance");const i={};for(const r of Object.getOwnPropertyNames(e))i[r]=V(e[r]);return i}function PS(e){if(!e||typeof e!="object"||typeof e=="function"||"HTMLElement"in globalThis&&e instanceof HTMLElement)return e;const t=GN(e);if(t!=null)return t;if(UN(e)){let r=!0;const s=e.map((n=>{const o=PS(n);return n!=null&&o==null&&(r=!1),o}));return r?s:null}if(z1(e))return e.clone();if(e instanceof File||e instanceof Blob)return e;if(jN(e))return null;const i=new(Object.getPrototypeOf(e)).constructor;for(const r of Object.getOwnPropertyNames(e)){const s=e[r],n=PS(s);if(s!=null&&n==null)return null;i[r]=n}return i}function z1(e){return typeof e.clone=="function"}function UN(e){return typeof e.map=="function"&&typeof e.forEach=="function"}function jN(e){return typeof e.notifyChange=="function"&&typeof e.watch=="function"}function MI(e){if(Object.prototype.toString.call(e)!=="[object Object]")return!1;const t=Object.getPrototypeOf(e);return t===null||t===Object.prototype}function GN(e){if(yE(e)||ON(e)||NN(e)||gE(e)||DN(e)||_E(e)||FN(e)||Pb(e)||Ib(e))return e.slice();if(e instanceof Date)return new Date(e.getTime());if(e instanceof ArrayBuffer)return e.slice(0,e.byteLength);if(e instanceof Map){const t=new Map;for(const[i,r]of e)t.set(i,V(r));return t}if(e instanceof Set){const t=new Set;for(const i of e)t.add(V(i));return t}return null}function vE(e,t){return e===t||typeof e=="number"&&isNaN(e)&&typeof t=="number"&&isNaN(t)||typeof e?.getTime=="function"&&typeof t?.getTime=="function"&&e.getTime()===t.getTime()||!1}function BN(e,t){return e===t||(e==null||typeof e=="string"?e===t:typeof e=="number"?e===t||typeof t=="number"&&isNaN(e)&&isNaN(t):e instanceof Date?t instanceof Date&&e.getTime()===t.getTime():Array.isArray(e)?Array.isArray(t)&&Cb(e,t):e instanceof Set?t instanceof Set&&Sq(e,t):e instanceof Map?t instanceof Map&&xq(e,t):!!MI(e)&&MI(t)&&wq(e,t))}function wq(e,t){if(e===null||t===null)return!1;const i=Object.keys(e);if(t===null||Object.keys(t).length!==i.length)return!1;for(const r of i)if(e[r]!==t[r]||!Object.prototype.hasOwnProperty.call(t,r))return!1;return!0}function Sq(e,t){if(e.size!==t.size)return!1;for(const i of e)if(!t.has(i))return!1;return!0}function xq(e,t){if(e.size!==t.size)return!1;for(const[i,r]of e){const s=t.get(i);if(s!==r||s===void 0&&!t.has(i))return!1}return!0}function bE(e,t,i=!1){return HN(e,t,i)}function xg(e,t){if(t!=null)return t[e]||qN(e.split("."),!1,t)}function wu(e,t,i){const r=e.split("."),s=r.pop(),n=qN(r,!0,i);n&&s&&(n[s]=t)}function TI(e,t){if(e==null&&t==null)return!1;if(e==null||t==null)return!0;if(typeof e=="object"){if(Array.isArray(e)){const i=t;if(e.length!==i.length)return!0;for(let r=0;r<e.length;r++)if(TI(e[r],i[r]))return!0;return!1}if(Object.keys(e).length!==Object.keys(t).length)return!0;for(const i in e)if(TI(e[i],t[i]))return!0;return!1}return e!==t}function qN(e,t,i){let r=i;for(const s of e){if(r==null)return;if(!(s in r)){if(!t)return;r[s]={}}r=r[s]}return r}function HN(e,t,i){return t?Object.keys(t).reduce(((r,s)=>{if(s==="__proto__")return r;let n=r[s],o=t[s];return n===o?r:n===void 0?(r[s]=V(o),r):(Array.isArray(o)||Array.isArray(r)?(n=n?Array.isArray(n)?r[s]=n.slice():r[s]=[n]:r[s]=[],o&&(Array.isArray(o)||(o=[o]),i?o.forEach((a=>{n.includes(a)||n.push(a)})):r[s]=o.slice())):o&&typeof o=="object"?r[s]=HN(n,o,i):r.hasOwnProperty(s)&&!t.hasOwnProperty(s)||(r[s]=o),r)}),e||{}):e}const Fe={apiKey:void 0,apiKeys:{scopes:[]},applicationName:"",applicationUrl:globalThis.location?.href,assetsPath:"",fontsUrl:"https://static.arcgis.com/fonts",geometryServiceUrl:"https://utility.arcgisonline.com/arcgis/rest/services/Geometry/GeometryServer",geoRSSServiceUrl:"https://utility.arcgis.com/sharing/rss",kmlServiceUrl:"https://utility.arcgis.com/sharing/kml",userPrivilegesApplied:!0,portalUrl:"https://www.arcgis.com",respectPrefersReducedMotion:!0,routeServiceUrl:"https://route-api.arcgis.com/arcgis/rest/services/World/Route/NAServer/Route_World",workers:{loaderConfig:{has:{},paths:{},map:{},packages:[]}},request:{crossOriginNoCorsDomains:null,httpsDomains:["arcgis.com","arcgisonline.com","esrikr.com","premiumservices.blackbridge.com","esripremium.accuweather.com","gbm.digitalglobe.com","firstlook.digitalglobe.com","msi.digitalglobe.com"],interceptors:[],internalInterceptors:[],maxUrlLength:2e3,priority:"high",proxyRules:[],proxyUrl:null,timeout:62e3,trustedServers:[],useIdentity:!0},log:{interceptors:[],level:null}};if(globalThis.esriConfig&&(bE(Fe,globalThis.esriConfig,!0),delete Fe.has),!Fe.assetsPath){{const e="4.33";Fe.assetsPath=`https://js.arcgis.com/${e}/@arcgis/core/assets`}Fe.defaultAssetsPath=Fe.assetsPath}const $q=/\{([^}]+)\}/g;function EI(e){return e??""}function mh(e,t){return t?e.replaceAll($q,typeof t=="object"?(i,r)=>EI(xg(r,t)):(i,r)=>EI(t(r))):e}function B$e(e,t){return e.replaceAll(/([.$?*|{}()[\]\\/+\-^])/g,(i=>t?.includes(i)?i:`\\${i}`))}function WN(e){let t=0;for(let i=0;i<e.length;i++)t=(t<<5)-t+e.charCodeAt(i),t|=0;return t}let CI;function Mq(e){return CI??=new DOMParser,CI.parseFromString(e||"","text/html").body.innerText||""}function q$e(e,t){return new RegExp(`{${t}}`,"ig").test(e)}function H$e(e,...t){let i=e[0];for(let r=0;r<t.length;++r)i+=t[r]+e[r+1];return i}const PI={info:0,warn:1,error:2,none:3};var si;let H=(si=class{constructor(t){this.level=null,this._module="",this._parent=null,this.writer=null,this._loggedMessages={error:new Map,warn:new Map,info:new Map},t.level!=null&&(this.level=t.level),t.writer!=null&&(this.writer=t.writer),this._module=t.module,si._loggers.set(this.module,this);const i=this.module.lastIndexOf(".");i!==-1&&(this._parent=si.getLogger(this.module.slice(0,i)))}get module(){return this._module}get parent(){return this._parent}error(...t){this._log("error","always",...t)}warn(...t){this._log("warn","always",...t)}info(...t){this._log("info","always",...t)}errorOnce(...t){this._log("error","once",...t)}warnOnce(...t){this._log("warn","once",...t)}infoOnce(...t){this._log("info","once",...t)}errorOncePerTick(...t){this._log("error","oncePerTick",...t)}warnOncePerTick(...t){this._log("warn","oncePerTick",...t)}infoOncePerTick(...t){this._log("info","oncePerTick",...t)}get test(){}static get test(){}static getLogger(t){return t=typeof t!="string"?t.declaredClass:t,si._loggers.get(t)||new si({module:t})}_log(t,i,...r){if(this._matchLevel(t)){if(i!=="always"&&!si._throttlingDisabled){const s=Eq(r),n=this._loggedMessages[t].get(s);if(i==="once"&&n!=null||i==="oncePerTick"&&n&&n>=si._tickCounter)return;this._loggedMessages[t].set(s,si._tickCounter),si._scheduleTickCounterIncrement()}for(const s of Fe.log.interceptors)if(s(t,this.module,...r))return;this._inheritedWriter()(t,this.module,...r)}}_parentWithMember(t,i){let r=this;for(;r!=null;){const s=r[t];if(s!=null)return s;r=r.parent}return i}_inheritedWriter(){return this._parentWithMember("writer",Tq)}_matchLevel(t){const i=Fe.log.level||"warn";return PI[this._parentWithMember("level",i)]<=PI[t]}static _scheduleTickCounterIncrement(){si._tickCounterScheduled||(si._tickCounterScheduled=!0,Promise.resolve().then((()=>{si._tickCounter++,si._tickCounterScheduled=!1})))}},si._loggers=new Map,si._tickCounter=0,si._tickCounterScheduled=!1,si._throttlingDisabled=!1,si);function Tq(e,t,...i){console[e](`[${t}]`,...i)}function Eq(...e){return WN(JSON.stringify(e,(i,r)=>typeof r!="object"||Array.isArray(r)?r:"[Object]"))}function Cq(e,t){return e.replaceAll(/\$\{([^\s:}]*)(?::([^\s:}]+))?\}/g,((i,r)=>r===""?"$":(xg(r,t)??"").toString()))}let ZN=class{constructor(t,i,r=void 0){this.name=t,this.details=r,this.message=(i&&Cq(i,r))??""}toString(){return"["+this.name+"]: "+this.message}},j=class YN extends ZN{constructor(t,i,r){super(t,i,r)}toJSON(){if(this.details!=null)try{return{name:this.name,message:this.message,details:JSON.parse(JSON.stringify(this.details,((t,i)=>{if(i&&typeof i=="object"&&typeof i.toJSON=="function")return i;try{return V(i)}catch{return"[object]"}})))}}catch(t){throw H.getLogger("esri.core.Error").error(t),t}return{name:this.name,message:this.message,details:this.details}}static fromJSON(t){return new YN(t.name,t.message,t.details)}};j.prototype.type="error";function zy(e){return e&&typeof e=="object"&&"toJSON"in e&&typeof e.toJSON=="function"}const Pq=/^https:\/\/([a-z\d-]+)(\.maps([^.]*))?\.arcgis\.com/i,Iq={devext:{customBaseUrl:"mapsdevext.arcgis.com",portalHostname:"devext.arcgis.com"},qaext:{customBaseUrl:"mapsqa.arcgis.com",portalHostname:"qaext.arcgis.com"},www:{customBaseUrl:"maps.arcgis.com",portalHostname:"www.arcgis.com"}};function II(e){const t=e?.match(Pq);if(!t)return null;const[,i,r,s]=t;if(!i)return null;let n=null,o=null,a=null;const{devext:l,qaext:u,www:c}=Iq;if(r)if(n=i,s)switch(s.toLowerCase()){case"devext":({customBaseUrl:o,portalHostname:a}=l);break;case"qa":({customBaseUrl:o,portalHostname:a}=u);break;default:return null}else({customBaseUrl:o,portalHostname:a}=c);else switch(i.toLowerCase()){case"devext":({customBaseUrl:o,portalHostname:a}=l);break;case"qaext":({customBaseUrl:o,portalHostname:a}=u);break;case"www":({customBaseUrl:o,portalHostname:a}=c);break;default:return null}return{customBaseUrl:o,isPortal:!1,portalHostname:a,urlKey:n}}function JN(e){return/\/(sharing|usrsvcs)\/(appservices|servers)\//i.test(e)}function XN(e){const t=/^https?:\/\/(?:cdn|[a-z\d-]+\.maps)\.arcgis\.com/i,i=/^https?:\/\/(?:cdndev|[a-z\d-]+\.mapsdevext)\.arcgis\.com/i,r=/^https?:\/\/(?:cdnqa|[a-z\d-]+\.mapsqa)\.arcgis\.com/i;return t.test(e)?e=e.replace(t,"https://www.arcgis.com"):i.test(e)?e=e.replace(i,"https://devext.arcgis.com"):r.test(e)&&(e=e.replace(r,"https://qaext.arcgis.com")),e}function KN(e){const t=atob(e),i=new Uint8Array(t.length);for(let r=0;r<t.length;r++)i[r]=t.charCodeAt(r);return i.buffer}function Aq(e){const t=new Uint8Array(e);let i="";for(let r=0;r<t.length;r++)i+=String.fromCharCode(t[r]);return btoa(i)}const Lq=()=>H.getLogger("esri.core.urlUtils"),nf=Fe.request,AI="esri/config: esriConfig.request.proxyUrl is not set.",QN=/^\s*[a-z][a-z0-9-+.]*:(?![0-9])/i,eD=/^\s*http:/i,kq=/^\s*https:/i,Rq=/^\s*file:/i,tD=/:\d+$/,Oq=/^https?:\/\/[^/]+\.arcgis.com\/sharing(\/|$)/i,Nq=new RegExp("^(([^:/?#]+):)?(//([^/?#]*))?([^?#]*)(\\?([^#]*))?(#(.*))?$"),Dq=new RegExp("^((([^[:]+):)?([^@]+)@)?(\\[([^\\]]+)\\]|([^[:]*))(:([0-9]+))?$");let Wd=class{constructor(t=""){this.uri=t,this.scheme=null,this.authority=null,this.path=null,this.query=null,this.fragment=null,this.user=null,this.password=null,this.host=null,this.port=null;let i=this.uri.match(Nq);this.scheme=i[2]||(i[1]?"":null),this.authority=i[4]||(i[3]?"":null),this.path=i[5],this.query=i[7]||(i[6]?"":null),this.fragment=i[9]||(i[8]?"":null),this.authority!=null&&(i=this.authority.match(Dq),this.user=i[3]||null,this.password=i[4]||null,this.host=i[6]||i[7],this.port=i[9]||null)}toString(){return this.uri}};const h0={},Fq=new Wd(Fe.applicationUrl);let sr=Fq;const zq=Vq();let wE=zq;const SE=()=>sr,Y$e=()=>wE;function Vq(){const e=sr.path,t=e.slice(0,e.lastIndexOf("/")+1);return`${`${sr.scheme}://${sr.host}${sr.port!=null?`:${sr.port}`:""}`}${t}`}function Li(e){if(!e)return null;const t={path:null,query:null},i=new Wd(e),r=e.indexOf("?");return i.query===null?t.path=e:(t.path=e.slice(0,r),t.query=xE(i.query)),i.fragment&&(t.hash=i.fragment,i.query===null&&(t.path=t.path.slice(0,t.path.length-(i.fragment.length+1)))),t}function xE(e){const t=e.split("&"),i={};for(const r of t){if(!r)continue;const s=r.indexOf("=");let n,o;s<0?(n=decodeURIComponent(r),o=""):(n=decodeURIComponent(r.slice(0,s)),o=decodeURIComponent(r.slice(s+1)));let a=i[n];typeof a=="string"&&(a=i[n]=[a]),Array.isArray(a)?a.push(o):i[n]=o}return i}function Vy(e,t){return e?Object.keys(e).map((i=>{const r=e[i];if(r==null)return"";const s=encodeURIComponent(i)+"=",n=t?.[i];return n?s+encodeURIComponent(n(r)):Array.isArray(r)?r.map((o=>zy(o)?s+encodeURIComponent(JSON.stringify(o)):s+encodeURIComponent(o))).join("&"):zy(r)?s+encodeURIComponent(JSON.stringify(r)):s+encodeURIComponent(r)})).filter((i=>i)).join("&"):""}function iD(e=!1){let t,i=nf.proxyUrl;if(typeof e=="string"){t=Wq(e);const r=Ab(e);r&&(i=r.proxyUrl)}else t=!!e;if(!i)throw Lq().warn(AI),new j("urlUtils:proxy-not-set",AI);return t&&AS()&&(i=CE(i)),Li(i)}function J$e(e,t=!1){const i=Ab(e);let r,s;if(i){const n=$E(i.proxyUrl);r=n.path,s=n.query?xE(n.query):null}else if(t){const n=iD(e);r=n.path,s=n.query}if(r){const n=Li(e);e=r+"?"+n.path;const o=Vy({...s,...n.query});o&&(e=`${e}?${o}`)}return e}const Ef={path:"",query:""};function $E(e){const t=e.indexOf("?");return t!==-1?(Ef.path=e.slice(0,t),Ef.query=e.slice(t+1)):(Ef.path=e,Ef.query=null),Ef}function rD(e){return e=(e=U1(e=Kq(e=$E(e).path),!0)).toLowerCase()}function Uq(e){const t={proxyUrl:e.proxyUrl,urlPrefix:rD(e.urlPrefix)},i=nf.proxyRules,r=t.urlPrefix;let s=i.length;for(let n=0;n<i.length;n++){const o=i[n].urlPrefix;if(r.indexOf(o)===0){if(r.length===o.length)return-1;s=n;break}o.indexOf(r)===0&&(s=n+1)}return i.splice(s,0,t),s}function Ab(e){const t=nf.proxyRules,i=rD(e);for(let r=0;r<t.length;r++)if(i.indexOf(t[r].urlPrefix)===0)return t[r]}function X$e(e,t){if(!e||!t)return!1;e=V1(e),t=V1(t);const i=II(e),r=II(t);return i!=null&&r!=null?i.portalHostname===r.portalHostname:i==null&&r==null&&ih(e,t,!0)}function jq(e,t){return e=V1(e),t=V1(t),U1(e)===U1(t)}function V1(e){const t=(e=No(e)).indexOf("/sharing");return t>0?e.slice(0,t):e.replace(/\/+$/,"")}function IS(e,t=nf.interceptors){const i=r=>r instanceof RegExp?r.test(e):typeof r=="string"?e.startsWith(r):r==null;if(t){for(const r of t)if(Array.isArray(r.urls)){if(r.urls.some(i))return r}else if(i(r.urls))return r}return null}function ih(e,t,i=!1){if(!e||!t)return!1;const r=kS(e),s=kS(t);return!(!i&&r.scheme!==s.scheme)&&r.host!=null&&s.host!=null&&r.host.toLowerCase()===s.host.toLowerCase()&&r.port===s.port}function ME(e){if(typeof e=="string"){if(!qr(e))return!0;e=kS(e)}if(ih(e,sr))return!0;const t=nf.trustedServers||[];for(let i=0;i<t.length;i++){const r=Gq(t[i]);for(let s=0;s<r.length;s++)if(ih(e,r[s]))return!0}return!1}function Gq(e){return h0[e]||(EE(e)||Vo(e)?h0[e]=[new Wd(ks(e))]:h0[e]=[new Wd(`http://${e}`),new Wd(`https://${e}`)]),h0[e]}function ks(e,t=wE,i){return Vo(e)?i?.preserveProtocolRelative?e:sr.scheme==="http"&&sr.authority===ds(e).slice(2)?`http:${e}`:`https:${e}`:EE(e)?e:$g(e[0]==="/"?Xq(t):t,e)}function TE(e,t=wE,i){if(e==null||!qr(e))return e;const r=No(e),s=r.toLowerCase(),n=No(t).toLowerCase().replace(/\/+$/,""),o=i?No(i).toLowerCase().replace(/\/+$/,""):null;if(o&&n.indexOf(o)!==0)return e;const a=(d,m,y)=>(y=d.indexOf(m,y))===-1?d.length:y;let l=a(s,"/",s.indexOf("//")+2),u=-1;for(;s.slice(0,l+1)===n.slice(0,l)+"/"&&(u=l+1,l!==s.length);)l=a(s,"/",l+1);if(u===-1||o&&u<o.length)return e;e=r.slice(u);const c=n.slice(u-1).replaceAll(/[^/]+/g,"").length;if(c>0)for(let d=0;d<c;d++)e=`../${e}`;else e=`./${e}`;return e}function No(e){return e=tH(e=eH(e=Qq(e=ks(e=e.trim()))))}function $g(...e){const t=e.filter(rr);if(!t?.length)return;const i=[];if(qr(t[0])){const s=t[0],n=s.indexOf("//");n!==-1&&(i.push(s.slice(0,n+1)),Yq(t[0])&&(i[0]+="/"),t[0]=s.slice(n+2))}else t[0][0]==="/"&&i.push("");const r=t.reduce(((s,n)=>n?s.concat(n.split("/")):s),[]);for(let s=0;s<r.length;s++){const n=r[s];n===".."&&i.length>0&&i[i.length-1]!==".."?i.pop():(!n&&s===r.length-1||n&&(n!=="."||i.length===0))&&i.push(n)}return i.join("/")}function ds(e,t=!1){if(e==null||Mg(e)||yh(e))return null;let i=e.indexOf("://");if(i===-1&&Vo(e))i=2;else{if(i===-1)return null;i+=3}const r=e.indexOf("/",i);return r!==-1&&(e=e.slice(0,r)),t&&(e=U1(e,!0)),e}function qr(e){return Vo(e)||EE(e)}function Mg(e){return e!=null&&e.slice(0,5)==="blob:"}function yh(e){return e!=null&&e.slice(0,5)==="data:"}function Bq(e){const t=Ap(e);return t?.isBase64?KN(t.data):null}function K$e(e){return Aq(e).replaceAll("+","-").replaceAll("/","_").replace(/=+$/,"")}const qq=/^data:(.*?)(;base64)?,(.*)$/;function Ap(e){const t=e.match(qq);if(!t)return null;const[,i,r,s]=t;return{mediaType:i,isBase64:!!r,data:s}}function sD(e){return e.isBase64?`data:${e.mediaType};base64,${e.data}`:`data:${e.mediaType},${e.data}`}async function Hq(e){return(await fetch(e)).blob()}function Q$e(e){const t=Bq(e);if(!t)return null;const i=Ap(e);return new Blob([t],{type:i.mediaType})}function Vo(e){return e!=null&&e[0]==="/"&&e[1]==="/"}function EE(e){return e!=null&&QN.test(e)}function Wq(e){return e!=null&&kq.test(e)||sr.scheme==="https"&&Vo(e)}function Zq(e){return e!=null&&eD.test(e)||sr.scheme==="http"&&Vo(e)}function Yq(e){return e!=null&&Rq.test(e)}function CE(e){return Vo(e)?`https:${e}`:e.replace(eD,"https:")}function Jq(){return sr.scheme==="http"}function AS(){return sr.scheme==="https"}function U1(e,t=!1){return Vo(e)?e.slice(2):(e=e.replace(QN,""),t&&e.length>1&&e[0]==="/"&&e[1]==="/"&&(e=e.slice(2)),e)}function Xq(e){const t=e.indexOf("//"),i=e.indexOf("/",t+2);return i===-1?e:e.slice(0,i)}function PE(e){let t=0;if(qr(e)){const r=e.indexOf("//");r!==-1&&(t=r+2)}const i=e.lastIndexOf("/");return i<t?e:e.slice(0,i+1)}function eMe(e,t){if(!e)return"";const i=Li(e).path.replace(/\/+$/,""),r=i.slice(i.lastIndexOf("/")+1);if(!t?.length)return r;const s=new RegExp(`\\.(${t.join("|")})$`,"i");return r.replace(s,"")}function Kq(e){return e.endsWith("/")?e:`${e}/`}function nD(e){return e.replace(/\/+$/,"")}function Qq(e){if(/^https?:\/\//i.test(e)){const t=$E(e);e=(e=t.path.replaceAll(/\/{2,}/g,"/")).replace("/","//"),t.query&&(e+=`?${t.query}`)}return e}function eH(e){return e.replace(/^(https?:\/\/)(arcgis\.com)/i,"$1www.$2")}function tH(e){const t=nf.httpsDomains;if(!Zq(e))return e;const i=e.indexOf("/",7);let r;if(r=i===-1?e:e.slice(0,i),r=r.toLowerCase().slice(7),tD.test(r)){if(!r.endsWith(":80"))return e;r=r.slice(0,-3),e=e.replace(":80","")}return Jq()&&r===sr.authority&&!Oq.test(e)||(AS()&&r===sr.authority||t&&t.some((s=>r===s||r.endsWith(`.${s}`)))||AS()&&!Ab(e))&&(e=CE(e)),e}function LS(e,t,i){if(!(t&&i&&e&&qr(e)))return e;const r=e.indexOf("//"),s=e.indexOf("/",r+2),n=e.indexOf(":",r+2),o=Math.min(s<0?e.length:s,n<0?e.length:n);return e.slice(r+2,o).toLowerCase()!==t.toLowerCase()?e:`${e.slice(0,r+2)}${i}${e.slice(o)}`}function iH(e,t){const i=new URL(e);return i.host=t,i.port&&!tD.test(t)&&(i.port=""),i.toString()}function tMe(e){return new URL(e).host}function kS(e){return typeof e=="string"?new Wd(ks(e)):(e.scheme||(e.scheme=sr.scheme),e)}function iMe(e){return sH.test(e)}function oD(e,t){const i=Li(e),r=Object.keys(i.query||{});return r.length>0&&t&&t.warn("removeQueryParameters()",`Url query parameters are not supported, the following parameters have been removed: ${r.join(", ")}.`),i.path}function rH(e,t,i){const r=Li(e),s=r.query||{};return s[t]=String(i),`${r.path}?${Vy(s)}`}function w_(e,t){if(!t)return e;const i=Li(e),r=i.query||{};for(const[n,o]of Object.entries(t))o!=null&&(r[n]=o);const s=Vy(r);return s?`${i.path}?${s}`:i.path}function aD(e){if(e==null)return null;const t=e.match(lD);return t?t[2]:null}function LI(e){if(e==null)return null;const t=e.match(lD);return t?{path:t[1],extension:t[2]}:{path:e,extension:null}}async function rMe(e){return typeof e=="string"?Ap(e)??{data:e}:new Promise(((t,i)=>{const r=new FileReader;r.readAsDataURL(e),r.onload=()=>t(Ap(r.result)),r.onerror=s=>i(s)}))}const lD=/([^.]*)\.([^/]*)$/,sH=/(^data:image\/svg|\.svg$)/i,uD="20250903",cD="39b1ef512004eb2837696c72250a1294d18a21b1";Symbol.dispose??=Symbol("Symbol.dispose"),Symbol.asyncDispose??=Symbol("Symbol.asyncDispose");const nH="4.33";let ot,IE=nH;IE="4.33.13";function sMe(e){ot=e}function oH(e){const t=ot?.findCredential(e);return t?.token?rH(e,"token",t.token):e}N("host-webworker")||globalThis.$arcgis||Object.defineProperty(globalThis,"$arcgis",{configurable:!1,enumerable:!0,writable:!1,value:{}}),N("host-webworker");function aH(e,t){for(const i of e.values())if(t(i))return!0;return!1}function nMe(e,t){for(const i of e.values())if(t(i))return i;return null}function of(e,t,i){const r=e.get(t);if(r!==void 0)return r;const s=i();return e.set(t,s),s}function oMe(e){const t=new Map;return i=>(t.has(i)||t.set(i,e(i)),t.get(i))}const lH={remove:()=>{}};function ze(e){return e?{remove(){e&&(e(),e=void 0)}}:lH}function hD(e){e.forEach((t=>t?.remove()))}function aMe(e){hD(e),e.length=0}function gh(e){return ze((()=>hD(e)))}function lMe(e){return ze((()=>e()?.remove()))}function uMe(e){return ze((()=>e?.abort()))}function cMe(e){return ze(e!=null?()=>e.destroy():void 0)}function uH(e){return typeof e=="object"&&!!e&&"remove"in e&&typeof e.remove=="function"}function hMe(e){uH(e)&&e.remove()}function dMe(e){return{[Symbol.dispose](){e.remove()}}}function cH(e){return{setTimeout:(t,i)=>{const r=e.setTimeout(t,i);return ze((()=>e.clearTimeout(r)))}}}const af=cH(globalThis);function Lb(e){return hH(e)||dD(e)}function hH(e){return e!=null&&typeof e=="object"&&"on"in e&&typeof e.on=="function"}function dD(e){return e!=null&&typeof e=="object"&&"addEventListener"in e&&typeof e.addEventListener=="function"}function lf(e,t,i){if(!Lb(e))throw new TypeError("target is not a Evented or EventTarget object");return dD(e)?dH(e,t,i):e.on(t,i)}function dH(e,t,i,r){if(Array.isArray(t)){const s=t.slice();for(const n of s)e.addEventListener(n,i,r);return ze((()=>{for(const n of s)e.removeEventListener(n,i,r)}))}return e.addEventListener(t,i,r),ze((()=>e.removeEventListener(t,i,r)))}function pD(e,t,i){if(!Lb(e))throw new TypeError("target is not a Evented or EventTarget object");if("once"in e)return e.once(t,i);const r=lf(e,t,(s=>{r.remove(),i.call(e,s)}));return r}function Tg(e,t){if(e==null)throw new Error(t??"value is None")}function Ot(e){return e?.destroy(),null}function pMe(e){return e?.dispose(),null}function St(e){return e?.remove(),null}function Lp(e){return e?.abort(),null}function fMe(e){return e?.release(),null}function pH(e,t,i){return e!=null&&t!=null?i!=null?i(e,t):e.equals(t):e===t}function fD(e,t){let i;return e.some(((r,s)=>(i=t(r,s),i!=null))),i??void 0}function yt(e="Aborted"){return new j("AbortError",e)}function It(e,t="Aborted"){if(js(e))throw yt(t)}function Eg(e){return e instanceof AbortSignal?e:e?.signal??void 0}function js(e){const t=Eg(e);return t!=null&&t.aborted}function AE(e){if(Er(e))throw e}function kI(e){if(!Er(e))throw e}function kn(e,t){const i=Eg(e);if(i!=null){if(!i.aborted)return pD(i,"abort",(()=>t()));t()}}function LE(e,t){const i=Eg(e);if(i!=null)return It(i),pD(i,"abort",(()=>t(yt())))}function fH(e,t){return Eg(t)==null?e:new Promise(((i,r)=>{let s=kn(t,(()=>r(yt())));const n=()=>{s=St(s)};e.then(n,n),e.then(i,r)}))}function Er(e){return e?.name==="AbortError"}async function RI(e){try{return await e}catch(t){if(!Er(t))throw t;return}}async function kE(e){if(!e)return;if(typeof e.forEach!="function"){const i=Object.keys(e),r=i.map((o=>e[o])),s=await kE(r),n={};return i.map(((o,a)=>n[o]=s[a])),n}const t=e;return Promise.allSettled(t).then((i=>Array.from(t,((r,s)=>{const n=i[s];return n.status==="fulfilled"?{promise:r,value:n.value}:{promise:r,error:n.reason}}))))}async function mH(e){return(await Promise.allSettled(e)).filter((t=>t.status==="fulfilled")).map((t=>t.value))}async function mMe(e){return(await Promise.allSettled(e)).filter((t=>t.status==="rejected")).map((t=>t.reason))}function mD(e,t=void 0,i){const r=new AbortController;return kn(i,(()=>r.abort())),new Promise(((s,n)=>{let o=setTimeout((()=>{o=0,s(t)}),e);kn(r,(()=>{o&&(clearTimeout(o),n(yt()))}))}))}function yMe(e,t,i,r){const s=i&&"abort"in i?i:null;r!=null||s||(r=i);let n=setTimeout((()=>{n=0,s?.abort()}),t);const o=()=>r||new j("promiseUtils:timeout","The wrapped promise did not resolve within "+t+" ms");return e.then((a=>{if(n===0)throw o();return clearTimeout(n),a}),(a=>{throw clearTimeout(n),n===0?o():a}))}function yH(e,t){const i=new AbortController,r=setTimeout((()=>i.abort()),t);return kn(e,(()=>{i.abort(),clearTimeout(r)})),{...e,signal:i.signal}}function Bo(e){return e&&typeof e.then=="function"}function RS(e){return Bo(e)?e:Promise.resolve(e)}function yD(e,t=-1){let i,r,s,n,o=null;const a=(...l)=>{if(i){r=l,n&&n.reject(yt()),n=Gs();const m=n.promise;if(o){const y=o;o=null,y.abort()}return m}if(s=n||Gs(),n=null,t>0){const m=new AbortController;i=RS(e(...l,m.signal));const y=i;mD(t).then((()=>{i===y&&(n?m.abort():o=m)}))}else i=1,i=RS(e(...l));const u=()=>{const m=r;r=s=i=o=null,m!=null&&a(...m)},c=i,d=s;return c.then(u,u),c.then(d.resolve,d.reject),d.promise};return a}function Gs(){let e,t;const i=new Promise(((s,n)=>{e=s,t=n})),r=s=>{e(s)};return r.resolve=s=>e(s),r.reject=s=>t(s),r.timeout=(s,n)=>af.setTimeout((()=>r.reject(n)),s),r.promise=i,r}function gMe(e,t){t.then(e.resolve,e.reject)}async function OI(e){await Promise.resolve(),It(e)}function Ga(e,t){const i=t?.url?.path;if(e&&i&&(e=ks(e,i,{preserveProtocolRelative:!0}),t.portalItem&&t.readResourcePaths)){const r=TE(e,t.portalItem.itemUrl);r!=null&&gH.test(r)&&t.readResourcePaths.push(t.portalItem.resourceFromPath(r).path)}return(e=OS(e,t?.portal))&&Rb.test(e)?RE(e):e}function rh(e,t,i=Rp.YES){if((e=e&&Rb.test(e)?bD(e):e)==null)return e;!qr(e)&&t?.blockedRelativeUrls&&t.blockedRelativeUrls.push(e);let r=ks(e);if(t){const s=t.verifyItemRelativeUrls?.rootPath||t.url?.path;if(s){const n=OS(s,t.portal),o=OS(r,t.portal);r=TE(o,n,n),r!=null&&r!==o&&r!==e&&t.verifyItemRelativeUrls&&t.verifyItemRelativeUrls.writtenUrls.push(r)}}return r=vD(r,t?.portal),qr(r)&&(r=No(r)),t?.resources&&t?.portalItem&&!qr(r)&&!yh(r)&&i===Rp.YES&&t.resources.toKeep.push({resource:t.portalItem.resourceFromPath(r),compress:!1}),r}function kb(e,t,i){return Ga(e,i)}function kp(e,t,i,r){const s=rh(e,r);s!==void 0&&(t[i]=s)}const Rb=/\/items\/([^/]+)\/resources\/(.*)/,gH=/^\.\/resources\//;function gD(e){return(e?.match(Rb)??null)?.[1]??null}function _D(e){const t=e?.match(Rb)??null;if(t==null)return null;const i=t[2],r=i.lastIndexOf("/");if(r===-1){const{path:o,extension:a}=LI(i);return{prefix:null,filename:o,extension:a}}const{path:s,extension:n}=LI(i.slice(r+1));return{prefix:i.slice(0,r),filename:s,extension:n}}function vD(e,t){return t&&!t.isPortal&&t.urlKey&&t.customBaseUrl?LS(e,`${t.urlKey}.${t.customBaseUrl}`,t.portalHostname):e}function OS(e,t){if(!t||t.isPortal||!t.urlKey||!t.customBaseUrl)return e;const i=`${t.urlKey}.${t.customBaseUrl}`,r=SE();return ih(r,`${r.scheme}://${i}`)?LS(e,t.portalHostname,i):LS(e,i,t.portalHostname)}function RE(e){if(!e)return e||null;let t=e;return t&&ot&&!ot.findCredential(t)&&(t=XN(t),t=t.replace(/^https?:\/\/www\.arcgis\.com/,"https://cdn.arcgis.com"),t=t.replace(/^https?:\/\/devext\.arcgis\.com/,"https://cdndev.arcgis.com"),t=t.replace(/^https?:\/\/qaext\.arcgis\.com/,"https://cdnqa.arcgis.com")),t}function bD(e){if(!e)return e||null;let t=e;return t=t.replace(/^https?:\/\/cdn\.arcgis\.com/,"https://www.arcgis.com"),t=t.replace(/^https?:\/\/cdndev\.arcgis\.com/,"https://devext.arcgis.com"),t=t.replace(/^https?:\/\/cdnqa\.arcgis\.com/,"https://qaext.arcgis.com"),t&&ot&&!ot.findCredential(t)&&(t=XN(t)),t}var Rp;(function(e){e[e.YES=0]="YES",e[e.NO=1]="NO"})(Rp||(Rp={}));const _H=Object.freeze(Object.defineProperty({__proto__:null,get MarkKeep(){return Rp},ensureMainOnlineDomain:vD,fromCDNUrl:bD,fromJSON:Ga,itemIdFromResourceUrl:gD,prefixAndFilenameFromResourceUrl:_D,read:kb,toCDNUrl:RE,toJSON:rh,write:kp},Symbol.toStringTag,{value:"Module"})),wD={mapserver:"MapServer",imageserver:"ImageServer",featureserver:"FeatureServer",knowledgegraphserver:"KnowledgeGraphServer",sceneserver:"SceneServer",streamserver:"StreamServer",vectortileserver:"VectorTileServer","3dtilesserver":"3DTilesServer",videoserver:"VideoServer"},SD=Object.values(wD),xD=new RegExp(`^((?:https?:)?\\/\\/\\S+?\\/rest\\/services\\/(.+?)\\/(${SD.join("|")}))(?:\\/(?:layers\\/)?(\\d+))?`,"i"),vH=new RegExp(`^((?:https?:)?\\/\\/\\S+?\\/([^/\\n]+)\\/(${SD.join("|")}))(?:\\/(?:layers\\/)?(\\d+))?`,"i"),bH=/(.*?)\/(?:layers\/)?(\d+)\/?$/i;function _Me(e){return xD.test(e)}function Cg(e){if(e==null)return null;const t=Li(e),i=t?.path.match(xD)||t?.path.match(vH);if(!i)return null;const[,r,s,n,o]=i,a=s.indexOf("/");return{title:$D(a!==-1?s.slice(a+1):s),serverType:wD[n.toLowerCase()],sublayer:o!=null&&o!==""?parseInt(o,10):null,url:{path:r}}}function wH(e){const t=Li(e).path.match(bH);return t?{serviceUrl:t[1],sublayerId:Number(t[2])}:null}function $D(e){return(e=e.replaceAll(/\s*[/_]+\s*/g," "))[0].toUpperCase()+e.slice(1)}function vMe(e,t){const i=[];if(e){const r=Cg(e);r!=null&&r.title&&i.push(r.title)}if(t){const r=$D(t);i.push(r)}if(i.length===2){if(i[0].toLowerCase().includes(i[1].toLowerCase()))return i[0];if(i[1].toLowerCase().includes(i[0].toLowerCase()))return i[1]}return i.join(" - ")}function NI(e){let t=ds(e,!0);return!!t&&(t=t.toLowerCase(),t.endsWith(".arcgis.com")&&(t.startsWith("services")||t.startsWith("tiles")||t.startsWith("features")||/^[a-z\d-]+\.svcs[a-z\d-]*\./.test(t)))}function bMe(e,t){return e&&nD(oD(e,t))}function wMe(e){let{url:t}=e;if(!t)return{url:t};t=oD(t,e.logger);const i=Li(t),r=Cg(i.path);let s;if(r!=null)r.sublayer!=null&&e.layer.layerId==null&&(s=r.sublayer),t=r.url.path;else if(e.nonStandardUrlAllowed){const n=wH(i.path);n!=null&&(t=n.serviceUrl,s=n.sublayerId)}return{url:nD(t),layerId:s}}function SMe(e,t,i,r,s){kp(t,r,"url",s),r.url&&e.layerId!=null&&(r.url=$g(r.url,i,e.layerId.toString()))}function xMe(e){if(!e)return!1;const t=e.toLowerCase(),i=t.includes("/services/"),r=t.includes("/mapserver/wmsserver"),s=t.includes("/imageserver/wmsserver"),n=t.includes("/wmsserver");return i&&(r||s||n)}const SH=new Set(["elevation3d.arcgis.com","js.arcgis.com","jsdev.arcgis.com","jsqa.arcgis.com","static.arcgis.com"]);function OE(e){if(!NE(e))return null;const t=r=>r instanceof RegExp?r.test(e):typeof r=="string"&&e.startsWith(r),i=Fe.apiKeys;if(Array.isArray(i.scopes)){for(const r of i.scopes)if(Array.isArray(r.urls)){if(r.urls.some(t))return r.token}else if(t(r.urls))return r.token}return i.basemapStyles&&/^https?:\/\/(i?basemaps|basemapstyles)-api\.arcgis\.com\//i.test(e)?i.basemapStyles:Fe.apiKey&&/^https?:\/\/.+\.arcgis\.com(\/|$)/i.test(e)?Fe.apiKey:null}function NS(){return Fe.apiKey!=null||Fe.apiKeys.basemapStyles!=null}function xH(e,t){return t?NE(e):OE(e)!=null}function NE(e){const t=ds(e,!0);return!!t&&!SH.has(t)&&!e.endsWith("/sharing/rest/generateToken")}function $H(e,t,i=!1,r){return new Promise(((s,n)=>{if(js(r))return void n(DI());let o=()=>{u(),n(new Error(`Unable to load ${t}`))},a=()=>{const c=e;u(),s(c)},l=()=>{if(!e)return;const c=e;u(),c.src="",n(DI())};const u=()=>{N("esri-image-decode")||(e.removeEventListener("error",o),e.removeEventListener("load",a)),o=null,a=null,e=null,r?.removeEventListener("abort",l),l=null,i&&URL.revokeObjectURL(t)};r?.addEventListener("abort",l),N("esri-image-decode")?e.decode().then(a,o):(e.addEventListener("error",o),e.addEventListener("load",a))}))}function DI(){try{return new DOMException("Aborted","AbortError")}catch{const e=new Error;return e.name="AbortError",e}}const MD="Timeout exceeded";function MH(){return new Error(MD)}function $Me(e){return typeof e=="object"&&!!e&&"message"in e&&e.message===MD}function TH(e){Fe.request.crossOriginNoCorsDomains||(Fe.request.crossOriginNoCorsDomains={});const t=Fe.request.crossOriginNoCorsDomains;for(let i of e)i=i.toLowerCase(),/^https?:\/\//.test(i)?t[ds(i)??""]=0:(t[ds("http://"+i)??""]=0,t[ds("https://"+i)??""]=0)}function EH(e){const t=Fe.request.crossOriginNoCorsDomains;if(t){let i=ds(e);if(i)return i=i.toLowerCase(),!ih(i,SE())&&t[i]<Date.now()-36e5}return!1}async function CH(e){const t=Li(e);e=t.path,t.query?.f==="json"&&(e+="?f=json");try{await fetch(e,{mode:"no-cors",credentials:"include"})}catch{}const i=Fe.request.crossOriginNoCorsDomains,r=ds(e);i&&r&&(i[r.toLowerCase()]=Date.now())}const DS=new Map;function PH(e,t){const i=t?.preferredHost;if(!i||ih(e,`https://${i}`,!0))return;const r=Cg(e);if(!r||r.serverType!=="FeatureServer"||JN(e))return;const s=r.url.path.toLowerCase();DS.has(s)||DS.set(s,i)}function FI(e){const t=Cg(e)?.url.path.toLowerCase();if(!t)return e;const i=DS.get(t);return i?iH(e,i):e}async function at(e,t){e instanceof URL&&(e=e.toString()),t?.query instanceof URLSearchParams&&(t.query=xE(t.query.toString().replaceAll("+"," ")));const i=yh(e),r=Mg(e);r||i||(e=No(e));const s={url:e,requestOptions:{...t}},n=y=>({data:y,getAllHeaders:Op,getHeader:Op,httpStatus:200,requestOptions:s.requestOptions,url:s.url}),o=IS(e,Is.internalInterceptors);if(o){const y=await VI(o,s);if(y!=null)return n(y)}let a=IS(e);if(a){const y=await VI(a,s);if(y!=null)return n(y);a.after||a.error||(a=null)}if(e=s.url,(t=s.requestOptions).responseType==="image"&&(N("host-webworker")||N("host-node")))throw Pn("request:invalid-parameters",new Error("responseType 'image' is not supported in Web Workers or Node environment"),s);if(t.method==="head"){if(t.body)throw Pn("request:invalid-parameters",new Error("body parameter cannot be set when method is 'head'"),s);if(i||r)throw Pn("request:invalid-parameters",new Error("data and blob URLs are not supported for method 'head'"),s)}if(await RH(),j1)return j1.execute(e,t);const l=new AbortController,u=kn(t,(()=>l.abort())),c={controller:l,credential:void 0,credentialToken:void 0,fetchOptions:void 0,hasToken:!1,interceptor:a,params:s,redoRequest:!1,useIdentity:Is.useIdentity,useProxy:!1,useSSL:!1,withCredentials:!1},d=t.useRequestQueue?zH(c):zS(c),m=await d.finally((()=>u?.remove()));return a?.after?.(m),m}let j1,TD=!1;const Is=Fe.request,ED="FormData"in globalThis,IH=new Set([499,498,403,401]),AH=new Set(["COM_0056","COM_0057","SB_0008"]),LH=[/\/arcgis\/tokens/i,/\/sharing(\/rest)?\/generatetoken/i,/\/rest\/info/i],Op=()=>null,G1=Symbol();function kH(e){const t=ds(e);t&&!at._corsServers.includes(t)&&at._corsServers.push(t)}function zI(e){const t=ds(e);return!t||t.endsWith(".arcgis.com")||at._corsServers.includes(t)||ME(t)}function Pn(e,t,i,r){let s;const n={url:i.url,requestOptions:i.requestOptions,getAllHeaders:Op,getHeader:Op,ssl:!1};if(t instanceof j)return t.details?(t.details=V(t.details),t.details.url=i.url,t.details.requestOptions=i.requestOptions):t.details=n,t;if(t){const o=r&&(()=>Array.from(r.headers)),a=r&&(c=>r.headers.get(c)),l=r?.status,u=t.message;u&&(s=u),o&&a&&(n.getAllHeaders=o,n.getHeader=a),n.httpStatus=(t.httpCode!=null?t.httpCode:t.code)||l||0,n.subCode=t.subcode,n.messageCode=t.messageCode,typeof t.details=="string"?(n.messages=[t.details],s??=t.details):(n.messages=t.details,s??=n.messages?.[0]),n.raw=G1 in t?t[G1]:t}return s??="Error",Er(t)?yt():new j(e,s,n)}async function RH(){N("host-webworker")&&(!j1&&globalThis.invokeStaticMessage?j1=await J(()=>import("./request-BMuU0YVK.js"),[]):TD=!0)}async function FS(){ot||await J(()=>import("./IdentityManager-Dfl1HL-x.js"),[])}async function OH(e){const t=e.params.url,i=e.params.requestOptions,r=e.controller.signal,s=i.body;let n=null,o=null;if(ED&&"HTMLFormElement"in globalThis&&(s instanceof FormData?n=s:s instanceof HTMLFormElement&&(n=new FormData(s))),typeof s=="string"&&(o=s),e.fetchOptions={cache:i.cacheBust?"no-cache":"default",credentials:"same-origin",headers:i.headers||{},method:i.method==="head"?"HEAD":"GET",mode:"cors",priority:Is.priority,redirect:"follow",signal:r},(n||o)&&(e.fetchOptions.body=n||o),(TD||i.authMode==="anonymous")&&(e.useIdentity=!1),e.hasToken=!!(/token=/i.test(t)||i.query?.token||n?.get("token")),!e.hasToken){const a=OE(t);a&&(i.query??={},i.query.token=a,e.hasToken=!0)}if(e.useIdentity&&!e.hasToken&&!e.credential&&!e.credentialToken&&!CD(t)&&!js(r)){let a;i.authMode==="immediate"?(await FS(),a=await ot.getCredential(t,{signal:r})):i.authMode==="no-prompt"?(await FS(),a=await ot.getCredential(t,{prompt:!1,signal:r}).catch((()=>{}))):ot&&(a=ot.findCredential(t)),a&&(e.credential=a,e.credentialToken=a.token,e.useSSL=!!a.ssl)}}function CD(e){return LH.some((t=>t.test(e)))}async function NH(e){let t=e.params.url,i=FI(t);const r=e.params.requestOptions,s=e.fetchOptions??{},n=Mg(t)||yh(t),o=r.responseType||"json",a=n?0:r.timeout!=null?r.timeout:Is.timeout;let l=!1;if(!n){e.useSSL&&(t=CE(t));let y={...r.query};e.credentialToken&&(y.token=e.credentialToken);let g=Vy(y);N("esri-url-encodes-apostrophe")&&(g=g.replaceAll("'","%27"));const _=i.length+1+g.length;let v;l=r.method==="delete"||r.method==="post"||r.method==="put"||!!r.body||_>Is.maxUrlLength;const b=r.useProxy||!!Ab(t);if(b){const S=iD(t);v=S.path,!l&&v.length+1+_>Is.maxUrlLength&&(l=!0),S.query&&(y={...S.query,...y})}if(s.method==="HEAD"&&(l||b)){if(l)throw _>Is.maxUrlLength?Pn("request:invalid-parameters",new Error("URL exceeds maximum length"),e.params):Pn("request:invalid-parameters",new Error("cannot use POST request when method is 'head'"),e.params);if(b)throw Pn("request:invalid-parameters",new Error("cannot use proxy when method is 'head'"),e.params)}l?(s.method=r.method==="delete"?"DELETE":r.method==="put"?"PUT":"POST",r.body?t=w_(t,y):(s.body=Vy(y),s.headers||(s.headers={}),s.headers["Content-Type"]="application/x-www-form-urlencoded")):t=w_(t,y),b&&(e.useProxy=!0,t=`${v}?${t}`),y.token&&ED&&s.body instanceof FormData&&!JN(t)&&s.body.set("token",y.token),r.hasOwnProperty("withCredentials")?e.withCredentials=r.withCredentials:ih(t,SE())||(ME(t)||ot&&ot.findServerInfo(t)?.webTierAuth)&&(e.withCredentials=!0),e.withCredentials&&(s.credentials="include",EH(t)&&await CH(l?w_(t,y):t)),i=FI(t)}let u,c,d=0,m=!1;a>0&&(d=setTimeout((()=>{m=!0,e.controller.abort()}),a));try{if(r.responseType==="native-request-init")c=s,c.url=i,r.signal?c.signal=r.signal:delete c.signal;else if(r.responseType!=="image"||s.cache!=="default"||s.method!=="GET"||l||DH(r.headers)||!n&&!e.useProxy&&Is.proxyUrl&&!zI(t)){if(at._beforeFetch&&await at._beforeFetch(t,s),u=await fetch(i,s),at._afterFetch&&await at._afterFetch(u),e.useProxy||kH(t),r.responseType==="native")c=u;else if(s.method!=="HEAD")if(u.ok){switch(o){case"array-buffer":c=await u.arrayBuffer();break;case"blob":case"image":c=await u.blob();break;default:c=await u.text()}if(d&&(clearTimeout(d),d=0),o==="json"||o==="xml"||o==="document")if(c)switch(o){case"json":c=JSON.parse(c);break;case"xml":c=UI(c,"application/xml");break;case"document":c=UI(c,"text/html")}else c=null;if(c){if(o==="array-buffer"||o==="blob"){const y=u.headers.get("Content-Type");if(y&&/application\/json|text\/plain/i.test(y)&&c[o==="blob"?"size":"byteLength"]<=750)try{const g=await new Response(c).json();g.error&&(c=g)}catch{}}o==="image"&&c instanceof Blob&&(c=await jI(URL.createObjectURL(c),e,!0))}}else{c=await u.text();try{c=JSON.parse(c)}catch{}}}else c=await jI(i,e)}catch(y){if(y.name==="AbortError")throw m?MH():yt("Request canceled");if(!(!u&&y instanceof TypeError&&Is.proxyUrl)||r.body||r.method==="delete"||r.method==="head"||r.method==="post"||r.method==="put"||e.useProxy||zI(t))throw y;e.redoRequest=!0,Uq({proxyUrl:Is.proxyUrl,urlPrefix:ds(t)??""})}finally{d&&clearTimeout(d)}return[u,c]}async function VI(e,t){if(e.responseData!=null)return e.responseData;if(e.headers&&(t.requestOptions.headers={...t.requestOptions.headers,...e.headers}),e.query&&(t.requestOptions.query={...t.requestOptions.query,...e.query}),e.before){let i,r;try{r=await e.before(t)}catch(s){i=Pn("request:interceptor",s,t)}if((r instanceof Error||r instanceof j)&&(i=Pn("request:interceptor",r,t)),i)throw e.error&&e.error(i),i;return r}}function DH(e){if(e){for(const t of Object.getOwnPropertyNames(e))if(e[t])return!0}return!1}function UI(e,t){let i;try{i=new DOMParser().parseFromString(e,t)}catch{}if(!i||i.getElementsByTagName("parsererror").length)throw new SyntaxError("XML Parse error");return i}at._corsServers=["https://server.arcgisonline.com","https://services.arcgisonline.com"],at._beforeFetch=void 0,at._afterFetch=void 0;const FH=new Map;async function zH(e){const t=UH(e.params.url);if(!t)return zS(e);const{QueueProcessor:i}=await J(()=>import("./QueueProcessor-x30S7ems.js"),[]);return of(FH,t.origin,(()=>{const s=t.isHosted?N("request-queue-concurrency-hosted"):N("request-queue-concurrency-non-hosted");return new i({concurrency:s,process:n=>{if(js(n.params.requestOptions))throw Pn("",yt("Request canceled"),n.params);return zS(n)}})})).push(e)}async function zS(e){let t,i;await OH(e);try{do[t,i]=await NH(e);while(!await VH(e,t,i))}catch(n){const o=Pn("request:server",n,e.params,t);throw o.details.ssl=e.useSSL,e.interceptor?.error&&e.interceptor.error(o),o}const r=e.params.url;if(i)if(/\/sharing\/rest\/(accounts|portals)\/self/i.test(r)){if(!e.hasToken&&!e.credentialToken&&i.user?.username&&!ME(r)){const n=ds(r,!0);n&&Is.trustedServers.push(n)}Array.isArray(i.authorizedCrossOriginNoCorsDomains)&&TH(i.authorizedCrossOriginNoCorsDomains)}else(e.params.requestOptions.responseType||"json")==="json"&&PH(r,i);const s=e.credential;if(s&&ot){let o=ot.findServerInfo(s.server)?.owningSystemUrl;if(o){o=o.replace(/\/?$/,"/sharing");const a=ot.findCredential(o,s.userId);a&&ot._getIdenticalSvcIdx(o,a)===-1&&a.resources.unshift(o)}}return{data:i,getAllHeaders:t?()=>Array.from(t.headers):Op,getHeader:t?n=>t.headers.get(n):Op,httpStatus:t?.status??200,requestOptions:e.params.requestOptions,ssl:e.useSSL,url:e.params.url}}async function VH(e,t,i){if(e.redoRequest)return e.redoRequest=!1,!1;const r=e.params.requestOptions;if(!t||r.responseType==="native"||r.responseType==="native-request-init")return!0;let s,n;if(i&&(i.error&&typeof i.error=="object"?s=i.error:i.status==="error"&&Array.isArray(i.messages)&&(s={...i},s[G1]=i,s.details=i.messages)),!s&&!t.ok)throw s=new Error(`Unable to load ${t.url} status: ${t.status}`),s[G1]=i,s;let o,a=null;s&&(n=Number(s.code),a=s.hasOwnProperty("subcode")?Number(s.subcode):null,o=s.messageCode,o=o?.toUpperCase());const l=r.authMode;if(n===403&&(a===4||s.message?.toLowerCase().includes("ssl")&&!s.message.toLowerCase().includes("permission"))){if(!e.useSSL)return e.useSSL=!0,!1}else if(!e.hasToken&&e.useIdentity&&(l!=="no-prompt"||n===498)&&n!==void 0&&IH.has(n)&&!CD(e.params.url)&&(n!==403||(!o||!AH.has(o))&&(a==null||a===2&&e.credentialToken))){await FS();try{const u=await ot.getCredential(e.params.url,{error:Pn("request:server",s,e.params),credential:e.credential,prompt:l!=="no-prompt",signal:e.controller.signal,token:e.credentialToken});return e.credential=u,e.credentialToken=u.token,e.useSSL=e.useSSL||u.ssl,!1}catch(u){if(l==="no-prompt")return e.credential=void 0,e.credentialToken=void 0,!1;s=u}}if(s)throw s;return!0}function jI(e,t,i=!1){const r=t.controller.signal,s=new Image;return t.withCredentials?s.crossOrigin="use-credentials":s.crossOrigin="anonymous",s.alt="",s.fetchPriority=Is.priority,s.src=e,$H(s,e,i,r)}function UH(e){let t,i;return typeof e=="string"?(t=ds(e,!0),i=NI(e)):(t=e.origin,i=NI(e.toString())),t==null?null:{origin:t,isHosted:i}}function jH(e){return e?.release&&typeof e.release=="function"}function GH(e){return e?.acquire&&typeof e.acquire=="function"}var lu;let _h=(lu=class{constructor(t,i,r,s=1,n=0){this._ctor=t,this._acquireFunction=i,this._releaseFunction=r,this.allocationSize=s,this._pool=new Array(n),this._initialSize=n;for(let o=0;o<n;o++)this._pool[o]=new this._ctor;this.allocationSize=Math.max(s,1)}destroy(){this.prune(0)}acquire(...t){let i;if(lu.test.disabled)i=new this._ctor;else{if(this._pool.length===0){const r=this.allocationSize;for(let s=0;s<r;s++)this._pool[s]=new this._ctor}i=this._pool.pop()}return this._acquireFunction?this._acquireFunction(i,...t):GH(i)&&i.acquire(...t),i}release(t){t&&!lu.test.disabled&&(this._releaseFunction?this._releaseFunction(t):jH(t)&&t.release(),this._pool.push(t))}prune(t=this._initialSize){if(!(t>=this._pool.length)){for(let i=t;i<this._pool.length;++i){const r=this._pool[i];this._dispose(r)}this._pool.length=t}}_dispose(t){t.dispose&&typeof t.dispose=="function"&&t.dispose()}},lu.test={disabled:!1},lu);function BH(e){e.length=0}let Sr=class{constructor(t=50,i=50){this._pool=new _h(Array,void 0,BH,i,t)}acquire(){return this._pool.acquire()}release(t){this._pool.release(t)}prune(){this._pool.prune(0)}static acquire(){return Bw.acquire()}static release(t){return Bw.release(t)}static prune(){Bw.prune()}};const Bw=new Sr(100),GI=new WeakMap;function qH(e,t,i=!1){const r=` DEPRECATED - ${t}`;if(!i)return void e.warn(r);let s=GI.get(e);s||(s=new Set,GI.set(e,s)),s.has(t)||(s.add(t),e.warn(r))}const B1="https://www.esriurl.com/";function DE(e,t,i,r={}){N("esri-deprecation-warnings")&&cu(e,`This widget is deprecated. Use the ${t} component instead.`,{see:[`${t} component reference: ${B1}${i}/`,`Esri's move to web components: ${B1}components-transition-plan/`],replacement:`<${i}></${i}>`,warnOnce:!0,...r})}function HH(e,t,i,r={}){N("esri-deprecation-warnings")&&cu(e,`This view model is deprecated. Use the ${t} component directly instead.`,{see:[`${t} component reference: ${B1}${i}/`,`Esri's move to web components: ${B1}components-transition-plan/`],replacement:`<${i}></${i}>`,warnOnce:!0,...r})}function TMe(e,t,i={}){N("esri-deprecation-warnings")&&cu(e,`Module: ${t}`,i)}function PD(e,t,i={}){if(N("esri-deprecation-warnings")){const{moduleName:r}=i;cu(e,`Function: ${(r?r+"::":"")+t+"()"}`,i)}}function ID(e,t,i={}){if(N("esri-deprecation-warnings")){const{moduleName:r}=i;cu(e,`Property: ${(r?r+"::":"")+t}`,i)}}function WH(e,t,i={}){N("esri-deprecation-warnings")&&cu(e,`Multiple argument constructor: ${t}`,{warnOnce:!0,replacement:`new ${t}({ <your properties here> })`,...i})}function cu(e,t,i={}){if(N("esri-deprecation-warnings")){const{replacement:r,version:s,see:n,warnOnce:o}=i;let a=t;if(r&&(a+=`
	 Replacement: ${r}`),s&&(a+=`
	 Version: ${s}`),n)if(Array.isArray(n)){a+=`
	 See for more details:`;for(const l of n)a+=`
		${l}`}else a+=`
	 See ${n} for more details.`;qH(e,a,o)}}function EMe(e){const t=[];return function*(){yield*t;for(const i of e)t.push(i),yield i}}function ZH(e,t){for(const i of e)if(i!=null&&t(i))return i}function q1(e){return e!=null&&typeof e[Symbol.iterator]=="function"}let uf=class{constructor(){this._groups=new Map}destroy(){this.removeAll()}get size(){let t=0;return this._groups.forEach((i=>{t+=i.length})),t}add(t,i){if(q1(t)){const r=this._getOrCreateGroup(i);for(const s of t)qI(s)&&r.push(s)}else qI(t)&&this._getOrCreateGroup(i).push(t);return this}forEach(t,i){if(typeof t=="function")this._groups.forEach((r=>r.forEach(t)));else{const r=this._getGroup(t);r&&i&&r.forEach(i)}}has(t){return this._groups.has(d0(t))}remove(t){if(typeof t!="string"&&q1(t)){for(const i of t)this.remove(i);return this}return this.has(t)?(BI(this._getGroup(t)),this._groups.delete(d0(t)),this):this}removeAll(){return this._groups.forEach(BI),this._groups.clear(),this}removeReference(t){return this._groups.delete(t),this}_getOrCreateGroup(t){if(this.has(t))return this._getGroup(t);const i=[];return this._groups.set(d0(t),i),i}_getGroup(t){return this._groups.get(d0(t))}};function d0(e){return e||"_default_"}function BI(e){for(const t of e)t instanceof uf?t.removeAll():t.remove()}function qI(e){return e!=null&&(!!e.remove||e instanceof uf)}const AD=Symbol("Accessor-beforeDestroy");function Ba(e){return e.__accessor__??null}function YH(e,t){return e?.metadata?.[t]!=null}function S_(e,t,i){return i?H1(e,t,{policy:i,path:""}):H1(e,t,null)}function H1(e,t,i){return t?Object.keys(t).reduce(((r,s)=>{const n=s;if(n==="__proto__")return r;let o=null,a="merge";if(i&&(o=i.path?`${i.path}.${s}`:s,a=i.policy(o)),a==="replace"||a==="replace-arrays"&&Array.isArray(r[n]))return r[n]=t[n],r;if(r[n]===void 0)return r[n]=V(t[n]),r;let l=r[n],u=t[n];if(l===u)return r;if(Array.isArray(u)||Array.isArray(r))l=l?Array.isArray(l)?r[n]=l.slice():r[n]=[l]:r[n]=[],u&&(Array.isArray(u)||(u=[u]),u.forEach((c=>{l.includes(c)||l.push(c)})));else if(u&&typeof u=="object")if(i){const c=i.path;i.path=o,r[n]=H1(l,u,i),i.path=c}else r[n]=H1(l,u,null);else r.hasOwnProperty(s)&&!t.hasOwnProperty(s)||(r[n]=u);return r}),e||{}):e}function LD(e){return Array.isArray(e)?e:e.split(".")}function HI(e){return e.includes(",")?e.split(",").map((t=>t.trim())):[e.trim()]}function JH(e){if(Array.isArray(e)){const t=[];for(const i of e)t.push(...HI(i));return t}return HI(e)}function kD(e,t,i,r){const s=JH(t);if(s.length!==1){const n=s.map((o=>r(e,o,i)));return gh(n)}return r(e,s[0],i)}function RD(e,t){const i=e[e.length-1]==="?"?e.slice(0,-1):e;if(t.getItemAt!=null||Array.isArray(t)){const s=parseInt(i,10);if(!isNaN(s))return Array.isArray(t)?t[s]:t.at(s)}const r=Ba(t);return YH(r,i)?r.get(i):t[i]}function OD(e,t,i){if(e==null)return e;const r=RD(t[i],e);return!r&&i<t.length-1?void 0:i===t.length-1?r:OD(r,t,i+1)}function Pg(e,t,i=0){return typeof t!="string"||t.includes(".")?OD(e,LD(t),i):RD(t,e)}function Mn(e,t){return Pg(e,t)}function WI(e,t){return Pg(t,e)!==void 0}const ls={INITIALIZING:0,CONSTRUCTING:1,CONSTRUCTED:2,DESTROYING:3,DESTROYED:4};function Ig(e){let t=e.constructor.__accessorMetadata__;const i=Object.prototype.hasOwnProperty.call(e.constructor,"__accessorMetadata__");if(t){if(!i){t=Object.create(t);for(const r in t)t[r]=V(t[r]);Object.defineProperty(e.constructor,"__accessorMetadata__",{value:t,enumerable:!1,configurable:!0,writable:!0})}}else t={},Object.defineProperty(e.constructor,"__accessorMetadata__",{value:t,enumerable:!1,configurable:!0,writable:!0});return e.constructor.__accessorMetadata__}function Ag(e,t){const i=Ig(e);let r=i[t];return r||(r=i[t]={}),r}function XH(e,t){return S_(e,t,QH)}const KH=/^(?:[^.]+\.)?(?:value|type|(?:json\.type|json\.origins\.[^.]\.type))$/;function QH(e){return KH.test(e)?"replace":"merge"}let eW=class{constructor(t,i){this._observers=t,this._observer=i}remove(){mE(this._observers,this._observer)}},ND=class{constructor(){this._observers=null,this.destroyed=!1}observe(t){if(this.destroyed||t.destroyed)return tW;this._observers==null&&(this._observers=[]);const i=this._observers;let r=!1,s=!1;const n=i.length;for(let o=0;o<n;++o){const a=i[o];if(a.destroyed)s=!0;else if(a===t){r=!0;break}}return r||(i.push(t),s&&this._removeDestroyedObservers()),new eW(i,t)}_removeDestroyedObservers(){const t=this._observers;if(!t||t.length===0)return;const i=t.length;let r=0;for(let s=0;s<i;++s){for(;s+r<i&&t[s+r].destroyed;)++r;if(r>0){if(!(s+r<i))break;t[s]=t[s+r]}}t.length=i-r}destroy(){if(this.destroyed)return;this.destroyed=!0;const t=this._observers;if(t!=null){for(const i of t)i.onCommitted();this._observers=null}}};const tW=ze();var Ie;(function(e){e[e.DEFAULTS=0]="DEFAULTS",e[e.COMPUTED=1]="COMPUTED",e[e.SERVICE=2]="SERVICE",e[e.PORTAL_ITEM=3]="PORTAL_ITEM",e[e.WEB_SCENE=4]="WEB_SCENE",e[e.WEB_MAP=5]="WEB_MAP",e[e.LINK_CHART=6]="LINK_CHART",e[e.USER=7]="USER"})(Ie||(Ie={}));const AMe=Ie.USER+1;function FE(e){switch(e){case"defaults":return Ie.DEFAULTS;case"service":return Ie.SERVICE;case"portal-item":return Ie.PORTAL_ITEM;case"web-scene":return Ie.WEB_SCENE;case"web-map":return Ie.WEB_MAP;case"link-chart":return Ie.LINK_CHART;case"user":return Ie.USER;default:return null}}function VS(e){switch(e){case Ie.DEFAULTS:return"defaults";case Ie.SERVICE:return"service";case Ie.PORTAL_ITEM:return"portal-item";case Ie.WEB_SCENE:return"web-scene";case Ie.WEB_MAP:return"web-map";case Ie.LINK_CHART:return"link-chart";case Ie.USER:return"user"}}function iW(e){return VS(e)}const bt={Dirty:1,Overridden:2,Computing:4,NonNullable:8,HasDefaultValue:16,DepTrackingInitialized:32,AutoTracked:64,ExplicitlyTracking:128};let Ob=class{constructor(t){this.accessed=void 0,this._handles=void 0,this._observer=t}destroy(){this.accessed?.clear(),this.clear()}onAccessed(t){this._observer!=null&&t!==this._observer&&(this.accessed==null&&(this.accessed=new Set),this.accessed.add(t))}onTrackingEnd(){this._observer!=null&&(this.clear(),this.accessed!=null&&(this._handles==null&&(this._handles=[]),this.accessed.forEach((t=>{this._handles.push(t.observe(this._observer))})),this.accessed.clear()))}clear(){if(this._handles!=null){for(let t=0;t<this._handles.length;++t)this._handles[t].remove();this._handles.length=0}}};const W1=new Ob,cm=[];let ay=W1;function ge(e){ay.onAccessed(e)}let x_=!1,$_=!1;function qa(e,t,i){if(x_)return zE(e,t,i);let r=null;return DD(e),r=t.call(i),FD(),r}function rW(e,t){return qa(W1,e,t)}function zE(e,t,i){const r=x_;x_=!0,DD(e);let s=null;try{s=t.call(i)}catch(n){$_&&H.getLogger("esri.core.accessorSupport.tracking").error(n)}return FD(),x_=r,s}function DD(e){ay=e,cm.push(e)}function FD(){const e=cm.length;if(e>1){const t=cm.pop();ay=cm[e-2],t.onTrackingEnd()}else if(e===1){const t=cm.pop();ay=W1,t.onTrackingEnd()}else ay=W1}function zD(e,t){if(t.flags&bt.DepTrackingInitialized)return;t.flags|=bt.DepTrackingInitialized;const i=$_;$_=!1,t.flags&bt.AutoTracked?zE(t.trackingTarget,t.metadata.get,e):VD(e,t),$_=i}const sW=[];function VD(e,t){t.flags&bt.ExplicitlyTracking||(t.flags|=bt.ExplicitlyTracking,zE(t.trackingTarget,(()=>{const i=t.metadata.dependsOn||sW;for(const r of i)if(typeof r!="string"||r.includes(".")){const s=LD(r);for(let n=0,o=e;n<s.length&&o!=null&&typeof o=="object";++n)o=ZI(o,s[n],n!==s.length-1)}else ZI(e,r,!1)})),t.flags&=-129)}function ZI(e,t,i){const r=t[t.length-1]==="?"?t.slice(0,-1):t;if(e.getItemAt!=null||Array.isArray(e)){const n=parseInt(r,10);if(!isNaN(n))return Array.isArray(e)?e[n]:e.at(n)}const s=Ba(e);if(s){const n=s.propertiesByName.get(r);n&&(ge(n),zD(e,n))}return i?e[r]:void 0}let YI=class extends ND{constructor(t,i){super(),this.propertyName=t,this.metadata=i,this.trackingTarget=new Ob(this),this.flags=0,this.flags=bt.Dirty|(i.nonNullable?bt.NonNullable:0)|(i.hasOwnProperty("value")?bt.HasDefaultValue:0)|(i.get===void 0?bt.DepTrackingInitialized:0)|(i.dependsOn===void 0?bt.AutoTracked:0)}destroy(){this.flags&bt.Dirty&&this.onCommitted(),super.destroy(),this.trackingTarget.destroy()}getComputed(t){t.mutable&&ge(this);const i=t.store,r=this.propertyName,s=this.flags,n=i.get(r);if(s&bt.Computing||~s&bt.Dirty&&i.has(r))return n;this.flags|=bt.Computing;const o=t.host;let a;s&bt.AutoTracked?a=qa(this.trackingTarget,this.metadata.get,o):(VD(o,this),a=this.metadata.get.call(o)),this.flags|=bt.DepTrackingInitialized,i.set(r,a,Ie.COMPUTED);const l=i.get(r);return l===n?this.flags&=-2:rW(this.commit,this),this.flags&=-5,l}notifyChange(){this.onInvalidated(),this.onCommitted()}invalidate(){this.onInvalidated()}commit(){this.flags&=-2,this.onCommitted()}onInvalidated(){~this.flags&bt.Overridden&&(this.flags|=bt.Dirty);const t=this._observers;if(t&&t.length>0)for(const i of t)i.onInvalidated()}onCommitted(){const t=this._observers;if(t&&t.length>0){const i=t.slice();for(const r of i)r.onCommitted()}}},nW=class UD{constructor(){this._values=new Map,this.multipleOriginsSupported=!1}clone(t){const i=new UD;return this._values.forEach(((r,s)=>{t&&t.has(s)||i.set(s,V(r))})),i}get(t){return this._values.get(t)}originOf(){return Ie.USER}keys(){return[...this._values.keys()]}set(t,i){this._values.set(t,i)}delete(t){this._values.delete(t)}has(t){return this._values.has(t)}isAtOrigin(t,i){return this.has(t)}isBelowOrigin(t,i){return!this.has(t)}forEach(t){this._values.forEach(t)}};function Lh(e,t,i){return e!==void 0}function JI(e,t,i,r){return e!==void 0&&(!(i==null&&e.flags&bt.NonNullable)||(r.lifecycle,!1))}let oW=class{constructor(t){this.host=t,this.propertiesByName=new Map,this.ctorArgs=null,this.lifecycle=ls.INITIALIZING,this.store=new nW,this.mutable=!0,this._origin=Ie.USER;const i=this.host.constructor.__accessorMetadata__;for(const r in i){const s=new YI(r,i[r]);this.propertiesByName.set(r,s)}this.metadata=i}initialize(){this.lifecycle=ls.CONSTRUCTING}constructed(){this.lifecycle=ls.CONSTRUCTED}destroy(){this.lifecycle=ls.DESTROYED,this.propertiesByName.forEach((t=>t.destroy()))}get initialized(){return this.lifecycle!==ls.INITIALIZING}get(t){const i=this.propertiesByName.get(t);if(!Lh(i))return;if(i.metadata.get)return i.getComputed(this);this.mutable&&ge(i);const r=this.store;return r.has(t)?r.get(t):i.metadata.value}originOf(t){const i=this.store.originOf(t);if(i===void 0){const r=this.propertiesByName.get(t);if(r!==void 0&&r.flags&bt.HasDefaultValue)return"defaults"}return VS(i)}has(t){return this.propertiesByName.has(t)&&this.store.has(t)}keys(){return[...this.propertiesByName.keys()]}internalGet(t){const i=this.propertiesByName.get(t);if(Lh(i))return this.store.has(t)?this.store.get(t):i.metadata.value}internalSet(t,i){const r=this.propertiesByName.get(t);Lh(r)&&this._internalSet(r,i)}getDependsInfo(t,i,r){const s=this.propertiesByName.get(i);if(!Lh(s))return"";const n=new Ob,o=qa(n,(()=>s.metadata.get?.call(t)));let a=`${r}${t.declaredClass.split(".").pop()}.${i}: ${o}
`;const l=n.accessed??new Set;if(l.size===0)return a;r+="  ";for(const u of l)u instanceof YI&&(a+=`${r}${u.propertyName}: undefined
`);return a}setAtOrigin(t,i,r){const s=this.propertiesByName.get(t);if(Lh(s))return this._setAtOrigin(s,i,r)}isOverridden(t){const i=this.propertiesByName.get(t);return i!==void 0&&!!(i.flags&bt.Overridden)}clearOrigin(t,i){const r=this.store,s=this.propertiesByName.get(t);if(!Lh(s))return;const n=r.isAtOrigin(t,i)&&!(s.flags&bt.Overridden);r.delete(t,i),n&&s.notifyChange()}clearOverride(t){const i=this.propertiesByName.get(t);i&&i.flags&bt.Overridden&&(i.flags&=-3,i.notifyChange())}override(t,i){const r=this.propertiesByName.get(t);if(!JI(r,t,i,this))return;const s=r.metadata.cast;if(s){const n=this._cast(s,i),{valid:o,value:a}=n;if(qw.release(n),!o)return;i=a}r.flags|=bt.Overridden,this._internalSet(r,i)}set(t,i){const r=this.propertiesByName.get(t);if(!JI(r,t,i,this))return;const s=r.metadata.cast;if(s){const o=this._cast(s,i),{valid:a,value:l}=o;if(qw.release(o),!a)return;i=l}const n=r.metadata.set;n?n.call(this.host,i):this._internalSet(r,i)}setDefaultOrigin(t){this._origin=FE(t)}getDefaultOrigin(){return VS(this._origin)}notifyChange(t){const i=this.propertiesByName.get(t);i!==void 0&&i.notifyChange()}invalidate(t){const i=this.propertiesByName.get(t);i!==void 0&&i.invalidate()}commit(t){const i=this.propertiesByName.get(t);i!==void 0&&i.commit()}_internalSet(t,i){const r=this.lifecycle!==ls.INITIALIZING?this._origin:Ie.DEFAULTS;this._setAtOrigin(t,i,r)}_setAtOrigin(t,i,r){const s=this.store,n=t.propertyName;if(s.isAtOrigin(n,r)&&vE(i,s.get(n))&&~t.flags&bt.Overridden)return;const o=s.isBelowOrigin(n,r)||s.isAtOrigin(n,r);o&&t.invalidate(),s.set(n,i,r),o&&t.commit(),zD(this.host,t)}_cast(t,i){const r=qw.acquire();return r.valid=!0,r.value=i,t&&(r.value=t.call(this.host,i,r)),r}},aW=class{constructor(){this.value=null,this.valid=!0}acquire(){this.valid=!0}release(){this.value=null}};const qw=new _h(aW);function Z1(e,t,i){if(e&&t)if(typeof t=="object")for(const r of Object.getOwnPropertyNames(t))Z1(e,r,t[r]);else{if(t.includes(".")){const s=t.split("."),n=s.splice(-1,1)[0];return void Z1(Mn(e,s),n,i)}const r=e.__accessor__;r!=null&&lW(t,r),e[t]=i}}function lW(e,t){if(N("esri-unknown-property-errors")&&!uW(e,t))throw new j("set:unknown-property",cW(e,t))}function uW(e,t){return t.metadata[e]!=null}function cW(e,t){return"setting unknown property '"+e+"' on instance of "+t.host.declaredClass}let hW;function dW(){return hW}var XI;(function(e){e[e.Ignore=0]="Ignore",e[e.Destroy=1]="Destroy",e[e.ThrowError=2]="ThrowError"})(XI||(XI={}));let jD=class extends _h{constructor(){super(...arguments),this._set=new Set}destroy(){super.destroy(),this._set=null}acquire(...t){const i=super.acquire(...t);return this._set.delete(i),i}release(t){t&&!this._set.has(t)&&(super.release(t),this._set.add(t))}_dispose(t){this._set.delete(t),super._dispose(t)}};const p0=[];function Y1(e){p0.push(e),p0.length===1&&queueMicrotask((()=>{const t=p0.slice();p0.length=0;for(const i of t)i()}))}let ly=class{constructor(t,i=30){this.name=t,this._counter=0,this._samples=new Array(i)}push(t){t!=null&&(this._samples[++this._counter%this._samples.length]=t)}set(t){t!=null&&(this._samples[this._counter%this._samples.length]=t)}get median(){return this._samples.slice().sort(((t,i)=>t-i))[Math.floor(this._samples.length/2)]}get average(){return this._samples.reduce(((t,i)=>t+i),0)/this._samples.length}get last(){return this._samples[this._counter%this._samples.length]}};var US;(function(e){const t=(n,o,a,l)=>{let u=o,c=o;const d=a>>>1,m=n[u-1];for(;c<=d;){c=u<<1,c<a&&l(n[c-1],n[c])<0&&++c;const y=n[c-1];if(l(y,m)<=0)break;n[u-1]=y,u=c}n[u-1]=m},i=(n,o)=>n<o?-1:n>o?1:0;function r(n,o,a,l){o===void 0&&(o=0),a===void 0&&(a=n.length),l===void 0&&(l=i);for(let c=a>>>1;c>o;c--)t(n,c,a,l);const u=o+1;for(let c=a-1;c>o;c--){const d=n[o];n[o]=n[c],n[c]=d,t(n,u,c,l)}}function*s(n,o,a,l){o===void 0&&(o=0),a===void 0&&(a=n.length),l===void 0&&(l=i);for(let c=a>>>1;c>o;c--)t(n,c,a,l),yield;const u=o+1;for(let c=a-1;c>o;c--){const d=n[o];n[o]=n[c],n[c]=d,t(n,u,c,l),yield}}e.sort=r,e.iterableSort=s})(US||(US={}));const KI=US,pW=1.5,fW=1.1;let uy=class{constructor(t){this.data=[],this._length=0,this._allocator=void 0,this._deallocator=()=>null,this._shrink=()=>{},this._hint=new LN,t&&(t.initialSize&&(this.data=new Array(t.initialSize)),t.allocator&&(this._allocator=t.allocator),t.deallocator!==void 0&&(this._deallocator=t.deallocator),t.shrink&&(this._shrink=()=>QI(this)))}toArray(){return this.data.slice(0,this.length)}filter(t){const i=new Array;for(let r=0;r<this._length;r++){const s=this.data[r];t(s)&&i.push(s)}return i}at(t){if((t=Math.trunc(t)||0)<0&&(t+=this._length),!(t<0||t>=this._length))return this.data[t]}includes(t,i){const r=this.data.indexOf(t,i);return r!==-1&&r<this.length}get length(){return this._length}set length(t){if(t>this._length){if(this._allocator){for(;this._length<t;)this.data[this._length++]=this._allocator(this.data[this._length]);return}this._length=t}else{if(this._deallocator)for(let i=t;i<this._length;++i)this.data[i]=this._deallocator(this.data[i]);this._length=t,this._shrink()}}clear(){this.length=0}prune(){this.clear(),this.data=[]}push(t){this.data[this._length++]=t}pushArray(t,i=t.length){for(let r=0;r<i;r++)this.data[this._length++]=t[r]}fill(t,i){for(let r=0;r<i;r++)this.data[this._length++]=t}pushNew(){this._allocator&&(this.data[this.length]=this._allocator(this.data[this.length]));const t=this.data[this._length];return++this._length,t}unshift(t){this.data.unshift(t),this._length++,QI(this)}pop(){if(this.length===0)return;const t=this.data[this.length-1];return this.length=this.length-1,this._shrink(),t}remove(t){const i=CS(this.data,t,this.length,this._hint);if(i!==-1)return this.data.splice(i,1),this.length=this.length-1,t}removeUnordered(t){return this.removeUnorderedIndex(CS(this.data,t,this.length,this._hint))}removeUnorderedIndex(t){if(!(t>=this.length||t<0))return this.swapElements(t,this.length-1),this.pop()}removeUnorderedMany(t,i=t.length,r){this.length=_q(this.data,t,this.length,i,this._hint,r),this._shrink()}front(){if(this.length!==0)return this.data[0]}back(){if(this.length!==0)return this.data[this.length-1]}swapElements(t,i){if(t>=this.length||i>=this.length||t===i)return;const r=this.data[t];this.data[t]=this.data[i],this.data[i]=r}sort(t){KI.sort(this.data,0,this.length,t)}iterableSort(t){return KI.iterableSort(this.data,0,this.length,t)}some(t,i){for(let r=0;r<this.length;++r)if(t.call(i,this.data[r],r,this.data))return!0;return!1}find(t,i){const{data:r,length:s}=this;for(let n=0;n<s;++n)if(t.call(i,r[n]))return r[n]}filterInPlace(t,i){let r=0;for(let s=0;s<this._length;++s){const n=this.data[s];t.call(i,n,s,this.data)&&(this.data[s]=this.data[r],this.data[r]=n,r++)}if(this._deallocator)for(let s=r;s<this._length;s++)this.data[s]=this._deallocator(this.data[s]);return this._length=r,this._shrink(),this}forAll(t,i){const{data:r,length:s}=this;for(let n=0;n<s;++n)t.call(i,r[n],n,r)}forEach(t,i){this.data.slice(0,this.length).forEach(t,i)}map(t,i){const r=new Array(this.length);for(let s=0;s<this.length;++s)r[s]=t.call(i,this.data[s],s,this.data);return r}reduce(t,i){let r=i;for(let s=0;s<this.length;++s)r=t(r,this.data[s],s,this.data);return r}has(t){const i=this.length,r=this.data;for(let s=0;s<i;++s)if(r[s]===t)return!0;return!1}*[Symbol.iterator](){for(let t=0;t<this.length;t++)yield this.data[t]}};function QI(e){e.data.length>pW*e.length&&(e.data.length=Math.floor(e.length*fW))}function zMe(e){return e}function mW(e){return 1e3*e}function VMe(e){return e}function UMe(e){return .001*e}let yW=class{constructor(t){this.phases=t,this.paused=!1,this.ticks=-1,this.removed=!1}},gW=class{constructor(t){this.callback=t,this.isActive=!0}remove(){this.isActive=!1}},jS=0;const Cf={time:0,deltaTime:0,elapsedFrameTime:0,frameDuration:0},GS=["prepare","preRender","render","postRender","update","finish"],BS=[],sh=new uy;let _W=class{constructor(t){this._task=t}remove(){this._task.removed=!0}pause(){this._task.paused=!0}resume(){this._task.paused=!1,GD()}};function vW(){Vc!=null&&(cancelAnimationFrame(Vc),Vc=requestAnimationFrame(VE))}function GD(){Vc==null&&(jS=performance.now(),Vc=requestAnimationFrame(VE))}const J1={frameTasks:sh,willDispatch:!1,clearFrameTasks:bW,dispatch:qD,executeFrameTasks:wW,reschedule:vW};function Lg(e){const t=new gW(e);return BS.push(t),J1.willDispatch||(J1.willDispatch=!0,Y1(qD)),t}function Np(e){const t=new yW(e);return sh.push(t),GD(),new _W(t)}let Vc=null;function bW(e=!1){sh.forAll((t=>{t.removed=!0})),e&&BD()}function VE(){const e=performance.now();Vc=null,Vc=sh.some((i=>!i.paused&&!i.removed))?requestAnimationFrame(VE):null,J1.executeFrameTasks(e)}function wW(e){const t=e-jS;jS=e;const i=1e3/60,r=Math.max(0,t-i);Cf.time=e,Cf.frameDuration=i-r;for(let s=0;s<GS.length;s++){const n=performance.now(),o=GS[s];sh.forAll((a=>{a.paused||a.removed||(s===0&&a.ticks++,a.phases[o]&&(Cf.elapsedFrameTime=performance.now()-e,Cf.deltaTime=a.ticks===0?0:t,a.phases[o]?.call(a,Cf)))})),MW[s].push(performance.now()-n)}BD(),TW.push(performance.now()-e)}const f0=new uy;function BD(){sh.forAll((e=>{e.removed&&f0.push(e)})),sh.removeUnorderedMany(f0.data,f0.length),f0.clear()}function qD(){for(;BS.length;){const e=BS.shift();e.isActive&&e.callback()}J1.willDispatch=!1}function SW(e=1,t){const i=Gs(),r=()=>{js(t)?i.reject(yt()):e===0?i():(--e,Y1((()=>r())))};return r(),i.promise}function xW(e){return SW(1,e)}async function $W(e){await xW(e),await new Promise((t=>requestAnimationFrame((()=>{e?.aborted||t()}))))}const MW=GS.map((e=>new ly(e))),TW=new ly("total");function HD(e,t){for(const i of e.values())if(t(i))return!0;return!1}function e3(e,t){if(!t)return e;for(const i of t)i!=null&&e.add(i);return e}function qMe(e,t){return t!=null&&e.add(t),e}function UE(e,t){const i=new Set;return e3(i,e),e3(i,t),i}function EW(e,t){const i=new Set;for(const r of t)e.has(r)&&i.add(r);return i}function HMe(e,t){if(!e||!t)return!1;if(e===t)return!0;for(const i of e)if(!t.has(i))return!1;return!0}function WMe(e,t){if(e==null&&t==null)return!0;if(e==null||t==null||e.size!==t.size)return!1;for(const i of e)if(!t.has(i))return!1;return!0}function CW(e,t){const i=new Set(e);for(const r of t)i.delete(r);return i}function PW(e,t){return CW(UE(e,t),EW(e,t))}let IW=0;function M_(){return++IW}let Nb=class extends Ob{constructor(t){super(new AW(t)),this._observer&&t3.register(this,new WeakRef(this._observer),this)}destroy(){this._observer&&t3.unregister(this._observer),this.accessed?.clear(),this.clear(),this._observer?.destroy()}},AW=class{constructor(t){this._notify=t,this._invalidCount=0,this.destroyed=!1}onInvalidated(){this._invalidCount++}onCommitted(){if(this.destroyed)return;const t=this._invalidCount;if(t===1)return this._invalidCount=0,void this._notify();this._invalidCount=t>0?t-1:0}destroy(){this.destroyed=!0,this._notify=LW}};const t3=new FinalizationRegistry((e=>{e.deref()?.destroy()}));function LW(){}let Zd=!1;const X1=[];function WD(e,t){let i=new Nb(n),r=null,s=!1;function n(){if(!i||s)return;if(Zd)return void YD(n);const a=r;i.clear(),Zd=!0,s=!0,r=qa(i,e),s=!1,Zd=!1,t(r,a),JD()}function o(){i&&(i.destroy(),i=null,r=null)}return s=!0,r=qa(i,e),s=!1,ze(o)}function ZD(e,t){let i=new Nb(s),r=null;function s(){t(r,o)}function n(){i&&(i.destroy(),i=null),r=null}function o(){return i?(i.clear(),r=qa(i,e),r):null}return o(),ze(n)}function kW(e,t){let i=!1,r=!1;const s=!!t?.sync;let n=new Nb((()=>{i||r||(r=!0,s?o():queueMicrotask(o))}));function o(){r=!1,n&&!i&&(Zd?YD(o):(n.clear(),Zd=!0,i=!0,qa(n,e),i=!1,Zd=!1,JD()))}function a(){n&&(n.destroy(),n=null)}return i=!0,qa(n,e),i=!1,ze(a)}function YD(e){X1.includes(e)||X1.unshift(e)}function JD(){for(;X1.length;)X1.pop()()}var cy;(function(e){e[e.Untracked=0]="Untracked",e[e.Tracked=1]="Tracked"})(cy||(cy={}));var Yc;let jE=(Yc=class{constructor(){this.uid=M_(),this.removed=!1,this.type=null,this.oldValue=null,this.callback=null,this.getValue=null,this.target=null,this.path=null,this.equals=null}static acquireUntracked(t,i,r,s,n){return this.pool.acquire(cy.Untracked,t,i,r,s,n,vE)}static acquireTracked(t,i,r,s){return this.pool.acquire(cy.Tracked,t,i,r,null,null,s)}notify(t,i){this.type===cy.Untracked?this.callback.call(this.target,t,i,this.path,this.target):this.callback.call(null,t,i,void 0,void 0)}acquire(t,i,r,s,n,o,a){this.uid=M_(),this.removed=!1,this.type=t,this.oldValue=i,this.callback=r,this.getValue=s,this.target=n,this.path=o,this.equals=a}release(){this.target=this.path=this.oldValue=this.callback=this.getValue=null,this.uid=M_(),this.removed=!0}},Yc.pool=new jD(Yc),Yc);const T_=new Sr,za=new Set;let K1;function Q1(e){za.delete(e),za.add(e),K1||(K1=Lg(NW))}function RW(e){if(e.removed)return;const t=e.oldValue,i=e.getValue();e.equals(t,i)||(e.oldValue=i,e.notify(i,t))}function OW(e){for(const t of za.values())t.target===e&&(t.removed=!0)}function NW(){let e=10;for(;K1&&e--;){K1=null;const t=DW(),i=T_.acquire();for(const r of t){const s=r.uid;RW(r),s===r.uid&&r.removed&&i.push(r)}for(const r of za)r.removed&&(i.push(r),za.delete(r));for(const r of i)jE.pool.release(r);T_.release(i),T_.release(t),qS.forEach((r=>r()))}}function DW(){const e=T_.acquire();e.length=za.size;let t=0;for(const i of za)e[t]=i,++t;return za.clear(),e}const qS=new Set;function FW(e){return qS.add(e),ze((()=>qS.delete(e)))}function zW(e,t,i){let r=kD(e,t,i,((s,n,o)=>{let a,l,u=ZD((()=>Pg(s,n)),((c,d)=>{s.__accessor__?.lifecycle===ls.DESTROYED||a&&a.uid!==l?r.remove():(a||(a=jE.acquireUntracked(c,o,d,s,n),l=a.uid),Q1(a))}));return ze((()=>{u.remove(),a&&(a.uid!==l||a.removed||(a.removed=!0,Q1(a)),a=null),r=u=null}))}));return r}function VW(e,t,i){const r=kD(e,t,i,((s,n,o)=>{let a=!1;return WD((()=>Pg(s,n)),((l,u)=>{s.__accessor__.lifecycle!==ls.DESTROYED?a||(a=!0,vE(u,l)||o.call(s,l,u,n,s),a=!1):r.remove()}))}));return r}function UW(e,t,i,r=!1){return e.__accessor__&&e.__accessor__.lifecycle!==ls.DESTROYED?r?VW(e,t,i):zW(e,t,i):ze()}function jW(e,t,i){let r,s,n=ZD(e,((o,a)=>{r&&r.uid!==s?n.remove():(r||(r=jE.acquireTracked(o,t,a,i),s=r.uid),Q1(r))}));return ze((()=>{n.remove(),r&&(r.uid!==s||r.removed||(r.removed=!0,Q1(r)),r=null),n=null}))}function GW(e,t,i){let r=!1;return WD(e,((s,n)=>{r||(r=!0,i(n,s)||t(s,n),r=!1)}))}function BW(e,t,i=!1,r=BN){return i?GW(e,t,r):jW(e,t,r)}function i3(e){return HD(za,(t=>t.oldValue===e))}const Uc=()=>H.getLogger("esri.core.accessorSupport.ensureTypes");function qW(e){if(e==null)return e;const t=new Date(e);return isNaN(t.getTime())?(Uc().error("Accessor#set",`Invalid date value: '${e}', falling back to current date`),new Date):t}function HW(e){return e==null?e:!!e}function kg(e){return e==null?e:e.toString()}function us(e,t=0){return e==null?e:(e=parseFloat(e),isNaN(e)?t:e)}function GE(e){return e==null?e:Math.round(parseFloat(e))}function WW(e){return null}function ZW(e,t){return i=>{let r=e(i);return t.step!=null&&(r=Math.round(r/t.step)*t.step),t.min!=null&&(r=Math.max(t.min,r)),t.max!=null&&(r=Math.min(t.max,r)),r}}function XD(e){return e?.constructor&&e.constructor.__accessorMetadata__!==void 0}function ev(e,t){return t!=null&&e&&!(t instanceof e)}function KD(e){return e&&"isCollection"in e}function r3(e){return e?.Type?typeof e.Type=="function"?e.Type:e.Type.base:null}function YW(e,t){if(!t?.constructor||!KD(t.constructor))return HS(e,t)?t:new e(t);const i=r3(e.prototype.itemType),r=r3(t.constructor.prototype.itemType);return i?r?i===r?t:i.prototype.isPrototypeOf(r.prototype)?new e(t):(HS(e,t),t):new e(t):t}function HS(e,t){return!!XD(t)&&(Uc().error("Accessor#set","Assigning an instance of '"+(t.declaredClass||"unknown")+"' which is not a subclass of '"+Db(e)+"'"),!0)}function cf(e,t){return t==null?t:KD(e)?YW(e,t):ev(e,t)?HS(e,t)?t:new e(t):t}function Db(e){return e?.prototype?.declaredClass||"unknown"}const JW=new WeakMap;function XW(e){switch(e){case Number:return t=>us(t);case Ue:return GE;case Boolean:return HW;case String:return kg;case Date:return qW;case BE:return WW;default:return of(JW,e,(()=>cf.bind(null,e)))}}function Ui(e,t){const i=XW(e);return arguments.length===1?i:i(t)}function Uy(e,t,i){return arguments.length===1?Uy.bind(null,e):t&&(Array.isArray(t)?t.map((r=>e(r,i))):[e(t,i)])}function KW(e,t){return arguments.length===1?Uy((i=>Ui(e,i))):Uy((i=>Ui(e,i)),t)}function QD(e,t,i){return t!==0&&Array.isArray(i)?i.map((r=>QD(e,t-1,r))):e(i)}function tv(e,t,i){if(arguments.length===2)return n=>tv(e,t,n);if(!i)return i;i=QD(e,t,i);let r=t,s=i;for(;r>0&&Array.isArray(s);)r--,s=s[0];if(s!==void 0)for(let n=0;n<r;n++)i=[i];return i}function QW(e,t,i){return arguments.length===2?tv((r=>Ui(e,r)),t):tv((r=>Ui(e,r)),t,i)}function e4(e){return!!Array.isArray(e)&&!e.some((t=>{const i=typeof t;return!(i==="string"||i==="number"||i==="function"&&e.length>1)}))}function WS(e,t){if(arguments.length===2)return WS(e).call(null,t);const i=new Set,r=e.filter((a=>typeof a!="function")),s=e.filter((a=>typeof a=="function"));for(const a of e)typeof a!="string"&&typeof a!="number"||i.add(a);let n=null,o=null;return(a,l)=>{if(a==null)return a;const u=typeof a,c=u==="string"||u==="number";return c&&(i.has(a)||s.some((d=>u==="string"&&d===String||u==="number"&&d===Number)))||u==="object"&&s.some((d=>!ev(a,d)))?a:(c&&r.length?(n||(n=r.map((d=>typeof d=="string"?`'${d}'`:`${d}`)).join(", ")),Uc().error("Accessor#set",`'${a}' is not a valid value for this property, only the following values are valid: ${n}`)):typeof a=="object"&&s.length?(o||(o=s.map((d=>Db(d))).join(", ")),Uc().error("Accessor#set",`'${a}' is not a valid value for this property, value must be one of ${o}`)):Uc().error("Accessor#set",`'${a}' is not a valid value for this property`),l&&(l.valid=!1),null)}}function hu(e,t){if(arguments.length===2)return hu(e).call(null,t);const i={},r=[],s=[];for(const l in e.typeMap){const u=e.typeMap[l];i[l]=Ui(u),r.push(Db(u)),s.push(l)}const n=()=>`'${r.join("', '")}'`,o=()=>`'${s.join("', '")}'`,a=typeof e.key=="string"?l=>l[e.key]:e.key;return l=>{if(e.base&&!ev(e.base,l)||l==null)return l;const u=a(l)||e.defaultKeyValue,c=i[u];if(!c)return Uc().error("Accessor#set",`Invalid property value, value needs to be one of ${n()}, or a plain object that can autocast (having .type = ${o()})`),null;if(!ev(e.typeMap[u],l))return l;if(typeof e.key=="string"&&!XD(l)){const d={};for(const m in l)m!==e.key&&(d[m]=l[m]);return c(d)}return c(l)}}let Ue=class{},BE=class{};const KMe={native:e=>({type:"native",value:e}),array:e=>({type:"array",value:e}),oneOf:e=>({type:"one-of",values:e})};function eZ(e){if(!e||!("type"in e))return!1;switch(e.type){case"native":case"array":case"one-of":return!0}return!1}function t4(e){switch(e.type){case"native":return Ui(e.value);case"array":return Uy(t4(e.value));case"one-of":return tZ(e);default:return null}}function tZ(e){let t=null;return(i,r)=>YS(i,e)?i:(t==null&&(t=ZS(e)),Uc().error("Accessor#set",`Invalid property value, value needs to be of type ${t}`),r&&(r.valid=!1),null)}function ZS(e){switch(e.type){case"native":switch(e.value){case Number:return"number";case String:return"string";case Boolean:return"boolean";case Ue:return"integer";case Date:return"date";case BE:return"null";default:return Db(e.value)}case"array":return`array of ${ZS(e.value)}`;case"one-of":{const t=e.values.map((i=>ZS(i)));return`one of ${t.slice(0,-1)} or ${t[t.length-1]}`}}return"unknown"}function YS(e,t){if(e==null)return!0;switch(t.type){case"native":switch(t.value){case Number:case Ue:return typeof e=="number";case Boolean:return typeof e=="boolean";case String:return typeof e=="string";case BE:return e===null}return e instanceof t.value;case"array":return!!Array.isArray(e)&&!e.some((i=>!YS(i,t.value)));case"one-of":return t.values.some((i=>YS(e,i)))}}function f(e={}){return(t,i)=>{if(t===Function.prototype)throw new Error(`Inappropriate use of @property() on a static field: ${t.name}.${i}. Accessor does not support static properties.`);const r=Object.getOwnPropertyDescriptor(t,i),s=Ag(t,i);r&&(r.get||r.set?(s.get=r.get||s.get,s.set=r.set||s.set):"value"in r&&("value"in e&&H.getLogger("esri.core.accessorSupport.decorators.property").warn(`@property() will redefine the value of "${i}" on "${t.constructor.name}" already defined in the metadata`,e),s.value=e.value=r.value)),e.readOnly!=null&&(s.readOnly=e.readOnly);const n=e.aliasOf;if(n){const l=typeof n=="string"?n:n.source,u=typeof n=="string"?null:n.overridable===!0;let c;s.dependsOn=[l],s.get=function(){let d=Mn(this,l);if(typeof d=="function"){c||(c=l.split(".").slice(0,-1).join("."));const m=Mn(this,c);m&&(d=d.bind(m))}return d},s.readOnly||(s.set=u?function(d){this._override(i,d)}:function(d){Z1(this,l,d)})}const o=e.type,a=e.types;if(!s.cast){let l;o?l=iZ(o):a&&(l=Array.isArray(a)?Uy(hu(a[0])):hu(a)),e.cast=rZ(e.cast,l)}XH(s,e),e.range&&(s.cast=ZW(s.cast,e.range))}}function qE(e,t,i){const r=Ag(e,i);r.json||(r.json={});let s=r.json;return t!==void 0&&(s.origins||(s.origins={}),s.origins[t]||(s.origins[t]={}),s=s.origins[t]),s}function iZ(e){let t=0,i=e;if(eZ(e))return t4(e);for(;Array.isArray(i)&&i.length===1&&typeof i[0]!="string"&&typeof i[0]!="number";)i=i[0],t++;const r=i;if(e4(r))return t===0?WS(r):tv(WS(r),t);if(t===1)return KW(r);if(t>1)return QW(r,t);const s=e;return s.from?s.from:Ui(s)}function rZ(e,t){if(e||t)return e?t?(i,r)=>t(e(i,r),r):e:t}function sZ(e){if(e.json&&e.json.origins){const t=e.json.origins,i={"web-document":["web-scene","web-map"]};for(const r in i)if(t[r]){const s=t[r];i[r].forEach((n=>{t[n]=s})),delete t[r]}}}let Bs=class extends ZN{constructor(t,i,r){super(t,i,r)}};Bs.prototype.type="warning";function i4(e){return!!e&&e.prototype?.declaredClass&&e.prototype.declaredClass.indexOf("esri.core.Collection")===0}const JS=()=>H.getLogger("esri.core.accessorSupport.extensions.serializableProperty.reader");function s3(e,t,i){e&&(!i&&!t.read||t.read?.reader||t.read?.enabled===!1||aZ(e)&&wu("read.reader",Rg(e),t))}function Rg(e){const t=e.ndimArray??0;if(t>1)return oZ(e);if(t===1)return n3(e);if("type"in e&&s4(e.type)){const i=e.type.prototype?.itemType?.Type,r=n3(typeof i=="function"?{type:i}:{types:i});return(s,n,o)=>{const a=r(s,n,o);return a&&new e.type(a)}}return HE(e)}function HE(e){return"type"in e?nZ(e.type):lZ(e.types)}function nZ(e){return e.prototype.read?(t,i,r)=>{if(t==null)return t;const s=typeof t;if(s!=="object")return void JS().error(`Expected JSON value of type 'object' to deserialize type '${e.prototype.declaredClass}', but got '${s}'`);const n=new e;return n.read(t,r),n}:e.fromJSON}function r4(e,t,i,r){return r!==0&&Array.isArray(t)?t.map((s=>r4(e,s,i,r-1))):e(t,void 0,i)}function oZ(e){const t=HE(e),i=r4.bind(null,t),r=e.ndimArray??0;return(s,n,o)=>{if(s==null)return s;s=i(s,o,r);let a=r,l=s;for(;a>0&&Array.isArray(l);)a--,l=l[0];if(l!==void 0)for(let u=0;u<a;u++)s=[s];return s}}function n3(e){const t=HE(e);return(i,r,s)=>{if(i==null)return i;if(Array.isArray(i)){const o=[];for(const a of i){const l=t(a,void 0,s);l!==void 0&&o.push(l)}return o}const n=t(i,void 0,s);return n!==void 0?[n]:void 0}}function s4(e){if(!i4(e))return!1;const t=e.prototype.itemType;return!(!t||!t.Type)&&(typeof t.Type=="function"?WE(t.Type):n4(t.Type))}function aZ(e){return"types"in e?n4(e.types):WE(e.type)}function WE(e){return!Array.isArray(e)&&!!e&&e.prototype&&("read"in e.prototype||"fromJSON"in e||s4(e))}function n4(e){for(const t in e.typeMap)if(!WE(e.typeMap[t]))return!1;return!0}function lZ(e){let t=null;const i=e.errorContext??"type",r=e.validate;return(s,n,o)=>{if(s==null)return s;const a=typeof s;if(a!=="object")return void JS().error(`Expected JSON value of type 'object' to deserialize, but got '${a}'`);t||(t=uZ(e));const l=e.key;if(typeof l!="string")return;const u=s[l],c=u?t[u]:e.defaultKeyValue?e.typeMap[e.defaultKeyValue]:void 0;if(!c){const m=`Type '${u||"unknown"}' is not supported`;return o?.messages&&s&&o.messages.push(new Bs(`${i}:unsupported`,m,{definition:s,context:o})),void JS().error(m)}const d=new c;return d.read(s,o),r?r(d):d}}function uZ(e){const t={};for(const i in e.typeMap){const r=e.typeMap[i],s=Ig(r.prototype);if(typeof e.key=="function")continue;const n=s[e.key];if(!n)continue;if(n.json?.type&&Array.isArray(n.json.type)&&n.json.type.length===1&&typeof n.json.type[0]=="string"){t[n.json.type[0]]=r;continue}const o=n.json?.write;if(!o?.writer){t[i]=r;continue}const a=o.target,l=typeof a=="string"?a:e.key,u={};o.writer(i,u,l),u[l]&&(t[u[l]]=r)}return t}function cZ(e){if(e.json||(e.json={}),a3(e.json),l3(e.json),o3(e.json),e.json.origins)for(const t in e.json.origins)a3(e.json.origins[t]),l3(e.json.origins[t]),o3(e.json.origins[t]);return!0}function o3(e){e.name&&(e.read&&typeof e.read=="object"?e.read.source===void 0&&(e.read.source=e.name):e.read={source:e.name},e.write&&typeof e.write=="object"?e.write.target===void 0&&(e.write.target=e.name):e.write={target:e.name})}function a3(e){typeof e.read=="boolean"?e.read={enabled:e.read}:typeof e.read=="function"?e.read={enabled:!0,reader:e.read}:e.read&&typeof e.read=="object"&&e.read.enabled===void 0&&(e.read.enabled=!0)}function l3(e){typeof e.write=="boolean"?e.write={enabled:e.write}:typeof e.write=="function"?e.write={enabled:!0,writer:e.write}:e.write&&typeof e.write=="object"&&e.write.enabled===void 0&&(e.write.enabled=!0)}function u3(e,t){if(!t.write||t.write.writer||t.write.enabled===!1&&!t.write.overridePolicy)return;const i=e?.ndimArray??0;e&&(i===1||"type"in e&&i4(e.type))?t.write.writer=pZ:i>1?t.write.writer=fZ(i):t.types?Array.isArray(t.types)?t.write.writer=dZ(t.types[0]):t.write.writer=hZ(t.types):t.write.writer=jy}function hZ(e){return(t,i,r,s)=>t?o4(t,e,s)?jy(t,i,r,s):void 0:jy(t,i,r,s)}function o4(e,t,i){for(const r in t.typeMap)if(e instanceof t.typeMap[r])return!0;if(i?.messages){const r=t.errorContext??"type",s=`Values of type '${(typeof t.key!="function"?e[t.key]:e.declaredClass)??"Unknown"}' cannot be written`;i&&i.messages&&e&&i.messages.push(new j(`${r}:unsupported`,s,{definition:e,context:i})),H.getLogger("esri.core.accessorSupport.extensions.serializableProperty.writer").error(s)}return!1}function dZ(e){return(t,i,r,s)=>!t||!Array.isArray(t)?jy(t,i,r,s):jy(t.filter((n=>o4(n,e,s))),i,r,s)}function jy(e,t,i,r){wu(i,iv(e,r),t)}function iv(e,t){return e&&typeof e.write=="function"?e.write({},t):e&&typeof e.toJSON=="function"?e.toJSON():typeof e=="number"?rv(e):e}function rv(e){return e===-1/0?-Number.MAX_VALUE:e===1/0?Number.MAX_VALUE:isNaN(e)?null:e}function pZ(e,t,i,r){let s;e===null?s=null:e&&typeof e.map=="function"?(s=e.map((n=>iv(n,r))),typeof s.toArray=="function"&&(s=s.toArray())):s=[iv(e,r)],wu(i,s,t)}function a4(e,t,i){return i!==0&&Array.isArray(e)?e.map((r=>a4(r,t,i-1))):iv(e,t)}function fZ(e){return(t,i,r,s)=>{let n;if(t===null)n=null;else{n=a4(t,s,e);let o=e,a=n;for(;o>0&&Array.isArray(a);)o--,a=a[0];if(a!==void 0)for(let l=0;l<o;l++)n=[n]}wu(r,n,i)}}function mZ(e,t){return ZE(e,"any",t?.origin)}function XS(e,t){return ZE(e,"read",t?.origin)}function l4(e,t){return ZE(e,"write",t?.origin)}function ZE(e,t,i){let r=e?.json;if(r?.origins&&i){let s;s=i==="link-chart"?r.origins[i]&&(t==="any"||t in r.origins[i])?r.origins[i]:r.origins["web-map"]:r.origins[i],s&&(t==="any"||t in s)&&(r=s)}return r}function yZ(e){const t=gZ(e);if(e.json.origins)for(const i in e.json.origins){const r=e.json.origins[i],s=r.types?_Z(r):t;s3(s,r,!1),r.types&&!r.write&&e.json.write?.enabled&&(r.write={...e.json.write}),u3(s,r)}s3(t,e.json,!0),u3(t,e.json)}function gZ(e){return e.json.types?KS(e.json):e.type?u4(e):KS(e)}function _Z(e){return e.type?u4(e):KS(e)}function u4(e){if(!e.type)return;let t=0,i=e.type;for(;Array.isArray(i)&&!e4(i);)i=i[0],t++;return{type:i,ndimArray:t}}function KS(e){if(!e.types)return;let t=0,i=e.types;for(;Array.isArray(i);)i=i[0],t++;return{types:i,ndimArray:t}}function vZ(e){cZ(e)&&(sZ(e),yZ(e))}const Hw=new Set,Ww=new Set;function I(e){return t=>{e??="esri.core.Accessor",t.prototype.declaredClass=e,wZ(t);const i=[],r=[];let s=t.prototype;for(;s;)s.hasOwnProperty("initialize")&&!Hw.has(s.initialize)&&(Hw.add(s.initialize),i.push(s.initialize)),s.hasOwnProperty("destroy")&&!Ww.has(s.destroy)&&(Ww.add(s.destroy),r.push(s.destroy)),s=Object.getPrototypeOf(s);Hw.clear(),Ww.clear();const n=class extends t{constructor(...a){if(super(...a),this.constructor===n&&typeof this.postscript=="function"){if(i.length&&Object.defineProperty(this,"initialize",{enumerable:!1,configurable:!0,value(){for(let l=i.length-1;l>=0;l--)i[l].call(this)}}),r.length){let l=!1;const u=this[AD];Object.defineProperty(this,"destroy",{enumerable:!1,configurable:!0,value(){if(!l){this.__accessor__.lifecycle=ls.DESTROYING,l=!0,u.call(this);for(let c=0;c<r.length;c++)r[c].call(this)}}})}Object.defineProperty(this,Symbol.dispose,{enumerable:!1,configurable:!0,value(){this.destroy()}}),this.postscript()}}};n.__accessorMetadata__=Ig(t.prototype),n.prototype.declaredClass=e;const o=(e||"AccessorSubclass").split(".").slice(-1)[0];return Object.defineProperty(n,"name",{value:o,configurable:!0}),n}}function bZ(e,t){return t.get==null?function(){const i=this.__accessor__,r=i.propertiesByName.get(e);if(r===void 0)return;i.mutable&&ge(r);const s=i.store;return s.has(e)?s.get(e):r.metadata.value}:function(){const i=this.__accessor__,r=i.propertiesByName.get(e);if(r!==void 0)return r.getComputed(i)}}function wZ(e){const t=e.prototype,i=Ig(t),r={};for(const s of Object.getOwnPropertyNames(i)){const n=i[s];vZ(n),r[s]={enumerable:!0,configurable:!0,get:bZ(s,n),set(o){const a=this.__accessor__;if(a!==void 0){if(a.mutable)return a.initialized&&n.readOnly?c3("read-only",s):a.lifecycle===ls.CONSTRUCTED&&n.constructOnly?c3("construct-only",s):void a.set(s,o)}else Object.defineProperty(this,s,{enumerable:!0,configurable:!0,writable:!0,value:o})}}}Object.defineProperties(e.prototype,r)}const c3=(e,t)=>{H.getLogger("esri.core.Accessor").error(`cannot assign to ${e} property '${t}'`)};var h3,d3;function SZ(e){if(e==null)return{value:e};if(Array.isArray(e))return{type:[e[0]],value:null};switch(typeof e){case"object":return e.constructor?.__accessorMetadata__||e instanceof Date?{type:e.constructor,value:e}:e;case"boolean":return{type:Boolean,value:e};case"string":return{type:String,value:e};case"number":return{type:Number,value:e};case"function":return{type:e,value:null};default:return}}const il=Symbol("Accessor-Handles"),Zw=Symbol("Accessor-Initialized");var uu;let le=(uu=class{static createSubclass(t={}){if(Array.isArray(t))throw new Error("Multi-inheritance unsupported since 4.16");const{properties:i,declaredClass:r,constructor:s}=t;delete t.declaredClass,delete t.properties,delete t.constructor;const n=this;class o extends n{constructor(...l){super(...l),this.inherited=null,s&&s.apply(this,l)}}Ig(o.prototype);for(const a in t){const l=t[a];o.prototype[a]=typeof l=="function"?function(...u){const c=this.inherited;let d;this.inherited=function(...m){if(n.prototype[a])return n.prototype[a].apply(this,m)};try{d=l.apply(this,u)}catch(m){throw this.inherited=c,m}return this.inherited=c,d}:t[a]}for(const a in i){const l=SZ(i[a]);f(l)(o.prototype,a)}return I(r)(o)}static freeze(t){return t instanceof uu?t.__accessor__.mutable=!1:Object.freeze(t),t}static isFrozen(t){return t instanceof uu?!t.__accessor__.mutable:Object.isFrozen(t)}constructor(...t){if(this[h3]=null,this[d3]=!1,this.constructor===uu)throw new Error("[accessor] cannot instantiate Accessor. This can be fixed by creating a subclass of Accessor");const i=new oW(this);Object.defineProperty(this,"__accessor__",{enumerable:!1,value:i}),t.length>0&&(i.ctorArgs=this.normalizeCtorArgs?.apply(this,t)??t[0])}postscript(){const t=this.__accessor__,i=t.ctorArgs;t.initialize(),i&&(this.set(i),t.ctorArgs=null),t.constructed(),this.initialize(),this[Zw]=!0}initialize(){}[AD](){this[il]=Ot(this[il])}destroy(){this.destroyed||(OW(this),this.__accessor__.destroy(),dW()?.onInstanceDestroy(this))}[Symbol.dispose](){this.destroy()}get constructed(){return this.__accessor__&&this.__accessor__.initialized||!1}get initialized(){return this[Zw]}get destroyed(){return this.__accessor__?.lifecycle===ls.DESTROYED||!1}get destroying(){return this.__accessor__?.lifecycle===ls.DESTROYING||!1}commitProperty(t){Mn(this,t)}hasOwnProperty(t){return this.__accessor__?this.__accessor__.has(t):Object.prototype.hasOwnProperty.call(this,t)}keys(){return this.__accessor__?this.__accessor__.keys():[]}set(t,i){return Z1(this,t,i),this}watch(t,i,r){return PD(H.getLogger(this),"`watch` is deprecated in favor of reactiveUtils.watch",{replacement:"reactiveUtils.watch",version:"4.32",see:"https://arcg.is/1vaqf42#watch",warnOnce:!0}),UW(this,t,i,r)}addHandles(t,i){if(this.destroyed){const r=Array.isArray(t)?t:[t];for(const s of r)s.remove();return}(this[il]??=new uf).add(t,i)}removeHandles(t){this[il]?.remove(t)}removeAllHandles(){this[il]?.removeAll()}removeHandlesReference(t){this[il]?.removeReference(t)}hasHandles(t){return this[il]?.has(t)===!0}_override(t,i){i===void 0?this.__accessor__.clearOverride(t):this.__accessor__.override(t,i)}_clearOverride(t){return this.__accessor__.clearOverride(t)}_overrideIfSome(t,i){i==null?this.__accessor__.clearOverride(t):this.__accessor__.override(t,i)}_isOverridden(t){return this.__accessor__.isOverridden(t)}notifyChange(t){this.__accessor__.notifyChange(t)}_get(t){return this.__accessor__.internalGet(t)}_set(t,i){return this.__accessor__.internalSet(t,i),this}},h3=il,d3=Zw,uu),E_=class c4{constructor(){this._emitter=new c4.EventEmitter(this)}emit(t,i){return this._emitter.emit(t,i)}on(t,i){return this._emitter.on(t,i)}once(t,i){return this._emitter.once(t,i)}hasEventListener(t){return this._emitter.hasEventListener(t)}};(function(e){class t{constructor(s=null){this._target=s,this._listenersMap=null}clear(){this._listenersMap?.clear(),this._listenersMap=null}destroy(){this.clear()}emit(s,n){let o=this._listenersMap?.get(s);if(!o)return!1;const a=this._target||this;let l=!1;for(const u of o.slice()){const c="deref"in u?u.deref():u;c?c?.call(a,n):l=!0}return l&&(o=o.filter((u=>!("deref"in u)||u.deref()!=null)),this._listenersMap.set(s,o)),o.length>0}on(s,n){if(Array.isArray(s)){const a=s.map((l=>this.on(l,n)));return gh(a)}if(s.includes(","))throw new TypeError("Evented.on() with a comma delimited string of event types is not supported");this._listenersMap??=new Map;const o=this._listenersMap.get(s)||[];return o.push(n),this._listenersMap.set(s,o),ze((()=>{const a=this._listenersMap?.get(s),l=a?.indexOf(n)??-1;l>=0&&a.splice(l,1)}))}once(s,n){const o=this.on(s,(a=>{o.remove(),("deref"in n?n.deref():n)?.call(null,a)}));return o}hasEventListener(s){const n=this._listenersMap?.get(s);return n!=null&&n.length>0}}e.EventEmitter=t,e.EventedMixin=r=>{let s=class extends r{constructor(){super(...arguments),this._emitter=new t}destroy(){this._emitter.clear()}emit(n,o){return this._emitter.emit(n,o)}on(n,o){return this._emitter.on(n,o)}once(n,o){return this._emitter.once(n,o)}hasEventListener(n){return this._emitter.hasEventListener(n)}};return s=h([I("esri.core.Evented")],s),s};let i=class extends le{constructor(){super(...arguments),this._emitter=new E_.EventEmitter(this)}destroy(){this._emitter.clear()}emit(r,s){return this._emitter.emit(r,s)}on(r,s){return this._emitter.on(r,s)}once(r,s){return this._emitter.once(r,s)}hasEventListener(r){return this._emitter.hasEventListener(r)}};i=h([I("esri.core.Evented.EventedAccessor")],i),e.EventedAccessor=i})(E_||(E_={}));const Ja=E_;var He;(function(e){e[e.ADD=1]="ADD",e[e.REMOVE=2]="REMOVE",e[e.MOVE=4]="MOVE"})(He||(He={}));function h4(e){return(t,i)=>{t[i]=e}}let Og=class extends ND{notify(){const t=this._observers;if(t&&t.length>0){const i=t.slice();for(const r of i)r.onInvalidated(),r.onCommitted()}}};var sa;let xZ=class{constructor(){this.target=null,this.cancellable=!1,this.defaultPrevented=!1,this.item=void 0,this.type=void 0}preventDefault(){this.cancellable&&(this.defaultPrevented=!0)}reset(t){this.defaultPrevented=!1,this.item=t}},$Z=class{constructor(t,i,r,s,n){this.target=t,this.added=i,this.removed=r,this.start=s,this.deleteCount=n}};const ys=new _h(xZ,void 0,(e=>{e.item=null,e.target=null,e.defaultPrevented=!1,e.cancellable=!1}));function p3(e){e&&typeof e=="object"&&"destroy"in e&&typeof e.destroy=="function"&&e.destroy()}function Yw(e){return e?e instanceof kl?e.toArray():e.length?Array.prototype.slice.apply(e):[]:[]}function Jw(e){if(e?.length)return e[0]}function MZ(e,t,i,r){const s=Math.min(e.length-i,t.length-r);let n=0;for(;n<s&&e[i+n]===t[r+n];)n++;return n}function d4(e,t,i,r){t&&t.forEach(((s,n,o)=>{e.push(s),d4(e,i.call(r,s,n,o),i,r)}))}const rl=new Set,sl=new Set,nl=new Set,Xw=new Map;let TZ=0;var Jc;let kl=(Jc=class extends Ja.EventedAccessor{static isCollection(t){return t!=null&&t instanceof sa}constructor(t){super(t),this._chgListeners=[],this._notifications=null,this._updating=!1,this._timer=null,this._observable=new Og,this.length=0,this._items=[],Object.defineProperty(this,"uid",{value:TZ++})}normalizeCtorArgs(t){return t?Array.isArray(t)||t instanceof sa?{items:t}:t:{}}destroy(){this._removeAllRaw(),this._timer&&this._timer.remove(),this._emitter.destroy(),this._notifications=null}*[Symbol.iterator](){yield*this.items}get items(){return ge(this._observable),this._items}set items(t){this._emitBeforeChanges(He.ADD)||(this._splice(0,this.length,Yw(t)),this._emitAfterChanges(He.ADD))}hasEventListener(t){return!this.destroyed&&(t==="change"?this._chgListeners.length>0:this._emitter.hasEventListener(t))}on(t,i){if(this.destroyed)return ze();if(t==="change"){const r=this._chgListeners,s={removed:!1,callback:i};return r.push(s),this._notifications&&this._notifications.push({listeners:r.slice(),items:this._items.slice(),changes:[]}),ze((()=>{s.removed=!0,r.splice(r.indexOf(s),1)}))}return this._emitter.on(t,i)}once(t,i){const r="deref"in i?()=>i.deref():()=>i,s=this.on(t,(n=>{r()?.call(null,n),s.remove()}));return s}add(t,i){if(ge(this._observable),this._emitBeforeChanges(He.ADD))return this;const r=this.getNextIndex(i??null);return this._splice(r,0,[t]),this._emitAfterChanges(He.ADD),this}addMany(t,i=this._items.length){if(ge(this._observable),!t?.length)return this;if(this._emitBeforeChanges(He.ADD))return this;const r=this.getNextIndex(i);return this._splice(r,0,Yw(t)),this._emitAfterChanges(He.ADD),this}at(t){if(ge(this._observable),(t=Math.trunc(t)||0)<0&&(t+=this.length),!(t<0||t>=this.length))return this._items[t]}removeAll(){if(ge(this._observable),!this.length||this._emitBeforeChanges(He.REMOVE))return[];const t=this._removeAllRaw();return this._emitAfterChanges(He.REMOVE),t}_removeAllRaw(){return this.length===0?[]:this._splice(0,this.length)||[]}clone(){return ge(this._observable),this._createNewInstance({items:this._items.map(V)})}concat(...t){ge(this._observable);const i=t.map(Yw);return this._createNewInstance({items:this._items.concat(...i)})}drain(t,i){if(ge(this._observable),!this.length||this._emitBeforeChanges(He.REMOVE))return;const r=this._splice(0,this.length),s=r.length;for(let n=0;n<s;n++)t.call(i,r[n],n,r);this._emitAfterChanges(He.REMOVE)}destroyAll(){this.drain(p3)}destroyMany(t){const i=this.removeMany(t);return i.forEach(p3),i}every(t,i){return ge(this._observable),this._items.every(t,i)}filter(t,i){ge(this._observable);const r=arguments.length===2?this._items.filter(t,i):this._items.filter(t);return this._createNewInstance({items:r})}find(t,i){return ge(this._observable),this._items.find(t,i)}findIndex(t,i){return ge(this._observable),this._items.findIndex(t,i)}flatten(t,i){ge(this._observable);const r=[];return d4(r,this,t,i),new sa(r)}forEach(t,i){return ge(this._observable),this._items.forEach(t,i)}getItemAt(t){return ge(this._observable),this._items[t]}getNextIndex(t){ge(this._observable);const i=this.length;return(t=t??i)<0?t=0:t>i&&(t=i),t}includes(t,i=0){return ge(this._observable),this._items.includes(t,i)}indexOf(t,i=0){return ge(this._observable),this._items.indexOf(t,i)}join(t=","){return ge(this._observable),this._items.join(t)}lastIndexOf(t,i=this.length-1){return ge(this._observable),this._items.lastIndexOf(t,i)}map(t,i){ge(this._observable);const r=this._items.map(t,i);return new sa({items:r})}reorder(t,i=this.length-1){ge(this._observable);const r=this.indexOf(t);if(r!==-1){if(i<0?i=0:i>=this.length&&(i=this.length-1),r!==i){if(this._emitBeforeChanges(He.MOVE))return t;this._splice(r,1),this._splice(i,0,[t]),this._emitAfterChanges(He.MOVE)}return t}}pop(){if(ge(this._observable),!this.length||this._emitBeforeChanges(He.REMOVE))return;const t=Jw(this._splice(this.length-1,1));return this._emitAfterChanges(He.REMOVE),t}push(...t){return ge(this._observable),this._emitBeforeChanges(He.ADD)||(this._splice(this.length,0,t),this._emitAfterChanges(He.ADD)),this.length}reduce(t,i){ge(this._observable);const r=this._items;return arguments.length===2?r.reduce(t,i):r.reduce(t)}reduceRight(t,i){ge(this._observable);const r=this._items;return arguments.length===2?r.reduceRight(t,i):r.reduceRight(t)}remove(t){return ge(this._observable),this.removeAt(this.indexOf(t))}removeAt(t){if(ge(this._observable),t<0||t>=this.length||this._emitBeforeChanges(He.REMOVE))return;const i=Jw(this._splice(t,1));return this._emitAfterChanges(He.REMOVE),i}removeMany(t){if(ge(this._observable),!t?.length||this._emitBeforeChanges(He.REMOVE))return[];const i=t instanceof sa?t.toArray():t,r=this._items,s=[],n=i.length;for(let o=0;o<n;o++){const a=i[o],l=r.indexOf(a);if(l>-1){const u=1+MZ(i,r,o+1,l+1),c=this._splice(l,u);c&&c.length>0&&s.push.apply(s,c),o+=u-1}}return this._emitAfterChanges(He.REMOVE),s}reverse(){if(ge(this._observable),this._emitBeforeChanges(He.MOVE))return this;const t=this._splice(0,this.length);return t&&(t.reverse(),this._splice(0,0,t)),this._emitAfterChanges(He.MOVE),this}shift(){if(ge(this._observable),!this.length||this._emitBeforeChanges(He.REMOVE))return;const t=Jw(this._splice(0,1));return this._emitAfterChanges(He.REMOVE),t}slice(t=0,i=this.length){return ge(this._observable),this._createNewInstance({items:this._items.slice(t,i)})}some(t,i){return ge(this._observable),this._items.some(t,i)}sort(t){if(ge(this._observable),!this.length||this._emitBeforeChanges(He.MOVE)||!this._requiresSort(t))return this;const i=this._splice(0,this.length);return arguments.length?i.sort(t):i.sort(),this._splice(0,0,i),this._emitAfterChanges(He.MOVE),this}_requiresSort(t=(i,r)=>i===r?0:i<r?-1:1){const i=this.length-1;for(let r=0;r<i;r++)if(t(this.items[r],this.items[r+1])>0)return!0;return!1}splice(t,i,...r){ge(this._observable),arguments.length===1&&(i=this.length),i??=0;const s=(i?He.REMOVE:0)|(r.length?He.ADD:0);if(this._emitBeforeChanges(s))return[];const n=this._splice(t,i,r)||[];return this._emitAfterChanges(s),n}toArray(){return ge(this._observable),this._items.slice()}toJSON(t){return ge(this._observable),this.toArray().map((i=>zy(i)?i.toJSON(t):i))}toLocaleString(){return ge(this._observable),this._items.toLocaleString()}toString(){return ge(this._observable),this._items.toString()}unshift(...t){return ge(this._observable),!t.length||this._emitBeforeChanges(He.ADD)||(this._splice(0,0,t),this._emitAfterChanges(He.ADD)),this.length}_createNewInstance(t){return new this.constructor(t)}_splice(t,i,r){const s=this._items,n=this.itemType;let o,a;if(!this._notifications&&this.hasEventListener("change")&&(this._notifications=[{listeners:this._chgListeners.slice(),items:this._items.slice(),changes:[]}],this._timer&&this._timer.remove(),this._updating=!0,this._timer=Lg((()=>this._dispatchChange()))),t<0&&(t+=this.length),i){if(a=s.splice(t,i),this.hasEventListener("before-remove")){const l=ys.acquire();l.target=this,l.cancellable=!0;for(let u=0,c=a.length;u<c;u++)o=a[u],l.reset(o),this.emit("before-remove",l),l.defaultPrevented&&(a.splice(u,1),s.splice(t,0,o),t+=1,u-=1,c-=1);ys.release(l)}if(this.length=this._items.length,this.hasEventListener("after-remove")){const l=ys.acquire();l.target=this,l.cancellable=!1;const u=a.length;for(let c=0;c<u;c++)l.reset(a[c]),this.emit("after-remove",l);ys.release(l)}}if(r?.length){if(n){const d=[];for(const m of r){const y=n.ensureType(m);y==null&&m!=null||d.push(y)}r=d}const l=this.hasEventListener("before-add"),u=this.hasEventListener("after-add"),c=t===this.length;if(l||u){const d=ys.acquire();d.target=this,d.cancellable=!0;const m=ys.acquire();m.target=this,m.cancellable=!1;for(const y of r)l?(d.reset(y),this.emit("before-add",d),d.defaultPrevented||(c?s.push(y):s.splice(t++,0,y),this._set("length",s.length),u&&(m.reset(y),this.emit("after-add",m)))):(c?s.push(y):s.splice(t++,0,y),this._set("length",s.length),m.reset(y),this.emit("after-add",m));ys.release(m),ys.release(d)}else{if(c)for(const d of r)s.push(d);else s.splice(t,0,...r);this._set("length",s.length)}}if((r?.length||a?.length)&&this._notifyChangeEvent(r,a),this.hasEventListener("after-splice")){const l=new $Z(this,r,a,t,i);this.emit("after-splice",l)}return a}_emitBeforeChanges(t){let i=!1;if(this.hasEventListener("before-changes")){const r=ys.acquire();r.target=this,r.cancellable=!0,r.type=t,this.emit("before-changes",r),i=r.defaultPrevented,ys.release(r)}return i}_emitAfterChanges(t){if(this.hasEventListener("after-changes")){const i=ys.acquire();i.target=this,i.cancellable=!1,i.type=t,this.emit("after-changes",i),ys.release(i)}this._observable.notify()}_notifyChangeEvent(t,i){this.hasEventListener("change")&&this._notifications&&this._notifications[this._notifications.length-1].changes.push({added:t,removed:i})}get updating(){return this._updating}_dispatchChange(){if(this._timer&&(this._timer.remove(),this._timer=null),this._updating=!1,!this._notifications)return;const t=this._notifications;this._notifications=null;for(const i of t){const r=i.changes;rl.clear(),sl.clear(),nl.clear();for(const{added:u,removed:c}of r){if(u)if(nl.size===0&&sl.size===0)for(const d of u)rl.add(d);else for(const d of u)sl.has(d)?(nl.add(d),sl.delete(d)):nl.has(d)||rl.add(d);if(c)if(nl.size===0&&rl.size===0)for(const d of c)sl.add(d);else for(const d of c)rl.has(d)?rl.delete(d):(nl.delete(d),sl.add(d))}const s=Sr.acquire();rl.forEach((u=>{s.push(u)}));const n=Sr.acquire();sl.forEach((u=>{n.push(u)}));const o=this._items,a=i.items,l=Sr.acquire();if(nl.forEach((u=>{a.indexOf(u)!==o.indexOf(u)&&l.push(u)})),i.listeners&&(s.length||n.length||l.length)){const u={target:this,added:s,removed:n,moved:l},c=i.listeners.length;for(let d=0;d<c;d++){const m=i.listeners[d];m.removed||m.callback.call(this,u)}}Sr.release(s),Sr.release(n),Sr.release(l)}rl.clear(),sl.clear(),nl.clear()}},sa=Jc,Jc.ofType=t=>{if(!t)return sa;if(Xw.has(t))return Xw.get(t);let i=null;if(typeof t=="function")i=t.prototype.declaredClass;else if(t.base)i=t.base.prototype.declaredClass;else for(const s in t.typeMap){const n=t.typeMap[s].prototype.declaredClass;i?i+=` | ${n}`:i=n}let r=class extends sa{};return h([h4({Type:t,ensureType:typeof t=="function"?Ui(t):hu(t)})],r.prototype,"itemType",void 0),r=h([I(`esri.core.Collection<${i}>`)],r),Xw.set(t,r),r},Jc);h([f()],kl.prototype,"_updating",void 0),h([f()],kl.prototype,"length",void 0),h([f()],kl.prototype,"items",null),h([f({readOnly:!0})],kl.prototype,"updating",null),kl=sa=h([I("esri.core.Collection")],kl);const ne=kl;function Ha(e,t,i=ne){return t||(t=new i),t===e||(t.removeAll(),EZ(e)?t.addMany(e):e&&t.add(e)),t}function p4(e){return e}function EZ(e){return e&&(Array.isArray(e)||"items"in e&&Array.isArray(e.items))}let CZ=class f4{constructor(){this._values=new Map,this.multipleOriginsSupported=!1}clone(t){const i=new f4;return this._values.forEach(((r,s)=>{t&&t.has(s)||i.set(s,V(r.value),r.origin)})),i}get(t,i){i=this._normalizeOrigin(i);const r=this._values.get(t);return i==null||r?.origin===i?r?.value:void 0}originOf(t){return this._values.get(t)?.origin??Ie.USER}keys(t){t=this._normalizeOrigin(t);const i=[...this._values.keys()];return t==null?i:i.filter((r=>this._values.get(r)?.origin===t))}set(t,i,r){if((r=this._normalizeOrigin(r))===Ie.DEFAULTS){const s=this._values.get(t);if(s?.origin!=null&&s.origin>r)return}this._values.set(t,new PZ(i,r))}delete(t,i){(i=this._normalizeOrigin(i))!=null&&this._values.get(t)?.origin!==i||this._values.delete(t)}has(t,i){return(i=this._normalizeOrigin(i))!=null?this._values.get(t)?.origin===i:this._values.has(t)}isAtOrigin(t,i){return i=this._normalizeOrigin(i),this.has(t,i)&&this.originOf(t)===i}isBelowOrigin(t,i){return i=this._normalizeOrigin(i),!this.has(t)||this.originOf(t)<i}forEach(t){this._values.forEach((({value:i},r)=>t(i,r)))}_normalizeOrigin(t){if(t!=null)return t===Ie.DEFAULTS?t:Ie.USER}},PZ=class{constructor(t,i){this.value=t,this.origin=i}};function IZ(e,t,i){t.keys().forEach((s=>{i.set(s,t.get(s),Ie.DEFAULTS)}));const r=e.metadata;Object.keys(r).forEach((s=>{e.internalGet(s)&&i.set(s,e.internalGet(s),Ie.DEFAULTS)}))}function AZ(e,t,i){if(!e?.read||e.read.enabled===!1||!e.read.source)return!1;const r=e.read.source;if(typeof r=="string"){if(r===t||r.includes(".")&&r.indexOf(t)===0&&WI(r,i))return!0}else for(const s of r)if(s===t||s.includes(".")&&s.indexOf(t)===0&&WI(s,i))return!0;return!1}function LZ(e){return e&&(!e.read||e.read.enabled!==!1&&!e.read.source)}function kZ(e,t,i,r,s){let n=XS(t[i],s);LZ(n)&&(e[i]=!0);for(const o of Object.getOwnPropertyNames(t))n=XS(t[o],s),AZ(n,i,r)&&(e[o]=!0)}function RZ(e,t,i,r){const s=i.metadata,n=mZ(s[t],r),o=n?.default;if(o===void 0)return;const a=typeof o=="function"?o.call(e,t,r):o;a!==void 0&&i.set(t,a)}const m4={origin:"service"};function OZ(e,t,i=m4){if(!t||typeof t!="object")return;const r=Ba(e),s=r.metadata,n={};for(const o of Object.getOwnPropertyNames(t))kZ(n,s,o,t,i);r.setDefaultOrigin(i.origin);for(const o of Object.getOwnPropertyNames(n)){const a=XS(s[o],i).read,l=a?.source;let u;u=l&&typeof l=="string"?Pg(t,l):t[o],a?.reader&&(u=a.reader.call(e,u,t,i)),u!==void 0&&r.set(o,u)}if(!i||!i.ignoreDefaults){r.setDefaultOrigin("defaults");for(const o of Object.getOwnPropertyNames(s))n[o]||RZ(e,o,r,i)}r.setDefaultOrigin("user")}function sTe(e,t,i,r=m4){const s={...r,messages:[]};i(s),s.messages?.forEach((n=>{n.type!=="warning"||e.loaded?r?.messages&&r.messages.push(n):e.loadWarnings.push(n)}))}function NZ(e,t,i,r,s){const n={};return t.write?.writer?.call(e,r,n,i,s),n}function y4(e,t,i,r,s,n){if(!r?.write)return!1;const o=Mn(e,i);if(!s&&r.write.overridePolicy){const a=r.write.overridePolicy.call(e,o,i,n??void 0);a!==void 0&&(s=a)}if(s||(s=r.write),!s||s.enabled===!1||s.layerContainerTypes&&n?.layerContainerType&&!s.layerContainerTypes.includes(n.layerContainerType))return!1;if((o===null&&!s.allowNull&&!s.writerEnsuresNonNull||o===void 0)&&s.isRequired){const a=new j("web-document-write:property-required",`Missing value for required property '${i}' on '${e.declaredClass}'`,{propertyName:i,target:e});return a&&n?.messages?n.messages.push(a):a&&!n&&H.getLogger("esri.core.accessorSupport.write").error(a.name,a.message),!1}return!(o===void 0||o===null&&!s.allowNull&&!s.writerEnsuresNonNull||!s.alwaysWriteDefaults&&(!t.store.multipleOriginsSupported||t.store.originOf(i)===Ie.DEFAULTS)&&DZ(e,i,n,r,o)||!s.ignoreOrigin&&n?.origin&&t.store.multipleOriginsSupported&&t.store.originOf(i)<FE(n.origin))}function DZ(e,t,i,r,s){const n=r.default;if(n===void 0)return!1;if(r.defaultEquals!=null)return r.defaultEquals(s);if(typeof n=="function"){if(Array.isArray(s)){const o=n.call(e,t,i??void 0);return Cb(o,s)}return!1}return n===s}function nTe(e,t,i,r){const s=Ba(e),n=s.metadata,o=l4(n[t],r);return!!o&&y4(e,s,t,o,i,r)}function FZ(e,t,i){if(e&&typeof e.toJSON=="function"&&(!e.toJSON.isDefaultToJSON||!e.write))return S_(t,e.toJSON(i));const r=Ba(e),s=r.metadata;for(const n in s){const o=l4(s[n],i);if(!y4(e,r,n,o,void 0,i))continue;const a=Mn(e,n),l=NZ(e,o,o.write&&typeof o.write.target=="string"?o.write.target:n,a,i);Object.keys(l).length>0&&(t=S_(t,l),i?.resources?.pendingOperations?.length&&i.resources.pendingOperations.push(Promise.all(i.resources.pendingOperations).then((()=>S_(t,l,(()=>"replace-arrays"))))),i?.writtenProperties&&i.writtenProperties.push({target:e,propName:n,oldOrigin:iW(r.store.originOf(n)),newOrigin:i.origin}))}return t}const g4=e=>{let t=class extends e{constructor(...i){super(...i);const r=Ba(this),s=r.store,n=new CZ;r.store=n,IZ(r,s,n)}read(i,r){OZ(this,i,r)}write(i,r){return FZ(this,i??{},r)}toJSON(i){return this.write({},i)}static fromJSON(i,r){return zZ.call(this,i,r)}};return t=h([I("esri.core.JSONSupport")],t),t.prototype.toJSON.isDefaultToJSON=!0,t};function zZ(e,t){if(!e)return null;if(e.declaredClass)throw new Error("JSON object is already hydrated");const i=new this;return i.read(e,t),i}let hm=class extends g4(le){};hm=h([I("esri.core.JSONSupport")],hm),(function(e){e.JSONSupportMixin=g4})(hm||(hm={}));const ee=hm;var Rl;(function(e){e[e.PENDING=0]="PENDING",e[e.RESOLVED=1]="RESOLVED",e[e.REJECTED=2]="REJECTED"})(Rl||(Rl={}));let VZ=class{constructor(){this._resolver=Gs(),this._status=Rl.PENDING,this._resolvingPromises=[],this._resolver.promise.then((()=>{this._status=Rl.RESOLVED,this._cleanUp()}),(()=>{this._status=Rl.REJECTED,this._cleanUp()})),this.promise=this._resolver.promise}destroy(){this._cleanUp()}addResolvingPromise(t){this._resolvingPromises.push(t),this._tryResolve()}isResolved(){return this._status===Rl.RESOLVED}isRejected(){return this._status===Rl.REJECTED}isFulfilled(){return this._status!==Rl.PENDING}abort(){this._resolver.reject(yt())}_cleanUp(){this._allPromise=null,this._resolvingPromises=null}_tryResolve(){if(this.isFulfilled())return;const t=Gs(),i=[...this._resolvingPromises,t.promise],r=this._allPromise=Promise.all(i);r.then((()=>{this.isFulfilled()||this._allPromise!==r||this._resolver.resolve()}),(s=>{this.isFulfilled()||this._allPromise!==r||Er(s)||this._resolver.reject(s)})),t.resolve()}};const _4=e=>{let t=class extends e{constructor(...i){super(...i),this._promiseProps=new VZ,this.addResolvingPromise(Promise.resolve())}destroy(){this._promiseProps.destroy()}isResolved(){return this._promiseProps.isResolved()}isRejected(){return this._promiseProps.isRejected()}isFulfilled(){return this._promiseProps.isFulfilled()}when(i,r){return this._promiseProps.promise.then((()=>this)).then(i,r)}catch(i){return this.when(null,i)}addResolvingPromise(i){i&&!this._promiseProps.isFulfilled()&&this._promiseProps.addResolvingPromise("_promiseProps"in i?i.when():i)}};return t=h([I("esri.core.Promise")],t),t};let Xl=class extends _4(le){};Xl=h([I("esri.core.Promise")],Xl),(function(e){e.EsriPromiseMixin=_4})(Xl||(Xl={}));const UZ="not-loaded",jZ="loading",GZ="failed",f3="loaded",v4=e=>{let t=class extends e{constructor(...i){super(...i),this._loadController=null,this.loadError=null,this.loadStatus="not-loaded",this._set("loadWarnings",[]),this.addResolvingPromise(new Promise((r=>{const s=this.load.bind(this);this.load=n=>{const o=new Promise(((a,l)=>{const u=LE(n,l);this.destroyed&&l(new j("load:instance-destroyed",`Instance of '${this.declaredClass||this.constructor.name}' is already destroyed`,{instance:this})),this.when(a,l).finally((()=>{u&&u.remove()}))}));if(this.loadStatus===UZ){this._set("loadStatus",jZ);const a=this._loadController=new AbortController;s({signal:a.signal})}return r(),o}}))),this.when((()=>{this._set("loadStatus",f3),this._loadController=null}),(r=>{this._set("loadStatus",GZ),this._set("loadError",r),this._loadController=null}))}destroy(){this._loadController&&(this._loadController=Lp(this._loadController),this._promiseProps.abort()),this._set("loadError",null),this._set("loadWarnings",[])}get loaded(){return this.loadStatus===f3}get loadWarnings(){return this._get("loadWarnings")}load(){return null}cancelLoad(){return this.isFulfilled()||(this._set("loadError",new j("load:cancelled","Cancelled")),this._loadController?.abort(),this._promiseProps.abort()),this}};return h([f({readOnly:!0})],t.prototype,"loaded",null),h([f({readOnly:!0})],t.prototype,"loadError",void 0),h([f({clonable:!1})],t.prototype,"loadStatus",void 0),h([f({type:[Bs],readOnly:!0})],t.prototype,"loadWarnings",null),t=h([I("esri.core.Loadable")],t),t};let Ns=class extends v4(Xl){};Ns=h([I("esri.core.Loadable")],Ns),(function(e){function t(i){return!(!i||!i.load)}e.LoadableMixin=v4,e.isLoadable=t})(Ns||(Ns={}));function BZ(e,t,i){return kE(e.map(((r,s)=>t.apply(i,[r,s]))))}async function qZ(e,t,i){return(await kE(e.map(((r,s)=>t.apply(i,[r,s]))))).map((r=>r.value))}function YE(e){return{ok:!0,value:e}}function JE(e){return{ok:!1,error:e}}function HZ(e){return e!=null&&e.ok===!0?e.value:null}function WZ(e){return e!=null&&e.ok===!1?e.error:null}async function b4(e){if(e==null)return{ok:!1,error:new Error("no promise provided")};try{return YE(await e)}catch(t){return JE(t)}}async function cTe(e){try{return YE(await e)}catch(t){return AE(t),JE(t)}}function XE(e,t){return new gl(e,t)}let gl=class extends le{get value(){return HZ(this._result)}get error(){return WZ(this._result)}get finished(){return this._result!=null}constructor(t,i){super({}),this._result=null,this._abortHandle=null,this.abort=()=>{this._abortController=Lp(this._abortController)},this.remove=this.abort,this._abortController=new AbortController;const{signal:r}=this._abortController;this.promise=t(r),this.promise.then((s=>{this._result=YE(s),this._cleanup()}),(s=>{this._result=JE(s),this._cleanup()})),this._abortHandle=kn(i,this.abort)}normalizeCtorArgs(){return{}}destroy(){this.abort()}_cleanup(){this._abortHandle=St(this._abortHandle),this._abortController=null}};h([f()],gl.prototype,"value",null),h([f()],gl.prototype,"error",null),h([f()],gl.prototype,"finished",null),h([f()],gl.prototype,"promise",void 0),h([f()],gl.prototype,"_result",void 0),gl=h([I("esri.core.asyncUtils.ReactiveTask")],gl);async function w4(e,t){return await e.load(),ZZ(e,t)}async function ZZ(e,t){const i=[],r=(...n)=>{for(const o of n)o!=null&&(Array.isArray(o)?r(...o):ne.isCollection(o)?o.forEach((a=>r(a))):Ns.isLoadable(o)&&i.push(o))};t(r);let s=null;if(await qZ(i,(async n=>{const o=await b4(YZ(n)?n.loadAll():n.load());o.ok!==!1||s||(s=o)})),s)throw s.error;return e}function YZ(e){return"loadAll"in e&&typeof e.loadAll=="function"}function $e(e,t,i){let r,s;return t===void 0?(s=e,r=[void 0]):typeof t!="string"?(s=e,r=[void 0],i=t):(s=t,r=Array.isArray(e)?e:[e]),(n,o)=>{const a=n.constructor.prototype;for(const l of r){const u=qE(n,l,s);u.write&&typeof u.write=="object"||(u.write={}),i&&(u.write.target=i),u.write.writer=a[o]}}}let Ye=class{constructor(t,i={ignoreUnknown:!1,useNumericKeys:!1}){this._jsonToAPI=t,this._options=i,this.apiValues=[],this.jsonValues=[],this._apiToJSON=JZ(t),this.apiValues=m3(this._apiToJSON),this.jsonValues=m3(this._jsonToAPI),this.read=r=>this.fromJSON(r),this.write=(r,s,n)=>{const o=this.toJSON(r);o!==void 0&&wu(n,o,s)},this.write.isJSONMapWriter=!0}toJSON(t){if(t==null)return null;if(this._apiToJSON.hasOwnProperty(t)){const i=this._apiToJSON[t];return this._options.useNumericKeys?+i:i}return this._options.ignoreUnknown?null:t}fromJSON(t){return t!=null&&this._jsonToAPI.hasOwnProperty(t)?this._jsonToAPI[t]:this._options.ignoreUnknown?void 0:t}};function JZ(e){const t={};for(const i in e)t[e[i]]=i;return t}function m3(e){const t=[];for(const i in e)t.push(i);return t.sort(),t}function cr(){return function(e,t){return new Ye(e,{ignoreUnknown:!0,...t})}}let KE=class{constructor(t,i,r,s,n,o){this.semiMajorAxis=t,this.flattening=i,this.outerAtmosphereRimWidth=r,this.atmosphereHeight=s,this.scaleHeight=n;const a=1-this.flattening;this.semiMinorAxis=this.semiMajorAxis*a,this.halfSemiMajorAxis=this.semiMajorAxis/2,this.halfCircumference=Math.PI*this.semiMajorAxis,this.metersPerDegree=this.halfCircumference/180,this.inverseFlattening=1/(1-this.flattening)-1,this.eccentricitySquared=o||2*this.flattening-this.flattening*this.flattening,this.meanRadiusSemiAxes=(2*this.semiMajorAxis+this.semiMinorAxis)/3}get radius(){return this.semiMajorAxis}};const Ft=new KE(6378137,1/298.257223563,3e5,1e5,.085,.006694379990137799),Do=new KE(3396190,1/169.8944472236118,23e4,6e4,.111),du=new KE(1737400,0,0,0,0);function vt(e){if(!Fe.assetsPath)throw H.getLogger("esri.assets").errorOnce("The API assets location needs to be set using config.assetsPath. More information: https://arcg.is/1OzLe50"),new j("assets:path-not-set","config.assetsPath is not set");return $g(Fe.assetsPath,e)}let Kw,O=null;function QE(){return!!O}function XZ(){return!!N("esri-wasm")}function S4(){return Kw||(Kw=J(()=>import("./pe-wasm-DzdsRf4N.js"),[]).then((({default:e})=>e({locateFile:t=>vt(`esri/geometry/support/${t}`)}))).then((e=>{M4(e)})),Kw)}var QS,wt;(function(e){function t(n,o,a){O.ensureCache.prepare();const l=vc(a),u=a===l,c=O.ensureFloat64(l),d=O._pe_geog_to_proj(O.getPointer(n),o,c);return d&&ql(a,o,c,u),d}function i(n,o,a,l){switch(l){case wt.PE_TRANSFORM_P_TO_G:return r(n,o,a);case wt.PE_TRANSFORM_G_TO_P:return t(n,o,a)}return 0}function r(n,o,a){return s(n,o,a,0)}function s(n,o,a,l){O.ensureCache.prepare();const u=vc(a),c=a===u,d=O.ensureFloat64(u),m=O._pe_proj_to_geog_center(O.getPointer(n),o,d,l);return m&&ql(a,o,d,c),m}e.geogToProj=t,e.projGeog=i,e.projToGeog=r,e.projToGeogCenter=s})(QS||(QS={})),(function(e){function t(){e.PE_BUFFER_MAX=O.PeDefs.prototype.PE_BUFFER_MAX,e.PE_NAME_MAX=O.PeDefs.prototype.PE_NAME_MAX,e.PE_MGRS_MAX=O.PeDefs.prototype.PE_MGRS_MAX,e.PE_USNG_MAX=O.PeDefs.prototype.PE_USNG_MAX,e.PE_DD_MAX=O.PeDefs.prototype.PE_DD_MAX,e.PE_DDM_MAX=O.PeDefs.prototype.PE_DDM_MAX,e.PE_DMS_MAX=O.PeDefs.prototype.PE_DMS_MAX,e.PE_UTM_MAX=O.PeDefs.prototype.PE_UTM_MAX,e.PE_PARM_MAX=O.PeDefs.prototype.PE_PARM_MAX,e.PE_TYPE_NONE=O.PeDefs.prototype.PE_TYPE_NONE,e.PE_TYPE_GEOGCS=O.PeDefs.prototype.PE_TYPE_GEOGCS,e.PE_TYPE_PROJCS=O.PeDefs.prototype.PE_TYPE_PROJCS,e.PE_TYPE_GEOGTRAN=O.PeDefs.prototype.PE_TYPE_GEOGTRAN,e.PE_TYPE_COORDSYS=O.PeDefs.prototype.PE_TYPE_COORDSYS,e.PE_TYPE_UNIT=O.PeDefs.prototype.PE_TYPE_UNIT,e.PE_TYPE_LINUNIT=O.PeDefs.prototype.PE_TYPE_LINUNIT,e.PE_STR_OPTS_NONE=O.PeDefs.prototype.PE_STR_OPTS_NONE,e.PE_STR_AUTH_NONE=O.PeDefs.prototype.PE_STR_AUTH_NONE,e.PE_STR_AUTH_TOP=O.PeDefs.prototype.PE_STR_AUTH_TOP,e.PE_STR_NAME_CANON=O.PeDefs.prototype.PE_STR_NAME_CANON,e.PE_STR_FMT_WKT=O.PeDefs.prototype.PE_STR_FMT_WKT,e.PE_STR_FMT_WKT2=O.PeDefs.prototype.PE_STR_FMT_WKT2,e.PE_PARM_X0=O.PeDefs.prototype.PE_PARM_X0,e.PE_PARM_ND=O.PeDefs.prototype.PE_PARM_ND,e.PE_TRANSFORM_1_TO_2=O.PeDefs.prototype.PE_TRANSFORM_1_TO_2,e.PE_TRANSFORM_2_TO_1=O.PeDefs.prototype.PE_TRANSFORM_2_TO_1,e.PE_TRANSFORM_P_TO_G=O.PeDefs.prototype.PE_TRANSFORM_P_TO_G,e.PE_TRANSFORM_G_TO_P=O.PeDefs.prototype.PE_TRANSFORM_G_TO_P,e.PE_HORIZON_RECT=O.PeDefs.prototype.PE_HORIZON_RECT,e.PE_HORIZON_POLY=O.PeDefs.prototype.PE_HORIZON_POLY,e.PE_HORIZON_LINE=O.PeDefs.prototype.PE_HORIZON_LINE,e.PE_HORIZON_DELTA=O.PeDefs.prototype.PE_HORIZON_DELTA}e.init=t})(wt||(wt={}));let x4=null;var ex;(function(e){const t={},i={},r=y=>{const g=y.getType();switch(g){case wt.PE_TYPE_GEOGCS:y=O.castObject(y,O.PeGeogcs);break;case wt.PE_TYPE_PROJCS:y=O.castObject(y,O.PeProjcs);break;case wt.PE_TYPE_GEOGTRAN:y=O.castObject(y,O.PeGeogtran);break;default:g&wt.PE_TYPE_UNIT&&(y=O.castObject(y,O.PeUnit))}return y};function s(){O.PeFactory.prototype.initialize(null)}function n(y){return o(wt.PE_TYPE_COORDSYS,y)}function o(y,g){let _=null,v=t[y];if(v||(v={},t[y]=v),v.hasOwnProperty(String(g))&&(_=v[g],O.compare(_,O.NULL)&&(_=null)),!_){const b=O.PeFactory.prototype.factoryByType(y,g);O.compare(b,O.NULL)||(_=r(b),v[g]=_)}return _}function a(y,g){let _=null,v=i[y];if(v||(v={},i[y]=v),v.hasOwnProperty(g)&&(_=v[g],O.compare(_,O.NULL)&&(_=null)),!_){const b=O.PeFactory.prototype.fromString(y,g);O.compare(b,O.NULL)||(_=r(b),v[g]=_)}return _}function l(y){return o(wt.PE_TYPE_GEOGCS,y)}function u(y){return o(wt.PE_TYPE_GEOGTRAN,y)}function c(y){return O.PeFactory.prototype.getCode(y)}function d(y){return o(wt.PE_TYPE_PROJCS,y)}function m(y){return o(wt.PE_TYPE_UNIT,y)}e.initialize=s,e.coordsys=n,e.factoryByType=o,e.fromString=a,e.geogcs=l,e.geogtran=u,e.getCode=c,e.projcs=d,e.unit=m})(ex||(ex={}));let $4=null;var sv,tx,ix,rx,sx,nx,nv,ox,ov,av,ax;function M4(e){function t(n,o,a){n[o]=a(n[o])}O=e,wt.init(),sv.init(),nv.init(),ov.init(),av.init(),x4=class extends O.PeDouble{constructor(n=NaN){super(n)}destroy(){O.destroy(this)}[Symbol.dispose](){this.destroy()}},$4=class extends O.PeGCSExtent{destroy(){O.destroy(this)}[Symbol.dispose](){this.destroy()}};const i=[O.PeAngunit,O.PeDatum,O.PeGeogcs,O.PeGeogtran,O.PeObject,O.PeParameter,O.PePrimem,O.PeProjcs,O.PeSpheroid,O.PeUnit];for(const n of i)t(n.prototype,"getName",(o=>function(){return o.call(this,new Array(wt.PE_NAME_MAX))}));for(const n of[O.PeGeogtran,O.PeProjcs])t(n.prototype,"getParameters",(o=>function(){const a=new Array(wt.PE_PARM_MAX);let l=o.call(this);for(let u=0;u<a.length;u++){const c=O.getValue(l,"*");a[u]=c?O.wrapPointer(c,O.PeParameter):null,l+=Int32Array.BYTES_PER_ELEMENT}return a}));t(O.PeHorizon.prototype,"getCoord",(n=>function(o=!1){const a=this.getSize();if(!a)return null;const l=[];return ql(l,a,n.call(this),o),l})),t(O.PeGTlistExtendedEntry.prototype,"getEntries",(n=>{const o=O._pe_getPeGTlistExtendedGTsSize();return function(){let a=null;const l=n.call(this);if(!O.compare(l,O.NULL)){a=[l];const u=this.getSteps();if(u>1){const c=O.getPointer(l);for(let d=1;d<u;d++)a.push(O.wrapPointer(c+o*d,O.PeGTlistExtendedGTs))}}return a}}));const r=O._pe_getPeHorizonSize(),s=n=>function(){let o=this._cache;if(o||(o=new Map,this._cache=o),o.has(n))return o.get(n);let a=null;const l=n.call(this);if(!O.compare(l,O.NULL)){a=[l];const u=l.getNump();if(u>1){const c=O.getPointer(l);for(let d=1;d<u;d++)a.push(O.wrapPointer(c+r*d,O.PeHorizon))}}return o.set(n,a),a};t(O.PeProjcs.prototype,"horizonGcsGenerate",s),t(O.PeProjcs.prototype,"horizonPcsGenerate",s),O.PeObject.prototype.toString=function(n=wt.PE_STR_OPTS_NONE){O.ensureCache.prepare();const o=O.getPointer(this),a=O.ensureInt8(new Array(wt.PE_BUFFER_MAX));return O.UTF8ToString(O._pe_object_to_string_ext(o,n,a))},O.PeGeogcs.prototype.destroy=function(){this.Delete(),fn(this),this.ptr=0},O.PeGeogcs.prototype[Symbol.dispose]=function(){this.destroy()},O.PeProjcs.prototype.destroy=function(){this.Delete(),fn(this),this.ptr=0},O.PeProjcs.prototype[Symbol.dispose]=function(){this.destroy()}}function fn(e){if(!e)return;const t=O.getClass(e);if(!t)return;const i=O.getCache(t);if(!i)return;const r=O.getPointer(e);r&&delete i[r]}function m0(e,t){const i=[],r=new Array(t);for(let s=0;s<e;s++)i.push(O.ensureInt8(r));return i}function vc(e){return ArrayBuffer.isView(e)?e:Array.isArray(e[0])?e.flat():e}function ql(e,t,i,r=!1){if(r)for(let s=0;s<2*t;s++)e[s]=O.getValue(i+s*Float64Array.BYTES_PER_ELEMENT,"double");else{const s=e.length===0;for(let n=0;n<t;n++)s&&(e[n]=new Array(2)),e[n][0]=O.getValue(i,"double"),e[n][1]=O.getValue(i+Float64Array.BYTES_PER_ELEMENT,"double"),i+=2*Float64Array.BYTES_PER_ELEMENT}}(function(e){let t;function i(){e.PE_GTLIST_OPTS_COMMON=O.PeGTlistExtended.prototype.PE_GTLIST_OPTS_COMMON,t=O._pe_getPeGTlistExtendedEntrySize()}function r(s,n,o,a,l,u){let c=null;const d=new O.PeInteger(u);try{const m=O.PeGTlistExtended.prototype.getGTlist(s,n,o,a,l,d);if((u=d.val)&&(c=[m],u>1)){const y=O.getPointer(m);for(let g=1;g<u;g++)c.push(O.wrapPointer(y+t*g,O.PeGTlistExtendedEntry))}}finally{O.destroy(d)}return c}e.init=i,e.getGTlist=r})(sv||(sv={})),(function(e){function t(i){if(i?.length){for(const r of i)fn(r),r.getEntries().forEach((s=>{fn(s);const n=s.getGeogtran();fn(n),n.getParameters().forEach(fn),[n.getGeogcs1(),n.getGeogcs2()].forEach((o=>{fn(o);const a=o.getDatum();fn(a),fn(a.getSpheroid()),fn(o.getPrimem()),fn(o.getUnit())}))}));O.PeGTlistExtendedEntry.prototype.Delete(i[0])}}e.destroy=t})(tx||(tx={})),(function(e){function t(i,r,s,n,o){O.ensureCache.prepare();const a=vc(s),l=s===a,u=O.ensureFloat64(a);let c=0;n&&(c=O.ensureFloat64(n));const d=O._pe_geog_to_geog(O.getPointer(i),r,u,c,o);return d&&ql(s,r,u,l),d}e.geogToGeog=t})(ix||(ix={})),(function(e){function t(n,o,a,l,u,c,d,m){O.PeLineType.prototype.geodesic_coordinate(n,o,a,l,u,c,d,m)}function i(n,o,a,l,u,c,d,m,y){O.PeLineType.prototype.geodetic_coordinate(n,o,a,l,u,c,d,m,y)}function r(n,o,a,l,u,c,d,m,y,g){O.PeLineType.prototype.geodetic_distance(n,o,a,l,u,c,d,m,y,g)}function s(n,o,a,l,u,c,d,m,y){O.PeLineType.prototype.great_elliptic_distance(n,o,a,l,u,c,d,m,y)}e.geodesicCoordinate=t,e.geodeticCoordinate=i,e.geodeticDistance=r,e.greatEllipticDistance=s})(rx||(rx={})),(function(e){function t(o,a){return O.PeMath.prototype.phi_to_eta(o,a)}function i(o,a){return O.PeMath.prototype.eta_to_phi(o,a)}function r(o,a){return O.PeMath.prototype.phi_to_phig(o,a)}function s(o,a,l){return O.PeMath.prototype.q(o,a,l)}function n(o,a){return O.PeMath.prototype.q90(o,a)}e.phiToEta=t,e.etaToPhi=i,e.phiToPhig=r,e.q=s,e.q90=n})(sx||(sx={})),(function(e){const t=(u,c,d,m,y,g)=>{let _,v;switch(O.ensureCache.prepare(),u){case"dd":_=O._pe_geog_to_dd,v=wt.PE_DD_MAX;break;case"ddm":_=O._pe_geog_to_ddm,v=wt.PE_DDM_MAX;break;case"dms":_=O._pe_geog_to_dms,v=wt.PE_DMS_MAX}let b=0;c&&(b=O.getPointer(c));const S=vc(m),$=O.ensureFloat64(S),E=m0(d,v),C=_(b,d,$,y,O.ensureInt32(E));if(C)for(let P=0;P<d;P++)g[P]=O.UTF8ToString(E[P]);return C},i=(u,c,d,m,y)=>{let g;switch(O.ensureCache.prepare(),u){case"dd":g=O._pe_dd_to_geog;break;case"ddm":g=O._pe_ddm_to_geog;break;case"dms":g=O._pe_dms_to_geog}let _=0;c&&(_=O.getPointer(c));const v=m.map((E=>O.ensureString(E))),b=O.ensureInt32(v),S=O.ensureFloat64(new Array(2*d)),$=g(_,d,b,S);return $&&ql(y,d,S),$};function r(u,c,d,m,y){return t("dms",u,c,d,m,y)}function s(u,c,d,m){return i("dms",u,c,d,m)}function n(u,c,d,m,y){return t("ddm",u,c,d,m,y)}function o(u,c,d,m){return i("ddm",u,c,d,m)}function a(u,c,d,m,y){return t("dd",u,c,d,m,y)}function l(u,c,d,m){return i("dd",u,c,d,m)}e.geogToDms=r,e.dmsToGeog=s,e.geogToDdm=n,e.ddmToGeog=o,e.geogToDd=a,e.ddToGeog=l})(nx||(nx={})),(function(e){function t(){e.PE_MGRS_STYLE_NEW=O.PeNotationMgrs.prototype.PE_MGRS_STYLE_NEW,e.PE_MGRS_STYLE_OLD=O.PeNotationMgrs.prototype.PE_MGRS_STYLE_OLD,e.PE_MGRS_STYLE_AUTO=O.PeNotationMgrs.prototype.PE_MGRS_STYLE_AUTO,e.PE_MGRS_180_ZONE_1_PLUS=O.PeNotationMgrs.prototype.PE_MGRS_180_ZONE_1_PLUS,e.PE_MGRS_ADD_SPACES=O.PeNotationMgrs.prototype.PE_MGRS_ADD_SPACES}function i(s,n,o,a,l,u,c){O.ensureCache.prepare();let d=0;s&&(d=O.getPointer(s));const m=vc(o),y=O.ensureFloat64(m),g=m0(n,wt.PE_MGRS_MAX),_=O.ensureInt32(g),v=O._pe_geog_to_mgrs_extended(d,n,y,a,l,u,_);if(v)for(let b=0;b<n;b++)c[b]=O.UTF8ToString(g[b]);return v}function r(s,n,o,a,l){O.ensureCache.prepare();let u=0;s&&(u=O.getPointer(s));const c=o.map((g=>O.ensureString(g))),d=O.ensureInt32(c),m=O.ensureFloat64(new Array(2*n)),y=O._pe_mgrs_to_geog_extended(u,n,d,a,m);return y&&ql(l,n,m),y}e.init=t,e.geogToMgrsExtended=i,e.mgrsToGeogExtended=r})(nv||(nv={})),(function(e){function t(r,s,n,o,a,l,u){O.ensureCache.prepare();let c=0;r&&(c=O.getPointer(r));const d=vc(n),m=O.ensureFloat64(d),y=m0(s,wt.PE_MGRS_MAX),g=O.ensureInt32(y),_=O._pe_geog_to_usng(c,s,m,o,a,l,g);if(_)for(let v=0;v<s;v++)u[v]=O.UTF8ToString(y[v]);return _}function i(r,s,n,o){O.ensureCache.prepare();let a=0;r&&(a=O.getPointer(r));const l=n.map((m=>O.ensureString(m))),u=O.ensureInt32(l),c=O.ensureFloat64(new Array(2*s)),d=O._pe_usng_to_geog(a,s,u,c);return d&&ql(o,s,c),d}e.geogToUsng=t,e.usngToGeog=i})(ox||(ox={})),(function(e){function t(){e.PE_UTM_OPTS_NONE=O.PeNotationUtm.prototype.PE_UTM_OPTS_NONE,e.PE_UTM_OPTS_ADD_SPACES=O.PeNotationUtm.prototype.PE_UTM_OPTS_ADD_SPACES,e.PE_UTM_OPTS_NS=O.PeNotationUtm.prototype.PE_UTM_OPTS_NS}function i(s,n,o,a,l){O.ensureCache.prepare();let u=0;s&&(u=O.getPointer(s));const c=vc(o),d=O.ensureFloat64(c),m=m0(n,wt.PE_UTM_MAX),y=O.ensureInt32(m),g=O._pe_geog_to_utm(u,n,d,a,y);if(g)for(let _=0;_<n;_++)l[_]=O.UTF8ToString(m[_]);return g}function r(s,n,o,a,l){O.ensureCache.prepare();let u=0;s&&(u=O.getPointer(s));const c=o.map((g=>O.ensureString(g))),d=O.ensureInt32(c),m=O.ensureFloat64(new Array(2*n)),y=O._pe_utm_to_geog(u,n,d,a,m);return y&&ql(l,n,m),y}e.init=t,e.geogToUtm=i,e.utmToGeog=r})(ov||(ov={})),(function(e){const t=new Map;function i(){e.PE_PCSINFO_OPTION_NONE=O.PePCSInfo.prototype.PE_PCSINFO_OPTION_NONE,e.PE_PCSINFO_OPTION_DOMAIN=O.PePCSInfo.prototype.PE_PCSINFO_OPTION_DOMAIN,e.PE_POLE_OUTSIDE_BOUNDARY=O.PePCSInfo.prototype.PE_POLE_OUTSIDE_BOUNDARY,e.PE_POLE_POINT=O.PePCSInfo.prototype.PE_POLE_POINT}function r(s,n=e.PE_PCSINFO_OPTION_DOMAIN){let o=null,a=null;return t.has(s)&&(a=t.get(s),a[n]&&(o=a[n])),o||(o=O.PePCSInfo.prototype.generate(s,n),a||(a=[],t.set(s,a)),a[n]=o),o}e.init=i,e.generate=r})(av||(av={})),(function(e){function t(){return O.PeVersion.prototype.version_string()}e.versionString=t})(ax||(ax={}));const KZ=Object.freeze(Object.defineProperty({__proto__:null,get PeCSTransformations(){return QS},get PeDefs(){return wt},get PeDouble(){return x4},get PeFactory(){return ex},get PeGCSExtent(){return $4},get PeGTTransformations(){return ix},get PeGTlistExtended(){return sv},get PeGTlistExtendedEntry(){return tx},get PeLineType(){return rx},get PeMath(){return sx},get PeNotationDms(){return nx},get PeNotationMgrs(){return nv},get PeNotationUsng(){return ox},get PeNotationUtm(){return ov},get PePCSInfo(){return av},get PeVersion(){return ax},_init:M4,get _pe(){return O},isLoaded:QE,isSupported:XZ,load:S4},Symbol.toStringTag,{value:"Module"}));var nh;(function(e){e[e.CGCS2000=4490]="CGCS2000",e[e.GCSMARS2000=104971]="GCSMARS2000",e[e.GCSMARS2000_SPHERE=104905]="GCSMARS2000_SPHERE",e[e.GCSMOON2000=104903]="GCSMOON2000"})(nh||(nh={}));let p;const T={values:[1,.3048,.3048006096012192,.3047972654,.9143917962,.201166195164,.9143984146160287,.3047994715386762,20.11676512155263,20.11678249437587,.9143985307444408,.91439523,.3047997101815088,20.1168,20.116756,5e4,15e4],units:["Meter","Foot","Foot_US","Foot_Clarke","Yard_Clarke","Link_Clarke","Yard_Sears","Foot_Sears","Chain_Sears","Chain_Benoit_1895_B","Yard_Indian","Yard_Indian_1937","Foot_Gold_Coast","Chain","Chain_Sears_1922_Truncated","50_Kilometers","150_Kilometers"],2066:5,2136:12,2155:2,2157:0,2158:0,2159:12,2160:12,2204:2,2219:0,2220:0,2254:2,2255:2,2256:1,2265:1,2266:1,2267:2,2268:2,2269:1,2270:1,2271:2,2272:2,2273:1,2294:0,2295:0,2314:3,2899:2,2900:2,2901:1,2909:1,2910:1,2911:2,2912:2,2913:1,2914:1,2992:1,2993:0,2994:1,3080:1,3089:2,3090:0,3091:2,3102:2,3141:0,3142:0,3167:14,3359:2,3360:0,3361:1,3362:0,3363:2,3364:0,3365:2,3366:3,3404:2,3405:0,3406:0,3407:3,3439:0,3440:0,3479:1,3480:0,3481:1,3482:0,3483:1,3484:0,3485:2,3486:0,3487:2,3488:0,3489:0,3490:2,3491:0,3492:2,3493:0,3494:2,3495:0,3496:2,3497:0,3498:2,3499:0,3500:2,3501:0,3502:2,3503:0,3504:2,3505:0,3506:2,3507:0,3508:2,3509:0,3510:2,3511:0,3512:2,3513:0,3514:0,3515:2,3516:0,3517:2,3518:0,3519:2,3520:0,3521:2,3522:0,3523:2,3524:0,3525:2,3526:0,3527:2,3528:0,3529:2,3530:0,3531:2,3532:0,3533:2,3534:0,3535:2,3536:0,3537:2,3538:0,3539:2,3540:0,3541:2,3542:0,3543:2,3544:0,3545:2,3546:0,3547:2,3548:0,3549:2,3550:0,3551:2,3552:0,3553:2,3582:2,3583:0,3584:2,3585:0,3586:2,3587:0,3588:1,3589:0,3590:1,3591:0,3592:0,3593:1,3598:2,3599:0,3600:2,3605:1,3606:0,3607:0,3608:2,3609:0,3610:2,3611:0,3612:2,3613:0,3614:2,3615:0,3616:2,3617:0,3618:2,3619:0,3620:2,3621:0,3622:2,3623:0,3624:2,3625:0,3626:2,3627:0,3628:2,3629:0,3630:2,3631:0,3632:2,3633:0,3634:1,3635:0,3636:1,3640:2,3641:0,3642:2,3643:0,3644:1,3645:0,3646:1,3647:0,3648:1,3649:0,3650:2,3651:0,3652:2,3653:0,3654:2,3655:0,3656:1,3657:0,3658:2,3659:0,3660:2,3661:0,3662:2,3663:0,3664:2,3668:2,3669:0,3670:2,3671:0,3672:2,3673:0,3674:2,3675:0,3676:1,3677:2,3678:0,3679:1,3680:2,3681:0,3682:1,3683:2,3684:0,3685:0,3686:2,3687:0,3688:2,3689:0,3690:2,3691:0,3692:2,3696:2,3697:0,3698:2,3699:0,3700:2,3793:0,3794:0,3812:0,3854:0,3857:0,3920:0,3978:0,3979:0,3991:2,3992:2,4026:0,4037:0,4038:0,4071:0,4082:0,4083:0,4087:0,4088:0,4217:2,4414:0,4415:0,4417:0,4434:0,4437:0,4438:2,4439:2,4462:0,4467:0,4471:0,4474:0,4559:0,4647:0,4822:0,4826:0,4839:0,5018:0,5041:0,5042:0,5048:0,5221:0,5223:0,5234:0,5235:0,5243:0,5247:0,5266:0,5316:0,5320:0,5321:0,5325:0,5337:0,5361:0,5362:0,5367:0,5382:0,5383:0,5396:0,5456:0,5457:0,5469:0,5472:4,5490:0,5513:0,5514:0,5523:0,5559:0,5588:1,5589:3,5596:0,5627:0,5629:0,5641:0,5643:0,5644:0,5646:2,5654:2,5655:2,5659:0,5700:0,5825:0,5836:0,5837:0,5839:0,5842:0,5844:0,5858:0,5879:0,5880:0,5887:0,5890:0,6128:1,6129:1,6141:1,6204:0,6210:0,6211:0,6307:0,6312:0,6316:0,6362:0,6391:1,6405:1,6406:0,6407:1,6408:0,6409:1,6410:0,6411:2,6412:0,6413:2,6414:0,6415:0,6416:2,6417:0,6418:2,6419:0,6420:2,6421:0,6422:2,6423:0,6424:2,6425:0,6426:2,6427:0,6428:2,6429:0,6430:2,6431:0,6432:2,6433:0,6434:2,6435:0,6436:2,6437:0,6438:2,6439:0,6440:0,6441:2,6442:0,6443:2,6444:0,6445:2,6446:0,6447:2,6448:0,6449:2,6450:0,6451:2,6452:0,6453:2,6454:0,6455:2,6456:0,6457:2,6458:0,6459:2,6460:0,6461:2,6462:0,6463:2,6464:0,6465:2,6466:0,6467:2,6468:0,6469:2,6470:0,6471:2,6472:0,6473:2,6474:0,6475:2,6476:0,6477:2,6478:0,6479:2,6484:2,6485:0,6486:2,6487:0,6488:2,6489:0,6490:2,6491:0,6492:2,6493:0,6494:1,6495:0,6496:1,6497:0,6498:0,6499:1,6500:0,6501:2,6502:0,6503:2,6504:0,6505:2,6506:0,6507:2,6508:0,6509:0,6510:2,6515:1,6516:0,6518:0,6519:2,6520:0,6521:2,6522:0,6523:2,6524:0,6525:2,6526:0,6527:2,6528:0,6529:2,6530:0,6531:2,6532:0,6533:2,6534:0,6535:2,6536:0,6537:2,6538:0,6539:2,6540:0,6541:2,6542:0,6543:2,6544:0,6545:1,6546:0,6547:1,6548:0,6549:2,6550:0,6551:2,6552:0,6553:2,6554:0,6555:2,6556:0,6557:1,6558:0,6559:1,6560:0,6561:1,6562:0,6563:2,6564:0,6565:2,6566:0,6567:0,6568:2,6569:0,6570:1,6571:0,6572:2,6573:0,6574:2,6575:0,6576:2,6577:0,6578:2,6582:2,6583:0,6584:2,6585:0,6586:2,6587:0,6588:2,6589:0,6590:2,6591:0,6592:0,6593:2,6594:0,6595:2,6596:0,6597:2,6598:0,6599:2,6600:0,6601:2,6602:0,6603:2,6605:2,6606:0,6607:2,6608:0,6609:2,6610:0,6611:0,6612:2,6613:0,6614:2,6615:0,6616:2,6617:0,6618:2,6633:2,6646:0,6703:0,6784:0,6785:1,6786:0,6787:1,6788:0,6789:1,6790:0,6791:1,6792:0,6793:1,6794:0,6795:1,6796:0,6797:1,6798:0,6799:1,6800:0,6801:1,6802:0,6803:1,6804:0,6805:1,6806:0,6807:1,6808:0,6809:1,6810:0,6811:1,6812:0,6813:1,6814:0,6815:1,6816:0,6817:1,6818:0,6819:1,6820:0,6821:1,6822:0,6823:1,6824:0,6825:1,6826:0,6827:1,6828:0,6829:1,6830:0,6831:1,6832:0,6833:1,6834:0,6835:1,6836:0,6837:1,6838:0,6839:1,6840:0,6841:1,6842:0,6843:1,6844:0,6845:1,6846:0,6847:1,6848:0,6849:1,6850:0,6851:1,6852:0,6853:1,6854:0,6855:1,6856:0,6857:1,6858:0,6859:1,6860:0,6861:1,6862:0,6863:1,6867:0,6868:1,6870:0,6875:0,6876:0,6879:0,6880:2,6884:0,6885:1,6886:0,6887:1,6915:0,6922:0,6923:2,6924:0,6925:2,6962:0,6984:0,6991:0,7128:2,7131:0,7132:2,7142:0,7257:0,7258:2,7259:0,7260:2,7261:0,7262:2,7263:0,7264:2,7265:0,7266:2,7267:0,7268:2,7269:0,7270:2,7271:0,7272:2,7273:0,7274:2,7275:0,7276:2,7277:0,7278:2,7279:0,7280:2,7281:0,7282:2,7283:0,7284:2,7285:0,7286:2,7287:0,7288:2,7289:0,7290:2,7291:0,7292:2,7293:0,7294:2,7295:0,7296:2,7297:0,7298:2,7299:0,7300:2,7301:0,7302:2,7303:0,7304:2,7305:0,7306:2,7307:0,7308:2,7309:0,7310:2,7311:0,7312:2,7313:0,7314:2,7315:0,7316:2,7317:0,7318:2,7319:0,7320:2,7321:0,7322:2,7323:0,7324:2,7325:0,7326:2,7327:0,7328:2,7329:0,7330:2,7331:0,7332:2,7333:0,7334:2,7335:0,7336:2,7337:0,7338:2,7339:0,7340:2,7341:0,7342:2,7343:0,7344:2,7345:0,7346:2,7347:0,7348:2,7349:0,7350:2,7351:0,7352:2,7353:0,7354:2,7355:0,7356:2,7357:0,7358:2,7359:0,7360:2,7361:0,7362:2,7363:0,7364:2,7365:0,7366:2,7367:0,7368:2,7369:0,7370:2,7877:0,7878:0,7882:0,7883:0,7887:0,7899:0,7991:0,7992:0,8035:2,8036:2,8058:0,8059:0,8082:0,8083:0,8088:0,8090:0,8091:2,8092:0,8093:2,8095:0,8096:2,8097:0,8098:2,8099:0,8100:2,8101:0,8102:2,8103:0,8104:2,8105:0,8106:2,8107:0,8108:2,8109:0,8110:2,8111:0,8112:2,8113:0,8114:2,8115:0,8116:2,8117:0,8118:2,8119:0,8120:2,8121:0,8122:2,8123:0,8124:2,8125:0,8126:2,8127:0,8128:2,8129:0,8130:2,8131:0,8132:2,8133:0,8134:2,8135:0,8136:2,8137:0,8138:2,8139:0,8140:2,8141:0,8142:2,8143:0,8144:2,8145:0,8146:2,8147:0,8148:2,8149:0,8150:2,8151:0,8152:2,8153:0,8154:2,8155:0,8156:2,8157:0,8158:2,8159:0,8160:2,8161:0,8162:2,8163:0,8164:2,8165:0,8166:2,8167:0,8168:2,8169:0,8170:2,8171:0,8172:2,8173:0,8177:2,8179:0,8180:2,8181:0,8182:2,8184:0,8185:2,8187:0,8189:2,8191:0,8193:2,8196:0,8197:2,8198:0,8200:2,8201:0,8202:2,8203:0,8204:2,8205:0,8206:2,8207:0,8208:2,8209:0,8210:2,8212:0,8213:2,8214:0,8216:2,8218:0,8220:2,8222:0,8224:2,8225:0,8226:2,8311:0,8312:1,8313:0,8314:1,8315:0,8316:1,8317:0,8318:1,8319:0,8320:1,8321:0,8322:1,8323:0,8324:1,8325:0,8326:1,8327:0,8328:1,8329:0,8330:1,8331:0,8332:1,8333:0,8334:1,8335:0,8336:1,8337:0,8338:1,8339:0,8340:1,8341:0,8342:1,8343:0,8344:1,8345:0,8346:1,8347:0,8348:1,8352:0,8353:0,8379:0,8380:2,8381:0,8382:2,8383:0,8384:2,8385:0,8387:2,8391:0,8395:0,8433:0,8441:0,8455:0,8456:0,8531:2,8682:0,8686:0,8687:0,8692:0,8693:0,8826:0,8903:0,8950:0,8951:0,9039:0,9040:0,9141:0,9149:0,9150:0,9191:0,9221:0,9222:0,9249:0,9250:0,9252:0,9254:0,9265:0,9284:0,9285:0,9300:0,9354:0,9367:0,9373:0,9377:0,9387:0,9391:0,9456:0,9473:0,9498:0,9674:0,9678:0,9680:0,9709:0,9712:0,9713:0,9716:0,9741:0,9748:2,9749:2,9761:0,9766:0,9793:0,9794:0,9869:0,9874:0,9875:0,9880:0,9895:0,9943:0,9945:0,9947:0,9967:0,9972:0,9977:0,10160:0,10183:0,10188:0,10194:0,10199:0,10207:0,10212:0,10217:0,10222:0,10227:0,10235:0,10240:0,10250:0,10254:0,10270:0,10275:0,10280:0,10306:0,10329:0,10471:0,10477:0,10481:2,10516:2,10592:0,10594:0,10596:0,10598:0,10601:0,10603:0,10626:0,10632:0,10641:0,10665:0,10674:0,10744:0,10745:0,10759:0,10773:0,10802:0,10820:0,20002:0,20042:0,20050:1,20499:0,20538:0,20539:0,20790:0,20791:0,21291:0,21292:0,21500:0,21817:0,21818:0,22032:0,22033:0,22091:0,22092:0,22239:0,22240:0,22332:0,22337:0,22338:0,22391:0,22392:0,22639:0,22700:0,22739:0,22770:0,22780:0,22832:0,23090:0,23095:0,23239:0,23240:0,23433:0,23700:0,24047:0,24048:0,24100:3,24200:0,24305:0,24306:0,24382:10,24383:0,24500:0,24547:0,24548:0,24571:9,24600:0,25e3:0,25231:0,25884:0,25932:0,26237:0,26331:0,26332:0,26432:0,26591:0,26592:0,26632:0,26692:0,27120:0,27200:0,27291:6,27292:6,27429:0,27492:0,27493:0,27500:0,28232:0,28600:0,28991:0,28992:0,29100:0,29101:0,29220:0,29221:0,29333:0,29635:0,29636:0,29701:0,29738:0,29739:0,29849:0,29850:0,29871:8,29872:7,29873:0,29874:0,30200:5,30339:0,30340:0,30591:0,30592:0,30791:0,30792:0,30800:0,31028:0,31121:0,31154:0,31170:0,31171:0,31370:0,31528:0,31529:0,31600:0,31700:0,31838:0,31839:0,31900:0,31901:0,32061:0,32062:0,32098:0,32099:2,32100:0,32104:0,32161:0,32766:0,53048:0,53049:0,65061:2,65062:2,102041:2,102064:11,102068:15,102069:16,102118:2,102119:1,102120:2,102121:2,102217:2,102218:0,102219:2,102220:2,102378:1,102379:1,102380:0,102381:1,102589:2,102599:2,102600:2,102604:2,102647:0,102704:2,102705:2,102706:0,102731:0,102732:0,102759:1,102760:1,102761:2,102762:0,102763:2,102764:0,102765:0,102766:2,102970:1,102974:2,102993:0,102994:0,102995:2,102996:2,103015:0,103016:2,103017:0,103018:2,103025:0,103026:0,103027:2,103028:2,103035:0,103036:0,103037:2,103038:2,103039:0,103040:0,103041:2,103042:2,103043:0,103044:0,103045:2,103046:2,103047:0,103048:0,103049:2,103050:2,103051:0,103052:2,103053:0,103054:2,103055:0,103056:2,103057:0,103058:0,103059:2,103060:2,103061:0,103062:0,103063:2,103064:2,103069:2,103070:0,103071:0,103072:2,103073:2,103086:0,103087:0,103088:2,103089:2,103094:1,103095:0,103096:2,103103:0,103104:2,103105:0,103106:2,103121:0,103122:2,103123:0,103124:0,103125:1,103126:1,103127:0,103128:0,103129:2,103130:2,103131:0,103132:0,103133:2,103134:2,103135:0,103136:0,103137:1,103138:1,103139:0,103140:2,103141:0,103142:2,103143:0,103144:2,103145:0,103146:1,103147:0,103148:0,103149:2,103150:2,103151:0,103152:2,103172:0,103173:2,103174:0,103175:0,103176:2,103177:2,103178:0,103179:0,103180:2,103181:2,103182:0,103183:0,103184:2,103185:2,103228:0,103229:0,103230:2,103231:2,103250:0,103251:2,103252:0,103253:2,103260:0,103261:0,103262:2,103263:2,103270:0,103271:0,103272:2,103273:2,103274:0,103275:0,103276:2,103277:2,103278:0,103279:0,103280:2,103281:2,103282:0,103283:0,103284:2,103285:2,103286:0,103287:2,103288:0,103289:2,103290:0,103291:2,103292:0,103293:0,103294:2,103295:2,103296:0,103297:0,103298:2,103299:2,103376:2,103377:0,103378:0,103379:2,103380:2,103393:0,103394:0,103395:2,103396:2,103472:0,103473:1,103474:0,103475:2,103482:0,103483:2,103484:0,103485:2,103500:0,103501:2,103502:0,103503:0,103504:1,103505:1,103506:0,103507:0,103508:2,103509:2,103510:0,103511:0,103512:2,103513:2,103514:0,103515:2,103516:0,103517:2,103518:0,103519:2,103520:0,103521:1,103522:0,103523:0,103524:2,103525:2,103526:0,103527:2,103561:2,103562:2,103563:0,103564:0,103565:2,103566:2,103567:0,103568:0,103569:2,103570:2,103584:0,103585:2,103586:0,103587:2,103588:1,103589:0,103590:2,103591:1,103592:0,103593:2,103594:1,103695:2,103897:1,103978:2,103979:0,103980:2,103981:0};for(p=2e3;p<=2045;p++)T[p]=0;for(p=2056;p<=2065;p++)T[p]=0;for(p=2067;p<=2135;p++)T[p]=0;for(p=2137;p<=2154;p++)T[p]=0;for(p=2161;p<=2170;p++)T[p]=0;for(p=2172;p<=2193;p++)T[p]=0;for(p=2195;p<=2198;p++)T[p]=0;for(p=2200;p<=2203;p++)T[p]=0;for(p=2205;p<=2217;p++)T[p]=0;for(p=2222;p<=2224;p++)T[p]=1;for(p=2225;p<=2250;p++)T[p]=2;for(p=2251;p<=2253;p++)T[p]=1;for(p=2257;p<=2264;p++)T[p]=2;for(p=2274;p<=2279;p++)T[p]=2;for(p=2280;p<=2282;p++)T[p]=1;for(p=2283;p<=2289;p++)T[p]=2;for(p=2290;p<=2292;p++)T[p]=0;for(p=2308;p<=2313;p++)T[p]=0;for(p=2315;p<=2491;p++)T[p]=0;for(p=2494;p<=2866;p++)T[p]=0;for(p=2867;p<=2869;p++)T[p]=1;for(p=2870;p<=2888;p++)T[p]=2;for(p=2891;p<=2895;p++)T[p]=2;for(p=2896;p<=2898;p++)T[p]=1;for(p=2902;p<=2908;p++)T[p]=2;for(p=2915;p<=2920;p++)T[p]=2;for(p=2921;p<=2923;p++)T[p]=1;for(p=2924;p<=2930;p++)T[p]=2;for(p=2931;p<=2962;p++)T[p]=0;for(p=2964;p<=2968;p++)T[p]=2;for(p=2969;p<=2973;p++)T[p]=0;for(p=2975;p<=2991;p++)T[p]=0;for(p=2995;p<=3051;p++)T[p]=0;for(p=3054;p<=3079;p++)T[p]=0;for(p=3081;p<=3088;p++)T[p]=0;for(p=3092;p<=3101;p++)T[p]=0;for(p=3106;p<=3138;p++)T[p]=0;for(p=3146;p<=3151;p++)T[p]=0;for(p=3153;p<=3166;p++)T[p]=0;for(p=3168;p<=3172;p++)T[p]=0;for(p=3174;p<=3203;p++)T[p]=0;for(p=3294;p<=3358;p++)T[p]=0;for(p=3367;p<=3403;p++)T[p]=0;for(p=3408;p<=3416;p++)T[p]=0;for(p=3417;p<=3438;p++)T[p]=2;for(p=3441;p<=3446;p++)T[p]=2;for(p=3447;p<=3450;p++)T[p]=0;for(p=3451;p<=3459;p++)T[p]=2;for(p=3460;p<=3478;p++)T[p]=0;for(p=3554;p<=3559;p++)T[p]=0;for(p=3560;p<=3570;p++)T[p]=2;for(p=3571;p<=3581;p++)T[p]=0;for(p=3594;p<=3597;p++)T[p]=0;for(p=3601;p<=3604;p++)T[p]=0;for(p=3637;p<=3639;p++)T[p]=0;for(p=3665;p<=3667;p++)T[p]=0;for(p=3693;p<=3695;p++)T[p]=0;for(p=3701;p<=3727;p++)T[p]=0;for(p=3728;p<=3739;p++)T[p]=2;for(p=3740;p<=3751;p++)T[p]=0;for(p=3753;p<=3760;p++)T[p]=2;for(p=3761;p<=3773;p++)T[p]=0;for(p=3775;p<=3777;p++)T[p]=0;for(p=3779;p<=3781;p++)T[p]=0;for(p=3783;p<=3785;p++)T[p]=0;for(p=3788;p<=3791;p++)T[p]=0;for(p=3797;p<=3802;p++)T[p]=0;for(p=3814;p<=3816;p++)T[p]=0;for(p=3825;p<=3829;p++)T[p]=0;for(p=3832;p<=3841;p++)T[p]=0;for(p=3844;p<=3852;p++)T[p]=0;for(p=3873;p<=3885;p++)T[p]=0;for(p=3890;p<=3893;p++)T[p]=0;for(p=3907;p<=3912;p++)T[p]=0;for(p=3942;p<=3950;p++)T[p]=0;for(p=3968;p<=3970;p++)T[p]=0;for(p=3973;p<=3976;p++)T[p]=0;for(p=3986;p<=3989;p++)T[p]=0;for(p=3994;p<=3997;p++)T[p]=0;for(p=4048;p<=4051;p++)T[p]=0;for(p=4056;p<=4063;p++)T[p]=0;for(p=4093;p<=4096;p++)T[p]=0;for(p=4390;p<=4398;p++)T[p]=0;for(p=4399;p<=4413;p++)T[p]=2;for(p=4418;p<=4433;p++)T[p]=2;for(p=4455;p<=4457;p++)T[p]=2;for(p=4484;p<=4489;p++)T[p]=0;for(p=4491;p<=4554;p++)T[p]=0;for(p=4568;p<=4589;p++)T[p]=0;for(p=4652;p<=4656;p++)T[p]=0;for(p=4766;p<=4800;p++)T[p]=0;for(p=5014;p<=5016;p++)T[p]=0;for(p=5069;p<=5072;p++)T[p]=0;for(p=5105;p<=5130;p++)T[p]=0;for(p=5167;p<=5188;p++)T[p]=0;for(p=5253;p<=5259;p++)T[p]=0;for(p=5269;p<=5275;p++)T[p]=0;for(p=5292;p<=5311;p++)T[p]=0;for(p=5329;p<=5331;p++)T[p]=0;for(p=5343;p<=5349;p++)T[p]=0;for(p=5355;p<=5357;p++)T[p]=0;for(p=5387;p<=5389;p++)T[p]=0;for(p=5459;p<=5463;p++)T[p]=0;for(p=5479;p<=5482;p++)T[p]=0;for(p=5518;p<=5520;p++)T[p]=0;for(p=5530;p<=5539;p++)T[p]=0;for(p=5550;p<=5552;p++)T[p]=0;for(p=5562;p<=5583;p++)T[p]=0;for(p=5623;p<=5625;p++)T[p]=2;for(p=5631;p<=5639;p++)T[p]=0;for(p=5649;p<=5653;p++)T[p]=0;for(p=5663;p<=5680;p++)T[p]=0;for(p=5682;p<=5685;p++)T[p]=0;for(p=5875;p<=5877;p++)T[p]=0;for(p=5896;p<=5899;p++)T[p]=0;for(p=5921;p<=5940;p++)T[p]=0;for(p=6050;p<=6125;p++)T[p]=0;for(p=6244;p<=6275;p++)T[p]=0;for(p=6328;p<=6348;p++)T[p]=0;for(p=6350;p<=6356;p++)T[p]=0;for(p=6366;p<=6372;p++)T[p]=0;for(p=6381;p<=6387;p++)T[p]=0;for(p=6393;p<=6404;p++)T[p]=0;for(p=6480;p<=6483;p++)T[p]=0;for(p=6511;p<=6514;p++)T[p]=0;for(p=6579;p<=6581;p++)T[p]=0;for(p=6619;p<=6624;p++)T[p]=0;for(p=6625;p<=6627;p++)T[p]=2;for(p=6628;p<=6632;p++)T[p]=0;for(p=6634;p<=6637;p++)T[p]=0;for(p=6669;p<=6692;p++)T[p]=0;for(p=6707;p<=6709;p++)T[p]=0;for(p=6720;p<=6723;p++)T[p]=0;for(p=6732;p<=6738;p++)T[p]=0;for(p=6931;p<=6933;p++)T[p]=0;for(p=6956;p<=6959;p++)T[p]=0;for(p=7005;p<=7007;p++)T[p]=0;for(p=7057;p<=7070;p++)T[p]=2;for(p=7074;p<=7082;p++)T[p]=0;for(p=7109;p<=7118;p++)T[p]=0;for(p=7119;p<=7127;p++)T[p]=1;for(p=7374;p<=7376;p++)T[p]=0;for(p=7528;p<=7586;p++)T[p]=0;for(p=7587;p<=7645;p++)T[p]=2;for(p=7692;p<=7696;p++)T[p]=0;for(p=7755;p<=7787;p++)T[p]=0;for(p=7791;p<=7795;p++)T[p]=0;for(p=7799;p<=7801;p++)T[p]=0;for(p=7803;p<=7805;p++)T[p]=0;for(p=7825;p<=7831;p++)T[p]=0;for(p=7845;p<=7859;p++)T[p]=0;for(p=8013;p<=8032;p++)T[p]=0;for(p=8065;p<=8068;p++)T[p]=1;for(p=8518;p<=8529;p++)T[p]=2;for(p=8533;p<=8536;p++)T[p]=2;for(p=8538;p<=8540;p++)T[p]=2;for(p=8677;p<=8679;p++)T[p]=0;for(p=8836;p<=8840;p++)T[p]=0;for(p=8857;p<=8859;p++)T[p]=0;for(p=8908;p<=8910;p++)T[p]=0;for(p=9154;p<=9159;p++)T[p]=0;for(p=9205;p<=9218;p++)T[p]=0;for(p=9271;p<=9273;p++)T[p]=0;for(p=9295;p<=9297;p++)T[p]=0;for(p=9356;p<=9360;p++)T[p]=0;for(p=9404;p<=9407;p++)T[p]=0;for(p=9476;p<=9482;p++)T[p]=0;for(p=9487;p<=9494;p++)T[p]=0;for(p=9697;p<=9699;p++)T[p]=0;for(p=9821;p<=9865;p++)T[p]=0;for(p=10285;p<=10291;p++)T[p]=0;for(p=10314;p<=10317;p++)T[p]=0;for(p=10448;p<=10465;p++)T[p]=0;for(p=10726;p<=10729;p++)T[p]=0;for(p=10731;p<=10733;p++)T[p]=0;for(p=11114;p<=11118;p++)T[p]=0;for(p=20004;p<=20032;p++)T[p]=0;for(p=20047;p<=20049;p++)T[p]=0;for(p=20062;p<=20092;p++)T[p]=0;for(p=20135;p<=20138;p++)T[p]=0;for(p=20248;p<=20258;p++)T[p]=0;for(p=20348;p<=20358;p++)T[p]=0;for(p=20436;p<=20440;p++)T[p]=0;for(p=20822;p<=20824;p++)T[p]=0;for(p=20904;p<=20932;p++)T[p]=0;for(p=20934;p<=20936;p++)T[p]=0;for(p=21004;p<=21032;p++)T[p]=0;for(p=21035;p<=21037;p++)T[p]=0;for(p=21095;p<=21097;p++)T[p]=0;for(p=21148;p<=21150;p++)T[p]=0;for(p=21207;p<=21264;p++)T[p]=0;for(p=21307;p<=21364;p++)T[p]=0;for(p=21413;p<=21423;p++)T[p]=0;for(p=21453;p<=21463;p++)T[p]=0;for(p=21473;p<=21483;p++)T[p]=0;for(p=21780;p<=21782;p++)T[p]=0;for(p=21891;p<=21894;p++)T[p]=0;for(p=21896;p<=21899;p++)T[p]=0;for(p=22171;p<=22177;p++)T[p]=0;for(p=22181;p<=22187;p++)T[p]=0;for(p=22191;p<=22197;p++)T[p]=0;for(p=22207;p<=22222;p++)T[p]=0;for(p=22229;p<=22232;p++)T[p]=0;for(p=22234;p<=22236;p++)T[p]=0;for(p=22243;p<=22250;p++)T[p]=0;for(p=22262;p<=22265;p++)T[p]=0;for(p=22307;p<=22322;p++)T[p]=0;for(p=22348;p<=22357;p++)T[p]=0;for(p=22407;p<=22422;p++)T[p]=0;for(p=22462;p<=22465;p++)T[p]=0;for(p=22521;p<=22525;p++)T[p]=0;for(p=22607;p<=22622;p++)T[p]=0;for(p=22641;p<=22646;p++)T[p]=0;for(p=22648;p<=22657;p++)T[p]=0;for(p=22707;p<=22722;p++)T[p]=0;for(p=22762;p<=22765;p++)T[p]=0;for(p=22807;p<=22822;p++)T[p]=0;for(p=22991;p<=22994;p++)T[p]=0;for(p=23028;p<=23038;p++)T[p]=0;for(p=23301;p<=23333;p++)T[p]=2;for(p=23830;p<=23853;p++)T[p]=0;for(p=23866;p<=23872;p++)T[p]=0;for(p=23877;p<=23884;p++)T[p]=0;for(p=23886;p<=23894;p++)T[p]=0;for(p=23946;p<=23948;p++)T[p]=0;for(p=24311;p<=24313;p++)T[p]=0;for(p=24342;p<=24347;p++)T[p]=0;for(p=24370;p<=24374;p++)T[p]=10;for(p=24375;p<=24381;p++)T[p]=0;for(p=24718;p<=24721;p++)T[p]=0;for(p=24817;p<=24821;p++)T[p]=0;for(p=24877;p<=24882;p++)T[p]=0;for(p=24891;p<=24893;p++)T[p]=0;for(p=25391;p<=25395;p++)T[p]=0;for(p=25828;p<=25838;p++)T[p]=0;for(p=26191;p<=26195;p++)T[p]=0;for(p=26391;p<=26393;p++)T[p]=0;for(p=26701;p<=26722;p++)T[p]=0;for(p=26729;p<=26799;p++)T[p]=2;for(p=26801;p<=26803;p++)T[p]=2;for(p=26811;p<=26813;p++)T[p]=2;for(p=26847;p<=26870;p++)T[p]=2;for(p=26891;p<=26899;p++)T[p]=0;for(p=26901;p<=26923;p++)T[p]=0;for(p=26929;p<=26946;p++)T[p]=0;for(p=26948;p<=26998;p++)T[p]=0;for(p=27037;p<=27040;p++)T[p]=0;for(p=27205;p<=27232;p++)T[p]=0;for(p=27258;p<=27260;p++)T[p]=0;for(p=27391;p<=27398;p++)T[p]=0;for(p=27561;p<=27564;p++)T[p]=0;for(p=27571;p<=27574;p++)T[p]=0;for(p=27581;p<=27584;p++)T[p]=0;for(p=27591;p<=27594;p++)T[p]=0;for(p=27700;p<=27707;p++)T[p]=0;for(p=28191;p<=28193;p++)T[p]=0;for(p=28348;p<=28358;p++)T[p]=0;for(p=28402;p<=28432;p++)T[p]=0;for(p=28462;p<=28492;p++)T[p]=0;for(p=29118;p<=29122;p++)T[p]=0;for(p=29168;p<=29172;p++)T[p]=0;for(p=29177;p<=29185;p++)T[p]=0;for(p=29187;p<=29195;p++)T[p]=0;for(p=29900;p<=29903;p++)T[p]=0;for(p=30161;p<=30179;p++)T[p]=0;for(p=30491;p<=30494;p++)T[p]=0;for(p=30729;p<=30732;p++)T[p]=0;for(p=31251;p<=31259;p++)T[p]=0;for(p=31265;p<=31268;p++)T[p]=0;for(p=31275;p<=31279;p++)T[p]=0;for(p=31281;p<=31297;p++)T[p]=0;for(p=31461;p<=31469;p++)T[p]=0;for(p=31491;p<=31495;p++)T[p]=0;for(p=31917;p<=31922;p++)T[p]=0;for(p=31965;p<=32e3;p++)T[p]=0;for(p=32001;p<=32003;p++)T[p]=2;for(p=32005;p<=32031;p++)T[p]=2;for(p=32033;p<=32060;p++)T[p]=2;for(p=32064;p<=32067;p++)T[p]=2;for(p=32074;p<=32077;p++)T[p]=2;for(p=32081;p<=32086;p++)T[p]=0;for(p=32107;p<=32130;p++)T[p]=0;for(p=32133;p<=32159;p++)T[p]=0;for(p=32164;p<=32167;p++)T[p]=2;for(p=32180;p<=32199;p++)T[p]=0;for(p=32201;p<=32260;p++)T[p]=0;for(p=32301;p<=32360;p++)T[p]=0;for(p=32401;p<=32460;p++)T[p]=0;for(p=32501;p<=32560;p++)T[p]=0;for(p=32601;p<=32662;p++)T[p]=0;for(p=32664;p<=32667;p++)T[p]=2;for(p=32701;p<=32761;p++)T[p]=0;for(p=53001;p<=53004;p++)T[p]=0;for(p=53008;p<=53019;p++)T[p]=0;for(p=53021;p<=53032;p++)T[p]=0;for(p=53034;p<=53037;p++)T[p]=0;for(p=53042;p<=53046;p++)T[p]=0;for(p=53074;p<=53080;p++)T[p]=0;for(p=54001;p<=54004;p++)T[p]=0;for(p=54008;p<=54019;p++)T[p]=0;for(p=54021;p<=54032;p++)T[p]=0;for(p=54034;p<=54037;p++)T[p]=0;for(p=54042;p<=54046;p++)T[p]=0;for(p=54048;p<=54053;p++)T[p]=0;for(p=54074;p<=54080;p++)T[p]=0;for(p=54090;p<=54096;p++)T[p]=0;for(p=54098;p<=54101;p++)T[p]=0;for(p=65161;p<=65163;p++)T[p]=0;for(p=102001;p<=102040;p++)T[p]=0;for(p=102042;p<=102063;p++)T[p]=0;for(p=102065;p<=102067;p++)T[p]=0;for(p=102070;p<=102117;p++)T[p]=0;for(p=102122;p<=102216;p++)T[p]=0;for(p=102221;p<=102377;p++)T[p]=0;for(p=102382;p<=102388;p++)T[p]=0;for(p=102389;p<=102398;p++)T[p]=2;for(p=102399;p<=102444;p++)T[p]=0;for(p=102445;p<=102447;p++)T[p]=2;for(p=102448;p<=102458;p++)T[p]=0;for(p=102459;p<=102468;p++)T[p]=2;for(p=102469;p<=102499;p++)T[p]=0;for(p=102500;p<=102519;p++)T[p]=1;for(p=102520;p<=102524;p++)T[p]=0;for(p=102525;p<=102529;p++)T[p]=2;for(p=102530;p<=102588;p++)T[p]=0;for(p=102590;p<=102598;p++)T[p]=0;for(p=102601;p<=102603;p++)T[p]=0;for(p=102605;p<=102628;p++)T[p]=0;for(p=102629;p<=102646;p++)T[p]=2;for(p=102648;p<=102700;p++)T[p]=2;for(p=102701;p<=102703;p++)T[p]=0;for(p=102707;p<=102730;p++)T[p]=2;for(p=102733;p<=102758;p++)T[p]=2;for(p=102767;p<=102900;p++)T[p]=0;for(p=102901;p<=102933;p++)T[p]=2;for(p=102934;p<=102950;p++)T[p]=13;for(p=102951;p<=102963;p++)T[p]=0;for(p=102965;p<=102969;p++)T[p]=0;for(p=102971;p<=102973;p++)T[p]=0;for(p=102975;p<=102989;p++)T[p]=0;for(p=102990;p<=102992;p++)T[p]=1;for(p=102997;p<=103002;p++)T[p]=0;for(p=103003;p<=103008;p++)T[p]=2;for(p=103009;p<=103011;p++)T[p]=0;for(p=103012;p<=103014;p++)T[p]=2;for(p=103019;p<=103021;p++)T[p]=0;for(p=103022;p<=103024;p++)T[p]=2;for(p=103029;p<=103031;p++)T[p]=0;for(p=103032;p<=103034;p++)T[p]=2;for(p=103065;p<=103068;p++)T[p]=0;for(p=103074;p<=103076;p++)T[p]=0;for(p=103077;p<=103079;p++)T[p]=1;for(p=103080;p<=103082;p++)T[p]=0;for(p=103083;p<=103085;p++)T[p]=2;for(p=103090;p<=103093;p++)T[p]=0;for(p=103097;p<=103099;p++)T[p]=0;for(p=103100;p<=103102;p++)T[p]=2;for(p=103107;p<=103109;p++)T[p]=0;for(p=103110;p<=103112;p++)T[p]=2;for(p=103113;p<=103116;p++)T[p]=0;for(p=103117;p<=103120;p++)T[p]=2;for(p=103153;p<=103157;p++)T[p]=0;for(p=103158;p<=103162;p++)T[p]=2;for(p=103163;p<=103165;p++)T[p]=0;for(p=103166;p<=103168;p++)T[p]=1;for(p=103169;p<=103171;p++)T[p]=2;for(p=103186;p<=103188;p++)T[p]=0;for(p=103189;p<=103191;p++)T[p]=2;for(p=103192;p<=103195;p++)T[p]=0;for(p=103196;p<=103199;p++)T[p]=2;for(p=103200;p<=103224;p++)T[p]=0;for(p=103225;p<=103227;p++)T[p]=1;for(p=103232;p<=103237;p++)T[p]=0;for(p=103238;p<=103243;p++)T[p]=2;for(p=103244;p<=103246;p++)T[p]=0;for(p=103247;p<=103249;p++)T[p]=2;for(p=103254;p<=103256;p++)T[p]=0;for(p=103257;p<=103259;p++)T[p]=2;for(p=103264;p<=103266;p++)T[p]=0;for(p=103267;p<=103269;p++)T[p]=2;for(p=103300;p<=103375;p++)T[p]=0;for(p=103381;p<=103383;p++)T[p]=0;for(p=103384;p<=103386;p++)T[p]=1;for(p=103387;p<=103389;p++)T[p]=0;for(p=103390;p<=103392;p++)T[p]=2;for(p=103397;p<=103399;p++)T[p]=0;for(p=103400;p<=103471;p++)T[p]=2;for(p=103476;p<=103478;p++)T[p]=0;for(p=103479;p<=103481;p++)T[p]=2;for(p=103486;p<=103488;p++)T[p]=0;for(p=103489;p<=103491;p++)T[p]=2;for(p=103492;p<=103495;p++)T[p]=0;for(p=103496;p<=103499;p++)T[p]=2;for(p=103528;p<=103543;p++)T[p]=0;for(p=103544;p<=103548;p++)T[p]=2;for(p=103549;p<=103551;p++)T[p]=0;for(p=103552;p<=103554;p++)T[p]=1;for(p=103555;p<=103557;p++)T[p]=2;for(p=103558;p<=103560;p++)T[p]=0;for(p=103571;p<=103573;p++)T[p]=0;for(p=103574;p<=103576;p++)T[p]=2;for(p=103577;p<=103580;p++)T[p]=0;for(p=103581;p<=103583;p++)T[p]=2;for(p=103595;p<=103694;p++)T[p]=0;for(p=103696;p<=103699;p++)T[p]=0;for(p=103700;p<=103793;p++)T[p]=2;for(p=103794;p<=103890;p++)T[p]=0;for(p=103891;p<=103896;p++)T[p]=2;for(p=103900;p<=103971;p++)T[p]=2;for(p=103972;p<=103977;p++)T[p]=0;for(p=112e3;p<=112101;p++)T[p]=0;const T4=[102100,102113,3857,3785,900913],QZ=[104905,104971],eY=[4326,...T4,...QZ],Gy=[-20037508342788905e-9,20037508342788905e-9],lx=[-20037508342787e-6,20037508342787e-6],Qw={wkTemplate:'PROJCS["WGS_1984_Web_Mercator_Auxiliary_Sphere",GEOGCS["GCS_WGS_1984",DATUM["D_WGS_1984",SPHEROID["WGS_1984",6378137.0,298.257223563]],PRIMEM["Greenwich",0.0],UNIT["Degree",0.0174532925199433]],PROJECTION["Mercator_Auxiliary_Sphere"],PARAMETER["False_Easting",0.0],PARAMETER["False_Northing",0.0],PARAMETER["Central_Meridian",{Central_Meridian}],PARAMETER["Standard_Parallel_1",0.0],PARAMETER["Auxiliary_Sphere_Type",0.0],UNIT["Meter",1.0]]',valid:Gy,origin:lx,dx:1e-5},E4={102113:{wkTemplate:'PROJCS["WGS_1984_Web_Mercator",GEOGCS["GCS_WGS_1984_Major_Auxiliary_Sphere",DATUM["D_WGS_1984_Major_Auxiliary_Sphere",SPHEROID["WGS_1984_Major_Auxiliary_Sphere",6378137.0,0.0]],PRIMEM["Greenwich",0.0],UNIT["Degree",0.0174532925199433]],PROJECTION["Mercator"],PARAMETER["False_Easting",0.0],PARAMETER["False_Northing",0.0],PARAMETER["Central_Meridian",{Central_Meridian}],PARAMETER["Standard_Parallel_1",0.0],UNIT["Meter",1.0]]',valid:Gy,origin:lx,dx:1e-5},102100:Qw,3785:{wkTemplate:'PROJCS["WGS_1984_Web_Mercator",GEOGCS["GCS_WGS_1984_Major_Auxiliary_Sphere",DATUM["D_WGS_1984_Major_Auxiliary_Sphere",SPHEROID["WGS_1984_Major_Auxiliary_Sphere",6378137.0,0.0]],PRIMEM["Greenwich",0.0],UNIT["Degree",0.0174532925199433]],PROJECTION["Mercator"],PARAMETER["False_Easting",0.0],PARAMETER["False_Northing",0.0],PARAMETER["Central_Meridian",{Central_Meridian}],PARAMETER["Standard_Parallel_1",0.0],UNIT["Meter",1.0]]',valid:Gy,origin:lx,dx:1e-5},3857:Qw,4326:{wkTemplate:'GEOGCS["GCS_WGS_1984",DATUM["D_WGS_1984",SPHEROID["WGS_1984",6378137.0,298.257223563]],PRIMEM["Greenwich",{Central_Meridian}],UNIT["Degree",0.0174532925199433]]',altTemplate:'PROJCS["WGS_1984_Plate_Carree",GEOGCS["GCS_WGS_1984",DATUM["D_WGS_1984",SPHEROID["WGS_1984",6378137.0,298.257223563]],PRIMEM["Greenwich",0.0],UNIT["Degree",0.0174532925199433]],PROJECTION["Plate_Carree"],PARAMETER["False_Easting",0.0],PARAMETER["False_Northing",0.0],PARAMETER["Central_Meridian",{Central_Meridian}],UNIT["Degrees",111319.491]]',valid:[-180,180],origin:[-180,90],dx:1e-5},104971:{wkTemplate:'GEOGCS["Mars_2000_(Sphere)",DATUM["Mars_2000_(Sphere)",SPHEROID["Mars_2000_(Sphere)",3396190.0,0.0]],PRIMEM["Reference_Meridian",0.0],UNIT["Degree",0.0174532925199433]]',valid:[-180,180],origin:[-180,90],dx:1e-5},104905:{wkTemplate:'GEOGCS["GCS_Mars_2000",DATUM["D_Mars_2000",SPHEROID["Mars_2000_IAU_IAG",3396190.0,169.8944472236118]],PRIMEM["Reference_Meridian",0.0],UNIT["Degree",0.0174532925199433]]',valid:[-180,180],origin:[-180,90],dx:1e-5},900913:Qw};function ci(e,t){if(e===t)return!0;if(e==null||t==null)return!1;const i=e.wkid,r=t.wkid;if(i!=null||r!=null){if(i===r||Rn(e)&&Rn(t))return!0;const o=e.latestWkid;if(o!=null&&r===o)return!0;const a=t.latestWkid;return a!=null&&i===a}let s,n;return e.wkt2&&t.wkt2?(s=e.wkt2,n=t.wkt2):e.wkt&&t.wkt&&(s=e.wkt,n=t.wkt),!(!s||!n)&&s.toUpperCase()===n.toUpperCase()}function ar(e){const t=e?.wkid;return t!=null&&t>=2e3&&E4[t]||null}function C4(e){if(!e)return;const{wkid:t,vcsWkid:i}=e;if(t)return i?JSON.stringify({wkid:t,vcsWkid:i}):String(t);const r=e.wkt||e.wkt2;return JSON.stringify(r?i?{wkt:r,vcsWkid:i}:{wkt:r}:{})}function vh(e){if(!jr(e))return!1;const{wkid:t}=e;if(t)return T[t]==null;const i=e.wkt2||e.wkt;return!!i&&/^\s*(?:GEOGCS|GEOGCRS|GEOGRAPHICCRS)/i.test(i)}function tY(e){return!(P4(e)||I4(e))}function oh(e){return e?.wkid===4326}function fTe(e){return/^\s*(?:GEOD|GEODETIC|GEOG|GEOGRAPHIC|PROJ|PROJECTED|VERT|VERTICAL|ENG|ENGINEERING|PARAMETRIC|TIME|DERIVEDPROJ|COMPOUND|BOUND)CRS/i.test(e)}function y3(e){return e?.wkid===nh.CGCS2000}function Rn(e){const t=e?.wkid;return t!=null&&t>=2e3&&T4.includes(t)}function iY(e){return e?.wkid===32662}function Fb(e){return e===nh.GCSMARS2000||e===nh.GCSMARS2000_SPHERE}function P4(e){return Fb(e?.wkid)}function zb(e){return e===nh.GCSMOON2000}function I4(e){return zb(e?.wkid)}function rY(e){const t=e?.wkid;return t!=null&&t>=2e3&&eY.includes(t)}function jr(e){if(e==null)return!1;const t=e.wkid;return t!=null&&t>=2e3||e.wkt2!=null||e.wkt!=null}const A4={wkid:4326,wkt:mh(E4[4326].wkTemplate,{Central_Meridian:"0.0"})},L4={wkid:102100,latestWkid:3857},sY={wkid:32662};function eC(e){return{wkt:`GEOCCS["Spherical geocentric",
    DATUM["Not specified",
      SPHEROID["Sphere",${e.radius},0]],
    PRIMEM["Greenwich",0.0,
      AUTHORITY["EPSG","8901"]],
    UNIT["m",1.0],
    AXIS["Geocentric X",OTHER],
    AXIS["Geocentric Y",EAST],
    AXIS["Geocentric Z",NORTH]
  ]`}}const nY=eC(Ft),tC=eC(Do),iC=eC(du),oY={wkt:`GEOCCS["WGS 84",
  DATUM["WGS_1984",
    SPHEROID["WGS 84",${Ft.radius},298.257223563,
      AUTHORITY["EPSG","7030"]],
    AUTHORITY["EPSG","6326"]],
  PRIMEM["Greenwich",0,
    AUTHORITY["EPSG","8901"]],
  UNIT["m",1.0,
    AUTHORITY["EPSG","9001"]],
  AXIS["Geocentric X",OTHER],
  AXIS["Geocentric Y",OTHER],
  AXIS["Geocentric Z",NORTH],
  AUTHORITY["EPSG","4978"]
]`},aY=tC.wkt.toUpperCase(),lY=iC.wkt.toUpperCase();function uY(e){if(e!=null&&jr(e)){const t=e.wkid,i=e.wkt2??e.wkt;if(Fb(t))return Do;const r=i?.toUpperCase();if(i&&r===aY)return Do;if(zb(t)||r&&r===lY)return du}return Ft}function mTe(e){return Fb(e)?Do:zb(e)?du:Ft}function lv(e){return ci(e,nY)}function pu(e){return lv(e)||ci(e,tC)||ci(e,iC)}const k4=39.37,cY=Ft.radius*Math.PI/200,R4=/(?:LENGTH)?UNIT\[([^\]]+)]]$/i,Dp=T,O4=/UNIT\[([^\]]+)]/i,hY=new Set([4305,4807,4810,4811,4812,4816,4819,4821,4901,4902,37225,104025,104026,104139,104140]),dY=cr()({millimeter:"millimeters",centimeter:"centimeters",meter:"meters",meter_german:"german-meters",kilometer:"kilometers",decimeter:"decimeters",micrometer:"micrometers",nanometer:"nanometers","50_kilometers":"50-kilometers","150_kilometers":"150-kilometers",foot:"feet",foot_us:"us-feet",foot_clarke:"clarke-feet",fathom:"fathoms",nautical_mile:"nautical-miles",chain_us:"us-chains",link_us:"us-links",mile_us:"us-miles",yard_clarke:"clarke-yards",chain_clarke:"clarke-chains",link_clarke:"clarke-links",yard_sears:"sears-yards",foot_sears:"sears-feet",chain_sears:"sears-chains",link_sears:"sears-links",yard_benoit_1895_a:"benoit-1895-a-yards",foot_benoit_1895_a:"benoit-1895-a-feet",chain_benoit_1895_a:"benoit-1895-a-chains",link_benoit_1895_a:"benoit-1895-a-links",yard_benoit_1895_b:"benoit-1895-b-yards",foot_benoit_1895_b:"benoit-1895-b-feet",chain_benoit_1895_b:"benoit-1895-b-chains",link_benoit_1895_b:"benoit-1895-b-links",foot_1865:"1865-feet",foot_indian:"indian-feet",foot_indian_1937:"indian-1937-feet",foot_indian_1962:"indian-1962-feet",foot_indian_1975:"indian-1975-feet",yard_indian:"indian-yards",yard_indian_1937:"indian-1937-yards",yard_indian_1962:"indian-1962-yards",yard_indian_1975:"indian-1975-yards",statute_mile:"statute-miles",foot_gold_coast:"gold-coast-feet",foot_british_1936:"british-1936-feet",yard:"yards",chain:"chains",link:"links",yard_sears_1922_truncated:"sears-1922-truncated-yards",foot_sears_1922_truncated:"sears-1922-truncated-feet",chain_sears_1922_truncated:"sears-1922-truncated-chains",link_sears_1922_truncated:"sears-1922-truncated-links",yard_us:"us-yards",inch:"inches",inch_us:"us-inches",rod:"rods",rod_us:"us-rods",nautical_mile_us:"us-nautical-miles",nautical_mile_uk:"uk-nautical-miles",smoot:"smoots",vara_tx:"tx-vara",point:"points"}),Qs=e=>e*e,ol=e=>e*e*e,By={length:{baseUnit:"meters",units:{millimeters:{inBaseUnits:.001},centimeters:{inBaseUnits:.01},meters:{inBaseUnits:1},feet:{inBaseUnits:.3048},"us-feet":{inBaseUnits:.3048006096012192},"clarke-feet":{inBaseUnits:.3047972654},fathoms:{inBaseUnits:1.8288},"nautical-miles":{inBaseUnits:1852},"german-meters":{inBaseUnits:1.0000135965},"us-chains":{inBaseUnits:20.11684023368047},"us-links":{inBaseUnits:.2011684023368047},"us-miles":{inBaseUnits:1609.347218694438},kilometers:{inBaseUnits:1e3},"clarke-yards":{inBaseUnits:.9143917962},"clarke-chains":{inBaseUnits:20.1166195164},"clarke-links":{inBaseUnits:.201166195164},"sears-yards":{inBaseUnits:.9143984146160287},"sears-feet":{inBaseUnits:.3047994715386762},"sears-chains":{inBaseUnits:20.11676512155263},"sears-links":{inBaseUnits:.2011676512155263},"benoit-1895-a-yards":{inBaseUnits:.9143992},"benoit-1895-a-feet":{inBaseUnits:.3047997333333333},"benoit-1895-a-chains":{inBaseUnits:20.1167824},"benoit-1895-a-links":{inBaseUnits:.201167824},"benoit-1895-b-yards":{inBaseUnits:.9143992042898124},"benoit-1895-b-feet":{inBaseUnits:.3047997347632708},"benoit-1895-b-chains":{inBaseUnits:20.11678249437587},"benoit-1895-b-links":{inBaseUnits:.2011678249437587},"1865-feet":{inBaseUnits:.3048008333333334},"indian-feet":{inBaseUnits:.3047995102481469},"indian-1937-feet":{inBaseUnits:.30479841},"indian-1962-feet":{inBaseUnits:.3047996},"indian-1975-feet":{inBaseUnits:.3047995},"indian-yards":{inBaseUnits:.9143985307444408},"indian-1937-yards":{inBaseUnits:.91439523},"indian-1962-yards":{inBaseUnits:.9143988},"indian-1975-yards":{inBaseUnits:.9143985},miles:{inBaseUnits:1609.344},"statute-miles":{inBaseUnits:1609.344},"gold-coast-feet":{inBaseUnits:.3047997101815088},"british-1936-feet":{inBaseUnits:.3048007491},yards:{inBaseUnits:.9144},chains:{inBaseUnits:20.1168},links:{inBaseUnits:.201168},"sears-1922-truncated-yards":{inBaseUnits:.914398},"sears-1922-truncated-feet":{inBaseUnits:.3047993333333334},"sears-1922-truncated-chains":{inBaseUnits:20.116756},"sears-1922-truncated-links":{inBaseUnits:.20116756},"us-yards":{inBaseUnits:.9144018288036576},decimeters:{inBaseUnits:.1},inches:{inBaseUnits:.0254},"us-inches":{inBaseUnits:.0254000508001016},rods:{inBaseUnits:5.0292},"us-rods":{inBaseUnits:5.029210058420118},"us-nautical-miles":{inBaseUnits:1853.248},"uk-nautical-miles":{inBaseUnits:1853.184},smoots:{inBaseUnits:1.7018},"tx-vara":{inBaseUnits:.8466683600033867},points:{inBaseUnits:.0003527777777777778},micrometers:{inBaseUnits:1e-6},nanometers:{inBaseUnits:1e-9},"50-kilometers":{inBaseUnits:5e4},"150-kilometers":{inBaseUnits:15e4}}},area:{baseUnit:"square-meters",units:{"square-millimeters":{inBaseUnits:Qs(.001)},"square-centimeters":{inBaseUnits:Qs(.01)},"square-decimeters":{inBaseUnits:Qs(.1)},"square-meters":{inBaseUnits:1},"square-kilometers":{inBaseUnits:Qs(1e3)},"square-inches":{inBaseUnits:Qs(.0254)},"square-feet":{inBaseUnits:Qs(.3048)},"square-yards":{inBaseUnits:Qs(.9144)},"square-miles":{inBaseUnits:Qs(1609.344)},"square-nautical-miles":{inBaseUnits:Qs(1852)},"square-us-feet":{inBaseUnits:Qs(1200/3937)},acres:{inBaseUnits:.0015625*Qs(1609.344)},ares:{inBaseUnits:100},hectares:{inBaseUnits:1e4}}},volume:{baseUnit:"liters",units:{liters:{inBaseUnits:1},"cubic-millimeters":{inBaseUnits:1e3*ol(.001)},"cubic-centimeters":{inBaseUnits:1e3*ol(.01)},"cubic-decimeters":{inBaseUnits:1e3*ol(.1)},"cubic-meters":{inBaseUnits:1e3},"cubic-kilometers":{inBaseUnits:1e3*ol(1e3)},"cubic-inches":{inBaseUnits:1e3*ol(.0254)},"cubic-feet":{inBaseUnits:1e3*ol(.3048)},"cubic-yards":{inBaseUnits:1e3*ol(.9144)},"cubic-miles":{inBaseUnits:1e3*ol(1609.344)}}},angle:{baseUnit:"radians",units:{radians:{inBaseUnits:1},degrees:{inBaseUnits:Math.PI/180}}}},pY=(()=>{const e={};for(const t in By)for(const i in By[t].units)e[i]=t;return e})();function fY(e,t,i){return e*By[i].units[t].inBaseUnits}function mY(e,t,i){return e/By[i].units[t].inBaseUnits}const yY=["inches","feet","yards","miles","nautical-miles","us-feet","millimeters","centimeters","decimeters","meters","kilometers"],gY=["metric","imperial"],N4=[...gY,...yY],_Y=new Map([["meters","square-meters"],["feet","square-feet"],["us-feet","square-us-feet"]]);function ux(e){const t=pY[e];if(!t)throw new Error("unknown type");return t}function g3(e,t=null){return t=t||ux(e),By[t].baseUnit===e}function it(e,t,i){if(t===i)return e;const r=ux(t);if(r!==ux(i))throw new Error("incompatible units");const s=g3(t,r)?e:fY(e,t,r);return g3(i,r)?s:mY(s,i,r)}function yTe(e,t,i,r=!1){if(!r&&vh(t))throw new Error("Unable to convert from an angular unit to a linear unit.");const s=bh(t);return s!==i&&(e=s?it(e,s,i):it(e*=Hs(t),"meters",i)),e}function gTe(e,t,i,r=!1){if(!r&&vh(i))throw new Error("Unable to convert from a linear unit to an angular unit.");const s=bh(i);return t!==s&&(e=s?it(e,t,s):it(e,t,"meters")/Hs(i)),e}function vY(e){switch(e){case"metric":return"meters";case"imperial":return"feet";default:return e}}function _Te(e){return vY(e)}function vTe(e){switch(e){case"metric":return"square-meters";case"imperial":return"square-feet";default:return e}}function bTe(e,t){const i=it(e,t,"meters");return Math.abs(i)<3e3?"meters":"kilometers"}function wTe(e,t){const i=it(e,t,"meters");return Math.abs(i)<1e5?"meters":"kilometers"}function STe(e,t){const i=it(e,t,"feet");return Math.abs(i)<1e3?"feet":"miles"}function xTe(e,t){const i=it(e,t,"feet");return Math.abs(i)<1e5?"feet":"miles"}function $Te(e,t){const i=it(e,t,"square-meters");return Math.abs(i)<3e6?"square-meters":"square-kilometers"}function MTe(e,t){const i=it(e,t,"square-feet");return Math.abs(i)<1e6?"square-feet":"square-miles"}function bY(e,t,i){return it(e,t,"meters")/(i*Math.PI/180)}function rC(e){return dY.fromJSON(e.toLowerCase())||null}function _3(e){if(e!=null&&!tY(e))return 1;const t=Hs(e);return t>1e5?1:t}function D4(e){return Hs(e)>=uY(e).metersPerDegree?"meters":bh(e)}function Hs(e,t=Ft.metersPerDegree){return F4(e,!0)??t}function F4(e,t=!1){const i=e?.wkid??null,r=e?.wkt2??e?.wkt??null;let s=null;if(i){if(Fb(i))return Do.metersPerDegree;if(zb(i))return du.metersPerDegree;s=Dp.values[Dp[i]],!s&&t&&hY.has(i)&&(s=cY)}else r&&(U4(r)?s=v3(R4.exec(r),s):V4(r)&&(s=v3(O4.exec(r),s)));return s}function TTe(e){return vh(e)?1:Hs(e)}function v3(e,t){return e?.[1]?z4(e[1]):t}function z4(e){return parseFloat(e.split(",")[1])}function bh(e){const t=e?.wkid??null,i=e?.wkt2??e?.wkt??null;let r=null;if(t)r=Dp.units[Dp[t]];else if(i){const s=U4(i)?R4:V4(i)?O4:null;if(s){const n=s.exec(i);n?.[1]&&(r=SY(n[1]))}}return r!=null?rC(r):null}function ETe(e){const t=bh(e);return t!=null&&N4.includes(t)?t:null}function CTe(e){const t=D4(e);return t!=null&&N4.includes(t)?t:null}function PTe(e){const t=bh(e);return t==null?null:_Y.get(t)}function V4(e){return/^GEOCCS/i.test(e)}function U4(e){return/^\s*(?:PROJCS|PROJCRS|PROJECTEDCRS)/i.test(e)}const wY=1e-7;function SY(e){let i=/[\\"']{1}([^\\"']+)/.exec(e)?.[1];if(!i||!rC(i)){const r=z4(e);i=null;const s=Dp.values;for(let n=0;n<s.length;++n)if(Math.abs(r-s[n])<wY){i=Dp.units[n];break}}return i}function xY(e){const t=bh(e);if(t==null)return null;switch(t){case"feet":case"us-feet":case"clarke-feet":case"fathoms":case"nautical-miles":case"us-chains":case"us-links":case"us-miles":case"clarke-yards":case"clarke-chains":case"clarke-links":case"sears-yards":case"sears-feet":case"sears-chains":case"sears-links":case"benoit-1895-a-yards":case"benoit-1895-a-feet":case"benoit-1895-a-chains":case"benoit-1895-a-links":case"benoit-1895-b-yards":case"benoit-1895-b-feet":case"benoit-1895-b-chains":case"benoit-1895-b-links":case"1865-feet":case"indian-feet":case"indian-1937-feet":case"indian-1962-feet":case"indian-1975-feet":case"indian-yards":case"indian-1937-yards":case"indian-1962-yards":case"indian-1975-yards":case"statute-miles":case"gold-coast-feet":case"british-1936-feet":case"yards":case"chains":case"links":case"sears-1922-truncated-yards":case"sears-1922-truncated-feet":case"sears-1922-truncated-chains":case"sears-1922-truncated-links":case"us-yards":case"inches":case"us-inches":case"rods":case"us-rods":case"us-nautical-miles":case"uk-nautical-miles":case"smoots":case"tx-vara":case"points":return"imperial";case"millimeters":case"centimeters":case"meters":case"german-meters":case"kilometers":case"decimeters":case"micrometers":case"nanometers":case"50-kilometers":case"150-kilometers":return"metric"}return null}const $Y={esriAcres:"acres",esriAres:"ares",esriHectares:"hectares",esriSquareCentimeters:"square-centimeters",esriSquareDecimeters:"square-decimeters",esriSquareFeet:"square-feet",esriSquareInches:"square-inches",esriSquareKilometers:"square-kilometers",esriSquareMeters:"square-meters",esriSquareMiles:"square-miles",esriSquareMillimeters:"square-millimeters",esriSquareUsFeet:"square-us-feet",esriSquareYards:"square-yards"},MY={esriCentimeters:"centimeters",esriDecimeters:"decimeters",esriFeet:"feet",esriInches:"inches",esriKilometers:"kilometers",esriMeters:"meters",esriMiles:"miles",esriMillimeters:"millimeters",esriNauticalMiles:"nautical-miles",esriYards:"yards"},TY={esriDUDecimalDegrees:"degrees",esriDURadians:"radians"},ITe=cr()($Y),ATe=cr()(MY),LTe=cr()(TY);var Gn,oo;let ae=(oo=class extends ee{static fromJSON(t){if(!t)return null;if(t?.wkid===102100)return Gn.WebMercator;if(t?.wkid===4326)return Gn.WGS84;const i=new Gn;return i.read(t),i}constructor(t){super(t),this.latestWkid=null,this.wkid=null,this.wkt=null,this.wkt2=null,this.vcsWkid=null,this.latestVcsWkid=null,this.imageCoordinateSystem=null}normalizeCtorArgs(t){return t&&typeof t=="object"?t:{[typeof t=="string"?"wkt":"wkid"]:t}}get isWGS84(){return oh(this)}get isWebMercator(){return Rn(this)}get isGeographic(){return vh(this)}get isWrappable(){return rY(this)}get metersPerUnit(){return Hs(this)}get unit(){return bh(this)||(this.isGeographic?"degrees":null)}writeWkt(t,i){this.wkid||(i.wkt=t)}clone(){if(this===Gn.WGS84)return new Gn(A4);if(this===Gn.WebMercator)return new Gn(L4);const t=new Gn;return this.wkid!=null?(t.wkid=this.wkid,this.latestWkid!=null&&(t.latestWkid=this.latestWkid),this.vcsWkid!=null&&(t.vcsWkid=this.vcsWkid),this.latestVcsWkid!=null&&(t.latestVcsWkid=this.latestVcsWkid)):(this.wkt!=null&&(t.wkt=this.wkt),this.wkt2!=null&&(t.wkt2=this.wkt2)),this.imageCoordinateSystem&&(t.imageCoordinateSystem=V(this.imageCoordinateSystem)),t}equals(t){if(t==null)return!1;if(this.imageCoordinateSystem||t.imageCoordinateSystem){if(this.imageCoordinateSystem==null||t.imageCoordinateSystem==null)return!1;const{id:i,referenceServiceName:r}=t.imageCoordinateSystem,{geodataXform:s}=t.imageCoordinateSystem,n=this.imageCoordinateSystem;return i==null||s?JSON.stringify(n)===JSON.stringify(t.imageCoordinateSystem):r?n.id===i&&n.referenceServiceName===r:n.id===i}return ci(this,t)}toJSON(t){return this.write(void 0,t)}},Gn=oo,oo.GCS_NAD_1927=null,oo.WGS84=null,oo.WebMercator=null,oo.PlateCarree=null,oo);h([f({readOnly:!0})],ae.prototype,"isWGS84",null),h([f({readOnly:!0})],ae.prototype,"isWebMercator",null),h([f({readOnly:!0})],ae.prototype,"isGeographic",null),h([f({readOnly:!0})],ae.prototype,"isWrappable",null),h([f({type:Ue,json:{write:!0}})],ae.prototype,"latestWkid",void 0),h([f({readOnly:!0})],ae.prototype,"metersPerUnit",null),h([f({readOnly:!0})],ae.prototype,"unit",null),h([f({type:Ue,json:{write:!0,origins:{"web-scene":{write:{overridePolicy(){return{isRequired:this.wkt==null}}}}}}})],ae.prototype,"wkid",void 0),h([f({type:String,json:{origins:{"web-scene":{write:{overridePolicy(){return{isRequired:this.wkid==null}}}}}}})],ae.prototype,"wkt",void 0),h([$e("wkt"),$e("web-scene","wkt")],ae.prototype,"writeWkt",null),h([f({type:String,json:{write:!1}})],ae.prototype,"wkt2",void 0),h([f({type:Ue,json:{write:!0}})],ae.prototype,"vcsWkid",void 0),h([f({type:Ue,json:{write:!0}})],ae.prototype,"latestVcsWkid",void 0),h([f()],ae.prototype,"imageCoordinateSystem",void 0),ae=Gn=h([I("esri.geometry.SpatialReference")],ae),ae.prototype.toJSON.isDefaultToJSON=!0,ae.GCS_NAD_1927=le.freeze(new ae({wkid:4267,wkt:'GEOGCS["GCS_North_American_1927",DATUM["D_North_American_1927",SPHEROID["Clarke_1866",6378206.4,294.9786982]],PRIMEM["Greenwich",0.0],UNIT["Degree",0.0174532925199433]]'})),ae.WGS84=le.freeze(new ae(A4)),ae.WebMercator=le.freeze(new ae(L4)),ae.PlateCarree=le.freeze(new ae(sY));function Ae(e,t,i){let r,s;return t===void 0||Array.isArray(t)?(s=e,i=t,r=[void 0]):(s=t,r=Array.isArray(e)?e:[e]),(n,o)=>{const a=n.constructor.prototype;r.forEach((l=>{const u=qE(n,l,s);u.read&&typeof u.read=="object"||(u.read={}),u.read.reader=a[o],i&&(u.read.source=(u.read.source||[]).concat(i))}))}}let Ci=class extends ee{constructor(...t){super(...t),this.type=null,this.hasM=!1,this.hasZ=!1,this.spatialReference=ae.WGS84}get cache(){return this.commitProperty("spatialReference"),{}}get extent(){return null}readSpatialReference(t,i){if(t instanceof ae)return t;if(t!=null){const r=new ae;return r.read(t,i),r}return t}clone(){return console.warn(".clone() is not implemented for "+this.declaredClass),null}clearCache(){this.notifyChange("cache")}getCacheValue(t){return this.cache[t]}setCacheValue(t,i){this.cache[t]=i}};h([f()],Ci.prototype,"type",void 0),h([f({readOnly:!0})],Ci.prototype,"cache",null),h([f({readOnly:!0})],Ci.prototype,"extent",null),h([f({type:Boolean,json:{write:{overridePolicy:e=>({enabled:e})}}})],Ci.prototype,"hasM",void 0),h([f({type:Boolean,json:{write:{overridePolicy:e=>({enabled:e})}}})],Ci.prototype,"hasZ",void 0),h([f({type:ae,json:{write:!0},value:ae.WGS84})],Ci.prototype,"spatialReference",void 0),h([Ae("spatialReference")],Ci.prototype,"readSpatialReference",null),Ci=h([I("esri.geometry.Geometry")],Ci);const EY=Object.prototype.toString;function CY(e){const t="__accessorMetadata__"in e?Ui(e):e;return function(...i){if(i.push(t),typeof i[2]=="number")throw new Error("Using @cast has parameter decorator is not supported since 4.16");return PY.apply(this,i)}}function PY(e,t,i,r){Ag(e,t).cast=r}function IY(e){return(t,i)=>{Ag(t,e).cast=t[i]}}function Ke(...e){if(e.length!==3||typeof e[1]!="string")return e.length===1&&EY.call(e[0])==="[object Function]"?CY(e[0]):e.length===1&&typeof e[0]=="string"?IY(e[0]):void 0}function Fp(e){if(e&&typeof e=="object"&&"type"in e&&e.type==="mesh")throw new j("internal:mesh","Mesh geometries are not supported for this operation")}function AY(e){e.forEach(Fp)}const LY=57.29577951308232,kY=.017453292519943;function b3(e){return e*LY}function w3(e){return e*kY}function RTe(e){return Math.PI/2-2*Math.atan(Math.exp(-e/Ft.radius))}function cx(e){return e.wkid!=null||e.wkt!=null}const e2=[0,0];function uv(e,t,i,r,s){const n=e,o=s;if(o.spatialReference=i,"x"in n&&"x"in o)[o.x,o.y]=t(n.x,n.y,e2,r);else if("xmin"in n&&"xmin"in o)[o.xmin,o.ymin]=t(n.xmin,n.ymin,e2,r),[o.xmax,o.ymax]=t(n.xmax,n.ymax,e2,r);else if("paths"in n&&"paths"in o||"rings"in n&&"rings"in o){const a="paths"in n?n.paths:n.rings,l=[];let u;for(let c=0;c<a.length;c++){const d=a[c];u=[],l.push(u);for(let m=0;m<d.length;m++)u.push(t(d[m][0],d[m][1],[0,0],r)),d[m].length>2&&u[m].push(d[m][2]),d[m].length>3&&u[m].push(d[m][3])}"paths"in o?o.paths=l:o.rings=l}else if("points"in n&&"points"in o){const a=n.points,l=[];for(let u=0;u<a.length;u++)l[u]=t(a[u][0],a[u][1],[0,0],r),a[u].length>2&&l[u].push(a[u][2]),a[u].length>3&&l[u].push(a[u][3]);o.points=l}return s}function C_(e,t){const i=e&&(cx(e)?e:e.spatialReference),r=t&&(cx(t)?t:t.spatialReference);return!(e&&"type"in e&&e.type==="mesh"||t&&"type"in t&&t.type==="mesh"||!i||!r)&&(!!ci(r,i)||Rn(r)&&oh(i)||Rn(i)&&oh(r))}function Vb(e,t){if(e==null)return null;const i=e.spatialReference,r=t&&(cx(t)?t:t.spatialReference);return C_(i,r)?ci(i,r)?V(e):Rn(r)?uv(e,Md,ae.WebMercator,!1,V(e)):oh(r)?uv(e,Ub,ae.WGS84,!1,V(e)):null:null}function Md(e,t,i=[0,0]){t>89.99999?t=89.99999:t<-89.99999&&(t=-89.99999);const r=w3(t);return i[0]=w3(e)*Ft.radius,i[1]=Ft.halfSemiMajorAxis*Math.log((1+Math.sin(r))/(1-Math.sin(r))),i}function Ub(e,t,i=[0,0],r=!1){if(e===Gy[0])i[0]=-180;else if(e===Gy[1])i[0]=180;else{const s=b3(e/Ft.radius);i[0]=r?s:s-360*Math.floor((s+180)/360)}return i[1]=b3(Math.PI/2-2*Math.atan(Math.exp(-t/Ft.radius))),i}function jc(e,t=!1,i=V(e)){return Fp(e),Fp(i),uv(e,Md,ae.WebMercator,t,i)}function Td(e,t=!1,i=V(e)){return Fp(e),Fp(i),uv(e,Ub,ae.WGS84,t,i)}function j4(e,t){const i=e.x-t.x,r=e.y-t.y,s=e.z!=null&&t.z!=null?e.z-t.z:0;return Math.sqrt(i*i+r*r+s*s)}function RY(e){return G4(e,B4)?.[0]??null}function OY(e){return G4(e,B4)?.[1]??null}function G4({x:e,y:t,spatialReference:i},r=[0,0]){if(i){if(Rn(i))return Ub(e,t,r);if(vh(i))return r[0]=e,r[1]=t,r}return null}const B4=[0,0];var P_;const t2=[0,0];function S3(e){return e&&(e.declaredClass==="esri.geometry.SpatialReference"||e.wkid!=null)}let he=P_=class extends Ci{static copy(e,t){t._set("x",e._get("x")),t._set("y",e._get("y")),t._set("z",e._get("z")),t._set("m",e._get("m"));const i=e._get("spatialReference");t._set("spatialReference",le.isFrozen(i)?i:i.clone())}constructor(...e){super(...e),this.x=0,this.y=0,this.z=void 0,this.m=void 0,this.type="point"}normalizeCtorArgs(e,t,i,r,s){let n;if(Array.isArray(e))n=e,s=t,e=n[0],t=n[1],i=n[2],r=n[3];else if(e&&typeof e=="object"){if(n=e,e=n.x!=null?n.x:n.longitude,t=n.y!=null?n.y:n.latitude,i=n.z,r=n.m,(s=n.spatialReference)&&s.declaredClass!=="esri.geometry.SpatialReference"&&(s=new ae(s)),n.longitude!=null||n.latitude!=null){if(n.longitude==null)H.getLogger(this).warn(".longitude=","Latitude was defined without longitude");else if(n.latitude==null)H.getLogger(this).warn(".latitude=","Longitude was defined without latitude");else if(!n.declaredClass&&s?.isWebMercator){const a=Md(n.longitude,n.latitude,t2);e=a[0],t=a[1]}}}else S3(i)?(s=i,i=null):S3(r)&&(s=r,r=null);const o={x:e,y:t};return o.x==null&&o.y!=null?H.getLogger(this).warn(".y=","Y coordinate was defined without an X coordinate"):o.y==null&&o.x!=null&&H.getLogger(this).warn(".x=","X coordinate was defined without a Y coordinate"),s!=null&&(o.spatialReference=s),i!=null&&(o.z=i),r!=null&&(o.m=r),o}get cache(){return this.commitProperty("x"),this.commitProperty("y"),this.commitProperty("z"),this.commitProperty("m"),this.commitProperty("spatialReference"),{}}get hasM(){return this.m!==void 0}set hasM(e){e!==(this._get("m")!==void 0)&&(this._set("m",e?0:void 0),this._set("hasM",e))}get hasZ(){return this.z!==void 0}set hasZ(e){e!==(this._get("z")!==void 0)&&(this._set("z",e?0:void 0),this._set("hasZ",e))}get latitude(){return OY(this)}set latitude(e){const{spatialReference:t,x:i}=this;e!=null&&t&&(t.isWebMercator?this._set("y",Md(i,e,t2)[1]):t.isGeographic&&this._set("y",e),this._set("latitude",e))}get longitude(){return RY(this)}set longitude(e){const{y:t,spatialReference:i}=this;e!=null&&i&&(i.isWebMercator?this._set("x",Md(e,t,t2)[0]):i.isGeographic&&this._set("x",e),this._set("longitude",e))}writeX(e,t,i){t[i]=isNaN(e)?"NaN":e}readX(e){return typeof e=="string"?NaN:e}clone(){const e=new P_;return e.x=this.x,e.y=this.y,e.z=this.z,e.m=this.m,e.spatialReference=this.spatialReference,e}copy(e){return P_.copy(e,this),this}equals(e){if(e==null)return!1;const{x:t,y:i,z:r,m:s,spatialReference:n}=this,{z:o,m:a}=e;let{x:l,y:u,spatialReference:c}=e;if(!n.equals(c))if(n.isWebMercator&&c.isWGS84)[l,u]=Md(l,u),c=n;else{if(!n.isWGS84||!c.isWebMercator)return!1;[l,u]=Ub(l,u),c=n}return t===l&&i===u&&r===o&&s===a&&n.wkid===c.wkid}offset(e,t,i){return this.x+=e,this.y+=t,i!=null&&(this.z=(this.z??0)+i),this}normalize(){if(!this.spatialReference)return this;const e=ar(this.spatialReference);if(!e)return this;let t=this.x;const[i,r]=e.valid,s=2*r;let n;return t>r?(n=Math.ceil(Math.abs(t-r)/s),t-=n*s):t<i&&(n=Math.ceil(Math.abs(t-i)/s),t+=n*s),this._set("x",t),this}distance(e){return j4(this,e)}toArray(){const e=this.hasZ,t=this.hasM;return e&&t?[this.x,this.y,this.z,this.m]:e?[this.x,this.y,this.z]:t?[this.x,this.y,this.m]:[this.x,this.y]}toJSON(e){return this.write({},e)}};h([f({readOnly:!0})],he.prototype,"cache",null),h([f({type:Boolean,json:{read:!1,write:{enabled:!1,overridePolicy:null}}})],he.prototype,"hasM",null),h([f({type:Boolean,json:{read:!1,write:{enabled:!1,overridePolicy:null}}})],he.prototype,"hasZ",null),h([f({type:Number})],he.prototype,"latitude",null),h([f({type:Number})],he.prototype,"longitude",null),h([f({type:Number,json:{type:[Number,String],write:{isRequired:!0,allowNull:!0}}}),Ke((e=>isNaN(e)?e:us(e)))],he.prototype,"x",void 0),h([$e("x")],he.prototype,"writeX",null),h([Ae("x")],he.prototype,"readX",null),h([f({type:Number,json:{write:!0}})],he.prototype,"y",void 0),h([f({type:Number,json:{write:{overridePolicy(){return{enabled:this.hasZ}}}}})],he.prototype,"z",void 0),h([f({type:Number,json:{write:{overridePolicy(){return{enabled:this.hasM}}}}})],he.prototype,"m",void 0),he=P_=h([I("esri.geometry.Point")],he),he.prototype.toJSON.isDefaultToJSON=!0;const i2=[0,0];function Ng(e,t){return t!=null&&mr(e,t.x,t.y,t.z)}function OTe(e,t){if(!t.points?.length)return!1;for(const i of t.points)if(!zp(e,i))return!1;return!0}function NY(e,t){const{xmin:i,ymin:r,zmin:s,xmax:n,ymax:o,zmax:a}=t;return e.hasZ&&t.hasZ?mr(e,i,r,s)&&mr(e,i,o,s)&&mr(e,n,o,s)&&mr(e,n,r,s)&&mr(e,i,r,a)&&mr(e,i,o,a)&&mr(e,n,o,a)&&mr(e,n,r,a):mr(e,i,r)&&mr(e,i,o)&&mr(e,n,o)&&mr(e,n,r)}function zp(e,t){return mr(e,t[0],t[1])}function DY(e,t){return mr(e,t[0],t[1],t[2])}function mr(e,t,i,r){return t>=e.xmin&&t<=e.xmax&&i>=e.ymin&&i<=e.ymax&&(r==null||!e.hasZ||r>=e.zmin&&r<=e.zmax)}function sC(e,t){return i2[1]=t.y,i2[0]=t.x,FY(e,i2)}function FY(e,t){return nC(e.rings,t)}function nC(e,t){if(!e)return!1;if(zY(e))return x3(!1,e,t);let i=!1;for(let r=0,s=e.length;r<s;r++)i=x3(i,e[r],t);return i}function zY(e){return!Array.isArray(e[0][0])}function x3(e,t,i){const[r,s]=i;let n=e,o=0;for(let a=0,l=t.length;a<l;a++){o++,o===l&&(o=0);const[u,c]=t[a],[d,m]=t[o];(c<s&&m>=s||m<s&&c>=s)&&u+(s-c)/(m-c)*(d-u)<r&&(n=!n)}return n}function VY(e,t){return Ng(e,t)}function UY(e,t){const i=e.hasZ&&t.hasZ;let r,s,n;if(e.xmin<=t.xmin){if(r=t.xmin,e.xmax<r)return!1}else if(r=e.xmin,t.xmax<r)return!1;if(e.ymin<=t.ymin){if(s=t.ymin,e.ymax<s)return!1}else if(s=e.ymin,t.ymax<s)return!1;if(i&&t.hasZ){if(e.zmin<=t.zmin){if(n=t.zmin,e.zmax<n)return!1}else if(n=e.zmin,t.zmax<n)return!1}return!0}function jY(e,t){const{points:i,hasZ:r}=t,s=r?DY:zp;for(const n of i)if(s(e,n))return!0;return!1}const ah=[0,0],lh=[0,0],uh=[0,0],ch=[0,0],GY=[ah,lh,uh,ch],q4=[[uh,ah],[ah,lh],[lh,ch],[ch,uh]];function BY(e,t){return qY(e,t.rings)}function qY(e,t){ah[0]=e.xmin,ah[1]=e.ymax,lh[0]=e.xmax,lh[1]=e.ymax,uh[0]=e.xmin,uh[1]=e.ymin,ch[0]=e.xmax,ch[1]=e.ymin;for(const i of GY)if(nC(t,i))return!0;for(const i of t){if(!i.length)continue;let r=i[0];if(zp(e,r))return!0;for(let s=1;s<i.length;s++){const n=i[s];if(zp(e,n)||H4(r,n,q4))return!0;r=n}}return!1}function HY(e,t){ah[0]=e.xmin,ah[1]=e.ymax,lh[0]=e.xmax,lh[1]=e.ymax,uh[0]=e.xmin,uh[1]=e.ymin,ch[0]=e.xmax,ch[1]=e.ymin;const i=t.paths;for(const r of i){if(!i.length)continue;let s=r[0];if(zp(e,s))return!0;for(let n=1;n<r.length;n++){const o=r[n];if(zp(e,o)||H4(s,o,q4))return!0;s=o}}return!1}const Si=[0,0];function WY(e){for(let t=0;t<e.length;t++){const i=e[t];for(let s=0;s<i.length-1;s++){const n=i[s],o=i[s+1];for(let a=t+1;a<e.length;a++)for(let l=0;l<e[a].length-1;l++){const u=e[a][l],c=e[a][l+1];if(cv(n,o,u,c,Si)&&!(Si[0]===n[0]&&Si[1]===n[1]||Si[0]===u[0]&&Si[1]===u[1]||Si[0]===o[0]&&Si[1]===o[1]||Si[0]===c[0]&&Si[1]===c[1]))return!0}}const r=i.length;if(!(r<=4))for(let s=0;s<r-3;s++){let n=r-1;s===0&&(n=r-2);const o=i[s],a=i[s+1];for(let l=s+2;l<n;l++){const u=i[l],c=i[l+1];if(cv(o,a,u,c,Si)&&!(Si[0]===o[0]&&Si[1]===o[1]||Si[0]===u[0]&&Si[1]===u[1]||Si[0]===a[0]&&Si[1]===a[1]||Si[0]===c[0]&&Si[1]===c[1]))return!0}}}return!1}function H4(e,t,i){for(let r=0;r<i.length;r++)if(cv(e,t,i[r][0],i[r][1]))return!0;return!1}function cv(e,t,i,r,s){const[n,o]=e,[a,l]=t,[u,c]=i,[d,m]=r,y=d-u,g=n-u,_=a-n,v=m-c,b=o-c,S=l-o,$=v*_-y*S;if($===0)return!1;const E=(y*b-v*g)/$,C=(_*b-S*g)/$;return E>=0&&E<=1&&C>=0&&C<=1&&(s&&(s[0]=n+E*(a-n),s[1]=o+E*(l-o)),!0)}function ZY(e){switch(e){case"esriGeometryEnvelope":case"extent":return UY;case"esriGeometryMultipoint":case"multipoint":return jY;case"esriGeometryPoint":case"point":return VY;case"esriGeometryMultiPatch":case"multipatch":case"esriGeometryPolygon":case"polygon":return BY;case"esriGeometryPolyline":case"polyline":return HY}}var an;function YY(e){return e&&(e.declaredClass==="esri.geometry.SpatialReference"||e.wkid!=null)}function al(e,t,i){return t==null?i:i==null?t:e(t,i)}let ke=an=class extends Ci{constructor(...e){super(...e),this.type="extent",this.xmin=0,this.ymin=0,this.mmin=void 0,this.zmin=void 0,this.xmax=0,this.ymax=0,this.mmax=void 0,this.zmax=void 0}normalizeCtorArgs(e,t,i,r,s){return YY(e)?{spatialReference:e,xmin:0,ymin:0,xmax:0,ymax:0}:typeof e=="object"?(e.spatialReference=e.spatialReference==null?ae.WGS84:e.spatialReference,e):{xmin:e,ymin:t,xmax:i,ymax:r,spatialReference:s??ae.WGS84}}static fromPoint(e){return new an({xmin:e.x,ymin:e.y,zmin:e.z,xmax:e.x,ymax:e.y,zmax:e.z,spatialReference:e.spatialReference})}get cache(){return this.commitProperty("xmin"),this.commitProperty("ymin"),this.commitProperty("zmin"),this.commitProperty("mmin"),this.commitProperty("xmax"),this.commitProperty("ymax"),this.commitProperty("zmax"),this.commitProperty("mmax"),this.commitProperty("spatialReference"),{}}get center(){const e=new he({x:.5*(this.xmin+this.xmax),y:.5*(this.ymin+this.ymax),spatialReference:this.spatialReference});return this.hasZ&&(e.z=.5*(this.zmin+this.zmax)),this.hasM&&(e.m=.5*(this.mmin+this.mmax)),e}get extent(){return this.clone()}get hasM(){return this.mmin!=null&&this.mmax!=null}get hasZ(){return this.zmin!=null&&this.zmax!=null}get height(){return Math.abs(this.ymax-this.ymin)}get width(){return Math.abs(this.xmax-this.xmin)}centerAt(e){const t=this.center;return e.z!=null&&this.hasZ?this.offset(e.x-t.x,e.y-t.y,e.z-t.z):this.offset(e.x-t.x,e.y-t.y)}clone(){const e=new an;return e.xmin=this.xmin,e.ymin=this.ymin,e.xmax=this.xmax,e.ymax=this.ymax,e.spatialReference=this.spatialReference,this.zmin!=null&&(e.zmin=this.zmin,e.zmax=this.zmax),this.mmin!=null&&(e.mmin=this.mmin,e.mmax=this.mmax),e}contains(e){if(!e)return!1;const t=this.spatialReference,i=e.spatialReference;return t&&i&&!t.equals(i)&&C_(t,i)&&(e=t.isWebMercator?jc(e):Td(e,!0)),e.type==="point"?Ng(this,e):e.type==="extent"&&NY(this,e)}equals(e){if(this===e)return!0;if(e==null)return!1;const t=this.spatialReference,i=e.spatialReference;return t&&i&&!t.equals(i)&&C_(t,i)&&(e=t.isWebMercator?jc(e):Td(e,!0)),this.xmin===e.xmin&&this.ymin===e.ymin&&this.zmin===e.zmin&&this.mmin===e.mmin&&this.xmax===e.xmax&&this.ymax===e.ymax&&this.zmax===e.zmax&&this.mmax===e.mmax}expand(e){const t=.5*(1-e),i=this.width*t,r=this.height*t;if(this.xmin+=i,this.ymin+=r,this.xmax-=i,this.ymax-=r,this.hasZ){const s=(this.zmax-this.zmin)*t;this.zmin+=s,this.zmax-=s}if(this.hasM){const s=(this.mmax-this.mmin)*t;this.mmin+=s,this.mmax-=s}return this}intersects(e){if(e==null)return!1;e.type==="mesh"&&(e=e.extent);const t=this.spatialReference,i=e.spatialReference;return t&&i&&!ci(t,i)&&C_(t,i)&&(e=t.isWebMercator?jc(e):Td(e,!0)),ZY(e.type)(this,e)}normalize(){const e=this._normalize(!1,!0);return Array.isArray(e)?e:[e]}offset(e,t,i){return this.xmin+=e,this.ymin+=t,this.xmax+=e,this.ymax+=t,i!=null&&(this.zmin+=i,this.zmax+=i),this}shiftCentralMeridian(){return this._normalize(!0)}union(e){return this===e||(this.xmin=Math.min(this.xmin,e.xmin),this.ymin=Math.min(this.ymin,e.ymin),this.xmax=Math.max(this.xmax,e.xmax),this.ymax=Math.max(this.ymax,e.ymax),(this.hasZ||e.hasZ)&&(this.zmin=al(Math.min,this.zmin,e.zmin),this.zmax=al(Math.max,this.zmax,e.zmax)),(this.hasM||e.hasM)&&(this.mmin=al(Math.min,this.mmin,e.mmin),this.mmax=al(Math.max,this.mmax,e.mmax))),this}intersection(e){return this===e?this:e!=null&&this.intersects(e)?(this.xmin=Math.max(this.xmin,e.xmin),this.ymin=Math.max(this.ymin,e.ymin),this.xmax=Math.min(this.xmax,e.xmax),this.ymax=Math.min(this.ymax,e.ymax),(this.hasZ||e.hasZ)&&(this.zmin=al(Math.max,this.zmin,e.zmin),this.zmax=al(Math.min,this.zmax,e.zmax)),(this.hasM||e.hasM)&&(this.mmin=al(Math.max,this.mmin,e.mmin),this.mmax=al(Math.min,this.mmax,e.mmax)),this):null}toJSON(e){return this.write({},e)}_shiftCM(e=ar(this.spatialReference)){if(!e||!this.spatialReference)return this;const t=this.spatialReference,i=this._getCM(e);if(i){const r=t.isWebMercator?Td(i):i;this.xmin-=i.x,this.xmax-=i.x,t.isWebMercator||(r.x=r2(r.x,e).x),this.spatialReference=new ae(mh((t.isWGS84?e.altTemplate:null)??e.wkTemplate,{Central_Meridian:r.x}))}return this}_getCM(e){let t=null;const[i,r]=e.valid,s=this.xmin,n=this.xmax;return s>=i&&s<=r&&n>=i&&n<=r||(t=this.center),t}_normalize(e,t,i){const r=this.spatialReference;if(!r)return this;const s=i??ar(r);if(s==null)return this;const n=this._getParts(s).map((l=>l.extent));if(n.length<2)return n[0]||this;if(n.length>2)return e?this._shiftCM(s):this.set({xmin:s.valid[0],xmax:s.valid[1]});if(e)return this._shiftCM(s);if(t)return n;let o=!0,a=!0;return n.forEach((l=>{l.hasZ||(o=!1),l.hasM||(a=!1)})),{rings:n.map((l=>{const u=[[l.xmin,l.ymin],[l.xmin,l.ymax],[l.xmax,l.ymax],[l.xmax,l.ymin],[l.xmin,l.ymin]];if(o){const c=(l.zmax-l.zmin)/2;for(let d=0;d<u.length;d++)u[d].push(c)}if(a){const c=(l.mmax-l.mmin)/2;for(let d=0;d<u.length;d++)u[d].push(c)}return u})),hasZ:o,hasM:a,spatialReference:r}}_getParts(e){let t=this.cache._parts;if(!t){t=[];const{ymin:s,ymax:n,spatialReference:o}=this,a=this.width,l=this.xmin,u=this.xmax;let c;e=e||ar(o);const[d,m]=e.valid;c=r2(this.xmin,e);const y=c.x,g=c.frameId;c=r2(this.xmax,e);const _=c.x,v=c.frameId,b=y===_&&a>0;if(a>2*m){const S=new an(l<u?y:_,s,m,n,o),$=new an(d,s,l<u?_:y,n,o),E=new an(0,s,m,n,o),C=new an(d,s,0,n,o),P=[],k=[];S.contains(E)&&P.push(g),S.contains(C)&&k.push(g),$.contains(E)&&P.push(v),$.contains(C)&&k.push(v);for(let F=g+1;F<v;F++)P.push(F),k.push(F);t.push({extent:S,frameIds:[g]},{extent:$,frameIds:[v]},{extent:E,frameIds:P},{extent:C,frameIds:k})}else y>_||b?t.push({extent:new an(y,s,m,n,o),frameIds:[g]},{extent:new an(d,s,_,n,o),frameIds:[v]}):t.push({extent:new an(y,s,_,n,o),frameIds:[g]});this.cache._parts=t}const i=this.hasZ,r=this.hasM;if(i||r){const s={};i&&(s.zmin=this.zmin,s.zmax=this.zmax),r&&(s.mmin=this.mmin,s.mmax=this.mmax);for(let n=0;n<t.length;n++)t[n].extent.set(s)}return t}};function r2(e,t){const[i,r]=t.valid,s=2*r;let n,o=0;return e>r?(n=Math.ceil(Math.abs(e-r)/s),e-=n*s,o=n):e<i&&(n=Math.ceil(Math.abs(e-i)/s),e+=n*s,o=-n),{x:e,frameId:o}}h([f({readOnly:!0})],ke.prototype,"cache",null),h([f({readOnly:!0})],ke.prototype,"center",null),h([f({readOnly:!0})],ke.prototype,"extent",null),h([f({readOnly:!0,json:{write:{enabled:!1,overridePolicy:null}}})],ke.prototype,"hasM",null),h([f({readOnly:!0,json:{write:{enabled:!1,overridePolicy:null}}})],ke.prototype,"hasZ",null),h([f({readOnly:!0})],ke.prototype,"height",null),h([f({readOnly:!0})],ke.prototype,"width",null),h([f({type:Number,json:{type:[Number,String],write:{enabled:!0,allowNull:!0}}})],ke.prototype,"xmin",void 0),h([f({type:Number,json:{write:!0}})],ke.prototype,"ymin",void 0),h([f({type:Number,json:{origins:{"web-scene":{write:!1}},write:{overridePolicy(){return{enabled:this.hasM}}}}})],ke.prototype,"mmin",void 0),h([f({type:Number,json:{origins:{"web-scene":{write:!1}},write:{overridePolicy(){return{enabled:this.hasZ}}}}})],ke.prototype,"zmin",void 0),h([f({type:Number,json:{write:!0}})],ke.prototype,"xmax",void 0),h([f({type:Number,json:{write:!0}})],ke.prototype,"ymax",void 0),h([f({type:Number,json:{origins:{"web-scene":{write:!1}},write:{overridePolicy(){return{enabled:this.hasM}}}}})],ke.prototype,"mmax",void 0),h([f({type:Number,json:{origins:{"web-scene":{write:!1}},write:{overridePolicy(){return{enabled:this.hasZ}}}}})],ke.prototype,"zmax",void 0),ke=an=h([I("esri.geometry.Extent")],ke),ke.prototype.toJSON.isDefaultToJSON=!0;let hy;const JY=globalThis.esriConfig?.locale??globalThis.dojoConfig?.locale,hx=globalThis.document?.documentElement;function W4(){const e=hx?.getAttribute("lang"),t=globalThis.navigator?.language;return JY??e??t??"en"}function Hr(){return hy===void 0&&(hy=W4()),hy}const XY=/^(?<language>[a-z]{2,3})(?:-[a-z]{3})?(?:-[A-Z][a-z]{3})?(?:-(?<region>[A-Z]{2}|\d{3}))?(?:-.*)?$/;function oC(e=Hr()){return XY.exec(e)?.groups}const I_=[];function aC(e){return I_.push(e),ze((()=>{I_.splice(I_.indexOf(e),1)}))}const A_=[];function lC(e){return A_.push(e),ze((()=>A_.splice(A_.indexOf(e),1)))}function $3(){const e=W4();hy!==e&&([...A_].forEach((t=>t(e))),hy=e,[...I_].forEach((t=>t(e))))}globalThis.addEventListener?.("languagechange",$3),hx&&new MutationObserver((()=>{$3()})).observe(hx,{attributeFilter:["lang"]});let y0;function KY(e){return y0&&!y0.destroyed||(y0=e()),y0}var dx;const QY=new Ye({avgRating:"avg-rating",numRatings:"num-ratings",numComments:"num-comments",numViews:"num-views"});let Wt=dx=class extends le{constructor(e){super(e),this.categories=null,this.disableExtraQuery=!1,this.extent=null,this.filter=null,this.num=10,this.query=null,this.sortField=null,this.start=1}get sortOrder(){return this._get("sortOrder")||"asc"}set sortOrder(e){e!=="asc"&&e!=="desc"||this._set("sortOrder",e)}clone(){return new dx({categories:this.categories?V(this.categories):null,disableExtraQuery:this.disableExtraQuery,extent:this.extent?this.extent.clone():null,filter:this.filter,num:this.num,query:this.query,sortField:this.sortField,sortOrder:this.sortOrder,start:this.start})}toRequestOptions(e,t){let i=[];this.categories&&(i=this.categories.map((o=>Array.isArray(o)?JSON.stringify(o):o)));let r="";if(this.extent){const o=Vb(this.extent,ae.WGS84);o!=null&&(r=`${o.xmin},${o.ymin},${o.xmax},${o.ymax}`)}let s=this.query;!this.disableExtraQuery&&e.extraQuery&&(s="("+s+")"+e.extraQuery);const n={categories:i,bbox:r,q:s,filter:this.filter,num:this.num,sortField:null,sortOrder:null,start:this.start};return this.sortField&&(n.sortField=this.sortField.split(",").map((o=>QY.toJSON(o.trim()))).join(","),n.sortOrder=this.sortOrder),{query:{...t,...n}}}};h([f()],Wt.prototype,"categories",void 0),h([f()],Wt.prototype,"disableExtraQuery",void 0),h([f({type:ke})],Wt.prototype,"extent",void 0),h([f()],Wt.prototype,"filter",void 0),h([f()],Wt.prototype,"num",void 0),h([f()],Wt.prototype,"query",void 0),h([f()],Wt.prototype,"sortField",void 0),h([f()],Wt.prototype,"sortOrder",null),h([f()],Wt.prototype,"start",void 0),Wt=dx=h([I("esri.portal.PortalQueryParams")],Wt);var px;let Bt=px=class extends ee{constructor(e){super(e),this.access=null,this.created=null,this.description=null,this.id=null,this.isInvitationOnly=!1,this.modified=null,this.owner=null,this.portal=null,this.snippet=null,this.sortField=null,this.sortOrder=null,this.sourceJSON=null,this.tags=null,this.title=null}get thumbnailUrl(){const e=this.url,t=this.thumbnail;return e&&t&&this.portal?this.portal?.normalizeUrl(`${e}/info/${t}?f=json`):null}get url(){const e=this.portal?.restUrl;return e?e+"/community/groups/"+this.id:null}fetchCategorySchema(e){return this.portal.request(this.url+"/categorySchema",e).then((t=>{const i=t.categorySchema||[];return i.some((r=>r.source==="contentCategorySetsGroupQuery.LivingAtlas"))?this._fetchCategorySchemaSet("LivingAtlas",e):i}))}fetchMembers(e){return this.portal.request(this.url+"/users",e)}getThumbnailUrl(e){let t=this.thumbnailUrl;return t&&e&&(t+=`&w=${e}`),t}toJSON(){throw new j("internal:not-yet-implemented","PortalGroup.toJSON is not yet implemented")}static fromJSON(e){if(!e)return null;if(e.declaredClass)throw new Error("JSON object is already hydrated");const t=new px({sourceJSON:e});return t.read(e),t}queryItems(e,t){let i=Ui(Wt,e);const r=this.portal;return parseFloat(r.currentVersion)>5?(i=i||new Wt,r.queryPortal(`/content/groups/${this.id}/search`,i,"PortalItem",t)):(i=i?i.clone():new Wt,i.query="group:"+this.id+(i.query?" "+i.query:""),r.queryItems(i,t))}_fetchCategorySchemaSet(e,t){const i=this.portal;return i.fetchSelf(i.authMode,!0,t).then((r=>{const s=r.contentCategorySetsGroupQuery;if(s){const n=new Wt({disableExtraQuery:!0,num:1,query:s});return i.queryGroups(n,t)}throw new j("portal-group:fetchCategorySchema","contentCategorySetsGroupQuery value not found")})).then((r=>{if(r.total){const s=r.results[0],n=new Wt({num:1,query:`typekeywords:"${e}"`});return s.queryItems(n,t)}throw new j("portal-group:fetchCategorySchema","contentCategorySetsGroupQuery group not found")})).then((r=>r.total?r.results[0].fetchData("json",t).then((s=>{const n=s?.categorySchema;return n?.length?n:[]})):[]))}};h([f()],Bt.prototype,"access",void 0),h([f({type:Date})],Bt.prototype,"created",void 0),h([f()],Bt.prototype,"description",void 0),h([f()],Bt.prototype,"id",void 0),h([f()],Bt.prototype,"isInvitationOnly",void 0),h([f({type:Date})],Bt.prototype,"modified",void 0),h([f()],Bt.prototype,"owner",void 0),h([f()],Bt.prototype,"portal",void 0),h([f()],Bt.prototype,"snippet",void 0),h([f()],Bt.prototype,"sortField",void 0),h([f()],Bt.prototype,"sortOrder",void 0),h([f()],Bt.prototype,"sourceJSON",void 0),h([f()],Bt.prototype,"tags",void 0),h([f()],Bt.prototype,"thumbnail",void 0),h([f({readOnly:!0})],Bt.prototype,"thumbnailUrl",null),h([f()],Bt.prototype,"title",void 0),h([f({readOnly:!0})],Bt.prototype,"url",null),Bt=px=h([I("esri.portal.PortalGroup")],Bt);let Vu=class extends le{constructor(t){super(t),this.nextQueryParams=null,this.queryParams=null,this.results=null,this.total=null}};h([f()],Vu.prototype,"nextQueryParams",void 0),h([f()],Vu.prototype,"queryParams",void 0),h([f()],Vu.prototype,"results",void 0),h([f()],Vu.prototype,"total",void 0),Vu=h([I("esri.portal.PortalQueryResult")],Vu);let na=class extends ee{constructor(t){super(t),this.created=null,this.id=null,this.portal=null,this.title=null,this.username=null}get url(){const t=this.portal?.restUrl;return t?`${t}/content/users/${this.username}/${this.id}`:null}toJSON(){throw new j("internal:not-yet-implemented","PortalFolder.toJSON is not yet implemented")}};h([f({type:Date})],na.prototype,"created",void 0),h([f()],na.prototype,"id",void 0),h([f()],na.prototype,"portal",void 0),h([f()],na.prototype,"title",void 0),h([f({readOnly:!0})],na.prototype,"url",null),h([f()],na.prototype,"username",void 0),na=h([I("esri.portal.PortalFolder")],na);var fx;let st=fx=class extends ee{constructor(e){super(e),this.access=null,this.created=null,this.culture=null,this.description=null,this.email=null,this.fullName=null,this.id=null,this.modified=null,this.orgId=null,this.portal=null,this.preferredView=null,this.privileges=null,this.region=null,this.role=null,this.roleId=null,this.sourceJSON=null,this.units=null,this.username=null,this.userLicenseTypeId=null,this.userType=null}get thumbnailUrl(){const e=this.url,t=this.thumbnail;return e&&t?this.portal.normalizeUrl(`${e}/info/${t}?f=json`):null}get userContentUrl(){const e=this.portal?.restUrl;return e?`${e}/content/users/${this.id}`:null}get url(){const e=this.portal?.restUrl;return e?`${e}/community/users/${this.id}`:null}addItem(e){const t=e&&e.item,i=e?.data,r=e?.folder,s={method:"post"};t&&(s.query=t.createPostQuery(),i!=null&&(typeof i=="string"?s.query.text=i:typeof i=="object"&&(s.query.text=JSON.stringify(i))));let n=this.userContentUrl;return r&&(n+="/"+(typeof r=="string"?r:r.id)),this.portal.request(n+"/addItem",s).then((o=>(t.id=o.id,t.portal=this.portal,t.loaded?t.reload():t.load())))}async deleteItem(e,t=!1){let i=this.userContentUrl;e.ownerFolder&&(i+="/"+e.ownerFolder);const r=t?{permanentDelete:!0}:{};await this.portal.request(i+`/items/${e.id}/delete`,{method:"post",query:r}),e.id=null,e.portal=null}async deleteItems(e,t=!1){e=e.slice();const i=this.userContentUrl+"/deleteItems",r=[],s=e.map((n=>n.id));if(s.length){const n={method:"post",query:{items:s.join(","),permanentDelete:t}},o=await this.portal.request(i,n);for(const a of o.results){const l=e.find((d=>a.itemId===d.id)),u=a.success;let c=null;u?(l.id=null,l.portal=null):a.error&&(c=new j("portal:delete-item-failed",a.error.message,a.error)),r.push({item:l,success:u,error:c})}}return r}fetchFolders(){const e={query:{num:1}};return this.portal.request(this.userContentUrl??"",e).then((t=>{let i;return i=t&&t.folders?t.folders.map((r=>{const s=na.fromJSON(r);return s.portal=this.portal,s})):[],i}))}fetchGroups(){return this.portal.request(this.url??"").then((e=>{let t;return t=e&&e.groups?e.groups.map((i=>{const r=Bt.fromJSON(i);return r.portal=this.portal,r})):[],t}))}async fetchItems(e){e??={};let t=this.userContentUrl??"";e.folder&&(t+="/"+e.folder.id);const{default:i}=await J(()=>Promise.resolve().then(()=>Z4),void 0),r={folders:!1,inRecycleBin:!!e.inRecycleBin||null,foldersContent:!(e.folder||!e.includeSubfolderItems)||null,num:e.num||10,start:e.start||1,sortField:e.sortField||"created",sortOrder:e.sortOrder||"asc"},s=await this.portal.request(t,{query:r});let n;return s?.items?(n=s.items.map((o=>{const a=i.fromJSON(o);return a.portal=this.portal,a})),await Promise.all(n.map((o=>o.load()))),{items:n,nextStart:s.nextStart,total:s.total}):{items:[],nextStart:-1,total:0}}fetchTags(){return this.portal.request(this.url+"/tags").then((e=>e.tags))}getThumbnailUrl(e){let t=this.thumbnailUrl;return t&&e&&(t+=`&w=${e}`),t}queryFavorites(e){return this.favGroupId?(this._favGroup||(this._favGroup=new Bt({id:this.favGroupId,portal:this.portal})),this._favGroup.queryItems(e)):Promise.reject(new j("internal:unknown","Unknown internal error",{internalError:"Unknown favGroupId"}))}async restoreItem(e,t){const i=this.userContentUrl,r=t?{folderID:typeof t=="string"?t:t.id}:null;await this.portal.request(i+`/items/${e.id}/restore`,{method:"post",query:r})}toJSON(){throw new j("internal:not-yet-implemented","PortalUser.toJSON is not yet implemented")}static fromJSON(e){if(!e)return null;if(e.declaredClass)throw new Error("JSON object is already hydrated");const t=new fx({sourceJSON:e});return t.read(e),t}};h([f()],st.prototype,"access",void 0),h([f({type:Date})],st.prototype,"created",void 0),h([f()],st.prototype,"culture",void 0),h([f()],st.prototype,"description",void 0),h([f()],st.prototype,"email",void 0),h([f()],st.prototype,"favGroupId",void 0),h([f()],st.prototype,"fullName",void 0),h([f()],st.prototype,"id",void 0),h([f({type:Date})],st.prototype,"modified",void 0),h([f()],st.prototype,"orgId",void 0),h([f()],st.prototype,"portal",void 0),h([f()],st.prototype,"preferredView",void 0),h([f()],st.prototype,"privileges",void 0),h([f()],st.prototype,"region",void 0),h([f()],st.prototype,"role",void 0),h([f()],st.prototype,"roleId",void 0),h([f()],st.prototype,"sourceJSON",void 0),h([f()],st.prototype,"thumbnail",void 0),h([f({readOnly:!0})],st.prototype,"thumbnailUrl",null),h([f()],st.prototype,"units",void 0),h([f({readOnly:!0})],st.prototype,"userContentUrl",null),h([f({readOnly:!0})],st.prototype,"url",null),h([f()],st.prototype,"username",void 0),h([f()],st.prototype,"userLicenseTypeId",void 0),h([f()],st.prototype,"userType",void 0),st=fx=h([I("esri.portal.PortalUser")],st);var Xr;let Pf;const M3={PortalGroup:()=>Promise.resolve({default:Bt}),PortalItem:()=>J(()=>Promise.resolve().then(()=>Z4),void 0),PortalUser:()=>Promise.resolve({default:st})};var ao;let Z=(ao=class extends ee.JSONSupportMixin(Ns){constructor(t){super(t),this._esriIdCredentialCreateHandle=null,this.access=null,this.allSSL=!1,this.authMode="auto",this.authorizedCrossOriginDomains=null,this.basemapGalleryGroupQuery=null,this.basemapGalleryGroupQuery3D=null,this.bingKey=null,this.canListApps=!1,this.canListData=!1,this.canListPreProvisionedItems=!1,this.canProvisionDirectPurchase=!1,this.canSearchPublic=!0,this.canShareBingPublic=!1,this.canSharePublic=!1,this.canSignInArcGIS=!1,this.canSignInIDP=!1,this.colorSetsGroupQuery=null,this.commentsEnabled=!1,this.created=null,this.culture=null,this.customBaseUrl=null,this.default3DBasemapQuery=null,this.defaultBasemap=null,this.defaultDevBasemap=null,this.defaultExtent=null,this.defaultVectorBasemap=null,this.description=null,this.devBasemapGalleryGroupQuery=null,this.eueiEnabled=null,this.featuredGroups=null,this.featuredItemsGroupQuery=null,this.galleryTemplatesGroupQuery=null,this.layoutGroupQuery=null,this.livingAtlasGroupQuery=null,this.hasCategorySchema=!1,this.hasClassificationSchema=!1,this.helperServices=null,this.homePageFeaturedContent=null,this.homePageFeaturedContentCount=null,this.httpPort=null,this.httpsPort=null,this.id=null,this.ipCntryCode=null,this.isPortal=!1,this.isReadOnly=!1,this.layerTemplatesGroupQuery=null,this.maxTokenExpirationMinutes=null,this.modified=null,this.name=null,this.portalHostname=null,this.portalMode=null,this.portalProperties=null,this.region=null,this.recycleBinEnabled=!1,this.rotatorPanels=null,this.showHomePageDescription=!1,this.sourceJSON=null,this.supportsHostedServices=!1,this.symbolSetsGroupQuery=null,this.templatesGroupQuery=null,this.units=null,this.url=Fe.portalUrl,this.urlKey=null,this.user=null,this.use3dBasemaps=!0,this.useDefault3dBasemap=!1,this.useStandardizedQuery=!1,this.useVectorBasemaps=!1,this.vectorBasemapGalleryGroupQuery=null}normalizeCtorArgs(t){return typeof t=="string"?{url:t}:t}destroy(){T3.unregister(this),this.defaultBasemap=Ot(this.defaultBasemap),this.defaultDevBasemap=Ot(this.defaultDevBasemap),this.defaultVectorBasemap=Ot(this.defaultVectorBasemap),this._esriIdCredentialCreateHandle=St(this._esriIdCredentialCreateHandle)}readAuthorizedCrossOriginDomains(t){if(t)for(const i of t)Fe.request.trustedServers.includes(i)||Fe.request.trustedServers.push(i);return t}readDefaultBasemap(t){return this._readBasemap(t)}readDefaultDevBasemap(t){return this._readBasemap(t)}readDefaultVectorBasemap(t){return this._readBasemap(t)}get extraQuery(){const t=this.user?.orgId,i=!t||this.canSearchPublic;return this.id&&!i?` AND orgid:${this.id}`:null}get hasAPIKey(){return xH(this.restUrl)}get isOrganization(){return!!this.access}get itemPageUrl(){return this.url?`${this.url}/home/item.html`:null}get restUrl(){let t=this.url;if(t){const i=t.indexOf("/sharing");t=i>0?t.slice(0,i):this.url.replace(/\/+$/,""),t+="/sharing/rest"}return t}get thumbnailUrl(){const t=this.restUrl,i=this.thumbnail;return t&&i?this._normalizeSSL(t+"/portals/self/resources/"+i):null}readUrlKey(t){return t&&t.toLowerCase()}readUser(t){let i=null;return t&&(i=st.fromJSON(t),i.portal=this),i}load(t){const i=J(()=>Promise.resolve().then(()=>QK),void 0).then((({default:r})=>{It(t),Pf=r})).then((()=>this.sourceJSON?this.sourceJSON:this.fetchSelf(this.authMode,!1,t))).then((r=>{if(!this.hasAPIKey&&ot){const s=ot;this.credential=s.findCredential(this.restUrl),this.credential||this.authMode!==Xr.AUTH_MODE_AUTO&&this.authMode!==Xr.AUTH_MODE_NO_PROMPT||(this._esriIdCredentialCreateHandle?.remove(),this._esriIdCredentialCreateHandle=s.on("credential-create",eJ(new WeakRef(this))),T3.register(this,this._esriIdCredentialCreateHandle,this))}this.sourceJSON=r,this.read(r)}));return this.addResolvingPromise(i),Promise.resolve(this)}async createElevationLayers(){await this.load();const t=this._getHelperService("defaultElevationLayers"),i=(await J(async()=>{const{default:r}=await import("./ElevationLayer-DjIherZI.js");return{default:r}},__vite__mapDeps([0,1,2,3,4,5,6,7,8,9,10]))).default;return t?t.map((r=>new i({id:r.id,url:r.url}))):[]}async fetchBasemaps(t,i){const r=await this._fetchBasemaps(t,i);if(i?.include3d===!0&&this.use3dBasemaps!==!1){const s=await this._fetchBasemaps3D(t,i);r.unshift(...s)}return r}async fetchDefault3DBasemap(t){if(!this.useDefault3dBasemap||!this.default3DBasemapQuery||this.default3DBasemapQuery==="none")return null;const i=new Wt;i.query=this.default3DBasemapQuery,i.disableExtraQuery=!0;const r=(await this.queryItems(i,t)).results.find((s=>s.type==="Web Scene"));return r?new Pf({portalItem:r}):null}fetchCategorySchema(t){return this.hasCategorySchema?this.request(this.restUrl+"/portals/self/categorySchema",t).then((i=>i.categorySchema)):js(t)?Promise.reject(yt()):Promise.resolve([])}async fetchClassificationSchema(t){return this.hasClassificationSchema?this.request(this.restUrl+"/portals/self/classification/classificationSchema",t).then((i=>i.classificationSchema)):null}fetchFeaturedGroups(t){const i=this.featuredGroups,r=new Wt({num:100,sortField:"title"});if(i?.length){const s=[];for(const n of i)s.push(`(title:"${n.title}" AND owner:${n.owner})`);return r.query=s.join(" OR "),this.queryGroups(r,t).then((n=>n.results))}return js(t)?Promise.reject(yt()):Promise.resolve([])}fetchRegions(t){const i=this.user?.culture||this.culture||Hr();return this.request(this.restUrl+"/portals/regions",{...t,query:{culture:i}})}fetchSettings(t){const i=this.user?.culture||this.culture||Hr();return this.request(this.restUrl+"/portals/self/settings",{...t,query:{culture:i}})}static getDefault(){return KY((()=>new Xr))}queryGroups(t,i){return this.queryPortal("/community/groups",t,"PortalGroup",i)}queryItems(t,i){return this.queryPortal("/search",t,"PortalItem",i)}queryUsers(t,i){return t.sortField||(t.sortField="username"),this.queryPortal("/community/users",t,"PortalUser",i)}fetchSelf(t=this.authMode,i=!1,r){const s=this.restUrl+"/portals/self",n={authMode:t,query:{culture:Hr().toLowerCase()},withCredentials:!0,...r};return n.authMode==="auto"&&(n.authMode="no-prompt"),i&&(n.query.default=!0),this.request(s,n)}queryPortal(t,i,r,s){const n=Ui(Wt,i),o=a=>this.request(this.restUrl+t,{...n.toRequestOptions(this),...s}).then((l=>{const u=n.clone();return u.start=l.nextStart,new Vu({nextQueryParams:u,queryParams:n,total:l.total,results:Xr._resultsToTypedArray(a,{portal:this},l,s)})})).then((l=>Promise.all(l.results.map((u=>typeof u.when=="function"?u.when():l))).then((()=>l),(u=>(AE(u),l)))));return r&&M3[r]?M3[r]().then((({default:a})=>(It(s),o(a)))):o()}signIn(){if(this.hasAPIKey)return this.load().then((()=>{if(!this.user)throw new j("portal:not-authenticated","Unable to authenticate user. Portal.user is missing")}));if(this.authMode===Xr.AUTH_MODE_ANONYMOUS||this.authMode===Xr.AUTH_MODE_NO_PROMPT&&!ot)return Promise.reject(new j("portal:invalid-auth-mode",`Current "authMode"' is "${this.authMode}"`));if(this.loadStatus==="failed")return Promise.reject(this.loadError);const t=i=>Promise.resolve().then((()=>this.loadStatus==="not-loaded"?(i||(this.authMode="immediate"),this.load().then((()=>null))):this.loadStatus==="loading"?this.load().then((()=>this.credential?null:(this.credential=i,this.fetchSelf("immediate")))):this.user&&this.credential===i?null:(this.credential=i,this.fetchSelf("immediate")))).then((r=>{r&&(this.sourceJSON=r,this.read(r))}));return ot?ot.getCredential(this.restUrl,{prompt:this.authMode!==Xr.AUTH_MODE_NO_PROMPT}).then((i=>t(i))):t(this.credential)}normalizeUrl(t){const i=this.credential?.token;return this._normalizeSSL(i?t+(t.includes("?")?"&":"?")+"token="+i:t)}requestToTypedArray(t,i,r){return this.request(t,i).then((s=>{const n=Xr._resultsToTypedArray(r,{portal:this},s);return Promise.all(n.map((o=>typeof o.when=="function"?o.when():s))).then((()=>n),(()=>n))}))}request(t,i={}){const r={f:"json",...i.query},{authMode:s=this.authMode===Xr.AUTH_MODE_ANONYMOUS||this.authMode===Xr.AUTH_MODE_NO_PROMPT?this.authMode:"auto",body:n=null,cacheBust:o=!1,method:a="auto",responseType:l="json",signal:u}=i,c={authMode:s,body:n,cacheBust:o,method:a,query:r,responseType:l,timeout:0,signal:u};return i.withCredentials&&(c.withCredentials=!0),at(this._normalizeSSL(t),c).then((d=>d.data))}toJSON(){throw new j("internal:not-yet-implemented","Portal.toJSON is not yet implemented")}static fromJSON(t){if(!t)return null;if(t.declaredClass)throw new Error("JSON object is already hydrated");return new Xr({sourceJSON:t})}_getHelperService(t){const i=this.helperServices&&this.helperServices[t];if(!i)throw new j("portal:service-not-found",`The \`helperServices\` do not include an entry named "${t}"`);return i}async _fetchBasemaps(t,i){const r=new Wt;r.query=t||(NS()?this.devBasemapGalleryGroupQuery:this.useVectorBasemaps?this.vectorBasemapGalleryGroupQuery:this.basemapGalleryGroupQuery),r.disableExtraQuery=!0;const s=await this.queryGroups(r,i);if(!s.total)return[];const n=s.results[0];r.num=100,r.query='type:"Web Map" -type:"Web Application"',r.sortField=n.sortField||"name",r.sortOrder=n.sortOrder||"desc";const o=await n.queryItems(r,i);return o.total?o.results.filter((a=>a.type==="Web Map")).map((a=>new Pf({portalItem:a}))):[]}async _fetchBasemaps3D(t,i){const r=t||this.basemapGalleryGroupQuery3D;if(!r)return[];if(NS())return[];const s=new Wt({query:r,disableExtraQuery:!0}),n=await this.queryGroups(s,i);if(!n.total)return[];const o=n.results[0];s.num=100,s.query='type:"Web Scene"',s.sortField=o.sortField||"name",s.sortOrder=o.sortOrder||"desc";const a=await o.queryItems(s,i);return a.total?a.results.filter((l=>l.type==="Web Scene")).map((l=>new Pf({portalItem:l}))):[]}_normalizeSSL(t){return t.replace(/^http:/i,"https:").replace(":7080",":7443")}_readBasemap(t){if(t){const i=Pf.fromJSON(t);return i.portalItem={portal:this},i}return null}static _resultsToTypedArray(t,i,r,s){let n;if(r){const o=s!=null?s.signal:null;n=r.listings||r.notifications||r.userInvitations||r.tags||r.items||r.groups||r.comments||r.provisions||r.results||r.relatedItems||r,(t||i)&&(n=n.map((a=>{const l=Object.assign(t?t.fromJSON(a):a,i);return typeof l.load=="function"&&l.load(o),l})))}else n=[];return n}},Xr=ao,ao.AUTH_MODE_ANONYMOUS="anonymous",ao.AUTH_MODE_AUTO="auto",ao.AUTH_MODE_IMMEDIATE="immediate",ao.AUTH_MODE_NO_PROMPT="no-prompt",ao);h([f()],Z.prototype,"access",void 0),h([f()],Z.prototype,"allSSL",void 0),h([f()],Z.prototype,"authMode",void 0),h([f()],Z.prototype,"authorizedCrossOriginDomains",void 0),h([Ae("authorizedCrossOriginDomains")],Z.prototype,"readAuthorizedCrossOriginDomains",null),h([f()],Z.prototype,"basemapGalleryGroupQuery",void 0),h([f({json:{name:"3DBasemapGalleryGroupQuery"}})],Z.prototype,"basemapGalleryGroupQuery3D",void 0),h([f()],Z.prototype,"bingKey",void 0),h([f()],Z.prototype,"canListApps",void 0),h([f()],Z.prototype,"canListData",void 0),h([f()],Z.prototype,"canListPreProvisionedItems",void 0),h([f()],Z.prototype,"canProvisionDirectPurchase",void 0),h([f()],Z.prototype,"canSearchPublic",void 0),h([f()],Z.prototype,"canShareBingPublic",void 0),h([f()],Z.prototype,"canSharePublic",void 0),h([f()],Z.prototype,"canSignInArcGIS",void 0),h([f()],Z.prototype,"canSignInIDP",void 0),h([f()],Z.prototype,"colorSetsGroupQuery",void 0),h([f()],Z.prototype,"commentsEnabled",void 0),h([f({type:Date})],Z.prototype,"created",void 0),h([f()],Z.prototype,"credential",void 0),h([f()],Z.prototype,"culture",void 0),h([f()],Z.prototype,"currentVersion",void 0),h([f()],Z.prototype,"customBaseUrl",void 0),h([f()],Z.prototype,"default3DBasemapQuery",void 0),h([f()],Z.prototype,"defaultBasemap",void 0),h([Ae("defaultBasemap")],Z.prototype,"readDefaultBasemap",null),h([f()],Z.prototype,"defaultDevBasemap",void 0),h([Ae("defaultDevBasemap")],Z.prototype,"readDefaultDevBasemap",null),h([f({type:ke})],Z.prototype,"defaultExtent",void 0),h([f()],Z.prototype,"defaultVectorBasemap",void 0),h([Ae("defaultVectorBasemap")],Z.prototype,"readDefaultVectorBasemap",null),h([f()],Z.prototype,"description",void 0),h([f()],Z.prototype,"devBasemapGalleryGroupQuery",void 0),h([f()],Z.prototype,"eueiEnabled",void 0),h([f({readOnly:!0})],Z.prototype,"extraQuery",null),h([f()],Z.prototype,"featuredGroups",void 0),h([f()],Z.prototype,"featuredItemsGroupQuery",void 0),h([f()],Z.prototype,"galleryTemplatesGroupQuery",void 0),h([f()],Z.prototype,"layoutGroupQuery",void 0),h([f()],Z.prototype,"livingAtlasGroupQuery",void 0),h([f({readOnly:!0})],Z.prototype,"hasAPIKey",null),h([f()],Z.prototype,"hasCategorySchema",void 0),h([f()],Z.prototype,"hasClassificationSchema",void 0),h([f()],Z.prototype,"helpBase",void 0),h([f()],Z.prototype,"helperServices",void 0),h([f()],Z.prototype,"helpMap",void 0),h([f()],Z.prototype,"homePageFeaturedContent",void 0),h([f()],Z.prototype,"homePageFeaturedContentCount",void 0),h([f()],Z.prototype,"httpPort",void 0),h([f()],Z.prototype,"httpsPort",void 0),h([f()],Z.prototype,"id",void 0),h([f()],Z.prototype,"ipCntryCode",void 0),h([f({readOnly:!0})],Z.prototype,"isOrganization",null),h([f()],Z.prototype,"isPortal",void 0),h([f()],Z.prototype,"isReadOnly",void 0),h([f({readOnly:!0})],Z.prototype,"itemPageUrl",null),h([f()],Z.prototype,"layerTemplatesGroupQuery",void 0),h([f()],Z.prototype,"maxTokenExpirationMinutes",void 0),h([f({type:Date})],Z.prototype,"modified",void 0),h([f()],Z.prototype,"name",void 0),h([f()],Z.prototype,"portalHostname",void 0),h([f()],Z.prototype,"portalMode",void 0),h([f()],Z.prototype,"portalProperties",void 0),h([f()],Z.prototype,"region",void 0),h([f()],Z.prototype,"recycleBinEnabled",void 0),h([f({readOnly:!0})],Z.prototype,"restUrl",null),h([f()],Z.prototype,"rotatorPanels",void 0),h([f()],Z.prototype,"showHomePageDescription",void 0),h([f()],Z.prototype,"sourceJSON",void 0),h([f()],Z.prototype,"staticImagesUrl",void 0),h([f({json:{name:"2DStylesGroupQuery"}})],Z.prototype,"stylesGroupQuery2d",void 0),h([f({json:{name:"stylesGroupQuery"}})],Z.prototype,"stylesGroupQuery3d",void 0),h([f()],Z.prototype,"supportsHostedServices",void 0),h([f()],Z.prototype,"symbolSetsGroupQuery",void 0),h([f()],Z.prototype,"templatesGroupQuery",void 0),h([f()],Z.prototype,"thumbnail",void 0),h([f({readOnly:!0})],Z.prototype,"thumbnailUrl",null),h([f()],Z.prototype,"units",void 0),h([f()],Z.prototype,"url",void 0),h([f()],Z.prototype,"urlKey",void 0),h([Ae("urlKey")],Z.prototype,"readUrlKey",null),h([f()],Z.prototype,"user",void 0),h([Ae("user")],Z.prototype,"readUser",null),h([f()],Z.prototype,"use3dBasemaps",void 0),h([f()],Z.prototype,"useDefault3dBasemap",void 0),h([f()],Z.prototype,"useStandardizedQuery",void 0),h([f()],Z.prototype,"useVectorBasemaps",void 0),h([f()],Z.prototype,"vectorBasemapGalleryGroupQuery",void 0),Z=Xr=h([I("esri.portal.Portal")],Z);const T3=new FinalizationRegistry((e=>{e.remove()}));function eJ(e){const t=ot;return()=>{const i=e.deref();i&&t.findCredential(i.restUrl)&&i.signIn().catch((()=>{}))}}let oa=class extends le{constructor(t){super(t),this.portalItem=null}normalizeCtorArgs(t){return t?.portalItem&&t.path?{...t,path:E3(t.path,t.portalItem)}:t}set path(t){t!=null&&qr(t)?H.getLogger(this).error("portalitemresource:invalid-path","A portal item resource path must be relative"):this._set("path",t)}_castPath(t){return E3(t,this.portalItem)}get url(){return this.portalItem&&this.path?`${this.portalItem.itemUrl}/resources/${this.path}`:null}get cdnUrl(){return this.portalItem&&this.path?`${this.portalItem.itemCdnUrl}/resources/${this.path}`:null}get itemRelativeUrl(){return this.portalItem&&this.path?`./resources/${this.path}`:null}fetch(t="json",i){const r=this.cdnUrl;if(r==null)throw new j("portal-item-resource:fetch","Portal item resource does not refer to a valid item or path");return this.portalItem.portal.request(r,{responseType:t,query:{token:this.portalItem.apiKey,_ts:i?.cacheBust?Date.now():null},signal:i?.signal})}async update(t,i){const{addOrUpdateResources:r}=await J(()=>import("./resourceUtils-CPgIi9u5.js"),[]);return await r(this.portalItem,[{resource:this,content:t,compress:i?.compress,access:i?.access}],"update",i),this}hasPath(){return this.path!=null}};function E3(e,t){return e==null?e:(e=e.replace(/^\/+/,""),t!=null&&qr(e)&&(e=TE(e,t.itemUrl)),e?.replace(/^\/+/,"").replace(/^(\.\/)?resources\//,""))}h([f()],oa.prototype,"portalItem",void 0),h([f({type:String,value:null})],oa.prototype,"path",null),h([Ke("path")],oa.prototype,"_castPath",null),h([f({type:String,readOnly:!0})],oa.prototype,"url",null),h([f({type:String,readOnly:!0})],oa.prototype,"cdnUrl",null),h([f({type:String,readOnly:!0})],oa.prototype,"itemRelativeUrl",null),oa=h([I("esri.portal.PortalItemResource")],oa);let Pc=class extends le{constructor(t){super(t),this.created=null,this.rating=null}};h([f({type:Date})],Pc.prototype,"created",void 0),h([f()],Pc.prototype,"rating",void 0),Pc=h([I("esri.portal.PortalRating")],Pc);var Uu;const tJ=new Set(["3DTiles Service","CSV","Feature Collection","Feature Service","Feed","GeoJson","Group Layer","Image Service","KML","Knowledge Graph Layer","Map Service","Media Layer","Scene Service","Stream Service","Video Service","Vector Tile Service","WCS","WFS","WMS","WMTS"]),iJ=new Set(["KML","GeoJson","CSV"]);let xe=Uu=class extends ee.JSONSupportMixin(Ns){static from(e){return cf(Uu,e)}constructor(e){super(e),this.access=null,this.accessInformation=null,this.apiKey=null,this.applicationProxies=null,this.avgRating=null,this.categories=null,this.classification=null,this.created=null,this.culture=null,this.description=null,this.extent=null,this.groupCategories=null,this.id=null,this.isOrgItem=!1,this.itemControl=null,this.licenseInfo=null,this.modified=null,this.name=null,this.numComments=null,this.numRatings=null,this.numViews=null,this.owner=null,this.ownerFolder=null,this.portal=null,this.screenshots=null,this.size=null,this.snippet=null,this.sourceJSON=null,this.sourceUrl=null,this.spatialReference=null,this.tags=null,this.title=null,this.type=null,this.typeKeywords=null,this.url=null}destroy(){this.portal=null}get displayName(){const e=this.type,t=this.typeKeywords||[];let i=e;return e==="Feature Service"||e==="Feature Collection"?i=t.includes("Table")?"Table":t.includes("Route Layer")?"Route Layer":t.includes("Markup")?"Markup":"Feature Layer":e==="Image Service"?i=t.includes("Elevation 3D Layer")?"Elevation Layer":t.includes("Tiled Imagery")?"Tiled Imagery Layer":"Imagery Layer":e==="Scene Service"?i="Scene Layer":e==="Video Service"?i="Video Layer":e==="Scene Package"?i="Scene Layer Package":e==="Stream Service"?i="Feature Layer":e==="Geoprocessing Service"?i=t.includes("Web Tool")?"Tool":"Geoprocessing Service":e==="Geoenrichment Service"?i="GeoEnrichment Service":e==="Geocoding Service"?i="Locator":e==="Microsoft Powerpoint"?i="Microsoft PowerPoint":e==="GeoJson"?i="GeoJSON":e==="Globe Service"?i="Globe Layer":e==="Vector Tile Service"?i="Tile Layer":e==="netCDF"?i="NetCDF":e==="Map Service"?i=t.includes("Spatiotemporal")||!t.includes("Hosted Service")&&!t.includes("Tiled")||t.includes("Relational")?"Map Image Layer":"Tile Layer":e?.toLowerCase().includes("add in")?i=e.replaceAll(/(add in)/gi,"Add-In"):e==="datastore catalog service"?i="Big Data File Share":e==="Compact Tile Package"?i="Tile Package (tpkx)":e==="Raster function template"?i="Raster Function Template":e==="OGCFeatureServer"?i="OGC Feature Layer":e==="web mapping application"&&t.includes("configurableApp")?i="Instant App":e==="Insights Page"?i="Insights Report":e==="Excalibur Imagery Project"?i="Excalibur Project":e==="3DTiles Service"?i="3D tiles layer":e==="3DTiles Package"&&(i="3D tiles package"),i}readExtent(e){return e&&e.length?new ke(e[0][0],e[0][1],e[1][0],e[1][1]):null}get iconUrl(){const e=this.type?.toLowerCase()||"",t=this.typeKeywords||[],i="esri/images/portal/",r="16";let s,n=!1,o=!1,a=!1,l=!1,u=!1,c=!1,d=!1,m=!1;return e.indexOf("service")>0||e==="feature collection"||e==="kml"||e==="wms"||e==="wmts"||e==="wfs"?(n=t.includes("Hosted Service"),e==="feature service"||e==="feature collection"||e==="kml"||e==="wfs"?(o=t.includes("Table"),a=t.includes("Route Layer"),l=t.includes("Markup"),u=t.includes("Spatiotemporal"),c=t.includes("UtilityNetwork"),s=u&&o?"spatiotemporaltable":o?"table":a?"routelayer":l?"markup":u?"spatiotemporal":c?"utilitynetwork":n?"featureshosted":"features"):e==="map service"||e==="wms"||e==="wmts"?(u=t.includes("Spatiotemporal"),d=t.includes("Relational"),s=u||d?"mapimages":n||t.includes("Tiled")||e==="wmts"?"maptiles":"mapimages"):s=e==="scene service"?t.includes("Line")?"sceneweblayerline":t.includes("3DObject")?"sceneweblayermultipatch":t.includes("Point")?"sceneweblayerpoint":t.includes("IntegratedMesh")?"sceneweblayermesh":t.includes("PointCloud")?"sceneweblayerpointcloud":t.includes("Polygon")?"sceneweblayerpolygon":t.includes("Building")?"sceneweblayerbuilding":t.includes("Voxel")?"sceneweblayervoxel":"sceneweblayer":e==="image service"?t.includes("Elevation 3D Layer")?"elevationlayer":t.includes("Tiled Imagery")?"tiledimagerylayer":"imagery":e==="stream service"?"streamlayer":e==="vector tile service"?"vectortile":e==="datastore catalog service"?"datastorecollection":e==="geocoding service"?"geocodeservice":e==="video service"?t.includes("Live Stream")?"livestreamvideolayer":"videolayer":e==="geoprocessing service"?t.includes("Web Tool")?"tool":"layers":e==="geodata service"?"geodataservice":e==="3dtiles service"?t.includes("3DObject")?"3dobjecttileslayer":t.includes("IntegratedMesh")?"integratedmeshtileslayer":"3dtileslayer":"layers"):e==="web map"||e==="cityengine web scene"?s="maps":e==="web scene"?s=t.includes("ViewingMode-Local")?"webscenelocal":"websceneglobal":e==="web mapping application"&&t.includes("configurableApp")?s="instantapps":e==="web mapping application"||e==="mobile application"||e==="application"||e==="operation view"||e==="desktop application"?s="apps":e==="map document"||e==="map package"||e==="published map"||e==="scene document"||e==="globe document"||e==="basemap package"||e==="mobile basemap package"||e==="mobile map package"||e==="project package"||e==="project template"||e==="pro map"||e==="layout"||e==="layer"&&t.includes("ArcGIS Pro")||e==="explorer map"&&t.indexOf("Explorer Document")?s="mapsgray":e==="service definition"||e==="shapefile"||e==="cad drawing"||e==="geojson"||e==="netcdf"||e==="administrative report"?s="datafiles":e==="360 vr experience"?s="360vr":e==="explorer add in"||e==="desktop add in"||e==="windows viewer add in"||e==="windows viewer configuration"?s="appsgray":e==="arcgis pro add in"||e==="arcgis pro configuration"?s="addindesktop":e==="pdf"?s="pdf":e==="microsoft word"?s="word":e==="microsoft excel"?s="excel":e==="microsoft powerpoint"?s="ppt":e==="rule package"||e==="file geodatabase"||e==="sqlite geodatabase"||e==="csv collection"||e==="kml collection"||e==="windows mobile package"||e==="map template"||e==="desktop application template"||e==="gml"||e==="arcpad package"||e==="code sample"||e==="document link"||e==="earth configuration"||e==="operations dashboard add in"||e==="rules package"||e==="workflow manager package"||e==="explorer map"&&t.includes("Explorer Mapping Application")||t.includes("Document")?s="datafilesgray":e==="network analysis service"||e==="geoprocessing service"||e==="geodata service"||e==="geometry service"||e==="geoprocessing package"||e==="locator package"||e==="geoprocessing sample"||e==="workflow manager service"?s="toolsgray":e==="layer"||e==="layer package"||e==="explorer layer"?s="layersgray":e==="analysis model"?s="analysismodel":e==="scene package"?s="scenepackage":e==="3dtiles package"?s="3dtileslayerpackage":e==="3dtiles service"?s="3dtileslayer":e==="mobile scene package"?s="mobilescenepackage":e==="tile package"||e==="compact tile package"?s="tilepackage":e==="task file"?s="taskfile":e==="report template"?s="report-template":e==="statistical data collection"?s="statisticaldatacollection":e==="insights workbook"?s="workbook":e==="insights model"?s="insightsmodel":e==="insights page"?s="insightspage":e==="insights theme"?s="insightstheme":e==="hub initiative"?s="hubinitiative":e==="hub page"?s="hubpage":e==="hub site application"?s="hubsite":e==="hub event"?s="hubevent":e==="hub project"?s="hubproject":e==="relational database connection"?s="relationaldatabaseconnection":e==="big data file share"?s="datastorecollection":e==="image collection"?s="imagecollection":e==="desktop style"?s="desktopstyle":e==="style"?s=t.includes("Dictionary")?"dictionarystyle":"style":e==="dashboard"?s="dashboard":e==="raster function template"?s="rasterprocessingtemplate":e==="vector tile package"?s="vectortilepackage":e==="ortho mapping project"?s="orthomappingproject":e==="ortho mapping template"?s="orthomappingtemplate":e==="solution"?s="solutions":e==="geopackage"?s="geopackage":e==="deep learning package"?s="deeplearningpackage":e==="real time analytic"?s="realtimeanalytics":e==="reality mapping project"?s="realitymappingproject":e==="big data analytic"?s="bigdataanalytics":e==="feed"?s="feed":e==="excalibur imagery project"?s="excaliburimageryproject":e==="notebook"?s="notebook":e==="storymap"?s="storymap":e==="survey123 add in"?s="survey123addin":e==="mission"?s="mission":e==="mission report"?s="missionreport":e==="mission template"?s="missiontemplate":e==="quickcapture project"?s="quickcaptureproject":e==="pro report"?s="proreport":e==="pro report template"?s="proreporttemplate":e==="urban model"?s="urbanmodel":e==="urban project"?s="urbanproject":e==="web experience"?s="experiencebuilder":e==="web experience template"?s="webexperiencetemplate":e==="experience builder widget"?s="experiencebuilderwidget":e==="experience builder widget package"?s="experiencebuilderwidgetpackage":e==="workflow"?s="workflow":e==="kernel gateway connection"?s="kernelgatewayconnection":e==="insights script"?s="insightsscript":e==="hub initiative template"?s="hubinitiativetemplate":e==="storymap theme"?s="storymaptheme":e==="knowledge graph"?s="knowledgegraph":e==="knowledge graph layer"?s="knowledgegraphlayer":e==="knowledge studio project"?s="knowledgestudio":e==="native application"?s="nativeapp":e==="native application installer"?s="nativeappinstaller":e==="web link chart"?s="linkchart":e==="knowledge graph web investigation"?s="investigation":e==="ogcfeatureserver"?s="features":e==="pro presentation"?s="propresentation":e==="pro project"?s="proproject":e==="insights workbook package"?s="insightsworkbookpackage":e==="apache parquet"?s="apacheparquet":e==="notebook code snippet library"?s="notebookcodesnippets":e==="suitability model"?s="suitabilitymodel":e==="esri classifier definition"?s="classifierdefinition":e==="esri classification schema"?s="classificationschema":e==="insights data engineering workbook"?s="dataengineeringworkbook":e==="insights data engineering model"?s="dataengineeringmodel":e==="deep learning studio project"?s="deeplearningproject":e==="discussion"?s="discussion":e==="allsource project"?s="allsourceproject":e==="api key"?s="apikey":e==="data pipeline"?s="datapipelines":e==="group layer"?(m=t.includes("Map"),s=m?"layergroup2d":"layergroup"):s=e==="media layer"?"onlinemedialayer":e==="form"?t.includes("Survey123")?"survey":"datafilesgray":e==="csv"?"csv":e==="image"?"image":"maps",s?vt(i+s+r+".png"):null}get isLayer(){return this.type!=null&&tJ.has(this.type)}get itemCdnUrl(){return RE(this.itemUrl)}get itemPageUrl(){const e=this.portal?.itemPageUrl;return e&&this.id?`${e}?id=${this.id}`:null}get itemUrl(){const e=this.portal?.restUrl;return e&&this.id?`${e}/content/items/${this.id}`:null}get thumbnailUrl(){const e=this.itemUrl,t=this.thumbnail;return e&&t?this.portal?.normalizeUrl(`${e}/info/${t}?f=json`)??null:null}get userItemUrl(){const e=this.portal?.restUrl;if(!e)return null;const t=this.owner||this.portal?.user?.id;return t?`${e}/content/users/${this.ownerFolder?`${t}/${this.ownerFolder}`:t}/items/${this.id}`:null}load(e){const t=this.portal??(this.portal=Z.getDefault()),i=t.load(e).then((()=>this.sourceJSON?this.sourceJSON:this.id&&this.itemUrl?t.request(this.itemUrl,{signal:e!=null?e.signal:null,query:{token:this.apiKey}}):{})).then((r=>{this.sourceJSON=r,this.read(r)}));return this.addResolvingPromise(i),Promise.resolve(this)}async addRating(e){const t={method:"post",query:{}},i=e instanceof Pc?e.rating:e;return i==null||isNaN(i)||typeof e!="number"||(t.query.rating=i),this.portal?(await this.portal.request(this.itemUrl+"/addRating",t),new Pc({rating:i,created:new Date})):null}clone(){const e={access:this.access,accessInformation:this.accessInformation,applicationProxies:V(this.applicationProxies),avgRating:this.avgRating,categories:V(this.categories),classification:V(this.classification),created:V(this.created),culture:this.culture,description:this.description,extent:V(this.extent),groupCategories:V(this.groupCategories),id:this.id,itemControl:this.itemControl,licenseInfo:this.licenseInfo,modified:V(this.modified),name:this.name,numComments:this.numComments,numRatings:this.numRatings,numViews:this.numViews,owner:this.owner,ownerFolder:this.ownerFolder,portal:this.portal,screenshots:V(this.screenshots),size:this.size,snippet:this.snippet,sourceUrl:this.sourceUrl,spatialReference:this.spatialReference,tags:V(this.tags),thumbnail:this.thumbnail,title:this.title,type:this.type,typeKeywords:V(this.typeKeywords),url:this.url};this.loaded&&(e.loadStatus="loaded");const t=new Uu({sourceJSON:this.sourceJSON}).set(e);return t._set("isOrgItem",this.isOrgItem),t}createPostQuery(){const e=this.toJSON();for(const t of["tags","typeKeywords","categories"])e[t]=e[t]?.join(", ");for(const t of["extent","classification"]){const i=e[t];i&&(e[t]=JSON.stringify(i))}return e}async deleteRating(){await this.portal.request(this.itemUrl+"/deleteRating",{method:"post"})}fetchData(e="json",t){return this.portal.request(this.itemUrl+"/data",{responseType:e,...t,query:{token:this.apiKey}})}async fetchRating(e){const t=await this.portal.request(this.itemUrl+"/rating",{query:{token:this.apiKey},...e});return t.rating!=null?(t.created=new Date(t.created),new Pc(t)):null}fetchRelatedItems(e,t){return this.portal.requestToTypedArray(this.itemUrl+"/relatedItems",{query:{...e,token:this.apiKey},...t},Uu)}getThumbnailUrl(e){let t=this.thumbnailUrl;return t&&e&&(t+=`&w=${e}`),t}reload(){return this.portal.request(this.itemUrl??"",{cacheBust:!0,query:{token:this.apiKey}}).then((e=>(this.applicationProxies&&!Object.hasOwn(e,"appProxies")&&(this.applicationProxies=null),this.sourceJSON=e,this.read(e),this)))}update(e){return this.id?this.load().then((()=>this.portal.signIn())).then((()=>{const t=e?.data,i={method:"post"};i.query=this.createPostQuery();for(const r in i.query)i.query[r]===null&&(i.query[r]="");return i.query.clearEmptyFields=!0,t!=null&&(typeof t=="string"?i.query.text=t:typeof t=="object"&&(i.query.text=JSON.stringify(t))),this.portal.request(`${this.userItemUrl}/update`,i).then((()=>this.reload()))})):Promise.reject(new j("portal:item-does-not-exist","The item does not exist yet and cannot be updated"))}async copy(e){if(!this.id)throw new j("portal:item-does-not-exist","The item does not exist yet");await this.load();const{portal:t,itemUrl:i}=this;await t.signIn();const{copyResources:r,folder:s,tags:n,title:o}=e||{},a={method:"post",query:{copyPrivateResources:r==="all",folder:typeof s=="string"?s:s?.id,includeResources:!!r,tags:n?.join(","),title:o}},{itemId:l}=await t.request(`${i}/copy`,a);return new Uu({id:l,portal:t})}updateThumbnail(e){return this.id?this.load().then((()=>this.portal.signIn())).then((()=>{const t=e.thumbnail,i=e.filename,r={method:"post"};if(typeof t=="string")yh(t)?r.query={data:t}:r.query={url:ks(t)},i!=null&&(r.query.filename=i);else{const s=new FormData;i!=null?s.append("file",t,i):s.append("file",t),r.body=s}return this.portal.request(`${this.userItemUrl}/updateThumbnail`,r).then((()=>this.reload()))})):Promise.reject(new j("portal:item-does-not-exist","The item does not exist yet and cannot be updated"))}async fetchResources(e={},t){const{fetchResources:i}=await J(()=>import("./resourceUtils-CPgIi9u5.js"),[]);return i(this,e,t)}async addResource(e,t,i){const{addOrUpdateResources:r}=await J(()=>import("./resourceUtils-CPgIi9u5.js"),[]);return e.portalItem=this,await r(this,[{resource:e,content:t,compress:i?.compress,access:i?.access}],"add",i),e}async removeResource(e,t){const{removeResource:i}=await J(()=>import("./resourceUtils-CPgIi9u5.js"),[]);if(e.portalItem&&e.portalItem.itemUrl!==this.itemUrl)throw new j("removeresource:portal-item-mismatch","The portal item associated with the provided resource does not match the item");return i(this,e,t)}async removeAllResources(e){const{removeAllResources:t}=await J(()=>import("./resourceUtils-CPgIi9u5.js"),[]);return t(this,e)}resourceFromPath(e){return new oa({portalItem:this,path:e})}toJSON(){const e=this.extent,t={accessInformation:this.accessInformation,categories:V(this.categories),classification:V(this.classification),created:this.created?.getTime(),description:this.description,extent:e&&[[e.xmin,e.ymin],[e.xmax,e.ymax]],id:this.id,isOrgItem:this.isOrgItem,licenseInfo:this.licenseInfo,modified:this.modified?.getTime(),name:this.name,owner:this.owner,ownerFolder:this.ownerFolder,snippet:this.snippet,sourceUrl:this.sourceUrl,spatialReference:this.spatialReference,tags:V(this.tags),thumbnail:this.thumbnail,title:this.title,type:this.type,typeKeywords:V(this.typeKeywords),url:this.url};return bq(t)}static fromJSON(e){if(!e)return null;if(e.declaredClass)throw new Error("JSON object is already hydrated");return new Uu({sourceJSON:e})}_getPostQuery(){const e=this.toJSON();for(const t in e)t==="tags"&&e[t]!==null&&(e[t]=e[t].join(", ")),t==="typeKeywords"&&e[t]!==null&&(e[t]=e[t].join(", ")),t==="extent"&&e[t]&&(e[t]=JSON.stringify(e[t]));return e}};h([f({type:["private","shared","org","public"]})],xe.prototype,"access",void 0),h([f()],xe.prototype,"accessInformation",void 0),h([f({type:String})],xe.prototype,"apiKey",void 0),h([f({json:{read:{source:"appProxies"}}})],xe.prototype,"applicationProxies",void 0),h([f()],xe.prototype,"avgRating",void 0),h([f()],xe.prototype,"categories",void 0),h([f()],xe.prototype,"classification",void 0),h([f({type:Date})],xe.prototype,"created",void 0),h([f()],xe.prototype,"culture",void 0),h([f()],xe.prototype,"description",void 0),h([f({readOnly:!0})],xe.prototype,"displayName",null),h([f({type:ke})],xe.prototype,"extent",void 0),h([Ae("extent")],xe.prototype,"readExtent",null),h([f()],xe.prototype,"groupCategories",void 0),h([f({readOnly:!0})],xe.prototype,"iconUrl",null),h([f()],xe.prototype,"id",void 0),h([f({readOnly:!0})],xe.prototype,"isLayer",null),h([f({type:Boolean,readOnly:!0})],xe.prototype,"isOrgItem",void 0),h([f()],xe.prototype,"itemControl",void 0),h([f({readOnly:!0})],xe.prototype,"itemPageUrl",null),h([f({readOnly:!0})],xe.prototype,"itemUrl",null),h([f()],xe.prototype,"licenseInfo",void 0),h([f({type:Date})],xe.prototype,"modified",void 0),h([f()],xe.prototype,"name",void 0),h([f()],xe.prototype,"numComments",void 0),h([f()],xe.prototype,"numRatings",void 0),h([f()],xe.prototype,"numViews",void 0),h([f()],xe.prototype,"owner",void 0),h([f()],xe.prototype,"ownerFolder",void 0),h([f({type:Z})],xe.prototype,"portal",void 0),h([f()],xe.prototype,"screenshots",void 0),h([f()],xe.prototype,"size",void 0),h([f()],xe.prototype,"snippet",void 0),h([f()],xe.prototype,"sourceJSON",void 0),h([f({type:String})],xe.prototype,"sourceUrl",void 0),h([f({type:String})],xe.prototype,"spatialReference",void 0),h([f()],xe.prototype,"tags",void 0),h([f()],xe.prototype,"thumbnail",void 0),h([f({readOnly:!0})],xe.prototype,"thumbnailUrl",null),h([f()],xe.prototype,"title",void 0),h([f()],xe.prototype,"type",void 0),h([f()],xe.prototype,"typeKeywords",void 0),h([f({type:String,json:{read(e,t){if(iJ.has(t.type)){const i=this.portal?.restUrl;e||=i&&this.id?`${i}/content/items/${this.id}/data`:null}return e}}})],xe.prototype,"url",void 0),h([f({readOnly:!0})],xe.prototype,"userItemUrl",null),xe=Uu=h([I("esri.portal.PortalItem")],xe);const Z4=Object.freeze(Object.defineProperty({__proto__:null,get default(){return xe}},Symbol.toStringTag,{value:"Module"})),Y4={ar:!0,bg:!0,bs:!0,ca:!0,cs:!0,da:!0,de:!0,el:!0,en:!0,es:!0,et:!0,fi:!0,fr:!0,he:!0,hr:!0,hu:!0,id:!0,it:!0,ja:!0,ko:!0,lt:!0,lv:!0,nb:"no",nl:!0,no:!0,nn:"no",pl:!0,pt:"pt-BR","pt-BR":!0,"pt-PT":!0,ro:!0,ru:!0,sk:!0,sl:!0,sr:!0,sv:!0,th:!0,tr:!0,uk:!0,vi:!0,zh:"zh-CN","zh-CN":!0,"zh-HK":!0,"zh-TW":!0};function rJ(e){return e in Y4}function C3(e){if(rJ(e)){const t=Y4[e];return t===!0?e:t}return null}const dm=[],Yd=new Map;function P3(e){for(const t of Yd.keys())X4(e.pattern,t)&&Yd.delete(t)}function sJ(e){return dm.includes(e)||(P3(e),dm.unshift(e)),ze((()=>{const t=dm.indexOf(e);t>-1&&(dm.splice(t,1),P3(e))}))}async function uC(e){const t=Hr();Yd.has(e)||Yd.set(e,nJ(e,t));const i=Yd.get(e);return i&&await oJ.add(i),i}function J4(e){const t=oC(e);return t?C3(e)??C3(t.language):null}async function nJ(e,t){const i=[];for(const r of dm)if(X4(r.pattern,e))try{return await r.fetchMessageBundle(e,t)}catch(s){i.push(s)}throw i.length?new j("intl:message-bundle-error",`Errors occurred while loading "${e}"`,{errors:i}):new j("intl:no-message-bundle-loader",`No loader found for message bundle "${e}"`)}function X4(e,t){return typeof e=="string"?t.startsWith(e):e.test(t)}lC((()=>{Yd.clear()}));const oJ=new class{constructor(){this._numLoading=0,this._dfd=null}async waitForAll(){this._dfd&&await this._dfd.promise}add(e){return this._increase(),e.then((()=>this._decrease()),(()=>this._decrease())),this.waitForAll()}_increase(){this._numLoading++,this._dfd||(this._dfd=Gs())}_decrease(){this._numLoading=Math.max(this._numLoading-1,0),this._dfd&&this._numLoading===0&&(this._dfd.resolve(),this._dfd=null)}};async function aJ(e){if(!e)return;const t=e.includes("-vector")?e.slice(0,e.indexOf("-vector")):e.includes("-3d")?e.slice(0,e.indexOf("-3d")):e,i=await uC("esri/t9n/basemaps");return i[e]||i[t]}const Vp={satellite:{id:"satellite",classic:!0,get thumbnailUrl(){return vt("esri/images/basemap/satellite.jpg")},baseMapLayers:[{id:"satellite-base-layer",url:"//services.arcgisonline.com/ArcGIS/rest/services/World_Imagery/MapServer",layerType:"ArcGISTiledMapServiceLayer",title:"World Imagery",showLegend:!1,visibility:!0,opacity:1}]},hybrid:{id:"hybrid",classic:!0,get thumbnailUrl(){return vt("esri/images/basemap/hybrid.jpg")},baseMapLayers:[{id:"hybrid-base-layer",url:"//services.arcgisonline.com/ArcGIS/rest/services/World_Imagery/MapServer",layerType:"ArcGISTiledMapServiceLayer",title:"World Imagery",showLegend:!1,visibility:!0,opacity:1},{id:"hybrid-reference-layer",styleUrl:"https://cdn.arcgis.com/sharing/rest/content/items/30d6b8271e1849cd9c3042060001f425/resources/styles/root.json",layerType:"VectorTileLayer",title:"Hybrid Reference Layer",isReference:!0,showLegend:!1,visibility:!0,opacity:1}]},terrain:{id:"terrain",classic:!0,get thumbnailUrl(){return vt("esri/images/basemap/terrain.jpg")},baseMapLayers:[{id:"terrain-base-layer",url:"//services.arcgisonline.com/ArcGIS/rest/services/World_Terrain_Base/MapServer",layerType:"ArcGISTiledMapServiceLayer",title:"World Terrain Base",showLegend:!1,visibility:!0,opacity:1},{id:"terrain-reference-layer",url:"//services.arcgisonline.com/ArcGIS/rest/services/Reference/World_Reference_Overlay/MapServer",layerType:"ArcGISTiledMapServiceLayer",title:"World Reference Overlay",isReference:!0,showLegend:!1,visibility:!0,opacity:1}]},oceans:{id:"oceans",classic:!0,get thumbnailUrl(){return vt("esri/images/basemap/oceans.jpg")},baseMapLayers:[{id:"oceans-base-layer",url:"//services.arcgisonline.com/arcgis/rest/services/Ocean/World_Ocean_Base/MapServer",layerType:"ArcGISTiledMapServiceLayer",title:"World Ocean Base",showLegend:!1,visibility:!0,opacity:1},{id:"oceans-reference-layer",url:"//services.arcgisonline.com/arcgis/rest/services/Ocean/World_Ocean_Reference/MapServer",layerType:"ArcGISTiledMapServiceLayer",title:"World Ocean Reference",isReference:!0,showLegend:!1,visibility:!0,opacity:1}]},osm:{id:"osm",classic:!0,get thumbnailUrl(){return vt("esri/images/basemap/osm.jpg")},baseMapLayers:[{id:"osm-base-layer",layerType:"OpenStreetMap",title:"Open Street Map",showLegend:!1,visibility:!0,opacity:1}]},"dark-gray-vector":{id:"dark-gray-vector",classic:!0,get thumbnailUrl(){return vt("esri/images/basemap/dark-gray-vector.jpg")},baseMapLayers:[{id:"dark-gray-base-layer",styleUrl:"https://cdn.arcgis.com/sharing/rest/content/items/5e9b3685f4c24d8781073dd928ebda50/resources/styles/root.json",layerType:"VectorTileLayer",title:"Dark Gray Base",visibility:!0,opacity:1},{id:"dark-gray-reference-layer",styleUrl:"https://cdn.arcgis.com/sharing/rest/content/items/747cb7a5329c478cbe6981076cc879c5/resources/styles/root.json",layerType:"VectorTileLayer",title:"Dark Gray Reference",isReference:!0,visibility:!0,opacity:1}]},get"dark-gray"(){return{...this["dark-gray-vector"],id:"dark-gray"}},"gray-vector":{id:"gray-vector",classic:!0,get thumbnailUrl(){return vt("esri/images/basemap/gray-vector.jpg")},baseMapLayers:[{id:"gray-base-layer",styleUrl:"https://cdn.arcgis.com/sharing/rest/content/items/291da5eab3a0412593b66d384379f89f/resources/styles/root.json",layerType:"VectorTileLayer",title:"Light Gray Base",visibility:!0,opacity:1},{id:"gray-reference-layer",styleUrl:"https://cdn.arcgis.com/sharing/rest/content/items/1768e8369a214dfab4e2167d5c5f2454/resources/styles/root.json",layerType:"VectorTileLayer",title:"Light Gray Reference",isReference:!0,visibility:!0,opacity:1}]},get gray(){return{...this["gray-vector"],id:"gray"}},"streets-vector":{id:"streets-vector",classic:!0,get thumbnailUrl(){return vt("esri/images/basemap/streets-vector.jpg")},baseMapLayers:[{id:"streets-vector-base-layer",styleUrl:"//cdn.arcgis.com/sharing/rest/content/items/de26a3cf4cc9451298ea173c4b324736/resources/styles/root.json",layerType:"VectorTileLayer",title:"World Streets",visibility:!0,opacity:1}]},get streets(){return{...this["streets-vector"],id:"streets"}},"topo-vector":{id:"topo-vector",classic:!0,get thumbnailUrl(){return vt("esri/images/basemap/topo-vector.jpg")},baseMapLayers:[{id:"world-hillshade-layer",url:"//services.arcgisonline.com/arcgis/rest/services/Elevation/World_Hillshade/MapServer",layerType:"ArcGISTiledMapServiceLayer",title:"World Hillshade",showLegend:!1,visibility:!0,opacity:1},{id:"topo-vector-base-layer",styleUrl:"//cdn.arcgis.com/sharing/rest/content/items/7dc6cea0b1764a1f9af2e679f642f0f5/resources/styles/root.json",layerType:"VectorTileLayer",title:"World Topo",visibility:!0,opacity:1}]},get topo(){return{...this["topo-vector"],id:"topo"}},"streets-night-vector":{id:"streets-night-vector",classic:!0,get thumbnailUrl(){return vt("esri/images/basemap/streets-night.jpg")},baseMapLayers:[{id:"streets-night-vector-base-layer",styleUrl:"//cdn.arcgis.com/sharing/rest/content/items/86f556a2d1fd468181855a35e344567f/resources/styles/root.json",layerType:"VectorTileLayer",title:"World Streets Night",visibility:!0,opacity:1}]},"streets-relief-vector":{id:"streets-relief-vector",classic:!0,get thumbnailUrl(){return vt("esri/images/basemap/streets-relief.jpg")},baseMapLayers:[{id:"world-hillshade-layer",url:"//services.arcgisonline.com/arcgis/rest/services/Elevation/World_Hillshade/MapServer",layerType:"ArcGISTiledMapServiceLayer",title:"World Hillshade",showLegend:!1,visibility:!0,opacity:1},{id:"streets-relief-vector-base-layer",styleUrl:"//www.arcgis.com/sharing/rest/content/items/b266e6d17fc345b498345613930fbd76/resources/styles/root.json",title:"World Streets Relief",layerType:"VectorTileLayer",visibility:!0,opacity:1}]},"streets-navigation-vector":{id:"streets-navigation-vector",classic:!0,get thumbnailUrl(){return vt("esri/images/basemap/streets-navigation.jpg")},baseMapLayers:[{id:"streets-navigation-vector-base-layer",styleUrl:"//cdn.arcgis.com/sharing/rest/content/items/63c47b7177f946b49902c24129b87252/resources/styles/root.json",layerType:"VectorTileLayer",title:"World Streets Navigation",visibility:!0,opacity:1}]},"topo-3d":{id:"topo-3d",is3d:!0,get thumbnailUrl(){return vt("esri/images/basemap/topo-3d.png")},baseMapLayers:[{id:"topo-3d-base-layer",styleUrl:"https://www.arcgis.com/sharing/rest/content/items/1e7d1784d1ef4b79ba6764d0bd6c3150/resources/styles/root.json",layerType:"VectorTileLayer",title:"Topographic",visibility:!0,opacity:1},{id:"topo-3d-trees",title:"Trees",url:"https://basemaps3d.arcgis.com/arcgis/rest/services/OpenStreetMap3D_Trees_Thematic_v1/SceneServer",itemId:"f75fef56b2d944fe92ef9f7737b4f953",layerType:"ArcGISSceneServiceLayer"},{id:"topo-3d-places-and-labels",title:"Places and Labels",url:"https://basemaps3d.arcgis.com/arcgis/rest/services/OpenStreetMap3D_DarkLabels_v1/SceneServer",itemId:"a84404ad39c64c328d0596e361ec459b",layerType:"ArcGISSceneServiceLayer"},{id:"topo-3d-buildings",title:"Buildings",url:"https://basemaps3d.arcgis.com/arcgis/rest/services/OpenStreetMap3D_Buildings_v1/SceneServer",itemId:"ca0470dbbddb4db28bad74ed39949e25",layerType:"ArcGISSceneServiceLayer"}]},"navigation-3d":{id:"navigation-3d",is3d:!0,get thumbnailUrl(){return vt("esri/images/basemap/navigation-3d.jpg")},baseMapLayers:[{id:"navigation-3d-base-layer",styleUrl:"https://www.arcgis.com/sharing/rest/content/items/ccc904ff872b4144b94934e55e32784b/resources/styles/root.json",layerType:"VectorTileLayer",title:"Navigation",visibility:!0,opacity:1},{id:"navigation-3d-places-and-labels",title:"Places and Labels",url:"https://basemaps3d.arcgis.com/arcgis/rest/services/OpenStreetMap3D_DarkLabels_v1/SceneServer",itemId:"a84404ad39c64c328d0596e361ec459b",layerType:"ArcGISSceneServiceLayer"},{id:"navigation-3d-buildings",title:"Buildings",url:"https://basemaps3d.arcgis.com/arcgis/rest/services/OpenStreetMap3D_Buildings_v1/SceneServer",itemId:"ca0470dbbddb4db28bad74ed39949e25",layerType:"ArcGISSceneServiceLayer"}]},"streets-3d":{id:"streets-3d",is3d:!0,get thumbnailUrl(){return vt("esri/images/basemap/streets-3d.png")},baseMapLayers:[{id:"streets-3d-base-layer",styleUrl:"https://www.arcgis.com/sharing/rest/content/items/198298c4c64c4cb19de5b46aa00c198d/resources/styles/root.json",layerType:"VectorTileLayer",title:"Streets",visibility:!0,opacity:1},{id:"streets-3d-places-and-labels",title:"Places and Labels",url:"https://basemaps3d.arcgis.com/arcgis/rest/services/OpenStreetMap3D_DarkLabels_v1/SceneServer",itemId:"a84404ad39c64c328d0596e361ec459b",layerType:"ArcGISSceneServiceLayer"},{id:"streets-3d-buildings",title:"Buildings",url:"https://basemaps3d.arcgis.com/arcgis/rest/services/OpenStreetMap3D_Buildings_v1/SceneServer",itemId:"ca0470dbbddb4db28bad74ed39949e25",layerType:"ArcGISSceneServiceLayer"}]},"osm-3d":{id:"osm-3d",is3d:!0,get thumbnailUrl(){return vt("esri/images/basemap/osm-3d.png")},baseMapLayers:[{id:"osm-3d-base-layer",styleUrl:"https://www.arcgis.com/sharing/rest/content/items/8628d259c9d14bdc848771c23c513940/resources/styles/root.json",layerType:"VectorTileLayer",title:"OpenStreetMap",visibility:!0,opacity:1},{id:"osm-3d-trees",title:"Trees",url:"https://basemaps3d.arcgis.com/arcgis/rest/services/OpenStreetMap3D_Trees_Thematic_v1/SceneServer",itemId:"f75fef56b2d944fe92ef9f7737b4f953",layerType:"ArcGISSceneServiceLayer"},{id:"osm-3d-places-and-labels",title:"Places and Labels",url:"https://basemaps3d.arcgis.com/arcgis/rest/services/OpenStreetMap3D_DarkLabels_v1/SceneServer",itemId:"a84404ad39c64c328d0596e361ec459b",layerType:"ArcGISSceneServiceLayer"},{id:"osm-3d-buildings",title:"Buildings",url:"https://basemaps3d.arcgis.com/arcgis/rest/services/OpenStreetMap3D_Buildings_v1/SceneServer",itemId:"ca0470dbbddb4db28bad74ed39949e25",layerType:"ArcGISSceneServiceLayer"}]},"gray-3d":{id:"gray-3d",is3d:!0,get thumbnailUrl(){return vt("esri/images/basemap/gray-3d.png")},baseMapLayers:[{id:"gray-3d-base-layer",styleUrl:"https://www.arcgis.com/sharing/rest/content/items/01a14b466345455ba4176d2e6390db92/resources/styles/root.json",layerType:"VectorTileLayer",title:"Streets",visibility:!0,opacity:1},{id:"gray-3d-places-and-labels",title:"Places and Labels",url:"https://basemaps3d.arcgis.com/arcgis/rest/services/OpenStreetMap3D_DarkLabels_v1/SceneServer",itemId:"a84404ad39c64c328d0596e361ec459b",layerType:"ArcGISSceneServiceLayer"},{id:"gray-3d-buildings",title:"Buildings",url:"https://basemaps3d.arcgis.com/arcgis/rest/services/OpenStreetMap3D_Buildings_v1/SceneServer",itemId:"ca0470dbbddb4db28bad74ed39949e25",layerType:"ArcGISSceneServiceLayer"}]},"navigation-dark-3d":{id:"navigation-dark-3d",itemId:"5a1365328b4943f09a54cf5fd1205707",is3d:!0,baseMapLayers:[{id:"navigation-dark-3d-base-layer",styleUrl:"https://www.arcgis.com/sharing/rest/content/items/451a1777ab3f4bf095fae24a117439d9/resources/styles/root.json",layerType:"VectorTileLayer",title:"Navigation Dark"},{id:"navigation-dark-3d-places-and-labels",title:"Places and Labels",url:"https://basemaps3d.arcgis.com/arcgis/rest/services/OpenStreetMap3D_LightLabels_v1/SceneServer/layers/0",itemId:"f364b70b012a4da5a4b5921e193eac4a",layerType:"ArcGISSceneServiceLayer"},{id:"navigation-dark-3d-buildings",title:"Buildings",url:"https://basemaps3d.arcgis.com/arcgis/rest/services/OpenStreetMap3D_Buildings_v1/SceneServer",itemId:"ca0470dbbddb4db28bad74ed39949e25",layerType:"ArcGISSceneServiceLayer"}]},"streets-dark-3d":{id:"streets-dark-3d",itemId:"8a4efa2c20484ec9b4557895e65736ff",is3d:!0,baseMapLayers:[{id:"streets-dark-3d-base-layer",styleUrl:"https://www.arcgis.com/sharing/rest/content/items/bc599b6d741a4ac084b7eea7bf8c5938/resources/styles/root.json",layerType:"VectorTileLayer",title:"OpenStreetMap Streets Night (for 3D)"},{id:"streets-dark-3d-places-and-labels",title:"Places and Labels",url:"https://basemaps3d.arcgis.com/arcgis/rest/services/OpenStreetMap3D_LightLabels_v1/SceneServer",itemId:"f364b70b012a4da5a4b5921e193eac4a",layerType:"ArcGISSceneServiceLayer"},{id:"streets-dark-3d-buildings",title:"Buildings",url:"https://basemaps3d.arcgis.com/arcgis/rest/services/OpenStreetMap3D_Buildings_v1/SceneServer",itemId:"ca0470dbbddb4db28bad74ed39949e25",layerType:"ArcGISSceneServiceLayer"}]},"dark-gray-3d":{id:"dark-gray-3d",itemId:"a8b7322a5fe94002bb0f5e0eeb0c5c18",is3d:!0,baseMapLayers:[{id:"dark-gray-3d-base-layer",styleUrl:"https://www.arcgis.com/sharing/rest/content/items/4178f71acb934fb89f169e7d667c20c6/resources/styles/root.json",layerType:"VectorTileLayer",title:"OpenStreetMap Dark Gray Canvas (for 3D)"},{id:"dark-gray-3d-places-and-labels",title:"Places and Labels",url:"https://basemaps3d.arcgis.com/arcgis/rest/services/OpenStreetMap3D_LightLabels_v1/SceneServer/layers/0",itemId:"f364b70b012a4da5a4b5921e193eac4a",layerType:"ArcGISSceneServiceLayer"},{id:"dark-gray-3d-buildings",title:"Buildings",url:"https://basemaps3d.arcgis.com/arcgis/rest/services/OpenStreetMap3D_Buildings_v1/SceneServer",itemId:"ca0470dbbddb4db28bad74ed39949e25",layerType:"ArcGISSceneServiceLayer"}]}},On="system",fu="unknown",Uo="UTC",lJ=Intl.DateTimeFormat().resolvedOptions().timeZone,I3=new Map([["AUS Central Standard Time","Australia/Darwin"],["AUS Eastern Standard Time","Australia/Sydney"],["Afghanistan Standard Time","Asia/Kabul"],["Alaskan Standard Time","America/Anchorage"],["Aleutian Standard Time","America/Adak"],["Altai Standard Time","Asia/Barnaul"],["Arab Standard Time","Asia/Riyadh"],["Arabian Standard Time","Asia/Dubai"],["Arabic Standard Time","Asia/Baghdad"],["Argentina Standard Time","America/Buenos_Aires"],["Astrakhan Standard Time","Europe/Astrakhan"],["Atlantic Standard Time","America/Halifax"],["Aus Central W. Standard Time","Australia/Eucla"],["Azerbaijan Standard Time","Asia/Baku"],["Azores Standard Time","Atlantic/Azores"],["Bahia Standard Time","America/Bahia"],["Bangladesh Standard Time","Asia/Dhaka"],["Belarus Standard Time","Europe/Minsk"],["Bougainville Standard Time","Pacific/Bougainville"],["Canada Central Standard Time","America/Regina"],["Cape Verde Standard Time","Atlantic/Cape_Verde"],["Caucasus Standard Time","Asia/Yerevan"],["Cen. Australia Standard Time","Australia/Adelaide"],["Central America Standard Time","America/Guatemala"],["Central Asia Standard Time","Asia/Bishkek"],["Central Brazilian Standard Time","America/Cuiaba"],["Central Europe Standard Time","Europe/Budapest"],["Central European Standard Time","Europe/Warsaw"],["Central Pacific Standard Time","Pacific/Guadalcanal"],["Central Standard Time","America/Chicago"],["Central Standard Time (Mexico)","America/Mexico_City"],["Chatham Islands Standard Time","Pacific/Chatham"],["China Standard Time","Asia/Shanghai"],["Cuba Standard Time","America/Havana"],["Dateline Standard Time","Etc/GMT+12"],["E. Africa Standard Time","Africa/Nairobi"],["E. Australia Standard Time","Australia/Brisbane"],["E. Europe Standard Time","Europe/Chisinau"],["E. South America Standard Time","America/Sao_Paulo"],["Easter Island Standard Time","Pacific/Easter"],["Eastern Standard Time","America/New_York"],["Eastern Standard Time (Mexico)","America/Cancun"],["Egypt Standard Time","Africa/Cairo"],["Ekaterinburg Standard Time","Asia/Yekaterinburg"],["FLE Standard Time","Europe/Kiev"],["Fiji Standard Time","Pacific/Fiji"],["GMT Standard Time","Europe/London"],["GTB Standard Time","Europe/Bucharest"],["Georgian Standard Time","Asia/Tbilisi"],["Greenland Standard Time","America/Godthab"],["Greenwich Standard Time","Atlantic/Reykjavik"],["Haiti Standard Time","America/Port-au-Prince"],["Hawaiian Standard Time","Pacific/Honolulu"],["India Standard Time","Asia/Calcutta"],["Iran Standard Time","Asia/Tehran"],["Israel Standard Time","Asia/Jerusalem"],["Jordan Standard Time","Asia/Amman"],["Kaliningrad Standard Time","Europe/Kaliningrad"],["Korea Standard Time","Asia/Seoul"],["Libya Standard Time","Africa/Tripoli"],["Line Islands Standard Time","Pacific/Kiritimati"],["Lord Howe Standard Time","Australia/Lord_Howe"],["Magadan Standard Time","Asia/Magadan"],["Magallanes Standard Time","America/Punta_Arenas"],["Marquesas Standard Time","Pacific/Marquesas"],["Mauritius Standard Time","Indian/Mauritius"],["Middle East Standard Time","Asia/Beirut"],["Montevideo Standard Time","America/Montevideo"],["Morocco Standard Time","Africa/Casablanca"],["Mountain Standard Time","America/Denver"],["Mountain Standard Time (Mexico)","America/Mazatlan"],["Myanmar Standard Time","Asia/Rangoon"],["N. Central Asia Standard Time","Asia/Novosibirsk"],["Namibia Standard Time","Africa/Windhoek"],["Nepal Standard Time","Asia/Katmandu"],["New Zealand Standard Time","Pacific/Auckland"],["Newfoundland Standard Time","America/St_Johns"],["Norfolk Standard Time","Pacific/Norfolk"],["North Asia East Standard Time","Asia/Irkutsk"],["North Asia Standard Time","Asia/Krasnoyarsk"],["North Korea Standard Time","Asia/Pyongyang"],["Omsk Standard Time","Asia/Omsk"],["Pacific SA Standard Time","America/Santiago"],["Pacific Standard Time","America/Los_Angeles"],["Pacific Standard Time (Mexico)","America/Tijuana"],["Pakistan Standard Time","Asia/Karachi"],["Paraguay Standard Time","America/Asuncion"],["Qyzylorda Standard Time","Asia/Qyzylorda"],["Romance Standard Time","Europe/Paris"],["Russia Time Zone 10","Asia/Srednekolymsk"],["Russia Time Zone 11","Asia/Kamchatka"],["Russia Time Zone 3","Europe/Samara"],["Russian Standard Time","Europe/Moscow"],["SA Eastern Standard Time","America/Cayenne"],["SA Pacific Standard Time","America/Bogota"],["SA Western Standard Time","America/La_Paz"],["SE Asia Standard Time","Asia/Bangkok"],["Saint Pierre Standard Time","America/Miquelon"],["Sakhalin Standard Time","Asia/Sakhalin"],["Samoa Standard Time","Pacific/Apia"],["Sao Tome Standard Time","Africa/Sao_Tome"],["Saratov Standard Time","Europe/Saratov"],["Singapore Standard Time","Asia/Singapore"],["South Africa Standard Time","Africa/Johannesburg"],["South Sudan Standard Time","Africa/Juba"],["Sri Lanka Standard Time","Asia/Colombo"],["Sudan Standard Time","Africa/Khartoum"],["Syria Standard Time","Asia/Damascus"],["Taipei Standard Time","Asia/Taipei"],["Tasmania Standard Time","Australia/Hobart"],["Tocantins Standard Time","America/Araguaina"],["Tokyo Standard Time","Asia/Tokyo"],["Tomsk Standard Time","Asia/Tomsk"],["Tonga Standard Time","Pacific/Tongatapu"],["Transbaikal Standard Time","Asia/Chita"],["Turkey Standard Time","Europe/Istanbul"],["Turks And Caicos Standard Time","America/Grand_Turk"],["US Eastern Standard Time","America/Indianapolis"],["US Mountain Standard Time","America/Phoenix"],["UTC","Etc/GMT"],["UTC+01","Etc/GMT-1"],["UTC+02","Etc/GMT-2"],["UTC+03","Etc/GMT-3"],["UTC+04","Etc/GMT-4"],["UTC+05","Etc/GMT-5"],["UTC+06","Etc/GMT-6"],["UTC+07","Etc/GMT-7"],["UTC+08","Etc/GMT-8"],["UTC+09","Etc/GMT-9"],["UTC+10","Etc/GMT-10"],["UTC+11","Etc/GMT-11"],["UTC+12","Etc/GMT-12"],["UTC+13","Etc/GMT-13"],["UTC+14","Etc/GMT-14"],["UTC-01","Etc/GMT+1"],["UTC-02","Etc/GMT+2"],["UTC-03","Etc/GMT+3"],["UTC-04","Etc/GMT+4"],["UTC-05","Etc/GMT+5"],["UTC-06","Etc/GMT+6"],["UTC-07","Etc/GMT+7"],["UTC-08","Etc/GMT+8"],["UTC-09","Etc/GMT+9"],["UTC-10","Etc/GMT+10"],["UTC-11","Etc/GMT+11"],["UTC-12","Etc/GMT+12"],["Ulaanbaatar Standard Time","Asia/Ulaanbaatar"],["Venezuela Standard Time","America/Caracas"],["Vladivostok Standard Time","Asia/Vladivostok"],["Volgograd Standard Time","Europe/Volgograd"],["W. Australia Standard Time","Australia/Perth"],["W. Central Africa Standard Time","Africa/Lagos"],["W. Europe Standard Time","Europe/Berlin"],["W. Mongolia Standard Time","Asia/Hovd"],["West Asia Standard Time","Asia/Tashkent"],["West Bank Standard Time","Asia/Hebron"],["West Pacific Standard Time","Pacific/Port_Moresby"],["Yakutsk Standard Time","Asia/Yakutsk"],["Yukon Standard Time","America/Whitehorse"]]);class wh extends Error{}class uJ extends wh{constructor(t){super(`Invalid DateTime: ${t.toMessage()}`)}}class cJ extends wh{constructor(t){super(`Invalid Interval: ${t.toMessage()}`)}}class hJ extends wh{constructor(t){super(`Invalid Duration: ${t.toMessage()}`)}}class Ed extends wh{}class K4 extends wh{constructor(t){super(`Invalid unit ${t}`)}}class Ki extends wh{}class ll extends wh{constructor(){super("Zone is an abstract class")}}const ie="numeric",Nn="short",ps="long",hv={year:ie,month:ie,day:ie},Q4={year:ie,month:Nn,day:ie},dJ={year:ie,month:Nn,day:ie,weekday:Nn},eF={year:ie,month:ps,day:ie},tF={year:ie,month:ps,day:ie,weekday:ps},iF={hour:ie,minute:ie},rF={hour:ie,minute:ie,second:ie},sF={hour:ie,minute:ie,second:ie,timeZoneName:Nn},nF={hour:ie,minute:ie,second:ie,timeZoneName:ps},oF={hour:ie,minute:ie,hourCycle:"h23"},aF={hour:ie,minute:ie,second:ie,hourCycle:"h23"},lF={hour:ie,minute:ie,second:ie,hourCycle:"h23",timeZoneName:Nn},uF={hour:ie,minute:ie,second:ie,hourCycle:"h23",timeZoneName:ps},cF={year:ie,month:ie,day:ie,hour:ie,minute:ie},hF={year:ie,month:ie,day:ie,hour:ie,minute:ie,second:ie},dF={year:ie,month:Nn,day:ie,hour:ie,minute:ie},pF={year:ie,month:Nn,day:ie,hour:ie,minute:ie,second:ie},pJ={year:ie,month:Nn,day:ie,weekday:Nn,hour:ie,minute:ie},fF={year:ie,month:ps,day:ie,hour:ie,minute:ie,timeZoneName:Nn},mF={year:ie,month:ps,day:ie,hour:ie,minute:ie,second:ie,timeZoneName:Nn},yF={year:ie,month:ps,day:ie,weekday:ps,hour:ie,minute:ie,timeZoneName:ps},gF={year:ie,month:ps,day:ie,weekday:ps,hour:ie,minute:ie,second:ie,timeZoneName:ps};class Sh{get type(){throw new ll}get name(){throw new ll}get ianaName(){return this.name}get isUniversal(){throw new ll}offsetName(t,i){throw new ll}formatOffset(t,i){throw new ll}offset(t){throw new ll}equals(t){throw new ll}get isValid(){throw new ll}}let s2=null;class jb extends Sh{static get instance(){return s2===null&&(s2=new jb),s2}get type(){return"system"}get name(){return new Intl.DateTimeFormat().resolvedOptions().timeZone}get isUniversal(){return!1}offsetName(t,{format:i,locale:r}){return CF(t,i,r)}formatOffset(t,i){return dy(this.offset(t),i)}offset(t){return-new Date(t).getTimezoneOffset()}equals(t){return t.type==="system"}get isValid(){return!0}}const mx=new Map;function fJ(e){let t=mx.get(e);return t===void 0&&(t=new Intl.DateTimeFormat("en-US",{hour12:!1,timeZone:e,year:"numeric",month:"2-digit",day:"2-digit",hour:"2-digit",minute:"2-digit",second:"2-digit",era:"short"}),mx.set(e,t)),t}const mJ={year:0,month:1,day:2,era:3,hour:4,minute:5,second:6};function yJ(e,t){const i=e.format(t).replace(/\u200E/g,""),r=/(\d+)\/(\d+)\/(\d+) (AD|BC),? (\d+):(\d+):(\d+)/.exec(i),[,s,n,o,a,l,u,c]=r;return[o,s,n,a,l,u,c]}function gJ(e,t){const i=e.formatToParts(t),r=[];for(let s=0;s<i.length;s++){const{type:n,value:o}=i[s],a=mJ[n];n==="era"?r[a]=o:Te(a)||(r[a]=parseInt(o,10))}return r}const n2=new Map;class Zr extends Sh{static create(t){let i=n2.get(t);return i===void 0&&n2.set(t,i=new Zr(t)),i}static resetCache(){n2.clear(),mx.clear()}static isValidSpecifier(t){return this.isValidZone(t)}static isValidZone(t){if(!t)return!1;try{return new Intl.DateTimeFormat("en-US",{timeZone:t}).format(),!0}catch{return!1}}constructor(t){super(),this.zoneName=t,this.valid=Zr.isValidZone(t)}get type(){return"iana"}get name(){return this.zoneName}get isUniversal(){return!1}offsetName(t,{format:i,locale:r}){return CF(t,i,r,this.name)}formatOffset(t,i){return dy(this.offset(t),i)}offset(t){if(!this.valid)return NaN;const i=new Date(t);if(isNaN(i))return NaN;const r=fJ(this.name);let[s,n,o,a,l,u,c]=r.formatToParts?gJ(r,i):yJ(r,i);a==="BC"&&(s=-Math.abs(s)+1);const m=Bb({year:s,month:n,day:o,hour:l===24?0:l,minute:u,second:c,millisecond:0});let y=+i;const g=y%1e3;return y-=g>=0?g:1e3+g,(m-y)/(60*1e3)}equals(t){return t.type==="iana"&&t.name===this.name}get isValid(){return this.valid}}let A3={};function _J(e,t={}){const i=JSON.stringify([e,t]);let r=A3[i];return r||(r=new Intl.ListFormat(e,t),A3[i]=r),r}const yx=new Map;function gx(e,t={}){const i=JSON.stringify([e,t]);let r=yx.get(i);return r===void 0&&(r=new Intl.DateTimeFormat(e,t),yx.set(i,r)),r}const _x=new Map;function vJ(e,t={}){const i=JSON.stringify([e,t]);let r=_x.get(i);return r===void 0&&(r=new Intl.NumberFormat(e,t),_x.set(i,r)),r}const vx=new Map;function bJ(e,t={}){const{base:i,...r}=t,s=JSON.stringify([e,r]);let n=vx.get(s);return n===void 0&&(n=new Intl.RelativeTimeFormat(e,t),vx.set(s,n)),n}let pm=null;function wJ(){return pm||(pm=new Intl.DateTimeFormat().resolvedOptions().locale,pm)}const bx=new Map;function _F(e){let t=bx.get(e);return t===void 0&&(t=new Intl.DateTimeFormat(e).resolvedOptions(),bx.set(e,t)),t}const wx=new Map;function SJ(e){let t=wx.get(e);if(!t){const i=new Intl.Locale(e);t="getWeekInfo"in i?i.getWeekInfo():i.weekInfo,"minimalDays"in t||(t={...vF,...t}),wx.set(e,t)}return t}function xJ(e){const t=e.indexOf("-x-");t!==-1&&(e=e.substring(0,t));const i=e.indexOf("-u-");if(i===-1)return[e];{let r,s;try{r=gx(e).resolvedOptions(),s=e}catch{const l=e.substring(0,i);r=gx(l).resolvedOptions(),s=l}const{numberingSystem:n,calendar:o}=r;return[s,n,o]}}function $J(e,t,i){return(i||t)&&(e.includes("-u-")||(e+="-u"),i&&(e+=`-ca-${i}`),t&&(e+=`-nu-${t}`)),e}function MJ(e){const t=[];for(let i=1;i<=12;i++){const r=se.utc(2009,i,1);t.push(e(r))}return t}function TJ(e){const t=[];for(let i=1;i<=7;i++){const r=se.utc(2016,11,13+i);t.push(e(r))}return t}function g0(e,t,i,r){const s=e.listingMode();return s==="error"?null:s==="en"?i(t):r(t)}function EJ(e){return e.numberingSystem&&e.numberingSystem!=="latn"?!1:e.numberingSystem==="latn"||!e.locale||e.locale.startsWith("en")||_F(e.locale).numberingSystem==="latn"}class CJ{constructor(t,i,r){this.padTo=r.padTo||0,this.floor=r.floor||!1;const{padTo:s,floor:n,...o}=r;if(!i||Object.keys(o).length>0){const a={useGrouping:!1,...r};r.padTo>0&&(a.minimumIntegerDigits=r.padTo),this.inf=vJ(t,a)}}format(t){if(this.inf){const i=this.floor?Math.floor(t):t;return this.inf.format(i)}else{const i=this.floor?Math.floor(t):fC(t,3);return li(i,this.padTo)}}}class PJ{constructor(t,i,r){this.opts=r,this.originalZone=void 0;let s;if(this.opts.timeZone)this.dt=t;else if(t.zone.type==="fixed"){const o=-1*(t.offset/60),a=o>=0?`Etc/GMT+${o}`:`Etc/GMT${o}`;t.offset!==0&&Zr.create(a).valid?(s=a,this.dt=t):(s="UTC",this.dt=t.offset===0?t:t.setZone("UTC").plus({minutes:t.offset}),this.originalZone=t.zone)}else t.zone.type==="system"?this.dt=t:t.zone.type==="iana"?(this.dt=t,s=t.zone.name):(s="UTC",this.dt=t.setZone("UTC").plus({minutes:t.offset}),this.originalZone=t.zone);const n={...this.opts};n.timeZone=n.timeZone||s,this.dtf=gx(i,n)}format(){return this.originalZone?this.formatToParts().map(({value:t})=>t).join(""):this.dtf.format(this.dt.toJSDate())}formatToParts(){const t=this.dtf.formatToParts(this.dt.toJSDate());return this.originalZone?t.map(i=>{if(i.type==="timeZoneName"){const r=this.originalZone.offsetName(this.dt.ts,{locale:this.dt.locale,format:this.opts.timeZoneName});return{...i,value:r}}else return i}):t}resolvedOptions(){return this.dtf.resolvedOptions()}}class IJ{constructor(t,i,r){this.opts={style:"long",...r},!i&&TF()&&(this.rtf=bJ(t,r))}format(t,i){return this.rtf?this.rtf.format(t,i):KJ(i,t,this.opts.numeric,this.opts.style!=="long")}formatToParts(t,i){return this.rtf?this.rtf.formatToParts(t,i):[]}}const vF={firstDay:1,minimalDays:4,weekend:[6,7]};class rt{static fromOpts(t){return rt.create(t.locale,t.numberingSystem,t.outputCalendar,t.weekSettings,t.defaultToEN)}static create(t,i,r,s,n=!1){const o=t||Zt.defaultLocale,a=o||(n?"en-US":wJ()),l=i||Zt.defaultNumberingSystem,u=r||Zt.defaultOutputCalendar,c=xx(s)||Zt.defaultWeekSettings;return new rt(a,l,u,c,o)}static resetCache(){pm=null,yx.clear(),_x.clear(),vx.clear(),bx.clear(),wx.clear()}static fromObject({locale:t,numberingSystem:i,outputCalendar:r,weekSettings:s}={}){return rt.create(t,i,r,s)}constructor(t,i,r,s,n){const[o,a,l]=xJ(t);this.locale=o,this.numberingSystem=i||a||null,this.outputCalendar=r||l||null,this.weekSettings=s,this.intl=$J(this.locale,this.numberingSystem,this.outputCalendar),this.weekdaysCache={format:{},standalone:{}},this.monthsCache={format:{},standalone:{}},this.meridiemCache=null,this.eraCache={},this.specifiedLocale=n,this.fastNumbersCached=null}get fastNumbers(){return this.fastNumbersCached==null&&(this.fastNumbersCached=EJ(this)),this.fastNumbersCached}listingMode(){const t=this.isEnglish(),i=(this.numberingSystem===null||this.numberingSystem==="latn")&&(this.outputCalendar===null||this.outputCalendar==="gregory");return t&&i?"en":"intl"}clone(t){return!t||Object.getOwnPropertyNames(t).length===0?this:rt.create(t.locale||this.specifiedLocale,t.numberingSystem||this.numberingSystem,t.outputCalendar||this.outputCalendar,xx(t.weekSettings)||this.weekSettings,t.defaultToEN||!1)}redefaultToEN(t={}){return this.clone({...t,defaultToEN:!0})}redefaultToSystem(t={}){return this.clone({...t,defaultToEN:!1})}months(t,i=!1){return g0(this,t,AF,()=>{const r=i?{month:t,day:"numeric"}:{month:t},s=i?"format":"standalone";return this.monthsCache[s][t]||(this.monthsCache[s][t]=MJ(n=>this.extract(n,r,"month"))),this.monthsCache[s][t]})}weekdays(t,i=!1){return g0(this,t,RF,()=>{const r=i?{weekday:t,year:"numeric",month:"long",day:"numeric"}:{weekday:t},s=i?"format":"standalone";return this.weekdaysCache[s][t]||(this.weekdaysCache[s][t]=TJ(n=>this.extract(n,r,"weekday"))),this.weekdaysCache[s][t]})}meridiems(){return g0(this,void 0,()=>OF,()=>{if(!this.meridiemCache){const t={hour:"numeric",hourCycle:"h12"};this.meridiemCache=[se.utc(2016,11,13,9),se.utc(2016,11,13,19)].map(i=>this.extract(i,t,"dayperiod"))}return this.meridiemCache})}eras(t){return g0(this,t,NF,()=>{const i={era:t};return this.eraCache[t]||(this.eraCache[t]=[se.utc(-40,1,1),se.utc(2017,1,1)].map(r=>this.extract(r,i,"era"))),this.eraCache[t]})}extract(t,i,r){const s=this.dtFormatter(t,i),n=s.formatToParts(),o=n.find(a=>a.type.toLowerCase()===r);return o?o.value:null}numberFormatter(t={}){return new CJ(this.intl,t.forceSimple||this.fastNumbers,t)}dtFormatter(t,i={}){return new PJ(t,this.intl,i)}relFormatter(t={}){return new IJ(this.intl,this.isEnglish(),t)}listFormatter(t={}){return _J(this.intl,t)}isEnglish(){return this.locale==="en"||this.locale.toLowerCase()==="en-us"||_F(this.intl).locale.startsWith("en-us")}getWeekSettings(){return this.weekSettings?this.weekSettings:EF()?SJ(this.locale):vF}getStartOfWeek(){return this.getWeekSettings().firstDay}getMinDaysInFirstWeek(){return this.getWeekSettings().minimalDays}getWeekendDays(){return this.getWeekSettings().weekend}equals(t){return this.locale===t.locale&&this.numberingSystem===t.numberingSystem&&this.outputCalendar===t.outputCalendar}toString(){return`Locale(${this.locale}, ${this.numberingSystem}, ${this.outputCalendar})`}}let o2=null;class ui extends Sh{static get utcInstance(){return o2===null&&(o2=new ui(0)),o2}static instance(t){return t===0?ui.utcInstance:new ui(t)}static parseSpecifier(t){if(t){const i=t.match(/^utc(?:([+-]\d{1,2})(?::(\d{2}))?)?$/i);if(i)return new ui(qb(i[1],i[2]))}return null}constructor(t){super(),this.fixed=t}get type(){return"fixed"}get name(){return this.fixed===0?"UTC":`UTC${dy(this.fixed,"narrow")}`}get ianaName(){return this.fixed===0?"Etc/UTC":`Etc/GMT${dy(-this.fixed,"narrow")}`}offsetName(){return this.name}formatOffset(t,i){return dy(this.fixed,i)}get isUniversal(){return!0}offset(){return this.fixed}equals(t){return t.type==="fixed"&&t.fixed===this.fixed}get isValid(){return!0}}class AJ extends Sh{constructor(t){super(),this.zoneName=t}get type(){return"invalid"}get name(){return this.zoneName}get isUniversal(){return!1}offsetName(){return null}formatOffset(){return""}offset(){return NaN}equals(){return!1}get isValid(){return!1}}function Hl(e,t){if(Te(e)||e===null)return t;if(e instanceof Sh)return e;if(DJ(e)){const i=e.toLowerCase();return i==="default"?t:i==="local"||i==="system"?jb.instance:i==="utc"||i==="gmt"?ui.utcInstance:ui.parseSpecifier(i)||Zr.create(e)}else return su(e)?ui.instance(e):typeof e=="object"&&"offset"in e&&typeof e.offset=="function"?e:new AJ(e)}const cC={arab:"[-]",arabext:"[-]",bali:"[-]",beng:"[-]",deva:"[-]",fullwide:"[-]",gujr:"[-]",hanidec:"[|||||||||]",khmr:"[-]",knda:"[-]",laoo:"[-]",limb:"[-]",mlym:"[-]",mong:"[-]",mymr:"[-]",orya:"[-]",tamldec:"[-]",telu:"[-]",thai:"[-]",tibt:"[-]",latn:"\\d"},L3={arab:[1632,1641],arabext:[1776,1785],bali:[6992,7001],beng:[2534,2543],deva:[2406,2415],fullwide:[65296,65303],gujr:[2790,2799],khmr:[6112,6121],knda:[3302,3311],laoo:[3792,3801],limb:[6470,6479],mlym:[3430,3439],mong:[6160,6169],mymr:[4160,4169],orya:[2918,2927],tamldec:[3046,3055],telu:[3174,3183],thai:[3664,3673],tibt:[3872,3881]},LJ=cC.hanidec.replace(/[\[|\]]/g,"").split("");function kJ(e){let t=parseInt(e,10);if(isNaN(t)){t="";for(let i=0;i<e.length;i++){const r=e.charCodeAt(i);if(e[i].search(cC.hanidec)!==-1)t+=LJ.indexOf(e[i]);else for(const s in L3){const[n,o]=L3[s];r>=n&&r<=o&&(t+=r-n)}}return parseInt(t,10)}else return t}const Sx=new Map;function RJ(){Sx.clear()}function en({numberingSystem:e},t=""){const i=e||"latn";let r=Sx.get(i);r===void 0&&(r=new Map,Sx.set(i,r));let s=r.get(t);return s===void 0&&(s=new RegExp(`${cC[i]}${t}`),r.set(t,s)),s}let k3=()=>Date.now(),R3="system",O3=null,N3=null,D3=null,F3=60,z3,V3=null;class Zt{static get now(){return k3}static set now(t){k3=t}static set defaultZone(t){R3=t}static get defaultZone(){return Hl(R3,jb.instance)}static get defaultLocale(){return O3}static set defaultLocale(t){O3=t}static get defaultNumberingSystem(){return N3}static set defaultNumberingSystem(t){N3=t}static get defaultOutputCalendar(){return D3}static set defaultOutputCalendar(t){D3=t}static get defaultWeekSettings(){return V3}static set defaultWeekSettings(t){V3=xx(t)}static get twoDigitCutoffYear(){return F3}static set twoDigitCutoffYear(t){F3=t%100}static get throwOnInvalid(){return z3}static set throwOnInvalid(t){z3=t}static resetCaches(){rt.resetCache(),Zr.resetCache(),se.resetCache(),RJ()}}class Tn{constructor(t,i){this.reason=t,this.explanation=i}toMessage(){return this.explanation?`${this.reason}: ${this.explanation}`:this.reason}}const bF=[0,31,59,90,120,151,181,212,243,273,304,334],wF=[0,31,60,91,121,152,182,213,244,274,305,335];function Ds(e,t){return new Tn("unit out of range",`you specified ${t} (of type ${typeof t}) as a ${e}, which is invalid`)}function hC(e,t,i){const r=new Date(Date.UTC(e,t-1,i));e<100&&e>=0&&r.setUTCFullYear(r.getUTCFullYear()-1900);const s=r.getUTCDay();return s===0?7:s}function SF(e,t,i){return i+(Dg(e)?wF:bF)[t-1]}function xF(e,t){const i=Dg(e)?wF:bF,r=i.findIndex(n=>n<t),s=t-i[r];return{month:r+1,day:s}}function dC(e,t){return(e-t+7)%7+1}function dv(e,t=4,i=1){const{year:r,month:s,day:n}=e,o=SF(r,s,n),a=dC(hC(r,s,n),i);let l=Math.floor((o-a+14-t)/7),u;return l<1?(u=r-1,l=qy(u,t,i)):l>qy(r,t,i)?(u=r+1,l=1):u=r,{weekYear:u,weekNumber:l,weekday:a,...Hb(e)}}function U3(e,t=4,i=1){const{weekYear:r,weekNumber:s,weekday:n}=e,o=dC(hC(r,1,t),i),a=Jd(r);let l=s*7+n-o-7+t,u;l<1?(u=r-1,l+=Jd(u)):l>a?(u=r+1,l-=Jd(r)):u=r;const{month:c,day:d}=xF(u,l);return{year:u,month:c,day:d,...Hb(e)}}function a2(e){const{year:t,month:i,day:r}=e,s=SF(t,i,r);return{year:t,ordinal:s,...Hb(e)}}function j3(e){const{year:t,ordinal:i}=e,{month:r,day:s}=xF(t,i);return{year:t,month:r,day:s,...Hb(e)}}function G3(e,t){if(!Te(e.localWeekday)||!Te(e.localWeekNumber)||!Te(e.localWeekYear)){if(!Te(e.weekday)||!Te(e.weekNumber)||!Te(e.weekYear))throw new Ed("Cannot mix locale-based week fields with ISO-based week fields");return Te(e.localWeekday)||(e.weekday=e.localWeekday),Te(e.localWeekNumber)||(e.weekNumber=e.localWeekNumber),Te(e.localWeekYear)||(e.weekYear=e.localWeekYear),delete e.localWeekday,delete e.localWeekNumber,delete e.localWeekYear,{minDaysInFirstWeek:t.getMinDaysInFirstWeek(),startOfWeek:t.getStartOfWeek()}}else return{minDaysInFirstWeek:4,startOfWeek:1}}function OJ(e,t=4,i=1){const r=Gb(e.weekYear),s=Fs(e.weekNumber,1,qy(e.weekYear,t,i)),n=Fs(e.weekday,1,7);return r?s?n?!1:Ds("weekday",e.weekday):Ds("week",e.weekNumber):Ds("weekYear",e.weekYear)}function NJ(e){const t=Gb(e.year),i=Fs(e.ordinal,1,Jd(e.year));return t?i?!1:Ds("ordinal",e.ordinal):Ds("year",e.year)}function $F(e){const t=Gb(e.year),i=Fs(e.month,1,12),r=Fs(e.day,1,pv(e.year,e.month));return t?i?r?!1:Ds("day",e.day):Ds("month",e.month):Ds("year",e.year)}function MF(e){const{hour:t,minute:i,second:r,millisecond:s}=e,n=Fs(t,0,23)||t===24&&i===0&&r===0&&s===0,o=Fs(i,0,59),a=Fs(r,0,59),l=Fs(s,0,999);return n?o?a?l?!1:Ds("millisecond",s):Ds("second",r):Ds("minute",i):Ds("hour",t)}function Te(e){return typeof e>"u"}function su(e){return typeof e=="number"}function Gb(e){return typeof e=="number"&&e%1===0}function DJ(e){return typeof e=="string"}function FJ(e){return Object.prototype.toString.call(e)==="[object Date]"}function TF(){try{return typeof Intl<"u"&&!!Intl.RelativeTimeFormat}catch{return!1}}function EF(){try{return typeof Intl<"u"&&!!Intl.Locale&&("weekInfo"in Intl.Locale.prototype||"getWeekInfo"in Intl.Locale.prototype)}catch{return!1}}function zJ(e){return Array.isArray(e)?e:[e]}function B3(e,t,i){if(e.length!==0)return e.reduce((r,s)=>{const n=[t(s),s];return r&&i(r[0],n[0])===r[0]?r:n},null)[1]}function VJ(e,t){return t.reduce((i,r)=>(i[r]=e[r],i),{})}function Up(e,t){return Object.prototype.hasOwnProperty.call(e,t)}function xx(e){if(e==null)return null;if(typeof e!="object")throw new Ki("Week settings must be an object");if(!Fs(e.firstDay,1,7)||!Fs(e.minimalDays,1,7)||!Array.isArray(e.weekend)||e.weekend.some(t=>!Fs(t,1,7)))throw new Ki("Invalid week settings");return{firstDay:e.firstDay,minimalDays:e.minimalDays,weekend:Array.from(e.weekend)}}function Fs(e,t,i){return Gb(e)&&e>=t&&e<=i}function UJ(e,t){return e-t*Math.floor(e/t)}function li(e,t=2){const i=e<0;let r;return i?r="-"+(""+-e).padStart(t,"0"):r=(""+e).padStart(t,"0"),r}function Ol(e){if(!(Te(e)||e===null||e===""))return parseInt(e,10)}function Tu(e){if(!(Te(e)||e===null||e===""))return parseFloat(e)}function pC(e){if(!(Te(e)||e===null||e==="")){const t=parseFloat("0."+e)*1e3;return Math.floor(t)}}function fC(e,t,i=!1){const r=10**t;return(i?Math.trunc:Math.round)(e*r)/r}function Dg(e){return e%4===0&&(e%100!==0||e%400===0)}function Jd(e){return Dg(e)?366:365}function pv(e,t){const i=UJ(t-1,12)+1,r=e+(t-i)/12;return i===2?Dg(r)?29:28:[31,null,31,30,31,30,31,31,30,31,30,31][i-1]}function Bb(e){let t=Date.UTC(e.year,e.month-1,e.day,e.hour,e.minute,e.second,e.millisecond);return e.year<100&&e.year>=0&&(t=new Date(t),t.setUTCFullYear(e.year,e.month-1,e.day)),+t}function q3(e,t,i){return-dC(hC(e,1,t),i)+t-1}function qy(e,t=4,i=1){const r=q3(e,t,i),s=q3(e+1,t,i);return(Jd(e)-r+s)/7}function $x(e){return e>99?e:e>Zt.twoDigitCutoffYear?1900+e:2e3+e}function CF(e,t,i,r=null){const s=new Date(e),n={hourCycle:"h23",year:"numeric",month:"2-digit",day:"2-digit",hour:"2-digit",minute:"2-digit"};r&&(n.timeZone=r);const o={timeZoneName:t,...n},a=new Intl.DateTimeFormat(i,o).formatToParts(s).find(l=>l.type.toLowerCase()==="timezonename");return a?a.value:null}function qb(e,t){let i=parseInt(e,10);Number.isNaN(i)&&(i=0);const r=parseInt(t,10)||0,s=i<0||Object.is(i,-0)?-r:r;return i*60+s}function PF(e){const t=Number(e);if(typeof e=="boolean"||e===""||Number.isNaN(t))throw new Ki(`Invalid unit value ${e}`);return t}function fv(e,t){const i={};for(const r in e)if(Up(e,r)){const s=e[r];if(s==null)continue;i[t(r)]=PF(s)}return i}function dy(e,t){const i=Math.trunc(Math.abs(e/60)),r=Math.trunc(Math.abs(e%60)),s=e>=0?"+":"-";switch(t){case"short":return`${s}${li(i,2)}:${li(r,2)}`;case"narrow":return`${s}${i}${r>0?`:${r}`:""}`;case"techie":return`${s}${li(i,2)}${li(r,2)}`;default:throw new RangeError(`Value format ${t} is out of range for property format`)}}function Hb(e){return VJ(e,["hour","minute","second","millisecond"])}const jJ=["January","February","March","April","May","June","July","August","September","October","November","December"],IF=["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],GJ=["J","F","M","A","M","J","J","A","S","O","N","D"];function AF(e){switch(e){case"narrow":return[...GJ];case"short":return[...IF];case"long":return[...jJ];case"numeric":return["1","2","3","4","5","6","7","8","9","10","11","12"];case"2-digit":return["01","02","03","04","05","06","07","08","09","10","11","12"];default:return null}}const LF=["Monday","Tuesday","Wednesday","Thursday","Friday","Saturday","Sunday"],kF=["Mon","Tue","Wed","Thu","Fri","Sat","Sun"],BJ=["M","T","W","T","F","S","S"];function RF(e){switch(e){case"narrow":return[...BJ];case"short":return[...kF];case"long":return[...LF];case"numeric":return["1","2","3","4","5","6","7"];default:return null}}const OF=["AM","PM"],qJ=["Before Christ","Anno Domini"],HJ=["BC","AD"],WJ=["B","A"];function NF(e){switch(e){case"narrow":return[...WJ];case"short":return[...HJ];case"long":return[...qJ];default:return null}}function ZJ(e){return OF[e.hour<12?0:1]}function YJ(e,t){return RF(t)[e.weekday-1]}function JJ(e,t){return AF(t)[e.month-1]}function XJ(e,t){return NF(t)[e.year<0?0:1]}function KJ(e,t,i="always",r=!1){const s={years:["year","yr."],quarters:["quarter","qtr."],months:["month","mo."],weeks:["week","wk."],days:["day","day","days"],hours:["hour","hr."],minutes:["minute","min."],seconds:["second","sec."]},n=["hours","minutes","seconds"].indexOf(e)===-1;if(i==="auto"&&n){const d=e==="days";switch(t){case 1:return d?"tomorrow":`next ${s[e][0]}`;case-1:return d?"yesterday":`last ${s[e][0]}`;case 0:return d?"today":`this ${s[e][0]}`}}const o=Object.is(t,-0)||t<0,a=Math.abs(t),l=a===1,u=s[e],c=r?l?u[1]:u[2]||u[1]:l?s[e][0]:e;return o?`${a} ${c} ago`:`in ${a} ${c}`}function H3(e,t){let i="";for(const r of e)r.literal?i+=r.val:i+=t(r.val);return i}const QJ={D:hv,DD:Q4,DDD:eF,DDDD:tF,t:iF,tt:rF,ttt:sF,tttt:nF,T:oF,TT:aF,TTT:lF,TTTT:uF,f:cF,ff:dF,fff:fF,ffff:yF,F:hF,FF:pF,FFF:mF,FFFF:gF};class nr{static create(t,i={}){return new nr(t,i)}static parseFormat(t){let i=null,r="",s=!1;const n=[];for(let o=0;o<t.length;o++){const a=t.charAt(o);a==="'"?(r.length>0&&n.push({literal:s||/^\s+$/.test(r),val:r}),i=null,r="",s=!s):s||a===i?r+=a:(r.length>0&&n.push({literal:/^\s+$/.test(r),val:r}),r=a,i=a)}return r.length>0&&n.push({literal:s||/^\s+$/.test(r),val:r}),n}static macroTokenToFormatOpts(t){return QJ[t]}constructor(t,i){this.opts=i,this.loc=t,this.systemLoc=null}formatWithSystemDefault(t,i){return this.systemLoc===null&&(this.systemLoc=this.loc.redefaultToSystem()),this.systemLoc.dtFormatter(t,{...this.opts,...i}).format()}dtFormatter(t,i={}){return this.loc.dtFormatter(t,{...this.opts,...i})}formatDateTime(t,i){return this.dtFormatter(t,i).format()}formatDateTimeParts(t,i){return this.dtFormatter(t,i).formatToParts()}formatInterval(t,i){return this.dtFormatter(t.start,i).dtf.formatRange(t.start.toJSDate(),t.end.toJSDate())}resolvedOptions(t,i){return this.dtFormatter(t,i).resolvedOptions()}num(t,i=0){if(this.opts.forceSimple)return li(t,i);const r={...this.opts};return i>0&&(r.padTo=i),this.loc.numberFormatter(r).format(t)}formatDateTimeFromString(t,i){const r=this.loc.listingMode()==="en",s=this.loc.outputCalendar&&this.loc.outputCalendar!=="gregory",n=(y,g)=>this.loc.extract(t,y,g),o=y=>t.isOffsetFixed&&t.offset===0&&y.allowZ?"Z":t.isValid?t.zone.formatOffset(t.ts,y.format):"",a=()=>r?ZJ(t):n({hour:"numeric",hourCycle:"h12"},"dayperiod"),l=(y,g)=>r?JJ(t,y):n(g?{month:y}:{month:y,day:"numeric"},"month"),u=(y,g)=>r?YJ(t,y):n(g?{weekday:y}:{weekday:y,month:"long",day:"numeric"},"weekday"),c=y=>{const g=nr.macroTokenToFormatOpts(y);return g?this.formatWithSystemDefault(t,g):y},d=y=>r?XJ(t,y):n({era:y},"era"),m=y=>{switch(y){case"S":return this.num(t.millisecond);case"u":case"SSS":return this.num(t.millisecond,3);case"s":return this.num(t.second);case"ss":return this.num(t.second,2);case"uu":return this.num(Math.floor(t.millisecond/10),2);case"uuu":return this.num(Math.floor(t.millisecond/100));case"m":return this.num(t.minute);case"mm":return this.num(t.minute,2);case"h":return this.num(t.hour%12===0?12:t.hour%12);case"hh":return this.num(t.hour%12===0?12:t.hour%12,2);case"H":return this.num(t.hour);case"HH":return this.num(t.hour,2);case"Z":return o({format:"narrow",allowZ:this.opts.allowZ});case"ZZ":return o({format:"short",allowZ:this.opts.allowZ});case"ZZZ":return o({format:"techie",allowZ:this.opts.allowZ});case"ZZZZ":return t.zone.offsetName(t.ts,{format:"short",locale:this.loc.locale});case"ZZZZZ":return t.zone.offsetName(t.ts,{format:"long",locale:this.loc.locale});case"z":return t.zoneName;case"a":return a();case"d":return s?n({day:"numeric"},"day"):this.num(t.day);case"dd":return s?n({day:"2-digit"},"day"):this.num(t.day,2);case"c":return this.num(t.weekday);case"ccc":return u("short",!0);case"cccc":return u("long",!0);case"ccccc":return u("narrow",!0);case"E":return this.num(t.weekday);case"EEE":return u("short",!1);case"EEEE":return u("long",!1);case"EEEEE":return u("narrow",!1);case"L":return s?n({month:"numeric",day:"numeric"},"month"):this.num(t.month);case"LL":return s?n({month:"2-digit",day:"numeric"},"month"):this.num(t.month,2);case"LLL":return l("short",!0);case"LLLL":return l("long",!0);case"LLLLL":return l("narrow",!0);case"M":return s?n({month:"numeric"},"month"):this.num(t.month);case"MM":return s?n({month:"2-digit"},"month"):this.num(t.month,2);case"MMM":return l("short",!1);case"MMMM":return l("long",!1);case"MMMMM":return l("narrow",!1);case"y":return s?n({year:"numeric"},"year"):this.num(t.year);case"yy":return s?n({year:"2-digit"},"year"):this.num(t.year.toString().slice(-2),2);case"yyyy":return s?n({year:"numeric"},"year"):this.num(t.year,4);case"yyyyyy":return s?n({year:"numeric"},"year"):this.num(t.year,6);case"G":return d("short");case"GG":return d("long");case"GGGGG":return d("narrow");case"kk":return this.num(t.weekYear.toString().slice(-2),2);case"kkkk":return this.num(t.weekYear,4);case"W":return this.num(t.weekNumber);case"WW":return this.num(t.weekNumber,2);case"n":return this.num(t.localWeekNumber);case"nn":return this.num(t.localWeekNumber,2);case"ii":return this.num(t.localWeekYear.toString().slice(-2),2);case"iiii":return this.num(t.localWeekYear,4);case"o":return this.num(t.ordinal);case"ooo":return this.num(t.ordinal,3);case"q":return this.num(t.quarter);case"qq":return this.num(t.quarter,2);case"X":return this.num(Math.floor(t.ts/1e3));case"x":return this.num(t.ts);default:return c(y)}};return H3(nr.parseFormat(i),m)}formatDurationFromString(t,i){const r=l=>{switch(l[0]){case"S":return"millisecond";case"s":return"second";case"m":return"minute";case"h":return"hour";case"d":return"day";case"w":return"week";case"M":return"month";case"y":return"year";default:return null}},s=l=>u=>{const c=r(u);return c?this.num(l.get(c),u.length):u},n=nr.parseFormat(i),o=n.reduce((l,{literal:u,val:c})=>u?l:l.concat(c),[]),a=t.shiftTo(...o.map(r).filter(l=>l));return H3(n,s(a))}}const DF=/[A-Za-z_+-]{1,256}(?::?\/[A-Za-z0-9_+-]{1,256}(?:\/[A-Za-z0-9_+-]{1,256})?)?/;function hf(...e){const t=e.reduce((i,r)=>i+r.source,"");return RegExp(`^${t}$`)}function df(...e){return t=>e.reduce(([i,r,s],n)=>{const[o,a,l]=n(t,s);return[{...i,...o},a||r,l]},[{},null,1]).slice(0,2)}function pf(e,...t){if(e==null)return[null,null];for(const[i,r]of t){const s=i.exec(e);if(s)return r(s)}return[null,null]}function FF(...e){return(t,i)=>{const r={};let s;for(s=0;s<e.length;s++)r[e[s]]=Ol(t[i+s]);return[r,null,i+s]}}const zF=/(?:(Z)|([+-]\d\d)(?::?(\d\d))?)/,eX=`(?:${zF.source}?(?:\\[(${DF.source})\\])?)?`,mC=/(\d\d)(?::?(\d\d)(?::?(\d\d)(?:[.,](\d{1,30}))?)?)?/,VF=RegExp(`${mC.source}${eX}`),yC=RegExp(`(?:T${VF.source})?`),tX=/([+-]\d{6}|\d{4})(?:-?(\d\d)(?:-?(\d\d))?)?/,iX=/(\d{4})-?W(\d\d)(?:-?(\d))?/,rX=/(\d{4})-?(\d{3})/,sX=FF("weekYear","weekNumber","weekDay"),nX=FF("year","ordinal"),oX=/(\d{4})-(\d\d)-(\d\d)/,UF=RegExp(`${mC.source} ?(?:${zF.source}|(${DF.source}))?`),aX=RegExp(`(?: ${UF.source})?`);function Xd(e,t,i){const r=e[t];return Te(r)?i:Ol(r)}function lX(e,t){return[{year:Xd(e,t),month:Xd(e,t+1,1),day:Xd(e,t+2,1)},null,t+3]}function ff(e,t){return[{hours:Xd(e,t,0),minutes:Xd(e,t+1,0),seconds:Xd(e,t+2,0),milliseconds:pC(e[t+3])},null,t+4]}function Fg(e,t){const i=!e[t]&&!e[t+1],r=qb(e[t+1],e[t+2]),s=i?null:ui.instance(r);return[{},s,t+3]}function zg(e,t){const i=e[t]?Zr.create(e[t]):null;return[{},i,t+1]}const uX=RegExp(`^T?${mC.source}$`),cX=/^-?P(?:(?:(-?\d{1,20}(?:\.\d{1,20})?)Y)?(?:(-?\d{1,20}(?:\.\d{1,20})?)M)?(?:(-?\d{1,20}(?:\.\d{1,20})?)W)?(?:(-?\d{1,20}(?:\.\d{1,20})?)D)?(?:T(?:(-?\d{1,20}(?:\.\d{1,20})?)H)?(?:(-?\d{1,20}(?:\.\d{1,20})?)M)?(?:(-?\d{1,20})(?:[.,](-?\d{1,20}))?S)?)?)$/;function hX(e){const[t,i,r,s,n,o,a,l,u]=e,c=t[0]==="-",d=l&&l[0]==="-",m=(y,g=!1)=>y!==void 0&&(g||y&&c)?-y:y;return[{years:m(Tu(i)),months:m(Tu(r)),weeks:m(Tu(s)),days:m(Tu(n)),hours:m(Tu(o)),minutes:m(Tu(a)),seconds:m(Tu(l),l==="-0"),milliseconds:m(pC(u),d)}]}const dX={GMT:0,EDT:-240,EST:-300,CDT:-300,CST:-360,MDT:-360,MST:-420,PDT:-420,PST:-480};function gC(e,t,i,r,s,n,o){const a={year:t.length===2?$x(Ol(t)):Ol(t),month:IF.indexOf(i)+1,day:Ol(r),hour:Ol(s),minute:Ol(n)};return o&&(a.second=Ol(o)),e&&(a.weekday=e.length>3?LF.indexOf(e)+1:kF.indexOf(e)+1),a}const pX=/^(?:(Mon|Tue|Wed|Thu|Fri|Sat|Sun),\s)?(\d{1,2})\s(Jan|Feb|Mar|Apr|May|Jun|Jul|Aug|Sep|Oct|Nov|Dec)\s(\d{2,4})\s(\d\d):(\d\d)(?::(\d\d))?\s(?:(UT|GMT|[ECMP][SD]T)|([Zz])|(?:([+-]\d\d)(\d\d)))$/;function fX(e){const[,t,i,r,s,n,o,a,l,u,c,d]=e,m=gC(t,s,r,i,n,o,a);let y;return l?y=dX[l]:u?y=0:y=qb(c,d),[m,new ui(y)]}function mX(e){return e.replace(/\([^()]*\)|[\n\t]/g," ").replace(/(\s\s+)/g," ").trim()}const yX=/^(Mon|Tue|Wed|Thu|Fri|Sat|Sun), (\d\d) (Jan|Feb|Mar|Apr|May|Jun|Jul|Aug|Sep|Oct|Nov|Dec) (\d{4}) (\d\d):(\d\d):(\d\d) GMT$/,gX=/^(Monday|Tuesday|Wednesday|Thursday|Friday|Saturday|Sunday), (\d\d)-(Jan|Feb|Mar|Apr|May|Jun|Jul|Aug|Sep|Oct|Nov|Dec)-(\d\d) (\d\d):(\d\d):(\d\d) GMT$/,_X=/^(Mon|Tue|Wed|Thu|Fri|Sat|Sun) (Jan|Feb|Mar|Apr|May|Jun|Jul|Aug|Sep|Oct|Nov|Dec) ( \d|\d\d) (\d\d):(\d\d):(\d\d) (\d{4})$/;function W3(e){const[,t,i,r,s,n,o,a]=e;return[gC(t,s,r,i,n,o,a),ui.utcInstance]}function vX(e){const[,t,i,r,s,n,o,a]=e;return[gC(t,a,i,r,s,n,o),ui.utcInstance]}const bX=hf(tX,yC),wX=hf(iX,yC),SX=hf(rX,yC),xX=hf(VF),jF=df(lX,ff,Fg,zg),$X=df(sX,ff,Fg,zg),MX=df(nX,ff,Fg,zg),TX=df(ff,Fg,zg);function EX(e){return pf(e,[bX,jF],[wX,$X],[SX,MX],[xX,TX])}function CX(e){return pf(mX(e),[pX,fX])}function PX(e){return pf(e,[yX,W3],[gX,W3],[_X,vX])}function IX(e){return pf(e,[cX,hX])}const AX=df(ff);function LX(e){return pf(e,[uX,AX])}const kX=hf(oX,aX),RX=hf(UF),OX=df(ff,Fg,zg);function NX(e){return pf(e,[kX,jF],[RX,OX])}const Z3="Invalid Duration",GF={weeks:{days:7,hours:168,minutes:10080,seconds:10080*60,milliseconds:10080*60*1e3},days:{hours:24,minutes:1440,seconds:1440*60,milliseconds:1440*60*1e3},hours:{minutes:60,seconds:3600,milliseconds:3600*1e3},minutes:{seconds:60,milliseconds:60*1e3},seconds:{milliseconds:1e3}},DX={years:{quarters:4,months:12,weeks:52,days:365,hours:365*24,minutes:365*24*60,seconds:365*24*60*60,milliseconds:365*24*60*60*1e3},quarters:{months:3,weeks:13,days:91,hours:2184,minutes:2184*60,seconds:2184*60*60,milliseconds:2184*60*60*1e3},months:{weeks:4,days:30,hours:720,minutes:720*60,seconds:720*60*60,milliseconds:720*60*60*1e3},...GF},gs=146097/400,kh=146097/4800,FX={years:{quarters:4,months:12,weeks:gs/7,days:gs,hours:gs*24,minutes:gs*24*60,seconds:gs*24*60*60,milliseconds:gs*24*60*60*1e3},quarters:{months:3,weeks:gs/28,days:gs/4,hours:gs*24/4,minutes:gs*24*60/4,seconds:gs*24*60*60/4,milliseconds:gs*24*60*60*1e3/4},months:{weeks:kh/7,days:kh,hours:kh*24,minutes:kh*24*60,seconds:kh*24*60*60,milliseconds:kh*24*60*60*1e3},...GF},Ic=["years","quarters","months","weeks","days","hours","minutes","seconds","milliseconds"],zX=Ic.slice(0).reverse();function ul(e,t,i=!1){const r={values:i?t.values:{...e.values,...t.values||{}},loc:e.loc.clone(t.loc),conversionAccuracy:t.conversionAccuracy||e.conversionAccuracy,matrix:t.matrix||e.matrix};return new Ge(r)}function BF(e,t){let i=t.milliseconds??0;for(const r of zX.slice(1))t[r]&&(i+=t[r]*e[r].milliseconds);return i}function Y3(e,t){const i=BF(e,t)<0?-1:1;Ic.reduceRight((r,s)=>{if(Te(t[s]))return r;if(r){const n=t[r]*i,o=e[s][r],a=Math.floor(n/o);t[s]+=a*i,t[r]-=a*o*i}return s},null),Ic.reduce((r,s)=>{if(Te(t[s]))return r;if(r){const n=t[r]%1;t[r]-=n,t[s]+=n*e[r][s]}return s},null)}function VX(e){const t={};for(const[i,r]of Object.entries(e))r!==0&&(t[i]=r);return t}class Ge{constructor(t){const i=t.conversionAccuracy==="longterm"||!1;let r=i?FX:DX;t.matrix&&(r=t.matrix),this.values=t.values,this.loc=t.loc||rt.create(),this.conversionAccuracy=i?"longterm":"casual",this.invalid=t.invalid||null,this.matrix=r,this.isLuxonDuration=!0}static fromMillis(t,i){return Ge.fromObject({milliseconds:t},i)}static fromObject(t,i={}){if(t==null||typeof t!="object")throw new Ki(`Duration.fromObject: argument expected to be an object, got ${t===null?"null":typeof t}`);return new Ge({values:fv(t,Ge.normalizeUnit),loc:rt.fromObject(i),conversionAccuracy:i.conversionAccuracy,matrix:i.matrix})}static fromDurationLike(t){if(su(t))return Ge.fromMillis(t);if(Ge.isDuration(t))return t;if(typeof t=="object")return Ge.fromObject(t);throw new Ki(`Unknown duration argument ${t} of type ${typeof t}`)}static fromISO(t,i){const[r]=IX(t);return r?Ge.fromObject(r,i):Ge.invalid("unparsable",`the input "${t}" can't be parsed as ISO 8601`)}static fromISOTime(t,i){const[r]=LX(t);return r?Ge.fromObject(r,i):Ge.invalid("unparsable",`the input "${t}" can't be parsed as ISO 8601`)}static invalid(t,i=null){if(!t)throw new Ki("need to specify a reason the Duration is invalid");const r=t instanceof Tn?t:new Tn(t,i);if(Zt.throwOnInvalid)throw new hJ(r);return new Ge({invalid:r})}static normalizeUnit(t){const i={year:"years",years:"years",quarter:"quarters",quarters:"quarters",month:"months",months:"months",week:"weeks",weeks:"weeks",day:"days",days:"days",hour:"hours",hours:"hours",minute:"minutes",minutes:"minutes",second:"seconds",seconds:"seconds",millisecond:"milliseconds",milliseconds:"milliseconds"}[t&&t.toLowerCase()];if(!i)throw new K4(t);return i}static isDuration(t){return t&&t.isLuxonDuration||!1}get locale(){return this.isValid?this.loc.locale:null}get numberingSystem(){return this.isValid?this.loc.numberingSystem:null}toFormat(t,i={}){const r={...i,floor:i.round!==!1&&i.floor!==!1};return this.isValid?nr.create(this.loc,r).formatDurationFromString(this,t):Z3}toHuman(t={}){if(!this.isValid)return Z3;const i=Ic.map(r=>{const s=this.values[r];return Te(s)?null:this.loc.numberFormatter({style:"unit",unitDisplay:"long",...t,unit:r.slice(0,-1)}).format(s)}).filter(r=>r);return this.loc.listFormatter({type:"conjunction",style:t.listStyle||"narrow",...t}).format(i)}toObject(){return this.isValid?{...this.values}:{}}toISO(){if(!this.isValid)return null;let t="P";return this.years!==0&&(t+=this.years+"Y"),(this.months!==0||this.quarters!==0)&&(t+=this.months+this.quarters*3+"M"),this.weeks!==0&&(t+=this.weeks+"W"),this.days!==0&&(t+=this.days+"D"),(this.hours!==0||this.minutes!==0||this.seconds!==0||this.milliseconds!==0)&&(t+="T"),this.hours!==0&&(t+=this.hours+"H"),this.minutes!==0&&(t+=this.minutes+"M"),(this.seconds!==0||this.milliseconds!==0)&&(t+=fC(this.seconds+this.milliseconds/1e3,3)+"S"),t==="P"&&(t+="T0S"),t}toISOTime(t={}){if(!this.isValid)return null;const i=this.toMillis();return i<0||i>=864e5?null:(t={suppressMilliseconds:!1,suppressSeconds:!1,includePrefix:!1,format:"extended",...t,includeOffset:!1},se.fromMillis(i,{zone:"UTC"}).toISOTime(t))}toJSON(){return this.toISO()}toString(){return this.toISO()}[Symbol.for("nodejs.util.inspect.custom")](){return this.isValid?`Duration { values: ${JSON.stringify(this.values)} }`:`Duration { Invalid, reason: ${this.invalidReason} }`}toMillis(){return this.isValid?BF(this.matrix,this.values):NaN}valueOf(){return this.toMillis()}plus(t){if(!this.isValid)return this;const i=Ge.fromDurationLike(t),r={};for(const s of Ic)(Up(i.values,s)||Up(this.values,s))&&(r[s]=i.get(s)+this.get(s));return ul(this,{values:r},!0)}minus(t){if(!this.isValid)return this;const i=Ge.fromDurationLike(t);return this.plus(i.negate())}mapUnits(t){if(!this.isValid)return this;const i={};for(const r of Object.keys(this.values))i[r]=PF(t(this.values[r],r));return ul(this,{values:i},!0)}get(t){return this[Ge.normalizeUnit(t)]}set(t){if(!this.isValid)return this;const i={...this.values,...fv(t,Ge.normalizeUnit)};return ul(this,{values:i})}reconfigure({locale:t,numberingSystem:i,conversionAccuracy:r,matrix:s}={}){const o={loc:this.loc.clone({locale:t,numberingSystem:i}),matrix:s,conversionAccuracy:r};return ul(this,o)}as(t){return this.isValid?this.shiftTo(t).get(t):NaN}normalize(){if(!this.isValid)return this;const t=this.toObject();return Y3(this.matrix,t),ul(this,{values:t},!0)}rescale(){if(!this.isValid)return this;const t=VX(this.normalize().shiftToAll().toObject());return ul(this,{values:t},!0)}shiftTo(...t){if(!this.isValid)return this;if(t.length===0)return this;t=t.map(o=>Ge.normalizeUnit(o));const i={},r={},s=this.toObject();let n;for(const o of Ic)if(t.indexOf(o)>=0){n=o;let a=0;for(const u in r)a+=this.matrix[u][o]*r[u],r[u]=0;su(s[o])&&(a+=s[o]);const l=Math.trunc(a);i[o]=l,r[o]=(a*1e3-l*1e3)/1e3}else su(s[o])&&(r[o]=s[o]);for(const o in r)r[o]!==0&&(i[n]+=o===n?r[o]:r[o]/this.matrix[n][o]);return Y3(this.matrix,i),ul(this,{values:i},!0)}shiftToAll(){return this.isValid?this.shiftTo("years","months","weeks","days","hours","minutes","seconds","milliseconds"):this}negate(){if(!this.isValid)return this;const t={};for(const i of Object.keys(this.values))t[i]=this.values[i]===0?0:-this.values[i];return ul(this,{values:t},!0)}get years(){return this.isValid?this.values.years||0:NaN}get quarters(){return this.isValid?this.values.quarters||0:NaN}get months(){return this.isValid?this.values.months||0:NaN}get weeks(){return this.isValid?this.values.weeks||0:NaN}get days(){return this.isValid?this.values.days||0:NaN}get hours(){return this.isValid?this.values.hours||0:NaN}get minutes(){return this.isValid?this.values.minutes||0:NaN}get seconds(){return this.isValid?this.values.seconds||0:NaN}get milliseconds(){return this.isValid?this.values.milliseconds||0:NaN}get isValid(){return this.invalid===null}get invalidReason(){return this.invalid?this.invalid.reason:null}get invalidExplanation(){return this.invalid?this.invalid.explanation:null}equals(t){if(!this.isValid||!t.isValid||!this.loc.equals(t.loc))return!1;function i(r,s){return r===void 0||r===0?s===void 0||s===0:r===s}for(const r of Ic)if(!i(this.values[r],t.values[r]))return!1;return!0}}const Rh="Invalid Interval";function UX(e,t){return!e||!e.isValid?qt.invalid("missing or invalid start"):!t||!t.isValid?qt.invalid("missing or invalid end"):t<e?qt.invalid("end before start",`The end of an interval must be after its start, but you had start=${e.toISO()} and end=${t.toISO()}`):null}class qt{constructor(t){this.s=t.start,this.e=t.end,this.invalid=t.invalid||null,this.isLuxonInterval=!0}static invalid(t,i=null){if(!t)throw new Ki("need to specify a reason the Interval is invalid");const r=t instanceof Tn?t:new Tn(t,i);if(Zt.throwOnInvalid)throw new cJ(r);return new qt({invalid:r})}static fromDateTimes(t,i){const r=If(t),s=If(i),n=UX(r,s);return n??new qt({start:r,end:s})}static after(t,i){const r=Ge.fromDurationLike(i),s=If(t);return qt.fromDateTimes(s,s.plus(r))}static before(t,i){const r=Ge.fromDurationLike(i),s=If(t);return qt.fromDateTimes(s.minus(r),s)}static fromISO(t,i){const[r,s]=(t||"").split("/",2);if(r&&s){let n,o;try{n=se.fromISO(r,i),o=n.isValid}catch{o=!1}let a,l;try{a=se.fromISO(s,i),l=a.isValid}catch{l=!1}if(o&&l)return qt.fromDateTimes(n,a);if(o){const u=Ge.fromISO(s,i);if(u.isValid)return qt.after(n,u)}else if(l){const u=Ge.fromISO(r,i);if(u.isValid)return qt.before(a,u)}}return qt.invalid("unparsable",`the input "${t}" can't be parsed as ISO 8601`)}static isInterval(t){return t&&t.isLuxonInterval||!1}get start(){return this.isValid?this.s:null}get end(){return this.isValid?this.e:null}get lastDateTime(){return this.isValid&&this.e?this.e.minus(1):null}get isValid(){return this.invalidReason===null}get invalidReason(){return this.invalid?this.invalid.reason:null}get invalidExplanation(){return this.invalid?this.invalid.explanation:null}length(t="milliseconds"){return this.isValid?this.toDuration(t).get(t):NaN}count(t="milliseconds",i){if(!this.isValid)return NaN;const r=this.start.startOf(t,i);let s;return i?.useLocaleWeeks?s=this.end.reconfigure({locale:r.locale}):s=this.end,s=s.startOf(t,i),Math.floor(s.diff(r,t).get(t))+(s.valueOf()!==this.end.valueOf())}hasSame(t){return this.isValid?this.isEmpty()||this.e.minus(1).hasSame(this.s,t):!1}isEmpty(){return this.s.valueOf()===this.e.valueOf()}isAfter(t){return this.isValid?this.s>t:!1}isBefore(t){return this.isValid?this.e<=t:!1}contains(t){return this.isValid?this.s<=t&&this.e>t:!1}set({start:t,end:i}={}){return this.isValid?qt.fromDateTimes(t||this.s,i||this.e):this}splitAt(...t){if(!this.isValid)return[];const i=t.map(If).filter(o=>this.contains(o)).sort((o,a)=>o.toMillis()-a.toMillis()),r=[];let{s}=this,n=0;for(;s<this.e;){const o=i[n]||this.e,a=+o>+this.e?this.e:o;r.push(qt.fromDateTimes(s,a)),s=a,n+=1}return r}splitBy(t){const i=Ge.fromDurationLike(t);if(!this.isValid||!i.isValid||i.as("milliseconds")===0)return[];let{s:r}=this,s=1,n;const o=[];for(;r<this.e;){const a=this.start.plus(i.mapUnits(l=>l*s));n=+a>+this.e?this.e:a,o.push(qt.fromDateTimes(r,n)),r=n,s+=1}return o}divideEqually(t){return this.isValid?this.splitBy(this.length()/t).slice(0,t):[]}overlaps(t){return this.e>t.s&&this.s<t.e}abutsStart(t){return this.isValid?+this.e==+t.s:!1}abutsEnd(t){return this.isValid?+t.e==+this.s:!1}engulfs(t){return this.isValid?this.s<=t.s&&this.e>=t.e:!1}equals(t){return!this.isValid||!t.isValid?!1:this.s.equals(t.s)&&this.e.equals(t.e)}intersection(t){if(!this.isValid)return this;const i=this.s>t.s?this.s:t.s,r=this.e<t.e?this.e:t.e;return i>=r?null:qt.fromDateTimes(i,r)}union(t){if(!this.isValid)return this;const i=this.s<t.s?this.s:t.s,r=this.e>t.e?this.e:t.e;return qt.fromDateTimes(i,r)}static merge(t){const[i,r]=t.sort((s,n)=>s.s-n.s).reduce(([s,n],o)=>n?n.overlaps(o)||n.abutsStart(o)?[s,n.union(o)]:[s.concat([n]),o]:[s,o],[[],null]);return r&&i.push(r),i}static xor(t){let i=null,r=0;const s=[],n=t.map(l=>[{time:l.s,type:"s"},{time:l.e,type:"e"}]),o=Array.prototype.concat(...n),a=o.sort((l,u)=>l.time-u.time);for(const l of a)r+=l.type==="s"?1:-1,r===1?i=l.time:(i&&+i!=+l.time&&s.push(qt.fromDateTimes(i,l.time)),i=null);return qt.merge(s)}difference(...t){return qt.xor([this].concat(t)).map(i=>this.intersection(i)).filter(i=>i&&!i.isEmpty())}toString(){return this.isValid?`[${this.s.toISO()}  ${this.e.toISO()})`:Rh}[Symbol.for("nodejs.util.inspect.custom")](){return this.isValid?`Interval { start: ${this.s.toISO()}, end: ${this.e.toISO()} }`:`Interval { Invalid, reason: ${this.invalidReason} }`}toLocaleString(t=hv,i={}){return this.isValid?nr.create(this.s.loc.clone(i),t).formatInterval(this):Rh}toISO(t){return this.isValid?`${this.s.toISO(t)}/${this.e.toISO(t)}`:Rh}toISODate(){return this.isValid?`${this.s.toISODate()}/${this.e.toISODate()}`:Rh}toISOTime(t){return this.isValid?`${this.s.toISOTime(t)}/${this.e.toISOTime(t)}`:Rh}toFormat(t,{separator:i="  "}={}){return this.isValid?`${this.s.toFormat(t)}${i}${this.e.toFormat(t)}`:Rh}toDuration(t,i){return this.isValid?this.e.diff(this.s,t,i):Ge.invalid(this.invalidReason)}mapEndpoints(t){return qt.fromDateTimes(t(this.s),t(this.e))}}class _0{static hasDST(t=Zt.defaultZone){const i=se.now().setZone(t).set({month:12});return!t.isUniversal&&i.offset!==i.set({month:6}).offset}static isValidIANAZone(t){return Zr.isValidZone(t)}static normalizeZone(t){return Hl(t,Zt.defaultZone)}static getStartOfWeek({locale:t=null,locObj:i=null}={}){return(i||rt.create(t)).getStartOfWeek()}static getMinimumDaysInFirstWeek({locale:t=null,locObj:i=null}={}){return(i||rt.create(t)).getMinDaysInFirstWeek()}static getWeekendWeekdays({locale:t=null,locObj:i=null}={}){return(i||rt.create(t)).getWeekendDays().slice()}static months(t="long",{locale:i=null,numberingSystem:r=null,locObj:s=null,outputCalendar:n="gregory"}={}){return(s||rt.create(i,r,n)).months(t)}static monthsFormat(t="long",{locale:i=null,numberingSystem:r=null,locObj:s=null,outputCalendar:n="gregory"}={}){return(s||rt.create(i,r,n)).months(t,!0)}static weekdays(t="long",{locale:i=null,numberingSystem:r=null,locObj:s=null}={}){return(s||rt.create(i,r,null)).weekdays(t)}static weekdaysFormat(t="long",{locale:i=null,numberingSystem:r=null,locObj:s=null}={}){return(s||rt.create(i,r,null)).weekdays(t,!0)}static meridiems({locale:t=null}={}){return rt.create(t).meridiems()}static eras(t="short",{locale:i=null}={}){return rt.create(i,null,"gregory").eras(t)}static features(){return{relative:TF(),localeWeek:EF()}}}function J3(e,t){const i=s=>s.toUTC(0,{keepLocalTime:!0}).startOf("day").valueOf(),r=i(t)-i(e);return Math.floor(Ge.fromMillis(r).as("days"))}function jX(e,t,i){const r=[["years",(l,u)=>u.year-l.year],["quarters",(l,u)=>u.quarter-l.quarter+(u.year-l.year)*4],["months",(l,u)=>u.month-l.month+(u.year-l.year)*12],["weeks",(l,u)=>{const c=J3(l,u);return(c-c%7)/7}],["days",J3]],s={},n=e;let o,a;for(const[l,u]of r)i.indexOf(l)>=0&&(o=l,s[l]=u(e,t),a=n.plus(s),a>t?(s[l]--,e=n.plus(s),e>t&&(a=e,s[l]--,e=n.plus(s))):e=a);return[e,s,a,o]}function GX(e,t,i,r){let[s,n,o,a]=jX(e,t,i);const l=t-s,u=i.filter(d=>["hours","minutes","seconds","milliseconds"].indexOf(d)>=0);u.length===0&&(o<t&&(o=s.plus({[a]:1})),o!==s&&(n[a]=(n[a]||0)+l/(o-s)));const c=Ge.fromObject(n,r);return u.length>0?Ge.fromMillis(l,r).shiftTo(...u).plus(c):c}const BX="missing Intl.DateTimeFormat.formatToParts support";function Xe(e,t=i=>i){return{regex:e,deser:([i])=>t(kJ(i))}}const qX="",qF=`[ ${qX}]`,HF=new RegExp(qF,"g");function HX(e){return e.replace(/\./g,"\\.?").replace(HF,qF)}function X3(e){return e.replace(/\./g,"").replace(HF," ").toLowerCase()}function tn(e,t){return e===null?null:{regex:RegExp(e.map(HX).join("|")),deser:([i])=>e.findIndex(r=>X3(i)===X3(r))+t}}function K3(e,t){return{regex:e,deser:([,i,r])=>qb(i,r),groups:t}}function v0(e){return{regex:e,deser:([t])=>t}}function WX(e){return e.replace(/[\-\[\]{}()*+?.,\\\^$|#\s]/g,"\\$&")}function ZX(e,t){const i=en(t),r=en(t,"{2}"),s=en(t,"{3}"),n=en(t,"{4}"),o=en(t,"{6}"),a=en(t,"{1,2}"),l=en(t,"{1,3}"),u=en(t,"{1,6}"),c=en(t,"{1,9}"),d=en(t,"{2,4}"),m=en(t,"{4,6}"),y=v=>({regex:RegExp(WX(v.val)),deser:([b])=>b,literal:!0}),_=(v=>{if(e.literal)return y(v);switch(v.val){case"G":return tn(t.eras("short"),0);case"GG":return tn(t.eras("long"),0);case"y":return Xe(u);case"yy":return Xe(d,$x);case"yyyy":return Xe(n);case"yyyyy":return Xe(m);case"yyyyyy":return Xe(o);case"M":return Xe(a);case"MM":return Xe(r);case"MMM":return tn(t.months("short",!0),1);case"MMMM":return tn(t.months("long",!0),1);case"L":return Xe(a);case"LL":return Xe(r);case"LLL":return tn(t.months("short",!1),1);case"LLLL":return tn(t.months("long",!1),1);case"d":return Xe(a);case"dd":return Xe(r);case"o":return Xe(l);case"ooo":return Xe(s);case"HH":return Xe(r);case"H":return Xe(a);case"hh":return Xe(r);case"h":return Xe(a);case"mm":return Xe(r);case"m":return Xe(a);case"q":return Xe(a);case"qq":return Xe(r);case"s":return Xe(a);case"ss":return Xe(r);case"S":return Xe(l);case"SSS":return Xe(s);case"u":return v0(c);case"uu":return v0(a);case"uuu":return Xe(i);case"a":return tn(t.meridiems(),0);case"kkkk":return Xe(n);case"kk":return Xe(d,$x);case"W":return Xe(a);case"WW":return Xe(r);case"E":case"c":return Xe(i);case"EEE":return tn(t.weekdays("short",!1),1);case"EEEE":return tn(t.weekdays("long",!1),1);case"ccc":return tn(t.weekdays("short",!0),1);case"cccc":return tn(t.weekdays("long",!0),1);case"Z":case"ZZ":return K3(new RegExp(`([+-]${a.source})(?::(${r.source}))?`),2);case"ZZZ":return K3(new RegExp(`([+-]${a.source})(${r.source})?`),2);case"z":return v0(/[a-z_+-/]{1,256}?/i);case" ":return v0(/[^\S\n\r]/);default:return y(v)}})(e)||{invalidReason:BX};return _.token=e,_}const YX={year:{"2-digit":"yy",numeric:"yyyyy"},month:{numeric:"M","2-digit":"MM",short:"MMM",long:"MMMM"},day:{numeric:"d","2-digit":"dd"},weekday:{short:"EEE",long:"EEEE"},dayperiod:"a",dayPeriod:"a",hour12:{numeric:"h","2-digit":"hh"},hour24:{numeric:"H","2-digit":"HH"},minute:{numeric:"m","2-digit":"mm"},second:{numeric:"s","2-digit":"ss"},timeZoneName:{long:"ZZZZZ",short:"ZZZ"}};function JX(e,t,i){const{type:r,value:s}=e;if(r==="literal"){const l=/^\s+$/.test(s);return{literal:!l,val:l?" ":s}}const n=t[r];let o=r;r==="hour"&&(t.hour12!=null?o=t.hour12?"hour12":"hour24":t.hourCycle!=null?t.hourCycle==="h11"||t.hourCycle==="h12"?o="hour12":o="hour24":o=i.hour12?"hour12":"hour24");let a=YX[o];if(typeof a=="object"&&(a=a[n]),a)return{literal:!1,val:a}}function XX(e){return[`^${e.map(i=>i.regex).reduce((i,r)=>`${i}(${r.source})`,"")}$`,e]}function KX(e,t,i){const r=e.match(t);if(r){const s={};let n=1;for(const o in i)if(Up(i,o)){const a=i[o],l=a.groups?a.groups+1:1;!a.literal&&a.token&&(s[a.token.val[0]]=a.deser(r.slice(n,n+l))),n+=l}return[r,s]}else return[r,{}]}function QX(e){const t=n=>{switch(n){case"S":return"millisecond";case"s":return"second";case"m":return"minute";case"h":case"H":return"hour";case"d":return"day";case"o":return"ordinal";case"L":case"M":return"month";case"y":return"year";case"E":case"c":return"weekday";case"W":return"weekNumber";case"k":return"weekYear";case"q":return"quarter";default:return null}};let i=null,r;return Te(e.z)||(i=Zr.create(e.z)),Te(e.Z)||(i||(i=new ui(e.Z)),r=e.Z),Te(e.q)||(e.M=(e.q-1)*3+1),Te(e.h)||(e.h<12&&e.a===1?e.h+=12:e.h===12&&e.a===0&&(e.h=0)),e.G===0&&e.y&&(e.y=-e.y),Te(e.u)||(e.S=pC(e.u)),[Object.keys(e).reduce((n,o)=>{const a=t(o);return a&&(n[a]=e[o]),n},{}),i,r]}let l2=null;function eK(){return l2||(l2=se.fromMillis(1555555555555)),l2}function tK(e,t){if(e.literal)return e;const i=nr.macroTokenToFormatOpts(e.val),r=JF(i,t);return r==null||r.includes(void 0)?e:r}function WF(e,t){return Array.prototype.concat(...e.map(i=>tK(i,t)))}class ZF{constructor(t,i){if(this.locale=t,this.format=i,this.tokens=WF(nr.parseFormat(i),t),this.units=this.tokens.map(r=>ZX(r,t)),this.disqualifyingUnit=this.units.find(r=>r.invalidReason),!this.disqualifyingUnit){const[r,s]=XX(this.units);this.regex=RegExp(r,"i"),this.handlers=s}}explainFromTokens(t){if(this.isValid){const[i,r]=KX(t,this.regex,this.handlers),[s,n,o]=r?QX(r):[null,null,void 0];if(Up(r,"a")&&Up(r,"H"))throw new Ed("Can't include meridiem when specifying 24-hour format");return{input:t,tokens:this.tokens,regex:this.regex,rawMatches:i,matches:r,result:s,zone:n,specificOffset:o}}else return{input:t,tokens:this.tokens,invalidReason:this.invalidReason}}get isValid(){return!this.disqualifyingUnit}get invalidReason(){return this.disqualifyingUnit?this.disqualifyingUnit.invalidReason:null}}function YF(e,t,i){return new ZF(e,i).explainFromTokens(t)}function iK(e,t,i){const{result:r,zone:s,specificOffset:n,invalidReason:o}=YF(e,t,i);return[r,s,n,o]}function JF(e,t){if(!e)return null;const r=nr.create(t,e).dtFormatter(eK()),s=r.formatToParts(),n=r.resolvedOptions();return s.map(o=>JX(o,e,n))}const u2="Invalid DateTime",Q3=864e13;function fm(e){return new Tn("unsupported zone",`the zone "${e.name}" is not supported`)}function c2(e){return e.weekData===null&&(e.weekData=dv(e.c)),e.weekData}function h2(e){return e.localWeekData===null&&(e.localWeekData=dv(e.c,e.loc.getMinDaysInFirstWeek(),e.loc.getStartOfWeek())),e.localWeekData}function Eu(e,t){const i={ts:e.ts,zone:e.zone,c:e.c,o:e.o,loc:e.loc,invalid:e.invalid};return new se({...i,...t,old:i})}function XF(e,t,i){let r=e-t*60*1e3;const s=i.offset(r);if(t===s)return[r,t];r-=(s-t)*60*1e3;const n=i.offset(r);return s===n?[r,s]:[e-Math.min(s,n)*60*1e3,Math.max(s,n)]}function b0(e,t){e+=t*60*1e3;const i=new Date(e);return{year:i.getUTCFullYear(),month:i.getUTCMonth()+1,day:i.getUTCDate(),hour:i.getUTCHours(),minute:i.getUTCMinutes(),second:i.getUTCSeconds(),millisecond:i.getUTCMilliseconds()}}function L_(e,t,i){return XF(Bb(e),t,i)}function eA(e,t){const i=e.o,r=e.c.year+Math.trunc(t.years),s=e.c.month+Math.trunc(t.months)+Math.trunc(t.quarters)*3,n={...e.c,year:r,month:s,day:Math.min(e.c.day,pv(r,s))+Math.trunc(t.days)+Math.trunc(t.weeks)*7},o=Ge.fromObject({years:t.years-Math.trunc(t.years),quarters:t.quarters-Math.trunc(t.quarters),months:t.months-Math.trunc(t.months),weeks:t.weeks-Math.trunc(t.weeks),days:t.days-Math.trunc(t.days),hours:t.hours,minutes:t.minutes,seconds:t.seconds,milliseconds:t.milliseconds}).as("milliseconds"),a=Bb(n);let[l,u]=XF(a,i,e.zone);return o!==0&&(l+=o,u=e.zone.offset(l)),{ts:l,o:u}}function Oh(e,t,i,r,s,n){const{setZone:o,zone:a}=i;if(e&&Object.keys(e).length!==0||t){const l=t||a,u=se.fromObject(e,{...i,zone:l,specificOffset:n});return o?u:u.setZone(a)}else return se.invalid(new Tn("unparsable",`the input "${s}" can't be parsed as ${r}`))}function w0(e,t,i=!0){return e.isValid?nr.create(rt.create("en-US"),{allowZ:i,forceSimple:!0}).formatDateTimeFromString(e,t):null}function d2(e,t){const i=e.c.year>9999||e.c.year<0;let r="";return i&&e.c.year>=0&&(r+="+"),r+=li(e.c.year,i?6:4),t?(r+="-",r+=li(e.c.month),r+="-",r+=li(e.c.day)):(r+=li(e.c.month),r+=li(e.c.day)),r}function tA(e,t,i,r,s,n){let o=li(e.c.hour);return t?(o+=":",o+=li(e.c.minute),(e.c.millisecond!==0||e.c.second!==0||!i)&&(o+=":")):o+=li(e.c.minute),(e.c.millisecond!==0||e.c.second!==0||!i)&&(o+=li(e.c.second),(e.c.millisecond!==0||!r)&&(o+=".",o+=li(e.c.millisecond,3))),s&&(e.isOffsetFixed&&e.offset===0&&!n?o+="Z":e.o<0?(o+="-",o+=li(Math.trunc(-e.o/60)),o+=":",o+=li(Math.trunc(-e.o%60))):(o+="+",o+=li(Math.trunc(e.o/60)),o+=":",o+=li(Math.trunc(e.o%60)))),n&&(o+="["+e.zone.ianaName+"]"),o}const KF={month:1,day:1,hour:0,minute:0,second:0,millisecond:0},rK={weekNumber:1,weekday:1,hour:0,minute:0,second:0,millisecond:0},sK={ordinal:1,hour:0,minute:0,second:0,millisecond:0},QF=["year","month","day","hour","minute","second","millisecond"],nK=["weekYear","weekNumber","weekday","hour","minute","second","millisecond"],oK=["year","ordinal","hour","minute","second","millisecond"];function aK(e){const t={year:"year",years:"year",month:"month",months:"month",day:"day",days:"day",hour:"hour",hours:"hour",minute:"minute",minutes:"minute",quarter:"quarter",quarters:"quarter",second:"second",seconds:"second",millisecond:"millisecond",milliseconds:"millisecond",weekday:"weekday",weekdays:"weekday",weeknumber:"weekNumber",weeksnumber:"weekNumber",weeknumbers:"weekNumber",weekyear:"weekYear",weekyears:"weekYear",ordinal:"ordinal"}[e.toLowerCase()];if(!t)throw new K4(e);return t}function iA(e){switch(e.toLowerCase()){case"localweekday":case"localweekdays":return"localWeekday";case"localweeknumber":case"localweeknumbers":return"localWeekNumber";case"localweekyear":case"localweekyears":return"localWeekYear";default:return aK(e)}}function lK(e){if(mm===void 0&&(mm=Zt.now()),e.type!=="iana")return e.offset(mm);const t=e.name;let i=Mx.get(t);return i===void 0&&(i=e.offset(mm),Mx.set(t,i)),i}function rA(e,t){const i=Hl(t.zone,Zt.defaultZone);if(!i.isValid)return se.invalid(fm(i));const r=rt.fromObject(t);let s,n;if(Te(e.year))s=Zt.now();else{for(const l of QF)Te(e[l])&&(e[l]=KF[l]);const o=$F(e)||MF(e);if(o)return se.invalid(o);const a=lK(i);[s,n]=L_(e,a,i)}return new se({ts:s,zone:i,loc:r,o:n})}function sA(e,t,i){const r=Te(i.round)?!0:i.round,s=(o,a)=>(o=fC(o,r||i.calendary?0:2,!0),t.loc.clone(i).relFormatter(i).format(o,a)),n=o=>i.calendary?t.hasSame(e,o)?0:t.startOf(o).diff(e.startOf(o),o).get(o):t.diff(e,o).get(o);if(i.unit)return s(n(i.unit),i.unit);for(const o of i.units){const a=n(o);if(Math.abs(a)>=1)return s(a,o)}return s(e>t?-0:0,i.units[i.units.length-1])}function nA(e){let t={},i;return e.length>0&&typeof e[e.length-1]=="object"?(t=e[e.length-1],i=Array.from(e).slice(0,e.length-1)):i=Array.from(e),[t,i]}let mm;const Mx=new Map;class se{constructor(t){const i=t.zone||Zt.defaultZone;let r=t.invalid||(Number.isNaN(t.ts)?new Tn("invalid input"):null)||(i.isValid?null:fm(i));this.ts=Te(t.ts)?Zt.now():t.ts;let s=null,n=null;if(!r)if(t.old&&t.old.ts===this.ts&&t.old.zone.equals(i))[s,n]=[t.old.c,t.old.o];else{const a=su(t.o)&&!t.old?t.o:i.offset(this.ts);s=b0(this.ts,a),r=Number.isNaN(s.year)?new Tn("invalid input"):null,s=r?null:s,n=r?null:a}this._zone=i,this.loc=t.loc||rt.create(),this.invalid=r,this.weekData=null,this.localWeekData=null,this.c=s,this.o=n,this.isLuxonDateTime=!0}static now(){return new se({})}static local(){const[t,i]=nA(arguments),[r,s,n,o,a,l,u]=i;return rA({year:r,month:s,day:n,hour:o,minute:a,second:l,millisecond:u},t)}static utc(){const[t,i]=nA(arguments),[r,s,n,o,a,l,u]=i;return t.zone=ui.utcInstance,rA({year:r,month:s,day:n,hour:o,minute:a,second:l,millisecond:u},t)}static fromJSDate(t,i={}){const r=FJ(t)?t.valueOf():NaN;if(Number.isNaN(r))return se.invalid("invalid input");const s=Hl(i.zone,Zt.defaultZone);return s.isValid?new se({ts:r,zone:s,loc:rt.fromObject(i)}):se.invalid(fm(s))}static fromMillis(t,i={}){if(su(t))return t<-Q3||t>Q3?se.invalid("Timestamp out of range"):new se({ts:t,zone:Hl(i.zone,Zt.defaultZone),loc:rt.fromObject(i)});throw new Ki(`fromMillis requires a numerical input, but received a ${typeof t} with value ${t}`)}static fromSeconds(t,i={}){if(su(t))return new se({ts:t*1e3,zone:Hl(i.zone,Zt.defaultZone),loc:rt.fromObject(i)});throw new Ki("fromSeconds requires a numerical input")}static fromObject(t,i={}){t=t||{};const r=Hl(i.zone,Zt.defaultZone);if(!r.isValid)return se.invalid(fm(r));const s=rt.fromObject(i),n=fv(t,iA),{minDaysInFirstWeek:o,startOfWeek:a}=G3(n,s),l=Zt.now(),u=Te(i.specificOffset)?r.offset(l):i.specificOffset,c=!Te(n.ordinal),d=!Te(n.year),m=!Te(n.month)||!Te(n.day),y=d||m,g=n.weekYear||n.weekNumber;if((y||c)&&g)throw new Ed("Can't mix weekYear/weekNumber units with year/month/day or ordinals");if(m&&c)throw new Ed("Can't mix ordinal dates with month/day");const _=g||n.weekday&&!y;let v,b,S=b0(l,u);_?(v=nK,b=rK,S=dv(S,o,a)):c?(v=oK,b=sK,S=a2(S)):(v=QF,b=KF);let $=!1;for(const U of v){const W=n[U];Te(W)?$?n[U]=b[U]:n[U]=S[U]:$=!0}const E=_?OJ(n,o,a):c?NJ(n):$F(n),C=E||MF(n);if(C)return se.invalid(C);const P=_?U3(n,o,a):c?j3(n):n,[k,F]=L_(P,u,r),D=new se({ts:k,zone:r,o:F,loc:s});return n.weekday&&y&&t.weekday!==D.weekday?se.invalid("mismatched weekday",`you can't specify both a weekday of ${n.weekday} and a date of ${D.toISO()}`):D.isValid?D:se.invalid(D.invalid)}static fromISO(t,i={}){const[r,s]=EX(t);return Oh(r,s,i,"ISO 8601",t)}static fromRFC2822(t,i={}){const[r,s]=CX(t);return Oh(r,s,i,"RFC 2822",t)}static fromHTTP(t,i={}){const[r,s]=PX(t);return Oh(r,s,i,"HTTP",i)}static fromFormat(t,i,r={}){if(Te(t)||Te(i))throw new Ki("fromFormat requires an input string and a format");const{locale:s=null,numberingSystem:n=null}=r,o=rt.fromOpts({locale:s,numberingSystem:n,defaultToEN:!0}),[a,l,u,c]=iK(o,t,i);return c?se.invalid(c):Oh(a,l,r,`format ${i}`,t,u)}static fromString(t,i,r={}){return se.fromFormat(t,i,r)}static fromSQL(t,i={}){const[r,s]=NX(t);return Oh(r,s,i,"SQL",t)}static invalid(t,i=null){if(!t)throw new Ki("need to specify a reason the DateTime is invalid");const r=t instanceof Tn?t:new Tn(t,i);if(Zt.throwOnInvalid)throw new uJ(r);return new se({invalid:r})}static isDateTime(t){return t&&t.isLuxonDateTime||!1}static parseFormatForOpts(t,i={}){const r=JF(t,rt.fromObject(i));return r?r.map(s=>s?s.val:null).join(""):null}static expandFormat(t,i={}){return WF(nr.parseFormat(t),rt.fromObject(i)).map(s=>s.val).join("")}static resetCache(){mm=void 0,Mx.clear()}get(t){return this[t]}get isValid(){return this.invalid===null}get invalidReason(){return this.invalid?this.invalid.reason:null}get invalidExplanation(){return this.invalid?this.invalid.explanation:null}get locale(){return this.isValid?this.loc.locale:null}get numberingSystem(){return this.isValid?this.loc.numberingSystem:null}get outputCalendar(){return this.isValid?this.loc.outputCalendar:null}get zone(){return this._zone}get zoneName(){return this.isValid?this.zone.name:null}get year(){return this.isValid?this.c.year:NaN}get quarter(){return this.isValid?Math.ceil(this.c.month/3):NaN}get month(){return this.isValid?this.c.month:NaN}get day(){return this.isValid?this.c.day:NaN}get hour(){return this.isValid?this.c.hour:NaN}get minute(){return this.isValid?this.c.minute:NaN}get second(){return this.isValid?this.c.second:NaN}get millisecond(){return this.isValid?this.c.millisecond:NaN}get weekYear(){return this.isValid?c2(this).weekYear:NaN}get weekNumber(){return this.isValid?c2(this).weekNumber:NaN}get weekday(){return this.isValid?c2(this).weekday:NaN}get isWeekend(){return this.isValid&&this.loc.getWeekendDays().includes(this.weekday)}get localWeekday(){return this.isValid?h2(this).weekday:NaN}get localWeekNumber(){return this.isValid?h2(this).weekNumber:NaN}get localWeekYear(){return this.isValid?h2(this).weekYear:NaN}get ordinal(){return this.isValid?a2(this.c).ordinal:NaN}get monthShort(){return this.isValid?_0.months("short",{locObj:this.loc})[this.month-1]:null}get monthLong(){return this.isValid?_0.months("long",{locObj:this.loc})[this.month-1]:null}get weekdayShort(){return this.isValid?_0.weekdays("short",{locObj:this.loc})[this.weekday-1]:null}get weekdayLong(){return this.isValid?_0.weekdays("long",{locObj:this.loc})[this.weekday-1]:null}get offset(){return this.isValid?+this.o:NaN}get offsetNameShort(){return this.isValid?this.zone.offsetName(this.ts,{format:"short",locale:this.locale}):null}get offsetNameLong(){return this.isValid?this.zone.offsetName(this.ts,{format:"long",locale:this.locale}):null}get isOffsetFixed(){return this.isValid?this.zone.isUniversal:null}get isInDST(){return this.isOffsetFixed?!1:this.offset>this.set({month:1,day:1}).offset||this.offset>this.set({month:5}).offset}getPossibleOffsets(){if(!this.isValid||this.isOffsetFixed)return[this];const t=864e5,i=6e4,r=Bb(this.c),s=this.zone.offset(r-t),n=this.zone.offset(r+t),o=this.zone.offset(r-s*i),a=this.zone.offset(r-n*i);if(o===a)return[this];const l=r-o*i,u=r-a*i,c=b0(l,o),d=b0(u,a);return c.hour===d.hour&&c.minute===d.minute&&c.second===d.second&&c.millisecond===d.millisecond?[Eu(this,{ts:l}),Eu(this,{ts:u})]:[this]}get isInLeapYear(){return Dg(this.year)}get daysInMonth(){return pv(this.year,this.month)}get daysInYear(){return this.isValid?Jd(this.year):NaN}get weeksInWeekYear(){return this.isValid?qy(this.weekYear):NaN}get weeksInLocalWeekYear(){return this.isValid?qy(this.localWeekYear,this.loc.getMinDaysInFirstWeek(),this.loc.getStartOfWeek()):NaN}resolvedLocaleOptions(t={}){const{locale:i,numberingSystem:r,calendar:s}=nr.create(this.loc.clone(t),t).resolvedOptions(this);return{locale:i,numberingSystem:r,outputCalendar:s}}toUTC(t=0,i={}){return this.setZone(ui.instance(t),i)}toLocal(){return this.setZone(Zt.defaultZone)}setZone(t,{keepLocalTime:i=!1,keepCalendarTime:r=!1}={}){if(t=Hl(t,Zt.defaultZone),t.equals(this.zone))return this;if(t.isValid){let s=this.ts;if(i||r){const n=t.offset(this.ts),o=this.toObject();[s]=L_(o,n,t)}return Eu(this,{ts:s,zone:t})}else return se.invalid(fm(t))}reconfigure({locale:t,numberingSystem:i,outputCalendar:r}={}){const s=this.loc.clone({locale:t,numberingSystem:i,outputCalendar:r});return Eu(this,{loc:s})}setLocale(t){return this.reconfigure({locale:t})}set(t){if(!this.isValid)return this;const i=fv(t,iA),{minDaysInFirstWeek:r,startOfWeek:s}=G3(i,this.loc),n=!Te(i.weekYear)||!Te(i.weekNumber)||!Te(i.weekday),o=!Te(i.ordinal),a=!Te(i.year),l=!Te(i.month)||!Te(i.day),u=a||l,c=i.weekYear||i.weekNumber;if((u||o)&&c)throw new Ed("Can't mix weekYear/weekNumber units with year/month/day or ordinals");if(l&&o)throw new Ed("Can't mix ordinal dates with month/day");let d;n?d=U3({...dv(this.c,r,s),...i},r,s):Te(i.ordinal)?(d={...this.toObject(),...i},Te(i.day)&&(d.day=Math.min(pv(d.year,d.month),d.day))):d=j3({...a2(this.c),...i});const[m,y]=L_(d,this.o,this.zone);return Eu(this,{ts:m,o:y})}plus(t){if(!this.isValid)return this;const i=Ge.fromDurationLike(t);return Eu(this,eA(this,i))}minus(t){if(!this.isValid)return this;const i=Ge.fromDurationLike(t).negate();return Eu(this,eA(this,i))}startOf(t,{useLocaleWeeks:i=!1}={}){if(!this.isValid)return this;const r={},s=Ge.normalizeUnit(t);switch(s){case"years":r.month=1;case"quarters":case"months":r.day=1;case"weeks":case"days":r.hour=0;case"hours":r.minute=0;case"minutes":r.second=0;case"seconds":r.millisecond=0;break}if(s==="weeks")if(i){const n=this.loc.getStartOfWeek(),{weekday:o}=this;o<n&&(r.weekNumber=this.weekNumber-1),r.weekday=n}else r.weekday=1;if(s==="quarters"){const n=Math.ceil(this.month/3);r.month=(n-1)*3+1}return this.set(r)}endOf(t,i){return this.isValid?this.plus({[t]:1}).startOf(t,i).minus(1):this}toFormat(t,i={}){return this.isValid?nr.create(this.loc.redefaultToEN(i)).formatDateTimeFromString(this,t):u2}toLocaleString(t=hv,i={}){return this.isValid?nr.create(this.loc.clone(i),t).formatDateTime(this):u2}toLocaleParts(t={}){return this.isValid?nr.create(this.loc.clone(t),t).formatDateTimeParts(this):[]}toISO({format:t="extended",suppressSeconds:i=!1,suppressMilliseconds:r=!1,includeOffset:s=!0,extendedZone:n=!1}={}){if(!this.isValid)return null;const o=t==="extended";let a=d2(this,o);return a+="T",a+=tA(this,o,i,r,s,n),a}toISODate({format:t="extended"}={}){return this.isValid?d2(this,t==="extended"):null}toISOWeekDate(){return w0(this,"kkkk-'W'WW-c")}toISOTime({suppressMilliseconds:t=!1,suppressSeconds:i=!1,includeOffset:r=!0,includePrefix:s=!1,extendedZone:n=!1,format:o="extended"}={}){return this.isValid?(s?"T":"")+tA(this,o==="extended",i,t,r,n):null}toRFC2822(){return w0(this,"EEE, dd LLL yyyy HH:mm:ss ZZZ",!1)}toHTTP(){return w0(this.toUTC(),"EEE, dd LLL yyyy HH:mm:ss 'GMT'")}toSQLDate(){return this.isValid?d2(this,!0):null}toSQLTime({includeOffset:t=!0,includeZone:i=!1,includeOffsetSpace:r=!0}={}){let s="HH:mm:ss.SSS";return(i||t)&&(r&&(s+=" "),i?s+="z":t&&(s+="ZZ")),w0(this,s,!0)}toSQL(t={}){return this.isValid?`${this.toSQLDate()} ${this.toSQLTime(t)}`:null}toString(){return this.isValid?this.toISO():u2}[Symbol.for("nodejs.util.inspect.custom")](){return this.isValid?`DateTime { ts: ${this.toISO()}, zone: ${this.zone.name}, locale: ${this.locale} }`:`DateTime { Invalid, reason: ${this.invalidReason} }`}valueOf(){return this.toMillis()}toMillis(){return this.isValid?this.ts:NaN}toSeconds(){return this.isValid?this.ts/1e3:NaN}toUnixInteger(){return this.isValid?Math.floor(this.ts/1e3):NaN}toJSON(){return this.toISO()}toBSON(){return this.toJSDate()}toObject(t={}){if(!this.isValid)return{};const i={...this.c};return t.includeConfig&&(i.outputCalendar=this.outputCalendar,i.numberingSystem=this.loc.numberingSystem,i.locale=this.loc.locale),i}toJSDate(){return new Date(this.isValid?this.ts:NaN)}diff(t,i="milliseconds",r={}){if(!this.isValid||!t.isValid)return Ge.invalid("created by diffing an invalid DateTime");const s={locale:this.locale,numberingSystem:this.numberingSystem,...r},n=zJ(i).map(Ge.normalizeUnit),o=t.valueOf()>this.valueOf(),a=o?this:t,l=o?t:this,u=GX(a,l,n,s);return o?u.negate():u}diffNow(t="milliseconds",i={}){return this.diff(se.now(),t,i)}until(t){return this.isValid?qt.fromDateTimes(this,t):this}hasSame(t,i,r){if(!this.isValid)return!1;const s=t.valueOf(),n=this.setZone(t.zone,{keepLocalTime:!0});return n.startOf(i,r)<=s&&s<=n.endOf(i,r)}equals(t){return this.isValid&&t.isValid&&this.valueOf()===t.valueOf()&&this.zone.equals(t.zone)&&this.loc.equals(t.loc)}toRelative(t={}){if(!this.isValid)return null;const i=t.base||se.fromObject({},{zone:this.zone}),r=t.padding?this<i?-t.padding:t.padding:0;let s=["years","months","days","hours","minutes","seconds"],n=t.unit;return Array.isArray(t.unit)&&(s=t.unit,n=void 0),sA(i,this.plus(r),{...t,numeric:"always",units:s,unit:n})}toRelativeCalendar(t={}){return this.isValid?sA(t.base||se.fromObject({},{zone:this.zone}),this,{...t,numeric:"auto",units:["years","months","days"],calendary:!0}):null}static min(...t){if(!t.every(se.isDateTime))throw new Ki("min requires all arguments be DateTimes");return B3(t,i=>i.valueOf(),Math.min)}static max(...t){if(!t.every(se.isDateTime))throw new Ki("max requires all arguments be DateTimes");return B3(t,i=>i.valueOf(),Math.max)}static fromFormatExplain(t,i,r={}){const{locale:s=null,numberingSystem:n=null}=r,o=rt.fromOpts({locale:s,numberingSystem:n,defaultToEN:!0});return YF(o,t,i)}static fromStringExplain(t,i,r={}){return se.fromFormatExplain(t,i,r)}static buildFormatParser(t,i={}){const{locale:r=null,numberingSystem:s=null}=i,n=rt.fromOpts({locale:r,numberingSystem:s,defaultToEN:!0});return new ZF(n,t)}static fromFormatParser(t,i,r={}){if(Te(t)||Te(i))throw new Ki("fromFormatParser requires an input string and a format parser");const{locale:s=null,numberingSystem:n=null}=r,o=rt.fromOpts({locale:s,numberingSystem:n,defaultToEN:!0});if(!o.equals(i.locale))throw new Ki(`fromFormatParser called with a locale of ${o}, but the format parser was created for ${i.locale}`);const{result:a,zone:l,specificOffset:u,invalidReason:c}=i.explainFromTokens(t);return c?se.invalid(c):Oh(a,l,r,`format ${i.format}`,t,u)}static get DATE_SHORT(){return hv}static get DATE_MED(){return Q4}static get DATE_MED_WITH_WEEKDAY(){return dJ}static get DATE_FULL(){return eF}static get DATE_HUGE(){return tF}static get TIME_SIMPLE(){return iF}static get TIME_WITH_SECONDS(){return rF}static get TIME_WITH_SHORT_OFFSET(){return sF}static get TIME_WITH_LONG_OFFSET(){return nF}static get TIME_24_SIMPLE(){return oF}static get TIME_24_WITH_SECONDS(){return aF}static get TIME_24_WITH_SHORT_OFFSET(){return lF}static get TIME_24_WITH_LONG_OFFSET(){return uF}static get DATETIME_SHORT(){return cF}static get DATETIME_SHORT_WITH_SECONDS(){return hF}static get DATETIME_MED(){return dF}static get DATETIME_MED_WITH_SECONDS(){return pF}static get DATETIME_MED_WITH_WEEKDAY(){return pJ}static get DATETIME_FULL(){return fF}static get DATETIME_FULL_WITH_SECONDS(){return mF}static get DATETIME_HUGE(){return yF}static get DATETIME_HUGE_WITH_SECONDS(){return gF}}function If(e){if(se.isDateTime(e))return e;if(e&&e.valueOf&&su(e.valueOf()))return se.fromJSDate(e);if(e&&typeof e=="object")return se.fromObject(e);throw new Ki(`Unknown datetime argument: ${e}, of type ${typeof e}`)}const uK="shortOffset";function cK(e){return"timeZoneIANA"in e}function hK(e){return e.startsWith("UTC")}function VTe(e,t=!1){return{json:{read:{source:e,reader:(i,r)=>r[e]?k_(r[e]):null},write:!!t&&{allowNull:!0,writer(i,r){r[e]=i?dK(i):null}}}}}function k_(e,t=On){return e?cK(e)?e.timeZoneIANA:pK(e,t):t}function dK(e){return{timeZoneIANA:e}}function pK(e,t=On){if(!e||!I3.has(e.timeZone))return t;const i=I3.get(e.timeZone);return hK(e.timeZone)||e.respectsDaylightSaving?i:fK(i)}function fK(e){const t=se.local().setZone(e),i=Math.min(t.set({month:1,day:1}).offset,t.set({month:5}).offset);return i===0?"Etc/UTC":`Etc/GMT${ui.instance(-i).formatOffset(0,"narrow")}`}function mK(e,t,i,r,s){if(t&&s==="date")return{timeZone:Uo,timeZoneName:void 0};const n=r.timeStyle||r.hour,o=i===fu;return{timeZone:o?s==="timestamp-offset"?void 0:e??Uo:i,timeZoneName:o&&n?uK:void 0}}function yK(e){const t=new Set(["etc/utc","etc/gmt","gmt"]),i=new Set(Intl.supportedValuesOf("timeZone").map((r=>r.toLowerCase())));return e===On||e===fu||t.has(e.toLowerCase())||i.has(e.toLowerCase())}const gK={year:void 0,month:void 0,day:void 0,weekday:void 0},_K={hour:void 0,minute:void 0,second:void 0},e6={timeZone:Uo},zn={year:"numeric",month:"numeric",day:"numeric"},Af={year:"numeric",month:"long",day:"numeric"},Lf={year:"numeric",month:"short",day:"numeric"},kf={year:"numeric",month:"long",weekday:"long",day:"numeric"},Nl={hour:"numeric",minute:"numeric"},ju={...Nl,second:"numeric"},t6={hourCycle:"h23"},Rf={...Nl,...t6},Of={...ju,...t6},i6={"short-date":zn,"short-date-short-time":{...zn,...Nl},"short-date-short-time-24":{...zn,...Rf},"short-date-long-time":{...zn,...ju},"short-date-long-time-24":{...zn,...Of},"short-date-le":zn,"short-date-le-short-time":{...zn,...Nl},"short-date-le-short-time-24":{...zn,...Rf},"short-date-le-long-time":{...zn,...ju},"short-date-le-long-time-24":{...zn,...Of},"long-month-day-year":Af,"long-month-day-year-short-time":{...Af,...Nl},"long-month-day-year-short-time-24":{...Af,...Rf},"long-month-day-year-long-time":{...Af,...ju},"long-month-day-year-long-time-24":{...Af,...Of},"day-short-month-year":Lf,"day-short-month-year-short-time":{...Lf,...Nl},"day-short-month-year-short-time-24":{...Lf,...Rf},"day-short-month-year-long-time":{...Lf,...ju},"day-short-month-year-long-time-24":{...Lf,...Of},"long-date":kf,"long-date-short-time":{...kf,...Nl},"long-date-short-time-24":{...kf,...Rf},"long-date-long-time":{...kf,...ju},"long-date-long-time-24":{...kf,...Of},"long-month-year":{month:"long",year:"numeric"},"short-month-year":{month:"short",year:"numeric"},year:{year:"numeric"},"short-time":Nl,"long-time":ju},vK=cr()({shortDate:"short-date",shortDateShortTime:"short-date-short-time",shortDateShortTime24:"short-date-short-time-24",shortDateLongTime:"short-date-long-time",shortDateLongTime24:"short-date-long-time-24",shortDateLE:"short-date-le",shortDateLEShortTime:"short-date-le-short-time",shortDateLEShortTime24:"short-date-le-short-time-24",shortDateLELongTime:"short-date-le-long-time",shortDateLELongTime24:"short-date-le-long-time-24",longMonthDayYear:"long-month-day-year",longMonthDayYearShortTime:"long-month-day-year-short-time",longMonthDayYearShortTime24:"long-month-day-year-short-time-24",longMonthDayYearLongTime:"long-month-day-year-long-time",longMonthDayYearLongTime24:"long-month-day-year-long-time-24",dayShortMonthYear:"day-short-month-year",dayShortMonthYearShortTime:"day-short-month-year-short-time",dayShortMonthYearShortTime24:"day-short-month-year-short-time-24",dayShortMonthYearLongTime:"day-short-month-year-long-time",dayShortMonthYearLongTime24:"day-short-month-year-long-time-24",longDate:"long-date",longDateShortTime:"long-date-short-time",longDateShortTime24:"long-date-short-time-24",longDateLongTime:"long-date-long-time",longDateLongTime24:"long-date-long-time-24",longMonthYear:"long-month-year",shortMonthYear:"short-month-year",year:"year"}),r6={ar:"ar-u-nu-latn-ca-gregory",nn:"no-NN"},bK=new Intl.DateTimeFormat("bs",{month:"long"}).formatToParts(new Date(2025,2)),wK=bK.find((({type:e})=>e==="month"))?.value.toLowerCase();function s6(){const e=Hr(),t=oC(e)?.language;return(t&&r6[t])??e}wK!=="mart"&&(r6.bs="sr-Latn-CS");let Tx=new WeakMap;const Wb=i6["short-date-short-time"];function SK(e){let t=Tx.get(e);if(!t){const i=s6(),r=_C(e.timeZone??On),s={...e,timeZone:r};t=new Intl.DateTimeFormat(i,s),Tx.set(e,t)}return t}function Nf(e){return i6[e]}function En(e,t=Wb){return SK(t).format(e)}function xK(e,t=Wb){return En(new Date(e),{...t,...e6,..._K})}function $K(e,t=Wb){return En(new Date(`1970-01-01T${e}Z`),{...t,...e6,...gK})}function MK(e,t=Wb){if(t.timeZone)return En(new Date(e),t);const i=se.fromISO(e,{setZone:!0}),r=i.offset===0?Uo:t.timeZone,s={...t,timeZone:r};return i.toLocaleString(s,{locale:s6()})}function _C(e){switch(e){case On:return lJ;case fu:return Uo;default:return e}}lC((()=>{Tx=new WeakMap}));const TK={ar:"ar-u-nu-latn",bs:"sr-Latn-CS",nn:"no-NN"};let R_=new WeakMap,n6={};function Ex(e){const t=e||n6;if(!R_.has(t)){const i=Hr(),r=oC(i)?.language,s=r&&TK[r]||i;R_.set(t,new Intl.NumberFormat(s,e))}return R_.get(t)}function UTe(e={}){const t={};return e.digitSeparator!=null&&(t.useGrouping=e.digitSeparator),e.places!=null&&(t.minimumFractionDigits=t.maximumFractionDigits=e.places),t}function mu(e,t){return Object.is(e,-0)&&(e=0),Ex(t).format(e)}function jTe(e,t=Hr()){if(!e)return null;let i=oA.get(t);if(!i){const r=Ex().formatToParts(12345.6),s=[...Ex({useGrouping:!1}).format(9876543210)].reverse(),n=new Map(s.map(((d,m)=>[d,m]))),o=new RegExp(`[${r.find((d=>d.type==="group"))?.value}]`,"g"),a=new RegExp(`[${r.find((d=>d.type==="decimal"))?.value}]`),l=new RegExp(`[${s.join("")}]`,"g"),u=/[\u200E\u200F\u202A\u202B\u202C\u202D\u202E\u2066\u2067\u2068\u2069\u061C]/g,c=/[-\u2212\u2013\u2014\u2015]/g;i=d=>{if((d=d.trim().replaceAll(o,"").replace(a,".").replace(l,(y=>String(n.get(y)))).replaceAll(u,"").replaceAll(c,"-"))==="")return null;const m=Number(d);return isNaN(m)?null:m},oA.set(t,i)}return i(e)}lC((()=>{R_=new WeakMap,n6={}}));const oA=new Map,o6=()=>H.getLogger("esri.intl.substitute");function mv(e,t,i={}){const{format:r={}}=i;return mh(e,(s=>EK(s,t,r)))}function EK(e,t,i){let r,s;const n=e.indexOf(":");if(n===-1?r=e.trim():(r=e.slice(0,n).trim(),s=e.slice(n+1).trim()),!r)return"";const o=xg(r,t);if(o==null)return"";const a=(s?i?.[s]:null)??i?.[r];return a?CK(o,a):s?PK(o,s):vC(o)}function CK(e,t){switch(t.type){case"date":return En(e,t.intlOptions);case"number":return mu(e,t.intlOptions);default:return o6().warn("missing format descriptor for key {key}"),vC(e)}}function PK(e,t){switch(t.toLowerCase()){case"dateformat":return En(e);case"numberformat":return mu(e);default:return o6().warn(`inline format is unsupported since 4.12: ${t}`),/^(dateformat|datestring)/i.test(t)?En(e):/^numberformat/i.test(t)?mu(e):vC(e)}}function vC(e){switch(typeof e){case"string":return e;case"number":return mu(e);case"boolean":return""+e;default:return e instanceof Date?En(e):""}}async function IK(e,t,i,r){const s=t.exec(i);if(!s)throw new j("esri-intl:invalid-bundle",`Bundle id "${i}" is not compatible with the pattern "${t}"`);const n=s[1]?`${s[1]}/`:"",o=s[2],a=J4(r),l=`${n}${o}.json`,u=a?`${n}${o}_${a}.json`:l;let c;try{c=await aA(e(u))}catch(d){if(u===l)throw new j("intl:unknown-bundle",`Bundle "${i}" cannot be loaded`,{error:d});try{c=await aA(e(l))}catch(m){throw new j("intl:unknown-bundle",`Bundle "${i}" cannot be loaded`,{error:m})}}return c}async function aA(e){if(lA.fetchBundleAsset!=null)return lA.fetchBundleAsset(e);const t=await at(e,{responseType:"text"});return JSON.parse(t.data)}let AK=class{constructor({base:t="",pattern:i,location:r=new URL(window.location.href)}){let s;s=typeof r=="string"?n=>new URL(n,new URL(r,window.location.href)).href:r instanceof URL?n=>new URL(n,r).href:r,this.pattern=typeof i=="string"?new RegExp(`^${i}`):i,this.getAssetUrl=s,t=t?t.endsWith("/")?t:t+"/":"",this.matcher=new RegExp(`^${t}(?:(.*)\\/)?(.*)$`)}fetchMessageBundle(t,i){return IK(this.getAssetUrl,this.matcher,t,i)}};function LK(e){return new AK(e)}const lA={};sJ(LK({pattern:"esri/",location:vt}));let aa=class extends le{constructor(t){super(t),this.apiKey=null,this.id=null,this.language=null,this.places=null,this.serviceUrl="https://basemapstyles-api.arcgis.com/arcgis/rest/services/styles/v2",this.worldview=null}get languageParameter(){const t=this.language;let i=t==="local"||t==="global"?t:J4(t??Hr())??"global";return i=i==="no"?"nb":i,i}};h([f()],aa.prototype,"apiKey",void 0),h([f()],aa.prototype,"id",void 0),h([f()],aa.prototype,"language",void 0),h([f()],aa.prototype,"places",void 0),h([f()],aa.prototype,"serviceUrl",void 0),h([f()],aa.prototype,"worldview",void 0),aa=h([I("esri.support.BasemapStyle")],aa);const kK=aa;function te(e,t,i={}){return bC(e,t,i,a6)}function Yr(e,t,i={}){return bC(e,t,i,l6)}function bC(e,t,i={},r){let s=null;const n=i.once?(o,a)=>{r(o)&&(St(s),t(o,a))}:(o,a)=>{r(o)&&t(o,a)};if(s=BW(e,n,i.sync,i.equals),i.initial){const o=e();n(o,o)}return s}function In(e,t,i,r={}){let s=null,n=null,o=null;function a(){s&&n&&(n.remove(),r.onListenerRemove?.(s),s=null,n=null)}function l(c){r.once&&r.once&&St(o),i(c)}const u=te(e,((c,d)=>{a(),Lb(c)&&(s=c,n=lf(c,t,l),r.onListenerAdd?.(c))}),{sync:r.sync,initial:!0});return o=ze((()=>{u.remove(),a()})),o}function Vg(e,t){return RK(e,l6,t)}function RK(e,t,i){if(js(i))return Promise.reject(yt());const r=e();if(t?.(r))return Promise.resolve(r);let s=null;function n(){s=St(s)}return new Promise(((o,a)=>{s=gh([kn(i,(()=>{n(),a(yt())})),bC(e,(l=>{n(),o(l)}),{sync:!1,once:!0},t??a6)])}))}function a6(e){return!0}function l6(e){return!!e}function qTe(e,t,i={}){let r=!1;const s=te(e,((n,o)=>{r||t(n,o)}),i);return{remove(){s.remove()},pause(){r=!0},resume(){r=!1}}}const yu={sync:!0},Pt={initial:!0},br={sync:!0,initial:!0},S0=new WeakMap;function u6(e){return!e.destroyed&&(S0.has(e)||e.addHandles([te((()=>{const t=e.parent;return!(!t||!("type"in t))&&(t.type==="catalog-dynamic-group"||u6(t))}),(t=>S0.set(e,t)),br),ze((()=>S0.delete(e)))]),S0.get(e))}function OK(e){return e!=null&&typeof e=="object"&&"type"in e&&e.type==="feature"}function HTe(e){return e!=null&&typeof e=="object"&&"type"in e&&e.type==="graphics"}function NK(e){return e!=null&&typeof e=="object"&&"type"in e&&e.type==="map-image"}function DK(e){return e!=null&&typeof e=="object"&&"type"in e&&e.type==="knowledge-graph"&&"layers"in e}function WTe(e){return e!=null&&typeof e=="object"&&"type"in e&&e.type==="knowledge-graph-sublayer"}function uA(e){return e!=null&&typeof e=="object"&&"type"in e&&e.type==="subtype-group"&&"sublayers"in e}function id(e){return e?.type==="subtype-sublayer"}const ZTe={Point:"SceneLayer","3DObject":"SceneLayer",IntegratedMesh:"IntegratedMeshLayer",PointCloud:"PointCloudLayer",Building:"BuildingSceneLayer"};function cA(e){const t=e?.type;return t==="building-scene"||t==="integrated-mesh"||t==="point-cloud"||t==="scene"}function YTe(e){return e==="integrated-mesh"||e==="integrated-mesh-3dtiles"}function Zb(e){return e?.type==="feature"&&!e.url&&e.source?.type==="memory"}function JTe(e){const t=e?.type;return(t==="feature"||t==="subtype-group"||t==="oriented-imagery")&&e?.source?.type==="feature-layer"}async function XTe(e,t){const i=ot?.findServerInfo(e);if(i?.currentVersion!=null)return i.owningSystemUrl||null;const r=e.toLowerCase().indexOf("/rest/services");if(r===-1)return null;const s=`${e.slice(0,r)}/rest/info`,n=t!=null?t.signal:null,{data:o}=await at(s,{query:{f:"json"},responseType:"json",signal:n});return o?.owningSystemUrl||null}function FK(e){if(!("capabilities"in e))return!1;switch(e.type){case"catalog":case"catalog-footprint":case"csv":case"feature":case"geojson":case"imagery":case"knowledge-graph-sublayer":case"ogc-feature":case"oriented-imagery":case"scene":case"sublayer":case"subtype-group":case"subtype-sublayer":case"wfs":return!0;default:return!1}}function zK(e){return FK(e)?"effectiveCapabilities"in e?e.effectiveCapabilities:e.capabilities:null}function VK(e){if(!("editingEnabled"in e))return!1;switch(e.type){case"csv":case"feature":case"geojson":case"oriented-imagery":case"scene":case"subtype-group":case"subtype-sublayer":return!0;default:return!1}}function UK(e){return!!VK(e)&&("effectiveEditingEnabled"in e?e.effectiveEditingEnabled:e.editingEnabled)}function jK(e,t){return null}function KTe(e){return null}function GK(e){return!e||e.type==="Feature Service"&&!e.sourceUrl}function QTe(e,t){!t||!GK(e)||jK(e.url)}const BK=new Set(["bing-maps","imagery","imagery-tile","map-image","open-street-map","tile","unknown","unsupported","vector-tile","web-tile","wcs","wms","wmts"]),c6=new Set(["catalog","csv","feature","geo-rss","geojson","group","imagery","imagery-tile","kml","knowledge-graph","map-image","map-notes","media","ogc-feature","oriented-imagery","route","stream","subtype-group","tile","unknown","unsupported","vector-tile","video","web-tile","wcs","wfs","wms","wmts"]),qK=new Set([...c6,"link-chart"]);function HK(e){switch(e.layerContainerType){case"basemap":return BK;case"operational-layers":return e.origin==="link-chart"?qK:c6;default:return null}}function WK(e,t){if(t.restrictedWebMapWriting){const i=HK(t);return i==null||i.has(e.type)&&!Zb(e)}return!0}function ZK(e,t){if(t)if(Zb(e)){const i=xg("featureCollection.layers",t),r=i?.[0]?.layerDefinition;r&&hA(e,r)}else e.type!=="group"&&hA(e,t)}function hA(e,t){"maxScale"in e&&(t.maxScale=rv(e.maxScale)??void 0),"minScale"in e&&(t.minScale=rv(e.minScale)??void 0)}function YK(e,t){if(ZK(e,t),t&&(t.id=e.id,"blendMode"in e&&(t.blendMode=e.blendMode,t.blendMode==="normal"&&delete t.blendMode),t.opacity=rv(e.opacity)??void 0,t.title=e.title||"Layer",t.visibility=e.visible,"legendEnabled"in e&&e.type!=="wmts"))if(Zb(e)){const i=t.featureCollection;i&&(i.showLegend=e.legendEnabled)}else t.showLegend=e.legendEnabled}function dA(e,t,i){if(!e.persistenceEnabled)return null;if(!("write"in e)||!e.write)return i?.messages&&i.messages.push(new j("layer:unsupported",`Layers (${e.title}, ${e.id}) of type '${e.declaredClass}' cannot be persisted`,{layer:e})),null;if(Zb(e)&&!e.isTable)t=e.resourceInfo;else if(WK(e,i)){const r={};return e.write(r,i)?r:null}return t!=null&&YK(e,t=V(t)),t}var ym;let JK=0,Kr=ym=class extends ee.JSONSupportMixin(Ns){constructor(e){super(e),this.id=null,this.portalItem=null,this.spatialReference=null,this.style=null,this.thumbnailUrl=null,this.title="Basemap",this.id=Date.now().toString(16)+"-basemap-"+JK++,this.baseLayers=new ne,this.referenceLayers=new ne;const t=r=>{r.parent&&r.parent!==this&&"remove"in r.parent&&r.parent.remove(r),r.parent=this,r.type==="elevation"&&H.getLogger(this).error(`Layer '${r.title}, id:${r.id}' of type '${r.type}' is not supported as a basemap layer and will therefore be ignored.`)},i=r=>{r.parent=null};this.addHandles([this.baseLayers.on("after-add",(r=>t(r.item))),this.referenceLayers.on("after-add",(r=>t(r.item))),this.baseLayers.on("after-remove",(r=>i(r.item))),this.referenceLayers.on("after-remove",(r=>i(r.item)))])}initialize(){this.when().catch((e=>{H.getLogger(this).error("#load()",`Failed to load basemap (title: '${this.title}', id: '${this.id}')`,e)})),this.resourceInfo&&this.read(this.resourceInfo.data,this.resourceInfo.context)}destroy(){const e=this.baseLayers.toArray();for(const i of e)i.destroy();const t=this.referenceLayers.toArray();for(const i of t)i.destroy();this.baseLayers.destroy(),this.referenceLayers.destroy(),this.portalItem=Ot(this.portalItem)}normalizeCtorArgs(e){return e&&"resourceInfo"in e&&(this._set("resourceInfo",e.resourceInfo),delete(e={...e}).resourceInfo),e}set baseLayers(e){this._set("baseLayers",Ha(e,this._get("baseLayers")))}_writeBaseLayers(e,t,i){const r=[];e&&(i={...i,layerContainerType:"basemap"},this.baseLayers.forEach((s=>{const n=dA(s,i.webmap?i.webmap.getLayerJSONFromResourceInfo(s):null,i);n!=null&&r.push(n)})),this.referenceLayers.forEach((s=>{const n=dA(s,i.webmap?i.webmap.getLayerJSONFromResourceInfo(s):null,i);n!=null&&(s.type!=="scene"&&(n.isReference=!0),r.push(n))}))),t.baseMapLayers=r}set referenceLayers(e){this._set("referenceLayers",Ha(e,this._get("referenceLayers")))}writeTitle(e,t){t.title=e||"Basemap"}load(e){return this.addResolvingPromise(this._loadFromSource(e)),Promise.resolve(this)}loadAll(){return w4(this,(e=>{e(this.baseLayers,this.referenceLayers)}))}clone(){const e={id:this.id,title:this.title,portalItem:this.portalItem,baseLayers:this.baseLayers.map((t=>z1(t)?t.clone():t)),referenceLayers:this.referenceLayers.map((t=>z1(t)?t.clone():t))};return this.loaded&&(e.loadStatus="loaded"),new ym({resourceInfo:this.resourceInfo}).set(e)}read(e,t){this.resourceInfo||this._set("resourceInfo",{data:e,context:t}),super.read(e,t)}write(e,t){return e=e||{},t?.origin||(t={origin:"web-map",...t}),super.write(e,t),!this.loaded&&this.resourceInfo?.data.baseMapLayers&&(e.baseMapLayers=this.resourceInfo.data.baseMapLayers.map((i=>{const r=V(i);return r.url&&Vo(r.url)&&(r.url=`https:${r.url}`),r.templateUrl&&Vo(r.templateUrl)&&(r.templateUrl=`https:${r.templateUrl}`),r}))),e}async _loadFromSource(e){const{resourceInfo:t,portalItem:i,style:r}=this;It(e);const s=[];if(t){const n=t.context?t.context.url:null;if(s.push(this._loadLayersFromJSON(t.data,n,e)),t.data.id&&!t.data.title){const o=t.data.id;s.push(aJ(o).then((a=>{a&&this.read({title:a},t.context)})))}}else i?s.push(this._loadFromItem(i,e)):r&&s.push(this._loadFromStylesService(r,e));await Promise.all(s)}async _loadLayersFromJSON(e,t,i){const r=this.resourceInfo?.context,s=this.portalItem?.portal||r?.portal||null,n=KK[r?.origin||""]??"web-map",{populateOperationalLayers:o}=await J(async()=>{const{populateOperationalLayers:l}=await import("./layersCreator-DrsNzVZE.js");return{populateOperationalLayers:l}},__vite__mapDeps([11,12,13,14,15,16,9,17])),a=[];if(It(i),e.baseMapLayers&&Array.isArray(e.baseMapLayers)){const l={context:{...r,origin:n,url:t,portal:s,layerContainerType:"basemap"},defaultLayerType:"DefaultTileLayer"},u=m=>n==="web-scene"&&m.layerType==="ArcGISSceneServiceLayer"||m.isReference,c=o(this.baseLayers,e.baseMapLayers.filter((m=>!u(m))),l);a.push(c);const d=o(this.referenceLayers,e.baseMapLayers.filter(u),l);a.push(d)}await Promise.allSettled(a)}async _loadFromItem(e,t){const i=await e.load(t),r=await i.fetchData("json",t),s=Li(e.itemUrl??"");return this._set("resourceInfo",{data:r.baseMap??{},context:{origin:XK[e.type||""]??"web-map",portal:e.portal||Z.getDefault(),url:s}}),this.read(this.resourceInfo.data,this.resourceInfo.context),this.read({spatialReference:r.spatialReference},this.resourceInfo.context),this.read({title:e.title,thumbnailUrl:e.thumbnailUrl},{origin:"portal-item",portal:e.portal||Z.getDefault(),url:s}),this._loadLayersFromJSON(this.resourceInfo.data,s,t)}async _loadFromStylesService(e,t){const i=e.serviceUrl.endsWith("/webmaps")?e.serviceUrl.slice(0,-8):e.serviceUrl,r=`${i}/styles/${e.id}/self`,s=`${i}/webmaps/${e.id}`,n=e.apiKey??Fe.apiKeys.basemapStyles,[o,a]=await Promise.all([(await at(r,{query:{token:n},signal:t?.signal})).data,(await at(s,{query:{language:e.languageParameter,places:e.places,worldview:e.worldview,token:n},signal:t?.signal})).data]);this.thumbnailUrl??=o.thumbnailUrl;const l=Li(s);if(this._set("resourceInfo",{data:a.baseMap??{},context:{origin:"web-map",url:l}}),this.read(this.resourceInfo.data,this.resourceInfo.context),this.read({spatialReference:a.spatialReference},this.resourceInfo.context),await this._loadLayersFromJSON(this.resourceInfo.data,l,t),n)for(const u of[...this.baseLayers,...this.referenceLayers])"apiKey"in u&&(u.apiKey=n)}static fromId(e){const t=Vp[e];return t?t.itemId?new ym({portalItem:{id:t.itemId,portal:{url:"https://www.arcgis.com"}}}):ym.fromJSON(t,t.is3d?{origin:"web-scene",portal:new Z({url:"https://www.arcgis.com"})}:{origin:"web-map"}):null}};h([f({json:{write:{ignoreOrigin:!0,target:"baseMapLayers",writer(e,t,i,r){this._writeBaseLayers(e,t,r)}},origins:{"web-scene":{write:{ignoreOrigin:!0,target:{baseMapLayers:{type:ne}},writer(e,t,i,r){this._writeBaseLayers(e,t,r)}}}}}})],Kr.prototype,"baseLayers",null),h([f({type:String,json:{origins:{"web-scene":{write:!0}}}})],Kr.prototype,"id",void 0),h([f({type:xe})],Kr.prototype,"portalItem",void 0),h([f()],Kr.prototype,"referenceLayers",null),h([f({readOnly:!0})],Kr.prototype,"resourceInfo",void 0),h([f({type:ae})],Kr.prototype,"spatialReference",void 0),h([f({type:kK})],Kr.prototype,"style",void 0),h([f()],Kr.prototype,"thumbnailUrl",void 0),h([f({type:String,json:{origins:{"web-scene":{write:{isRequired:!0}}}}})],Kr.prototype,"title",void 0),h([$e("title")],Kr.prototype,"writeTitle",null),Kr=ym=h([I("esri.Basemap")],Kr);const XK={"Web Scene":"web-scene","Web Map":"web-map","Link Chart":"link-chart"},KK={"web-scene":"web-scene","web-map":"web-map","link-chart":"link-chart"},py=Kr,QK=Object.freeze(Object.defineProperty({__proto__:null,default:py},Symbol.toStringTag,{value:"Module"})),yv={transparent:[0,0,0,0],black:[0,0,0,1],silver:[192,192,192,1],gray:[128,128,128,1],white:[255,255,255,1],maroon:[128,0,0,1],red:[255,0,0,1],purple:[128,0,128,1],fuchsia:[255,0,255,1],green:[0,128,0,1],lime:[0,255,0,1],olive:[128,128,0,1],yellow:[255,255,0,1],navy:[0,0,128,1],blue:[0,0,255,1],teal:[0,128,128,1],aqua:[0,255,255,1],aliceblue:[240,248,255,1],antiquewhite:[250,235,215,1],aquamarine:[127,255,212,1],azure:[240,255,255,1],beige:[245,245,220,1],bisque:[255,228,196,1],blanchedalmond:[255,235,205,1],blueviolet:[138,43,226,1],brown:[165,42,42,1],burlywood:[222,184,135,1],cadetblue:[95,158,160,1],chartreuse:[127,255,0,1],chocolate:[210,105,30,1],coral:[255,127,80,1],cornflowerblue:[100,149,237,1],cornsilk:[255,248,220,1],crimson:[220,20,60,1],cyan:[0,255,255,1],darkblue:[0,0,139,1],darkcyan:[0,139,139,1],darkgoldenrod:[184,134,11,1],darkgray:[169,169,169,1],darkgreen:[0,100,0,1],darkgrey:[169,169,169,1],darkkhaki:[189,183,107,1],darkmagenta:[139,0,139,1],darkolivegreen:[85,107,47,1],darkorange:[255,140,0,1],darkorchid:[153,50,204,1],darkred:[139,0,0,1],darksalmon:[233,150,122,1],darkseagreen:[143,188,143,1],darkslateblue:[72,61,139,1],darkslategray:[47,79,79,1],darkslategrey:[47,79,79,1],darkturquoise:[0,206,209,1],darkviolet:[148,0,211,1],deeppink:[255,20,147,1],deepskyblue:[0,191,255,1],dimgray:[105,105,105,1],dimgrey:[105,105,105,1],dodgerblue:[30,144,255,1],firebrick:[178,34,34,1],floralwhite:[255,250,240,1],forestgreen:[34,139,34,1],gainsboro:[220,220,220,1],ghostwhite:[248,248,255,1],gold:[255,215,0,1],goldenrod:[218,165,32,1],greenyellow:[173,255,47,1],grey:[128,128,128,1],honeydew:[240,255,240,1],hotpink:[255,105,180,1],indianred:[205,92,92,1],indigo:[75,0,130,1],ivory:[255,255,240,1],khaki:[240,230,140,1],lavender:[230,230,250,1],lavenderblush:[255,240,245,1],lawngreen:[124,252,0,1],lemonchiffon:[255,250,205,1],lightblue:[173,216,230,1],lightcoral:[240,128,128,1],lightcyan:[224,255,255,1],lightgoldenrodyellow:[250,250,210,1],lightgray:[211,211,211,1],lightgreen:[144,238,144,1],lightgrey:[211,211,211,1],lightpink:[255,182,193,1],lightsalmon:[255,160,122,1],lightseagreen:[32,178,170,1],lightskyblue:[135,206,250,1],lightslategray:[119,136,153,1],lightslategrey:[119,136,153,1],lightsteelblue:[176,196,222,1],lightyellow:[255,255,224,1],limegreen:[50,205,50,1],linen:[250,240,230,1],magenta:[255,0,255,1],mediumaquamarine:[102,205,170,1],mediumblue:[0,0,205,1],mediumorchid:[186,85,211,1],mediumpurple:[147,112,219,1],mediumseagreen:[60,179,113,1],mediumslateblue:[123,104,238,1],mediumspringgreen:[0,250,154,1],mediumturquoise:[72,209,204,1],mediumvioletred:[199,21,133,1],midnightblue:[25,25,112,1],mintcream:[245,255,250,1],mistyrose:[255,228,225,1],moccasin:[255,228,181,1],navajowhite:[255,222,173,1],oldlace:[253,245,230,1],olivedrab:[107,142,35,1],orange:[255,165,0,1],orangered:[255,69,0,1],orchid:[218,112,214,1],palegoldenrod:[238,232,170,1],palegreen:[152,251,152,1],paleturquoise:[175,238,238,1],palevioletred:[219,112,147,1],papayawhip:[255,239,213,1],peachpuff:[255,218,185,1],peru:[205,133,63,1],pink:[255,192,203,1],plum:[221,160,221,1],powderblue:[176,224,230,1],rebeccapurple:[102,51,153,1],rosybrown:[188,143,143,1],royalblue:[65,105,225,1],saddlebrown:[139,69,19,1],salmon:[250,128,114,1],sandybrown:[244,164,96,1],seagreen:[46,139,87,1],seashell:[255,245,238,1],sienna:[160,82,45,1],skyblue:[135,206,235,1],slateblue:[106,90,205,1],slategray:[112,128,144,1],slategrey:[112,128,144,1],snow:[255,250,250,1],springgreen:[0,255,127,1],steelblue:[70,130,180,1],tan:[210,180,140,1],thistle:[216,191,216,1],tomato:[255,99,71,1],turquoise:[64,224,208,1],violet:[238,130,238,1],wheat:[245,222,179,1],whitesmoke:[245,245,245,1],yellowgreen:[154,205,50,1]};function h6(e){return!!yv[e]||!!yv[e.toLowerCase()]}function wC(e){return yv[e]??yv[e.toLowerCase()]}function eQ(e){return[...wC(e)]}function p2(e,t,i){i<0&&++i,i>1&&--i;const r=6*i;return r<1?e+(t-e)*r:2*i<1?t:3*i<2?e+(t-e)*(2/3-i)*6:e}function d6(e,t,i,r=1){const s=(e%360+360)%360/360,n=i<=.5?i*(t+1):i+t-i*t,o=2*i-n;return[Math.round(255*p2(o,n,s+1/3)),Math.round(255*p2(o,n,s)),Math.round(255*p2(o,n,s-1/3)),r]}function tQ(e){const t=e.length>5,i=t?8:4,r=(1<<i)-1,s=t?1:17,n=t?e.length===9:e.length===5;let o=+("0x"+e.slice(1));if(isNaN(o))return null;const a=[0,0,0,1];let l;return n&&(l=o&r,o>>=i,a[3]=s*l/255),l=o&r,o>>=i,a[2]=s*l,l=o&r,o>>=i,a[1]=s*l,l=o&r,o>>=i,a[0]=s*l,a}function p6(e){if(e[0]!=="#"||isNaN(+`0x${e.slice(1)}`))return null;switch(e.length){case 4:case 5:{const t=parseInt(e.slice(1,2),16),i=parseInt(e.slice(2,3),16),r=parseInt(e.slice(3,4),16),s=e.length===4?15:parseInt(e.slice(4),16);return[t+16*t,i+16*i,r+16*r,(s+16*s)/255]}case 7:case 9:return[parseInt(e.slice(1,3),16),parseInt(e.slice(3,5),16),parseInt(e.slice(5,7),16),(e.length===7?255:parseInt(e.slice(7),16))/255];default:return null}}function f6(e){const t=e.toLowerCase().match(/^(rgba?|hsla?)\(([\s.\-,%0-9]+)\)/);if(t){const i=t[2].split(/\s*,\s*/),r=t[1];if(r==="rgb"&&i.length===3||r==="rgba"&&i.length===4){const s=i[0];if(s.charAt(s.length-1)==="%"){const n=i.map((o=>2.56*parseFloat(o)));return i.length===4&&(n[3]=parseFloat(i[3])),pA(n)}return pA(i.map((n=>parseFloat(n))))}if(r==="hsl"&&i.length===3||r==="hsla"&&i.length===4)return d6(parseFloat(i[0]),parseFloat(i[1])/100,parseFloat(i[2])/100,parseFloat(i[3]??"1"))}return null}function pA(e){return e[0]=Kd(e[0]),e[1]=Kd(e[1]),e[2]=Kd(e[2]),e[3]=e.length===4?y6(e[3]):1,e}function m6(e){let t=h6(e)?wC(e):null;return t??=f6(e),t??=p6(e),t}function eEe(e){const t=m6(e);return t!=null?[t[0]/255,t[1]/255,t[2]/255,t[3]]:null}function y6(e){return g6(e,0,1)}function Kd(e){return Math.round(g6(e,0,255))}function g6(e,t,i){return e=Number(e),isNaN(e)?i:e<t?t:e>i?i:e}const tEe=2.2,fA=new Float32Array(1);function iEe(e){--e;for(let t=1;t<32;t<<=1)e|=e>>t;return e+1}function lr(e,t,i){return Math.min(Math.max(e,t),i)}function iQ(e){return e--,e|=e>>1,e|=e>>2,e|=e>>4,e|=e>>8,e|=e>>16,++e}function gm(e,t,i){return e+(t-e)*i}function rEe(e,t,i,r,s){return gm(r,s,(e-t)/(i-t))}function mf(e){return e*Math.PI/180}function _6(e){return 180*e/Math.PI}function sEe(e,t=1e-6){return(e<0?-1:1)/Math.max(Math.abs(e),t)}function nEe(e){return Math.acos(lr(e,-1,1))}function rQ(e){return Math.asin(lr(e,-1,1))}function An(e,t,i=1e-6){return e===t?!0:!Number.isFinite(e)||!Number.isFinite(t)?!1:(e>t?e-t:t-e)<=i}function v6(e,t,i=1e-6){return!An(e,t,i)&&e>t}function Cx(e,t,i=1e-6){return!An(e,t,i)&&e<t}function sQ(e,t,i=1e-6){return An(e,t,i)||e>t}const gv=new DataView(new ArrayBuffer(Float64Array.BYTES_PER_ELEMENT));function Px(e){return gv.setFloat64(0,e),gv.getBigInt64(0)}function nQ(e){return gv.setBigInt64(0,e),gv.getFloat64(0)}const O_=BigInt("1000000"),oQ=b6(1);function b6(e){const t=Px(e=Math.abs(e)),i=nQ(t<=O_?O_:t-O_);return Math.abs(e-i)}function oEe(e,t,i=oQ){if(e===t)return!0;if(!Number.isFinite(e)||!Number.isFinite(t))return!1;if(i!=null&&b6(Math.min(Math.abs(e),Math.abs(t)))<i)return Math.abs(e-t)<=i;const r=Px(e),s=Px(t);return r<0!=s<0?!1:!((r<s?s-r:r-s)>O_)}function aEe(e,t,i=1e-6){if(e===t)return!0;if(!Number.isFinite(e)||!Number.isFinite(t))return!1;const r=Math.abs(e-t),s=Math.abs(e),n=Math.abs(t);if(e===0||t===0||s<1e-12&&n<1e-12){if(r>.01*i)return!1}else if(r/(s+n)>i)return!1;return!0}function lEe(e){return w6(Math.max(-mA,Math.min(e,mA)))}function w6(e){return fA[0]=e,fA[0]}function uEe(e){const t=e[0]*e[0]+e[1]*e[1]+e[2]*e[2],i=e[3]*e[3]+e[4]*e[4]+e[5]*e[5],r=e[6]*e[6]+e[7]*e[7]+e[8]*e[8];return!(An(t,1)&&An(i,1)&&An(r,1))}const mA=w6(34028234663852886e22);function cEe(e,t,i){if(i===void 0||+i==0)return Math[e](t);if(t=+t,i=+i,isNaN(t)||typeof i!="number"||i%1!=0)return NaN;let r=t.toString().split("e");return r=(t=Math[e](+(r[0]+"e"+(r[1]?+r[1]-i:-i)))).toString().split("e"),+(r[0]+"e"+(r[1]?+r[1]+i:i))}function x0(e){return lr(GE(e),0,255)}function $0(e,t){const i=e.toString(16).padStart(2,"0");return t?i.slice(0,1):i}let N_=class Ir{static blendColors(t,i,r,s=new Ir){return s.r=Math.round(t.r+(i.r-t.r)*r),s.g=Math.round(t.g+(i.g-t.g)*r),s.b=Math.round(t.b+(i.b-t.b)*r),s.a=t.a+(i.a-t.a)*r,s._sanitize()}static fromRgb(t,i){const r=f6(t);return r?Ir.fromArray(r,i):null}static fromHex(t,i=new Ir){const r=p6(t);return r?Ir.fromArray(r,i):null}static fromArray(t,i=new Ir){return i._set(Number(t[0]),Number(t[1]),Number(t[2]),Number(t[3])),isNaN(i.a)&&(i.a=1),i._sanitize()}static fromString(t,i){const r=m6(t);return r?Ir.fromArray(r,i):null}static fromJSON(t){return t!=null?new Ir([t[0],t[1],t[2],(t[3]??255)/255]):void 0}static toUnitRGB(t){return t!=null?[t.r/255,t.g/255,t.b/255]:null}static toUnitRGBA(t){return t!=null?[t.r/255,t.g/255,t.b/255,t.a!=null?t.a:1]:null}constructor(t){this.r=255,this.g=255,this.b=255,this.a=1,t&&this.setColor(t)}get isBright(){return .299*this.r+.587*this.g+.114*this.b>=127}setColor(t){return typeof t=="string"?Ir.fromString(t,this):Array.isArray(t)?Ir.fromArray(t,this):(this._set(t.r??0,t.g??0,t.b??0,t.a??1),t instanceof Ir||this._sanitize()),this}toRgb(){return[this.r,this.g,this.b]}toRgba(){return[this.r,this.g,this.b,this.a]}toHex(t){const i=t?.capitalize??!1,r=t?.digits??6,s=r===3||r===4,n=r===4||r===8,o=`#${$0(this.r,s)}${$0(this.g,s)}${$0(this.b,s)}${n?$0(Math.round(255*this.a),s):""}`;return i?o.toUpperCase():o}toCss(t=!1){const i=this.r+", "+this.g+", "+this.b;return t?`rgba(${i}, ${this.a})`:`rgb(${i})`}toString(){return this.toCss(!0)}toJSON(){return this.toArray()}toArray(t=Ir.AlphaMode.ALWAYS){const i=x0(this.r),r=x0(this.g),s=x0(this.b);return t===Ir.AlphaMode.ALWAYS||this.a!==1?[i,r,s,x0(255*this.a)]:[i,r,s]}clone(){return new Ir(this.toRgba())}hash(){return this.r<<24|this.g<<16|this.b<<8|255*this.a}equals(t){return t!=null&&t.r===this.r&&t.g===this.g&&t.b===this.b&&t.a===this.a}_sanitize(){return this.r=Kd(this.r),this.g=Kd(this.g),this.b=Kd(this.b),this.a=y6(this.a),this}_set(t,i,r,s){this.r=t,this.g=i,this.b=r,this.a=s}};N_.prototype.declaredClass="esri.Color",(function(e){var t;(t=e.AlphaMode||(e.AlphaMode={}))[t.ALWAYS=0]="ALWAYS",t[t.UNLESS_OPAQUE=1]="UNLESS_OPAQUE"})(N_||(N_={}));const X=N_;function me(e,t={}){const i=e instanceof Ye?e:new Ye(e,t),{alwaysWriteDefaults:r,default:s,ignoreUnknown:n=!0,name:o,nonNullable:a,readOnly:l=!1}=t;return f({type:n?i.apiValues:String,json:{type:i.jsonValues,default:s,name:o,read:!l&&{reader:i.read},write:{writer:i.write,alwaysWriteDefaults:r}},nonNullable:a,readOnly:l})}var Ix;let D_=Ix=class extends ee{constructor(e){super(e),this.type="none"}clone(){return new Ix({type:this.type})}};h([me({none:"none",stayAbove:"stay-above"}),f({json:{write:{isRequired:!0}}})],D_.prototype,"type",void 0),D_=Ix=h([I("esri.ground.NavigationConstraint")],D_);const aQ=Symbol("GroundInstance");function SC(e){const t=GE(100*(1-e));return Math.max(0,Math.min(t,100))}function xC(e){const t=1-e/100;return Math.max(0,Math.min(t,1))}var yA,Ax,AN;let la=Ax=(AN=class extends ee.JSONSupportMixin(Ns){constructor(e){super(e),this[yA]=!0,this.opacity=1,this.surfaceColor=null,this.navigationConstraint=null,this.layers=new ne;const t=r=>{r.parent&&r.parent!==this&&"remove"in r.parent&&r.parent.remove(r),r.parent=this,r.type!=="elevation"&&r.type!=="base-elevation"&&H.getLogger(this).error(`Layer '${r.title}, id:${r.id}' of type '${r.type}' is not supported as a ground layer and will therefore be ignored. Only layers of type 'elevation' are supported.`)},i=r=>{r.parent=null};this.addHandles([this.layers.on("after-add",(r=>t(r.item))),this.layers.on("after-remove",(r=>i(r.item)))])}initialize(){this.when().catch((e=>{Er(e)||H.getLogger(this).error("#load()","Failed to load ground",e)})),this.resourceInfo&&this.read(this.resourceInfo.data,this.resourceInfo.context)}destroy(){const e=this.layers.removeAll();for(const t of e)Ot(t);this.layers.destroy()}normalizeCtorArgs(e){return e&&"resourceInfo"in e&&(this._set("resourceInfo",e.resourceInfo),delete(e={...e}).resourceInfo),e}get layers(){return this._get("layers")}set layers(e){this._set("layers",Ha(e,this._get("layers")))}writeLayers(e,t,i,r){const s=[];e&&(r={...r,layerContainerType:"ground"},e.forEach((n=>{if("write"in n){const o={};fq(n)().write(o,r)&&s.push(o)}else r?.messages&&r.messages.push(new j("layer:unsupported",`Layers (${n.title}, ${n.id}) of type '${n.declaredClass}' cannot be persisted in the ground`,{layer:n}))}))),t.layers=s}load(e){return this.addResolvingPromise(this._loadFromSource(e)),Promise.resolve(this)}loadAll(){return w4(this,(e=>{e(this.layers)}))}async queryElevation(e,t){await this.load({signal:t?.signal});const{ElevationQuery:i}=await J(()=>import("./ElevationQuery-DVIvP83A.js"),[]);It(t);const r=new i,s=this.layers.filter(gA).toArray();return r.queryAll(s,e,t)}async createElevationSampler(e,t){await this.load({signal:t?.signal});const{ElevationQuery:i}=await J(()=>import("./ElevationQuery-DVIvP83A.js"),[]);It(t);const r=new i,s=this.layers.filter(gA).toArray();return r.createSamplerAll(s,e,t)}clone(){const e={opacity:this.opacity,surfaceColor:V(this.surfaceColor),navigationConstraint:V(this.navigationConstraint),layers:this.layers.slice()};return this.loaded&&(e.loadStatus="loaded"),new Ax({resourceInfo:this.resourceInfo}).set(e)}read(e,t){this.resourceInfo||this._set("resourceInfo",{data:e,context:t}),super.read(e,t)}_loadFromSource(e){const t=this.resourceInfo;return t?this._loadLayersFromJSON(t.data,t.context,e):Promise.resolve()}async _loadLayersFromJSON(e,t,i){const r=t?.origin||"web-scene",s=t?.portal||null,n=t?.url||null,{populateOperationalLayers:o}=await J(async()=>{const{populateOperationalLayers:l}=await import("./layersCreator-DrsNzVZE.js");return{populateOperationalLayers:l}},__vite__mapDeps([11,12,13,14,15,16,9,17]));It(i);const a=[];if(e.layers&&Array.isArray(e.layers)){const l={context:{origin:r,url:n,portal:s,layerContainerType:"ground"},defaultLayerType:"ArcGISTiledElevationServiceLayer"};a.push(o(this.layers,e.layers,l))}await Promise.allSettled(a)}},yA=aQ,AN);function lQ(e){return e&&"createElevationSampler"in e}function gA(e){return e.type==="elevation"||lQ(e)}h([f({json:{read:!1,write:{isRequired:!0}}})],la.prototype,"layers",null),h([$e("layers")],la.prototype,"writeLayers",null),h([f({readOnly:!0})],la.prototype,"resourceInfo",void 0),h([f({type:Number,nonNullable:!0,range:{min:0,max:1},json:{type:Ue,read:{reader:xC,source:"transparency"},write:{writer:(e,t)=>{t.transparency=SC(e)},target:"transparency"}}})],la.prototype,"opacity",void 0),h([f({type:X,json:{type:[Ue],write:(e,t)=>{t.surfaceColor=e.toJSON().slice(0,3)}}})],la.prototype,"surfaceColor",void 0),h([f({type:D_,json:{write:!0}})],la.prototype,"navigationConstraint",void 0),la=Ax=h([I("esri.Ground")],la);const _v=la;let ro=class extends ne{constructor(t){super(t),this.getCollections=null}initialize(){this.addHandles(kW((()=>this._refresh()),yu))}destroy(){this.getCollections=null}_refresh(){const t=this.getCollections!=null?this.getCollections():null;if(t==null)return void this.removeAll();let i=0;for(const r of t)r!=null&&(i=this._processCollection(i,r));this.splice(i)}_createNewInstance(t){return new ne(t)}_processCollection(t,i){if(!i)return t;const r=this.itemFilterFunction??(s=>!!s);for(const s of i)if(s){if(r(s)){const n=this.indexOf(s,t);n>=0?n!==t&&this.reorder(s,t):this.add(s,t),++t}if(this.getChildrenFunction){const n=this.getChildrenFunction(s);if(Array.isArray(n))for(const o of n)t=this._processCollection(t,o);else t=this._processCollection(t,n)}}return t}};h([f()],ro.prototype,"getCollections",void 0),h([f()],ro.prototype,"getChildrenFunction",void 0),h([f()],ro.prototype,"itemFilterFunction",void 0),ro=h([I("esri.core.CollectionFlattener")],ro);const S6=e=>{let t=class extends e{clone(){const i=Ba(this);Tg(i,"unable to clone instance of non-accessor class");const r=i.metadata,s=i.store,n={},o=new Map;for(const l in r){const u=r[l],c=s?.originOf(l),d=u.clonable;if(u.readOnly||d===!1||c!==Ie.USER&&c!==Ie.DEFAULTS&&c!==Ie.WEB_MAP&&c!==Ie.WEB_SCENE)continue;const m=this[l];let y=null;y=typeof d=="function"?d(m):d==="reference"?m:PS(m),m!=null&&y==null||(c===Ie.DEFAULTS?o.set(l,y):n[l]=y)}const a=new(Object.getPrototypeOf(this)).constructor(n);if(o.size){const l=Ba(a)?.store;if(l)for(const[u,c]of o)l.set(u,c,Ie.DEFAULTS)}return a}};return t=h([I("esri.core.Clonable")],t),t};let _m=class extends S6(le){};_m=h([I("esri.core.Clonable")],_m),(function(e){e.ClonableMixin=S6})(_m||(_m={}));const xt=_m,uQ="randomUUID"in crypto;function Ug(){if(uQ)return crypto.randomUUID();const e=crypto.getRandomValues(new Uint16Array(8));e[3]=4095&e[3]|16384,e[4]=16383&e[4]|32768;const t=i=>e[i].toString(16).padStart(4,"0");return t(0)+t(1)+"-"+t(2)+"-"+t(3)+"-"+t(4)+"-"+t(5)+t(6)+t(7)}function pEe(){return`{${Ug().toUpperCase()}}`}function fEe(){return`{${Ug()}}`}function mEe(e){const t=e.toUpperCase();return e[0]!=="{"?`{${t}}`:t}const Nh={Base64:0,Hex:1,String:2,Raw:3},Qd=8,x6=(1<<Qd)-1;function Kl(e,t){const i=(65535&e)+(65535&t);return(e>>16)+(t>>16)+(i>>16)<<16|65535&i}function cQ(e){const t=[];for(let i=0,r=e.length*Qd;i<r;i+=Qd)t[i>>5]|=(e.charCodeAt(i/Qd)&x6)<<i%32;return t}function hQ(e){const t=[];for(let i=0,r=32*e.length;i<r;i+=Qd)t.push(String.fromCharCode(e[i>>5]>>>i%32&x6));return t.join("")}function dQ(e){const t="0123456789abcdef",i=[];for(let r=0,s=4*e.length;r<s;r++)i.push(t.charAt(e[r>>2]>>r%4*8+4&15)+t.charAt(e[r>>2]>>r%4*8&15));return i.join("")}function pQ(e){const i="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",r=[];for(let s=0,n=4*e.length;s<n;s+=3){const o=(e[s>>2]>>s%4*8&255)<<16|(e[s+1>>2]>>(s+1)%4*8&255)<<8|e[s+2>>2]>>(s+2)%4*8&255;for(let a=0;a<4;a++)8*s+6*a>32*e.length?r.push("="):r.push(i.charAt(o>>6*(3-a)&63))}return r.join("")}function fQ(e,t){return e<<t|e>>>32-t}function Yb(e,t,i,r,s,n){return Kl(fQ(Kl(Kl(t,e),Kl(r,n)),s),i)}function Gi(e,t,i,r,s,n,o){return Yb(t&i|~t&r,e,t,s,n,o)}function Bi(e,t,i,r,s,n,o){return Yb(t&r|i&~r,e,t,s,n,o)}function qi(e,t,i,r,s,n,o){return Yb(t^i^r,e,t,s,n,o)}function Hi(e,t,i,r,s,n,o){return Yb(i^(t|~r),e,t,s,n,o)}function mQ(e,t){e[t>>5]|=128<<t%32,e[14+(t+64>>>9<<4)]=t;let i=1732584193,r=-271733879,s=-1732584194,n=271733878;for(let o=0;o<e.length;o+=16){const a=i,l=r,u=s,c=n;i=Gi(i,r,s,n,e[o],7,-680876936),n=Gi(n,i,r,s,e[o+1],12,-389564586),s=Gi(s,n,i,r,e[o+2],17,606105819),r=Gi(r,s,n,i,e[o+3],22,-1044525330),i=Gi(i,r,s,n,e[o+4],7,-176418897),n=Gi(n,i,r,s,e[o+5],12,1200080426),s=Gi(s,n,i,r,e[o+6],17,-1473231341),r=Gi(r,s,n,i,e[o+7],22,-45705983),i=Gi(i,r,s,n,e[o+8],7,1770035416),n=Gi(n,i,r,s,e[o+9],12,-1958414417),s=Gi(s,n,i,r,e[o+10],17,-42063),r=Gi(r,s,n,i,e[o+11],22,-1990404162),i=Gi(i,r,s,n,e[o+12],7,1804603682),n=Gi(n,i,r,s,e[o+13],12,-40341101),s=Gi(s,n,i,r,e[o+14],17,-1502002290),r=Gi(r,s,n,i,e[o+15],22,1236535329),i=Bi(i,r,s,n,e[o+1],5,-165796510),n=Bi(n,i,r,s,e[o+6],9,-1069501632),s=Bi(s,n,i,r,e[o+11],14,643717713),r=Bi(r,s,n,i,e[o],20,-373897302),i=Bi(i,r,s,n,e[o+5],5,-701558691),n=Bi(n,i,r,s,e[o+10],9,38016083),s=Bi(s,n,i,r,e[o+15],14,-660478335),r=Bi(r,s,n,i,e[o+4],20,-405537848),i=Bi(i,r,s,n,e[o+9],5,568446438),n=Bi(n,i,r,s,e[o+14],9,-1019803690),s=Bi(s,n,i,r,e[o+3],14,-187363961),r=Bi(r,s,n,i,e[o+8],20,1163531501),i=Bi(i,r,s,n,e[o+13],5,-1444681467),n=Bi(n,i,r,s,e[o+2],9,-51403784),s=Bi(s,n,i,r,e[o+7],14,1735328473),r=Bi(r,s,n,i,e[o+12],20,-1926607734),i=qi(i,r,s,n,e[o+5],4,-378558),n=qi(n,i,r,s,e[o+8],11,-2022574463),s=qi(s,n,i,r,e[o+11],16,1839030562),r=qi(r,s,n,i,e[o+14],23,-35309556),i=qi(i,r,s,n,e[o+1],4,-1530992060),n=qi(n,i,r,s,e[o+4],11,1272893353),s=qi(s,n,i,r,e[o+7],16,-155497632),r=qi(r,s,n,i,e[o+10],23,-1094730640),i=qi(i,r,s,n,e[o+13],4,681279174),n=qi(n,i,r,s,e[o],11,-358537222),s=qi(s,n,i,r,e[o+3],16,-722521979),r=qi(r,s,n,i,e[o+6],23,76029189),i=qi(i,r,s,n,e[o+9],4,-640364487),n=qi(n,i,r,s,e[o+12],11,-421815835),s=qi(s,n,i,r,e[o+15],16,530742520),r=qi(r,s,n,i,e[o+2],23,-995338651),i=Hi(i,r,s,n,e[o],6,-198630844),n=Hi(n,i,r,s,e[o+7],10,1126891415),s=Hi(s,n,i,r,e[o+14],15,-1416354905),r=Hi(r,s,n,i,e[o+5],21,-57434055),i=Hi(i,r,s,n,e[o+12],6,1700485571),n=Hi(n,i,r,s,e[o+3],10,-1894986606),s=Hi(s,n,i,r,e[o+10],15,-1051523),r=Hi(r,s,n,i,e[o+1],21,-2054922799),i=Hi(i,r,s,n,e[o+8],6,1873313359),n=Hi(n,i,r,s,e[o+15],10,-30611744),s=Hi(s,n,i,r,e[o+6],15,-1560198380),r=Hi(r,s,n,i,e[o+13],21,1309151649),i=Hi(i,r,s,n,e[o+4],6,-145523070),n=Hi(n,i,r,s,e[o+11],10,-1120210379),s=Hi(s,n,i,r,e[o+2],15,718787259),r=Hi(r,s,n,i,e[o+9],21,-343485551),i=Kl(i,a),r=Kl(r,l),s=Kl(s,u),n=Kl(n,c)}return[i,r,s,n]}function yQ(e,t=Nh.Hex){const i=t||Nh.Base64,r=mQ(cQ(e),e.length*Qd);switch(i){case Nh.Raw:return r;case Nh.Hex:return dQ(r);case Nh.String:return hQ(r);case Nh.Base64:return pQ(r)}}function gQ(e){return e&&"getAtOrigin"in e&&"originOf"in e}function Lx(e){return $C[_Q(e)]||bQ}function _Q(e){return e.type==="json"?"application/json":e.type==="blob"?e.blob.type:vQ(e.url)}function vQ(e){const t=aD(e);return kx[t]||$6}const $C={},$6="text/plain",bQ=$C[$6],kx={png:"image/png",jpeg:"image/jpeg",jpg:"image/jpg",bmp:"image/bmp",gif:"image/gif",json:"application/json",txt:"text/plain",xml:"application/xml",svg:"image/svg+xml",zip:"application/zip",pbf:"application/vnd.mapbox-vector-tile",gz:"application/gzip","bin.gz":"application/octet-stream"};for(const e in kx)$C[kx[e]]=e;function wQ(e){const t=e?.origins??[void 0];return(i,r)=>{const s=SQ(e,i,r);for(const n of t){const o=qE(i,n,r);for(const a in s)o[a]=s[a]}}}function SQ(e,t,i){if(e?.type==="resource")return xQ(e,t,i);switch(e?.type??"other"){case"other":return{read:!0,write:!0};case"url":{const{read:r,write:s}=_H;return{read:r,write:s}}}}function xQ(e,t,i){const r=Ag(t,i);return{type:String,read:(s,n,o)=>{const a=kb(s,n,o);return r.type===String?a:typeof r.type=="function"?new r.type({url:a}):void 0},write:{isRequired:r.json?.write?.isRequired,writer(s,n,o,a){if(!a?.resources)return typeof s=="string"?void(n[o]=rh(s,a)):void(n[o]=s.write({},a));const l=TQ(s),u=rh(l,{...a,verifyItemRelativeUrls:a?.verifyItemRelativeUrls?{writtenUrls:a.verifyItemRelativeUrls.writtenUrls,rootPath:void 0}:void 0},Rp.NO),c=r.type!==String&&(!gQ(this)||a?.origin&&this.originIdOf(i)>FE(a.origin)),d={object:this,propertyName:i,value:s,targetUrl:u,dest:n,targetPropertyName:o,context:a,params:e};a?.portalItem&&u&&!qr(u)?c&&e?.contentAddressed?Rx(d):c?$Q(d):MQ(d):a?.portalItem&&(u==null||gD(u)!=null||Mg(u)||c)?Rx(d):n[o]=u}}}}function Rx(e){const{targetUrl:t,params:i,value:r,context:s,dest:n,targetPropertyName:o}=e;if(!s.portalItem)return;const a=_D(t),l=T6(r,t,s);if(i?.contentAddressed&&l.type!=="json")return void s.messages?.push(new j("persistable:contentAddressingUnsupported",`Property "${o}" is trying to serializing a resource with content of type ${l.type} with content addressing. Content addressing is only supported for json resources.`,{content:l}));const u=i?.contentAddressed&&l.type==="json"?yQ(l.jsonString):a?.filename??Ug(),c=$g(i?.prefix??a?.prefix,u),d=`${c}.${Lx(l)}`;if(i?.contentAddressed&&s.resources&&l.type==="json"){const g=s.resources.toKeep.find((({resource:_})=>_.path===d))??s.resources.toAdd.find((({resource:_})=>_.path===d));if(g)return void(n[o]=g.resource.itemRelativeUrl)}const m=s.portalItem.resourceFromPath(d);Mg(t)&&s.resources&&s.resources.pendingOperations.push(Hq(t).then((g=>{m.path=`${c}.${Lx({type:"blob",blob:g})}`,n[o]=m.itemRelativeUrl})).catch((()=>{})));const y=i?.compress??!1;s.resources&&M6({...e,resource:m,content:l,compress:y,updates:s.resources.toAdd}),n[o]=m.itemRelativeUrl}function $Q(e){const{context:t,targetUrl:i,params:r,value:s,dest:n,targetPropertyName:o}=e;if(!t.portalItem)return;const a=t.portalItem.resourceFromPath(i),l=T6(s,i,t),u=Lx(l),c=aD(a.path),d=r?.compress??!1;u===c?(t.resources&&M6({...e,resource:a,content:l,compress:d,updates:t.resources.toUpdate}),n[o]=i):Rx(e)}function MQ({context:e,targetUrl:t,dest:i,targetPropertyName:r}){e.portalItem&&e.resources&&(e.resources.toKeep.push({resource:e.portalItem.resourceFromPath(t),compress:!1}),i[r]=t)}function M6({object:e,propertyName:t,updates:i,resource:r,content:s,compress:n}){const o=a=>{EQ(e,t,a)};i.push({resource:r,content:s,compress:n,finish:o})}function T6(e,t,i){return typeof e=="string"?{type:"url",url:t}:{type:"json",jsonString:JSON.stringify(e.toJSON(i))}}function TQ(e){return e==null?null:typeof e=="string"?e:e.url}function EQ(e,t,i){typeof e[t]=="string"?e[t]=i.url:e[t].url=i.url}let F_=class extends xt.ClonableMixin(ee){constructor(t){super(t),this.color=null}};h([f({type:X,json:{type:[Ue],write:!0}})],F_.prototype,"color",void 0),F_=h([I("esri.effects.FocusAreaOutline")],F_);const CQ=F_;function Jb(e){const t=[];for(e.reset();e.nextPath();){const i=[];for(;e.nextPoint();)i.push([e.x,e.y]);t.push(i)}return e.reset(),t}function nu(e){const t=[];for(;e.nextPoint();)t.push([e.x,e.y]);return e.seekPathStart(),t}var vv;(function(e){e[e.X=0]="X",e[e.Y=1]="Y",e[e.Z=2]="Z"})(vv||(vv={}));function gEe(e){if(!e)return null;if(Array.isArray(e))return e;const t=e.hasZ,i=e.hasM;if(e.type==="point")return i&&t?[e.x,e.y,e.z,e.m]:t?[e.x,e.y,e.z]:i?[e.x,e.y,e.m]:[e.x,e.y];if(e.type==="polygon")return e.rings.slice();if(e.type==="polyline")return e.paths.slice();if(e.type==="multipoint")return e.points.slice();if(e.type==="extent"){const r=e.clone().normalize();if(!r)return null;let s=!1,n=!1;return r.forEach((o=>{o.hasZ&&(s=!0),o.hasM&&(n=!0)})),r.map((o=>{const a=[[o.xmin,o.ymin],[o.xmin,o.ymax],[o.xmax,o.ymax],[o.xmax,o.ymin],[o.xmin,o.ymin]];if(s&&o.hasZ){const l=.5*(o.zmax-o.zmin);for(let u=0;u<a.length;u++)a[u].push(l)}if(n&&o.hasM){const l=.5*(o.mmax-o.mmin);for(let u=0;u<a.length;u++)a[u].push(l)}return a}))}return null}function Xb(e,t){const i=t[0]-e[0],r=t[1]-e[1];if(e.length>2&&t.length>2){const s=e[2]-t[2];return Math.sqrt(i*i+r*r+s*s)}return Math.sqrt(i*i+r*r)}function E6(e,t,i){const r=e[0]+i*(t[0]-e[0]),s=e[1]+i*(t[1]-e[1]);return e.length>2&&t.length>2?[r,s,e[2]+i*(t[2]-e[2])]:[r,s]}function PQ(e,t,i,r){return C6(e,t,i[r],i[r+1])}function C6(e,t,i,r){const[s,n]=t,[o,a]=i,[l,u]=r,c=l-o,d=u-a,m=c*c+d*d,y=(s-o)*c+(n-a)*d,g=Math.min(1,Math.max(0,y/m));return e[0]=o+c*g,e[1]=a+d*g,e}function IQ(e,t,i,r,s,n){let o=i,a=r,l=s-o,u=n-a;if(l!==0||u!==0){const c=((e-o)*l+(t-a)*u)/(l*l+u*u);c>1?(o=s,a=n):c>0&&(o+=l*c,a+=u*c)}return l=e-o,u=t-a,l*l+u*u}function P6(e,t){return E6(e,t,.5)}function AQ(e){const t=e.length;let i=0;for(let r=0;r<t-1;++r)i+=Xb(e[r],e[r+1]);return i}function _Ee(e,t){if(t<=0)return e[0];const i=e.length;let r=0;for(let s=0;s<i-1;++s){const n=Xb(e[s],e[s+1]);if(t-r<n){const o=(t-r)/n;return E6(e[s],e[s+1],o)}r+=n}return e[i-1]}function I6(e,t=vv.X,i=vv.Y){let r=0;const s=e.length;let n=e[0];for(let o=1;o<s;o++){const a=e[o];r+=(a[t]-n[t])*(a[i]+n[i]),n=a}if(A6(e)){const o=e[0];r+=(o[t]-n[t])*(o[i]+n[i])}return r>=0}function A6(e){const t=e.length;return t>0&&!Cb(e[0],e[t-1])}function LQ(e){"rings"in e&&(kQ(e),RQ(e))}function kQ(e){if("rings"in e)for(const t of e.rings)A6(t)&&t.push(t[0].slice())}function RQ(e){if(!("rings"in e)||e.rings.length===0||I6(e.rings[0]))return!1;for(const t of e.rings)t.reverse();return!0}function vEe(e){return e.type!=="polygon"&&e.type!=="polyline"||OQ(e.type==="polygon"?e.rings:e.paths,e.spatialReference),e}function OQ(e,t){const i=ar(t);if(!i)return;const r=i.valid[0],s=i.valid[1],n=s-r;for(const o of e){let a=1/0,l=-1/0;for(const c of o){const d=NQ(c[0],r,s);a=Math.min(a,d),l=Math.max(l,d),c[0]=d}const u=l-a;n-u<u&&o.forEach((c=>{c[0]<0&&(c[0]+=n)}))}}function NQ(e,t,i){const r=i-t;return e<t?i-(t-e)%r:e>i?t+(e-t)%r:e}function bEe(e,t){if(e===t)return!0;if(e.type!==t.type)return!1;if(e.type==="point"||e.type==="mesh"||e.type==="extent")return!0;if(e.type==="multipoint")return e.points.length===t.points.length;const[i,r]=e.type==="polyline"?[e.paths,t.paths]:[e.rings,t.rings];return i.length===r.length&&i.every(((s,n)=>s.length===r[n].length))}function wEe(e){return e?e.hasZ?[e.xmax-e.xmin/2,e.ymax-e.ymin/2,e.zmax-e.zmin/2]:[e.xmax-e.xmin/2,e.ymax-e.ymin/2]:null}function L6(e){return e?DQ(e.rings,e.hasZ??!1):null}function DQ(e,t){if(!e?.length)return null;const i=[],r=[],s=t?[1/0,-1/0,1/0,-1/0,1/0,-1/0]:[1/0,-1/0,1/0,-1/0];for(let n=0,o=e.length;n<o;n++){const a=k6(e[n],t,s);a&&r.push(a)}if(r.sort(((n,o)=>{let a=n[2]-o[2];return a===0&&t&&(a=n[4]-o[4]),a})),r.length&&(i[0]=r[0][0],i[1]=r[0][1],t&&(i[2]=r[0][3]),(i[0]<s[0]||i[0]>s[1]||i[1]<s[2]||i[1]>s[3]||t&&(i[2]<s[4]||i[2]>s[5]))&&(i.length=0)),!i.length){const n=e[0]&&e[0].length?zQ(e[0],t):null;if(!n)return null;i[0]=n[0],i[1]=n[1],t&&n.length>2&&(i[2]=n[2])}return i}function k6(e,t,i){let r=0,s=0,n=0,o=0,a=0;const l=e.length?e[0][0]:0,u=e.length?e[0][1]:0,c=e.length&&t?e[0][2]:0;for(let m=0;m<e.length;m++){const y=e[m],g=e[(m+1)%e.length],[_,v,b]=y,S=_-l,$=v-u,[E,C,P]=g,k=E-l,F=C-u,D=S*F-k*$;if(o+=D,r+=(S+k)*D,s+=($+F)*D,t&&y.length>2&&g.length>2){const U=b-c,W=P-c,Y=S*W-k*U;n+=(U+W)*Y,a+=Y}_<i[0]&&(i[0]=_),_>i[1]&&(i[1]=_),v<i[2]&&(i[2]=v),v>i[3]&&(i[3]=v),t&&(b<i[4]&&(i[4]=b),b>i[5]&&(i[5]=b))}if(o>0&&(o*=-1),a>0&&(a*=-1),!o)return null;o*=.5,a*=.5;const d=[r/(6*o)+l,s/(6*o)+u,o];return t&&(i[4]===i[5]||a===0?(d[3]=(i[4]+i[5])/2,d[4]=0):(d[3]=n/(6*a)+c,d[4]=a)),d}function FQ(e,t){let i=0,r=0,s=0;e.nextPoint();const n=e.pathSize?e.x:0,o=e.pathSize?e.y:0;for(let a=0;a<e.pathSize;a++){e.seekInPath(a);const l=[e.x,e.y];e.seekInPath((a+1)%e.pathSize);const u=[e.x,e.y],[c,d]=l,m=c-n,y=d-o,[g,_]=u,v=g-n,b=_-o,S=m*b-v*y;s+=S,i+=(m+v)*S,r+=(y+b)*S,c<t[0]&&(t[0]=c),c>t[1]&&(t[1]=c),d<t[2]&&(t[2]=d),d>t[3]&&(t[3]=d)}return s>0&&(s*=-1),s?(s*=.5,[i/(6*s)+n,r/(6*s)+o,s]):null}function zQ(e,t){const i=t?[0,0,0]:[0,0],r=t?[0,0,0]:[0,0];let s=0,n=0,o=0,a=0;for(let l=0,u=e.length;l<u-1;l++){const c=e[l],d=e[l+1];if(c&&d){i[0]=c[0],i[1]=c[1],r[0]=d[0],r[1]=d[1],t&&c.length>2&&d.length>2&&(i[2]=c[2],r[2]=d[2]);const m=Xb(i,r);if(m){s+=m;const y=P6(c,d);n+=m*y[0],o+=m*y[1],t&&y.length>2&&(a+=m*y[2])}}}return s>0?t?[n/s,o/s,a/s]:[n/s,o/s]:e.length?e[0]:null}function R6(e){const{hasZ:t,totalSize:i}=e;if(i===0)return null;const r=[],s=[],n=t?[Number.POSITIVE_INFINITY,Number.NEGATIVE_INFINITY,Number.POSITIVE_INFINITY,Number.NEGATIVE_INFINITY,Number.POSITIVE_INFINITY,Number.NEGATIVE_INFINITY]:[Number.POSITIVE_INFINITY,Number.NEGATIVE_INFINITY,Number.POSITIVE_INFINITY,Number.NEGATIVE_INFINITY];for(e.reset();e.nextPath();){const o=k6(nu(e),e.hasZ,n);o&&s.push(o)}if(s.sort(((o,a)=>{let l=o[2]-a[2];return l===0&&t&&(l=o[4]-a[4]),l})),s.length&&(r[0]=s[0][0],r[1]=s[0][1],t&&(r[2]=s[0][3]),(r[0]<n[0]||r[0]>n[1]||r[1]<n[2]||r[1]>n[3]||t&&(r[2]<n[4]||r[2]>n[5]))&&(r.length=0)),!r.length){e.reset(),e.nextPath();const o=e.pathSize?VQ(e):null;if(!o)return null;r[0]=o[0],r[1]=o[1],t&&o.length>2&&(r[2]=o[2])}return r}function VQ(e){const{hasZ:t}=e,i=t?[0,0,0]:[0,0],r=t?[0,0,0]:[0,0];let s=0,n=0,o=0,a=0;if(e.nextPoint()){let l=e.x,u=e.y,c=e.z;for(;e.nextPoint();){const d=e.x,m=e.y,y=e.z;i[0]=l,i[1]=u,r[0]=d,r[1]=m,t&&(i[2]=c,r[2]=y);const g=Xb(i,r);if(g){s+=g;const _=P6(i,r);n+=g*_[0],o+=g*_[1],t&&_.length>2&&(a+=g*_[2])}l=d,u=m,c=y}}return s>0?t?[n/s,o/s,a/s]:[n/s,o/s]:e.pathSize?(e.seekPathStart(),e.nextPoint(),[e.x,e.y]):null}const UQ=1e-6;function jQ(e){let t=0;for(e.reset();e.nextPath();)t+=e.getCurrentRingArea();if(t<UQ){const s=R6(e);return s?[s[0],s[1]]:null}const i=[0,0];if(e.reset(),!e.nextPath()||!e.nextPoint())return null;const r=[e.x,e.y];for(e.reset();e.nextPath();)BQ(i,r,e);return i[0]*=1/t,i[1]*=1/t,i[0]+=r[0],i[1]+=r[1],i}const GQ=1/3;function BQ(e,t,i){if(!e||!i||i.pathSize<3)return null;i.nextPoint();const r=i.x,s=i.y;i.nextPoint();let n,o=i.x-r,a=i.y-s,l=0,u=0;for(;i.nextPoint();)l=i.x-r,u=i.y-s,n=.5*GQ*(l*a-u*o),e[0]+=n*(o+l),e[1]+=n*(a+u),o=l,a=u;const c=i.getCurrentRingArea(),d=[r,s];return d[0]-=t[0],d[1]-=t[1],d[0]*=c,d[1]*=c,e[0]+=d[0],e[1]+=d[1],e}function Qt(e=XQ){return[e[0],e[1],e[2],e[3]]}function O6(e,t){return e!==t&&(e[0]=t[0],e[1]=t[1],e[2]=t[2],e[3]=t[3]),e}function qQ(e,t,i,r,s=Qt()){return s[0]=e,s[1]=t,s[2]=i,s[3]=r,s}function SEe(e,t=Qt()){return t[0]=e.xmin,t[1]=e.ymin,t[2]=e.xmax,t[3]=e.ymax,t}function HQ(e,t,i=new ke){return i.xmin=e[0],i.ymin=e[1],i.xmax=e[2],i.ymax=e[3],i.spatialReference=t,i}function vm(e,t){t[0]<e[0]&&(e[0]=t[0]),t[0]>e[2]&&(e[2]=t[0]),t[1]<e[1]&&(e[1]=t[1]),t[1]>e[3]&&(e[3]=t[1])}function xEe(e,t,i){if(t!=null)if("length"in t)Ox(t)?(i[0]=Math.min(e[0],t[0]),i[1]=Math.min(e[1],t[1]),i[2]=Math.max(e[2],t[2]),i[3]=Math.max(e[3],t[3])):t.length!==2&&t.length!==3||(i[0]=Math.min(e[0],t[0]),i[1]=Math.min(e[1],t[1]),i[2]=Math.max(e[2],t[0]),i[3]=Math.max(e[3],t[1]));else switch(t.type){case"extent":i[0]=Math.min(e[0],t.xmin),i[1]=Math.min(e[1],t.ymin),i[2]=Math.max(e[2],t.xmax),i[3]=Math.max(e[3],t.ymax);break;case"point":i[0]=Math.min(e[0],t.x),i[1]=Math.min(e[1],t.y),i[2]=Math.max(e[2],t.x),i[3]=Math.max(e[3],t.y)}else O6(i,e)}function $Ee(e,t,i=e){const r=t.length;let s=e[0],n=e[1],o=e[2],a=e[3];for(let l=0;l<r;l++){const u=t[l];s=Math.min(s,u[0]),n=Math.min(n,u[1]),o=Math.max(o,u[0]),a=Math.max(a,u[1])}return i[0]=s,i[1]=n,i[2]=o,i[3]=a,i}function MEe(e){for(let t=0;t<4;t++)if(!isFinite(e[t]))return!1;return!0}function Kb(e){return e==null||e[0]>=e[2]?0:e[2]-e[0]}function Qb(e){return e==null||e[1]>=e[3]?0:e[3]-e[1]}function TEe(e){return Kb(e)*Qb(e)}function _A(e,t=[0,0]){return t[0]=(e[0]+e[2])/2,t[1]=(e[1]+e[3])/2,t}function WQ(e){const t=Kb(e),i=Qb(e);return Math.sqrt(t*t+i*i)}function EEe(e,t){return ZQ(e,t.x,t.y)}function ZQ(e,t,i){return t>=e[0]&&i>=e[1]&&t<=e[2]&&i<=e[3]}function CEe(e,t){return Math.max(t[0],e[0])<=Math.min(t[2],e[2])&&Math.max(t[1],e[1])<=Math.min(t[3],e[3])}function PEe(e,t,i){return Math.max(t[0],e[0])-i<=Math.min(t[2],e[2])&&Math.max(t[1],e[1])-i<=Math.min(t[3],e[3])}function YQ(e,t){return t[0]>=e[0]&&t[2]<=e[2]&&t[1]>=e[1]&&t[3]<=e[3]}function IEe(e,t,i,r=e){return r[0]=e[0]+t,r[1]=e[1]+i,r[2]=e[2]+t,r[3]=e[3]+i,r}function JQ(e){return e?O6(e,vA):Qt(vA)}function Ox(e){return e!=null&&e.length===4}function AEe(e,t){return Ox(e)&&Ox(t)?e[0]===t[0]&&e[1]===t[1]&&e[2]===t[2]&&e[3]===t[3]:e===t}const vA=[1/0,1/0,-1/0,-1/0],XQ=[0,0,0,0];function N6(e){return e.xmin!==void 0&&e.ymin!==void 0&&e.xmax!==void 0&&e.ymax!==void 0}function D6(e){return e.points!==void 0}function F6(e){return e.x!==void 0&&e.y!==void 0}function z6(e){return e.paths!==void 0}function V6(e){return e.rings!==void 0}function U6(e){function t(i,r){return i==null?r:r==null?i:e(i,r)}return t}const Ql=U6(Math.min),eu=U6(Math.max);function MC(e,t){return z6(t)?jp(e,t.paths,!1,!1):V6(t)?jp(e,t.rings,!1,!1):D6(t)?TC(e,t.points,!1,!1,!1,!1):N6(t)?G6(e,t):(F6(t)&&(e[0]=t.x,e[1]=t.y,e[2]=t.x,e[3]=t.y),e)}function jg(e){let t,i,r,s;for(e.reset(),t=r=1/0,i=s=-1/0;e.nextPath();){const n=j6(e);t=Math.min(n[0],t),r=Math.min(n[1],r),i=Math.max(n[2],i),s=Math.max(n[3],s)}return Qt([t,r,i,s])}function j6(e){let t,i,r,s;for(t=r=1/0,i=s=-1/0;e.nextPoint();)t=Math.min(e.x,t),r=Math.min(e.y,r),i=Math.max(e.x,i),s=Math.max(e.y,s);return Qt([t,r,i,s])}function LEe(e,t){return z6(t)?jp(e,t.paths,!0,!1):V6(t)?jp(e,t.rings,!0,!1):D6(t)?TC(e,t.points,!0,!1,!0,!1):N6(t)?G6(e,t,!0,!1,!0,!1):(F6(t)&&(e[0]=t.x,e[1]=t.y,e[2]=t.z,e[3]=t.x,e[4]=t.y,e[5]=t.z),e)}function jp(e,t,i,r){const s=i?3:2;if(!t.length||!t[0].length)return null;let n,o,a,l,[u,c]=t[0][0],[d,m]=t[0][0];for(let y=0;y<t.length;y++){const g=t[y];for(let _=0;_<g.length;_++){const v=g[_],[b,S]=v;if(u=Ql(u,b),c=Ql(c,S),d=eu(d,b),m=eu(m,S),i&&v.length>2){const $=v[2];n=Ql(n,$),o=eu(o,$)}if(r&&v.length>s){const $=v[s];a=Ql(n,$),l=eu(o,$)}}}return i?r?(e[0]=u,e[1]=c,e[2]=n,e[3]=a,e[4]=d,e[5]=m,e[6]=o,e[7]=l,e.length=8,e):(e[0]=u,e[1]=c,e[2]=n,e[3]=d,e[4]=m,e[5]=o,e.length=6,e):r?(e[0]=u,e[1]=c,e[2]=a,e[3]=d,e[4]=m,e[5]=l,e.length=6,e):(e[0]=u,e[1]=c,e[2]=d,e[3]=m,e.length=4,e)}function G6(e,t,i,r,s,n){const o=t.xmin,a=t.xmax,l=t.ymin,u=t.ymax;let c=t.zmin,d=t.zmax,m=t.mmin,y=t.mmax;return s?(c=c||0,d=d||0,n?(m=m||0,y=y||0,e[0]=o,e[1]=l,e[2]=c,e[3]=m,e[4]=a,e[5]=u,e[6]=d,e[7]=y,e):(e[0]=o,e[1]=l,e[2]=c,e[3]=a,e[4]=u,e[5]=d,e)):n?(m=m||0,y=y||0,e[0]=o,e[1]=l,e[2]=m,e[3]=a,e[4]=u,e[5]=y,e):(e[0]=o,e[1]=l,e[2]=a,e[3]=u,e)}function TC(e,t,i,r,s,n){const o=i?3:2,a=r&&n,l=i&&s;if(!t.length||!t[0].length)return null;let u,c,d,m,[y,g]=t[0],[_,v]=t[0];for(let b=0;b<t.length;b++){const S=t[b],[$,E]=S;if(y=Ql(y,$),g=Ql(g,E),_=eu(_,$),v=eu(v,E),l&&S.length>2){const C=S[2];u=Ql(u,C),c=eu(c,C)}if(a&&S.length>o){const C=S[o];d=Ql(u,C),m=eu(c,C)}}return s?(u=u||0,c=c||0,n?(d=d||0,m=m||0,e[0]=y,e[1]=g,e[2]=u,e[3]=d,e[4]=_,e[5]=v,e[6]=c,e[7]=m,e):(e[0]=y,e[1]=g,e[2]=u,e[3]=_,e[4]=v,e[5]=c,e)):n?(d=d||0,m=m||0,e[0]=y,e[1]=g,e[2]=d,e[3]=_,e[4]=v,e[5]=m,e):(e[0]=y,e[1]=g,e[2]=_,e[3]=v,e)}function KQ(e){return e.xmin!==void 0&&e.ymin!==void 0&&e.xmax!==void 0&&e.ymax!==void 0}function QQ(e){return e.points!==void 0}function eee(e){return e.x!==void 0&&e.y!==void 0}function tee(e){return e.paths!==void 0}function iee(e){return e.rings!==void 0}const EC=[];function B6(e,t,i,r){return{xmin:e,ymin:t,xmax:i,ymax:r}}function q6(e,t,i,r,s,n){return{xmin:e,ymin:t,zmin:i,xmax:r,ymax:s,zmax:n}}function H6(e,t,i,r,s,n){return{xmin:e,ymin:t,mmin:i,xmax:r,ymax:s,mmax:n}}function W6(e,t,i,r,s,n,o,a){return{xmin:e,ymin:t,zmin:i,mmin:r,xmax:s,ymax:n,zmax:o,mmax:a}}function CC(e,t=!1,i=!1){return t?i?W6(e[0],e[1],e[2],e[3],e[4],e[5],e[6],e[7]):q6(e[0],e[1],e[2],e[3],e[4],e[5]):i?H6(e[0],e[1],e[2],e[3],e[4],e[5]):B6(e[0],e[1],e[2],e[3])}function kEe(e){return e?KQ(e)?e:eee(e)?see(e):iee(e)?Z6(e):tee(e)?Y6(e):QQ(e)?ree(e):null:null}function ree(e){const{hasZ:t,hasM:i,points:r}=e;return CC(TC(EC,r,t??!1,i??!1),t,i)}function see(e){const{x:t,y:i,z:r,m:s}=e,n=s!=null;return r!=null?n?W6(t,i,r,s,t,i,r,s):q6(t,i,r,t,i,r):n?H6(t,i,s,t,i,s):B6(t,i,t,i)}function Z6(e){const{hasZ:t,hasM:i,rings:r}=e,s=jp(EC,r,t??!1,i??!1);return s?CC(s,t,i):null}function Y6(e){const{hasZ:t,hasM:i,paths:r}=e,s=jp(EC,r,t??!1,i??!1);return s?CC(s,t,i):null}function Gp(e,t,i=!1){let{hasM:r,hasZ:s}=e;Array.isArray(t)?t.length!==4||r||s?t.length===3&&i&&!r?(s=!0,r=!1):t.length===3&&r&&s&&(r=!1,s=!1):(r=!0,s=!0):(s=!s&&t.hasZ&&(!r||t.hasM),r=!r&&t.hasM&&(!s||t.hasZ)),e.hasZ=s,e.hasM=r}var z_;function bA(e){return!Array.isArray(e[0])}function nee(e){return typeof e[0]?.[0]=="number"}function oee(e){if(!e)return;let{rings:t,hasM:i,hasZ:r,spatialReference:s}=e;switch(t??=[],nee(t)&&(t=[t]),t[0]?.[0]?.length){case 4:r??=!0,i??=!0;break;case 3:r??=i!==!0,i??=!r;break;default:r??=!1,i??=!1}return s??=ae.WGS84,{...e,hasM:i,hasZ:r,rings:t,spatialReference:s}}let mt=z_=class extends Ci{static fromExtent(e){const t=e.clone().normalize(),{spatialReference:i}=e;let r=!1,s=!1;for(const o of t)o.hasZ&&(r=!0),o.hasM&&(s=!0);const n={rings:t.map((o=>{const a=[[o.xmin,o.ymin],[o.xmin,o.ymax],[o.xmax,o.ymax],[o.xmax,o.ymin],[o.xmin,o.ymin]];if(r&&o.hasZ){const l=o.zmin+.5*(o.zmax-o.zmin);for(let u=0;u<a.length;u++)a[u].push(l)}if(s&&o.hasM){const l=o.mmin+.5*(o.mmax-o.mmin);for(let u=0;u<a.length;u++)a[u].push(l)}return a})),spatialReference:i};return r&&(n.hasZ=!0),s&&(n.hasM=!0),new z_(n)}constructor(e){super(oee(e)),this.curveRings=void 0,this.rings=[],this.type="polygon"}get cache(){return this.commitProperty("curveRings"),this.commitProperty("hasM"),this.commitProperty("hasZ"),this.commitProperty("rings"),this.commitProperty("spatialReference"),{}}get centroid(){const e=L6(this);if(!e||isNaN(e[0])||isNaN(e[1])||this.hasZ&&isNaN(e[2]))return null;const t=new he;return t.x=e[0],t.y=e[1],t.spatialReference=this.spatialReference,this.hasZ&&(t.z=e[2]),t}writeCurveRings(e,t){t.curveRings=V(e)}get extent(){const e=Z6(this),{spatialReference:t}=this;return e?new ke({...e,spatialReference:t}):null}get isSelfIntersecting(){return ID(H.getLogger(this),"isSelfIntersecting",{replacement:"Please use simplifyOperator.isSimple() instead.",version:"4.33",warnOnce:!0}),WY(this.rings)}writeRings(e,t){t.rings=V(this.rings)}addRing(e){if(!e)return;const t=this.rings,i=t.length;if(bA(e)){const r=[];for(let s=0,n=e.length;s<n;s++)r[s]=e[s].toArray();t[i]=r}else t[i]=e.slice();return this.notifyChange("rings"),this}clone(){const e=new z_;return e.spatialReference=this.spatialReference,e.rings=V(this.rings),e.curveRings=V(this.curveRings),e.hasZ=this.hasZ,e.hasM=this.hasM,e}equals(e){if(this===e)return!0;if(e==null)return!1;const t=this.spatialReference,i=e.spatialReference;if(t!=null!=(i!=null)||t!=null&&i!=null&&!t.equals(i)||this.rings.length!==e.rings.length)return!1;const r=([s,n,o,a],[l,u,c,d])=>s===l&&n===u&&(o==null&&c==null||o===c)&&(a==null&&d==null||a===d);for(let s=0;s<this.rings.length;s++){const n=this.rings[s],o=e.rings[s];if(!Cb(n,o,r))return!1}return!0}contains(e){if(!e)return!1;const t=Vb(e,this.spatialReference);return sC(this,t??e)}isClockwise(e){const t=bA(e)?e.map((i=>this.hasZ?this.hasM?[i.x,i.y,i.z,i.m]:[i.x,i.y,i.z]:[i.x,i.y])):e;return I6(t)}getPoint(e,t){if(!this._validateInputs(e,t))return null;const i=this.rings[e][t],r=this.hasZ,s=this.hasM;return r&&!s?new he(i[0],i[1],i[2],void 0,this.spatialReference):s&&!r?new he(i[0],i[1],void 0,i[2],this.spatialReference):r&&s?new he(i[0],i[1],i[2],i[3],this.spatialReference):new he(i[0],i[1],this.spatialReference)}insertPoint(e,t,i){return this._validateInputs(e,t,!0)?(Gp(this,i),Array.isArray(i)||(i=i.toArray()),this.rings[e].splice(t,0,i),this.notifyChange("rings"),this):this}removePoint(e,t){if(!this._validateInputs(e,t))return null;const i=new he(this.rings[e].splice(t,1)[0],this.spatialReference);return this.notifyChange("rings"),i}removeRing(e){if(!this._validateInputs(e,null))return null;const t=this.rings.splice(e,1)[0],i=this.spatialReference,r=t.map((s=>new he(s,i)));return this.notifyChange("rings"),r}setPoint(e,t,i){return this._validateInputs(e,t)?(Gp(this,i),Array.isArray(i)||(i=i.toArray()),this.rings[e][t]=i,this.notifyChange("rings"),this):this}_validateInputs(e,t,i=!1){if(e==null||e<0||e>=this.rings.length)return!1;if(t!=null){const r=this.rings[e];if(i&&(t<0||t>r.length)||!i&&(t<0||t>=r.length))return!1}return!0}toJSON(e){return this.write({},e)}};h([f({readOnly:!0})],mt.prototype,"cache",null),h([f({readOnly:!0})],mt.prototype,"centroid",null),h([f({json:{write:!0,origins:{"portal-item":{write:!1},"web-map":{write:!1},"web-scene":{write:!1}}}})],mt.prototype,"curveRings",void 0),h([$e("curveRings")],mt.prototype,"writeCurveRings",null),h([f({readOnly:!0})],mt.prototype,"extent",null),h([f({readOnly:!0})],mt.prototype,"isSelfIntersecting",null),h([f({type:[[[Number]]],json:{write:{isRequired:!0}}})],mt.prototype,"rings",void 0),h([$e("rings")],mt.prototype,"writeRings",null),mt=z_=h([I("esri.geometry.Polygon")],mt),mt.prototype.toJSON.isDefaultToJSON=!0;function Su(){return[0,0,0]}function aee(e){return[e[0],e[1],e[2]]}function yf(e,t,i){return[e,t,i]}function lee(e,t,i){return[e,t,i]}function uee(e,t=Su()){const i=Math.min(3,e.length);for(let r=0;r<i;++r)t[r]=e[r];return t}function J6(){return Su()}function X6(){return yf(1,1,1)}function K6(){return yf(1,0,0)}function Q6(){return yf(0,1,0)}function ez(){return yf(0,0,1)}const cee=J6(),tz=X6(),hee=K6(),dee=Q6(),pee=ez();Object.freeze(Object.defineProperty({__proto__:null,ONES:tz,UNIT_X:hee,UNIT_Y:dee,UNIT_Z:pee,ZEROS:cee,clone:aee,create:Su,freeze:lee,fromArray:uee,fromValues:yf,ones:X6,unitX:K6,unitY:Q6,unitZ:ez,zeros:J6},Symbol.toStringTag,{value:"Module"}));var Nx;function wA(e){return(t,i)=>t==null?i:i==null?t:e(t,i)}function fee(e){return e&&(e.declaredClass==="esri.geometry.SpatialReference"||e.wkid!=null)}let gn=Nx=class extends Ci{constructor(...e){super(...e),this.points=[],this.type="multipoint"}normalizeCtorArgs(e,t){if(!e&&!t)return{};const i={};Array.isArray(e)?(i.points=e,i.spatialReference=t):fee(e)?i.spatialReference=e:(e.points&&(i.points=e.points),e.spatialReference&&(i.spatialReference=e.spatialReference),e.hasZ&&(i.hasZ=e.hasZ),e.hasM&&(i.hasM=e.hasM));const r=i.points?.[0];return r&&(i.hasZ===void 0&&i.hasM===void 0?(i.hasZ=r.length>2,i.hasM=!1):i.hasZ===void 0?i.hasZ=r.length>3:i.hasM===void 0&&(i.hasM=r.length>3)),i}get cache(){return this.commitProperty("points"),this.commitProperty("hasZ"),this.commitProperty("hasM"),this.commitProperty("spatialReference"),{}}get extent(){const e=this.points;if(!e.length)return null;const t=new ke,i=this.hasZ,r=this.hasM,s=i?3:2,n=e[0],o=wA(Math.min),a=wA(Math.max);let l,u,c,d,[m,y]=n,[g,_]=n;for(let v=0,b=e.length;v<b;v++){const S=e[v],[$,E]=S;if(m=o(m,$),y=o(y,E),g=a(g,$),_=a(_,E),i&&S.length>2){const C=S[2];l=o(l,C),c=a(c,C)}if(r&&S.length>s){const C=S[s];u=o(u,C),d=a(d,C)}}return t.xmin=m,t.ymin=y,t.xmax=g,t.ymax=_,t.spatialReference=this.spatialReference,i?(t.zmin=l,t.zmax=c):(t.zmin=void 0,t.zmax=void 0),r?(t.mmin=u,t.mmax=d):(t.mmin=void 0,t.mmax=void 0),t}writePoints(e,t){t.points=V(this.points)}addPoint(e){return Gp(this,e),Array.isArray(e)?this.points.push(e):this.points.push(e.toArray()),this.notifyChange("points"),this}clone(){const e={points:V(this.points),spatialReference:this.spatialReference};return this.hasZ&&(e.hasZ=!0),this.hasM&&(e.hasM=!0),new Nx(e)}getPoint(e){if(!this._validateInputs(e))return null;const t=this.points[e],i={x:t[0],y:t[1],spatialReference:this.spatialReference};let r=2;return this.hasZ&&(i.z=t[2],r=3),this.hasM&&(i.m=t[r]),new he(i)}removePoint(e){if(!this._validateInputs(e))return null;const t=new he(this.points.splice(e,1)[0],this.spatialReference);return this.notifyChange("points"),t}setPoint(e,t){return this._validateInputs(e)?(Gp(this,t),Array.isArray(t)||(t=t.toArray()),this.points[e]=t,this.notifyChange("points"),this):this}toJSON(e){return this.write({},e)}_validateInputs(e){return e!=null&&e>=0&&e<this.points.length}};h([f({readOnly:!0})],gn.prototype,"cache",null),h([f()],gn.prototype,"extent",null),h([f({type:[[Number]],json:{write:{isRequired:!0}}})],gn.prototype,"points",void 0),h([$e("points")],gn.prototype,"writePoints",null),gn=Nx=h([I("esri.geometry.Multipoint")],gn),gn.prototype.toJSON.isDefaultToJSON=!0;var Dx;function mee(e){return!Array.isArray(e[0])}function yee(e){return typeof e[0]?.[0]=="number"}function gee(e){if(!e)return;let{paths:t,hasM:i,hasZ:r,spatialReference:s}=e;switch(t??=[],yee(t)&&(t=[t]),t[0]?.[0]?.length){case 4:r??=!0,i??=!0;break;case 3:r??=i!==!0,i??=!r;break;default:r??=!1,i??=!1}return s??=ae.WGS84,{...e,hasM:i,hasZ:r,paths:t,spatialReference:s}}let Yt=Dx=class extends Ci{constructor(e){super(gee(e)),this.curvePaths=void 0,this.paths=[],this.type="polyline"}get cache(){return this.commitProperty("curvePaths"),this.commitProperty("hasM"),this.commitProperty("hasZ"),this.commitProperty("paths"),this.commitProperty("spatialReference"),{}}writeCurvePaths(e,t){t.curvePaths=V(e)}get extent(){const e=Y6(this),{spatialReference:t}=this;return e?new ke({...e,spatialReference:t}):null}writePaths(e,t){t.paths=V(this.paths)}addPath(e){if(!e)return;const t=this.paths,i=t.length;if(mee(e)){const r=[];for(let s=0,n=e.length;s<n;s++)r[s]=e[s].toArray();t[i]=r}else t[i]=e.slice();return this.notifyChange("paths"),this}clone(){const e=new Dx;return e.spatialReference=this.spatialReference,e.paths=V(this.paths),e.curvePaths=V(this.curvePaths),e.hasZ=this.hasZ,e.hasM=this.hasM,e}getPoint(e,t){if(!this._validateInputs(e,t))return null;const i=this.paths[e][t],r=this.hasZ,s=this.hasM;return r&&!s?new he(i[0],i[1],i[2],void 0,this.spatialReference):s&&!r?new he(i[0],i[1],void 0,i[2],this.spatialReference):r&&s?new he(i[0],i[1],i[2],i[3],this.spatialReference):new he(i[0],i[1],this.spatialReference)}insertPoint(e,t,i){return this._validateInputs(e,t,!0)?(Gp(this,i),Array.isArray(i)||(i=i.toArray()),this.paths[e].splice(t,0,i),this.notifyChange("paths"),this):this}removePath(e){if(!this._validateInputs(e,null))return null;const t=this.paths.splice(e,1)[0],i=this.spatialReference,r=t.map((s=>new he(s,i)));return this.notifyChange("paths"),r}removePoint(e,t){if(!this._validateInputs(e,t))return null;const i=new he(this.paths[e].splice(t,1)[0],this.spatialReference);return this.notifyChange("paths"),i}setPoint(e,t,i){return this._validateInputs(e,t)?(Gp(this,i),Array.isArray(i)||(i=i.toArray()),this.paths[e][t]=i,this.notifyChange("paths"),this):this}_validateInputs(e,t,i=!1){if(e==null||e<0||e>=this.paths.length)return!1;if(t!=null){const r=this.paths[e];if(i&&(t<0||t>r.length)||!i&&(t<0||t>=r.length))return!1}return!0}toJSON(e){return this.write({},e)}};h([f({readOnly:!0})],Yt.prototype,"cache",null),h([f({json:{write:!0,origins:{"portal-item":{write:!1},"web-map":{write:!1},"web-scene":{write:!1}}}})],Yt.prototype,"curvePaths",void 0),h([$e("curvePaths")],Yt.prototype,"writeCurvePaths",null),h([f({readOnly:!0})],Yt.prototype,"extent",null),h([f({type:[[[Number]]],json:{write:{isRequired:!0}}})],Yt.prototype,"paths",void 0),h([$e("paths")],Yt.prototype,"writePaths",null),Yt=Dx=h([I("esri.geometry.Polyline")],Yt),Yt.prototype.toJSON.isDefaultToJSON=!0;const Vr=Math.PI/180,_ee=/(?:SPHEROID|ELLIPSOID)\[([^\]]+)]/i,cl=Ft.radius,rn=Ft.eccentricitySquared,vee={a1:cl*rn,a2:cl*rn*cl*rn,a3:cl*rn*rn/2,a4:cl*rn*cl*rn*2.5,a5:cl*rn+cl*rn*rn/2,a6:1-rn},bee={4267:{a:63782064e-1,f:1/294.9786982},4269:{a:6378137,f:1/298.257222101},4326:{a:Ft.radius,f:Ft.flattening},4490:{a:6378137,f:1/298.257222101},104900:{a:2439700,f:0},104901:{a:6051e3,f:0},104902:{a:6051800,f:0},104903:{a:du.radius,f:du.flattening},104904:{a:3393400,f:1/192.0430107526882},104905:{a:Do.radius,f:Do.flattening},104906:{a:6200,f:0},104907:{a:11100,f:0},104908:{a:71492e3,f:.06487439154031222},104909:{a:8200,f:0},104910:{a:83500,f:0},104911:{a:1e4,f:0},104912:{a:2409300,f:0},104913:{a:15e3,f:0},104914:{a:4e4,f:0},104915:{a:1562090,f:0},104916:{a:2632345,f:0},104917:{a:85e3,f:0},104918:{a:1821460,f:0},104919:{a:5e3,f:0},104920:{a:12e3,f:0},104921:{a:3e4,f:3},104922:{a:18e3,f:0},104923:{a:14e3,f:0},104924:{a:49300,f:0},104925:{a:60268e3,f:1/10.2079945799458},104926:{a:16e3,f:0},104927:{a:9500,f:0},104928:{a:56e4,f:0},104929:{a:249400,f:0},104930:{a:59500,f:0},104931:{a:16e3,f:0},104932:{a:133e3,f:0},104933:{a:718e3,f:0},104934:{a:888e3,f:0},104935:{a:1986300,f:0},104936:{a:1e4,f:0},104937:{a:41900,f:0},104938:{a:11e4,f:0},104939:{a:50100,f:0},104940:{a:764e3,f:0},104941:{a:11e3,f:0},104942:{a:529800,f:0},104943:{a:2575e3,f:0},104944:{a:25559e3,f:1/43.61604095563141},104945:{a:578900,f:0},104946:{a:33e3,f:0},104947:{a:21e3,f:0},104948:{a:13e3,f:0},104949:{a:31e3,f:0},104950:{a:27e3,f:0},104951:{a:42e3,f:0},104952:{a:235800,f:0},104953:{a:761400,f:0},104954:{a:15e3,f:0},104955:{a:54e3,f:0},104956:{a:77e3,f:0},104957:{a:27e3,f:0},104958:{a:788900,f:0},104959:{a:584700,f:0},104960:{a:24764e3,f:.01708124697141011},104961:{a:74e3,f:0},104962:{a:79e3,f:0},104963:{a:104e3,f:.14423076923076922},104964:{a:29e3,f:0},104965:{a:17e4,f:0},104966:{a:208e3,f:0},104967:{a:4e4,f:0},104968:{a:1352600,f:0},104969:{a:1195e3,f:0},104970:{a:593e3,f:0},104971:{a:Do.radius,f:0},104972:{a:47e4,f:0},104973:{a:255e3,f:0},104974:{a:2439400,f:0}};var z;(function(e){e[e.UNKNOWN=0]="UNKNOWN",e[e.SPHERICAL_ECEF=1]="SPHERICAL_ECEF",e[e.WGS84=2]="WGS84",e[e.WEB_MERCATOR=3]="WEB_MERCATOR",e[e.WGS84_ECEF=4]="WGS84_ECEF",e[e.CGCS2000=5]="CGCS2000",e[e.SPHERICAL_MARS_PCPF=6]="SPHERICAL_MARS_PCPF",e[e.GCSMARS2000=7]="GCSMARS2000",e[e.SPHERICAL_MOON_PCPF=8]="SPHERICAL_MOON_PCPF",e[e.GCSMOON2000=9]="GCSMOON2000",e[e.LON_LAT=10]="LON_LAT",e[e.PLATE_CARREE=11]="PLATE_CARREE"})(z||(z={}));const wee={[z.WGS84]:{[z.CGCS2000]:_t,[z.GCSMARS2000]:null,[z.GCSMOON2000]:null,[z.LON_LAT]:_t,[z.SPHERICAL_ECEF]:my,[z.SPHERICAL_MARS_PCPF]:null,[z.SPHERICAL_MOON_PCPF]:null,[z.UNKNOWN]:null,[z.WEB_MERCATOR]:ep,[z.PLATE_CARREE]:tp,[z.WGS84]:_t,[z.WGS84_ECEF]:sp},[z.CGCS2000]:{[z.CGCS2000]:_t,[z.GCSMARS2000]:null,[z.GCSMOON2000]:null,[z.LON_LAT]:_t,[z.SPHERICAL_ECEF]:my,[z.SPHERICAL_MARS_PCPF]:null,[z.SPHERICAL_MOON_PCPF]:null,[z.UNKNOWN]:null,[z.WEB_MERCATOR]:ep,[z.PLATE_CARREE]:tp,[z.WGS84]:_t,[z.WGS84_ECEF]:sp},[z.GCSMARS2000]:{[z.CGCS2000]:null,[z.GCSMARS2000]:_t,[z.GCSMOON2000]:null,[z.LON_LAT]:_t,[z.SPHERICAL_ECEF]:null,[z.SPHERICAL_MARS_PCPF]:$A,[z.SPHERICAL_MOON_PCPF]:null,[z.UNKNOWN]:null,[z.WEB_MERCATOR]:null,[z.PLATE_CARREE]:null,[z.WGS84]:null,[z.WGS84_ECEF]:null},[z.GCSMOON2000]:{[z.CGCS2000]:null,[z.GCSMARS2000]:null,[z.GCSMOON2000]:_t,[z.LON_LAT]:_t,[z.SPHERICAL_ECEF]:null,[z.SPHERICAL_MARS_PCPF]:null,[z.SPHERICAL_MOON_PCPF]:xA,[z.UNKNOWN]:null,[z.WEB_MERCATOR]:null,[z.PLATE_CARREE]:null,[z.WGS84]:null,[z.WGS84_ECEF]:null},[z.WEB_MERCATOR]:{[z.CGCS2000]:fy,[z.GCSMARS2000]:null,[z.GCSMOON2000]:null,[z.LON_LAT]:fy,[z.SPHERICAL_ECEF]:xee,[z.SPHERICAL_MARS_PCPF]:null,[z.SPHERICAL_MOON_PCPF]:null,[z.UNKNOWN]:null,[z.WEB_MERCATOR]:_t,[z.PLATE_CARREE]:Tee,[z.WGS84]:fy,[z.WGS84_ECEF]:$ee},[z.WGS84_ECEF]:{[z.CGCS2000]:np,[z.GCSMARS2000]:null,[z.GCSMOON2000]:null,[z.LON_LAT]:np,[z.SPHERICAL_ECEF]:Oee,[z.SPHERICAL_MARS_PCPF]:null,[z.SPHERICAL_MOON_PCPF]:null,[z.UNKNOWN]:null,[z.WEB_MERCATOR]:Nee,[z.PLATE_CARREE]:Eee,[z.WGS84]:np,[z.WGS84_ECEF]:_t},[z.SPHERICAL_ECEF]:{[z.CGCS2000]:rp,[z.GCSMARS2000]:null,[z.GCSMOON2000]:null,[z.LON_LAT]:rp,[z.SPHERICAL_ECEF]:_t,[z.SPHERICAL_MARS_PCPF]:null,[z.SPHERICAL_MOON_PCPF]:null,[z.UNKNOWN]:null,[z.WEB_MERCATOR]:Lee,[z.PLATE_CARREE]:Cee,[z.WGS84]:rp,[z.WGS84_ECEF]:kee},[z.SPHERICAL_MARS_PCPF]:{[z.CGCS2000]:null,[z.GCSMARS2000]:TA,[z.GCSMOON2000]:null,[z.LON_LAT]:TA,[z.SPHERICAL_ECEF]:null,[z.SPHERICAL_MARS_PCPF]:_t,[z.SPHERICAL_MOON_PCPF]:null,[z.UNKNOWN]:null,[z.WEB_MERCATOR]:null,[z.PLATE_CARREE]:null,[z.WGS84]:null,[z.WGS84_ECEF]:null},[z.SPHERICAL_MOON_PCPF]:{[z.CGCS2000]:null,[z.GCSMARS2000]:null,[z.GCSMOON2000]:MA,[z.LON_LAT]:MA,[z.SPHERICAL_ECEF]:null,[z.SPHERICAL_MARS_PCPF]:null,[z.SPHERICAL_MOON_PCPF]:_t,[z.UNKNOWN]:null,[z.WEB_MERCATOR]:null,[z.PLATE_CARREE]:null,[z.WGS84]:null,[z.WGS84_ECEF]:null},[z.UNKNOWN]:{[z.CGCS2000]:null,[z.GCSMARS2000]:null,[z.GCSMOON2000]:null,[z.LON_LAT]:null,[z.SPHERICAL_ECEF]:null,[z.SPHERICAL_MARS_PCPF]:null,[z.SPHERICAL_MOON_PCPF]:null,[z.UNKNOWN]:_t,[z.WEB_MERCATOR]:null,[z.PLATE_CARREE]:null,[z.WGS84]:null,[z.WGS84_ECEF]:null},[z.LON_LAT]:{[z.CGCS2000]:_t,[z.GCSMARS2000]:_t,[z.GCSMOON2000]:_t,[z.LON_LAT]:_t,[z.SPHERICAL_ECEF]:my,[z.SPHERICAL_MARS_PCPF]:$A,[z.SPHERICAL_MOON_PCPF]:xA,[z.UNKNOWN]:null,[z.WEB_MERCATOR]:ep,[z.PLATE_CARREE]:tp,[z.WGS84]:_t,[z.WGS84_ECEF]:sp},[z.PLATE_CARREE]:{[z.CGCS2000]:ip,[z.GCSMARS2000]:null,[z.GCSMOON2000]:null,[z.LON_LAT]:ip,[z.SPHERICAL_ECEF]:Pee,[z.SPHERICAL_MARS_PCPF]:null,[z.SPHERICAL_MOON_PCPF]:null,[z.UNKNOWN]:null,[z.WEB_MERCATOR]:Iee,[z.PLATE_CARREE]:_t,[z.WGS84]:ip,[z.WGS84_ECEF]:Aee}};function iz(e,t){return See(e,t)?.projector}function See(e,t){if(e==null||t==null)return null;if(Zo.source.spatialReference===e&&Zo.dest.spatialReference===t)return Zo;const i=SA(e,Zo.source),r=SA(t,Zo.dest);return i===z.UNKNOWN&&r===z.UNKNOWN?ci(e,t)?Zo.projector=_t:Zo.projector=null:Zo.projector=wee[i][r],Zo}function SA(e,t){return e?t.spatialReference===e?t.spatialReferenceId:(t.spatialReference=e,"metersPerUnit"in t&&(t.metersPerUnit=Hs(e,1)),lv(e)?t.spatialReferenceId=z.SPHERICAL_ECEF:oh(e)?t.spatialReferenceId=z.WGS84:Rn(e)?t.spatialReferenceId=z.WEB_MERCATOR:iY(e)?t.spatialReferenceId=z.PLATE_CARREE:e.wkt===oY.wkt?t.spatialReferenceId=z.WGS84_ECEF:e.wkid===nh.CGCS2000?t.spatialReferenceId=z.CGCS2000:e.wkt===tC.wkt?t.spatialReferenceId=z.SPHERICAL_MARS_PCPF:e.wkt===iC.wkt?t.spatialReferenceId=z.SPHERICAL_MOON_PCPF:P4(e)?t.spatialReferenceId=z.GCSMARS2000:I4(e)?t.spatialReferenceId=z.GCSMOON2000:t.spatialReferenceId=z.UNKNOWN):z.UNKNOWN}function _t(e,t,i,r){e!==i&&(i[r++]=e[t++],i[r++]=e[t++],i[r]=e[t])}function fy(e,t,i,r){i[r]=qp*(e[t]/Gc),i[r+1]=qp*(rz-2*Math.atan(Math.exp(-e[t+1]/Gc))),i[r+2]=e[t+2]}function xee(e,t,i,r){const s=e[t]/Gc,n=rz-2*Math.atan(Math.exp(-e[t+1]/Gc)),o=Gc+e[t+2],a=Math.cos(n)*o;i[r]=Math.cos(s)*a,i[r+1]=Math.sin(s)*a,i[r+2]=Math.sin(n)*o}function $ee(e,t,i,r){fy(e,t,i,r),sp(i,r,i,r)}function Mee(e,t,i,r,s){const n=.4999999*Math.PI,o=lr(Bp*e[t+1],-n,n),a=Math.sin(o);i[r++]=Bp*e[t]*s.radius,i[r++]=s.halfSemiMajorAxis*Math.log((1+a)/(1-a)),i[r]=e[t+2]}function ep(e,t,i,r){Mee(e,t,i,r,Ft)}function tp(e,t,i,r){i[r]=e[t]*EA,i[r+1]=e[t+1]*EA,i[r+2]=e[t+2]}function ip(e,t,i,r){i[r]=e[t]*CA,i[r+1]=e[t+1]*CA,i[r+2]=e[t+2]}function Tee(e,t,i,r){fy(e,t,i,r),tp(i,r,i,r)}function Eee(e,t,i,r){np(e,t,i,r),tp(i,r,i,r)}function Cee(e,t,i,r){rp(e,t,i,r),tp(i,r,i,r)}function Pee(e,t,i,r){ip(e,t,i,r),my(i,r,i,r)}function Iee(e,t,i,r){ip(e,t,i,r),ep(i,r,i,r)}function Aee(e,t,i,r){ip(e,t,i,r),sp(i,r,i,r)}function PC(e,t,i,r,s){const n=s+e[t+2],o=Bp*e[t+1],a=Bp*e[t],l=Math.cos(o)*n;i[r]=Math.cos(a)*l,i[r+1]=Math.sin(a)*l,i[r+2]=Math.sin(o)*n}function xA(e,t,i,r){PC(e,t,i,r,du.radius)}function $A(e,t,i,r){PC(e,t,i,r,Do.radius)}function my(e,t,i,r){PC(e,t,i,r,Ft.radius)}function IC(e,t,i,r,s){const n=e[t],o=e[t+1],a=e[t+2],l=Math.sqrt(n*n+o*o+a*a),u=rQ(a/(l===0?1:l)),c=Math.atan2(o,n);i[r++]=qp*c,i[r++]=qp*u,i[r]=l-s}function MA(e,t,i,r){IC(e,t,i,r,du.radius)}function TA(e,t,i,r){IC(e,t,i,r,Do.radius)}function rp(e,t,i,r){IC(e,t,i,r,Ft.radius)}function Lee(e,t,i,r){rp(e,t,i,r),ep(i,r,i,r)}function kee(e,t,i,r){rp(e,t,i,r),sp(i,r,i,r)}function Ree(e,t,i,r,s){const n=Bp*e[t],o=Bp*e[t+1],a=e[t+2],l=Math.sin(o),u=Math.cos(o),c=s.radius/Math.sqrt(1-s.eccentricitySquared*l*l);i[r++]=(c+a)*u*Math.cos(n),i[r++]=(c+a)*u*Math.sin(n),i[r++]=(c*(1-s.eccentricitySquared)+a)*l}function sp(e,t,i,r){Ree(e,t,i,r,Ft)}function np(e,t,i,r){const s=vee,n=e[t],o=e[t+1],a=e[t+2];let l,u,c,d,m,y,g,_,v,b,S,$,E,C,P,k,F,D,U,W,Y;l=Math.abs(a),u=n*n+o*o,c=Math.sqrt(u),d=u+a*a,m=Math.sqrt(d),W=Math.atan2(o,n),y=a*a/d,g=u/d,C=s.a2/m,P=s.a3-s.a4/m,g>.3?(_=l/m*(1+g*(s.a1+C+y*P)/m),U=Math.asin(_),b=_*_,v=Math.sqrt(1-b)):(v=c/m*(1-y*(s.a5-C-g*P)/m),U=Math.acos(v),b=1-v*v,_=Math.sqrt(b)),S=1-Ft.eccentricitySquared*b,$=Ft.radius/Math.sqrt(S),E=s.a6*$,C=c-$*v,P=l-E*_,F=v*C+_*P,k=v*P-_*C,D=k/(E/S+F),U+=D,Y=F+k*D/2,a<0&&(U=-U),i[r++]=qp*W,i[r++]=qp*U,i[r]=Y}function Oee(e,t,i,r){np(e,t,i,r),my(i,r,i,r)}function Nee(e,t,i,r){np(e,t,i,r),ep(i,r,i,r)}const Zo={source:{spatialReference:null,spatialReferenceId:z.UNKNOWN,metersPerUnit:1},dest:{spatialReference:null,spatialReferenceId:z.UNKNOWN,metersPerUnit:1},projector:_t},Bp=mf(1),qp=_6(1),rz=.5*Math.PI,Gc=Ft.radius,EA=Gc*Math.PI/180,CA=180/(Gc*Math.PI);function Gg(e,t,i,r,s,n,o=Math.floor(e.length/3)){const a=iz(t,s);if(a==null)return!1;if(a===_t){if(e===r&&i===n)return!0;const u=i+3*o;for(let c=i,d=n;c<u;c++,d++)r[d]=e[c];return!0}const l=i+3*o;for(let u=i,c=n;u<l;u+=3,c+=3)a(e,u,r,c);return!0}const REe=Object.freeze(Object.defineProperty({__proto__:null,projectBuffer:Gg},Symbol.toStringTag,{value:"Module"}));function PA(e,t,i,r,s,n){return M0[0]=e,M0[1]=t,M0[2]=i,Gg(M0,r,0,s,n,0)}const M0=Su();let T0=0,f2=class Fx{static fromGE(t){const i=new Fx;return i._wkt=t.wkt,i._wkid=t.wkid,i._isInverse=t.isInverse,i}constructor(t){this.uid=T0++,t?(this._wkt=t.wkt!=null?t.wkt:null,this._wkid=t.wkid!=null?t.wkid:-1,this._isInverse=t.isInverse!=null&&t.isInverse===!0):(this._wkt=null,this._wkid=-1,this._isInverse=!1)}get wkt(){return this._wkt}set wkt(t){this._wkt=t,this.uid=T0++}get wkid(){return this._wkid}set wkid(t){this._wkid=t,this.uid=T0++}get isInverse(){return this._isInverse}set isInverse(t){this._isInverse=t,this.uid=T0++}getInverse(){const t=new Fx;return t._wkt=this.wkt,t._wkid=this._wkid,t._isInverse=!this.isInverse,t}},bv=class bm{static cacheKey(t,i){return[t.wkid?.toString()??"-1",t.wkt?.toString()??"",t.wkt2?.toString()??"",i.wkid?.toString()??"-1",i.wkt?.toString()??"",i.wkt2?.toString()??""].join()}static fromGE(t){const i=new bm;let r="";for(const s of t.steps){const n=f2.fromGE(s);i.steps.push(n),r+=n.uid.toString()+","}return i._cachedProjection={},i._gtlistentry=null,i._chain=r,i}constructor(t){if(this.steps=[],this._cachedProjection={},this._chain="",this._gtlistentry=null,t?.steps)for(const i of t.steps)i instanceof f2?this.steps.push(i):this.steps.push(new f2({wkid:i.wkid,wkt:i.wkt,isInverse:i.isInverse}))}getInverse(){const t=new bm;t.steps=[];for(let i=this.steps.length-1;i>=0;i--){const r=this.steps[i];t.steps.push(r.getInverse())}return t}getGTListEntry(){let t="";for(const i of this.steps)t+=i.uid.toString()+",";return t!==this._chain&&(this._gtlistentry=null,this._cachedProjection={},this._chain=t),this._gtlistentry}assignCachedGe(t,i,r){this._cachedProjection[bm.cacheKey(t,i)]=r}getCachedGeTransformation(t,i){let r="";for(const n of this.steps)r+=n.uid.toString()+",";r!==this._chain&&(this._gtlistentry=null,this._cachedProjection={},this._chain=r);const s=this._cachedProjection[bm.cacheKey(t,i)];return s===void 0?null:s}};function Dee(e,t,i){if(t==null||i==null||i.vcsWkid||ci(t,i)||pu(t)||pu(i))return null;const r=_3(t)/_3(i);if(r===1)return null;switch(e){case"point":case"esriGeometryPoint":return s=>Fee(s,r);case"polyline":case"esriGeometryPolyline":return s=>Vee(s,r);case"polygon":case"esriGeometryPolygon":return s=>zee(s,r);case"multipoint":case"esriGeometryMultipoint":return s=>Uee(s,r);case"extent":case"esriGeometryEnvelope":return s=>jee(s,r);default:return null}}function Fee(e,t){e?.z!=null&&(e.z*=t)}function zee(e,t){if(e)for(const i of e.rings)for(const r of i)r.length>2&&(r[2]*=t)}function Vee(e,t){if(e)for(const i of e.paths)for(const r of i)r.length>2&&(r[2]*=t)}function Uee(e,t){if(e)for(const i of e.points)i.length>2&&(i[2]*=t)}function jee(e,t){e&&e.zmin!=null&&e.zmax!=null&&(e.zmin*=t,e.zmax*=t)}let Ln=null,gu=null,yy=null,V_={};const AC=new Og;function Xa(){return!!Ln&&QE()}function sz(){return!!Xa()||(ge(AC),Wa(),!1)}function nz(e,t){return!e||!t||qs(e,t)||sz()}function Gee(e,t){return!qs(e,t)&&!Xa()}function Wa(e){return yy==null&&(yy=Promise.all([S4(),J(()=>import("./geometryEngineBase-B9CjWDWD.js"),__vite__mapDeps([18,19])).then((t=>t.g)),J(()=>import("./hydrated-DW5S65w6.js"),[])])),yy.then((([,t,{hydratedAdapter:i}])=>{It(e),gu=i,Ln=t.default,Ln._enableProjection(KZ),AC.notify()}))}function xh(e,t,i=null,r=null){return Array.isArray(e)?e.length===0?[]:(AY(e),zx(gu,e,e[0].spatialReference,t,i,r)):(Fp(e),zx(gu,[e],e.spatialReference,t,i,r)[0])}function zx(e,t,i,r,s=null,n=null){if(i==null||r==null)return t;if(qs(i,r,s))return t.map((o=>U_(o,i,r)));if(s==null&&lv(i))return t.map((o=>U_(o,i,ae.WGS84))).map((o=>Hy(o,r)));if(s==null&&lv(r))return t.map((o=>Hy(o,ae.WGS84))).map((o=>U_(o,ae.WGS84,r)));if(s==null){const o=bv.cacheKey(i,r);V_[o]!==void 0?s=V_[o]:((s=az(i,r,void 0))==null&&(s=new bv),V_[o]=s)}if(Ln==null||e==null)throw new ew;return n!=null?Ln._project(e,t,i,r,s,n):Ln._project(e,t,i,r,s)}function Bee(e,t){const i=oz([e],t);return i.pending!=null?{pending:i.pending,geometry:null}:i.geometries!=null?{pending:null,geometry:i.geometries[0]}:{pending:null,geometry:null}}function oz(e,t){if(!Xa()){for(const i of e)if(i!=null&&!ci(i.spatialReference,t)&&jr(i.spatialReference)&&jr(t)&&!qs(i.spatialReference,t))return ge(AC),{pending:Wa(),geometries:null}}return{pending:null,geometries:e.map((i=>i==null?null:ci(i.spatialReference,t)?i:jr(i.spatialReference)&&jr(t)?Hy(i,t):null))}}function az(e,t,i=null){if(e==null||t==null)return null;if(Ln==null||gu==null)throw new ew;const r=Ln._getTransformation(gu,e,t,i,i?.spatialReference);return r!==null?bv.fromGE(r):null}function qee(e,t,i=null){if(Ln==null||gu==null)throw new ew;const r=Ln._getTransformationBySuitability(gu,e,t,i,i?.spatialReference);if(r!==null){const s=[];for(const n of r)s.push(bv.fromGE(n));return s}return[]}let ew=class extends j{constructor(){super("projection:not-loaded","projection engine not fully loaded yet, please call load()")}};function Hee(){Ln=null,gu=null,yy=null,V_={}}const Wee={get loadPromise(){return yy}};function Hy(e,t){try{const i=xh(e,t);if(i==null)return null;"xmin"in e&&"xmin"in i&&(i.zmin=e.zmin,i.zmax=e.zmax);const r=Dee(i.type,e.spatialReference,t);return r?.(i),i}catch(i){if(!(i instanceof ew))throw i;return null}}async function lz(e,t,i){const r=e.spatialReference;return r!=null&&t!=null&&await uz(r,t,null,i),Hy(e,t)}function qs(e,t,i){return!i&&(!!ci(e,t)||jr(e)&&jr(t)&&!!iz(e,t))}function Zee(e,t){if(ci(e,t))return!0;if(!jr(e)||!jr(t))return!1;const i=oh(e)||Rn(e)||y3(e),r=oh(t)||Rn(t)||y3(t);return i&&r}async function uz(e,t,i,r){if(Xa())return OI(r);if(Array.isArray(e)){for(const{source:s,dest:n,geographicTransformation:o}of e)if(s&&n&&!qs(s,n,o))return Wa(r)}else if(e&&t&&!qs(e,t,i))return Wa(r);return OI(r)}function U_(e,t,i){return e?"x"in e?cz(e,t,new he,i,0):"xmin"in e?mz(e,t,new ke,i,0):"rings"in e?fz(e,t,new mt,i,0):"paths"in e?dz(e,t,new Yt,i,0):"points"in e?hz(e,t,new gn,i,0):null:null}function Yee(e,t,i=t.spatialReference,r=0){return i!=null&&e.spatialReference!=null&&cz(e,e.spatialReference,t,i,r)!=null}function cz(e,t,i,r,s){Qi[0]=e.x,Qi[1]=e.y;const n=e.z;return Qi[2]=n!==void 0?n:s,Gg(Qi,t,0,Qi,r,0)?(i.x=Qi[0],i.y=Qi[1],i.spatialReference=r,n!==void 0||pu(r)?(i.z=Qi[2],i.hasZ=!0):(i.z=void 0,i.hasZ=!1),e.m===void 0?(i.m=void 0,i.hasM=!1):(i.m=e.m,i.hasM=!0),i):null}function Jee(e,t,i=t.spatialReference,r=0){return e.spatialReference!=null&&i!=null&&hz(e,e.spatialReference,t,i,r)!=null}function hz(e,t,i,r,s){const{points:n,hasZ:o,hasM:a}=e,l=[],u=n.length,c=[];for(const m of n)c.push(m[0],m[1],o?m[2]:s);if(!Gg(c,t,0,c,r,0,u))return null;const d=o||pu(r);for(let m=0;m<u;++m){const y=3*m,g=c[y],_=c[y+1];d&&a?l.push([g,_,c[y+2],n[m][3]]):d?l.push([g,_,c[y+2]]):a?l.push([g,_,n[m][2]]):l.push([g,_])}return i.points=l,i.spatialReference=r,i.hasZ=o,i.hasM=a,i}function Xee(e,t,i=t.spatialReference,r=0){return e.spatialReference!=null&&i!=null&&dz(e,e.spatialReference,t,i,r)!=null}function dz(e,t,i,r,s){const{paths:n,hasZ:o,hasM:a}=e,l=[];if(!yz(n,o??!1,a??!1,t,l,r,s))return null;const u=o||pu(r);return i.paths=l,i.spatialReference=r,i.hasZ=u,i.hasM=a,i}function pz(e,t,i=t.spatialReference,r=0){return e.spatialReference!=null&&i!=null&&fz(e,e.spatialReference,t,i,r)!=null}function fz(e,t,i,r,s){const{rings:n,hasZ:o,hasM:a}=e,l=[];if(!yz(n,o??!1,a??!1,t,l,r,s))return null;const u=o||pu(r);return i.rings=l,i.spatialReference=r,i.hasZ=u,i.hasM=a,i}function Kee(e,t,i=t.spatialReference,r=0){return e.spatialReference!=null&&i!=null&&mz(e,e.spatialReference,t,i,r)!=null}function mz(e,t,i,r,s){const{xmin:n,ymin:o,xmax:a,ymax:l,hasZ:u,hasM:c}=e,d=u?e.zmin:s;if(!PA(n,o,d,t,Qi,r))return null;const m=u||pu(r);i.xmin=Qi[0],i.ymin=Qi[1],m&&(i.zmin=Qi[2]);const y=u?e.zmax:s;return PA(a,l,y,t,Qi,r)?(i.xmax=Qi[0],i.ymax=Qi[1],m&&(i.zmax=Qi[2]),c&&(i.mmin=e.mmin,i.mmax=e.mmax),i.spatialReference=r,i):null}function yz(e,t,i,r,s,n,o=0){const a=new Array;for(const c of e)for(const d of c)a.push(d[0],d[1],t?d[2]:o);if(!Gg(a,r,0,a,n,0))return!1;let l=0;s.length=0;const u=t||pu(n);for(const c of e){const d=new Array;for(const m of c)u&&i?d.push([a[l++],a[l++],a[l++],m[3]]):u?d.push([a[l++],a[l++],a[l++]]):i?(d.push([a[l++],a[l++],m[2]]),l++):(d.push([a[l++],a[l++]]),l++);s.push(d)}return!0}const Qi=Su(),NEe=Object.freeze(Object.defineProperty({__proto__:null,canProjectWithoutEngine:qs,getTransformation:az,getTransformations:qee,initializeProjection:uz,isEqualBaseGCS:Zee,isLoaded:Xa,isLoadedOrLoad:sz,isLoadedOrLoadFor:nz,load:Wa,project:xh,projectExtent:Kee,projectMany:zx,projectMultipoint:Jee,projectOrLoad:Bee,projectOrLoadMany:oz,projectPoint:Yee,projectPolygon:pz,projectPolyline:Xee,projectWithZConversion:lz,projectWithoutEngine:U_,requiresLoad:Gee,test:Wee,tryProjectWithZConversion:Hy,unload:Hee},Symbol.toStringTag,{value:"Module"}));var j_;let Vx=j_=class extends ee.JSONSupportMixin(ne.ofType(mt)){constructor(e){super(e)}clone(){return new j_(this.items.map((e=>e.clone())))}write(e,t){return this.toJSON(t)}toJSON(e){const t=e?.layer?.spatialReference;return t?this.toArray().map((i=>{if(!t.equals(i.spatialReference)){if(!qs(i.spatialReference,t))return e?.messages?.push(new Bs("scenefilter:unsupported","Scene filters with incompatible spatial references are not supported",{modification:this,spatialReference:e.layer.spatialReference,context:e})),null;const s=new mt;pz(i,s,t),i=s}const r=i.toJSON(e);return delete r.spatialReference,r})).filter((i=>i!=null)):this.toArray().map((i=>i.toJSON(e)))}static fromJSON(e,t){const i=new j_;return e.forEach((r=>i.add(mt.fromJSON(r,t)))),i}};Vx=j_=h([I("esri.layers.support.PolygonCollection")],Vx);const gy=Vx;let ua=class extends ee.JSONSupportMixin(xt){constructor(t){super(t),this.id=`focusarea-${Ug()}`,this.title=null,this.enabled=!0,this.outline=null,this.geometries=new gy}readGeometries(t,i,r){Array.isArray(t)?this.geometries=gy.fromJSON(t,r):r.hooks?.onAfterLoad?.((()=>this._loadGeometries(Ga(t,r),r)))}async _loadGeometries(t,i){const r=await at(t,{responseType:"json"});this.geometries=gy.fromJSON(r.data,i)}};h([f({type:String,nonNullable:!0,json:{write:!0,origins:{"web-scene":{write:{isRequired:!0}}}}}),f()],ua.prototype,"id",void 0),h([f({type:String,json:{write:!0}})],ua.prototype,"title",void 0),h([f({type:Boolean,nonNullable:!0,json:{write:!0,origins:{"web-scene":{write:{isRequired:!0}}}}})],ua.prototype,"enabled",void 0),h([f({type:CQ,json:{write:!0}})],ua.prototype,"outline",void 0),h([f({type:gy,nonNullable:!0,json:{write:!0,origins:{"web-scene":{write:{isRequired:!0}}}},clonable:e=>new gy(e.items.map((t=>t.clone())))}),wQ({origins:["web-scene","portal-item"],type:"resource",prefix:"geometries",contentAddressed:!0})],ua.prototype,"geometries",void 0),h([Ae(["web-scene","portal-item"],"geometries")],ua.prototype,"readGeometries",null),ua=h([I("esri.effects.FocusArea")],ua);const Qee=ua;let wm=class extends ee.JSONSupportMixin(xt){constructor(t){super(t),this.areas=new ne,this.style="bright"}};h([f({type:ne.ofType(Qee),nonNullable:!0,json:{write:!0,origins:{"web-scene":{write:{isRequired:!0}}}},clonable:e=>new ne(e.items.map((t=>t.clone())))})],wm.prototype,"areas",void 0),h([f({type:["bright","dark"],nonNullable:!0,json:{write:!0}})],wm.prototype,"style",void 0),wm=h([I("esri.effects.FocusAreas")],wm);const gz=wm;function ete(e){return typeof e=="object"&&e!=null&&"loaded"in e&&e.loaded===!0&&"type"in e}function tte(e){return!(!ete(e)||!zK(e)?.operations?.supportsEditing||"editingEnabled"in e&&!UK(e)||u6(e))}const ite=/^-?(\d+(\.\d+)?)\s*((px)|(pt))?$/i,rte="screenUtils.toPt: input not recognized!",_z=96;function Re(e){return e?e/72*_z:0}function We(e){return e?72*e/_z:0}function ct(e){if(typeof e=="string"){const t=e.match(ite);if(t){const i=Number(t[1]),r=t[3]&&t[3].toLowerCase(),s=e.charAt(0)==="-",n=r==="px"?We(i):i;return s?-n:n}return console.warn(rte),null}return e}function ei(e=0,t=0){return{x:e,y:t}}function zEe(e){return e?ei(e.x,e.y):null}function VEe(e=0,t=0){return[e,t]}function UEe(e=0,t=0,i=0){return[e,t,i]}function jEe(e){return e}function GEe(e){return e}function BEe(e){return e}function qEe(e,t){return t?(t[0]=e.x,t[1]=e.y,t.length>2&&(t[2]=0),t):[e.x,e.y]}function tw(){const e=new Float32Array(16);return e[0]=1,e[5]=1,e[10]=1,e[15]=1,e}function ste(e){const t=new Float32Array(16);return t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3],t[4]=e[4],t[5]=e[5],t[6]=e[6],t[7]=e[7],t[8]=e[8],t[9]=e[9],t[10]=e[10],t[11]=e[11],t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15],t}function nte(e,t,i,r,s,n,o,a,l,u,c,d,m,y,g,_){const v=new Float32Array(16);return v[0]=e,v[1]=t,v[2]=i,v[3]=r,v[4]=s,v[5]=n,v[6]=o,v[7]=a,v[8]=l,v[9]=u,v[10]=c,v[11]=d,v[12]=m,v[13]=y,v[14]=g,v[15]=_,v}const ote=tw();Object.freeze(Object.defineProperty({__proto__:null,IDENTITY:ote,clone:ste,create:tw,fromValues:nte},Symbol.toStringTag,{value:"Module"}));let LC=1e-6;function Tr(){return LC}function ate(e){LC=e}const iw=Math.random,lte=Math.PI/180,ute=180/Math.PI;function kC(e){return e*lte}function cte(e){return e*ute}function hte(e,t){return Math.abs(e-t)<=LC*Math.max(1,Math.abs(e),Math.abs(t))}Object.freeze(Object.defineProperty({__proto__:null,RANDOM:iw,equals:hte,getEpsilon:Tr,setEpsilon:ate,toDegree:cte,toRadian:kC},Symbol.toStringTag,{value:"Module"}));function vz(e,t){return e[0]=t[0],e[1]=t[1],e[2]=t[2],e[3]=t[3],e[4]=t[4],e[5]=t[5],e[6]=t[6],e[7]=t[7],e[8]=t[8],e[9]=t[9],e[10]=t[10],e[11]=t[11],e[12]=t[12],e[13]=t[13],e[14]=t[14],e[15]=t[15],e}function xu(e,t,i,r,s,n,o,a,l,u,c,d,m,y,g,_,v){return e[0]=t,e[1]=i,e[2]=r,e[3]=s,e[4]=n,e[5]=o,e[6]=a,e[7]=l,e[8]=u,e[9]=c,e[10]=d,e[11]=m,e[12]=y,e[13]=g,e[14]=_,e[15]=v,e}function rw(e){return e[0]=1,e[1]=0,e[2]=0,e[3]=0,e[4]=0,e[5]=1,e[6]=0,e[7]=0,e[8]=0,e[9]=0,e[10]=1,e[11]=0,e[12]=0,e[13]=0,e[14]=0,e[15]=1,e}function $u(e,t){if(e===t){const i=t[1],r=t[2],s=t[3],n=t[6],o=t[7],a=t[11];e[1]=t[4],e[2]=t[8],e[3]=t[12],e[4]=i,e[6]=t[9],e[7]=t[13],e[8]=r,e[9]=n,e[11]=t[14],e[12]=s,e[13]=o,e[14]=a}else e[0]=t[0],e[1]=t[4],e[2]=t[8],e[3]=t[12],e[4]=t[1],e[5]=t[5],e[6]=t[9],e[7]=t[13],e[8]=t[2],e[9]=t[6],e[10]=t[10],e[11]=t[14],e[12]=t[3],e[13]=t[7],e[14]=t[11],e[15]=t[15];return e}function dte(e,t){return bz(e,t)||rw(e),e}function bz(e,t){const i=t[0],r=t[1],s=t[2],n=t[3],o=t[4],a=t[5],l=t[6],u=t[7],c=t[8],d=t[9],m=t[10],y=t[11],g=t[12],_=t[13],v=t[14],b=t[15],S=i*a-r*o,$=i*l-s*o,E=i*u-n*o,C=r*l-s*a,P=r*u-n*a,k=s*u-n*l,F=c*_-d*g,D=c*v-m*g,U=c*b-y*g,W=d*v-m*_,Y=d*b-y*_,re=m*b-y*v;let K=S*re-$*Y+E*W+C*U-P*D+k*F;return K?(K=1/K,e[0]=(a*re-l*Y+u*W)*K,e[1]=(s*Y-r*re-n*W)*K,e[2]=(_*k-v*P+b*C)*K,e[3]=(m*P-d*k-y*C)*K,e[4]=(l*U-o*re-u*D)*K,e[5]=(i*re-s*U+n*D)*K,e[6]=(v*E-g*k-b*$)*K,e[7]=(c*k-m*E+y*$)*K,e[8]=(o*Y-a*U+u*F)*K,e[9]=(r*U-i*Y-n*F)*K,e[10]=(g*P-_*E+b*S)*K,e[11]=(d*E-c*P-y*S)*K,e[12]=(a*D-o*W-l*F)*K,e[13]=(i*W-r*D+s*F)*K,e[14]=(_*$-g*C-v*S)*K,e[15]=(c*C-d*$+m*S)*K,e):null}function pte(e,t){const i=t[0],r=t[1],s=t[2],n=t[3],o=t[4],a=t[5],l=t[6],u=t[7],c=t[8],d=t[9],m=t[10],y=t[11],g=t[12],_=t[13],v=t[14],b=t[15];return e[0]=a*(m*b-y*v)-d*(l*b-u*v)+_*(l*y-u*m),e[1]=-(r*(m*b-y*v)-d*(s*b-n*v)+_*(s*y-n*m)),e[2]=r*(l*b-u*v)-a*(s*b-n*v)+_*(s*u-n*l),e[3]=-(r*(l*y-u*m)-a*(s*y-n*m)+d*(s*u-n*l)),e[4]=-(o*(m*b-y*v)-c*(l*b-u*v)+g*(l*y-u*m)),e[5]=i*(m*b-y*v)-c*(s*b-n*v)+g*(s*y-n*m),e[6]=-(i*(l*b-u*v)-o*(s*b-n*v)+g*(s*u-n*l)),e[7]=i*(l*y-u*m)-o*(s*y-n*m)+c*(s*u-n*l),e[8]=o*(d*b-y*_)-c*(a*b-u*_)+g*(a*y-u*d),e[9]=-(i*(d*b-y*_)-c*(r*b-n*_)+g*(r*y-n*d)),e[10]=i*(a*b-u*_)-o*(r*b-n*_)+g*(r*u-n*a),e[11]=-(i*(a*y-u*d)-o*(r*y-n*d)+c*(r*u-n*a)),e[12]=-(o*(d*v-m*_)-c*(a*v-l*_)+g*(a*m-l*d)),e[13]=i*(d*v-m*_)-c*(r*v-s*_)+g*(r*m-s*d),e[14]=-(i*(a*v-l*_)-o*(r*v-s*_)+g*(r*l-s*a)),e[15]=i*(a*m-l*d)-o*(r*m-s*d)+c*(r*l-s*a),e}function fte(e){const t=e[0],i=e[1],r=e[2],s=e[3],n=e[4],o=e[5],a=e[6],l=e[7],u=e[8],c=e[9],d=e[10],m=e[11],y=e[12],g=e[13],_=e[14],v=e[15];return(t*o-i*n)*(d*v-m*_)-(t*a-r*n)*(c*v-m*g)+(t*l-s*n)*(c*_-d*g)+(i*a-r*o)*(u*v-m*y)-(i*l-s*o)*(u*_-d*y)+(r*l-s*a)*(u*g-c*y)}function wz(e,t,i){const r=t[0],s=t[1],n=t[2],o=t[3],a=t[4],l=t[5],u=t[6],c=t[7],d=t[8],m=t[9],y=t[10],g=t[11],_=t[12],v=t[13],b=t[14],S=t[15];let $=i[0],E=i[1],C=i[2],P=i[3];return e[0]=$*r+E*a+C*d+P*_,e[1]=$*s+E*l+C*m+P*v,e[2]=$*n+E*u+C*y+P*b,e[3]=$*o+E*c+C*g+P*S,$=i[4],E=i[5],C=i[6],P=i[7],e[4]=$*r+E*a+C*d+P*_,e[5]=$*s+E*l+C*m+P*v,e[6]=$*n+E*u+C*y+P*b,e[7]=$*o+E*c+C*g+P*S,$=i[8],E=i[9],C=i[10],P=i[11],e[8]=$*r+E*a+C*d+P*_,e[9]=$*s+E*l+C*m+P*v,e[10]=$*n+E*u+C*y+P*b,e[11]=$*o+E*c+C*g+P*S,$=i[12],E=i[13],C=i[14],P=i[15],e[12]=$*r+E*a+C*d+P*_,e[13]=$*s+E*l+C*m+P*v,e[14]=$*n+E*u+C*y+P*b,e[15]=$*o+E*c+C*g+P*S,e}function mte(e,t,i){const r=i[0],s=i[1],n=i[2];if(t===e)e[12]=t[0]*r+t[4]*s+t[8]*n+t[12],e[13]=t[1]*r+t[5]*s+t[9]*n+t[13],e[14]=t[2]*r+t[6]*s+t[10]*n+t[14],e[15]=t[3]*r+t[7]*s+t[11]*n+t[15];else{const o=t[0],a=t[1],l=t[2],u=t[3],c=t[4],d=t[5],m=t[6],y=t[7],g=t[8],_=t[9],v=t[10],b=t[11];e[0]=o,e[1]=a,e[2]=l,e[3]=u,e[4]=c,e[5]=d,e[6]=m,e[7]=y,e[8]=g,e[9]=_,e[10]=v,e[11]=b,e[12]=o*r+c*s+g*n+t[12],e[13]=a*r+d*s+_*n+t[13],e[14]=l*r+m*s+v*n+t[14],e[15]=u*r+y*s+b*n+t[15]}return e}function yte(e,t,i){const r=i[0],s=i[1],n=i[2];return e[0]=t[0]*r,e[1]=t[1]*r,e[2]=t[2]*r,e[3]=t[3]*r,e[4]=t[4]*s,e[5]=t[5]*s,e[6]=t[6]*s,e[7]=t[7]*s,e[8]=t[8]*n,e[9]=t[9]*n,e[10]=t[10]*n,e[11]=t[11]*n,e[12]=t[12],e[13]=t[13],e[14]=t[14],e[15]=t[15],e}function gte(e,t,i,r){let s=r[0],n=r[1],o=r[2],a=Math.sqrt(s*s+n*n+o*o);if(a<=Tr())return void vz(e,t);a=1/a,s*=a,n*=a,o*=a;const l=Math.sin(i),u=Math.cos(i),c=1-u,d=t[0],m=t[1],y=t[2],g=t[3],_=t[4],v=t[5],b=t[6],S=t[7],$=t[8],E=t[9],C=t[10],P=t[11],k=s*s*c+u,F=n*s*c+o*l,D=o*s*c-n*l,U=s*n*c-o*l,W=n*n*c+u,Y=o*n*c+s*l,re=s*o*c+n*l,K=n*o*c-s*l,Ce=o*o*c+u;e[0]=d*k+_*F+$*D,e[1]=m*k+v*F+E*D,e[2]=y*k+b*F+C*D,e[3]=g*k+S*F+P*D,e[4]=d*U+_*W+$*Y,e[5]=m*U+v*W+E*Y,e[6]=y*U+b*W+C*Y,e[7]=g*U+S*W+P*Y,e[8]=d*re+_*K+$*Ce,e[9]=m*re+v*K+E*Ce,e[10]=y*re+b*K+C*Ce,e[11]=g*re+S*K+P*Ce,t!==e&&(e[12]=t[12],e[13]=t[13],e[14]=t[14],e[15]=t[15])}function _te(e,t,i){const r=Math.sin(i),s=Math.cos(i),n=t[4],o=t[5],a=t[6],l=t[7],u=t[8],c=t[9],d=t[10],m=t[11];return t!==e&&(e[0]=t[0],e[1]=t[1],e[2]=t[2],e[3]=t[3],e[12]=t[12],e[13]=t[13],e[14]=t[14],e[15]=t[15]),e[4]=n*s+u*r,e[5]=o*s+c*r,e[6]=a*s+d*r,e[7]=l*s+m*r,e[8]=u*s-n*r,e[9]=c*s-o*r,e[10]=d*s-a*r,e[11]=m*s-l*r,e}function vte(e,t,i){const r=Math.sin(i),s=Math.cos(i),n=t[0],o=t[1],a=t[2],l=t[3],u=t[8],c=t[9],d=t[10],m=t[11];return t!==e&&(e[4]=t[4],e[5]=t[5],e[6]=t[6],e[7]=t[7],e[12]=t[12],e[13]=t[13],e[14]=t[14],e[15]=t[15]),e[0]=n*s-u*r,e[1]=o*s-c*r,e[2]=a*s-d*r,e[3]=l*s-m*r,e[8]=n*r+u*s,e[9]=o*r+c*s,e[10]=a*r+d*s,e[11]=l*r+m*s,e}function bte(e,t,i){const r=Math.sin(i),s=Math.cos(i),n=t[0],o=t[1],a=t[2],l=t[3],u=t[4],c=t[5],d=t[6],m=t[7];return t!==e&&(e[8]=t[8],e[9]=t[9],e[10]=t[10],e[11]=t[11],e[12]=t[12],e[13]=t[13],e[14]=t[14],e[15]=t[15]),e[0]=n*s+u*r,e[1]=o*s+c*r,e[2]=a*s+d*r,e[3]=l*s+m*r,e[4]=u*s-n*r,e[5]=c*s-o*r,e[6]=d*s-a*r,e[7]=m*s-l*r,e}function wte(e,t){return e[0]=1,e[1]=0,e[2]=0,e[3]=0,e[4]=0,e[5]=1,e[6]=0,e[7]=0,e[8]=0,e[9]=0,e[10]=1,e[11]=0,e[12]=t[0],e[13]=t[1],e[14]=t[2],e[15]=1,e}function Ste(e,t){return e[0]=t[0],e[1]=0,e[2]=0,e[3]=0,e[4]=0,e[5]=t[1],e[6]=0,e[7]=0,e[8]=0,e[9]=0,e[10]=t[2],e[11]=0,e[12]=0,e[13]=0,e[14]=0,e[15]=1,e}function xte(e,t,i){if(t===0)return rw(e);let r=i[0],s=i[1],n=i[2],o=Math.sqrt(r*r+s*s+n*n);if(o<=Tr())return null;o=1/o,r*=o,s*=o,n*=o;const a=Math.sin(t),l=Math.cos(t),u=1-l;return e[0]=r*r*u+l,e[1]=s*r*u+n*a,e[2]=n*r*u-s*a,e[3]=0,e[4]=r*s*u-n*a,e[5]=s*s*u+l,e[6]=n*s*u+r*a,e[7]=0,e[8]=r*n*u+s*a,e[9]=s*n*u-r*a,e[10]=n*n*u+l,e[11]=0,e[12]=0,e[13]=0,e[14]=0,e[15]=1,e}function $te(e,t){const i=Math.sin(t),r=Math.cos(t);return e[0]=1,e[1]=0,e[2]=0,e[3]=0,e[4]=0,e[5]=r,e[6]=i,e[7]=0,e[8]=0,e[9]=-i,e[10]=r,e[11]=0,e[12]=0,e[13]=0,e[14]=0,e[15]=1,e}function Mte(e,t){const i=Math.sin(t),r=Math.cos(t);return e[0]=r,e[1]=0,e[2]=-i,e[3]=0,e[4]=0,e[5]=1,e[6]=0,e[7]=0,e[8]=i,e[9]=0,e[10]=r,e[11]=0,e[12]=0,e[13]=0,e[14]=0,e[15]=1,e}function Tte(e,t){const i=Math.sin(t),r=Math.cos(t);return e[0]=r,e[1]=i,e[2]=0,e[3]=0,e[4]=-i,e[5]=r,e[6]=0,e[7]=0,e[8]=0,e[9]=0,e[10]=1,e[11]=0,e[12]=0,e[13]=0,e[14]=0,e[15]=1,e}function Sz(e,t,i){const r=t[0],s=t[1],n=t[2],o=t[3],a=r+r,l=s+s,u=n+n,c=r*a,d=r*l,m=r*u,y=s*l,g=s*u,_=n*u,v=o*a,b=o*l,S=o*u;return e[0]=1-(y+_),e[1]=d+S,e[2]=m-b,e[3]=0,e[4]=d-S,e[5]=1-(c+_),e[6]=g+v,e[7]=0,e[8]=m+b,e[9]=g-v,e[10]=1-(c+y),e[11]=0,e[12]=i[0],e[13]=i[1],e[14]=i[2],e[15]=1,e}function Ete(e,t){const i=Cte,r=-t[0],s=-t[1],n=-t[2],o=t[3],a=t[4],l=t[5],u=t[6],c=t[7],d=r*r+s*s+n*n+o*o;return d>0?(i[0]=2*(a*o+c*r+l*n-u*s)/d,i[1]=2*(l*o+c*s+u*r-a*n)/d,i[2]=2*(u*o+c*n+a*s-l*r)/d):(i[0]=2*(a*o+c*r+l*n-u*s),i[1]=2*(l*o+c*s+u*r-a*n),i[2]=2*(u*o+c*n+a*s-l*r)),Sz(e,t,i),e}const Cte=Su();function Pte(e,t){return e[0]=t[12],e[1]=t[13],e[2]=t[14],e}function Ite(e,t){const i=t[0],r=t[1],s=t[2],n=t[4],o=t[5],a=t[6],l=t[8],u=t[9],c=t[10];return e[0]=Math.sqrt(i*i+r*r+s*s),e[1]=Math.sqrt(n*n+o*o+a*a),e[2]=Math.sqrt(l*l+u*u+c*c),e}function Ate(e,t){const i=t[0]+t[5]+t[10];let r=0;return i>0?(r=2*Math.sqrt(i+1),e[3]=.25*r,e[0]=(t[6]-t[9])/r,e[1]=(t[8]-t[2])/r,e[2]=(t[1]-t[4])/r):t[0]>t[5]&&t[0]>t[10]?(r=2*Math.sqrt(1+t[0]-t[5]-t[10]),e[3]=(t[6]-t[9])/r,e[0]=.25*r,e[1]=(t[1]+t[4])/r,e[2]=(t[8]+t[2])/r):t[5]>t[10]?(r=2*Math.sqrt(1+t[5]-t[0]-t[10]),e[3]=(t[8]-t[2])/r,e[0]=(t[1]+t[4])/r,e[1]=.25*r,e[2]=(t[6]+t[9])/r):(r=2*Math.sqrt(1+t[10]-t[0]-t[5]),e[3]=(t[1]-t[4])/r,e[0]=(t[8]+t[2])/r,e[1]=(t[6]+t[9])/r,e[2]=.25*r),e}function Lte(e,t,i,r){const s=t[0],n=t[1],o=t[2],a=t[3],l=s+s,u=n+n,c=o+o,d=s*l,m=s*u,y=s*c,g=n*u,_=n*c,v=o*c,b=a*l,S=a*u,$=a*c,E=r[0],C=r[1],P=r[2];return e[0]=(1-(g+v))*E,e[1]=(m+$)*E,e[2]=(y-S)*E,e[3]=0,e[4]=(m-$)*C,e[5]=(1-(d+v))*C,e[6]=(_+b)*C,e[7]=0,e[8]=(y+S)*P,e[9]=(_-b)*P,e[10]=(1-(d+g))*P,e[11]=0,e[12]=i[0],e[13]=i[1],e[14]=i[2],e[15]=1,e}function kte(e,t,i,r,s){const n=t[0],o=t[1],a=t[2],l=t[3],u=n+n,c=o+o,d=a+a,m=n*u,y=n*c,g=n*d,_=o*c,v=o*d,b=a*d,S=l*u,$=l*c,E=l*d,C=r[0],P=r[1],k=r[2],F=s[0],D=s[1],U=s[2],W=(1-(_+b))*C,Y=(y+E)*C,re=(g-$)*C,K=(y-E)*P,Ce=(1-(m+b))*P,Ve=(v+S)*P,Je=(g+$)*k,Oe=(v-S)*k,Lt=(1-(m+_))*k;return e[0]=W,e[1]=Y,e[2]=re,e[3]=0,e[4]=K,e[5]=Ce,e[6]=Ve,e[7]=0,e[8]=Je,e[9]=Oe,e[10]=Lt,e[11]=0,e[12]=i[0]+F-(W*F+K*D+Je*U),e[13]=i[1]+D-(Y*F+Ce*D+Oe*U),e[14]=i[2]+U-(re*F+Ve*D+Lt*U),e[15]=1,e}function Rte(e,t){const i=t[0],r=t[1],s=t[2],n=t[3],o=i+i,a=r+r,l=s+s,u=i*o,c=r*o,d=r*a,m=s*o,y=s*a,g=s*l,_=n*o,v=n*a,b=n*l;return e[0]=1-d-g,e[1]=c+b,e[2]=m-v,e[3]=0,e[4]=c-b,e[5]=1-u-g,e[6]=y+_,e[7]=0,e[8]=m+v,e[9]=y-_,e[10]=1-u-d,e[11]=0,e[12]=0,e[13]=0,e[14]=0,e[15]=1,e}function Ote(e,t,i,r,s,n,o){const a=1/(i-t),l=1/(s-r),u=1/(n-o);return e[0]=2*n*a,e[1]=0,e[2]=0,e[3]=0,e[4]=0,e[5]=2*n*l,e[6]=0,e[7]=0,e[8]=(i+t)*a,e[9]=(s+r)*l,e[10]=(o+n)*u,e[11]=-1,e[12]=0,e[13]=0,e[14]=o*n*2*u,e[15]=0,e}function Nte(e,t,i,r,s){const n=1/Math.tan(t/2);let o;return e[0]=n/i,e[1]=0,e[2]=0,e[3]=0,e[4]=0,e[5]=n,e[6]=0,e[7]=0,e[8]=0,e[9]=0,e[11]=-1,e[12]=0,e[13]=0,e[15]=0,s!=null&&s!==1/0?(o=1/(r-s),e[10]=(s+r)*o,e[14]=2*s*r*o):(e[10]=-1,e[14]=-2*r),e}function Dte(e,t,i,r){const s=Math.tan(t.upDegrees*Math.PI/180),n=Math.tan(t.downDegrees*Math.PI/180),o=Math.tan(t.leftDegrees*Math.PI/180),a=Math.tan(t.rightDegrees*Math.PI/180),l=2/(o+a),u=2/(s+n);return e[0]=l,e[1]=0,e[2]=0,e[3]=0,e[4]=0,e[5]=u,e[6]=0,e[7]=0,e[8]=-(o-a)*l*.5,e[9]=(s-n)*u*.5,e[10]=r/(i-r),e[11]=-1,e[12]=0,e[13]=0,e[14]=r*i/(i-r),e[15]=0,e}function Fte(e,t,i,r,s,n,o){const a=1/(t-i),l=1/(r-s),u=1/(n-o);return e[0]=-2*a,e[1]=0,e[2]=0,e[3]=0,e[4]=0,e[5]=-2*l,e[6]=0,e[7]=0,e[8]=0,e[9]=0,e[10]=2*u,e[11]=0,e[12]=(t+i)*a,e[13]=(s+r)*l,e[14]=(o+n)*u,e[15]=1,e}function zte(e,t,i,r){const s=t[0],n=t[1],o=t[2];let a=s-i[0],l=n-i[1],u=o-i[2];const c=Tr();if(Math.abs(a)<c&&Math.abs(l)<c&&Math.abs(u)<c)return void rw(e);let d=1/Math.sqrt(a*a+l*l+u*u);a*=d,l*=d,u*=d;const m=r[0],y=r[1],g=r[2];let _=y*u-g*l,v=g*a-m*u,b=m*l-y*a;d=Math.sqrt(_*_+v*v+b*b),d?(d=1/d,_*=d,v*=d,b*=d):(_=0,v=0,b=0);let S=l*b-u*v,$=u*_-a*b,E=a*v-l*_;d=Math.sqrt(S*S+$*$+E*E),d?(d=1/d,S*=d,$*=d,E*=d):(S=0,$=0,E=0),e[0]=_,e[1]=S,e[2]=a,e[3]=0,e[4]=v,e[5]=$,e[6]=l,e[7]=0,e[8]=b,e[9]=E,e[10]=u,e[11]=0,e[12]=-(_*s+v*n+b*o),e[13]=-(S*s+$*n+E*o),e[14]=-(a*s+l*n+u*o),e[15]=1}function Vte(e,t,i,r){const s=t[0],n=t[1],o=t[2],a=r[0],l=r[1],u=r[2];let c=s-i[0],d=n-i[1],m=o-i[2],y=c*c+d*d+m*m;y>0&&(y=1/Math.sqrt(y),c*=y,d*=y,m*=y);let g=l*m-u*d,_=u*c-a*m,v=a*d-l*c;return y=g*g+_*_+v*v,y>0&&(y=1/Math.sqrt(y),g*=y,_*=y,v*=y),e[0]=g,e[1]=_,e[2]=v,e[3]=0,e[4]=d*v-m*_,e[5]=m*g-c*v,e[6]=c*_-d*g,e[7]=0,e[8]=c,e[9]=d,e[10]=m,e[11]=0,e[12]=s,e[13]=n,e[14]=o,e[15]=1,e}function Ute(e){return"mat4("+e[0]+", "+e[1]+", "+e[2]+", "+e[3]+", "+e[4]+", "+e[5]+", "+e[6]+", "+e[7]+", "+e[8]+", "+e[9]+", "+e[10]+", "+e[11]+", "+e[12]+", "+e[13]+", "+e[14]+", "+e[15]+")"}function jte(e){return Math.sqrt(e[0]**2+e[1]**2+e[2]**2+e[3]**2+e[4]**2+e[5]**2+e[6]**2+e[7]**2+e[8]**2+e[9]**2+e[10]**2+e[11]**2+e[12]**2+e[13]**2+e[14]**2+e[15]**2)}function Gte(e,t,i){return e[0]=t[0]+i[0],e[1]=t[1]+i[1],e[2]=t[2]+i[2],e[3]=t[3]+i[3],e[4]=t[4]+i[4],e[5]=t[5]+i[5],e[6]=t[6]+i[6],e[7]=t[7]+i[7],e[8]=t[8]+i[8],e[9]=t[9]+i[9],e[10]=t[10]+i[10],e[11]=t[11]+i[11],e[12]=t[12]+i[12],e[13]=t[13]+i[13],e[14]=t[14]+i[14],e[15]=t[15]+i[15],e}function xz(e,t,i){return e[0]=t[0]-i[0],e[1]=t[1]-i[1],e[2]=t[2]-i[2],e[3]=t[3]-i[3],e[4]=t[4]-i[4],e[5]=t[5]-i[5],e[6]=t[6]-i[6],e[7]=t[7]-i[7],e[8]=t[8]-i[8],e[9]=t[9]-i[9],e[10]=t[10]-i[10],e[11]=t[11]-i[11],e[12]=t[12]-i[12],e[13]=t[13]-i[13],e[14]=t[14]-i[14],e[15]=t[15]-i[15],e}function Bte(e,t,i){return e[0]=t[0]*i,e[1]=t[1]*i,e[2]=t[2]*i,e[3]=t[3]*i,e[4]=t[4]*i,e[5]=t[5]*i,e[6]=t[6]*i,e[7]=t[7]*i,e[8]=t[8]*i,e[9]=t[9]*i,e[10]=t[10]*i,e[11]=t[11]*i,e[12]=t[12]*i,e[13]=t[13]*i,e[14]=t[14]*i,e[15]=t[15]*i,e}function qte(e,t,i,r){return e[0]=t[0]+i[0]*r,e[1]=t[1]+i[1]*r,e[2]=t[2]+i[2]*r,e[3]=t[3]+i[3]*r,e[4]=t[4]+i[4]*r,e[5]=t[5]+i[5]*r,e[6]=t[6]+i[6]*r,e[7]=t[7]+i[7]*r,e[8]=t[8]+i[8]*r,e[9]=t[9]+i[9]*r,e[10]=t[10]+i[10]*r,e[11]=t[11]+i[11]*r,e[12]=t[12]+i[12]*r,e[13]=t[13]+i[13]*r,e[14]=t[14]+i[14]*r,e[15]=t[15]+i[15]*r,e}function Hte(e,t){return e[0]===t[0]&&e[1]===t[1]&&e[2]===t[2]&&e[3]===t[3]&&e[4]===t[4]&&e[5]===t[5]&&e[6]===t[6]&&e[7]===t[7]&&e[8]===t[8]&&e[9]===t[9]&&e[10]===t[10]&&e[11]===t[11]&&e[12]===t[12]&&e[13]===t[13]&&e[14]===t[14]&&e[15]===t[15]}function Wte(e,t){if(e===t)return!0;const i=e[0],r=e[1],s=e[2],n=e[3],o=e[4],a=e[5],l=e[6],u=e[7],c=e[8],d=e[9],m=e[10],y=e[11],g=e[12],_=e[13],v=e[14],b=e[15],S=t[0],$=t[1],E=t[2],C=t[3],P=t[4],k=t[5],F=t[6],D=t[7],U=t[8],W=t[9],Y=t[10],re=t[11],K=t[12],Ce=t[13],Ve=t[14],Je=t[15],Oe=Tr();return Math.abs(i-S)<=Oe*Math.max(1,Math.abs(i),Math.abs(S))&&Math.abs(r-$)<=Oe*Math.max(1,Math.abs(r),Math.abs($))&&Math.abs(s-E)<=Oe*Math.max(1,Math.abs(s),Math.abs(E))&&Math.abs(n-C)<=Oe*Math.max(1,Math.abs(n),Math.abs(C))&&Math.abs(o-P)<=Oe*Math.max(1,Math.abs(o),Math.abs(P))&&Math.abs(a-k)<=Oe*Math.max(1,Math.abs(a),Math.abs(k))&&Math.abs(l-F)<=Oe*Math.max(1,Math.abs(l),Math.abs(F))&&Math.abs(u-D)<=Oe*Math.max(1,Math.abs(u),Math.abs(D))&&Math.abs(c-U)<=Oe*Math.max(1,Math.abs(c),Math.abs(U))&&Math.abs(d-W)<=Oe*Math.max(1,Math.abs(d),Math.abs(W))&&Math.abs(m-Y)<=Oe*Math.max(1,Math.abs(m),Math.abs(Y))&&Math.abs(y-re)<=Oe*Math.max(1,Math.abs(y),Math.abs(re))&&Math.abs(g-K)<=Oe*Math.max(1,Math.abs(g),Math.abs(K))&&Math.abs(_-Ce)<=Oe*Math.max(1,Math.abs(_),Math.abs(Ce))&&Math.abs(v-Ve)<=Oe*Math.max(1,Math.abs(v),Math.abs(Ve))&&Math.abs(b-Je)<=Oe*Math.max(1,Math.abs(b),Math.abs(Je))}function Zte(e){const t=Tr(),i=e[0],r=e[1],s=e[2],n=e[4],o=e[5],a=e[6],l=e[8],u=e[9],c=e[10];return Math.abs(1-(i*i+n*n+l*l))<=t&&Math.abs(1-(r*r+o*o+u*u))<=t&&Math.abs(1-(s*s+a*a+c*c))<=t}function Yte(e){return e[0]===1&&e[1]===0&&e[2]===0&&e[4]===0&&e[5]===1&&e[6]===0&&e[8]===0&&e[9]===0&&e[10]===1}const Jte=wz,Xte=xz;Object.freeze(Object.defineProperty({__proto__:null,add:Gte,adjoint:pte,copy:vz,determinant:fte,equals:Wte,exactEquals:Hte,frob:jte,fromQuat:Rte,fromQuat2:Ete,fromRotation:xte,fromRotationTranslation:Sz,fromRotationTranslationScale:Lte,fromRotationTranslationScaleOrigin:kte,fromScaling:Ste,fromTranslation:wte,fromXRotation:$te,fromYRotation:Mte,fromZRotation:Tte,frustum:Ote,getRotation:Ate,getScale:Ite,getTranslation:Pte,hasIdentityRotation:Yte,identity:rw,invert:bz,invertOrIdentity:dte,isOrthoNormal:Zte,lookAt:zte,mul:Jte,multiply:wz,multiplyScalar:Bte,multiplyScalarAndAdd:qte,ortho:Fte,perspective:Nte,perspectiveFromFieldOfView:Dte,rotate:gte,rotateX:_te,rotateY:vte,rotateZ:bte,scale:yte,set:xu,str:Ute,sub:Xte,subtract:xz,targetTo:Vte,translate:mte,transpose:$u},Symbol.toStringTag,{value:"Module"}));const Kte=(e,t)=>{const i=xu(e,t,0,0,0,0,t,0,0,0,0,t,0,0,0,0,1);return $u(i,i)},Qte=(e,t)=>{const i=xu(e,t,0,0,.5-.5*t,0,t,0,.5-.5*t,0,0,t,.5-.5*t,0,0,0,1);return $u(i,i)},eie=(e,t)=>{const i=1-t,r=xu(e,.2126+.7874*i,.7152-.7152*i,.0722-.0722*i,0,.2126-.2126*i,.7152+.2848*i,.0722-.0722*i,0,.2126-.2126*i,.7152-.7152*i,.0722+.9278*i,0,0,0,0,1);return $u(r,r)},tie=(e,t)=>{const i=Math.sin(t*Math.PI/180),r=Math.cos(t*Math.PI/180),s=xu(e,.213+.787*r-.213*i,.715-.715*r-.715*i,.072-.072*r+.928*i,0,.213-.213*r+.143*i,.715+.285*r+.14*i,.072-.072*r-.283*i,0,.213-.213*r-.787*i,.715-.715*r+.715*i,.072+.928*r+.072*i,0,0,0,0,1);return $u(s,s)},iie=(e,t)=>{const i=1-2*t,r=xu(e,i,0,0,t,0,i,0,t,0,0,i,t,0,0,0,1);return $u(r,r)},rie=(e,t)=>{const i=xu(e,.213+.787*t,.715-.715*t,.072-.072*t,0,.213-.213*t,.715+.285*t,.072-.072*t,0,.213-.213*t,.715-.715*t,.072+.928*t,0,0,0,0,1);return $u(i,i)},sie=(e,t)=>{const i=1-t,r=xu(e,.393+.607*i,.769-.769*i,.189-.189*i,0,.349-.349*i,.686+.314*i,.168-.168*i,0,.272-.272*i,.534-.534*i,.131+.869*i,0,0,0,0,1);return $u(r,r)};let $z=class Mz{constructor(t,i,r){this.strength=t,this.radius=i,this.threshold=r,this.type="bloom"}interpolate(t,i,r){this.strength=Ur(t.strength,i.strength,r),this.radius=Ur(t.radius,i.radius,r),this.threshold=Ur(t.threshold,i.threshold,r)}clone(){return new Mz(this.strength,this.radius,this.threshold)}toJSON(){return{type:"bloom",radius:_y(this.radius),strength:this.strength,threshold:this.threshold}}},Tz=class Ez{constructor(t){this.radius=t,this.type="blur"}interpolate(t,i,r){this.radius=Math.round(Ur(t.radius,i.radius,r))}clone(){return new Ez(this.radius)}toJSON(){return{type:"blur",radius:_y(this.radius)}}},Ux=class Cz{constructor(t,i){this.type=t,this.amount=i,this.type!=="invert"&&this.type!=="grayscale"&&this.type!=="sepia"||(this.amount=Math.min(this.amount,1))}get colorMatrix(){return this._colorMatrix||this._updateMatrix(),this._colorMatrix}interpolate(t,i,r){this.amount=Ur(t.amount,i.amount,r),this._updateMatrix()}clone(){return new Cz(this.type,this.amount)}toJSON(){return{type:this.type,amount:this.amount}}_updateMatrix(){const t=this._colorMatrix||tw();switch(this.type){case"brightness":this._colorMatrix=Kte(t,this.amount);break;case"contrast":this._colorMatrix=Qte(t,this.amount);break;case"grayscale":this._colorMatrix=eie(t,this.amount);break;case"invert":this._colorMatrix=iie(t,this.amount);break;case"saturate":this._colorMatrix=rie(t,this.amount);break;case"sepia":this._colorMatrix=sie(t,this.amount)}}},Pz=class Iz{constructor(t,i,r,s){this.offsetX=t,this.offsetY=i,this.blurRadius=r,this.color=s,this.type="drop-shadow"}interpolate(t,i,r){this.offsetX=Ur(t.offsetX,i.offsetX,r),this.offsetY=Ur(t.offsetY,i.offsetY,r),this.blurRadius=Ur(t.blurRadius,i.blurRadius,r),this.color[0]=Math.round(Ur(t.color[0],i.color[0],r)),this.color[1]=Math.round(Ur(t.color[1],i.color[1],r)),this.color[2]=Math.round(Ur(t.color[2],i.color[2],r)),this.color[3]=Ur(t.color[3],i.color[3],r)}clone(){return new Iz(this.offsetX,this.offsetY,this.blurRadius,[...this.color])}toJSON(){const t=[...this.color];return t[3]*=255,{type:"drop-shadow",xoffset:_y(this.offsetX),yoffset:_y(this.offsetY),blurRadius:_y(this.blurRadius),color:t}}},Az=class Lz{constructor(t){this.angle=t,this.type="hue-rotate"}get colorMatrix(){return this._colorMatrix||this._updateMatrix(),this._colorMatrix}interpolate(t,i,r){this.angle=Ur(t.angle,i.angle,r),this._updateMatrix()}clone(){return new Lz(this.angle)}toJSON(){return{type:"hue-rotate",angle:this.angle}}_updateMatrix(){const t=this._colorMatrix||tw();this._colorMatrix=tie(t,this.angle)}},kz=class Rz{constructor(t){this.amount=t,this.type="opacity",this.amount=Math.min(this.amount,1)}interpolate(t,i,r){this.amount=Ur(t.amount,i.amount,r)}clone(){return new Rz(this.amount)}toJSON(){return{type:"opacity",amount:this.amount}}};function Ur(e,t,i){return e+(t-e)*i}function _y(e){return Math.round(1e3*We(e))/1e3}function nie(e){switch(e.type){case"grayscale":case"sepia":case"invert":return new Ux(e.type,0);case"saturate":case"brightness":case"contrast":return new Ux(e.type,1);case"opacity":return new kz(1);case"hue-rotate":return new Az(0);case"blur":return new Tz(0);case"drop-shadow":return new Pz(0,0,0,[...wC("transparent")]);case"bloom":return new $z(0,0,1)}}function Oz(e,t){const i=e.length>t.length?e:t;return(e.length>t.length?t:e).every(((r,s)=>r.type===i[s].type))}function Nz(e,t){const i=e.length>t.length?e:t,r=e.length>t.length?t:e;for(let s=r.length;s<i.length;s++)r.push(nie(i[s]))}function oie(e){const t=e[0];return!!t&&"type"in t}function aie(e,t){return JSON.stringify(e??null)===JSON.stringify(t??null)}function HEe(e,t){return e.allLayerViews.find((r=>r.uid===t))?.layer.parent===e.map?.basemap}function lie(e){let t=null;const i=cie(e),r=!i?.baseLayers.length;for(const s in Vp){const n=pie(i,Dz(Vp[s]),{mustMatchReferences:r});if(n==="equal"){t=s;break}n==="base-layers-equal"&&(t=s)}return t}function uie(e,t){if(t==null||e==null)return{spatialReference:null,updating:!1};if(t.loadStatus==="not-loaded")return t.load(),{spatialReference:null,updating:!0};if(t.spatialReference)return{spatialReference:t.spatialReference,updating:!1};if(t.baseLayers.length===0)return{spatialReference:null,updating:!1};const i=t.baseLayers.at(0);switch(i.loadStatus){case"not-loaded":i.load();case"loading":return{spatialReference:null,updating:!0};case"failed":return{spatialReference:null,updating:!1}}const r=(("supportedSpatialReferences"in i?i.supportedSpatialReferences:null)||["tileInfo"in i?i.tileInfo?.spatialReference:i.spatialReference]).filter(Boolean),s=e.spatialReference;return s?{spatialReference:r.find((n=>s.equals(n)))??r[0]??null,updating:!1}:{spatialReference:r[0],updating:!1}}function cie(e){return e?!e.loaded&&e.resourceInfo?Dz(e.resourceInfo.data):{baseLayers:IA(e.baseLayers),referenceLayers:IA(e.referenceLayers)}:null}function IA(e){return(ne.isCollection(e)?e.toArray():e).map(hie)}function hie(e){return{type:e.type,effect:"effect"in e?e.effect:void 0,url:Fz("urlTemplate"in e&&e.urlTemplate||e.url||"styleUrl"in e&&e.styleUrl||""),minScale:"minScale"in e&&e.minScale!=null?e.minScale:0,maxScale:"maxScale"in e&&e.maxScale!=null?e.maxScale:0,opacity:e.opacity!=null?e.opacity:1,visible:e.visible==null||!!e.visible,sublayers:e.type!=="map-image"&&e.type!=="wms"||e.sublayers==null?void 0:e.sublayers?.map((t=>({id:t.id,visible:t.visible}))),activeLayerId:e.type==="wmts"?e.activeLayer?.id:void 0}}function AA(e){return e.isReference||e.layerType==="ArcGISSceneServiceLayer"}function Dz(e){return e?{baseLayers:LA((e.baseMapLayers??[]).filter((t=>!AA(t)))),referenceLayers:LA((e.baseMapLayers??[]).filter((t=>AA(t))))}:null}function LA(e){return e.map((t=>die(t)))}function die(e){let t;switch(e.layerType){case"VectorTileLayer":t="vector-tile";break;case"ArcGISTiledMapServiceLayer":t="tile";break;case"ArcGISSceneServiceLayer":t="scene";break;default:t="unknown"}return{type:t,effect:e.effect,url:Fz(e.templateUrl||e.urlTemplate||e.styleUrl||e.url),minScale:e.minScale??0,maxScale:e.maxScale??0,opacity:e.opacity??1,visible:e.visibility==null||!!e.visibility,sublayers:void 0,activeLayerId:void 0}}function pie(e,t,i){return e!=null!=(t!=null)?"not-equal":!e||!t?"equal":kA(e.baseLayers,t.baseLayers)?kA(e.referenceLayers,t.referenceLayers)?"equal":i.mustMatchReferences?"not-equal":"base-layers-equal":"not-equal"}function kA(e,t){if(e.length!==t.length)return!1;for(let i=0;i<e.length;i++)if(!fie(e[i],t[i]))return!1;return!0}function fie(e,t){if(e.type!==t.type||e.url!==t.url||e.minScale!==t.minScale||e.maxScale!==t.maxScale||e.visible!==t.visible||e.opacity!==t.opacity||!aie(e.effect,t.effect))return!1;if(e.activeLayerId!=null||t.activeLayerId!=null)return e.activeLayerId===t.activeLayerId;if(e.sublayers!=null||t.sublayers!=null){if(e.sublayers==null||t.sublayers==null||e.sublayers.length!==t.sublayers.length)return!1;for(let i=0;i<e.sublayers.length;i++){const r=e.sublayers.at(i),s=t.sublayers.at(i);if(r?.id!==s?.id||r?.visible!==s?.visible)return!1}}return!0}function Fz(e){return e?No(e).replace(/^\s*https?:/i,"").toLowerCase():""}function zz(e){if(!e)return null;const{thumbnailUrl:t}=e;if(t)return t;const i=lie(e);return i?Vp[i].thumbnailUrl:fD(e.baseLayers,mie)}function mie(e){return"portalItem"in e?e.portalItem?.thumbnailUrl:void 0}const m2=()=>H.getLogger("esri.support.basemapUtils");function yie(){return{}}function Vz(e){for(const t in e){const i=e[t];Ot(i),delete e[t]}}function G_(e,t){let i;if(typeof e=="string"){const r=e in Vp,s=!r&&e.includes("/");if(!r&&!s){if(NS())m2().warn(`Unable to find basemap definition for: ${e}. See available styles at https://developers.arcgis.com/rest/basemap-styles/`);else{const n=Object.entries(Vp).filter((([o,a])=>a.classic||a.is3d)).map((([o])=>`"${o}"`)).sort().join(", ");m2().warn(`Unable to find basemap definition for: ${e}. Try one of these: ${n}`)}return null}t&&(i=t[e]),i||(i=r?py.fromId(e):new py({style:{id:e}}),t&&(t[e]=i))}else i=Ui(py,e);return i?.destroyed&&(m2().warn("The provided basemap is already destroyed",{basemap:i}),i=null),i}function gie(e){return new ro({getCollections:()=>[e.tables,e.layers],getChildrenFunction:t=>{const i=[];return"tables"in t&&i.push(t.tables),"layers"in t&&i.push(t.layers),i},itemFilterFunction:t=>{const i=t.parent;return!!i&&"tables"in i&&i.tables.includes(t)}})}function y2(e){for(const t of e.values())t?.destroy();e.clear()}const RA={"world-elevation":{id:"worldElevation",url:"//elevation3d.arcgis.com/arcgis/rest/services/WorldElevation3D/Terrain3D/ImageServer",layerType:"ArcGISTiledElevationServiceLayer"},"world-topobathymetry":{id:"worldTopoBathymetry",url:"//elevation3d.arcgis.com/arcgis/rest/services/WorldElevation3D/TopoBathy3D/ImageServer",layerType:"ArcGISTiledElevationServiceLayer"}};function _ie(e){let t=null;if(typeof e=="string")if(e in RA){const i=RA[e];t=new _v({resourceInfo:{data:{layers:[i]}}})}else H.getLogger("esri.support.groundUtils").warn(`Unable to find ground definition for: ${e}. Try "world-elevation"`);else t=Ui(_v,e);return t}let Uz=0;const jz=e=>{let t=class extends e{constructor(...i){super(...i),Object.defineProperty(this,"uid",{writable:!1,configurable:!1,value:Date.now().toString(16)+"-object-"+Uz++})}};return t=h([I("esri.core.Identifiable")],t),t},vie=e=>{let t=class extends e{constructor(...i){super(...i),Object.defineProperty(this,"uid",{writable:!1,configurable:!1,value:Uz++})}};return t=h([I("esri.core.Identifiable.NumericIdentifiable")],t),t};let Sm=class extends jz(class{}){};Sm=h([I("esri.core.Identifiable")],Sm),(function(e){e.IdentifiableMixin=jz,e.NumericIdentifiableMixin=vie})(Sm||(Sm={}));const Bg=Sm;async function bie(e){const t="portalItem"in e?e:{portalItem:e},{fromItem:i}=await J(async()=>{const{fromItem:r}=await import("./portalLayers-DdegSe-f.js");return{fromItem:r}},__vite__mapDeps([16,14,13,12,15,9]));try{return await i(t)}catch(r){const s=t?.portalItem,n=s?.id||"unset",o=s?.portal?.url||Fe.portalUrl;throw H.getLogger("esri.layers.support.fromPortalItem").error("#fromPortalItem()","Failed to create layer from portal item (portal: '"+o+"', id: '"+n+"')",r),r}}const jx={milliseconds:1,seconds:1e3,minutes:6e4,hours:36e5,days:864e5,weeks:6048e5,months:26784e5,years:31536e6,decades:31536e7,centuries:31536e8};function g2(e,t,i,r=On){const s=new Zr(_C(r)),n=se.fromJSDate(e,{zone:s}),o=i==="decades"||i==="centuries"?"year":Gz(i);return i==="decades"&&(t*=10),i==="centuries"&&(t*=100),n.plus({[o]:t}).toJSDate()}function ZEe(e,t,i="milliseconds"){const r=e.getTime(),s=wie(t,i,"milliseconds");return new Date(r+s)}function OA(e,t,i=On){const r=new Zr(_C(i)),s=se.fromJSDate(e,{zone:r});if(t==="decades"||t==="centuries"){const o=s.startOf("year"),{year:a}=o,l=a-a%(t==="decades"?10:100);return o.set({year:l}).toJSDate()}const n=Gz(t);return s.startOf(n).toJSDate()}function wie(e,t,i){return e===0?0:e*jx[t]/jx[i]}function YEe(e,t){return e&&t?e.intersection(t):e||t}function Gz(e){switch(e){case"milliseconds":return"millisecond";case"seconds":return"second";case"minutes":return"minute";case"hours":return"hour";case"days":return"day";case"weeks":return"week";case"months":return"month";case"years":return"year"}}var _s,cp;let yr=(cp=class extends ee{static get allTime(){return NA}static get empty(){return Sie}static fromArray(t){return new _s({start:t[0]!=null?new Date(t[0]):t[0],end:t[1]!=null?new Date(t[1]):t[1]})}constructor(t){super(t),this.end=null,this.start=null}readEnd(t,i){return i.end!=null?new Date(i.end):null}writeEnd(t,i){i.end=t?.getTime()??null}get isAllTime(){return this.equals(_s.allTime)}get isEmpty(){return this.equals(_s.empty)}readStart(t,i){return i.start!=null?new Date(i.start):null}writeStart(t,i){i.start=t?.getTime()??null}clone(){return new _s({end:this.end,start:this.start})}equals(t){if(!t)return!1;const i=this.start?.getTime()??this.start,r=this.end?.getTime()??this.end,s=t.start?.getTime()??t.start,n=t.end?.getTime()??t.end;return i===s&&r===n}expandTo(t,i=On){if(this.isEmpty||this.isAllTime)return this.clone();let r=this.start;r&&(r=OA(r,t,i));let s=this.end;if(s){const n=OA(s,t,i);s=s.getTime()===n.getTime()?n:g2(n,1,t,i)}return new _s({start:r,end:s})}intersection(t){if(!t)return this.clone();if(this.isEmpty||t.isEmpty)return _s.empty;if(this.isAllTime)return t.clone();if(t.isAllTime)return this.clone();const i=this.start?.getTime()??-1/0,r=this.end?.getTime()??1/0,s=t.start?.getTime()??-1/0,n=t.end?.getTime()??1/0;let o,a;return s>=i&&s<=r?o=s:i>=s&&i<=n&&(o=i),r>=s&&r<=n?a=r:n>=i&&n<=r&&(a=n),o==null||a==null||isNaN(o)||isNaN(a)?_s.empty:new _s({start:o===-1/0?null:new Date(o),end:a===1/0?null:new Date(a)})}offset(t,i,r=On){if(this.isEmpty||this.isAllTime)return this.clone();const s=new _s,{start:n,end:o}=this;return n!=null&&(s.start=g2(n,t,i,r)),o!=null&&(s.end=g2(o,t,i,r)),s}toArray(){return this.isEmpty?[void 0,void 0]:[this.start?.getTime()??null,this.end?.getTime()??null]}union(t){if(!t||t.isEmpty)return this.clone();if(this.isEmpty)return t.clone();if(this.isAllTime||t.isAllTime)return NA.clone();const i=this.start!=null&&t.start!=null?new Date(Math.min(this.start.getTime(),t.start.getTime())):null,r=this.end!=null&&t.end!=null?new Date(Math.max(this.end.getTime(),t.end.getTime())):null;return new _s({start:i,end:r})}},_s=cp,cp);h([f({type:Date,json:{write:{allowNull:!0}}})],yr.prototype,"end",void 0),h([Ae("end")],yr.prototype,"readEnd",null),h([$e("end")],yr.prototype,"writeEnd",null),h([f({readOnly:!0,json:{read:!1}})],yr.prototype,"isAllTime",null),h([f({readOnly:!0,json:{read:!1}})],yr.prototype,"isEmpty",null),h([f({type:Date,json:{write:{allowNull:!0}}})],yr.prototype,"start",void 0),h([Ae("start")],yr.prototype,"readStart",null),h([$e("start")],yr.prototype,"writeStart",null),yr=_s=h([I("esri.time.TimeExtent")],yr);const NA=new yr,Sie=new yr({start:void 0,end:void 0});let xie=0,kt=class extends Ja.EventedMixin(Bg.IdentifiableMixin(Ns)){constructor(){super(...arguments),this.attributionDataUrl=null,this.fullExtent=new ke(-180,-90,180,90,ae.WGS84),this.id=Date.now().toString(16)+"-layer-"+xie++,this.legendEnabled=!0,this.listMode="show",this.opacity=1,this.parent=null,this.persistenceEnabled=!1,this.popupEnabled=!0,this.attributionVisible=!0,this.spatialReference=ae.WGS84,this.title=null,this.type=null,this.url=null,this.visibilityTimeExtent=null,this.visible=!0}static async fromArcGISServerUrl(t){const i=typeof t=="string"?{url:t}:t;return(await J(async()=>{const{fromUrl:r}=await import("./arcgisLayers-0p4GGeHk.js");return{fromUrl:r}},__vite__mapDeps([20,14,13,15]))).fromUrl(i)}static fromPortalItem(t){return bie(t)}initialize(){this.when().catch((t=>{Er(t)||H.getLogger(this).error("#load()",`Failed to load layer (title: '${this.title??"no title"}', id: '${this.id??"no id"}')`,{error:t})}))}destroy(){const t=this.parent;if(t){const i=this;"layers"in t&&t.layers.includes(i)?t.layers.remove(i):"tables"in t&&t.tables.includes(i)?t.tables.remove(i):"baseLayers"in t&&t.baseLayers.includes(i)?t.baseLayers.remove(i):"referenceLayers"in t&&t.referenceLayers.includes(i)&&t.referenceLayers.remove(i),this._set("parent",null)}}get effectiveVisible(){let t=this.visible;const i=this.parent;return t&&i&&"effectiveVisible"in i&&(t&&=i.effectiveVisible),t}get hasAttributionData(){return this.attributionDataUrl!=null}get parsedUrl(){return Li(this.url)}createLayerView(t,i){return Promise.reject(new j("layer:create-layer-view","Layer does not support creating a layer view"))}async fetchAttributionData(){const t=this.attributionDataUrl;if(this.hasAttributionData&&t)return(await at(t,{query:{f:"json"},responseType:"json"})).data;throw new j("layer:no-attribution-data","Layer does not have attribution data")}};h([f({type:String})],kt.prototype,"attributionDataUrl",void 0),h([f({readOnly:!0})],kt.prototype,"effectiveVisible",null),h([f({type:ke})],kt.prototype,"fullExtent",void 0),h([f({readOnly:!0})],kt.prototype,"hasAttributionData",null),h([f({type:String,clonable:!1})],kt.prototype,"id",void 0),h([f({type:Boolean,nonNullable:!0})],kt.prototype,"legendEnabled",void 0),h([f({type:["show","hide","hide-children"]})],kt.prototype,"listMode",void 0),h([f({type:Number,range:{min:0,max:1},nonNullable:!0})],kt.prototype,"opacity",void 0),h([f({clonable:!1})],kt.prototype,"parent",void 0),h([f({readOnly:!0})],kt.prototype,"parsedUrl",null),h([f({type:Boolean,readOnly:!0})],kt.prototype,"persistenceEnabled",void 0),h([f({type:Boolean})],kt.prototype,"popupEnabled",void 0),h([f({type:Boolean})],kt.prototype,"attributionVisible",void 0),h([f({type:ae})],kt.prototype,"spatialReference",void 0),h([f({type:String})],kt.prototype,"title",void 0),h([f({readOnly:!0,json:{read:!1}})],kt.prototype,"type",void 0),h([f()],kt.prototype,"url",void 0),h([f({type:yr})],kt.prototype,"visibilityTimeExtent",void 0),h([f({type:Boolean,nonNullable:!0})],kt.prototype,"visible",void 0),kt=h([I("esri.layers.Layer")],kt);function Gx(e,t,i){let r,s;if(e)for(let n=0,o=e.length;n<o;n++){if(r=e.at(n),r?.[t]===i)return r;if(r?.type==="group"&&(s=Gx(r.layers,t,i),s))return s}}const $ie=e=>{let t=class extends e{constructor(...i){super(...i),this.layers=new ne;const r=o=>{o.parent&&"remove"in o.parent&&o.parent.remove(o)},s=o=>{o.parent=this,this.layerAdded(o),o.type!=="elevation"&&o.type!=="base-elevation"||H.getLogger(this).error(`Layer 'title:${o.title}, id:${o.id}' of type '${o.type}' is not supported as an operational layer and will therefore be ignored.`)},n=o=>{o.parent=null,this.layerRemoved(o)};this.addHandles([this.layers.on("before-add",(o=>{if(o.item===this)return o.preventDefault(),void H.getLogger(this).error("#add()","Cannot add layer to itself.");r(o.item)})),this.layers.on("after-add",(o=>s(o.item))),this.layers.on("after-remove",(o=>n(o.item)))])}destroy(){const i=this.layers.toArray();for(const r of i)r.destroy();this.layers.destroy()}set layers(i){this._set("layers",Ha(i,this._get("layers")))}add(i,r){const s=this.layers;if(r=s.getNextIndex(r),i instanceof kt){const n=i;n.parent===this?this.reorder(n,r):s.add(n,r)}else Bo(i)?i.then((n=>{this.destroyed||this.add(n,r)})):H.getLogger(this).error("#add()","The item being added is not a Layer or a Promise that resolves to a Layer.")}addMany(i,r){const s=this.layers;let n=s.getNextIndex(r);i.slice().forEach((o=>{o.parent!==this?(s.add(o,n),n+=1):this.reorder(o,n)}))}findLayerById(i){return Gx(this.layers,"id",i)}findLayerByUid(i){return Gx(this.layers,"uid",i)}remove(i){return this.layers.remove(i)}removeMany(i){return this.layers.removeMany(i)}removeAll(){return this.layers.removeAll()}reorder(i,r){return this.layers.reorder(i,r)}layerAdded(i){}layerRemoved(i){}};return h([f()],t.prototype,"layers",null),t=h([I("esri.support.LayersMixin")],t),t},Mie=new Set(["feature","subtype-group"]);function Bx(e,t,i){if(e)for(let r=0,s=e.length;r<s;r++){const n=e.at(r);if(n[t]===i)return n;if(n?.type==="group"){const o=Bx(n.tables,t,i);if(o)return o}}}const Tie=e=>{let t=class extends e{constructor(...i){super(...i),this.tables=new ne,this.addHandles([this.tables.on("after-add",(r=>{const s=r.item;s.parent&&s.parent!==this&&"tables"in s.parent&&s.parent.tables.remove(s),s.parent=this,Mie.has(s.type)||H.getLogger(this).error(`Layer 'title:${s.title}, id:${s.id}' of type '${s.type}' is not supported as a table and will therefore be ignored.`)})),this.tables.on("after-remove",(r=>{r.item.parent=null}))])}destroy(){const i=this.tables.toArray();for(const r of i)r.destroy();this.tables.destroy()}set tables(i){this._set("tables",Ha(i,this._get("tables")))}findTableById(i){return Bx(this.tables,"id",i)}findTableByUid(i){return Bx(this.tables,"uid",i)}};return h([f()],t.prototype,"tables",null),t=h([I("esri.support.TablesMixin")],t),t};let vs=class extends Tie($ie(Ja.EventedMixin(le))){constructor(t){super(t),this.allLayers=new ro({getCollections:()=>[this.basemap?.baseLayers,this.ground?.layers,this.layers,this.basemap?.referenceLayers],getChildrenFunction:i=>"layers"in i?i.layers:null}),this.focusAreas=new gz,this.allTables=gie(this),this.basemap=null,this.editableLayers=new ro({getCollections:()=>[this.allLayers],itemFilterFunction:tte}),this.ground=new _v,this._basemapCache=yie()}destroy(){Vz(this._basemapCache),this._basemapCache=null,this.focusAreas.destroy(),this.allLayers.destroy(),this.allTables.destroy(),this.editableLayers.destroy(),this.basemap=Ot(this.basemap),Ot(this.ground),this._set("ground",null)}castBasemap(t){return G_(t,this._basemapCache)}castGround(t){return _ie(t)??this._get("ground")}findLayerById(t){return this.allLayers.find((i=>i.id===t))}findTableById(t){return this.allTables.find((i=>i.id===t))}};h([f({readOnly:!0,dependsOn:[]})],vs.prototype,"allLayers",void 0),h([f({type:gz,nonNullable:!0,json:{write:{overridePolicy:e=>({enabled:e.areas.length>0,ignoreOrigin:!0})}}})],vs.prototype,"focusAreas",void 0),h([f({readOnly:!0})],vs.prototype,"allTables",void 0),h([f({type:py,json:{read:{source:"baseMap"},write:{target:"baseMap"}}})],vs.prototype,"basemap",void 0),h([Ke("basemap")],vs.prototype,"castBasemap",null),h([f({readOnly:!0})],vs.prototype,"editableLayers",void 0),h([f({type:_v,nonNullable:!0})],vs.prototype,"ground",void 0),h([Ke("ground")],vs.prototype,"castGround",null),h([f()],vs.prototype,"undoRedo",void 0),vs=h([I("esri.Map")],vs);const Eie=vs;let Gu=class extends xt{constructor(t){super(t),this.row=0,this.column=0,this.rows=1,this.columns=1}equals(t){return t!=null&&this.row===t.row&&this.rows===t.rows&&this.column===t.column&&this.columns===t.columns}};h([f({type:Number,nonNullable:!0,json:{read:!1,write:!1}})],Gu.prototype,"row",void 0),h([f({type:Number,nonNullable:!0,json:{read:!1,write:!1}})],Gu.prototype,"column",void 0),h([f({type:Number,nonNullable:!0,json:{read:!1,write:!1}})],Gu.prototype,"rows",void 0),h([f({type:Number,nonNullable:!0,json:{read:!1,write:!1}})],Gu.prototype,"columns",void 0),Gu=h([I("esri.CameraLayout")],Gu);const Bz=Gu;let RC=class{constructor(t,i){this.min=t,this.max=i,this.range=i-t}normalize(t,i=0,r=!1){return DA(this.range,this.min,this.max,t,i,r)}clamp(t,i=0){return lr(t-i,this.min,this.max)+i}monotonic(t,i,r){return t<i?i:i+qx(this.range,t-i,r)}minimalMonotonic(t,i,r){return DA(this.range,t,t+this.range,i,r)}center(t,i,r){return i=this.monotonic(t,i,r),this.normalize((t+i)/2,r)}diff(t,i,r){return this.monotonic(t,i,r)-t}shortestSignedDiff(t,i){t=this.normalize(t);const r=(i=this.normalize(i))-t,s=i<t?this.minimalMonotonic(t,i)-t:i-this.minimalMonotonic(i,t);return Math.abs(r)<Math.abs(s)?r:s}contains(t,i,r){return i=this.minimalMonotonic(t,i),(r=this.minimalMonotonic(t,r))>t&&r<i}};function DA(e,t,i,r,s=0,n=!1){return(r-=s)<t?r+=qx(e,t-r):r>i&&(r-=qx(e,r-i)),n&&r===i&&(r=t),r+s}function qx(e,t,i=0){return Math.ceil((t-i)/e)*e+i}const eCe=new RC(0,2*Math.PI),tCe=new RC(-Math.PI,Math.PI),Cie=new RC(0,360);let Bn=class extends xt.ClonableMixin(ee){constructor(...t){super(...t),this.position=new he([0,0,0]),this.heading=0,this.tilt=0,this.fov=55,this.layout=new Bz}normalizeCtorArgs(t,i,r,s){if(t&&typeof t=="object"&&("x"in t||Array.isArray(t))){const n={position:t};return i!=null&&(n.heading=i),r!=null&&(n.tilt=r),s!=null&&(n.fov=s),n}return t}writePosition(t,i,r,s){const n=t.clone();n.x=us(t.x||0),n.y=us(t.y||0),n.z=t.hasZ?us(t.z||0):t.z,i[r]=n.write({},s)}readPosition(t,i){const r=new he;return r.read(t,i),r.x=us(r.x||0),r.y=us(r.y||0),r.z=r.hasZ?us(r.z||0):r.z,r}equals(t){return t!=null&&this.tilt===t.tilt&&this.heading===t.heading&&this.fov===t.fov&&this.position.equals(t.position)&&this.layout.equals(t.layout)}};h([f({type:he,json:{write:{isRequired:!0}}})],Bn.prototype,"position",void 0),h([$e("position")],Bn.prototype,"writePosition",null),h([Ae("position")],Bn.prototype,"readPosition",null),h([f({type:Number,nonNullable:!0,json:{write:{isRequired:!0}}}),Ke((e=>Cie.normalize(us(e))))],Bn.prototype,"heading",void 0),h([f({type:Number,nonNullable:!0,json:{write:{isRequired:!0}}}),Ke((e=>lr(us(e),-180,180)))],Bn.prototype,"tilt",void 0),h([f({type:Number,nonNullable:!0,json:{default:55,write:!0}}),Ke((e=>lr(us(e,55),1,170)))],Bn.prototype,"fov",void 0),h([f({type:Bz,nonNullable:!0,json:{read:!1,write:!1}})],Bn.prototype,"layout",void 0),Bn=h([I("esri.Camera")],Bn);const Pie=Bn;function wr(e){return e.xmin!==void 0&&e.ymin!==void 0&&e.xmax!==void 0&&e.ymax!==void 0}function op(e){return e.points!==void 0}function Wy(e){return e.x!==void 0&&e.y!==void 0}function Vi(e){return e.paths!==void 0||e.curvePaths!==void 0}function gi(e){return e.rings!==void 0||e.curveRings!==void 0}function hh(e){return e==null?null:e instanceof Ci?e:Wy(e)?he.fromJSON(e):Vi(e)?Yt.fromJSON(e):gi(e)?mt.fromJSON(e):op(e)?gn.fromJSON(e):wr(e)?ke.fromJSON(e):null}function sw(e){return e?Wy(e)?"esriGeometryPoint":Vi(e)?"esriGeometryPolyline":gi(e)?"esriGeometryPolygon":wr(e)?"esriGeometryEnvelope":op(e)?"esriGeometryMultipoint":null:null}const Iie={esriGeometryPoint:he,esriGeometryPolyline:Yt,esriGeometryPolygon:mt,esriGeometryEnvelope:ke,esriGeometryMultipoint:gn,esriGeometryMultiPatch:mt};function Aie(e){return e&&Iie[e]||null}const Lie=cr()({esriGeometryPoint:"point",esriGeometryMultipoint:"multipoint",esriGeometryPolyline:"polyline",esriGeometryPolygon:"polygon"}),rCe=cr()({esriGeometryPoint:"point",esriGeometryMultipoint:"multipoint",esriGeometryPolyline:"polyline",esriGeometryPolygon:"polygon",esriGeometryEnvelope:"extent",mesh:"mesh"}),OC={base:Ci,key:"type",typeMap:{extent:ke,multipoint:gn,point:he,polyline:Yt,polygon:mt}};var Hx;let _l=Hx=class extends ee{constructor(e){super(e),this.rotation=0,this.scale=0,this.targetGeometry=null,this.camera=null}castRotation(e){return(e%=360)<0&&(e+=360),e}clone(){return new Hx({rotation:this.rotation,scale:this.scale,targetGeometry:this.targetGeometry!=null?this.targetGeometry.clone():null,camera:this.camera!=null?this.camera.clone():null})}};h([f({type:Number,json:{write:!0,origins:{"web-map":{default:0,write:!0},"web-scene":{write:{overridePolicy:_2}}}}})],_l.prototype,"rotation",void 0),h([Ke("rotation")],_l.prototype,"castRotation",null),h([f({type:Number,json:{write:!0,origins:{"web-map":{default:0,write:!0},"web-scene":{write:{overridePolicy:_2}}}}})],_l.prototype,"scale",void 0),h([f({types:OC,json:{read:hh,write:!0,origins:{"web-scene":{read:hh,write:{overridePolicy:_2}}}}})],_l.prototype,"targetGeometry",void 0),h([f({type:Pie,json:{write:!0,origins:{"web-scene":{write:{isRequired:!0}}}}})],_l.prototype,"camera",void 0),_l=Hx=h([I("esri.Viewpoint")],_l);const Us=_l;function _2(){return{enabled:!this.camera}}let Zy=class{constructor(t=i=>i.values().next().value){this._peeker=t,this._observable=new Og,this._items=new Set}get length(){return ge(this._observable),this._items.size}clear(){this.length!==0&&(this._items.clear(),this._observable.notify())}last(){if(this.length===0)return;let t;for(t of this._items);return t}peek(){if(this.length!==0)return this._peeker(this._items)}push(t){this.contains(t)||(this._items.add(t),this._observable.notify())}contains(t){return ge(this._observable),this._items.has(t)}pop(){if(this.length===0)return;const t=this.peek();return this._items.delete(t),this._observable.notify(),t}popLast(){if(this.length===0)return;const t=this.last();return this._items.delete(t),this._observable.notify(),t}remove(t){this.contains(t)&&(this._items.delete(t),this._observable.notify())}filter(t){const i=this.length;return this._items.forEach((r=>{t(r)||this._items.delete(r)})),i!==this._items.size&&this._observable.notify(),this}*[Symbol.iterator](){ge(this._observable),yield*this._items}};const qz=new FinalizationRegistry((e=>{e.close()}));function kie(e,t){qz.register(e,t,t)}function Rie(e){qz.unregister(e)}function Hz(e,t){return new Proxy({},{get:(i,r,s)=>(...n)=>{let o,a;const l=n[n.length-1];return Oie(l)&&(o=l.signal,a=l.transferList,n.pop()),e.apply(t?`${t}.${r.toString()}`:r.toString(),n,{transferList:a,signal:o})}})}function Oie(e){return typeof e=="object"&&!Array.isArray(e)&&e!=null&&("signal"in e||"transferList"in e||Object.keys(e).length===0)}const Nie={statsWorker:()=>J(()=>import("./statsWorker-D0zPvu16.js"),__vite__mapDeps([21,22,23,24])),geometryEngineWorker:()=>J(()=>import("./geometryEngineWorker-BeElq9cK.js"),__vite__mapDeps([25,26,18,19,27])),arcadeGeometryOperatorsWorker:()=>J(()=>import("./operatorsWorker-CX6o6r0E.js"),[]),CSVSourceWorker:()=>J(()=>import("./CSVSourceWorker-8-piIXC2.js"),__vite__mapDeps([28,29,27,30,31,32,33,34,35,36,37,38,39,22,23,24,40,41,42,43,44,45,46,47,48])),EdgeProcessingWorker:()=>J(()=>import("./EdgeProcessingWorker-CUuH6ZnC.js"),__vite__mapDeps([49,50,51,52,53,54,55,56,57,58,59,60])),ElevationSamplerWorker:()=>J(()=>import("./ElevationSamplerWorker-BFfRePqi.js"),__vite__mapDeps([61,45,62,63,64,65,66,67,68,69,70,52,71])),FeatureServiceSnappingSourceWorker:()=>J(()=>import("./FeatureServiceSnappingSourceWorker-BCe-FKt2.js"),__vite__mapDeps([72,31,32,27,33,34,30,35,36,37,38,39,22,23,24,40,41,42,43,44,45,46,73,74,75,76,77,5])),GeoJSONSourceWorker:()=>J(()=>import("./GeoJSONSourceWorker-DKTY3tLv.js"),__vite__mapDeps([78,34,30,35,31,32,27,33,36,37,38,39,22,23,24,40,41,42,43,44,45,46,79,29,48,80])),LercWorker:()=>J(()=>import("./LercWorker-s5YItR5A.js"),[]),MemorySourceWorker:()=>J(()=>import("./MemorySourceWorker-CwEyEK5e.js"),__vite__mapDeps([81,34,30,35,82,31,32,27,33,36,37,38,39,22,23,24,40,41,42,43,44,45,46,48,80,29])),PBFDecoderWorker:()=>J(()=>import("./PBFDecoderWorker-HbdwxNZo.js"),__vite__mapDeps([83,84,34,30,35,74,75])),FeaturePipelineWorker:()=>J(()=>import("./FeaturePipelineWorker-DrXtjM2D.js"),__vite__mapDeps([85,86,87,59,88,89,90,32,27,38,34,30,35,91,92,93,94,95,96,97,46,33,36,37,39,22,23,24,40,41,42,98,99,100,101,76,74,75,77,102,79,29,48,80,103,104,105])),PointCloudWorker:()=>J(()=>import("./PointCloudWorker-Du4Hk8KH.js"),__vite__mapDeps([106,107,64,108,109,110,111,57,112,65,66,67,113,114])),RasterWorker:()=>J(()=>import("./RasterWorker-BP2Loyx8.js"),__vite__mapDeps([115,116,117,118,19,119,120,121,122])),SceneLayerSnappingSourceWorker:()=>J(()=>import("./SceneLayerSnappingSourceWorker-B7_qAxj8.js"),__vite__mapDeps([123,124,125,64,114,65,108,126,113,52,54,55,56,51,53,57,58,59,60])),SceneLayerWorker:()=>J(()=>import("./SceneLayerWorker-ClqCDr7P.js"),__vite__mapDeps([127,62,70,128,68,125,64,114,65,108,129,111,57,130,131,132,133,134,112,107,66,67,113])),WFSSourceWorker:()=>J(()=>import("./WFSSourceWorker-Ck50zAD4.js"),__vite__mapDeps([135,34,30,35,31,32,27,33,36,37,38,39,22,23,24,40,41,42,43,44,45,46,79,29,80,136,137])),WorkerTileHandler:()=>J(()=>import("./WorkerTileHandler-DbNWTtU6.js"),__vite__mapDeps([138,139,140,141,75,95,142,143,59,96])),Lyr3DWorker:()=>J(()=>import("./Lyr3DWorker-CFI1C7AO.js"),[]),Feature3DPipelineWorker:()=>J(()=>import("./Feature3DPipelineWorker-SzJAsaXC.js"),__vite__mapDeps([144,33,34,30,35,36,37,38,32,27,39,22,23,24,40,41,42,65,145,132,69,62,128,68,146,109,147,148,149,150,151,52,56,152,125,64,114,108,124,57,134,133,153,112,107,66,67,113,154,155,156,157,51,53,158,159,160,131,45,76,74,75,77])),TextureCompressionWorker:()=>J(()=>import("./TextureCompressionWorker-Bwoo-IJl.js"),__vite__mapDeps([161,151]))},Wz="worker:port-closed";var Ii;(function(e){e[e.HANDSHAKE=0]="HANDSHAKE",e[e.OPEN=1]="OPEN",e[e.OPENED=2]="OPENED",e[e.RESPONSE=3]="RESPONSE",e[e.INVOKE=4]="INVOKE",e[e.ABORT=5]="ABORT",e[e.CLOSE=6]="CLOSE",e[e.OPEN_PORT=7]="OPEN_PORT",e[e.ON=8]="ON"})(Ii||(Ii={}));let Die=0;function Zz(){return Die++}function Fie(e){return e&&typeof e=="object"&&("result"in e||"transferList"in e)}function Yy(e){return e?typeof e=="string"?JSON.stringify({name:"message",message:e}):e.toJSON?JSON.stringify(e):JSON.stringify({name:e.name,message:e.message,details:e.details||{stack:e.stack}}):null}function NC(e,t,i,r){if(t.type===Ii.OPEN_PORT)return void e.postMessage(t,[t.port]);if(t.type!==Ii.INVOKE&&t.type!==Ii.RESPONSE)return void e.postMessage(t);let s;if(Fie(i)?(s=FA(i.transferList),t.data=i.result):(s=FA(r),t.data=i),s){if(N("ff")){for(const n of s)if("byteLength"in n&&n.byteLength>267386880){const o="Worker call with large ArrayBuffer would crash Firefox";switch(t.type){case Ii.INVOKE:throw o;case Ii.RESPONSE:return void NC(e,{type:Ii.RESPONSE,jobId:t.jobId,error:Yy(o)})}}}e.postMessage(t,s)}else e.postMessage(t)}function Jy(e){if(!e)return null;const t=e.data;return t?typeof t=="string"?JSON.parse(t):t:null}function FA(e){if(!e?.length)return null;if(N("esri-workers-arraybuffer-transfer"))return e;const t=e.filter((i=>!zie(i)));return t.length?t:null}function zie(e){return e instanceof ArrayBuffer||e?.constructor?.name==="ArrayBuffer"}async function nCe(e){try{return await e}catch(t){const i=t?.name===Wz;if(!(Er(t)||i))throw t;return}}const{CLOSE:zA,ABORT:VA,INVOKE:UA,RESPONSE:Df,OPEN_PORT:jA,ON:Vie}=Ii,Uie=2;let jie=class{constructor(t){this._invoke=t,this._timer=null,this._cancelledJobIds=new Set,this._invokeMessages=[],this._timer=null,this._process=this._process.bind(this)}push(t){t.type===Ii.ABORT?this._cancelledJobIds.add(t.jobId):(this._invokeMessages.push(t),this._timer===null&&(this._timer=setTimeout(this._process,0)))}clear(){this._invokeMessages.length=0,this._cancelledJobIds.clear(),this._timer=null}_process(){this._timer=null;for(const t of this._invokeMessages)this._cancelledJobIds.has(t.jobId)||this._invoke(t);this._cancelledJobIds.clear(),this._invokeMessages.length=0}};var As;let Hp=(As=class{static connect(t,i){const r=new MessageChannel;let s;s=typeof t=="function"?new t:"default"in t&&typeof t.default=="function"?new t.default:t;const n=new As(r.port1,{channel:r,client:s,schedule:i});return typeof s=="object"&&"remoteClient"in s&&(s.remoteClient=n),As.clients.set(n,s),r.port2}static loadWorker(t){const i=Nie[t];return i?i():Promise.resolve(null)}constructor(t,i,r,s){this._port=t,this._jobQueue=r,this._lowPriorityJobQueue=s,this._outJobs=new Map,this._inJobs=new Map,this._invokeQueue=new jie((n=>this._onInvokeMessage(n))),this._client=i.client,this._onMessage=this._onMessage.bind(this),this._channel=i.channel,this._schedule=i.schedule,this._port.addEventListener("message",this._onMessage),this._port.start()}close(){this._post({type:zA}),this._close()}isBusy(){return this._outJobs.size>0}invoke(t,i,r){return this.apply(t,[i],r)}apply(t,i,r){const s=r?.signal,n=r?.transferList;if(!this._port)return Promise.reject(new j(Wz,`Cannot call invoke('${t}'), port is closed`,{methodName:t,data:i}));const o=Zz();return new Promise(((a,l)=>{if(js(s))return this._processWork(),void l(yt());const u=kn(s,(()=>{const d=this._outJobs.get(o);d&&(this._outJobs.delete(o),this._processWork(),St(d.abortHandle),this._post({type:VA,jobId:o}),l(yt()))})),c={resolve:a,reject:l,abortHandle:u,debugInfo:t};this._outJobs.set(o,c),this._post({type:UA,jobId:o,methodName:t,abortable:s!=null},i,n)}))}createInvokeProxy(t){return Hz(this,t)}on(t,i){const r=new MessageChannel;function s(n){i(n.data)}return this._port.postMessage({type:Ii.ON,eventType:t,port:r.port2},[r.port2]),r.port1.addEventListener("message",s),r.port1.start(),ze((()=>{r.port1.postMessage({type:Ii.CLOSE}),r.port1.close(),r.port1.removeEventListener("message",s)}))}jobAdded(){this._processWork()}openPort(){const t=new MessageChannel;return this._post({type:jA,port:t.port2}),t.port1}_processWork(){if(this._outJobs.size>=Uie)return;const t=this._jobQueue?.pop()??this._lowPriorityJobQueue?.pop();if(!t)return;const{methodName:i,data:r,invokeOptions:s,resolver:n}=t;this.apply(i,r,s).then((o=>n.resolve(o))).catch((o=>n.reject(o)))}_close(){this._channel&&(this._channel=void 0),this._port.removeEventListener("message",this._onMessage),this._port.close(),this._outJobs.forEach((t=>{St(t.abortHandle),t.reject(yt(`Worker closing, aborting job calling '${t.debugInfo}'`))})),this._inJobs.clear(),this._outJobs.clear(),this._invokeQueue.clear(),this._port=null,this._client=null,this._schedule=null}_onMessage(t){this._schedule!=null?this._schedule((()=>this._processMessage(t,!0))):this._processMessage(t,!1)}_processMessage(t,i){const r=Jy(t);if(r)switch(r.type){case Df:this._onResponseMessage(r);break;case UA:i?this._onInvokeMessage(r):this._invokeQueue.push(r);break;case VA:this._onAbortMessage(r);break;case zA:this._onCloseMessage();break;case jA:this._onOpenPortMessage(r);break;case Vie:this._onOnMessage(r)}}_onAbortMessage(t){const i=this._inJobs,r=t.jobId,s=i.get(r);this._invokeQueue.push(t),s&&(s.controller&&s.controller.abort(),i.delete(r))}_onCloseMessage(){const t=this._client;this._close(),t&&"destroy"in t&&As.clients.get(this)===t&&t.destroy(),As.clients.delete(this),t?.remoteClient&&(t.remoteClient=null)}_onInvokeMessage(t){const{methodName:i,jobId:r,data:s=[],abortable:n}=t,o=n?new AbortController:null,a=this._inJobs;let l,u=this._client,c=u[i];try{if(!c&&i&&i.includes(".")){const d=i.split(".");for(let m=0;m<d.length-1;m++)u=u[d[m]],c=u[d[m+1]]}if(typeof c!="function")throw new TypeError(`${i} is not a function`);s.push({client:this,signal:o?o.signal:null}),l=c.apply(u,s)}catch(d){return void this._post({type:Df,jobId:r,error:Yy(d)})}Bo(l)?(a.set(r,{controller:o,promise:l}),l.then((d=>{a.has(r)&&(a.delete(r),this._post({type:Df,jobId:r},d))}),(d=>{a.has(r)&&(a.delete(r),Er(d)||this._post({type:Df,jobId:r,error:Yy(d||{message:`Error encountered at method ${i}`})}))}))):this._post({type:Df,jobId:r},l)}_onOpenPortMessage(t){new As(t.port,{client:this._client})}_onOnMessage(t){const{port:i}=t,r=this._client.on(t.eventType,(n=>{i.postMessage(n)})),s=lf(t.port,"message",(n=>{Jy(n)?.type===Ii.CLOSE&&(s.remove(),r.remove(),i.close())}))}_onResponseMessage(t){const{jobId:i,error:r,data:s}=t,n=this._outJobs;if(!n.has(i))return;const o=n.get(i);n.delete(i),this._processWork(),St(o.abortHandle),r?o.reject(j.fromJSON(JSON.parse(r))):o.resolve(s)}_post(t,i,r){return NC(this._port,t,i,r)}},As.kernelInfo={buildDate:uD,fullVersion:IE,revision:cD},As.clients=new Map,As),Gie=class{constructor(){this._inUseClients=new Array,this._clients=new Array,this._clientPromises=new Array,this._ongoingJobsQueue=new Zy,this._ongoingLowPriorityJobsQueue=new Zy}destroy(){this.close()}get closed(){return!this._clients?.length}open(t,i){return new Promise(((r,s)=>{let n=!0;const o=a=>{It(i.signal),n&&(n=!1,a())};this._clients.length=t.length,this._clientPromises.length=t.length,this._inUseClients.length=t.length;for(let a=0;a<t.length;++a){const l=t[a];Bo(l)?this._clientPromises[a]=l.then((u=>(this._clients[a]=new Hp(u,i,this._ongoingJobsQueue,this._ongoingLowPriorityJobsQueue),o(r),this._clients[a])),(()=>(o(s),null))):(this._clients[a]=new Hp(l,i,this._ongoingJobsQueue,this._ongoingLowPriorityJobsQueue),this._clientPromises[a]=Promise.resolve(this._clients[a]),o(r))}}))}broadcast(t,i,r){const s=new Array(this._clientPromises.length);for(let n=0;n<this._clientPromises.length;++n){const o=this._clientPromises[n];s[n]=o.then((a=>a?.invoke(t,i,r)))}return s}close(){let t;for(;t=this._ongoingJobsQueue.pop();)t.resolver.reject(yt(`Worker closing, aborting job calling '${t.methodName}'`));for(;t=this._ongoingLowPriorityJobsQueue.pop();)t.resolver.reject(yt(`Worker closing, aborting job calling '${t.methodName}'`));for(const i of this._clientPromises)i.then((r=>r?.close()));this._clients.length=0,this._clientPromises.length=0,this._inUseClients.length=0,Rie(this)}invoke(t,i,r){return this.apply(t,[i],r)}apply(t,i,r){const s=Gs();(r?.priority==="low"?this._ongoingLowPriorityJobsQueue:this._ongoingJobsQueue).push({methodName:t,data:i,invokeOptions:r,resolver:s});for(let n=0;n<this._clientPromises.length;n++){const o=this._clients[n];o?o.jobAdded():this._clientPromises[n].then((a=>a?.jobAdded()))}return s.promise}createInvokeProxy(t){return Hz(this,t)}on(t,i){return Promise.all(this._clientPromises).then((()=>gh(this._clients.map((r=>r.on(t,i))))))}openPorts(){return new Promise((t=>{const i=new Array(this._clientPromises.length);let r=i.length;for(let s=0;s<this._clientPromises.length;++s)this._clientPromises[s].then((n=>{n&&(i[s]=n.openPort()),--r===0&&t(i)}))}))}get test(){}};const Bie={async request(e,t){const i=e.options,r=i.responseType;i.signal=t?.signal,i.responseType=r==="native"||r==="native-request-init"?"native-request-init":r&&["blob","json","text"].includes(r)&&IS(e.url)?.after?r:"array-buffer";const s=await at(e.url,i),n={data:s.data,httpStatus:s.httpStatus,ssl:s.ssl};switch(s.requestOptions?.responseType){case"native-request-init":return delete n.data.signal,n;case"blob":n.data=await n.data.arrayBuffer();break;case"json":n.data=new TextEncoder().encode(JSON.stringify(n.data)).buffer;break;case"text":n.data=new TextEncoder().encode(n.data).buffer}return{result:n,transferList:[n.data]}}},GA={};function qie(e){const t={async:e.async,isDebug:e.isDebug,locale:e.locale,baseUrl:e.baseUrl,has:{...e.has},map:{...e.map},packages:e.packages?.slice()||[],paths:{...GA.paths,...e.paths}};return e.hasOwnProperty("async")||(t.async=!0),e.hasOwnProperty("isDebug")||(t.isDebug=!1),e.baseUrl||(t.baseUrl=GA.baseUrl),t}let Hie=class{constructor(){const t=document.createDocumentFragment();["addEventListener","dispatchEvent","removeEventListener"].forEach((i=>{this[i]=(...r)=>t[i](...r)}))}},B_=class{constructor(){this._dispatcher=new Hie,this._workerPostMessage({type:Ii.HANDSHAKE})}terminate(){}get onmessage(){return this._onmessageHandler}set onmessage(t){this._onmessageHandler&&this.removeEventListener("message",this._onmessageHandler),this._onmessageHandler=t,t&&this.addEventListener("message",t)}get onmessageerror(){return this._onmessageerrorHandler}set onmessageerror(t){this._onmessageerrorHandler&&this.removeEventListener("messageerror",this._onmessageerrorHandler),this._onmessageerrorHandler=t,t&&this.addEventListener("messageerror",t)}get onerror(){return this._onerrorHandler}set onerror(t){this._onerrorHandler&&this.removeEventListener("error",this._onerrorHandler),this._onerrorHandler=t,t&&this.addEventListener("error",t)}postMessage(t){Y1((()=>{this._workerMessageHandler(new MessageEvent("message",{data:t}))}))}dispatchEvent(t){return this._dispatcher.dispatchEvent(t)}addEventListener(t,i,r){this._dispatcher.addEventListener(t,i,r)}removeEventListener(t,i,r){this._dispatcher.removeEventListener(t,i,r)}_workerPostMessage(t){Y1((()=>{this.dispatchEvent(new MessageEvent("message",{data:t}))}))}async _workerMessageHandler(t){const i=Jy(t);if(i&&i.type===Ii.OPEN){const{modulePath:r,jobId:s}=i;let n=await Hp.loadWorker(r);n||(n=await import(r));const o=Hp.connect(n);this._workerPostMessage({type:Ii.OPENED,jobId:s,data:o})}}};const Wx=()=>H.getLogger("esri.core.workers.workerFactory"),{HANDSHAKE:Wie}=Ii,Zie='let globalId=0;const outgoing=new Map,configuration={CONFIGURATION};self.esriConfig=configuration.esriConfig;const workerPath=self.esriConfig.workers.workerPath,HANDSHAKE=0,OPEN=1,OPENED=2,RESPONSE=3,INVOKE=4,ABORT=5;function createAbortError(){const e=new Error("Aborted");return e.name="AbortError",e}function receiveMessage(e){return e&&e.data?"string"==typeof e.data?JSON.parse(e.data):e.data:null}function invokeStaticMessage(e,o,r){const t=r&&r.signal,n=globalId++;let s=null;return new Promise(((r,i)=>{if(t){if(t.aborted)return i(createAbortError());s=()=>{outgoing.get(n)&&(outgoing.delete(n),self.postMessage({type:5,jobId:n}),i(createAbortError()))},t.addEventListener("abort",s)}outgoing.set(n,{resolve:r,reject:i}),self.postMessage({type:4,jobId:n,methodName:e,abortable:null!=t,data:o})})).finally((()=>{t&&t.removeEventListener("abort",s)}))}let workerRevisionChecked=!1;function checkWorkerRevision(e){if(!workerRevisionChecked&&e.kernelInfo){workerRevisionChecked=!0;const{revision:o,fullVersion:r}=configuration.kernelInfo,{revision:t,fullVersion:n,version:s}=e.kernelInfo;esriConfig.assetsPath!==esriConfig.defaultAssetsPath&&o!==t&&console.warn(`Version mismatch detected between ArcGIS Maps SDK for JavaScript modules and assets. For more information visit https://bit.ly/3QnsuSo.\nModules version: ${r}\nAssets version: ${n??s}\nAssets path: ${esriConfig.assetsPath}`)}}function messageHandler(e){const o=receiveMessage(e);if(!o)return;const r=o.jobId;switch(o.type){case 1:let n;function t(e){const o=n.connect(e);self.postMessage({type:2,jobId:r,data:o},[o])}"function"==typeof define&&define.amd?require([workerPath],(e=>{n=e.default||e,checkWorkerRevision(n),n.loadWorker(o.modulePath).then((e=>e||new Promise((e=>{require([o.modulePath],e)})))).then(t)})):"System"in self&&"function"==typeof System.import?System.import(workerPath).then((e=>(n=e.default,checkWorkerRevision(n),n.loadWorker(o.modulePath)))).then((e=>e||System.import(o.modulePath))).then(t):esriConfig.workers.useDynamicImport?import(workerPath).then((e=>{n=e.default||e,checkWorkerRevision(n),n.loadWorker(o.modulePath).then((e=>e||import(o.modulePath))).then(t)})):(self.RemoteClient||importScripts(workerPath),n=self.RemoteClient.default||self.RemoteClient,checkWorkerRevision(n),n.loadWorker(o.modulePath).then(t));break;case 3:if(outgoing.has(r)){const s=outgoing.get(r);outgoing.delete(r),o.error?s.reject(JSON.parse(o.error)):s.resolve(o.data)}}}self.dojoConfig=configuration.loaderConfig,esriConfig.workers.loaderUrl&&(self.importScripts(esriConfig.workers.loaderUrl),"function"==typeof require&&"function"==typeof require.config&&require.config(configuration.loaderConfig)),self.addEventListener("message",messageHandler),self.postMessage({type:0});';let E0,C0;const BA="Failed to create Worker. Fallback to execute module in main thread";async function Yie(){if(!N("esri-workers"))return qA(new B_);if(!E0&&!C0)try{const t=Zie.split("{CONFIGURATION}").join(Jie());E0=URL.createObjectURL(new Blob([t],{type:"text/javascript"}))}catch(t){C0=t||{}}let e;if(E0)try{e=new Worker(E0,{name:"esri-worker-"+Xie++})}catch{Wx().warn(BA,C0),e=new B_}else Wx().warn(BA,C0),e=new B_;return qA(e)}async function qA(e){return new Promise((t=>{function i(s){const n=Jy(s);n&&n.type===Wie&&(e.removeEventListener("message",i),e.removeEventListener("error",r),t(e))}function r(s){s.preventDefault(),e.removeEventListener("message",i),e.removeEventListener("error",r),Wx().warn("Failed to create Worker. Fallback to execute module in main thread",s),(e=new B_).addEventListener("message",i),e.addEventListener("error",r)}e.addEventListener("message",i),e.addEventListener("error",r)}))}function Jie(){let e;if(Fe.default!=null){const s={...Fe};delete s.default,e=JSON.parse(JSON.stringify(s))}else e=JSON.parse(JSON.stringify(Fe));e.assetsPath=ks(e.assetsPath),e.defaultAssetsPath=e.defaultAssetsPath?ks(e.defaultAssetsPath):void 0,e.request.interceptors=[],e.log.interceptors=[],e.locale=Hr(),e.has={"esri-csp-restrictions":N("esri-csp-restrictions"),"esri-2d-debug":!1,"esri-2d-update-debug":N("esri-2d-update-debug"),"esri-2d-log-updating":N("esri-2d-log-updating"),"featurelayer-pbf":N("featurelayer-pbf"),"featurelayer-fast-triangulation-enabled":N("featurelayer-fast-triangulation-enabled"),"featurelayer-simplify-thresholds":N("featurelayer-simplify-thresholds"),"featurelayer-simplify-payload-size-factors":N("featurelayer-simplify-payload-size-factors"),"featurelayer-simplify-mobile-factor":N("featurelayer-simplify-mobile-factor"),"featurelayer-query-max-depth":N("featurelayer-query-max-depth"),"featurelayer-query-tile-max-features":N("featurelayer-query-tile-max-features"),"featurelayer-query-tile-concurrency":N("featurelayer-query-tile-concurrency"),"featurelayer-query-pausing-enabled":N("featurelayer-query-pausing-enabled"),"featurelayer-snapshot-concurrency":N("featurelayer-snapshot-concurrency"),"featurelayer-snapshot-enabled":N("featurelayer-snapshot-enabled"),"esri-atomics":N("esri-atomics"),"esri-shared-array-buffer":N("esri-shared-array-buffer"),"esri-tiles-debug":N("esri-tiles-debug"),"esri-workers-arraybuffer-transfer":N("esri-workers-arraybuffer-transfer"),"feature-polyline-generalization-factor":N("feature-polyline-generalization-factor"),"host-webworker":1},e.workers.loaderUrl&&(e.workers.loaderUrl=ks(e.workers.loaderUrl)),e.workers.workerPath?e.workers.workerPath=ks(e.workers.workerPath):e.workers.workerPath=ks(vt("esri/core/workers/RemoteClient.js")),e.workers.useDynamicImport=!1;const t=Fe.workers.loaderConfig,i=qie({baseUrl:t?.baseUrl,locale:Hr(),has:{"csp-restrictions":1,"dojo-test-sniff":0,"host-webworker":1,...t?.has},map:{...t?.map},paths:{...t?.paths},packages:t?.packages||[]});return JSON.stringify({esriConfig:e,loaderConfig:i,kernelInfo:{buildDate:uD,fullVersion:IE,revision:cD}})}let Xie=0;const{ABORT:HA,INVOKE:Kie,OPEN:Qie,OPENED:ere,RESPONSE:Ff}=Ii;let tre=class Yz{static async create(t){const i=await Yie();return new Yz(i,t)}constructor(t,i){this._outJobs=new Map,this._inJobs=new Map,this.worker=t,this.id=i,t.addEventListener("message",this._onMessage.bind(this)),t.addEventListener("error",(r=>{r.preventDefault(),H.getLogger("esri.core.workers.WorkerOwner").error(r)}))}terminate(){this.worker.terminate()}async open(t,i={}){const{signal:r}=i,s=Zz();return new Promise(((n,o)=>{const a={resolve:n,reject:o,abortHandle:LE(r,(()=>{this._outJobs.delete(s),this._post({type:HA,jobId:s})}))};this._outJobs.set(s,a),this._post({type:Qie,jobId:s,modulePath:t})}))}_onMessage(t){const i=Jy(t);if(i)switch(i.type){case ere:this._onOpenedMessage(i);break;case Ff:this._onResponseMessage(i);break;case HA:this._onAbortMessage(i);break;case Kie:this._onInvokeMessage(i)}}_onAbortMessage(t){const i=this._inJobs,r=t.jobId,s=i.get(r);s&&(s.controller&&s.controller.abort(),i.delete(r))}_onInvokeMessage(t){const{methodName:i,jobId:r,data:s,abortable:n}=t,o=n?new AbortController:null,a=this._inJobs,l=Bie[i];let u;try{if(typeof l!="function")throw new TypeError(`${i} is not a function`);u=l.call(null,s,{signal:o?o.signal:null})}catch(c){return void this._post({type:Ff,jobId:r,error:Yy(c)})}Bo(u)?(a.set(r,{controller:o,promise:u}),u.then((c=>{a.has(r)&&(a.delete(r),this._post({type:Ff,jobId:r},c))}),(c=>{a.has(r)&&(a.delete(r),c||(c={message:"Error encountered at method"+i}),Er(c)||this._post({type:Ff,jobId:r,error:Yy(c||{message:`Error encountered at method ${i}`})}))}))):this._post({type:Ff,jobId:r},u)}_onOpenedMessage(t){const{jobId:i,data:r}=t,s=this._outJobs.get(i);s&&(this._outJobs.delete(i),St(s.abortHandle),s.resolve(r))}_onResponseMessage(t){const{jobId:i,error:r,data:s}=t,n=this._outJobs.get(i);n&&(this._outJobs.delete(i),St(n.abortHandle),r?n.reject(j.fromJSON(JSON.parse(r))):n.resolve(s))}_post(t,i,r){return NC(this.worker,t,i,r)}};const WA=N("host-browser")?Math.min(navigator.hardwareConcurrency-1,N("workers-pool-size")??8):0;let Ac=N("esri-mobile")?Math.min(WA,3):WA;Ac||(Ac=N("safari")&&N("mac")?7:2);let ZA=0;const q_=[];function ire(){Jz()}async function P0(e,t){const i=new Gie,{registryTarget:r,...s}=t;return await i.open(e,s),r&&kie(r,i),i}async function cCe(e,t={}){if(typeof e!="string")throw new j("workers:undefined-module","modulePath is missing");let i=t.strategy||"distributed";if(N("host-webworker")&&!N("esri-workers")&&(i="local"),i==="local"){let r=await Hp.loadWorker(e);r||(r=await import(e)),It(t.signal);const s=t.client||r;return P0([Hp.connect(r,t.schedule)],{...t,client:s})}if(await Jz(),It(t.signal),i==="dedicated"){const r=ZA++%Ac;return P0([await q_[r].open(e,t)],t)}if(t.maxNumWorkers&&t.maxNumWorkers>0){const r=Math.min(t.maxNumWorkers,Ac);if(r<Ac){const s=new Array(r);for(let n=0;n<r;++n){const o=ZA++%Ac;s[n]=q_[o].open(e,t)}return P0(s,t)}}return P0(q_.map((r=>r.open(e,t))),t)}let I0=null;async function Jz(){if(I0)return I0;new AbortController;const e=[];for(let t=0;t<Ac;t++){const i=tre.create(t).then((r=>(q_[t]=r,r)));e.push(i)}return I0=Promise.all(e),I0}var Zx,hp;let zi=(hp=class extends ee{constructor(t){super(t),this.cols=null,this.level=0,this.levelValue=null,this.origin=null,this.resolution=0,this.rows=null,this.scale=0}clone(){return new Zx({cols:this.cols,level:this.level,levelValue:this.levelValue,resolution:this.resolution,rows:this.rows,scale:this.scale})}},Zx=hp,hp);h([f({json:{write:!0,origins:{"web-document":{read:!1,write:!1},"portal-item":{read:!1,write:!1}}}})],zi.prototype,"cols",void 0),h([f({type:Ue,json:{write:!0}})],zi.prototype,"level",void 0),h([f({type:String,json:{write:!0}})],zi.prototype,"levelValue",void 0),h([f({json:{write:!0,origins:{"web-document":{read:!1,write:!1},"portal-item":{read:!1,write:!1}}}})],zi.prototype,"origin",void 0),h([f({type:Number,json:{write:!0}})],zi.prototype,"resolution",void 0),h([f({json:{write:!0,origins:{"web-document":{read:!1,write:!1},"portal-item":{read:!1,write:!1}}}})],zi.prototype,"rows",void 0),h([f({type:Number,json:{write:!0}})],zi.prototype,"scale",void 0),zi=Zx=h([I("esri.layers.support.LOD")],zi);let rre=class{constructor(t,i,r,s,n=void 0){this.id=t,this.level=i,this.row=r,this.col=s,this.extent=n}};var vl;const YA=new Ye({PNG:"png",PNG8:"png8",PNG24:"png24",PNG32:"png32",JPEG:"jpg",JPG:"jpg",DIB:"dib",TIFF:"tiff",EMF:"emf",PS:"ps",PDF:"pdf",GIF:"gif",SVG:"svg",SVGZ:"svgz",Mixed:"mixed",MIXED:"mixed",LERC:"lerc",LERC2D:"lerc2d",RAW:"raw",pbf:"pbf"});var dp;let Ri=(dp=class extends ee{static create(t={}){const{resolutionFactor:i=1,scales:r,size:s=256,spatialReference:n=ae.WebMercator,numLODs:o=24}=t;if(!jr(n)){const m=[];if(r)for(let y=0;y<r.length;y++){const g=r[y];m.push(new zi({level:y,scale:g,resolution:g}))}else{let y=5e-4;for(let g=o-1;g>=0;g--)m.unshift(new zi({level:g,scale:y,resolution:y})),y*=2}return new vl({dpi:96,lods:m,origin:new he(0,0,n),size:[s,s],spatialReference:n})}const a=ar(n),l=t.origin?new he({x:t.origin.x,y:t.origin.y,spatialReference:n}):new he(a?{x:a.origin[0],y:a.origin[1],spatialReference:n}:{x:0,y:0,spatialReference:n}),u=96,c=1/(Hs(n)*39.37*u),d=[];if(r)for(let m=0;m<r.length;m++){const y=r[m],g=y*c;d.push(new zi({level:m,scale:y,resolution:g}))}else{let m=vh(n)?512/s*5916575275917094e-7:256/s*591657527591555e-6;const y=Math.ceil(o/i);d.push(new zi({level:0,scale:m,resolution:m*c}));for(let g=1;g<y;g++){const _=m/2**i,v=_*c;d.push(new zi({level:g,scale:_,resolution:v})),m=_}}return new vl({dpi:u,lods:d,origin:l,size:[s,s],spatialReference:n})}constructor(t){super(t),this.dpi=96,this.format=null,this.origin=null,this.size=null,this.spatialReference=null}get isWrappable(){const{spatialReference:t,origin:i}=this;if(t&&i){const r=ar(t);return t.isWrappable&&!!r&&Math.abs(r.origin[0]-i.x)<=r.dx}return!1}readOrigin(t,i){return he.fromJSON({spatialReference:i.spatialReference,...t})}set lods(t){let i=0,r=0;const s=[],n=this._levelToLOD={};t&&(i=-1/0,r=1/0,t.forEach((o=>{s.push(o.scale),i=o.scale>i?o.scale:i,r=o.scale<r?o.scale:r,n[o.level]=o}))),this._set("scales",s),this._set("lods",t),this._initializeUpsampleLevels()}readSize(t,i){return[i.cols,i.rows]}writeSize(t,i){i.cols=t[0],i.rows=t[1]}zoomToScale(t){const i=this.scales;if(t<=0)return i[0];if(t>=i.length-1)return i[i.length-1];const r=Math.floor(t),s=r+1;return i[r]/(i[r]/i[s])**(t-r)}scaleToZoom(t){const i=this.scales,r=i.length-1;let s=0;for(;s<r;s++){const n=i[s],o=i[s+1];if(n<=t)return s;if(o===t)return s+1;if(n>t&&o<t)return s+Math.log(n/t)/Math.log(n/o)}return s}tileAt(t,i,r,s){const n=this.lodAt(t);if(!n)return null;let o,a;if(typeof i=="number")o=i,a=r;else if(ci(i.spatialReference,this.spatialReference))o=i.x,a=i.y,s=r;else{const c=Vb(i,this.spatialReference);if(c==null)return null;o=c.x,a=c.y,s=r}const l=n.resolution*this.size[0],u=n.resolution*this.size[1];return s||(s=new rre(null,0,0,0,Qt())),s.level=t,s.row=Math.floor((this.origin.y-a)/u+.001),s.col=Math.floor((o-this.origin.x)/l+.001),this.updateTileInfo(s),s}updateTileInfo(t,i=vl.ExtrapolateOptions.NONE){let r=this.lodAt(t.level);if(!r&&i===vl.ExtrapolateOptions.POWER_OF_TWO){const a=this.lods[this.lods.length-1];a.level<t.level&&(r=a)}if(!r)return;const s=t.level-r.level,n=r.resolution*this.size[0]/2**s,o=r.resolution*this.size[1]/2**s;t.id=`${t.level}/${t.row}/${t.col}`,t.extent||(t.extent=Qt()),t.extent[0]=this.origin.x+t.col*n,t.extent[1]=this.origin.y-(t.row+1)*o,t.extent[2]=t.extent[0]+n,t.extent[3]=t.extent[1]+o}upsampleTile(t){const i=this._upsampleLevels[t.level];return!(!i||i.parentLevel===-1)&&(t.level=i.parentLevel,t.row=Math.floor(t.row/i.factor+.001),t.col=Math.floor(t.col/i.factor+.001),this.updateTileInfo(t),!0)}getTileBounds(t,i){const r=this.lodAt(i.level);if(r==null)return null;const{resolution:s}=r,n=s*this.size[0],o=s*this.size[1];return t[0]=this.origin.x+i.col*n,t[1]=this.origin.y-(i.row+1)*o,t[2]=t[0]+n,t[3]=t[1]+o,t}lodAt(t){return this._levelToLOD?.[t]??null}clone(){return vl.fromJSON(this.write({}))}getCompatibleForVTL(t){if(this.size[0]!==this.size[1]||this.size[0]===256&&t===512)return null;const i=(this.size[0]===512&&t===256?-1:0)+(this.spatialReference.isGeographic?1:0);if(this.size[0]===t&&i===0)return this;const r=[],s=this.lods.length-i;for(let n=0;n<s;n++){const o=n+i,{scale:a,resolution:l}=o>=0?this.lods[o]:{scale:2*this.lods[0].scale,resolution:2*this.lods[0].resolution};r.push(new zi({level:n,scale:a,resolution:l}))}return new vl({size:[t,t],dpi:this.dpi,format:this.format,compressionQuality:this.compressionQuality,origin:this.origin,spatialReference:this.spatialReference,lods:r})}_initializeUpsampleLevels(){const t=this.lods;this._upsampleLevels=[];let i=null;for(let r=0;r<t.length;r++){const s=t[r];this._upsampleLevels[s.level]={parentLevel:i?i.level:-1,factor:i?i.resolution/s.resolution:0},i=s}}},vl=dp,dp);h([f({type:Number,json:{write:!0}})],Ri.prototype,"compressionQuality",void 0),h([f({type:Number,json:{write:!0}})],Ri.prototype,"dpi",void 0),h([f({type:String,json:{read:YA.read,write:YA.write,origins:{"web-scene":{read:!1,write:!1}}}})],Ri.prototype,"format",void 0),h([f({readOnly:!0})],Ri.prototype,"isWrappable",null),h([f({type:he,json:{write:!0}})],Ri.prototype,"origin",void 0),h([Ae("origin")],Ri.prototype,"readOrigin",null),h([f({type:[zi],value:null,json:{write:!0}})],Ri.prototype,"lods",null),h([f({readOnly:!0})],Ri.prototype,"scales",void 0),h([f({cast:e=>Array.isArray(e)?e:typeof e=="number"?[e,e]:[256,256]})],Ri.prototype,"size",void 0),h([Ae("size",["rows","cols"])],Ri.prototype,"readSize",null),h([$e("size",{cols:{type:Ue},rows:{type:Ue}})],Ri.prototype,"writeSize",null),h([f({type:ae,json:{write:!0}})],Ri.prototype,"spatialReference",void 0),Ri=vl=h([I("esri.layers.support.TileInfo")],Ri),(function(e){var t;(t=e.ExtrapolateOptions||(e.ExtrapolateOptions={}))[t.NONE=0]="NONE",t[t.POWER_OF_TWO=1]="POWER_OF_TWO"})(Ri||(Ri={}));const H_={widthBreakpoint:{getValue(e){const t=e.viewSize[0],i=e.breakpoints,r=this.values;return t<=i.xsmall?r.xsmall:t<=i.small?r.small:t<=i.medium?r.medium:t<=i.large?r.large:r.xlarge},values:{xsmall:"xsmall",small:"small",medium:"medium",large:"large",xlarge:"xlarge"},valueToClassName:{xsmall:"esri-view-width-xsmall esri-view-width-less-than-small esri-view-width-less-than-medium esri-view-width-less-than-large esri-view-width-less-than-xlarge",small:"esri-view-width-small esri-view-width-greater-than-xsmall esri-view-width-less-than-medium esri-view-width-less-than-large esri-view-width-less-than-xlarge",medium:"esri-view-width-medium esri-view-width-greater-than-xsmall esri-view-width-greater-than-small esri-view-width-less-than-large esri-view-width-less-than-xlarge",large:"esri-view-width-large esri-view-width-greater-than-xsmall esri-view-width-greater-than-small esri-view-width-greater-than-medium esri-view-width-less-than-xlarge",xlarge:"esri-view-width-xlarge esri-view-width-greater-than-xsmall esri-view-width-greater-than-small esri-view-width-greater-than-medium esri-view-width-greater-than-large"}},heightBreakpoint:{getValue(e){const t=e.viewSize[1],i=e.breakpoints,r=this.values;return t<=i.xsmall?r.xsmall:t<=i.small?r.small:t<=i.medium?r.medium:t<=i.large?r.large:r.xlarge},values:{xsmall:"xsmall",small:"small",medium:"medium",large:"large",xlarge:"xlarge"},valueToClassName:{xsmall:"esri-view-height-xsmall esri-view-height-less-than-small esri-view-height-less-than-medium esri-view-height-less-than-large esri-view-height-less-than-xlarge",small:"esri-view-height-small esri-view-height-greater-than-xsmall esri-view-height-less-than-medium esri-view-height-less-than-large esri-view-height-less-than-xlarge",medium:"esri-view-height-medium esri-view-height-greater-than-xsmall esri-view-height-greater-than-small esri-view-height-less-than-large esri-view-height-less-than-xlarge",large:"esri-view-height-large esri-view-height-greater-than-xsmall esri-view-height-greater-than-small esri-view-height-greater-than-medium esri-view-height-less-than-xlarge",xlarge:"esri-view-height-xlarge esri-view-height-greater-than-xsmall esri-view-height-greater-than-small esri-view-height-greater-than-medium esri-view-height-greater-than-large"}},orientation:{getValue(e){const t=e.viewSize,i=t[0],r=t[1],s=this.values;return r>=i?s.portrait:s.landscape},values:{portrait:"portrait",landscape:"landscape"},valueToClassName:{portrait:"esri-view-orientation-portrait",landscape:"esri-view-orientation-landscape"}}},v2={xsmall:544,small:768,medium:992,large:1200};function sre(e){const t=e;return t&&t.xsmall<t.small&&t.small<t.medium&&t.medium<t.large}function b2(e,t){return t?H_[e].valueToClassName[t].split(" "):[]}const nre=e=>{let t=class extends e{constructor(...i){super(...i),this.orientation=null,this.widthBreakpoint=null,this.heightBreakpoint=null,this.breakpoints=v2}initialize(){this.addHandles(te((()=>[this.breakpoints,this.size]),(()=>this._updateClassNames()),Pt))}destroy(){this.destroyed||this._removeActiveClassNames()}set breakpoints(i){if(i!==this._get("breakpoints")){if(!sre(i)){const r=JSON.stringify(v2,null,2);console.warn("provided breakpoints are not valid, using defaults:"+r),i=v2}this._set("breakpoints",{...i})}}_updateClassNames(){if(!this.container)return;const i=Sr.acquire(),r=Sr.acquire();let s,n=!1;for(s in H_){const o=this[s],a=H_[s].getValue({viewSize:this.size,breakpoints:this.breakpoints});o!==a&&(n=!0,this[s]=a,b2(s,o).forEach((l=>r.push(l))),b2(s,a).forEach((l=>i.push(l))))}n&&(this._applyClassNameChanges(i,r),Sr.release(i),Sr.release(r))}_applyClassNameChanges(i,r){const s=this.container;s&&(r.forEach((n=>s.classList.remove(n))),i.forEach((n=>s.classList.add(n))))}_removeActiveClassNames(){const i=this.container;if(!i)return;let r;for(r in H_)b2(r,this[r]).forEach((s=>i.classList.remove(s)))}};return h([f()],t.prototype,"breakpoints",null),h([f()],t.prototype,"orientation",void 0),h([f()],t.prototype,"widthBreakpoint",void 0),h([f()],t.prototype,"heightBreakpoint",void 0),t=h([I("esri.views.BreakpointsOwner")],t),t};function DC(e){return typeof e=="string"?document.getElementById(e):e??null}function JA(e,t){for(;;){const i=e.firstChild;if(!i)break;t.appendChild(i)}}let Bc=class extends le{constructor(){super(...arguments),this.updating=!1,this._handleId=0,this._scheduleHandleId=0,this._pendingPromises=new Set}destroy(){this.removeAll()}add(t,i,r={}){return this._installWatch(t,i,r,te)}addWhen(t,i,r={}){return this._installWatch(t,i,r,Yr)}addOnCollectionChange(t,i,{initial:r=!1,final:s=!1}={}){const n=++this._handleId;return this.addHandles([In(t,"after-changes",this._createSyncUpdatingCallback(),yu),In(t,"change",i,{onListenerAdd:r?o=>i({added:o.toArray(),removed:[]}):void 0,onListenerRemove:s?o=>i({added:[],removed:o.toArray()}):void 0})],n),ze((()=>this.removeHandles(n)))}addPromise(t){if(t==null)return t;const i=++this._handleId;this.addHandles(ze((()=>{this._pendingPromises.delete(t)&&(this._pendingPromises.size!==0||this.hasHandles(A0)||this._set("updating",!1))})),i),this._pendingPromises.add(t),this._set("updating",!0);const r=()=>this.removeHandles(i);return t.then(r,r),t}removeAll(){this._pendingPromises.clear(),this.removeAllHandles(),this._set("updating",!1)}_installWatch(t,i,r={},s){const n=++this._handleId;r.sync||this._installSyncUpdatingWatch(t,n);const o=s(t,i,r);return this.addHandles(o,n),ze((()=>this.removeHandles(n)))}_installSyncUpdatingWatch(t,i){const r=this._createSyncUpdatingCallback(),s=te(t,r,{sync:!0,equals:()=>!1});return this.addHandles(s,i),s}_createSyncUpdatingCallback(){return()=>{this.removeHandles(A0),++this._scheduleHandleId;const t=this._scheduleHandleId;this._get("updating")||this._set("updating",!0),this.addHandles(Lg((()=>{t===this._scheduleHandleId&&(this._set("updating",this._pendingPromises.size>0),this.removeHandles(A0))})),A0)}}};h([f({readOnly:!0})],Bc.prototype,"updating",void 0),Bc=h([I("esri.core.support.UpdatingHandles")],Bc);const A0=-42;/*!
 * @esri/arcgis-html-sanitizer - v4.1.0 - Tue Dec 03 2024 09:13:28 GMT-0500 (Eastern Standard Time)
 * Copyright (c) 2024 - Environmental Systems Research Institute, Inc.
 * Apache-2.0
 * 
 * js-xss
 * Copyright (c) 2012-2018 Zongmin Lei() <leizongmin@gmail.com>
 * http://ucdok.com
 * MIT License, see https://github.com/leizongmin/js-xss/blob/master/LICENSE for details
 *//*! *****************************************************************************
Copyright (c) Microsoft Corporation.

Permission to use, copy, modify, and/or distribute this software for any
purpose with or without fee is hereby granted.

THE SOFTWARE IS PROVIDED "AS IS" AND THE AUTHOR DISCLAIMS ALL WARRANTIES WITH
REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF MERCHANTABILITY
AND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY SPECIAL, DIRECT,
INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES WHATSOEVER RESULTING FROM
LOSS OF USE, DATA OR PROFITS, WHETHER IN AN ACTION OF CONTRACT, NEGLIGENCE OR
OTHER TORTIOUS ACTION, ARISING OUT OF OR IN CONNECTION WITH THE USE OR
PERFORMANCE OF THIS SOFTWARE.
***************************************************************************** */var wv=function(){return wv=Object.assign||function(t){for(var i,r=1,s=arguments.length;r<s;r++){i=arguments[r];for(var n in i)Object.prototype.hasOwnProperty.call(i,n)&&(t[n]=i[n])}return t},wv.apply(this,arguments)},Yx={exports:{}},Vt={},Jx={exports:{}},$h={};function Xz(){var e={};return e["align-content"]=!1,e["align-items"]=!1,e["align-self"]=!1,e["alignment-adjust"]=!1,e["alignment-baseline"]=!1,e.all=!1,e["anchor-point"]=!1,e.animation=!1,e["animation-delay"]=!1,e["animation-direction"]=!1,e["animation-duration"]=!1,e["animation-fill-mode"]=!1,e["animation-iteration-count"]=!1,e["animation-name"]=!1,e["animation-play-state"]=!1,e["animation-timing-function"]=!1,e.azimuth=!1,e["backface-visibility"]=!1,e.background=!0,e["background-attachment"]=!0,e["background-clip"]=!0,e["background-color"]=!0,e["background-image"]=!0,e["background-origin"]=!0,e["background-position"]=!0,e["background-repeat"]=!0,e["background-size"]=!0,e["baseline-shift"]=!1,e.binding=!1,e.bleed=!1,e["bookmark-label"]=!1,e["bookmark-level"]=!1,e["bookmark-state"]=!1,e.border=!0,e["border-bottom"]=!0,e["border-bottom-color"]=!0,e["border-bottom-left-radius"]=!0,e["border-bottom-right-radius"]=!0,e["border-bottom-style"]=!0,e["border-bottom-width"]=!0,e["border-collapse"]=!0,e["border-color"]=!0,e["border-image"]=!0,e["border-image-outset"]=!0,e["border-image-repeat"]=!0,e["border-image-slice"]=!0,e["border-image-source"]=!0,e["border-image-width"]=!0,e["border-left"]=!0,e["border-left-color"]=!0,e["border-left-style"]=!0,e["border-left-width"]=!0,e["border-radius"]=!0,e["border-right"]=!0,e["border-right-color"]=!0,e["border-right-style"]=!0,e["border-right-width"]=!0,e["border-spacing"]=!0,e["border-style"]=!0,e["border-top"]=!0,e["border-top-color"]=!0,e["border-top-left-radius"]=!0,e["border-top-right-radius"]=!0,e["border-top-style"]=!0,e["border-top-width"]=!0,e["border-width"]=!0,e.bottom=!1,e["box-decoration-break"]=!0,e["box-shadow"]=!0,e["box-sizing"]=!0,e["box-snap"]=!0,e["box-suppress"]=!0,e["break-after"]=!0,e["break-before"]=!0,e["break-inside"]=!0,e["caption-side"]=!1,e.chains=!1,e.clear=!0,e.clip=!1,e["clip-path"]=!1,e["clip-rule"]=!1,e.color=!0,e["color-interpolation-filters"]=!0,e["column-count"]=!1,e["column-fill"]=!1,e["column-gap"]=!1,e["column-rule"]=!1,e["column-rule-color"]=!1,e["column-rule-style"]=!1,e["column-rule-width"]=!1,e["column-span"]=!1,e["column-width"]=!1,e.columns=!1,e.contain=!1,e.content=!1,e["counter-increment"]=!1,e["counter-reset"]=!1,e["counter-set"]=!1,e.crop=!1,e.cue=!1,e["cue-after"]=!1,e["cue-before"]=!1,e.cursor=!1,e.direction=!1,e.display=!0,e["display-inside"]=!0,e["display-list"]=!0,e["display-outside"]=!0,e["dominant-baseline"]=!1,e.elevation=!1,e["empty-cells"]=!1,e.filter=!1,e.flex=!1,e["flex-basis"]=!1,e["flex-direction"]=!1,e["flex-flow"]=!1,e["flex-grow"]=!1,e["flex-shrink"]=!1,e["flex-wrap"]=!1,e.float=!1,e["float-offset"]=!1,e["flood-color"]=!1,e["flood-opacity"]=!1,e["flow-from"]=!1,e["flow-into"]=!1,e.font=!0,e["font-family"]=!0,e["font-feature-settings"]=!0,e["font-kerning"]=!0,e["font-language-override"]=!0,e["font-size"]=!0,e["font-size-adjust"]=!0,e["font-stretch"]=!0,e["font-style"]=!0,e["font-synthesis"]=!0,e["font-variant"]=!0,e["font-variant-alternates"]=!0,e["font-variant-caps"]=!0,e["font-variant-east-asian"]=!0,e["font-variant-ligatures"]=!0,e["font-variant-numeric"]=!0,e["font-variant-position"]=!0,e["font-weight"]=!0,e.grid=!1,e["grid-area"]=!1,e["grid-auto-columns"]=!1,e["grid-auto-flow"]=!1,e["grid-auto-rows"]=!1,e["grid-column"]=!1,e["grid-column-end"]=!1,e["grid-column-start"]=!1,e["grid-row"]=!1,e["grid-row-end"]=!1,e["grid-row-start"]=!1,e["grid-template"]=!1,e["grid-template-areas"]=!1,e["grid-template-columns"]=!1,e["grid-template-rows"]=!1,e["hanging-punctuation"]=!1,e.height=!0,e.hyphens=!1,e.icon=!1,e["image-orientation"]=!1,e["image-resolution"]=!1,e["ime-mode"]=!1,e["initial-letters"]=!1,e["inline-box-align"]=!1,e["justify-content"]=!1,e["justify-items"]=!1,e["justify-self"]=!1,e.left=!1,e["letter-spacing"]=!0,e["lighting-color"]=!0,e["line-box-contain"]=!1,e["line-break"]=!1,e["line-grid"]=!1,e["line-height"]=!1,e["line-snap"]=!1,e["line-stacking"]=!1,e["line-stacking-ruby"]=!1,e["line-stacking-shift"]=!1,e["line-stacking-strategy"]=!1,e["list-style"]=!0,e["list-style-image"]=!0,e["list-style-position"]=!0,e["list-style-type"]=!0,e.margin=!0,e["margin-bottom"]=!0,e["margin-left"]=!0,e["margin-right"]=!0,e["margin-top"]=!0,e["marker-offset"]=!1,e["marker-side"]=!1,e.marks=!1,e.mask=!1,e["mask-box"]=!1,e["mask-box-outset"]=!1,e["mask-box-repeat"]=!1,e["mask-box-slice"]=!1,e["mask-box-source"]=!1,e["mask-box-width"]=!1,e["mask-clip"]=!1,e["mask-image"]=!1,e["mask-origin"]=!1,e["mask-position"]=!1,e["mask-repeat"]=!1,e["mask-size"]=!1,e["mask-source-type"]=!1,e["mask-type"]=!1,e["max-height"]=!0,e["max-lines"]=!1,e["max-width"]=!0,e["min-height"]=!0,e["min-width"]=!0,e["move-to"]=!1,e["nav-down"]=!1,e["nav-index"]=!1,e["nav-left"]=!1,e["nav-right"]=!1,e["nav-up"]=!1,e["object-fit"]=!1,e["object-position"]=!1,e.opacity=!1,e.order=!1,e.orphans=!1,e.outline=!1,e["outline-color"]=!1,e["outline-offset"]=!1,e["outline-style"]=!1,e["outline-width"]=!1,e.overflow=!1,e["overflow-wrap"]=!1,e["overflow-x"]=!1,e["overflow-y"]=!1,e.padding=!0,e["padding-bottom"]=!0,e["padding-left"]=!0,e["padding-right"]=!0,e["padding-top"]=!0,e.page=!1,e["page-break-after"]=!1,e["page-break-before"]=!1,e["page-break-inside"]=!1,e["page-policy"]=!1,e.pause=!1,e["pause-after"]=!1,e["pause-before"]=!1,e.perspective=!1,e["perspective-origin"]=!1,e.pitch=!1,e["pitch-range"]=!1,e["play-during"]=!1,e.position=!1,e["presentation-level"]=!1,e.quotes=!1,e["region-fragment"]=!1,e.resize=!1,e.rest=!1,e["rest-after"]=!1,e["rest-before"]=!1,e.richness=!1,e.right=!1,e.rotation=!1,e["rotation-point"]=!1,e["ruby-align"]=!1,e["ruby-merge"]=!1,e["ruby-position"]=!1,e["shape-image-threshold"]=!1,e["shape-outside"]=!1,e["shape-margin"]=!1,e.size=!1,e.speak=!1,e["speak-as"]=!1,e["speak-header"]=!1,e["speak-numeral"]=!1,e["speak-punctuation"]=!1,e["speech-rate"]=!1,e.stress=!1,e["string-set"]=!1,e["tab-size"]=!1,e["table-layout"]=!1,e["text-align"]=!0,e["text-align-last"]=!0,e["text-combine-upright"]=!0,e["text-decoration"]=!0,e["text-decoration-color"]=!0,e["text-decoration-line"]=!0,e["text-decoration-skip"]=!0,e["text-decoration-style"]=!0,e["text-emphasis"]=!0,e["text-emphasis-color"]=!0,e["text-emphasis-position"]=!0,e["text-emphasis-style"]=!0,e["text-height"]=!0,e["text-indent"]=!0,e["text-justify"]=!0,e["text-orientation"]=!0,e["text-overflow"]=!0,e["text-shadow"]=!0,e["text-space-collapse"]=!0,e["text-transform"]=!0,e["text-underline-position"]=!0,e["text-wrap"]=!0,e.top=!1,e.transform=!1,e["transform-origin"]=!1,e["transform-style"]=!1,e.transition=!1,e["transition-delay"]=!1,e["transition-duration"]=!1,e["transition-property"]=!1,e["transition-timing-function"]=!1,e["unicode-bidi"]=!1,e["vertical-align"]=!1,e.visibility=!1,e["voice-balance"]=!1,e["voice-duration"]=!1,e["voice-family"]=!1,e["voice-pitch"]=!1,e["voice-range"]=!1,e["voice-rate"]=!1,e["voice-stress"]=!1,e["voice-volume"]=!1,e.volume=!1,e["white-space"]=!1,e.widows=!1,e.width=!0,e["will-change"]=!1,e["word-break"]=!0,e["word-spacing"]=!0,e["word-wrap"]=!0,e["wrap-flow"]=!1,e["wrap-through"]=!1,e["writing-mode"]=!1,e["z-index"]=!1,e}function ore(e,t,i){}function are(e,t,i){}var lre=/javascript\s*\:/img;function ure(e,t){return lre.test(t)?"":t}$h.whiteList=Xz();$h.getDefaultWhiteList=Xz;$h.onAttr=ore;$h.onIgnoreAttr=are;$h.safeAttrValue=ure;var cre={indexOf:function(e,t){var i,r;if(Array.prototype.indexOf)return e.indexOf(t);for(i=0,r=e.length;i<r;i++)if(e[i]===t)return i;return-1},forEach:function(e,t,i){var r,s;if(Array.prototype.forEach)return e.forEach(t,i);for(r=0,s=e.length;r<s;r++)t.call(i,e[r],r,e)},trim:function(e){return String.prototype.trim?e.trim():e.replace(/(^\s*)|(\s*$)/g,"")},trimRight:function(e){return String.prototype.trimRight?e.trimRight():e.replace(/(\s*$)/g,"")}},zf=cre;function hre(e,t){e=zf.trimRight(e),e[e.length-1]!==";"&&(e+=";");var i=e.length,r=!1,s=0,n=0,o="";function a(){if(!r){var c=zf.trim(e.slice(s,n)),d=c.indexOf(":");if(d!==-1){var m=zf.trim(c.slice(0,d)),y=zf.trim(c.slice(d+1));if(m){var g=t(s,o.length,m,y,c);g&&(o+=g+"; ")}}}s=n+1}for(;n<i;n++){var l=e[n];if(l==="/"&&e[n+1]==="*"){var u=e.indexOf("*/",n+2);if(u===-1)break;n=u+1,s=n+1,r=!1}else l==="("?r=!0:l===")"?r=!1:l===";"?r||a():l===`
`&&a()}return zf.trim(o)}var dre=hre,L0=$h,pre=dre;function XA(e){return e==null}function fre(e){var t={};for(var i in e)t[i]=e[i];return t}function Kz(e){e=fre(e||{}),e.whiteList=e.whiteList||L0.whiteList,e.onAttr=e.onAttr||L0.onAttr,e.onIgnoreAttr=e.onIgnoreAttr||L0.onIgnoreAttr,e.safeAttrValue=e.safeAttrValue||L0.safeAttrValue,this.options=e}Kz.prototype.process=function(e){if(e=e||"",e=e.toString(),!e)return"";var t=this,i=t.options,r=i.whiteList,s=i.onAttr,n=i.onIgnoreAttr,o=i.safeAttrValue,a=pre(e,function(l,u,c,d,m){var y=r[c],g=!1;if(y===!0?g=y:typeof y=="function"?g=y(d):y instanceof RegExp&&(g=y.test(d)),g!==!0&&(g=!1),d=o(c,d),!!d){var _={position:u,sourcePosition:l,source:m,isWhite:g};if(g){var v=s(c,d,_);return XA(v)?c+":"+d:v}else{var v=n(c,d,_);if(!XA(v))return v}}});return a};var mre=Kz;(function(e,t){var i=$h,r=mre;function s(o,a){var l=new r(a);return l.process(o)}t=e.exports=s,t.FilterCSS=r;for(var n in i)t[n]=i[n]})(Jx,Jx.exports);var FC=Jx.exports,zC={indexOf:function(e,t){var i,r;if(Array.prototype.indexOf)return e.indexOf(t);for(i=0,r=e.length;i<r;i++)if(e[i]===t)return i;return-1},forEach:function(e,t,i){var r,s;if(Array.prototype.forEach)return e.forEach(t,i);for(r=0,s=e.length;r<s;r++)t.call(i,e[r],r,e)},trim:function(e){return String.prototype.trim?e.trim():e.replace(/(^\s*)|(\s*$)/g,"")},spaceIndex:function(e){var t=/\s|\n|\t/,i=t.exec(e);return i?i.index:-1}},yre=FC.FilterCSS,gre=FC.getDefaultWhiteList,Sv=zC;function Qz(){return{a:["target","href","title"],abbr:["title"],address:[],area:["shape","coords","href","alt"],article:[],aside:[],audio:["autoplay","controls","crossorigin","loop","muted","preload","src"],b:[],bdi:["dir"],bdo:["dir"],big:[],blockquote:["cite"],br:[],caption:[],center:[],cite:[],code:[],col:["align","valign","span","width"],colgroup:["align","valign","span","width"],dd:[],del:["datetime"],details:["open"],div:[],dl:[],dt:[],em:[],figcaption:[],figure:[],font:["color","size","face"],footer:[],h1:[],h2:[],h3:[],h4:[],h5:[],h6:[],header:[],hr:[],i:[],img:["src","alt","title","width","height"],ins:["datetime"],li:[],mark:[],nav:[],ol:[],p:[],pre:[],s:[],section:[],small:[],span:[],sub:[],summary:[],sup:[],strong:[],strike:[],table:["width","border","align","valign"],tbody:["align","valign"],td:["width","rowspan","colspan","align","valign"],tfoot:["align","valign"],th:["width","rowspan","colspan","align","valign"],thead:["align","valign"],tr:["rowspan","align","valign"],tt:[],u:[],ul:[],video:["autoplay","controls","crossorigin","loop","muted","playsinline","poster","preload","src","height","width"]}}var e8=new yre;function _re(e,t,i){}function vre(e,t,i){}function bre(e,t,i){}function wre(e,t,i){}function t8(e){return e.replace(xre,"&lt;").replace($re,"&gt;")}function Sre(e,t,i,r){if(i=a8(i),t==="href"||t==="src"){if(i=Sv.trim(i),i==="#")return"#";if(!(i.substr(0,7)==="http://"||i.substr(0,8)==="https://"||i.substr(0,7)==="mailto:"||i.substr(0,4)==="tel:"||i.substr(0,11)==="data:image/"||i.substr(0,6)==="ftp://"||i.substr(0,2)==="./"||i.substr(0,3)==="../"||i[0]==="#"||i[0]==="/"))return""}else if(t==="background"){if(k0.lastIndex=0,k0.test(i))return""}else if(t==="style"){if(KA.lastIndex=0,KA.test(i)||(QA.lastIndex=0,QA.test(i)&&(k0.lastIndex=0,k0.test(i))))return"";r!==!1&&(r=r||e8,i=r.process(i))}return i=l8(i),i}var xre=/</g,$re=/>/g,Mre=/"/g,Tre=/&quot;/g,Ere=/&#([a-zA-Z0-9]*);?/gim,Cre=/&colon;?/gim,Pre=/&newline;?/gim,k0=/((j\s*a\s*v\s*a|v\s*b|l\s*i\s*v\s*e)\s*s\s*c\s*r\s*i\s*p\s*t\s*|m\s*o\s*c\s*h\s*a):/gi,KA=/e\s*x\s*p\s*r\s*e\s*s\s*s\s*i\s*o\s*n\s*\(.*/gi,QA=/u\s*r\s*l\s*\(.*/gi;function i8(e){return e.replace(Mre,"&quot;")}function r8(e){return e.replace(Tre,'"')}function s8(e){return e.replace(Ere,function(i,r){return r[0]==="x"||r[0]==="X"?String.fromCharCode(parseInt(r.substr(1),16)):String.fromCharCode(parseInt(r,10))})}function n8(e){return e.replace(Cre,":").replace(Pre," ")}function o8(e){for(var t="",i=0,r=e.length;i<r;i++)t+=e.charCodeAt(i)<32?" ":e.charAt(i);return Sv.trim(t)}function a8(e){return e=r8(e),e=s8(e),e=n8(e),e=o8(e),e}function l8(e){return e=i8(e),e=t8(e),e}function Ire(){return""}function Are(e,t){typeof t!="function"&&(t=function(){});var i=!Array.isArray(e);function r(o){return i?!0:Sv.indexOf(e,o)!==-1}var s=[],n=!1;return{onIgnoreTag:function(o,a,l){if(r(o))if(l.isClosing){var u="[/removed]",c=l.position+u.length;return s.push([n!==!1?n:l.position,c]),n=!1,u}else return n||(n=l.position),"[removed]";else return t(o,a,l)},remove:function(o){var a="",l=0;return Sv.forEach(s,function(u){a+=o.slice(l,u[0]),l=u[1]}),a+=o.slice(l),a}}}function Lre(e){for(var t="",i=0;i<e.length;){var r=e.indexOf("<!--",i);if(r===-1){t+=e.slice(i);break}t+=e.slice(i,r);var s=e.indexOf("-->",r);if(s===-1)break;i=s+3}return t}function kre(e){var t=e.split("");return t=t.filter(function(i){var r=i.charCodeAt(0);return r===127?!1:r<=31?r===10||r===13:!0}),t.join("")}Vt.whiteList=Qz();Vt.getDefaultWhiteList=Qz;Vt.onTag=_re;Vt.onIgnoreTag=vre;Vt.onTagAttr=bre;Vt.onIgnoreTagAttr=wre;Vt.safeAttrValue=Sre;Vt.escapeHtml=t8;Vt.escapeQuote=i8;Vt.unescapeQuote=r8;Vt.escapeHtmlEntities=s8;Vt.escapeDangerHtml5Entities=n8;Vt.clearNonPrintableCharacter=o8;Vt.friendlyAttrValue=a8;Vt.escapeAttrValue=l8;Vt.onIgnoreTagStripAll=Ire;Vt.StripTagBody=Are;Vt.stripCommentTag=Lre;Vt.stripBlankChar=kre;Vt.cssFilter=e8;Vt.getDefaultCSSWhiteList=gre;var nw={},Dl=zC;function Rre(e){var t=Dl.spaceIndex(e),i;return t===-1?i=e.slice(1,-1):i=e.slice(1,t+1),i=Dl.trim(i).toLowerCase(),i.slice(0,1)==="/"&&(i=i.slice(1)),i.slice(-1)==="/"&&(i=i.slice(0,-1)),i}function Ore(e){return e.slice(0,2)==="</"}function Nre(e,t,i){var r="",s=0,n=!1,o=!1,a=0,l=e.length,u="",c="";e:for(a=0;a<l;a++){var d=e.charAt(a);if(n===!1){if(d==="<"){n=a;continue}}else if(o===!1){if(d==="<"){r+=i(e.slice(s,a)),n=a,s=a;continue}if(d===">"){r+=i(e.slice(s,n)),c=e.slice(n,a+1),u=Rre(c),r+=t(n,r.length,u,c,Ore(c)),s=a+1,n=!1;continue}if(d==='"'||d==="'")for(var m=1,y=e.charAt(a-m);y.trim()===""||y==="=";){if(y==="="){o=d;continue e}y=e.charAt(a-++m)}}else if(d===o){o=!1;continue}}return s<e.length&&(r+=i(e.substr(s))),r}var Dre=/[^a-zA-Z0-9\\_:.-]/gim;function Fre(e,t){var i=0,r=0,s=[],n=!1,o=e.length;function a(m,y){if(m=Dl.trim(m),m=m.replace(Dre,"").toLowerCase(),!(m.length<1)){var g=t(m,y||"");g&&s.push(g)}}for(var l=0;l<o;l++){var u=e.charAt(l),c,d;if(n===!1&&u==="="){n=e.slice(i,l),i=l+1,r=e.charAt(i)==='"'||e.charAt(i)==="'"?i:Vre(e,l+1);continue}if(n!==!1&&l===r){if(d=e.indexOf(u,l+1),d===-1)break;c=Dl.trim(e.slice(r+1,d)),a(n,c),n=!1,l=d,i=l+1;continue}if(/\s|\n|\t/.test(u))if(e=e.replace(/\s|\n|\t/g," "),n===!1)if(d=zre(e,l),d===-1){c=Dl.trim(e.slice(i,l)),a(c),n=!1,i=l+1;continue}else{l=d-1;continue}else if(d=Ure(e,l-1),d===-1){c=Dl.trim(e.slice(i,l)),c=eL(c),a(n,c),n=!1,i=l+1;continue}else continue}return i<e.length&&(n===!1?a(e.slice(i)):a(n,eL(Dl.trim(e.slice(i))))),Dl.trim(s.join(" "))}function zre(e,t){for(;t<e.length;t++){var i=e[t];if(i!==" ")return i==="="?t:-1}}function Vre(e,t){for(;t<e.length;t++){var i=e[t];if(i!==" ")return i==="'"||i==='"'?t:-1}}function Ure(e,t){for(;t>0;t--){var i=e[t];if(i!==" ")return i==="="?t:-1}}function jre(e){return e[0]==='"'&&e[e.length-1]==='"'||e[0]==="'"&&e[e.length-1]==="'"}function eL(e){return jre(e)?e.substr(1,e.length-2):e}nw.parseTag=Nre;nw.parseAttr=Fre;var Gre=FC.FilterCSS,yn=Vt,u8=nw,Bre=u8.parseTag,qre=u8.parseAttr,W_=zC;function R0(e){return e==null}function Hre(e){var t=W_.spaceIndex(e);if(t===-1)return{html:"",closing:e[e.length-2]==="/"};e=W_.trim(e.slice(t+1,-1));var i=e[e.length-1]==="/";return i&&(e=W_.trim(e.slice(0,-1))),{html:e,closing:i}}function Wre(e){var t={};for(var i in e)t[i]=e[i];return t}function Zre(e){var t={};for(var i in e)Array.isArray(e[i])?t[i.toLowerCase()]=e[i].map(function(r){return r.toLowerCase()}):t[i.toLowerCase()]=e[i];return t}function c8(e){e=Wre(e||{}),e.stripIgnoreTag&&(e.onIgnoreTag&&console.error('Notes: cannot use these two options "stripIgnoreTag" and "onIgnoreTag" at the same time'),e.onIgnoreTag=yn.onIgnoreTagStripAll),e.whiteList||e.allowList?e.whiteList=Zre(e.whiteList||e.allowList):e.whiteList=yn.whiteList,e.onTag=e.onTag||yn.onTag,e.onTagAttr=e.onTagAttr||yn.onTagAttr,e.onIgnoreTag=e.onIgnoreTag||yn.onIgnoreTag,e.onIgnoreTagAttr=e.onIgnoreTagAttr||yn.onIgnoreTagAttr,e.safeAttrValue=e.safeAttrValue||yn.safeAttrValue,e.escapeHtml=e.escapeHtml||yn.escapeHtml,this.options=e,e.css===!1?this.cssFilter=!1:(e.css=e.css||{},this.cssFilter=new Gre(e.css))}c8.prototype.process=function(e){if(e=e||"",e=e.toString(),!e)return"";var t=this,i=t.options,r=i.whiteList,s=i.onTag,n=i.onIgnoreTag,o=i.onTagAttr,a=i.onIgnoreTagAttr,l=i.safeAttrValue,u=i.escapeHtml,c=t.cssFilter;i.stripBlankChar&&(e=yn.stripBlankChar(e)),i.allowCommentTag||(e=yn.stripCommentTag(e));var d=!1;i.stripIgnoreTagBody&&(d=yn.StripTagBody(i.stripIgnoreTagBody,n),n=d.onIgnoreTag);var m=Bre(e,function(y,g,_,v,b){var S={sourcePosition:y,position:g,isClosing:b,isWhite:Object.prototype.hasOwnProperty.call(r,_)},$=s(_,v,S);if(!R0($))return $;if(S.isWhite){if(S.isClosing)return"</"+_+">";var E=Hre(v),C=r[_],P=qre(E.html,function(k,F){var D=W_.indexOf(C,k)!==-1,U=o(_,k,F,D);return R0(U)?D?(F=l(_,k,F,c),F?k+'="'+F+'"':k):(U=a(_,k,F,D),R0(U)?void 0:U):U});return v="<"+_,P&&(v+=" "+P),E.closing&&(v+=" /"),v+=">",v}else return $=n(_,v,S),R0($)?u(v):$},u);return d&&(m=d.remove(m)),m};var Yre=c8;(function(e,t){var i=Vt,r=nw,s=Yre;function n(a,l){var u=new s(l);return u.process(a)}t=e.exports=n,t.filterXSS=n,t.FilterXSS=s,(function(){for(var a in i)t[a]=i[a];for(var l in r)t[l]=r[l]})();function o(){return typeof self<"u"&&typeof DedicatedWorkerGlobalScope<"u"&&self instanceof DedicatedWorkerGlobalScope}o()&&(self.filterXSS=e.exports)})(Yx,Yx.exports);var Dh=Yx.exports,Jre=function(e){if(typeof e!="object"||e===null||Object.prototype.toString.call(e)!=="[object Object]")return!1;var t=Object.getPrototypeOf(e);if(t===null)return!0;for(;Object.getPrototypeOf(t)!==null;)t=Object.getPrototypeOf(t);return Object.getPrototypeOf(e)===t},Xre=(function(){function e(t,i){var r=this;this.arcgisWhiteList={a:["href","style","target"],abbr:["title"],article:["style"],aside:["style"],audio:["autoplay","controls","loop","muted","preload"],b:[],blockquote:["style"],br:[],code:["style"],dd:["style"],del:["style"],details:["open","style"],div:["align","aria-hidden","aria-label","style"],dl:["style"],dt:["style"],em:[],figcaption:["style"],figure:["style"],font:["color","face","size","style"],footer:["style"],h1:["style"],h2:["style"],h3:["style"],h4:["style"],h5:["style"],h6:["style"],header:["style"],hr:[],i:[],img:["alt","border","height","src","style","width"],li:[],main:["style"],mark:["style"],nav:["style"],ol:[],p:["style"],pre:["style"],section:["style"],source:["media","src","type"],span:["aria-hidden","aria-label","style"],strong:[],sub:["style"],summary:["style"],sup:["style"],table:["border","cellpadding","cellspacing","height","style","width"],tbody:[],tr:["align","height","style","valign"],td:["align","colspan","height","nowrap","rowspan","style","valign","width"],th:["align","colspan","height","nowrap","rowspan","style","valign","width"],time:["style"],u:[],ul:[],video:["autoplay","controls","height","loop","muted","poster","preload","width"]},this.arcgisCSSWhiteList=wv(wv({},Dh.getDefaultCSSWhiteList()),{"align-items":!0,"align-self":!0,flex:!0,"flex-basis":!0,"flex-direction":!0,"flex-flow":!0,"flex-grow":!0,"flex-shrink":!0,"flex-wrap":!0,float:!0,gap:!0,grid:!0,"grid-area":!0,"grid-auto-columns":!0,"grid-auto-flow":!0,"grid-auto-rows":!0,"grid-column":!0,"grid-column-end":!0,"grid-column-start":!0,"grid-row":!0,"grid-row-end":!0,"grid-row-start":!0,"grid-template":!0,"grid-template-areas":!0,"grid-template-columns":!0,"grid-template-rows":!0,"justify-content":!0,"justify-items":!0,"justify-self":!0,"line-height":!0,overflow:!0}),this.allowedProtocols=["http","https","mailto","iform","tel","flow","lfmobile","arcgis-navigator","arcgis-appstudio-player","arcgis-survey123","arcgis-collector","arcgis-workforce","arcgis-explorer","arcgis-trek2there","arcgis-quickcapture","mspbi","comgooglemaps","pdfefile","pdfehttp","pdfehttps","boxapp","boxemm","awb","awbs","gropen","radarscope"],this.arcgisFilterOptions={allowCommentTag:!0,safeAttrValue:function(n,o,a,l){return n==="a"&&o==="href"||(n==="img"||n==="source")&&o==="src"?r.sanitizeUrl(a):Dh.safeAttrValue(n,o,a,l)}},this._entityMap={"&":"&#x38;","<":"&#x3C;",">":"&#x3E;",'"':"&#x22;","'":"&#x27;","/":"&#x2F;"};var s;t&&!i?s=t:t&&i?(s=Object.create(this.arcgisFilterOptions),s.css={whiteList:this.arcgisCSSWhiteList},Object.keys(t).forEach(function(n){if(n==="whiteList")s.whiteList=r._extendObjectOfArrays([r.arcgisWhiteList,t.whiteList||{}]);else if(n==="css"){var o=t.css.whiteList;o!=null&&t.css instanceof Object&&Object.keys(o).forEach(function(a){return s.css.whiteList[a]=o[a]})}else s[n]=t[n]})):(s=Object.create(this.arcgisFilterOptions),s.whiteList=this.arcgisWhiteList,s.css={whiteList:this.arcgisCSSWhiteList}),this.xssFilterOptions=s,this._xssFilter=new Dh.FilterXSS(s)}return e.prototype.sanitize=function(t,i){switch(i===void 0&&(i={}),typeof t){case"number":return isNaN(t)||!isFinite(t)?null:t;case"boolean":return t;case"string":return this._xssFilter.process(t);case"object":return this._iterateOverObject(t,i);default:return i.allowUndefined&&typeof t>"u"?void 0:null}},e.prototype.sanitizeUrl=function(t,i){var r=(i??{}).isProtocolRequired,s=r===void 0?!0:r,n=this._trim(t.substring(0,t.indexOf(":"))),o=t==="/",a=/^#/.test(t),l=n&&this.allowedProtocols.indexOf(n.toLowerCase())>-1;return o||a||l?Dh.escapeAttrValue(t):!n&&!s?Dh.escapeAttrValue("https://".concat(t)):""},e.prototype.sanitizeHTMLAttribute=function(t,i,r,s){return typeof this.xssFilterOptions.safeAttrValue=="function"?this.xssFilterOptions.safeAttrValue(t,i,r,s):Dh.safeAttrValue(t,i,r,s)},e.prototype.validate=function(t,i){i===void 0&&(i={});var r=this.sanitize(t,i);return{isValid:t===r,sanitized:r}},e.prototype.encodeHTML=function(t){var i=this;return String(t).replace(/[&<>"'\/]/g,function(r){return i._entityMap[r]})},e.prototype.encodeAttrValue=function(t){var i=/^[a-zA-Z0-9]$/;return String(t).replace(/[\x00-\xFF]/g,function(r,s){return i.test(r)?r:"&#x".concat(Number(t.charCodeAt(s)).toString(16),";")})},e.prototype._extendObjectOfArrays=function(t){var i={};return t.forEach(function(r){Object.keys(r).forEach(function(s){Array.isArray(r[s])&&Array.isArray(i[s])?i[s]=i[s].concat(r[s]):i[s]=r[s]})}),i},e.prototype._iterateOverObject=function(t,i){var r=this;i===void 0&&(i={});try{var s=!1,n=void 0;if(Array.isArray(t))n=t.reduce(function(a,l){var u=r.validate(l,i);return u.isValid?a.concat([l]):(s=!0,a.concat([u.sanitized]))},[]);else if(Jre(t)){var o=Object.keys(t);n=o.reduce(function(a,l){var u=t[l],c=r.validate(u,i);return c.isValid?a[l]=u:(s=!0,a[l]=c.sanitized),a},{})}else return i.allowUndefined&&typeof t>"u"?void 0:null;return s?n:t}catch{return null}},e.prototype._trim=function(t){return String.prototype.trim?t.trim():t.replace(/(^\s*)|(\s*$)/g,"")},e})();const Kre=["dd","dl","dt","h1","h2","h3","h4","h5","h6","sub","sup","animate","animatetransform","circle","clippath","defs","ellipse","g","image","line","lineargradient","marker","mask","path","pattern","polygon","polyline","radialgradient","rect","stop","svg","switch","symbol","text","textpath","tspan","use"],Qre=Kre.reduce(((e,t)=>(e[t]=[],e)),{}),ese=["align","alink","alt","bgcolor","border","cellpadding","cellspacing","class","color","cols","colspan","coords","d","dir","face","height","hspace","ismap","lang","marginheight","marginwidth","multiple","nohref","noresize","noshade","nowrap","ref","rel","rev","rows","rowspan","scrolling","shape","span","summary","tabindex","title","usemap","valign","value","vlink","vspace","width"],h8=new Xre({whiteList:Qre,onTagAttr:(e,t,i)=>{const r=`${t}="${i}"`;if(ese.includes(t))return r},stripIgnoreTag:!0,stripIgnoreTagBody:["script","style"]},!0),d8="http://www.w3.org/",ow=`${d8}2000/svg`,p8=`${d8}1999/xlink`;let tL=[],VC=(e,t)=>{let i={};return Object.keys(e).forEach((r=>{i[r]=e[r]})),t&&Object.keys(t).forEach((r=>{i[r]=t[r]})),i},UC=(e,t)=>e.vnodeSelector===t.vnodeSelector&&(e.properties&&t.properties?e.properties.key===t.properties.key&&e.properties.bind===t.properties.bind:!e.properties&&!t.properties),f8=e=>{if(typeof e!="string")throw new Error("Style values must be strings")},tse=(e,t,i)=>{if(t.vnodeSelector!==""){for(let r=i;r<e.length;r++)if(UC(e[r],t))return r}return-1},w2=(e,t,i,r)=>{let s=e[t];if(s.vnodeSelector==="")return;let n=s.properties;if(!(n&&(n.key===void 0?n.bind:n.key))){for(let o=0;o<e.length;o++)if(o!==t){let a=e[o];if(UC(a,s))throw new Error(`${i.vnodeSelector} had a ${s.vnodeSelector} child ${r==="added"?r:"removed"}, but there is now more than one. You must add unique key properties to make them distinguishable.`)}}},ise=e=>{if(e.properties){let t=e.properties.enterAnimation;t&&t(e.domNode,e.properties)}},Xx=[],Kx=!1,m8=e=>{(e.children||[]).forEach(m8),e.properties&&e.properties.afterRemoved&&e.properties.afterRemoved.apply(e.properties.bind||e.properties,[e.domNode])},iL=()=>{Kx=!1,Xx.forEach(m8),Xx.length=0},rL=e=>{Xx.push(e),Kx||(Kx=!0,typeof window<"u"&&"requestIdleCallback"in window?window.requestIdleCallback(iL,{timeout:16}):setTimeout(iL,16))},sL=e=>{let t=e.domNode;if(e.properties){let i=e.properties.exitAnimation;if(i)return t.style.pointerEvents="none",void i(t,()=>{t.parentNode&&(t.parentNode.removeChild(t),rL(e))},e.properties)}t.parentNode&&(t.parentNode.removeChild(t),rL(e))},rse=(e,t,i)=>{if(!t)return;let r=i.eventHandlerInterceptor,s=Object.keys(t),n=s.length;for(let o=0;o<n;o++){let a=s[o],l=t[a];if(a==="className")throw new Error('Property "className" is not supported, use "class".');if(a==="class")e$(e,l,!0);else if(a==="classes"){let u=Object.keys(l),c=u.length;for(let d=0;d<c;d++){let m=u[d];l[m]&&e.classList.add(m)}}else if(a==="styles"){let u=Object.keys(l),c=u.length;for(let d=0;d<c;d++){let m=u[d],y=l[m];y&&(f8(y),i.styleApplyer(e,m,y))}}else if(a!=="key"&&l!=null){let u=typeof l;u==="function"?(a.lastIndexOf("on",0)===0&&(r&&(l=r(a,l,e,t)),a==="oninput"&&(function(){let c=l;l=function(d){c.apply(this,[d]),d.target["oninput-value"]=d.target.value}})()),e[a]=l):i.namespace===ow?a==="href"?e.setAttributeNS(p8,a,l):e.setAttribute(a,l):u==="string"&&a!=="value"?a==="innerHTML"?e[a]=h8.sanitize(l):Qx(e)&&a in e?e[a]=l:e.setAttribute(a,l):e[a]=l}}};function Qx(e){if(!(e instanceof Element&&e.tagName.includes("-")))return!1;const t=window.customElements.get(e.tagName.toLowerCase());return!!t&&e instanceof t}let xv,sse=(e,t,i)=>{if(t)for(let r of t)vy(r,e,void 0,i)},y8=(e,t,i)=>{sse(e,t.children,i),t.text&&(e.textContent=t.text),rse(e,t.properties,i),t.properties&&t.properties.afterCreate&&t.properties.afterCreate.apply(t.properties.bind||t.properties,[e,i,t.vnodeSelector,t.properties,t.children])},vy=(e,t,i,r)=>{let s,n=0,o=e.vnodeSelector,a=t.ownerDocument;if(o==="")s=e.domNode=a.createTextNode(e.text),i!==void 0?t.insertBefore(s,i):t.appendChild(s);else{for(let l=0;l<=o.length;++l){let u=o.charAt(l);if(l===o.length||u==="."||u==="#"){let c=o.charAt(n-1),d=o.slice(n,l);c==="."?s.classList.add(d):c==="#"?s.id=d:(d==="svg"&&(r=VC(r,{namespace:ow})),r.namespace!==void 0?s=e.domNode=a.createElementNS(r.namespace,d):(s=e.domNode=e.domNode||a.createElement(d),d==="input"&&e.properties&&e.properties.type!==void 0&&s.setAttribute("type",e.properties.type)),i!==void 0?t.insertBefore(s,i):s.parentNode!==t&&t.appendChild(s)),n=l+1}}y8(s,e,r)}},e$=(e,t,i)=>{t&&t.split(" ").forEach((r=>{r&&e.classList.toggle(r,i)}))},nse=(e,t,i,r)=>{if(!i)return;let s=!1,n=Object.keys(i),o=n.length;for(let a=0;a<o;a++){let l=n[a],u=i[l],c=t[l];if(l==="class")c!==u&&(e$(e,c,!1),e$(e,u,!0));else if(l==="classes"){let d=e.classList,m=Object.keys(u),y=m.length;for(let g=0;g<y;g++){let _=m[g],v=!!u[_];v!==!!c[_]&&(s=!0,v?d.add(_):d.remove(_))}}else if(l==="styles"){let d=Object.keys(u),m=d.length;for(let y=0;y<m;y++){let g=d[y],_=u[g];_!==c[g]&&(s=!0,_?(f8(_),r.styleApplyer(e,g,_)):r.styleApplyer(e,g,""))}}else if(u||typeof c!="string"||(u=""),l!=="value"||Qx(e)){if(u!==c){let d=typeof u;d==="function"&&r.eventHandlerInterceptor||(r.namespace===ow?l==="href"?e.setAttributeNS(p8,l,u):e.setAttribute(l,u):d==="string"?l==="innerHTML"?e[l]=h8.sanitize(u):l==="role"&&u===""?e.removeAttribute(l):Qx(e)&&l in e?e[l]=u:e.setAttribute(l,u):e[l]!==u&&(e[l]=u),s=!0)}}else{let d=e[l];d!==u&&(e["oninput-value"]?d===e["oninput-value"]:u!==c)&&(e[l]=u,e["oninput-value"]=void 0),u!==c&&(s=!0)}}return s},ose=(e,t,i,r,s)=>{if(i===r)return!1;r=r||tL;let n,o=(i=i||tL).length,a=r.length,l=0,u=0,c=!1;for(;u<a;){let d=l<o?i[l]:void 0,m=r[u];if(d!==void 0&&UC(d,m))c=xv(d,m,s)||c,l++;else{let y=tse(i,m,l+1);if(y>=0){for(n=l;n<y;n++)sL(i[n]),w2(i,n,e,"removed");c=xv(i[y],m,s)||c,l=y+1}else vy(m,t,l<o?i[l].domNode:void 0,s),ise(m),w2(r,u,e,"added")}u++}if(o>l)for(n=l;n<o;n++)sL(i[n]),w2(i,n,e,"removed");return c};xv=(e,t,i)=>{let r=e.domNode,s=!1;if(e===t)return!1;let n=!1;if(t.vnodeSelector===""){if(t.text!==e.text){let o=r.ownerDocument.createTextNode(t.text);return r.parentNode.replaceChild(o,r),t.domNode=o,s=!0,s}t.domNode=r}else t.vnodeSelector.lastIndexOf("svg",0)===0&&(i=VC(i,{namespace:ow})),e.text!==t.text&&(n=!0,t.text===void 0?r.removeChild(r.firstChild):r.textContent=t.text),t.domNode=r,n=ose(t,r,e.children,t.children,i)||n,n=nse(r,e.properties,t.properties,i)||n,t.properties&&t.properties.afterUpdate&&t.properties.afterUpdate.apply(t.properties.bind||t.properties,[r,i,t.vnodeSelector,t.properties,t.children]);return n&&t.properties&&t.properties.updateAnimation&&t.properties.updateAnimation(r,t.properties,e.properties),s};let O0=(e,t)=>({getLastRender:()=>e,update:i=>{if(e.vnodeSelector!==i.vnodeSelector)throw new Error("The selector for the root VNode may not be changed. (consider using dom.merge and add one extra level to the virtual DOM)");let r=e;e=i,xv(r,i,t)},domNode:e.domNode});const ase={namespace:void 0,performanceLogger:()=>{},eventHandlerInterceptor:void 0,styleApplyer:(e,t,i)=>{t.charAt(0)==="-"?e.style.setProperty(t,i):e.style[t]=i}};let xm=e=>VC(ase,e),tu={append:(e,t,i)=>(i=xm(i),vy(t,e,void 0,i),O0(t,i)),insertBefore:(e,t,i)=>(i=xm(i),vy(t,e.parentNode,e,i),O0(t,i)),merge:(e,t,i)=>(i=xm(i),t.domNode=e,y8(e,t,i),O0(t,i)),replace:(e,t,i)=>(i=xm(i),vy(t,e.parentNode,e,i),e.parentNode.removeChild(e),O0(t,i))},g8,lse=(e,t)=>{let i=[];for(;e&&e!==t;)i.push(e),e=e.parentNode;return i};g8=Array.prototype.find?(e,t)=>e.find(t):(e,t)=>e.filter(t)[0];let use=(e,t)=>{let i=e;return t.forEach((r=>{i=i&&i.children?g8(i.children,(s=>s.domNode===r)):void 0})),i},cse=(e,t,i)=>{let r=function(s){i("domEvent",s);let n=t(),o=lse(s.currentTarget,n.domNode);o.reverse();let a,l=use(n.getLastRender(),o);return e.scheduleRender(),l&&(a=l.properties[`on${s.type}`].apply(l.properties.bind||this,arguments)),i("domEventProcessed",s),a};return(s,n,o,a)=>r},$v=e=>{let t,i,r=xm(e),s=r.performanceLogger,n=!0,o=!1,a=[],l=[],u=(d,m,y)=>{let g,_=()=>g;r.eventHandlerInterceptor=cse(t,_,s),g=d(m,y(),r),a.push(g),l.push(y)},c=()=>{if(i=void 0,n){n=!1,s("renderStart",void 0);for(let d=0;d<a.length;d++){let m=l[d]();s("rendered",void 0),a[d].update(m),s("patched",void 0)}s("renderDone",void 0),n=!0}};return t={renderNow:c,scheduleRender:()=>{i||o||(i=requestAnimationFrame(c))},stop:()=>{i&&(cancelAnimationFrame(i),i=void 0),o=!0},resume:()=>{o=!1,n=!0,t.scheduleRender()},append:(d,m)=>{u(tu.append,d,m)},insertBefore:(d,m)=>{u(tu.insertBefore,d,m)},merge:(d,m)=>{u(tu.merge,d,m)},replace:(d,m)=>{u(tu.replace,d,m)},detach:d=>{for(let m=0;m<l.length;m++)if(l[m]===d)return l.splice(m,1),a.splice(m,1)[0];throw new Error("renderFunction was not found")}},t},bl=class extends le{constructor(){super(...arguments),this.items=new ne,this._watchUpdatingTracking=new Bc,this._callbacks=new Map,this._projector=$v(),this._hiddenProjector=$v()}get needsRender(){return this.items.length>0}get updating(){return this._watchUpdatingTracking?.updating??!1}initialize(){const t=document.createElement("div");t.className="esri-overlay-surface",this._set("surface",t),this._hiddenSurface=document.createElement("div"),this._hiddenSurface.setAttribute("style","visibility: hidden;"),t.appendChild(this._hiddenSurface),this._watchUpdatingTracking.addOnCollectionChange((()=>this.items),(i=>{for(const r of i.added){const s=()=>r.render();this._callbacks.set(r,s),this._projector.append(this.surface,s)}for(const r of i.removed){const s=this._projector.detach(this._callbacks.get(r));this.surface.removeChild(s.domNode),this._callbacks.delete(r)}}))}addItem(t){this.items.add(t)}removeItem(t){this.items.remove(t)}destroy(){this.items.removeAll(),this._callbacks.forEach((t=>this._projector.detach(t))),this._callbacks=null,this._projector=null,this._watchUpdatingTracking.destroy()}render(){this._projector.renderNow()}computeBoundingRect(t){const i=this._hiddenSurface,r=this._hiddenProjector;let s;const n=()=>(s=t.render(),s);r.append(i,n),r.renderNow();const o={left:0,top:0,right:0,bottom:0};if(s?.domNode){const a=s.domNode.getBoundingClientRect();o.left=a.left,o.top=a.top,o.right=a.right,o.bottom=a.bottom}for(r.detach(n);i.firstChild;)i.removeChild(i.firstChild);return o}overlaps(t,i){const r=this.computeBoundingRect(t),s=this.computeBoundingRect(i);return Math.max(r.left,s.left)<=Math.min(r.right,s.right)&&Math.max(r.top,s.top)<=Math.min(r.bottom,s.bottom)}get hasVisibleItems(){return this.items.some((t=>t.visible))}async prepare(){await document.fonts.load(this._fontString()).catch((()=>{}))}renderCanvas(t,i){const r=!!i?.disableDecorations;if(!this.items.some((n=>n.visible&&!(r&&n.isDecoration))))return;const s=t.getContext("2d");s.save(),s.font=this._fontString(),this.items.forEach((n=>{r&&n.isDecoration||(s.save(),n.renderCanvas(s),s.restore())})),s.restore()}_fontString(){return`10px ${getComputedStyle(this.surface).fontFamily}`}};h([f({readOnly:!0})],bl.prototype,"surface",void 0),h([f({readOnly:!0})],bl.prototype,"items",void 0),h([f({readOnly:!0})],bl.prototype,"needsRender",null),h([f({readOnly:!0})],bl.prototype,"_watchUpdatingTracking",void 0),h([f({readOnly:!0})],bl.prototype,"updating",null),bl=h([I("esri.views.overlay.ViewOverlay")],bl);const nL=bl,S2=[0,0];function hse(e){const t=(e.ownerDocument||window.document).defaultView,i=e.getBoundingClientRect();return S2[0]=i.left+(t?.pageXOffset??0),S2[1]=i.top+(t?.pageYOffset??0),S2}function oL(e){e&&(e.textContent="",e.parentNode&&e.parentNode.removeChild(e))}function dse(e){const t=document.createElement("div");return e.appendChild(t),t}const Fh=16,Vf=750,pse=512,fse=2,mse=e=>{let t=class extends e{constructor(...i){super(...i),this._freqInfo={freq:Fh,time:Vf},this._overlayRenderTaskHandle=null,this.height=0,this.messagesCommon=null,this.overlay=null,this.position=null,this.resizing=!1,this.root=null,this.surface=null,this.suspended=!0,this.userContent=null,this.width=0,this.widthBreakpoint=null,this.addHandles([te((()=>this.cursor),(r=>{const{surface:s}=this;s&&s.setAttribute("data-cursor",r)})),te((()=>this.navigating),(r=>{const{surface:s}=this;s&&s.setAttribute("data-navigating",r.toString())}))])}initialize(){this.addHandles([te((()=>this.ui),((i,r)=>this._handleUIChange(i,r)),Pt),this.on("focus",(()=>this.notifyChange("focused"))),this.on("blur",(()=>this.notifyChange("focused")))])}destroy(){this.destroyed||(this.ui?.destroy(),this.container=null)}get container(){return this._get("container")??null}set container(i){const r=this._get("container"),s=DC(i);if(s||typeof i!="string"||H.getLogger(this).error("#container",`element with id '${i}' not found`),r===s)return;if(this._stopMeasuring(),r&&(r.classList.remove("esri-view"),this._overlayRenderTaskHandle&&(this._overlayRenderTaskHandle.remove(),this._overlayRenderTaskHandle=null),this.overlay&&(this.overlay.destroy(),this._set("overlay",null)),this.root&&(oL(this.root),this._set("root",null)),this.userContent&&(JA(this.userContent,r),oL(this.userContent),this._set("userContent",null))),!s)return this._set("width",0),this._set("height",0),this._set("position",null),this._set("suspended",!0),this._set("surface",null),void this._set("container",null);s.classList.add("esri-view");const n=document.createElement("div");n.className="esri-view-user-storage",JA(s,n),s.appendChild(n),this._set("userContent",n);const o=document.createElement("div");o.className="esri-view-root",s.insertBefore(o,s.firstChild),this._set("root",o);const a=document.createElement("div");a.className="esri-view-surface",a.setAttribute("role","application"),a.tabIndex=0,o.appendChild(a),this._set("surface",a);const l=new nL;o.appendChild(l.surface),this._set("overlay",l),this.addHandles(te((()=>l.needsRender),(u=>{u&&!this._overlayRenderTaskHandle?this._overlayRenderTaskHandle=Np({render:()=>this.overlay?.render()}):this._overlayRenderTaskHandle=St(this._overlayRenderTaskHandle)}))),this.forceDOMReadyCycle(),this._set("container",s),this._startMeasuring()}get focused(){const i=document.activeElement===this.surface;return document.hasFocus()&&i}get size(){return[this.width,this.height]}set ui(i){const r=this._get("ui");r!==i&&r?.destroy(),this._set("ui",i)}blur(){this.surface?.blur()}focus(){this.surface?.focus()}pageToContainer(i,r,s){const n=this.position;return i-=n?n[0]:0,r-=n?n[1]:0,s?(s[0]=i,s[1]=r):s=[i,r],s}containerToPage(i,r,s){const n=this.position;return i+=n?n[0]:0,r+=n?n[1]:0,s?(s[0]=i,s[1]=r):s=[i,r],s}_handleUIChange(i,r){this.removeHandles("ui"),r&&r!==i&&r.destroy(),i&&(i.view=this,this.addHandles(te((()=>this.root),(s=>{i.container=s?dse(s):null}),Pt),"ui")),this._set("ui",i)}_stopMeasuring(){this.removeHandles("measuring"),this._get("resizing")&&this._set("resizing",!1)}_startMeasuring(){const i=this._freqInfo;i.freq=Fh,i.time=Vf;const r=Np({prepare:o=>{const a=this._measure(),l=this._freqInfo;if(l.time+=o.deltaTime,a&&(l.freq=Fh,this._get("resizing")||this._set("resizing",!0)),l.time<l.freq)return;l.time=0;const u=this._position();l.freq=u||a?Fh:Math.min(Vf,l.freq*fse),!a&&l.freq>=pse&&(r.pause(),this._get("resizing")&&this._set("resizing",!1))}}),s=new ResizeObserver((o=>{i.freq=Fh,i.time=Vf,r.resume()}));this.container!=null&&s.observe(this.container);const n=ze((()=>s.disconnect()));this.addHandles([lf(window,"resize",(()=>{i.freq=Fh,i.time=Vf,r.resume()})),n,r],"measuring"),this._measure(),this._position()}_measure(){const i=this.container,r=i?i.clientWidth:0,s=i?i.clientHeight:0;if(r===0||s===0)return this.suspended||this._set("suspended",!0),!1;const n=this.width,o=this.height;return r===n&&s===o?(this.suspended&&this._set("suspended",!1),!1):(this._set("width",r),this._set("height",s),this.suspended&&this._set("suspended",!1),this.emit("resize",{oldWidth:n,oldHeight:o,width:r,height:s}),!0)}_position(){const i=this.container,r=this.position,s=i&&hse(i);return!!s&&(!r||s[0]!==r[0]||s[1]!==r[1])&&(this._set("position",[s[0],s[1]]),!0)}forceDOMReadyCycle(){}};return h([f()],t.prototype,"container",null),h([f({readOnly:!0})],t.prototype,"focused",null),h([f({readOnly:!0})],t.prototype,"height",void 0),h([f()],t.prototype,"messagesCommon",void 0),h([f({type:nL})],t.prototype,"overlay",void 0),h([f({readOnly:!0})],t.prototype,"position",void 0),h([f({readOnly:!0})],t.prototype,"resizing",void 0),h([f({readOnly:!0})],t.prototype,"root",void 0),h([f({value:null,readOnly:!0})],t.prototype,"size",null),h([f({readOnly:!0})],t.prototype,"surface",void 0),h([f({readOnly:!0})],t.prototype,"suspended",void 0),h([f({nonNullable:!0})],t.prototype,"ui",null),h([f({readOnly:!0})],t.prototype,"userContent",void 0),h([f({readOnly:!0})],t.prototype,"width",void 0),h([f()],t.prototype,"widthBreakpoint",void 0),t=h([I("esri.views.DOMContainer")],t),t},_8=N("mac")?"Meta":"Control",yse=new Set(["Alt","Control","Meta","Shift","Ctrl","Primary"]),gse=e=>yse.has(e);let _se=class{constructor(t,i=[]){this.eventType=t,this.keyModifiers=i}matches(t){if(t.type!==this.eventType)return!1;if(this.keyModifiers.length===0)return!0;const i=t.modifiers;for(const r of this.keyModifiers)if(!i.has(r))return!1;return!0}},_i=class{constructor(t){this._manager=null,this._incoming={},this._outgoing={},this._incomingEventMatches=null,this._incomingEventTypes=null,this._outgoingEventTypes=null,this._hasSideEffects=t}get incomingEventMatches(){if(!this._incomingEventMatches){this._incomingEventMatches=[];for(const t in this._incoming){const i=this._incoming[t];for(const r of i)this._incomingEventMatches.push(r.match)}}return this._incomingEventMatches}get incomingEventTypes(){return this._incomingEventTypes||(this._incomingEventTypes=this.incomingEventMatches.map((t=>t.eventType))),this._incomingEventTypes}get outgoingEventTypes(){return this._outgoingEventTypes||(this._outgoingEventTypes=Object.keys(this._outgoing)),this._outgoingEventTypes}get hasSideEffects(){return this._hasSideEffects}get hasPendingInputs(){return!1}onInstall(t){this._manager||(t.setEventCallback((i=>this._handleEvent(i))),t.setUninstallCallback((()=>this._onUninstall())),this._manager=t)}onUninstall(){}registerIncoming(t,i,r){let s;typeof i=="function"?(r=i,s=[]):s=i||[];const n=typeof t=="string"?new _se(t,s):t,o=()=>{this._incomingEventTypes=null,this._incomingEventMatches=null},a=c=>{const d=this._incoming[c.match.eventType];if(d){const m=d.indexOf(c);d.splice(m,1),o(),this._manager&&this._manager.updateDependencies()}},l=new vse(n,r,{onPause:a,onRemove:a,onResume:c=>{const d=this._incoming[c.match.eventType];d&&!d.includes(c)&&(d.push(c),o(),this._manager&&this._manager.updateDependencies())}});let u=this._incoming[n.eventType];return u||(u=[],this._incoming[n.eventType]=u),u.push(l),o(),this._manager&&this._manager.updateDependencies(),l}registerOutgoing(t){if(this._outgoing[t])throw new Error("There is already a callback registered for this outgoing InputEvent: "+t);const i=new bse(t,{onEmit:(r,s,n,o)=>{this._manager?.emit(r.eventType,s,n,o)},onRemove:r=>{delete this._outgoing[r.eventType],this._manager?.updateDependencies()}});return this._outgoing[t]=i,this._outgoingEventTypes=null,this._manager&&this._manager.updateDependencies(),i}startCapturingPointer(t){this._manager?.setPointerCapture(t,!0)}stopCapturingPointer(t){this._manager?.setPointerCapture(t,!1)}refreshHasPendingInputs(){this._manager?.refreshHasPendingInputs()}_onUninstall(){this._manager&&(this.onUninstall(),this._manager=null)}_handleEvent(t){const i=this._incoming[t.type];if(i){for(const r of i)if(r.match.matches(t)&&(r.callback?.(t),t.shouldStopPropagation()))break}}},vse=class{constructor(t,i,r){this.match=t,this._callback=i,this._handler=r}pause(){this._handler.onPause(this)}resume(){this._handler.onResume(this)}remove(){this._handler.onRemove(this)}get callback(){return this._callback}},bse=class{constructor(t,i){this.eventType=t,this._removed=!1,this._handler=i}emit(t,i,r){this._removed||this._handler.onEmit(this,t,i,r)}remove(){this._removed=!0,this._handler.onRemove(this)}},wse=class extends _i{constructor(t){super(!0),this._onChange=t,this._value="mouse",this._x=null,this._y=null,this.registerIncoming("pointer-move",(i=>this._update(i.data)))}_update(t){const i=t.native.pointerType==="touch"?"touch":"mouse",{x:r,y:s}=t;i===this._value&&this._x===r&&this._y===s||(this._value=i,this._x=r,this._y=s,this._onChange(i,r,s))}},Sse=class{constructor(t,i){this._observable=new Og,this._value=t,this._equalityFunction=i}get value(){return ge(this._observable),this._value}set value(t){this._equalityFunction(t,this._value)||(this._value=t,this._observable.notify())}mutate(t){t(this._value),this._observable.notify()}};function Wp(e,t=BN){return new Sse(e,t)}let xse=class extends _i{get multiTouchActive(){return this._multiTouchActive.value}constructor(){super(!0),this._activeTouchPointerIds=new Set,this._multiTouchActive=Wp(!1),this._onPointerAdd=({data:t})=>{t.pointerType==="touch"&&(this._activeTouchPointerIds.add(t.native.pointerId),this._update())},this._onPointerRemove=({data:t})=>{t.pointerType==="touch"&&(this._activeTouchPointerIds.delete(t.native.pointerId),this._update())},this.registerIncoming("pointer-down",this._onPointerAdd),this.registerIncoming("pointer-up",this._onPointerRemove),this.registerIncoming("pointer-capture-lost",this._onPointerRemove),this.registerIncoming("pointer-cancel",this._onPointerRemove)}_update(){this._multiTouchActive.value=this._activeTouchPointerIds.size>1}},$se=class{constructor(t,i){this._owner=i,this._properties={},this._afterDispatchHandle=null;for(const r in t){const s=t[r],n=new jD(s,void 0,void 0,2,2);this._properties[r]={pool:n,acquired:[]}}this._afterDispatchHandle=FW((()=>this._release()))}destroy(){this._afterDispatchHandle&&(this._afterDispatchHandle.remove(),this._afterDispatchHandle=null);for(const t in this._properties){const i=this._properties[t];for(const r of i.acquired)i3(r)||i.pool.release(r);i.pool.destroy(),i.pool=null,i.acquired=null}this._properties=null,this._owner=null}get(t){const i=this._owner._get(t),r=this._properties[t];let s=r.pool.acquire();for(r.acquired.push(s);s===i;)r.acquired.push(s),s=r.pool.acquire();return s}_release(){for(const t in this._properties){const i=this._properties[t];let r=0;for(const s of i.acquired)i3(s)?i.acquired[r++]=s:i.pool.release(s);i.acquired.length=r}}},bs=class extends le{constructor(t){super(t),this._pointerCaptures=new Map,this._nameToGroup={},this._handlers=[],this._handlersPriority=[],this._currentPropagation=null,this._updateDependenciesAfterPropagation=!1,this._sourceEvents=new Set,this._keyModifiers=new Set,this._activeKeyModifiers=new Set,this._stoppedPropagationEventIds=new Set,this.primaryKey=_8,this._latestPointerType="mouse",this._propertiesPool=new $se({latestPointerLocation:Ese},this),this.latestPointerLocation=null,this._paused=!1,this.test={timestamp:void 0,hasCurrentPropagation:()=>!!this._currentPropagation}}initialize(){this.eventSource.onEventReceived=this._onEventReceived.bind(this),this._installRecognizers()}destroy(){const t=Object.keys(this._nameToGroup);for(const i of t)this.uninstallHandlers(i);this.eventSource.destroy(),this._currentPropagation=null,this._propertiesPool.destroy()}get hasPendingInputs(){return this._handlers.some((t=>t.handler.hasPendingInputs))}get latestPointerType(){return this._latestPointerType}get multiTouchActive(){return this._multiTouchHandler.multiTouchActive}get updating(){return this.hasPendingInputs||this._paused}installHandlers(t,i,r=Va.INTERNAL){if(this._nameToGroup[t]||i.length===0)return;const s={name:t,handlers:i.map((n=>({handler:n,active:!0,removed:!1,priorityIndex:0,groupPriority:r,eventCallback:null,uninstallCallback:null})))};this._nameToGroup[t]=s;for(let n=s.handlers.length-1;n>=0;n--){const o=s.handlers[n];this._handlers.push(o),o.handler.onInstall({updateDependencies:()=>{this.updateDependencies()},emit:(a,l,u,c,d)=>{this._emitInputEvent(o.priorityIndex+1,a,l,u,d,c)},setPointerCapture:(a,l)=>{this._setPointerCapture(s,o,a,l)},setEventCallback:a=>{o.eventCallback=a},setUninstallCallback:a=>{o.uninstallCallback=a},refreshHasPendingInputs:()=>{this.notifyChange("hasPendingInputs")}})}this.updateDependencies()}uninstallHandlers(t){const i=this._nameToGroup[t];i?(i.handlers.forEach((r=>{r.removed=!0,r.uninstallCallback?.()})),delete this._nameToGroup[t],this._currentPropagation?this._currentPropagation.needsHandlerGarbageCollect=!0:this._garbageCollectRemovedHandlers()):H.getLogger(this).error("There is no InputHandler group registered under the name `"+t+"`")}hasHandlers(t){return this._nameToGroup[t]!==void 0}isModifierKeyDown(t){return this._activeKeyModifiers.has(t)}updateDependencies(){if(this._currentPropagation)return void(this._updateDependenciesAfterPropagation=!0);this._updateDependenciesAfterPropagation=!1;const t=new Set,i=new Set;this._handlersPriority=[];for(let r=this._handlers.length-1;r>=0;r--){const s=this._handlers[r];s.priorityIndex=r,this._handlersPriority.push(s)}this._handlersPriority=this._sortHandlersPriority(this._handlersPriority);for(let r=this._handlersPriority.length-1;r>=0;r--){const s=this._handlersPriority[r];s.priorityIndex=r;let n=s.handler.hasSideEffects;if(!n){for(const o of s.handler.outgoingEventTypes)if(t.has(o)){n=!0;break}}if(n)for(const o of s.handler.incomingEventMatches){t.add(o.eventType);for(const a of o.keyModifiers)gse(a)||i.add(a)}s.active=n}this._sourceEvents=t,this._keyModifiers=i,this._pointerCaptures.size>0&&this._sourceEvents.add("pointer-capture-lost"),this._keyModifiers.size>0&&(this._sourceEvents.add("key-down"),this._sourceEvents.add("key-up")),this.eventSource&&(this.eventSource.activeEvents=this._sourceEvents)}_setLatestPointer(t,i,r){this._latestPointerType=t;const s=this._get("latestPointerLocation");if(s==null||s.x!==i||s.y!==r){const n=this._propertiesPool.get("latestPointerLocation");n.x=i,n.y=r,this._set("latestPointerLocation",n)}}_onEventReceived(t,i){if(t==="pointer-capture-lost"){const n=i;this._pointerCaptures.delete(n.native.pointerId)}this._updateKeyModifiers(t,i);const r=this.test.timestamp!=null?this.test.timestamp:i.native?i.native.timestamp:void 0,s=i.native?i.native.cancelable:void 0;this._emitInputEventFromSource(t,i,r,s)}_updateKeyModifiers(t,i){if(!i)return;let r=!1;const s=()=>{r||(this._activeKeyModifiers=new Set(this._activeKeyModifiers),r=!0)},n=(a,l)=>{l&&!this._activeKeyModifiers.has(a)?(s(),this._activeKeyModifiers.add(a)):!l&&this._activeKeyModifiers.has(a)&&(s(),this._activeKeyModifiers.delete(a))};if(t==="key-down"||t==="key-up"){const a=i.key;this._keyModifiers.has(a)&&n(a,t==="key-down")}const o=i.native;n("Alt",!!o?.altKey),n("Control",!!o?.ctrlKey),n("Ctrl",!!o?.ctrlKey),n("Shift",!!o?.shiftKey),n("Meta",!!o?.metaKey),n("Primary",this._activeKeyModifiers.has(this.primaryKey))}_installRecognizers(){this._latestPointerHandler=new wse(((t,i,r)=>this._setLatestPointer(t,i,r))),this._multiTouchHandler=new xse,this.installHandlers("input-manager-logic",[this._latestPointerHandler,this._multiTouchHandler],Va.ALWAYS),this.recognizers.length>0&&this.installHandlers("default",this.recognizers,Va.INTERNAL)}_setPointerCapture(t,i,r,s){const n=t.name+"-"+i.priorityIndex,o=this._pointerCaptures.get(r.pointerId)||new Set;this._pointerCaptures.set(r.pointerId,o),s?(o.add(n),o.size===1&&this.eventSource&&this.eventSource.setPointerCapture(r,!0)):o.has(n)&&(o.delete(n),o.size===0&&(this._pointerCaptures.delete(r.pointerId),this.eventSource&&this.eventSource.setPointerCapture(r,!1)))}_garbageCollectRemovedHandlers(){this._handlers=this._handlers.filter((t=>!t.removed)),this.updateDependencies()}_emitInputEventFromSource(t,i,r,s){this._emitInputEvent(0,t,i,r,s)}_emitInputEvent(t,i,r,s,n,o){const a=s!==void 0?s:this._currentPropagation?this._currentPropagation.timestamp:performance.now(),l=n!==void 0&&n,u={event:new Mse(i,r,a,o||this._activeKeyModifiers,l),priorityIndex:t};this._currentPropagation?this._currentPropagation.events.push(u):this._doNewPropagation(u)}_doNewPropagation(t){this._currentPropagation={events:new Zy,currentHandler:null,needsHandlerGarbageCollect:!1,timestamp:t.event.timestamp},this._currentPropagation.events.push(t),this._continuePropagation()}_continuePropagation(){this._paused=!1;const t=this._currentPropagation;if(t){for(;t.events.length>0;){const{event:i,priorityIndex:r}=t.events.pop(),s=i.data?.eventId;if(!(s!=null&&this._stoppedPropagationEventIds.has(s)))for(t.currentHandler=this._handlersPriority[r];t.currentHandler;){if(t.currentHandler.removed)t.needsHandlerGarbageCollect=!0;else{if(t.currentHandler.active&&!i.shouldStopPropagation()&&t.currentHandler.eventCallback?.(i),i.shouldStopPropagation()){s!=null&&this._stoppedPropagationEventIds.add(s);break}if(i.shouldPausePropagation((()=>this._continuePropagation())))return void this._pausePropagation({event:i,priorityIndex:t.currentHandler.priorityIndex+1})}t.currentHandler=this._handlersPriority[t.currentHandler.priorityIndex+1]}}t.needsHandlerGarbageCollect&&this._garbageCollectRemovedHandlers(),this.hasPendingInputs||this._stoppedPropagationEventIds.clear(),this._currentPropagation=null,this._updateDependenciesAfterPropagation&&this.updateDependencies()}}_pausePropagation(t){const i=new Zy;i.push(t);const r=this._currentPropagation;if(r){for(;r.events.length;)i.push(r.events.pop());r.events=i,r.currentHandler=null,this._paused=!0}}_compareHandlerPriority(t,i){if(t.handler.hasSideEffects!==i.handler.hasSideEffects)return t.handler.hasSideEffects?1:-1;if(t.groupPriority!==i.groupPriority)return t.groupPriority>i.groupPriority?-1:1;for(const r of t.handler.incomingEventMatches)for(const s of i.handler.incomingEventMatches){if(r.eventType!==s.eventType)continue;const n=r.keyModifiers.filter((o=>s.keyModifiers.includes(o)));if(n.length===r.keyModifiers.length!=(n.length===s.keyModifiers.length))return r.keyModifiers.length>s.keyModifiers.length?-1:1}return t.priorityIndex>i.priorityIndex?-1:1}_sortHandlersPriority(t){const i=[];for(const r of t){let s=0;for(;s<i.length&&this._compareHandlerPriority(r,i[s])>=0;)s++;i.splice(s,0,r)}return i}get debug(){const t=i=>{const r=this._setPointerCapture;this._setPointerCapture=()=>{},i(),this._setPointerCapture=r};return{injectEvent:(i,r)=>{t((()=>this._onEventReceived(i,r)))},disablePointerCapture:t}}};h([f({readOnly:!0})],bs.prototype,"hasPendingInputs",null),h([f({constructOnly:!0})],bs.prototype,"eventSource",void 0),h([f({constructOnly:!0})],bs.prototype,"recognizers",void 0),h([f()],bs.prototype,"_latestPointerType",void 0),h([f()],bs.prototype,"latestPointerType",null),h([f()],bs.prototype,"multiTouchActive",null),h([f({readOnly:!0})],bs.prototype,"latestPointerLocation",void 0),h([f()],bs.prototype,"_paused",void 0),h([f({readOnly:!0})],bs.prototype,"updating",null),bs=h([I("esri.views.input.InputManager")],bs);let Mse=class{constructor(t,i,r,s,n){this.type=t,this.data=i,this.timestamp=r,this.modifiers=s,this.cancelable=n,this._propagationState=Fl.NONE,this._resumeCallback=null}stopPropagation(){this._propagationState|=Fl.STOPPED}shouldStopPropagation(){return(this._propagationState&Fl.STOPPED)!==0}defer(t){this._propagationState|=Fl.PAUSED;const i=(r,s)=>{this._propagationState&=~Fl.PAUSED;const n=this._resumeCallback;if(this._resumeCallback=null,n&&n(),s)throw r;return r};return(typeof t=="function"?t():t).then((r=>i(r,!1)),(r=>i(r,!0)))}shouldPausePropagation(t){return!!(this._propagationState&Fl.PAUSED)&&(this._resumeCallback=t,!0)}preventDefault(){this.data.native.preventDefault()}};var Fl;(function(e){e[e.NONE=0]="NONE",e[e.STOPPED=1]="STOPPED",e[e.PAUSED=2]="PAUSED"})(Fl||(Fl={}));const Va={ALWAYS:1,DEFAULT:0,TOOL:-1,WIDGET:-2,INTERNAL:-3};let Tse=class{};const Ese=Tse;function hl(e){return e!=null&&"open"in e&&"declaredClass"in e}function aL(e){return e!=null&&"declaredClass"in e&&"dockOptions"in e}const Cse=e=>{let t=class extends e{constructor(){super(...arguments),this._popupSetupTask=null,this.popup={},this.popupEnabled=!0}initialize(){this.addHandles([te((()=>[this.ui,this.popup]),(([i,r],s)=>{const n="popup",o="manual";if(s){const[a,l]=s;a&&hl(l)&&(l.view=null,aL(l)&&(a.remove(l,n),l!==r&&r&&l.destroy()))}i&&hl(r)&&(r.view=this,aL(r)&&i.add(r,{key:n,position:o,internal:!0}))}),br),this.on("click",(i=>{this.popup&&this.popupEnabled&&(i.pointerType!=="mouse"||i.button===0)&&(hl(this.popup)?this.popup.viewModel.handleViewClick(i):i.defer((async()=>{await this.setupPopup(),hl(this.popup)&&!this.destroyed&&this.ready&&this.popupEnabled&&this.popup.viewModel.handleViewClick(i)})))}),Va.WIDGET)]),Vg((()=>this.ready&&this.popupEnabled&&!this.updating)).then((()=>{J(()=>import("./Popup-CprH1y5X.js").then(i=>i.P),__vite__mapDeps([162,163,5,164,165,166,42,89,167,168,76,74,75,30,35,77,169,170,171,1,172,7,173,174,175,176,9,177,178,6,179,180,181,182,183,184,185,186,187,188,8,189,190,191,192,193,194,195,196,197,17,198,199,200,201,202]))}))}destroy(){this.destroyed||this.closePopup()}async openPopup(i){if(hl(this.popup))return this.popup.open(i);try{if(await this.setupPopup(),!this.popup)return void H.getLogger(this).error(new j("view:null-popup","Popup is null and can't be opened"));this.popup.open(i)}catch{}}closePopup(){this._popupSetupTask?.abort(),hl(this.popup)&&this.popup.close()}async fetchPopupFeatures(i,r){return await this.when(),this._popupHitsToFeatures(await this._getPopupHits(i,r),r)}async setupPopup(){if(this._popupSetupTask?.abort(),this.popup&&!hl(this.popup))return this._popupSetupTask=XE((async i=>{const{default:r}=await J(()=>import("./Popup-CprH1y5X.js").then(n=>n.P),__vite__mapDeps([162,163,5,164,165,166,42,89,167,168,76,74,75,30,35,77,169,170,171,1,172,7,173,174,175,176,9,177,178,6,179,180,181,182,183,184,185,186,187,188,8,189,190,191,192,193,194,195,196,197,17,198,199,200,201,202]));if(It(i),!this.popup||hl(this.popup))return;const s=this.popup;delete s.open,delete s.close,this.popup=new r(s)})),this._popupSetupTask.promise}async _popupHitsToFeatures({location:i,hits:r},s){const n=[],o=[];let a=!1;const l=yH(s,N("popup-view-fetch-timeout")??Ise),u=m=>{const y=new Pse(m);return o.push(y),n.push(y.promise),y},c=m=>{const y=o.at(-1);return y&&y.layerView===m&&!a?y:u(m)};for(const m of r)"graphic"in m?(c(m.layerView).graphics.push(m.graphic),a=!1):(n.push(m.layerView.fetchPopupFeaturesAtLocation(m.mapPoint,l)),a=!0);o.map((m=>m.resolve(l)));const d=mH(n).then((m=>m.filter((y=>!!y)).flat()));return{pendingFeatures:n,allGraphicsPromise:d,location:i}}async _getPopupHits(i,r){const{hits:s,location:n}=await this.popupHitTest(i);It(r);const o=[];for(const a of s)if("graphic"in a){if(this._isValidPopupGraphic(a.graphic,r)){const l=this._isValidPopupGraphicsLayerView(a.layerView)?a.layerView:void 0;o.push({graphic:a.graphic,layerView:l})}}else this._isValidPopupLocationLayerView(a.layerView)&&o.push({mapPoint:a.mapPoint,layerView:a.layerView});return{hits:o,location:n}}_isValidPopupGraphic(i,r){return i&&!!i.getEffectivePopupTemplate(r?.defaultPopupTemplateEnabled)}_isValidPopupGraphicsLayerView(i){return!i||(!("layer"in i)||!i.suspended)&&"fetchPopupFeaturesFromGraphics"in i}_isValidPopupLocationLayerView(i){return(!("layer"in i)||!i.suspended)&&"fetchPopupFeaturesAtLocation"in i}};return h([f()],t.prototype,"popup",void 0),h([f()],t.prototype,"popupEnabled",void 0),t=h([I("esri.views.PopupView")],t),t};let Pse=class{constructor(t){this.layerView=t,this._resolver=Gs(),this.graphics=[]}get promise(){return this._resolver.promise}resolve(t){const{layerView:i,graphics:r,_resolver:s}=this;if(!i)return s.resolve(r),s.promise;let n;return i.fetchPopupFeaturesFromGraphics(r,t).catch((o=>(n=o,null))).then((o=>{o?s.resolve(o):s.reject(n)})),s.promise}};const Ise=5e3;let by=class extends ne{constructor(t){super(t),this.addHandles([this.on("before-add",(i=>{i.item==null&&i.preventDefault()})),this.on("after-add",(i=>this._own(i.item))),this.on("after-remove",(i=>this._release(i.item)))])}get owner(){return this._get("owner")}set owner(t){t!==this._get("owner")&&(this._releaseAll(),this._set("owner",t),this._ownAll())}_ownAll(){for(const t of this.items)this._own(t)}_releaseAll(){for(const t of this.items)this._release(t)}_createNewInstance(t){return this.itemType?new(ne.ofType(this.itemType.Type))(t):new ne(t)}};function lL(e,t){return{type:e,cast:p4,set(i){const r=Ha(i,this._get(t),e);r.owner=this,this._set(t,r)}}}h([f()],by.prototype,"owner",null),by=h([I("esri.core.support.OwningCollection")],by);var $m;const Mv=cr()({orthometric:"gravity-related-height",gravity_related_height:"gravity-related-height",ellipsoidal:"ellipsoidal"}),v8=Mv.jsonValues.slice();gq(v8,"orthometric");const wy=cr()({meter:"meters",foot:"feet","us-foot":"us-feet","clarke-foot":"clarke-feet","clarke-yard":"clarke-yards","clarke-link":"clarke-links","sears-yard":"sears-yards","sears-foot":"sears-feet","sears-chain":"sears-chains","benoit-1895-b-chain":"benoit-1895-b-chains","indian-yard":"indian-yards","indian-1937-yard":"indian-1937-yards","gold-coast-foot":"gold-coast-feet","sears-1922-truncated-chain":"sears-1922-truncated-chains","50-kilometers":"50-kilometers","150-kilometers":"150-kilometers"});let Nr=$m=class extends ee{constructor(e){super(e),this.heightModel="gravity-related-height",this.heightUnit="meters",this.vertCRS=null}writeHeightModel(e,t,i){return Mv.write(e,t,i)}readHeightModel(e,t,i){return Mv.read(e)||(i?.messages&&i.messages.push(Ase(e,{context:i})),null)}readHeightUnit(e,t,i){return wy.read(e)||(i?.messages&&i.messages.push(uL(e,{context:i})),null)}readHeightUnitService(e,t,i){return rC(e)||wy.read(e)||(i?.messages&&i.messages.push(uL(e,{context:i})),null)}readVertCRS(e,t){return t.vertCRS||t.ellipsoid||t.geoid}clone(){return new $m({heightModel:this.heightModel,heightUnit:this.heightUnit,vertCRS:this.vertCRS})}equals(e){return!!e&&(this===e||this.heightModel===e.heightModel&&this.heightUnit===e.heightUnit&&this.vertCRS===e.vertCRS)}static deriveUnitFromSR(e,t){const i=D4(t);return new $m({heightModel:e.heightModel,heightUnit:i??void 0,vertCRS:e.vertCRS})}write(e,t){return t={origin:"web-scene",...t},super.write(e,t)}static fromJSON(e){if(!e)return null;const t=new $m;return t.read(e,{origin:"web-scene"}),t}};function uL(e,t){return new Bs("height-unit:unsupported",`Height unit of value '${e}' is not supported`,t)}function Ase(e,t){return new Bs("height-model:unsupported",`Height model of value '${e}' is not supported`,t)}h([f({type:Mv.apiValues,constructOnly:!0,json:{origins:{"web-scene":{type:v8,default:"ellipsoidal",write:{isRequired:!0}}}}})],Nr.prototype,"heightModel",void 0),h([$e("web-scene","heightModel")],Nr.prototype,"writeHeightModel",null),h([Ae(["web-scene","service"],"heightModel")],Nr.prototype,"readHeightModel",null),h([f({type:wy.apiValues,constructOnly:!0,json:{origins:{"web-scene":{type:wy.jsonValues,write:{writer:wy.write,isRequired:!0}}}}})],Nr.prototype,"heightUnit",void 0),h([Ae("web-scene","heightUnit")],Nr.prototype,"readHeightUnit",null),h([Ae("service","heightUnit")],Nr.prototype,"readHeightUnitService",null),h([f({type:String,constructOnly:!0,json:{origins:{"web-scene":{write:!0}}}})],Nr.prototype,"vertCRS",void 0),h([Ae("service","vertCRS",["vertCRS","ellipsoid","geoid"])],Nr.prototype,"readVertCRS",null),Nr=$m=h([I("esri.geometry.HeightModelInfo")],Nr);let Tv=class extends by{constructor(t){super(t),this.addHandles(this.on("before-add",(i=>{i.item!=null&&i.item.parent===this.owner&&(H.getLogger(this).warn("Analysis inside the collection must be unique. Not adding this element again."),i.preventDefault())})))}_own(t){t.parent=this.owner}_release(t){t.parent=null}};Tv=h([I("esri.support.AnalysesCollection")],Tv);let x2;async function Lse(){return x2==null&&(x2=J(()=>import("./WhereClauseCache-JX1YmA3Q.js"),__vite__mapDeps([36,37])).then((e=>new e.WhereClauseCache(500,500)))),x2}async function b8(e,t){const i=await Lse(),r=i.get(e,t);if(r==null)throw i.getError(e,t);return r}function kse(e,t){return e||=null,t||=null,e==="1=1"?t??e:t==="1=1"?e??t:e&&t?`(${e}) AND (${t})`:e??t}function Rse(e,t){return e||=null,t||=null,e==="1=1"||t==="1=1"||e===t?e==="1=1"?e:t:e&&t?`(${e}) OR (${t})`:e??t}function CCe(e,t){return t.length===0?null:`${e} IN (${Ose(t)})`}function Ose(e){return e.map((t=>typeof t=="string"?Nse(t):t)).join(",")}function Nse(e){return`'${e.replaceAll("'","''")}'`}function Zp(e){return typeof e=="number"}function PCe(e){return typeof e=="number"&&isFinite(e)&&Math.floor(e)===e}function ICe(e){return typeof e=="boolean"}function qg(e){return typeof e=="string"||e instanceof String}function Dse(e){return e==null||qg(e)}function ACe(e){return Array.isArray(e)}function LCe(e){return e?.declaredClass==="esri.Graphic"}function kCe(e){return e instanceof Date}const Fse="HH:mm",zse="HH:mm:ss",Vse="HH:mm:ss.SSS",Use=[Vse,zse,Fse,"TT"],jse="yyyy-MM-dd";function cL(e){if(!e||!qg(e))return null;const t=se.fromFormat(e,jse);return t.isValid?t:null}function hL(e){return e&&qg(e)?fD(Use,(t=>{const i=se.fromFormat(e,t);return i.isValid?i:null}))??null:null}function dL(e){if(!e||!qg(e))return null;const t=se.fromISO(e);return t.isValid?t:null}var Ev;(function(e){e.VALUE_OUT_OF_RANGE="domain-validation-error::value-out-of-range",e.INVALID_CODED_VALUE="domain-validation-error::invalid-coded-value"})(Ev||(Ev={}));const w8=new Set(["integer","small-integer","long","big-integer","esriFieldTypeInteger","esriFieldTypeSmallInteger","esriFieldTypeLong","esriFieldTypeBigInteger"]);function Gse(e){return e!=null&&w8.has(e.type)}function S8(e){return e!=null&&(e.type==="date-only"||e.type==="esriFieldTypeDateOnly")}function x8(e){return e!=null&&(e.type==="timestamp-offset"||e.type==="esriFieldTypeTimestampOffset")}function $8(e){return e!=null&&(e.type==="time-only"||e.type==="esriFieldTypeTimeOnly")}const Bse=new Set(["single","double","esriFieldTypeSingle","esriFieldTypeDouble"]);UE(w8,Bse);function RCe(e,t){const i=e?.domain;if(!i||i.type!=="range")return;const r="range"in i?i.range[0]:i.minValue,s="range"in i?i.range[1]:i.maxValue,n=Gse(e);return S8(e)||$8(e)||x8(e)?{...qse(e,s,r),isInteger:n}:{min:r!=null&&typeof r=="number"?r:null,max:s!=null&&typeof s=="number"?s:null,rawMin:r,rawMax:s,isInteger:n}}function qse(e,t,i){return S8(e)?{min:cL(i)?.toMillis(),max:cL(t)?.toMillis(),rawMin:i,rawMax:t}:$8(e)?{min:hL(i)?.toMillis(),max:hL(t)?.toMillis(),rawMin:i,rawMax:t}:x8(e)?{min:dL(i)?.toMillis(),max:dL(t)?.toMillis(),rawMin:i,rawMax:t}:{max:null,min:null}}function Hse(e){if(!e)return;const t=e.match(Wse);return t?.groups?t.groups.doubleQuoted??t.groups.singleQuoted??t.groups.dotNotation:void 0}const Wse=/^(\$feature\[(?:"(?<doubleQuoted>[^"]+)"|'(?<singleQuoted>[^']+)')\]|\$feature\.(?<dotNotation>[a-zA-Z_][a-zA-Z0-9_]*))$/i;function Zse(e){return e.match(Yse)?.[1]?.replace(/\\'/g,"'")??null}const Yse=/^hash\(\$feature\['((\\'|[^'])+)'\]\) \* 8\.381e-8$/;let $2;function _u(){return $2||($2=(async()=>{const[e,t,i]=await Promise.all([J(()=>import("./arcadeUtils-DEoDPJY0.js"),__vite__mapDeps([203,204,205,206,170,47,207,34,30,35,37,208])),J(()=>import("./batchExec-BzNFx7le.js"),__vite__mapDeps([209,97])),J(()=>import("./aiServices-Bsv_p2bQ.js").then(r=>r.ag),__vite__mapDeps([205,206,170,47,207]))]);return{arcade:e.arcade,arcadeUtils:e,batchExec:t,aiServices:i,Dictionary:e.Dictionary,Feature:e.arcadeFeature,Voxel:e.Voxel}})()),$2}const Jse=/^([0-9_])/,Xse=/[^a-z0-9_\u0080-\uffff]+/gi;function Kse(e){return e==null?null:e.trim().replaceAll(Xse,"_").replace(Jse,"F$1")||null}const Qse=["field","field2","field3","normalizationField","rotationInfo.field","proportionalSymbolInfo.field","proportionalSymbolInfo.normalizationField","colorInfo.field","colorInfo.normalizationField"],ene=["field","normalizationField"];function OCe(e,t){if(e!=null&&t!=null){for(const i of Array.isArray(e)?e:[e])if(pL(Qse,i,t),"visualVariables"in i&&i.visualVariables)for(const r of i.visualVariables)pL(ene,r,t)}}function pL(e,t,i){if(e)for(const r of e){const s=xg(r,t),n=s&&typeof s!="function"&&i.get(s);n&&wu(r,n.name,t)}}function NCe(e,t){if(e!=null&&t?.fields?.length)if("startField"in e){const i=t.get(e.startField),r=t.get(e.endField);e.startField=i?.name??null,e.endField=r?.name??null}else{const i=t.get(e.startTimeField),r=t.get(e.endTimeField);e.startTimeField=i?.name??null,e.endTimeField=r?.name??null}}const M2=new Set;function jC(e,t){return e&&t?(M2.clear(),Yp(M2,e,t),Array.from(M2).sort()):[]}function Yp(e,t,i){if(i)if(t?.fields?.length)if(i.includes("*"))for(const{name:r}of t.fields)e.add(r);else for(const r of i)fs(e,t,r);else{if(i.includes("*"))return e.clear(),void e.add("*");for(const r of i)r!=null&&e.add(r)}}function fs(e,t,i){if(typeof i=="string")if(t){const r=t.get(i);r&&e.add(r.name)}else e.add(i)}function DCe(e,t){return t==null||e==null?[]:t.includes("*")?(e.fields??[]).map((i=>i.name)):t}function FCe(e,t,i=1){if(!t||!e)return[];if(t.includes("*"))return["*"];const r=jC(e,t);return r.length/e.fields.length>=i?["*"]:r}async function ur(e,t,i){if(!i)return;let r;const s=Hse(i);if(s)r=[s];else{const{arcadeUtils:n}=await _u();r=n.extractFieldNames(i,t?.fields?.map((o=>o.name)))}for(const n of r)fs(e,t,n)}async function GC(e,t,i){if(i&&i!=="1=1"){const r=await b8(i,t);if(!r.isStandardized)throw new j("fieldUtils:collectFilterFields","Where clause is not standardized",{where:i});Yp(e,t,r.fieldNames)}}function zCe({displayField:e,fields:t}){return e||(t?.length?T2(t,"name-or-title")||T2(t,"unique-identifier")||T2(t,"type-or-category")||tne(t):null)}function tne(e){for(const t of e){if(!t?.name)continue;const i=t.name.toLowerCase();if(i.includes("name")||i.includes("title"))return t.name}return null}function T2(e,t){for(const i of e)if(i?.valueType&&i.valueType===t)return i.name;return null}async function VCe(e,t){if(!t)return;const i=t.elevationInfo?.featureExpressionInfo;return i?i.collectRequiredFields(e,t.fieldsIndex):void 0}function ine(e,t,i){i.onStatisticExpression?ur(e,t,i.onStatisticExpression.expression):e.add(i.onStatisticField)}async function UCe(e,t,i){if(!t||!i||!("fields"in i))return;const r=[],s=i.popupTemplate;r.push(M8(e,t,s)),i.fields&&r.push(...i.fields.map((async n=>ine(e,t.fieldsIndex,n)))),await Promise.all(r)}async function jCe(e,t){const{fieldsIndex:i,trackInfo:r}=t;if(!t||!r||!i)return;const s=[r.latestObservations.renderer?.collectRequiredFields(e,i),r.previousObservations.renderer?.collectRequiredFields(e,i),r.trackLines.renderer?.collectRequiredFields(e,i)];r.popupTemplate&&s.push(M8(e,t,r.popupTemplate));for(const n of[r.latestObservations.labelingInfo,r.previousObservations.labelingInfo,r.trackLines.labelingInfo])if(n)for(const o of n)s.push(C8(e,i,o));await Promise.all(s)}async function M8(e,t,i){const r=[];i?.expressionInfos&&r.push(...i.expressionInfos.map((n=>ur(e,t.fieldsIndex,n.expression))));const s=i?.content;if(Array.isArray(s))for(const n of s)n.type==="expression"&&n.expressionInfo&&r.push(ur(e,t.fieldsIndex,n.expressionInfo.expression));await Promise.all(r)}async function GCe(e,t,i){t&&(t.timeInfo&&i?.timeExtent&&Yp(e,t.fieldsIndex,[t.timeInfo.startField,t.timeInfo.endField]),t.floorInfo&&Yp(e,t.fieldsIndex,[t.floorInfo.floorField]),i?.where!=null&&await GC(e,t.fieldsIndex,i.where))}async function BCe(e,t,i){t&&i&&await Promise.all(i.map((r=>rne(e,t,r))))}async function rne(e,t,i){t&&i&&(i.valueExpression?await ur(e,t.fieldsIndex,i.valueExpression):i.field&&fs(e,t.fieldsIndex,i.field))}function qCe(e){return e?jC(e.fieldsIndex,T8(e)):[]}function sne(e){if(!e)return[];const t=e.geometryFieldsInfo;return t?jC(e.fieldsIndex,[t.shapeAreaField,t.shapeLengthField]):[]}async function HCe(e,t,i){if(!t||!i)return;const r=t.fieldsIndex;await Promise.all(i.filters.map((s=>GC(e,r,s.where))))}const nne=new Set(["oid","global-id","guid"]),one=new Set(["oid","global-id"]),ane=[/^fnode_$/i,/^tnode_$/i,/^lpoly_$/i,/^rpoly_$/i,/^poly_$/i,/^shape$/i,/^shape_$/i,/^subclass$/i,/^subclass_$/i,/^rings_ok$/i,/^rings_nok$/i,/objectid/i,/^perimeter_/i,/_perimeter$/i,/_i$/i];function lne(e){const t=new Set;E8(e).forEach((r=>t.add(r))),sne(e).forEach((r=>t.add(r.toLowerCase())));const i=e&&"infoFor3D"in e?e.infoFor3D:void 0;return i&&(Object.values(i.assetMapFieldRoles).forEach((r=>t.add(r.toLowerCase()))),Object.values(i.transformFieldRoles).forEach((r=>t.add(r.toLowerCase())))),Array.from(t)}function T8(e){if(!e)return[];const t="editFieldsInfo"in e&&e.editFieldsInfo;if(!t)return[];const{creationDateField:i,creatorField:r,editDateField:s,editorField:n}=t;return[i,r,s,n].filter(Boolean)}function E8(e){return T8(e).map((t=>t.toLowerCase()))}function WCe(e,t){return e.editable&&!nne.has(e.type)&&!E8(t).includes(e.name?.toLowerCase()??"")}function ZCe(e,t){const i=e.name?.toLowerCase()??"";return!(t?.objectIdField!=null&&i===t.objectIdField.toLowerCase()||t?.globalIdField!=null&&i===t.globalIdField.toLowerCase()||lne(t).includes(i)||one.has(e.type)||ane.some((r=>r.test(i))))}async function YCe(e,t){const{labelingInfo:i,fieldsIndex:r}=t;i?.length&&await Promise.all(i.map((s=>C8(e,r,s))))}async function C8(e,t,i){if(!i)return;const r=i.getLabelExpression(),s=i.where;if(r.type==="arcade")await ur(e,t,r.expression);else{const n=r.expression.match(/{[^}]*}/g);n&&n.forEach((o=>{fs(e,t,o.slice(1,-1))}))}await GC(e,t,s)}function une(e){const t=e.defaultValue;return t!==void 0&&I8(e,t)?t:e.nullable?null:void 0}function JCe(e){const t=typeof e=="string"?{type:e}:e;return vne(t)?255:t.type==="esriFieldTypeDate"||t.type==="date"?8:void 0}function P8(e){return typeof e=="number"&&!isNaN(e)&&isFinite(e)}function cne(e){return e===null||P8(e)}function hne(e){return e===null||Number.isInteger(e)}function dne(){return!0}function I8(e,t){let i;switch(e.type){case"date":case"integer":case"long":case"small-integer":case"big-integer":case"esriFieldTypeDate":case"esriFieldTypeInteger":case"esriFieldTypeLong":case"esriFieldTypeSmallInteger":case"esriFieldTypeBigInteger":i=e.nullable?hne:Number.isInteger;break;case"double":case"single":case"esriFieldTypeSingle":case"esriFieldTypeDouble":i=e.nullable?cne:P8;break;case"string":case"esriFieldTypeString":i=e.nullable?Dse:qg;break;default:i=dne}return arguments.length===1?i:i(t)}const pne=["integer","small-integer","big-integer","long"],fne=["single","double"],mne=["esriFieldTypeInteger","esriFieldTypeSmallInteger","esriFieldTypeLong","esriFieldTypeBigInteger"],yne=["esriFieldTypeSingle","esriFieldTypeDouble"],A8=new Set([...pne,...mne]),gne=new Set([...fne,...yne]),_ne=UE(A8,gne);function XCe(e){return e!=null&&A8.has(e.type)}function L8(e){return e!=null&&_ne.has(e.type)}function vne(e){return e!=null&&(e.type==="string"||e.type==="esriFieldTypeString")}function BC(e){return e!=null&&(e.type==="date"||e.type==="esriFieldTypeDate")}function bne(e){return e!=null&&(e.type==="date-only"||e.type==="esriFieldTypeDateOnly")}function wne(e){return e!=null&&(e.type==="timestamp-offset"||e.type==="esriFieldTypeTimestampOffset")}function k8(e){return e!=null&&(e.type==="time-only"||e.type==="esriFieldTypeTimeOnly")}function fL(e){return e!=null&&(e.type==="oid"||e.type==="esriFieldTypeOID")}function mL(e){return e!=null&&(e.type==="global-id"||e.type==="esriFieldTypeGlobalID")}function KCe(e,t){return Sne(e,t)===null}var Cv,Pv;function QCe(e){return e==null||typeof e=="number"&&isNaN(e)?null:e}function Sne(e,t){return e==null||e.nullable&&t===null?null:I8(e,t)?L8(e)&&!xne(e.type,Number(t))?Cv.OUT_OF_RANGE:null:Pv.INVALID_TYPE}function xne(e,t){const i=typeof e=="string"?R8(e):e;if(!i)return!1;const r=i.min,s=i.max;return i.isInteger?Number.isInteger(t)&&t>=r&&t<=s:t>=r&&t<=s}function R8(e){switch(e){case"esriFieldTypeSmallInteger":case"small-integer":return $ne;case"esriFieldTypeInteger":case"esriFieldTypeLong":case"integer":case"long":return Mne;case"esriFieldTypeBigInteger":case"big-integer":return Tne;case"esriFieldTypeSingle":case"single":return Ene;case"esriFieldTypeDouble":case"double":return Cne}}(function(e){e.OUT_OF_RANGE="numeric-range-validation-error::out-of-range"})(Cv||(Cv={})),(function(e){e.INVALID_TYPE="type-validation-error::invalid-type"})(Pv||(Pv={}));const $ne={min:-32768,max:32767,isInteger:!0,rawMin:-32768,rawMax:32767},Mne={min:-2147483648,max:2147483647,isInteger:!0,rawMin:-2147483648,rawMax:2147483647},Tne={min:-Number.MAX_SAFE_INTEGER,max:Number.MAX_SAFE_INTEGER,isInteger:!0,rawMin:-Number.MAX_SAFE_INTEGER,rawMax:Number.MAX_SAFE_INTEGER},Ene={min:-34e37,max:12e37,isInteger:!1,rawMin:-34e37,rawMax:12e37},Cne={min:-Number.MAX_VALUE,max:Number.MAX_VALUE,isInteger:!1,rawMin:-Number.MAX_VALUE,rawMax:Number.MAX_VALUE};function ePe(e,t,i){switch(e){case Ev.INVALID_CODED_VALUE:return`Value ${i} is not in the coded domain - field: ${t.name}, domain: ${JSON.stringify(t.domain)}`;case Ev.VALUE_OUT_OF_RANGE:return`Value ${i} is out of the range of valid values - field: ${t.name}, domain: ${JSON.stringify(t.domain)}`;case Pv.INVALID_TYPE:return`Value ${i} is not a valid value for the field type - field: ${t.name}, type: ${t.type}, nullable: ${t.nullable}`;case Cv.OUT_OF_RANGE:{const{min:r,max:s}=R8(t.type);return`Value ${i} is out of range for the number type - field: ${t.name}, type: ${t.type}, value range is ${r} to ${s}`}}}function tPe(e,t){return!Pne(e,t,null)}function Pne(e,t,i){if(!e?.attributes||!t)return!0;const r=new Set(Object.keys(e.attributes));let s=!1;for(const n of t)if(!r.has(n)&&(s=!0,i==null))break;return s}function iPe(e){return!!e&&["raster.itempixelvalue","raster.servicepixelvalue"].some((t=>e.toLowerCase().startsWith(t)))}function Ine(e){const t=e?.match(/{[^}]+}/g);return t?t.map((i=>i.slice(1,-1).split(":")[0].trim())):[]}let Z_=class extends ee{constructor(t){super(t),this.type=null}};h([f({type:["attachments","custom","fields","media","text","expression","relationship","utility-network-associations"],readOnly:!0,json:{read:!1,write:!0}})],Z_.prototype,"type",void 0),Z_=h([I("esri.popup.content.Content")],Z_);const Ka=Z_,N0=new Ye({asc:"ascending",desc:"descending"});let Mm=class extends xt.ClonableMixin(ee){constructor(t){super(t),this.field=null,this.order="ascending"}};h([f({type:String,json:{write:!0}})],Mm.prototype,"field",void 0),h([f({type:N0.apiValues,json:{type:N0.jsonValues,read:N0.read,write:N0.write}})],Mm.prototype,"order",void 0),Mm=h([I("esri.popup.support.AttachmentsOrderByInfo")],Mm);const Ane=Mm;let wl=class extends xt.ClonableMixin(Ka){constructor(t){super(t),this.description=null,this.displayType="auto",this.orderByFields=null,this.title=null,this.type="attachments"}};h([f({type:String,json:{write:!0}})],wl.prototype,"description",void 0),h([f({type:["auto","preview","list"],json:{write:!0}})],wl.prototype,"displayType",void 0),h([f({type:[Ane],json:{write:!0}})],wl.prototype,"orderByFields",void 0),h([f({type:String,json:{write:!0}})],wl.prototype,"title",void 0),h([f({type:["attachments"],readOnly:!0,json:{read:!1,write:{isRequired:!0}}})],wl.prototype,"type",void 0),wl=h([I("esri.popup.content.AttachmentsContent")],wl);const Xy=wl;var t$;let Bu=t$=class extends Ka{constructor(e){super(e),this.creator=null,this.destroyer=null,this.outFields=null,this.type="custom"}clone(){return new t$({creator:this.creator,destroyer:this.destroyer,outFields:Array.isArray(this.outFields)?V(this.outFields):null})}};h([f()],Bu.prototype,"creator",void 0),h([f()],Bu.prototype,"destroyer",void 0),h([f()],Bu.prototype,"outFields",void 0),h([f({type:["custom"],readOnly:!0})],Bu.prototype,"type",void 0),Bu=t$=h([I("esri.popup.content.CustomContent")],Bu);const Lne=Bu;var i$;let rd=i$=class extends ee{constructor(e){super(e),this.title=null,this.expression=null,this.returnType="dictionary"}clone(){return new i$({title:this.title,expression:this.expression})}};h([f({type:String,json:{write:!0}})],rd.prototype,"title",void 0),h([f({type:String,json:{write:!0}})],rd.prototype,"expression",void 0),h([f({type:["dictionary"],readOnly:!0,json:{read:!1,write:!0}})],rd.prototype,"returnType",void 0),rd=i$=h([I("esri.popup.ElementExpressionInfo")],rd);const kne=rd;var r$;let Tm=r$=class extends Ka{constructor(e){super(e),this.expressionInfo=null,this.type="expression"}clone(){return new r$({expressionInfo:this.expressionInfo?.clone()})}};h([f({type:kne,json:{write:!0}})],Tm.prototype,"expressionInfo",void 0),h([f({type:["expression"],readOnly:!0,json:{read:!1,write:!0}})],Tm.prototype,"type",void 0),Tm=r$=h([I("esri.popup.content.ExpressionContent")],Tm);const aw=Tm;let sd=class extends xt.ClonableMixin(ee){constructor(t){super(t),this.dateFormat=null,this.digitSeparator=!1,this.places=null}};h([me(vK)],sd.prototype,"dateFormat",void 0),h([f({type:Boolean,json:{write:!0}})],sd.prototype,"digitSeparator",void 0),h([f({type:Ue,json:{write:!0}})],sd.prototype,"places",void 0),sd=h([I("esri.popup.support.FieldInfoFormat")],sd);const Rne=sd;var s$;let ln=s$=class extends ee{constructor(e){super(e),this.fieldName=null,this.format=void 0,this.isEditable=!0,this.label=null,this.stringFieldOption="text-box",this.statisticType=null,this.tooltip=null,this.visible=!0}clone(){return new s$({fieldName:this.fieldName,format:this.format?.clone(),isEditable:this.isEditable,label:this.label,stringFieldOption:this.stringFieldOption,statisticType:this.statisticType,tooltip:this.tooltip,visible:this.visible})}};h([f({type:String,json:{write:!0}})],ln.prototype,"fieldName",void 0),h([f({type:Rne,json:{write:!0}})],ln.prototype,"format",void 0),h([f({type:Boolean,json:{write:{alwaysWriteDefaults:!0},default:!0}})],ln.prototype,"isEditable",void 0),h([f({type:String,json:{write:!0}})],ln.prototype,"label",void 0),h([me(new Ye({richtext:"rich-text",textarea:"text-area",textbox:"text-box"}),{default:"text-box"})],ln.prototype,"stringFieldOption",void 0),h([f({type:["count","sum","min","max","avg","stddev","var"],json:{write:!0}})],ln.prototype,"statisticType",void 0),h([f({type:String,json:{write:!0}})],ln.prototype,"tooltip",void 0),h([f({type:Boolean,json:{write:!0}})],ln.prototype,"visible",void 0),ln=s$=h([I("esri.popup.FieldInfo")],ln);const O8=ln;var n$;let ca=n$=class extends Ka{constructor(e){super(e),this.attributes=null,this.description=null,this.fieldInfos=null,this.title=null,this.type="fields"}writeFieldInfos(e,t){t.fieldInfos=e&&e.map((i=>i.toJSON()))}clone(){return new n$(V({attributes:this.attributes,description:this.description,fieldInfos:this.fieldInfos,title:this.title}))}};h([f({type:Object,json:{write:!0}})],ca.prototype,"attributes",void 0),h([f({type:String,json:{write:!0}})],ca.prototype,"description",void 0),h([f({type:[O8]})],ca.prototype,"fieldInfos",void 0),h([$e("fieldInfos")],ca.prototype,"writeFieldInfos",null),h([f({type:String,json:{write:!0}})],ca.prototype,"title",void 0),h([f({type:["fields"],readOnly:!0,json:{read:!1,write:{isRequired:!0}}})],ca.prototype,"type",void 0),ca=n$=h([I("esri.popup.content.FieldsContent")],ca);const Ky=ca;let qu=class extends ee{constructor(t){super(t),this.altText=null,this.caption="",this.title="",this.type=null}};h([f({type:String,json:{write:!0}})],qu.prototype,"altText",void 0),h([f({type:String,json:{write:!0}})],qu.prototype,"caption",void 0),h([f({type:String,json:{write:!0}})],qu.prototype,"title",void 0),h([f({type:["image","bar-chart","column-chart","line-chart","pie-chart"],readOnly:!0,json:{read:!1,write:!0}})],qu.prototype,"type",void 0),qu=h([I("esri.popup.content.mixins.MediaInfo")],qu);const qC=qu;var o$;let Hu=o$=class extends le{constructor(e){super(e),this.color=null,this.fieldName=null,this.tooltip=null,this.value=null}clone(){return new o$({color:this.color?.clone(),fieldName:this.fieldName,tooltip:this.tooltip,value:this.value})}};h([f()],Hu.prototype,"color",void 0),h([f()],Hu.prototype,"fieldName",void 0),h([f()],Hu.prototype,"tooltip",void 0),h([f()],Hu.prototype,"value",void 0),Hu=o$=h([I("esri.popup.content.support.ChartMediaInfoValueSeries")],Hu);const One=Hu;var a$;let Sl=a$=class extends ee{constructor(e){super(e),this.colors=null,this.fields=[],this.normalizeField=null,this.series=[],this.tooltipField=null}clone(){return new a$({colors:V(this.colors),fields:V(this.fields),normalizeField:this.normalizeField,series:V(this.series),tooltipField:this.tooltipField})}};h([f({type:[X],json:{type:[[Ue]],write:!0}})],Sl.prototype,"colors",void 0),h([f({type:[String],json:{write:{isRequired:!0}}})],Sl.prototype,"fields",void 0),h([f({type:String,json:{write:!0}})],Sl.prototype,"normalizeField",void 0),h([f({type:[One],json:{read:!1}})],Sl.prototype,"series",void 0),h([f({type:String,json:{write:!0}})],Sl.prototype,"tooltipField",void 0),Sl=a$=h([I("esri.popup.content.support.ChartMediaInfoValue")],Sl);const Nne=Sl;let Em=class extends qC{constructor(t){super(t),this.type=null,this.value=void 0}};h([f({type:["bar-chart","column-chart","line-chart","pie-chart"],readOnly:!0,json:{read:!1,write:!0}})],Em.prototype,"type",void 0),h([f({type:Nne,json:{write:{isRequired:!0}}})],Em.prototype,"value",void 0),Em=h([I("esri.popup.content.mixins.ChartMediaInfo")],Em);const lw=Em,uw=cr()({barchart:"bar-chart",columnchart:"column-chart",linechart:"line-chart",piechart:"pie-chart"});var l$;let Y_=l$=class extends lw{constructor(e){super(e),this.type="bar-chart"}clone(){return new l$({altText:this.altText,title:this.title,caption:this.caption,value:this.value?.clone()})}};h([f({type:["bar-chart"],readOnly:!0,json:{type:["barchart"],read:!1,write:{writer:uw.write,isRequired:!0}}})],Y_.prototype,"type",void 0),Y_=l$=h([I("esri.popup.content.BarChartMediaInfo")],Y_);const N8=Y_;var u$;let J_=u$=class extends lw{constructor(e){super(e),this.type="column-chart"}clone(){return new u$({altText:this.altText,title:this.title,caption:this.caption,value:this.value?.clone()})}};h([f({type:["column-chart"],readOnly:!0,json:{type:["columnchart"],read:!1,write:{writer:uw.write,isRequired:!0}}})],J_.prototype,"type",void 0),J_=u$=h([I("esri.popup.content.ColumnChartMediaInfo")],J_);const D8=J_;var c$;let Cm=c$=class extends ee{constructor(e){super(e),this.linkURL=null,this.sourceURL=null}clone(){return new c$({linkURL:this.linkURL,sourceURL:this.sourceURL})}};h([f({type:String,json:{write:!0}})],Cm.prototype,"linkURL",void 0),h([f({type:String,json:{write:{isRequired:!0}}})],Cm.prototype,"sourceURL",void 0),Cm=c$=h([I("esri.popup.content.support.ImageMediaInfoValue")],Cm);const Dne=Cm;var h$;let nd=h$=class extends qC{constructor(e){super(e),this.refreshInterval=0,this.type="image",this.value=void 0}clone(){return new h$({altText:this.altText,title:this.title,caption:this.caption,refreshInterval:this.refreshInterval,value:this.value?.clone()})}};h([f({type:Number,json:{write:!0}})],nd.prototype,"refreshInterval",void 0),h([f({type:["image"],readOnly:!0,json:{read:!1,write:{isRequired:!0}}})],nd.prototype,"type",void 0),h([f({type:Dne,json:{write:{isRequired:!0}}})],nd.prototype,"value",void 0),nd=h$=h([I("esri.popup.content.ImageMediaInfo")],nd);const F8=nd;var d$;let X_=d$=class extends lw{constructor(e){super(e),this.type="line-chart"}clone(){return new d$({altText:this.altText,title:this.title,caption:this.caption,value:this.value?.clone()})}};h([f({type:["line-chart"],readOnly:!0,json:{type:["linechart"],read:!1,write:{writer:uw.write,isRequired:!0}}})],X_.prototype,"type",void 0),X_=d$=h([I("esri.popup.content.LineChartMediaInfo")],X_);const z8=X_;var p$;let K_=p$=class extends lw{constructor(e){super(e),this.type="pie-chart"}clone(){return new p$({altText:this.altText,title:this.title,caption:this.caption,value:this.value?.clone()})}};h([f({type:["pie-chart"],readOnly:!0,json:{type:["piechart"],read:!1,write:{writer:uw.write,isRequired:!0}}})],K_.prototype,"type",void 0),K_=p$=h([I("esri.popup.content.PieChartMediaInfo")],K_);const V8=K_,f$={base:qC,key:"type",defaultKeyValue:"image",typeMap:{"bar-chart":N8,"column-chart":D8,"line-chart":z8,"pie-chart":V8,image:F8}};var m$;let un=m$=class extends Ka{constructor(e){super(e),this.activeMediaInfoIndex=null,this.attributes=null,this.description=null,this.mediaInfos=null,this.title=null,this.type="media"}readMediaInfos(e){return e&&e.map((t=>t.type==="image"?F8.fromJSON(t):t.type==="barchart"?N8.fromJSON(t):t.type==="columnchart"?D8.fromJSON(t):t.type==="linechart"?z8.fromJSON(t):t.type==="piechart"?V8.fromJSON(t):void 0)).filter(Boolean)}writeMediaInfos(e,t){t.mediaInfos=e&&e.map((i=>i.toJSON()))}clone(){return new m$(V({activeMediaInfoIndex:this.activeMediaInfoIndex,attributes:this.attributes,description:this.description,mediaInfos:this.mediaInfos,title:this.title}))}};h([f()],un.prototype,"activeMediaInfoIndex",void 0),h([f({type:Object,json:{write:!0}})],un.prototype,"attributes",void 0),h([f({type:String,json:{write:!0}})],un.prototype,"description",void 0),h([f({types:[f$]})],un.prototype,"mediaInfos",void 0),h([Ae("mediaInfos")],un.prototype,"readMediaInfos",null),h([$e("mediaInfos")],un.prototype,"writeMediaInfos",null),h([f({type:String,json:{write:!0}})],un.prototype,"title",void 0),h([f({type:["media"],readOnly:!0,json:{read:!1,write:{isRequired:!0}}})],un.prototype,"type",void 0),un=m$=h([I("esri.popup.content.MediaContent")],un);const Qy=un;var y$;let Pm=y$=class extends ee{constructor(e){super(e),this.field=null,this.order=null}clone(){return new y$({field:this.field,order:this.order})}};h([f({type:String,json:{write:!0}})],Pm.prototype,"field",void 0),h([f({type:["asc","desc"],json:{write:!0}})],Pm.prototype,"order",void 0),Pm=y$=h([I("esri.popup.support.RelatedRecordsInfoFieldOrder")],Pm);const U8=Pm;let qn=class extends xt.ClonableMixin(Ka){constructor(t){super(t),this.description=null,this.displayCount=null,this.displayType="list",this.orderByFields=null,this.relationshipId=null,this.title=null,this.type="relationship"}};h([f({type:String,json:{write:!0}})],qn.prototype,"description",void 0),h([f({type:Number,json:{type:Ue,write:!0}})],qn.prototype,"displayCount",void 0),h([f({type:["list"],json:{write:{isRequired:!0}}})],qn.prototype,"displayType",void 0),h([f({type:[U8],json:{write:!0}})],qn.prototype,"orderByFields",void 0),h([f({type:Number,json:{type:Ue,write:{isRequired:!0}}})],qn.prototype,"relationshipId",void 0),h([f({type:String,json:{write:!0}})],qn.prototype,"title",void 0),h([f({type:["relationship"],readOnly:!0,json:{read:!1,write:{isRequired:!0}}})],qn.prototype,"type",void 0),qn=h([I("esri.popup.content.RelationshipContent")],qn);const eg=qn;var g$;let Im=g$=class extends Ka{constructor(e){super(e),this.text=null,this.type="text"}clone(){return new g$({text:this.text})}};h([f({type:String,json:{write:!0}})],Im.prototype,"text",void 0),h([f({type:["text"],readOnly:!0,json:{read:!1,write:{isRequired:!0}}})],Im.prototype,"type",void 0),Im=g$=h([I("esri.popup.content.TextContent")],Im);const tg=Im;let ha=class extends xt.ClonableMixin(ee){constructor(t){super(t),this.title=null,this.description=null,this.type=null,this.associatedNetworkSourceId=null,this.associatedAssetGroup=null,this.associatedAssetType=null}};h([f({type:String,json:{write:!0}})],ha.prototype,"title",void 0),h([f({type:String,json:{write:!0}})],ha.prototype,"description",void 0),h([f({type:["attachment","connectivity","container","content","structure"],json:{write:!0}})],ha.prototype,"type",void 0),h([f({type:Number,json:{type:Ue,write:!0}})],ha.prototype,"associatedNetworkSourceId",void 0),h([f({type:Number,json:{type:Ue,write:!0}})],ha.prototype,"associatedAssetGroup",void 0),h([f({type:Number,json:{type:Ue,write:!0}})],ha.prototype,"associatedAssetType",void 0),ha=h([I("esri.popup.support.UtilityNetworkAssociationType")],ha);const Fne=ha;let xl=class extends xt.ClonableMixin(Ka){constructor(t){super(t),this.description=null,this.displayCount=null,this.title=null,this.associationTypes=[],this.type="utility-network-associations"}};h([f({type:String,json:{write:!0}})],xl.prototype,"description",void 0),h([f({type:Number,json:{type:Ue,write:!0}})],xl.prototype,"displayCount",void 0),h([f({type:String,json:{write:!0}})],xl.prototype,"title",void 0),h([f({type:[Fne],json:{write:!0}})],xl.prototype,"associationTypes",void 0),h([me({utilityNetworkAssociations:"utility-network-associations"})],xl.prototype,"type",void 0),xl=h([I("esri.popup.content.UtilityNetworkAssociationsContent")],xl);const HC=xl,zne={base:null,key:"type",typeMap:{attachment:Xy,media:Qy,text:tg,expression:aw,field:Ky,relationship:eg,utilityNetworkAssociations:HC}},Vne={base:null,key:"type",typeMap:{attachment:Xy,media:Qy,text:tg,expression:aw,field:Ky,relationship:eg}};var _$;let Wu=_$=class extends ee{constructor(e){super(e),this.name=null,this.title=null,this.expression=null,this.returnType=null}clone(){return new _$({name:this.name,title:this.title,expression:this.expression,returnType:this.returnType})}};h([f({type:String,json:{write:!0}})],Wu.prototype,"name",void 0),h([f({type:String,json:{write:!0}})],Wu.prototype,"title",void 0),h([f({type:String,json:{write:!0}})],Wu.prototype,"expression",void 0),h([f({type:["string","number"],json:{write:!0}})],Wu.prototype,"returnType",void 0),Wu=_$=h([I("esri.popup.ExpressionInfo")],Wu);const Une=Wu;var v$;let Am=v$=class extends ee{constructor(e){super(e),this.returnTopmostRaster=null,this.showNoDataRecords=null}clone(){return new v$({showNoDataRecords:this.showNoDataRecords,returnTopmostRaster:this.returnTopmostRaster})}};h([f({type:Boolean,json:{write:!0}})],Am.prototype,"returnTopmostRaster",void 0),h([f({type:Boolean,json:{write:!0}})],Am.prototype,"showNoDataRecords",void 0),Am=v$=h([I("esri.popup.LayerOptions")],Am);const jne=Am;var b$;let Lm=b$=class extends ee{constructor(e){super(e),this.showRelatedRecords=null,this.orderByFields=null}clone(){return new b$({showRelatedRecords:this.showRelatedRecords,orderByFields:this.orderByFields?V(this.orderByFields):null})}};h([f({type:Boolean,json:{write:!0}})],Lm.prototype,"showRelatedRecords",void 0),h([f({type:[U8],json:{write:!0}})],Lm.prototype,"orderByFields",void 0),Lm=b$=h([I("esri.popup.RelatedRecordsInfo")],Lm);const yL=Lm;var w$;let ws=w$=class extends Bg.IdentifiableMixin(le){constructor(e){super(e),this.active=!1,this.className=null,this.disabled=!1,this.icon=null,this.id=null,this.indicator=!1,this.title=null,this.type=null,this.visible=!0}clone(){return new w$({active:this.active,className:this.className,disabled:this.disabled,icon:this.icon,id:this.id,indicator:this.indicator,title:this.title,visible:this.visible})}};h([f()],ws.prototype,"active",void 0),h([f()],ws.prototype,"className",void 0),h([f()],ws.prototype,"disabled",void 0),h([f()],ws.prototype,"icon",void 0),h([f()],ws.prototype,"id",void 0),h([f()],ws.prototype,"indicator",void 0),h([f()],ws.prototype,"title",void 0),h([f()],ws.prototype,"type",void 0),h([f()],ws.prototype,"visible",void 0),ws=w$=h([I("esri.support.actions.ActionBase")],ws);const WC=ws;var S$;let Q_=S$=class extends WC{constructor(e){super(e),this.image=null,this.type="button"}clone(){return new S$({active:this.active,className:this.className,disabled:this.disabled,icon:this.icon,id:this.id,indicator:this.indicator,title:this.title,visible:this.visible,image:this.image})}};h([f()],Q_.prototype,"image",void 0),Q_=S$=h([I("esri.support.actions.ActionButton")],Q_);const Gne=Q_;var x$;let km=x$=class extends WC{constructor(e){super(e),this.image=null,this.type="toggle",this.value=!1}clone(){return new x$({active:this.active,className:this.className,disabled:this.disabled,icon:this.icon,id:this.id,indicator:this.indicator,title:this.title,visible:this.visible,image:this.image,value:this.value})}};h([f()],km.prototype,"image",void 0),h([f()],km.prototype,"value",void 0),km=x$=h([I("esri.support.actions.ActionToggle")],km);const Bne=km,Uf="relationships/",gL="expression/",qne=ne.ofType({key:"type",defaultKeyValue:"button",base:WC,typeMap:{button:Gne,toggle:Bne}}),Hne={base:Ka,key:"type",typeMap:{media:Qy,custom:Lne,text:tg,attachments:Xy,fields:Ky,expression:aw,relationship:eg,utilityNetworkAssociations:HC}},j8=new Set(["attachments","fields","media","text","expression","relationship"]),Wne=new Set([...j8,"utility-network-associations"]);let oi=class extends xt.ClonableMixin(ee){constructor(){super(...arguments),this.actions=null,this.content="",this.expressionInfos=null,this.fieldInfos=null,this.layerOptions=null,this.lastEditInfoEnabled=!0,this.outFields=null,this.overwriteActions=!1,this.returnGeometry=!1,this.title=""}castContent(t){return Array.isArray(t)?t.map((i=>hu(Hne,i))):typeof t=="string"||typeof t=="function"||t instanceof HTMLElement||Bo(t)?t:(H.getLogger(this).error("content error","unsupported content value",{value:t}),null)}readContent(t,i){const{popupElements:r}=i;return Array.isArray(r)&&r.length>0?this._readPopupInfoElements(i.description,i.mediaInfos,r):this._readPopupInfo(i)}writeWebSceneContent(t,i,r,s){this._writePopupTemplateContent(t,i,s)}writeWebMapContent(t,i,r,s){this._writePopupTemplateContent(t,i,s)}writeFieldInfos(t,i,r,s){const{content:n}=this,o=Array.isArray(n)?n:null;if(t){const a=o?o.filter((u=>u.type==="fields")):[],l=a.length&&a.every((u=>u.fieldInfos?.length));i.fieldInfos=t.filter(Boolean).map((u=>{const c=u.toJSON(s);return l&&(c.visible=!1),c}))}if(o)for(const a of o)a.type==="fields"&&this._writeFieldsContent(a,i)}writeLayerOptions(t,i,r,s){i[r]=!t||t.showNoDataRecords===null&&t.returnTopmostRaster===null?null:t.toJSON(s)}writeTitle(t,i){i.title=t||""}async collectRequiredFields(t,i){const r=this.expressionInfos||[];await this._collectExpressionInfoFields(t,i,[...r,...this._getContentExpressionInfos(this.content,r)]),Yp(t,i,[...this.outFields||[],...this._getActionsFields(this.actions),...this._getTitleFields(this.title),...this._getContentFields(this.content)])}async getRequiredFields(t){const i=new Set;return await this.collectRequiredFields(i,t),[...i].sort()}_writePopupTemplateContent(t,i,r){typeof t!="string"?Array.isArray(t)&&(i.popupElements=t.filter((s=>r?.origin==="web-scene"?j8.has(s.type):Wne.has(s.type))).map((s=>s?.toJSON(r))),i.popupElements.forEach((s=>{s.type==="attachments"?this._writeAttachmentContent(i):s.type==="media"?this._writeMediaContent(s,i):s.type==="text"?this._writeTextContent(s,i):s.type==="relationship"&&this._writeRelationshipContent(s,i)}))):i.description=t}_writeFieldsContent(t,i){if(!Array.isArray(t.fieldInfos)||!t.fieldInfos.length)return;const r=V(t.fieldInfos);Array.isArray(i.fieldInfos)?r.forEach((s=>{const n=i.fieldInfos.find((o=>o.fieldName?.toLowerCase()===s.fieldName?.toLowerCase()));n?n.visible=!0:i.fieldInfos.push(s)})):i.fieldInfos=r}_writeAttachmentContent(t){t.showAttachments||(t.showAttachments=!0)}_writeRelationshipContent(t,i){const r=t.orderByFields?.map((n=>this._toFieldOrderJSON(n,t.relationshipId)))||[],s=[...i.relatedRecordsInfo?.orderByFields||[],...r];i.relatedRecordsInfo={showRelatedRecords:!0,...s?.length&&{orderByFields:s}}}_writeTextContent(t,i){!i.description&&t.text&&(i.description=t.text)}_writeMediaContent(t,i){if(!Array.isArray(t.mediaInfos)||!t.mediaInfos.length)return;const r=V(t.mediaInfos);Array.isArray(i.mediaInfos)?i.mediaInfos=[...i.mediaInfos,...r]:i.mediaInfos=r}_readPopupInfoElements(t,i,r){const s={description:!1,mediaInfos:!1};return r.map((n=>n.type==="media"?(n.mediaInfos||!i||s.mediaInfos||(n.mediaInfos=i,s.mediaInfos=!0),Qy.fromJSON(n)):n.type==="text"?(n.text||!t||s.description||(n.text=t,s.description=!0),tg.fromJSON(n)):n.type==="attachments"?Xy.fromJSON(n):n.type==="fields"?Ky.fromJSON(n):n.type==="expression"?aw.fromJSON(n):n.type==="relationship"?eg.fromJSON(n):n.type==="utilityNetworkAssociations"?HC.fromJSON(n):void 0)).filter(Boolean)}_toRelationshipContent(t){const{field:i,order:r}=t;if(!i?.startsWith(Uf))return null;const s=i.replace(Uf,"").split("/");if(s.length!==2)return null;const n=parseInt(s[0],10),o=s[1];return!Number.isNaN(n)&&o?eg.fromJSON({relationshipId:n,orderByFields:[{field:o,order:r}]}):null}_toFieldOrderJSON(t,i){const{order:r,field:s}=t;return{field:`${Uf}${i}/${s}`,order:r}}_readPopupInfo({description:t,mediaInfos:i,showAttachments:r,relatedRecordsInfo:s={showRelatedRecords:!1}}){const n=[];t?n.push(new tg({text:t})):n.push(new Ky),Array.isArray(i)&&i.length&&n.push(Qy.fromJSON({mediaInfos:i})),r&&n.push(Xy.fromJSON({displayType:"auto"}));const{showRelatedRecords:o,orderByFields:a}=s;return o&&a?.length&&a.forEach((l=>{const u=this._toRelationshipContent(l);u&&n.push(u)})),n.length?n:t}_getContentElementFields(t){const i=t?.type;if(i==="attachments")return[...this._extractFieldNames(t.title),...this._extractFieldNames(t.description)];if(i==="custom")return t.outFields||[];if(i==="fields")return[...this._extractFieldNames(t.title),...this._extractFieldNames(t.description),...this._getFieldInfoFields(t.fieldInfos??this.fieldInfos)];if(i==="media"){const r=t.mediaInfos||[];return[...this._extractFieldNames(t.title),...this._extractFieldNames(t.description),...r.reduce(((s,n)=>[...s,...this._getMediaInfoFields(n)]),[])]}return i==="text"?this._extractFieldNames(t.text):i==="relationship"||i==="utility-network-associations"?[...this._extractFieldNames(t.title),...this._extractFieldNames(t.description)]:[]}_getMediaInfoFields(t){const{caption:i,title:r,value:s}=t,n=s||{},{fields:o,normalizeField:a,tooltipField:l,sourceURL:u,linkURL:c}=n,d=[...this._extractFieldNames(r),...this._extractFieldNames(i),...this._extractFieldNames(u),...this._extractFieldNames(c),...o??[]];return a&&d.push(a),l&&d.push(l),d}_getContentExpressionInfos(t,i){return Array.isArray(t)?t.reduce(((r,s)=>[...r,...s.type==="expression"&&s.expressionInfo?[s.expressionInfo]:[]]),i):[]}_getContentFields(t){return typeof t=="string"?this._extractFieldNames(t):Array.isArray(t)?t.reduce(((i,r)=>[...i,...this._getContentElementFields(r)]),[]):[]}async _collectExpressionInfoFields(t,i,r){r&&await Promise.all(r.map((s=>ur(t,i,s.expression))))}_getFieldInfoFields(t){return t?t.filter((({fieldName:i,visible:r})=>!(r!==void 0&&!r||!i||i.startsWith(Uf)||i.startsWith(gL)))).map((i=>i.fieldName)):[]}_getActionsFields(t){return t?t.toArray().reduce(((i,r)=>[...i,...this._getActionFields(r)]),[]):[]}_getActionFields(t){const{className:i,title:r,type:s}=t,n=s==="button"||s==="toggle"?t.image:"";return[...this._extractFieldNames(r),...this._extractFieldNames(i),...this._extractFieldNames(n)]}_getTitleFields(t){return typeof t=="string"?this._extractFieldNames(t):[]}_extractFieldNames(t){return Ine(t).filter((i=>!(i.indexOf(Uf)===0||i.indexOf(gL)===0)))}};h([f({type:qne})],oi.prototype,"actions",void 0),h([f()],oi.prototype,"content",void 0),h([Ke("content")],oi.prototype,"castContent",null),h([Ae("content",["description","fieldInfos","popupElements","mediaInfos","showAttachments","relatedRecordsInfo"])],oi.prototype,"readContent",null),h([$e("web-scene","content",{popupElements:{type:ne.ofType(Vne)},showAttachments:{type:Boolean},mediaInfos:{type:ne.ofType(f$)},description:{type:String},relatedRecordsInfo:{type:yL}})],oi.prototype,"writeWebSceneContent",null),h([$e("content",{popupElements:{type:ne.ofType(zne)},showAttachments:{type:Boolean},mediaInfos:{type:ne.ofType(f$)},description:{type:String},relatedRecordsInfo:{type:yL}})],oi.prototype,"writeWebMapContent",null),h([f({type:[Une],json:{write:!0}})],oi.prototype,"expressionInfos",void 0),h([f({type:[O8]})],oi.prototype,"fieldInfos",void 0),h([$e("fieldInfos")],oi.prototype,"writeFieldInfos",null),h([f({type:jne})],oi.prototype,"layerOptions",void 0),h([$e("layerOptions")],oi.prototype,"writeLayerOptions",null),h([f({type:Boolean,json:{read:{source:"showLastEditInfo"},write:{target:"showLastEditInfo"},default:!0}})],oi.prototype,"lastEditInfoEnabled",void 0),h([f()],oi.prototype,"outFields",void 0),h([f()],oi.prototype,"overwriteActions",void 0),h([f()],oi.prototype,"returnGeometry",void 0),h([f({json:{type:String}})],oi.prototype,"title",void 0),h([$e("title")],oi.prototype,"writeTitle",null),oi=h([I("esri.PopupTemplate")],oi);const Zne=oi;function pPe(e,t){switch(t.type){case"object-id":case"unique-id-simple":return e.attributes[t.fieldName];case"unique-id-composite":{const i=[];for(const r of t.fieldNames)i.push(e.attributes[r]??null);return JSON.stringify(i)}}}function Yne(e,t){if("uniqueIdFields"in t&&t.uniqueIdFields?.length){if(t.uniqueIdFields.length===1)return e.attributes?.[t.uniqueIdFields[0]];const i=t.uniqueIdFields.map((r=>e.attributes?.[r]));return JSON.stringify(i)}return"objectIdField"in t&&t.objectIdField?e.attributes?.[t.objectIdField]:null}const _L=new Ye({esriSMS:"simple-marker",esriPMS:"picture-marker",esriSLS:"simple-line",esriSFS:"simple-fill",esriPFS:"picture-fill",esriTS:"text",esriSHD:"shield-label-symbol",PointSymbol3D:"point-3d",LineSymbol3D:"line-3d",PolygonSymbol3D:"polygon-3d",WebStyleSymbol:"web-style",MeshSymbol3D:"mesh-3d",LabelSymbol3D:"label-3d",CIMSymbolReference:"cim"});let Jne=0,Kt=class extends ee{constructor(t){super(t),this.id="sym"+Jne++,this.type=null,this.color=new X([0,0,0,1])}readColor(t){return t?.[0]!=null?[t[0],t[1],t[2],t[3]/255]:t}async collectRequiredFields(t,i){}hash(){return JSON.stringify(this.toJSON())}clone(){}};h([f({type:_L.apiValues,readOnly:!0,json:{read:!1,write:{ignoreOrigin:!0,writer:_L.write,isRequired:!0}}})],Kt.prototype,"type",void 0),h([f({type:X,json:{write:{allowNull:!0}}})],Kt.prototype,"color",void 0),h([Ae("color")],Kt.prototype,"readColor",null),Kt=h([I("esri.symbols.Symbol")],Kt);var $$;let er=$$=class extends Kt{constructor(e){super(e),this.data=null,this.type="cim"}readData(e,t){return t}writeData(e,t){Object.assign(t,e)}async collectRequiredFields(e,t){if(this.data?.type==="CIMSymbolReference"){const i=this.data.primitiveOverrides;if(i){const r=i.map((s=>{const n=s.valueExpressionInfo;return n?ur(e,t,n.expression):null}));await Promise.all(r)}}}clone(){return new $$({data:V(this.data)})}hash(){return WN(JSON.stringify(this.data)).toString()}};h([f({json:{write:!1}})],er.prototype,"color",void 0),h([f({json:{write:!0}})],er.prototype,"data",void 0),h([Ae("data",["symbol"])],er.prototype,"readData",null),h([$e("data",{})],er.prototype,"writeData",null),h([me({CIMSymbolReference:"cim"},{readOnly:!0})],er.prototype,"type",void 0),er=$$=h([I("esri.symbols.CIMSymbol")],er);let Mr=class extends ee{constructor(t){super(t),this.enabled=!0,this.type=null,this.ignoreDrivers=!1}writeEnabled(t,i,r){t||(i[r]=t)}};h([f({type:Boolean,json:{read:{source:"enable"},write:{target:"enable"}}})],Mr.prototype,"enabled",void 0),h([$e("enabled")],Mr.prototype,"writeEnabled",null),h([f({type:["icon","object","line","path","fill","water","extrude","text"],readOnly:!0,json:{write:{isRequired:!0}}})],Mr.prototype,"type",void 0),Mr=h([I("esri.symbols.Symbol3DLayer")],Mr);function Xne(e,t){const i=t.transparency!=null?xC(t.transparency):1,r=t.color;return r&&Array.isArray(r)?new X([r[0]||0,r[1]||0,r[2]||0,i]):null}function Kne(e,t){t.color=e.toJSON().slice(0,3);const i=SC(e.a);i!==0&&(t.transparency=i)}function Mu(e){return{type:X,nonNullable:e?.nonNullable,json:{type:[Ue],default:null,read:{source:["color","transparency"],reader:Xne},write:{target:{color:{type:[Ue],isRequired:e?.colorRequiredOnWrite},transparency:{type:Ue}},writer:Kne}}}}const jo={type:Number,cast:ct,json:{write:!0}};var Iv;function yPe(e){return e==="emissive"?Iv.Emissive:Iv.Color}(function(e){e[e.Emissive=0]="Emissive",e[e.Color=1]="Color"})(Iv||(Iv={}));let Zu=class extends ee{constructor(t){super(t),this.color=new X([0,0,0,1]),this.extensionLength=0,this.size=We(1)}clone(){}cloneProperties(){return{color:V(this.color),size:this.size,extensionLength:this.extensionLength}}};h([f({type:["solid","sketch"],readOnly:!0,json:{read:!0,write:{ignoreOrigin:!0,isRequired:!0}}})],Zu.prototype,"type",void 0),h([f(Mu({colorRequiredOnWrite:!0}))],Zu.prototype,"color",void 0),h([f({...jo,json:{write:{overridePolicy:e=>({enabled:!!e})}}})],Zu.prototype,"extensionLength",void 0),h([f(jo)],Zu.prototype,"size",void 0),Zu=h([I("esri.symbols.edges.Edges3D")],Zu);const ZC=Zu;var M$;let e1=M$=class extends ZC{constructor(e){super(e),this.type="sketch"}clone(){return new M$(this.cloneProperties())}};h([me({sketch:"sketch"},{readOnly:!0})],e1.prototype,"type",void 0),e1=M$=h([I("esri.symbols.edges.SketchEdges3D")],e1);const Qne=e1;var T$;let t1=T$=class extends ZC{constructor(e){super(e),this.type="solid"}clone(){return new T$(this.cloneProperties())}};h([me({solid:"solid"},{readOnly:!0})],t1.prototype,"type",void 0),t1=T$=h([I("esri.symbols.edges.SolidEdges3D")],t1);const G8=t1,B8={types:{key:"type",base:ZC,typeMap:{solid:G8,sketch:Qne}},json:{write:!0}};var E$;let Cd=E$=class extends ee{constructor(){super(...arguments),this.strength=null,this.source="emissive"}clone(){const e={strength:this.strength,source:this.source};return new E$(e)}};h([f({json:{write:!1}})],Cd.prototype,"strength",void 0),h([f({json:{write:!1}})],Cd.prototype,"source",void 0),Cd=E$=h([I("esri.symbols.support.Symbol3DEmissive")],Cd);var C$;let Gr=C$=class extends ee{constructor(e){super(e),this.color=null,this.emissive=new Cd({source:"emissive"})}clone(){const e={color:this.color?.clone()??null,emissive:this.emissive?.clone()??null};return new C$(e)}};h([f(Mu())],Gr.prototype,"color",void 0),h([f({type:Cd,json:{write:!1}})],Gr.prototype,"emissive",void 0),Gr=C$=h([I("esri.symbols.support.Symbol3DMaterial")],Gr);var P$,pp;let va=(pp=class extends Mr{constructor(t){super(t),this.type="extrude",this.size=1,this.material=null,this.castShadows=!0,this.edges=null}clone(){return new P$({edges:this.edges?.clone(),enabled:this.enabled,material:this.material?.clone(),castShadows:this.castShadows,size:this.size})}},P$=pp,pp);h([me({Extrude:"extrude"},{readOnly:!0})],va.prototype,"type",void 0),h([f({type:Number,json:{write:{enabled:!0,isRequired:!0}},nonNullable:!0})],va.prototype,"size",void 0),h([f({type:Gr,json:{write:!0}})],va.prototype,"material",void 0),h([f({type:Boolean,nonNullable:!0,json:{write:!0,default:!0}})],va.prototype,"castShadows",void 0),h([f(B8)],va.prototype,"edges",void 0),va=P$=h([I("esri.symbols.ExtrudeSymbol3DLayer")],va);let Sy=class extends ee{constructor(t){super(t)}clone(){throw new Error("Subclasses of LinePattern3D should implement their own clone method.")}};h([f({type:["style"],readOnly:!0,json:{read:!0,write:{ignoreOrigin:!0}}})],Sy.prototype,"type",void 0),Sy=h([I("esri.symbols.patterns.LinePattern3D")],Sy);const eoe=["dash","dash-dot","dot","long-dash","long-dash-dot","long-dash-dot-dot","none","short-dash","short-dash-dot","short-dash-dot-dot","short-dot","solid"];var I$;const toe=cr()({dash:"dash","dash-dot":"dash-dot","dash-dot-dot":"long-dash-dot-dot",dot:"dot","long-dash":"long-dash","long-dash-dot":"long-dash-dot",null:"none","short-dash":"short-dash","short-dash-dot":"short-dash-dot","short-dash-dot-dot":"short-dash-dot-dot","short-dot":"short-dot",solid:"solid"});let Lc=I$=class extends Sy{constructor(e){super(e),this.type="style",this.style="solid"}clone(){const e={style:this.style};return new I$(e)}};h([f({type:["style"],json:{write:{isRequired:!0}}})],Lc.prototype,"type",void 0),h([me(toe),f({type:eoe,json:{write:{isRequired:!0}}})],Lc.prototype,"style",void 0),Lc=I$=h([I("esri.symbols.patterns.LineStylePattern3D")],Lc);let xy=class extends ee{constructor(t){super(t),this.type="style"}clone(){throw new Error("Subclasses of Pattern3D should implement their own clone method.")}};h([f({type:["style"],readOnly:!0,json:{read:!0,write:{ignoreOrigin:!0}}})],xy.prototype,"type",void 0),xy=h([I("esri.symbols.patterns.Pattern3D")],xy);const ioe=["backward-diagonal","cross","diagonal-cross","forward-diagonal","horizontal","none","solid","vertical"];var A$;let Pd=A$=class extends xy{constructor(e){super(e),this.type="style",this.style="solid"}clone(){return new A$({style:this.style})}};h([f({type:["style"],json:{write:{isRequired:!0}}})],Pd.prototype,"type",void 0),h([f({type:ioe,json:{read:!0,write:{isRequired:!0}}})],Pd.prototype,"style",void 0),Pd=A$=h([I("esri.symbols.patterns.StylePattern3D")],Pd);const roe={types:{key:"type",base:xy,typeMap:{style:Pd}},json:{write:!0}},q8={types:{key:"type",base:Sy,typeMap:{style:Lc}},json:{write:!0}},$y=new X("white"),soe=new X([255,255,255,0]);function noe(e){return e.r===0&&e.g===0&&e.b===0}var L$;let My=L$=class extends Gr{constructor(e){super(e),this.colorMixMode=null}clone(){const e={color:this.color?.clone()??null,colorMixMode:this.colorMixMode,emissive:this.emissive?.clone()??null};return new L$(e)}};h([me({multiply:"multiply",replace:"replace",tint:"tint"})],My.prototype,"colorMixMode",void 0),My=L$=h([I("esri.symbols.support.Symbol3DFillMaterial")],My);function ooe(e,t=!1){return e<=VN?t?new Array(e).fill(0):new Array(e):new Float64Array(e)}function bPe(e){return(zN(e)?e.byteLength/8:e.length)<=VN?Array.from(e):new Float64Array(e)}function wPe(e,t,i){return Array.isArray(e)?e.slice(t,t+i):e.subarray(t,t+i)}function Hg(e=coe){return[e[0],e[1],e[2],e[3],e[4],e[5]]}function YC(e,t,i,r,s,n,o=Hg()){return o[0]=e,o[1]=t,o[2]=i,o[3]=r,o[4]=s,o[5]=n,o}function SPe(e,t=Hg()){return aoe(e,0,e.length/3,t)}function aoe(e,t,i,r=Hg()){return H8(r,k$),loe(r,e,t,i),r}function xPe(e,t=ooe(24)){const[i,r,s,n,o,a]=e;return t[0]=i,t[1]=r,t[2]=s,t[3]=i,t[4]=r,t[5]=a,t[6]=i,t[7]=o,t[8]=s,t[9]=i,t[10]=o,t[11]=a,t[12]=n,t[13]=r,t[14]=s,t[15]=n,t[16]=r,t[17]=a,t[18]=n,t[19]=o,t[20]=s,t[21]=n,t[22]=o,t[23]=a,t}function $Pe(e,t){const i=isFinite(e[2])||isFinite(e[5]);return new ke(i?{xmin:e[0],xmax:e[3],ymin:e[1],ymax:e[4],zmin:e[2],zmax:e[5],spatialReference:t}:{xmin:e[0],xmax:e[3],ymin:e[1],ymax:e[4],spatialReference:t})}function MPe(e,t){e[0]=Math.min(e[0],t[0]),e[1]=Math.min(e[1],t[1]),e[2]=Math.min(e[2],t[2]),e[3]=Math.max(e[3],t[3]),e[4]=Math.max(e[4],t[4]),e[5]=Math.max(e[5],t[5])}function TPe(e,t){e[0]=Math.min(e[0],t[0]),e[1]=Math.min(e[1],t[1]),e[3]=Math.max(e[3],t[2]),e[4]=Math.max(e[4],t[3])}function EPe(e,t){e[0]=Math.min(e[0],t[0]),e[1]=Math.min(e[1],t[1]),e[2]=Math.min(e[2],t[2]),e[3]=Math.max(e[3],t[0]),e[4]=Math.max(e[4],t[1]),e[5]=Math.max(e[5],t[2])}function loe(e,t,i=0,r=t.length/3){let s=e[0],n=e[1],o=e[2],a=e[3],l=e[4],u=e[5];for(let c=0;c<r;c++)s=Math.min(s,t[i+3*c]),n=Math.min(n,t[i+3*c+1]),o=Math.min(o,t[i+3*c+2]),a=Math.max(a,t[i+3*c]),l=Math.max(l,t[i+3*c+1]),u=Math.max(u,t[i+3*c+2]);e[0]=s,e[1]=n,e[2]=o,e[3]=a,e[4]=l,e[5]=u}function CPe(e,t,i){const r=t.length;let s=e[0],n=e[1],o=e[2],a=e[3],l=e[4],u=e[5];if(i)for(let c=0;c<r;c++){const d=t[c];s=Math.min(s,d[0]),n=Math.min(n,d[1]),o=Math.min(o,d[2]),a=Math.max(a,d[0]),l=Math.max(l,d[1]),u=Math.max(u,d[2])}else for(let c=0;c<r;c++){const d=t[c];s=Math.min(s,d[0]),n=Math.min(n,d[1]),a=Math.max(a,d[0]),l=Math.max(l,d[1])}e[0]=s,e[1]=n,e[2]=o,e[3]=a,e[4]=l,e[5]=u}function PPe(e){for(let t=0;t<6;t++)if(!isFinite(e[t]))return!1;return!0}function Wg(e){return e[0]>=e[3]?0:e[3]-e[0]}function Zg(e){return e[1]>=e[4]?0:e[4]-e[1]}function Yg(e){return e[2]>=e[5]?0:e[5]-e[2]}function IPe(e){const t=Wg(e),i=Yg(e),r=Zg(e);return Math.sqrt(t*t+i*i+r*r)}function APe(e,t=[0,0,0]){return t[0]=e[0]+Wg(e)/2,t[1]=e[1]+Zg(e)/2,t[2]=e[2]+Yg(e)/2,t}function LPe(e,t=[0,0,0]){return t[0]=Wg(e),t[1]=Zg(e),t[2]=Yg(e),t}function kPe(e,t){return t[0]>=e[0]&&t[1]>=e[1]&&t[2]>=e[2]&&t[0]<=e[3]&&t[1]<=e[4]&&t[2]<=e[5]}function uoe(e,t){return Math.max(t[0],e[0])<=Math.min(t[3],e[3])&&Math.max(t[1],e[1])<=Math.min(t[4],e[4])&&Math.max(t[2],e[2])<=Math.min(t[5],e[5])}function RPe(e,t){return t==null||uoe(e,t)}function OPe(e,t,i,r,s=e){return s[0]=e[0]+t,s[1]=e[1]+i,s[2]=e[2]+r,s[3]=e[3]+t,s[4]=e[4]+i,s[5]=e[5]+r,s}function NPe(e,t,i=e){const r=e[0]+Wg(e)/2,s=e[1]+Zg(e)/2,n=e[2]+Yg(e)/2;return i[0]=r+(e[0]-r)*t,i[1]=s+(e[1]-s)*t,i[2]=n+(e[2]-n)*t,i[3]=r+(e[3]-r)*t,i[4]=s+(e[4]-s)*t,i[5]=n+(e[5]-n)*t,i}function DPe(e,t){return t[0]=e[0],t[1]=e[1],t[2]=e[2],t}function FPe(e,t,i=e){return i[0]=t[0],i[1]=t[1],i[2]=t[2],i!==e&&(i[3]=e[3],i[4]=e[4],i[5]=e[5]),i}function zPe(e,t,i=e){return i[3]=t[0],i[4]=t[1],i[5]=t[2],i!==e&&(i[0]=e[0],i[1]=e[1],i[2]=e[2]),e}function H8(e,t){return e[0]=t[0],e[1]=t[1],e[2]=t[2],e[3]=t[3],e[4]=t[4],e[5]=t[5],e}function VPe(e){return e?H8(e,k$):Hg(k$)}function UPe(e,t){return t||(t=Qt()),t[0]=e[0],t[1]=e[1],t[2]=e[3],t[3]=e[4],t}function jPe(e,t){return e[0]=t[0],e[1]=t[1],e[2]=Number.NEGATIVE_INFINITY,e[3]=t[2],e[4]=t[3],e[5]=Number.POSITIVE_INFINITY,e}function GPe(e,t,i,r,s){return e[0]=t,e[1]=i,e[2]=Number.NEGATIVE_INFINITY,e[3]=r,e[4]=s,e[5]=Number.POSITIVE_INFINITY,e}function vL(e){return e.length===6}function BPe(e){return Wg(e)===0&&Zg(e)===0&&Yg(e)===0}function qPe(e,t,i){if(e==null||t==null)return e===t;if(!vL(e)||!vL(t))return!1;for(let r=0;r<e.length;r++)if(e[r]!==t[r])return!1;return!0}const k$=[1/0,1/0,1/0,-1/0,-1/0,-1/0],coe=[0,0,0,0,0,0];Hg();function HPe(e,{isPrimitive:t,width:i,depth:r,height:s}){const n=t?10:1;if(i==null&&s==null&&r==null)return[n*e[0],n*e[1],n*e[2]];const o=yf(i,r,s);let a;for(let l=0;l<3;l++){const u=o[l];if(u!=null){a=u/e[l];break}}for(let l=0;l<3;l++)o[l]==null&&(o[l]=e[l]*a);return o}const hoe=YC(-.5,-.5,-.5,.5,.5,.5),doe=YC(-.5,-.5,0,.5,.5,1),poe=YC(-.5,-.5,0,.5,.5,.5);function WPe(e){switch(e){case"sphere":case"cube":case"diamond":return hoe;case"cylinder":case"cone":case"inverted-cone":return doe;case"tetrahedron":return poe;default:return}}const JC=["butt","square","round"],foe=[...JC,"none"],W8=["miter","bevel","round"];var R$;let Yu=R$=class extends ee{constructor(e){super(e),this.color=new X([0,0,0,1]),this.size=We(1),this.pattern=null,this.patternCap="butt"}clone(){const e={color:this.color!=null?this.color.clone():null,size:this.size,pattern:this.pattern!=null?this.pattern.clone():null,patternCap:this.patternCap};return new R$(e)}};h([f(Mu({colorRequiredOnWrite:!0}))],Yu.prototype,"color",void 0),h([f({...jo,json:{write:{isRequired:!0}}})],Yu.prototype,"size",void 0),h([f(q8)],Yu.prototype,"pattern",void 0),h([f({type:JC,json:{default:"butt",write:{overridePolicy(){return{enabled:this.pattern!=null}}}}})],Yu.prototype,"patternCap",void 0),Yu=R$=h([I("esri.symbols.support.Symbol3DOutline")],Yu);var i1,fp;let vr=(fp=class extends Mr{constructor(t){super(t),this.type="fill",this.material=null,this.pattern=null,this.castShadows=!0,this.outline=null,this.edges=null}clone(){const t={edges:this.edges!=null?this.edges.clone():null,enabled:this.enabled,material:this.material!=null?this.material.clone():null,pattern:this.pattern!=null?this.pattern.clone():null,castShadows:this.castShadows,outline:this.outline!=null?this.outline.clone():null};return new i1(t)}static fromSimpleFillSymbol(t){const i=t.outline&&t.outline.style&&t.outline.style!=="solid"?new Lc({style:t.outline.style}):null,r={size:t.outline?.width??0,color:(t.outline?.color??$y).clone(),pattern:i};return i&&t.outline?.cap&&(r.patternCap=t.outline.cap),new i1({material:new My({color:(t.color??soe).clone()}),pattern:t.style&&t.style!=="solid"?new Pd({style:t.style}):null,outline:r})}},i1=fp,fp);h([me({Fill:"fill"},{readOnly:!0})],vr.prototype,"type",void 0),h([f({type:My,json:{write:!0}})],vr.prototype,"material",void 0),h([f(roe)],vr.prototype,"pattern",void 0),h([f({type:Boolean,nonNullable:!0,json:{write:!0,default:!0}})],vr.prototype,"castShadows",void 0),h([f({type:Yu,json:{write:!0}})],vr.prototype,"outline",void 0),h([f(B8)],vr.prototype,"edges",void 0),vr=i1=h([I("esri.symbols.FillSymbol3DLayer")],vr);var O$;const moe=cr()({circle:"circle",square:"square",cross:"cross",x:"x",kite:"kite",triangle:"triangle"});let Ju=O$=class extends ee{constructor(e){super(e)}readHref(e,t,i){return e?Ga(e,i):t.dataURI}writeHref(e,t,i,r){e&&(yh(e)?t.dataURI=e:(t.href=rh(e,r),qr(t.href)&&(t.href=No(t.href))))}clone(){return new O$({href:this.href,primitive:this.primitive})}};h([f({type:String,json:{write:!0,read:{source:["href","dataURI"]}}})],Ju.prototype,"href",void 0),h([Ae("href")],Ju.prototype,"readHref",null),h([$e("href",{href:{type:String},dataURI:{type:String}})],Ju.prototype,"writeHref",null),h([me(moe)],Ju.prototype,"primitive",void 0),Ju=O$=h([I("esri.symbols.support.IconSymbol3DLayerResource")],Ju);const yoe="circle";var N$;let Id=N$=class extends le{constructor(){super(...arguments),this.x=0,this.y=0}clone(){return new N$({x:this.x,y:this.y})}};h([f({type:Number})],Id.prototype,"x",void 0),h([f({type:Number})],Id.prototype,"y",void 0),Id=N$=h([I("esri.symbols.support.Symbol3DAnchorPosition2D")],Id);var D$;let Rm=D$=class extends ee{constructor(e){super(e),this.color=new X([0,0,0,1]),this.size=We(1)}clone(){const e={color:this.color!=null?this.color.clone():null,size:this.size};return new D$(e)}};h([f(Mu({colorRequiredOnWrite:!0}))],Rm.prototype,"color",void 0),h([f({...jo,json:{write:{isRequired:!0}}})],Rm.prototype,"size",void 0),Rm=D$=h([I("esri.symbols.support.Symbol3DIconOutline")],Rm);var od,mp;let Fi=(mp=class extends Mr{constructor(t){super(t),this.material=null,this.resource=null,this.type="icon",this.size=12,this.anchor="center",this.anchorPosition=null,this.outline=null,this.angle=0}clone(){return new od({anchor:this.anchor,anchorPosition:V(this.anchorPosition),enabled:this.enabled,material:V(this.material),outline:V(this.outline),resource:V(this.resource),angle:this.angle,size:this.size})}static fromSimpleMarkerSymbol(t){const i=t.color||$y,r=bL(t),s=t.outline&&t.outline.width>0?{size:t.outline.width,color:(t.outline.color||$y).clone()}:null;return new od({size:t.size,angle:t.angle,resource:{primitive:_oe((()=>H.getLogger(this.prototype)),t.style)},material:{color:i},outline:s,anchor:r?"relative":void 0,anchorPosition:r})}static fromPictureMarkerSymbol(t){const i=!t.color||noe(t.color)?$y:t.color,r=bL(t);return new od({size:t.width<=t.height?t.height:t.width,angle:t.angle,resource:{href:t.url},material:{color:i.clone()},anchor:r?"relative":void 0,anchorPosition:r})}static fromCIMSymbol(t){return new od({resource:{href:sD({mediaType:"application/json",data:JSON.stringify(t.data)})}})}},od=mp,mp);function bL(e){const t="width"in e?e.width:e.size,i="height"in e?e.height:e.size,r=wL(e.xoffset),s=wL(e.yoffset);return(r||s)&&t&&i?{x:-r/t,y:s/i}:null}function wL(e){return isFinite(e)?e:0}h([f({type:Gr,json:{write:!0}})],Fi.prototype,"material",void 0),h([f({type:Ju,json:{write:!0}})],Fi.prototype,"resource",void 0),h([me({Icon:"icon"},{readOnly:!0})],Fi.prototype,"type",void 0),h([f({...jo,json:{write:{isRequired:!0}}})],Fi.prototype,"size",void 0),h([me({center:"center",left:"left",right:"right",top:"top",bottom:"bottom",topLeft:"top-left",topRight:"top-right",bottomLeft:"bottom-left",bottomRight:"bottom-right",relative:"relative"},{default:"center"})],Fi.prototype,"anchor",void 0),h([f({type:Id,json:{type:[Number],read:{reader:e=>new Id({x:e[0],y:e[1]})},write:{writer:(e,t)=>{t.anchorPosition=[e.x,e.y]},overridePolicy(){return{enabled:this.anchor==="relative"}}}}})],Fi.prototype,"anchorPosition",void 0),h([f({type:Rm,json:{write:!0}})],Fi.prototype,"outline",void 0),h([f({type:Number,json:{write:!0,default:0}})],Fi.prototype,"angle",void 0),Fi=od=h([I("esri.symbols.IconSymbol3DLayer")],Fi);const goe={circle:"circle",cross:"cross",diamond:"kite",square:"square",x:"x",triangle:"triangle",path:null};function _oe(e,t){return goe[t]||(e().warn(`${t} cannot be mapped to Icon symbol. Fallback to "circle"`),"circle")}const voe=["begin","end","begin-end"],Z8=["arrow","circle","square","diamond","cross","x"];let Ca=class extends xt.ClonableMixin(ee){constructor(t){super(t),this.type="style",this.placement="begin-end",this.style="arrow",this.color=null}equals(t){return t!=null&&t.placement===this.placement&&t.style===this.style&&(this.color==null&&t.color==null||this.color!=null&&t.color!=null&&this.color.toJSON()===t.color.toJSON())}};h([f({type:["style"],readOnly:!0,json:{read:!0,write:{ignoreOrigin:!0,isRequired:!0}}})],Ca.prototype,"type",void 0),h([f({type:voe,json:{default:"begin-end",write:!0}})],Ca.prototype,"placement",void 0),h([f({type:Z8,json:{default:"arrow",write:!0}})],Ca.prototype,"style",void 0),h([f({type:X,json:{type:[Ue],default:null,write:!0}})],Ca.prototype,"color",void 0),Ca=h([I("esri.symbols.LineStyleMarker3D")],Ca);var r1,yp;let _r=(yp=class extends Mr{constructor(t){super(t),this.material=null,this.type="line",this.join="miter",this.cap="butt",this.size=We(1),this.pattern=null,this.marker=null}clone(){const t={enabled:this.enabled,material:this.material!=null?this.material.clone():null,size:this.size,join:this.join,cap:this.cap,pattern:this.pattern!=null?this.pattern.clone():null,marker:this.marker!=null?this.marker.clone():null};return new r1(t)}static fromSimpleLineSymbol(t){const i={enabled:!0,size:t.width??We(1),cap:t.cap||"butt",join:t.join||"miter",pattern:t.style?new Lc({style:t.style}):null,material:new Gr({color:(t.color||$y).clone()}),marker:t.marker?new Ca({placement:t.marker.placement,style:t.marker.style,color:t.marker.color?.clone()??null}):null};return new r1(i)}},r1=yp,yp);h([f({type:Gr,json:{write:!0}})],_r.prototype,"material",void 0),h([me({Line:"line"},{readOnly:!0})],_r.prototype,"type",void 0),h([f({type:W8,json:{write:!0,default:"miter"}})],_r.prototype,"join",void 0),h([f({type:JC,json:{write:!0,default:"butt"}})],_r.prototype,"cap",void 0),h([f({...jo,json:{write:{isRequired:!0}}})],_r.prototype,"size",void 0),h([f(q8)],_r.prototype,"pattern",void 0),h([f({types:{key:"type",base:Ca,typeMap:{style:Ca}},json:{write:!0}})],_r.prototype,"marker",void 0),_r=r1=h([I("esri.symbols.LineSymbol3DLayer")],_r);var F$;const boe=cr()({sphere:"sphere",cylinder:"cylinder",cube:"cube",cone:"cone",diamond:"diamond",tetrahedron:"tetrahedron",invertedCone:"inverted-cone"});let Om=F$=class extends ee{clone(){return new F$({href:this.href,primitive:this.primitive})}};h([f({type:String,json:{read:kb,write:kp}})],Om.prototype,"href",void 0),h([me(boe)],Om.prototype,"primitive",void 0),Om=F$=h([I("esri.symbols.support.ObjectSymbol3DLayerResource")],Om);const woe="sphere";var z$;let bc=z$=class extends le{constructor(){super(...arguments),this.x=0,this.y=0,this.z=0}clone(){return new z$({x:this.x,y:this.y,z:this.z})}};h([f({type:Number})],bc.prototype,"x",void 0),h([f({type:Number})],bc.prototype,"y",void 0),h([f({type:Number})],bc.prototype,"z",void 0),bc=z$=h([I("esri.symbols.support.Symbol3DAnchorPosition3D")],bc);var V$,gp;let Mi=(gp=class extends Mr{constructor(t){super(t),this.material=null,this.castShadows=!0,this.resource=null,this.type="object",this.width=void 0,this.height=void 0,this.depth=void 0,this.anchor=void 0,this.anchorPosition=void 0,this.heading=void 0,this.tilt=void 0,this.roll=void 0}clone(){return new V$({heading:this.heading,tilt:this.tilt,roll:this.roll,anchor:this.anchor,anchorPosition:this.anchorPosition?.clone(),depth:this.depth,enabled:this.enabled,height:this.height,material:this.material?.clone()??null,castShadows:this.castShadows,resource:this.resource?.clone(),width:this.width})}get isPrimitive(){return!this.resource||typeof this.resource.href!="string"}},V$=gp,gp);h([f({type:Gr,json:{write:!0}})],Mi.prototype,"material",void 0),h([f({type:Boolean,nonNullable:!0,json:{write:!0,default:!0}})],Mi.prototype,"castShadows",void 0),h([f({type:Om,json:{write:!0}})],Mi.prototype,"resource",void 0),h([me({Object:"object"},{readOnly:!0})],Mi.prototype,"type",void 0),h([f({type:Number,json:{write:!0}})],Mi.prototype,"width",void 0),h([f({type:Number,json:{write:!0}})],Mi.prototype,"height",void 0),h([f({type:Number,json:{write:!0}})],Mi.prototype,"depth",void 0),h([me({center:"center",top:"top",bottom:"bottom",origin:"origin",relative:"relative"},{default:"origin"})],Mi.prototype,"anchor",void 0),h([f({type:bc,json:{type:[Number],read:{reader:e=>new bc({x:e[0],y:e[1],z:e[2]})},write:{writer:(e,t)=>{t.anchorPosition=[e.x,e.y,e.z]},overridePolicy(){return{enabled:this.anchor==="relative"}}}}})],Mi.prototype,"anchorPosition",void 0),h([f({type:Number,json:{write:!0}})],Mi.prototype,"heading",void 0),h([f({type:Number,json:{write:!0}})],Mi.prototype,"tilt",void 0),h([f({type:Number,json:{write:!0}})],Mi.prototype,"roll",void 0),h([f({readOnly:!0})],Mi.prototype,"isPrimitive",null),Mi=V$=h([I("esri.symbols.ObjectSymbol3DLayer")],Mi);var U$,_p;let Oi=(_p=class extends Mr{constructor(t){super(t),this.material=null,this.castShadows=!0,this.type="path",this.profile="circle",this.join="miter",this.cap="butt",this.width=void 0,this.height=void 0,this.anchor="center",this.profileRotation="all"}readWidth(t,i){return t??(i.height==null&&i.size!=null?i.size:void 0)}readHeight(t,i){return t??(i.width==null&&i.size!=null?i.size:void 0)}clone(){return new U$({enabled:this.enabled,material:this.material!=null?this.material.clone():null,castShadows:this.castShadows,profile:this.profile,join:this.join,cap:this.cap,width:this.width,height:this.height,profileRotation:this.profileRotation,anchor:this.anchor})}},U$=_p,_p);h([f({type:Gr,json:{write:!0}})],Oi.prototype,"material",void 0),h([f({type:Boolean,nonNullable:!0,json:{write:!0,default:!0}})],Oi.prototype,"castShadows",void 0),h([me({Path:"path"},{readOnly:!0})],Oi.prototype,"type",void 0),h([f({type:["circle","quad"],json:{write:!0,default:"circle"}})],Oi.prototype,"profile",void 0),h([f({type:W8,json:{write:!0,default:"miter"}})],Oi.prototype,"join",void 0),h([f({type:foe,json:{write:!0,default:"butt"}})],Oi.prototype,"cap",void 0),h([f({type:Number,json:{write:{enabled:!0,target:{width:{type:Number},size:{type:Number}}}}})],Oi.prototype,"width",void 0),h([Ae("width",["width","size","height"])],Oi.prototype,"readWidth",null),h([f({type:Number,json:{write:!0}})],Oi.prototype,"height",void 0),h([Ae("height",["height","size","width"])],Oi.prototype,"readHeight",null),h([f({type:["center","bottom","top"],json:{write:!0,default:"center"}})],Oi.prototype,"anchor",void 0),h([f({type:["heading","all"],json:{write:!0,default:"all"}})],Oi.prototype,"profileRotation",void 0),Oi=U$=h([I("esri.symbols.PathSymbol3DLayer")],Oi);const Soe=["none","underline","line-through"],xoe=["normal","italic","oblique"],$oe=["normal","lighter","bold","bolder"],Y8={type:Number,cast:e=>{const t=us(e);return t===0?1:lr(t,.1,4)},nonNullable:!0},Moe=["left","right","center"],Toe=["baseline","top","middle","bottom"],J8={type:Moe,nonNullable:!0},X8={type:Toe,nonNullable:!0},Eoe=8;var j$;let os=j$=class extends ee{constructor(e){super(e),this.decoration="none",this.family="sans-serif",this.size=9,this.style="normal",this.weight="normal"}castSize(e){return ct(e)}clone(){return new j$({decoration:this.decoration,family:this.family,size:this.size,style:this.style,weight:this.weight})}hash(){return`${this.decoration}.${this.family}.${this.size}.${this.style}.${this.weight}`}};h([f({type:Soe,json:{default:"none",write:!0}})],os.prototype,"decoration",void 0),h([f({type:String,json:{write:!0}})],os.prototype,"family",void 0),h([f({type:Number,json:{write:{overridePolicy:(e,t,i)=>({enabled:!i||!i.textSymbol3D})}}})],os.prototype,"size",void 0),h([Ke("size")],os.prototype,"castSize",null),h([f({type:xoe,json:{default:"normal",write:!0}})],os.prototype,"style",void 0),h([f({type:$oe,json:{default:"normal",write:!0}})],os.prototype,"weight",void 0),os=j$=h([I("esri.symbols.Font")],os);var G$;let Ad=G$=class extends ee{constructor(){super(...arguments),this.color=new X([0,0,0,1]),this.size=0}clone(){const e={color:V(this.color),size:this.size};return new G$(e)}};h([f(Mu())],Ad.prototype,"color",void 0),h([f(jo)],Ad.prototype,"size",void 0),Ad=G$=h([I("esri.symbols.support.Symbol3DHalo")],Ad);let Ty=class extends xt.ClonableMixin(ee){constructor(t){super(t),this.color=null}};h([f(Mu())],Ty.prototype,"color",void 0),Ty=h([I("esri.symbols.support.Symbol3DTextBackground")],Ty);var s1,vp;let mi=(vp=class extends Mr{constructor(t){super(t),this._userSize=void 0,this.halo=null,this.horizontalAlignment="center",this.lineHeight=1,this.material=null,this.background=null,this.text=null,this.type="text",this.verticalAlignment="baseline"}get font(){return this._get("font")||null}set font(t){t!=null&&this._userSize!=null&&(t.size=this._userSize),this._set("font",t)}writeFont(t,i,r,s){const n={...s,textSymbol3D:!0};i.font=t.write({},n),delete i.font.size}get size(){return this._userSize!=null?this._userSize:this.font?.size!=null?this.font.size:9}set size(t){this._userSize=t,this.font!=null&&(this.font.size=this._userSize),this.notifyChange("size")}clone(){const t=new s1({enabled:this.enabled,font:this.font&&V(this.font),halo:this.halo&&V(this.halo),horizontalAlignment:this.horizontalAlignment,lineHeight:this.lineHeight,material:this.material!=null?this.material.clone():null,text:this.text,verticalAlignment:this.verticalAlignment,background:V(this.background)});return t._userSize=this._userSize,t}static fromTextSymbol(t){return new s1({font:t.font!=null?t.font.clone():new os,halo:Coe(t.haloColor,t.haloSize),horizontalAlignment:t.horizontalAlignment,lineHeight:t.lineHeight,material:t.color?new Gr({color:t.color.clone()}):null,text:t.text,verticalAlignment:t.verticalAlignment,background:t.backgroundColor?new Ty({color:t.backgroundColor.clone()}):null})}},s1=vp,vp);function Coe(e,t){return e&&t!=null&&t>0?new Ad({color:V(e),size:t}):null}h([f({type:os,json:{write:!0}})],mi.prototype,"font",null),h([$e("font")],mi.prototype,"writeFont",null),h([f({type:Ad,json:{write:!0}})],mi.prototype,"halo",void 0),h([f({...J8,json:{default:"center",write:!0}})],mi.prototype,"horizontalAlignment",void 0),h([f({...Y8,json:{default:1,write:!0}})],mi.prototype,"lineHeight",void 0),h([f({type:Gr,json:{write:!0}})],mi.prototype,"material",void 0),h([f({type:Ty,json:{write:!0}})],mi.prototype,"background",void 0),h([f(jo)],mi.prototype,"size",null),h([f({type:String,json:{write:!0}})],mi.prototype,"text",void 0),h([me({Text:"text"},{readOnly:!0})],mi.prototype,"type",void 0),h([f({...X8,json:{default:"baseline",write:!0}})],mi.prototype,"verticalAlignment",void 0),mi=s1=h([I("esri.symbols.TextSymbol3DLayer")],mi);var B$,bp;let ba=(bp=class extends Mr{constructor(t){super(t),this.color=q$.clone(),this.type="water",this.waterbodySize="medium",this.waveDirection=null,this.waveStrength="moderate"}clone(){return new B$({color:V(this.color),waterbodySize:this.waterbodySize,waveDirection:this.waveDirection,waveStrength:this.waveStrength})}},B$=bp,bp);h([f({type:X,nonNullable:!0,json:{type:[Ue],write:(e,t,i)=>t[i]=e.toArray(X.AlphaMode.UNLESS_OPAQUE),default:()=>q$.clone(),defaultEquals:e=>e.toCss(!0)===q$.toCss(!0)}})],ba.prototype,"color",void 0),h([me({Water:"water"},{readOnly:!0})],ba.prototype,"type",void 0),h([f({type:["small","medium","large"],json:{write:!0,default:"medium"}})],ba.prototype,"waterbodySize",void 0),h([f({type:Number,json:{write:!0,default:null}})],ba.prototype,"waveDirection",void 0),h([f({type:["calm","rippled","slight","moderate"],json:{write:!0,default:"moderate"}})],ba.prototype,"waveStrength",void 0),ba=B$=h([I("esri.symbols.WaterSymbol3DLayer")],ba);const q$=new X([0,119,190]);var H$;let Sn=H$=class extends le{constructor(e){super(e),this.name=null,this.styleUrl=null,this.styleName=null,this.portal=null}clone(){return new H$({name:this.name,styleUrl:this.styleUrl,styleName:this.styleName,portal:this.portal})}};h([f({type:String})],Sn.prototype,"name",void 0),h([f({type:String})],Sn.prototype,"styleUrl",void 0),h([f({type:String})],Sn.prototype,"styleName",void 0),h([f({type:Z})],Sn.prototype,"portal",void 0),Sn=H$=h([I("esri.symbols.support.StyleOrigin")],Sn);var W$;let qc=W$=class extends le{constructor(){super(...arguments),this.url=""}clone(){return new W$({url:this.url})}};h([f({type:String})],qc.prototype,"url",void 0),qc=W$=h([I("esri.symbols.support.Thumbnail")],qc);const K8={icon:Fi,object:Mi,line:_r,path:Oi,fill:vr,extrude:va,text:mi,water:ba},Poe=ne.ofType({base:Mr,key:"type",typeMap:K8,errorContext:"symbol-layer"});let Dr=class extends Kt{constructor(t){super(t),this.styleOrigin=null,this.thumbnail=null,this.type=null;const i=this.__accessor__&&this.__accessor__.metadata&&this.__accessor__.metadata.symbolLayers,r=i?.type,s=r||ne;this._set("symbolLayers",new s)}get color(){return null}set color(t){this.constructed&&H.getLogger(this).error("Symbol3D does not support colors on the symbol level. Colors may be set on individual symbol layer materials instead.")}set symbolLayers(t){Ha(t,this._get("symbolLayers"))}readStyleOrigin(t,i,r){if(t.styleUrl&&t.name){const s=Ga(t.styleUrl,r);return new Sn({styleUrl:s,name:t.name})}if(t.styleName&&t.name)return new Sn({portal:r?.portal||Z.getDefault(),styleName:t.styleName,name:t.name});r?.messages&&r.messages.push(new Bs("symbol3d:incomplete-style-origin","Style origin requires either a 'styleUrl' or 'styleName' and a 'name' property",{context:r,definition:t}))}writeStyleOrigin(t,i,r,s){if(t.styleUrl&&t.name){let n=rh(t.styleUrl,s);qr(n)&&(n=No(n)),i.styleOrigin={styleUrl:n,name:t.name}}else t.styleName&&t.name&&(t.portal&&s?.portal&&!jq(t.portal.restUrl,s.portal.restUrl)?s?.messages&&s.messages.push(new Bs("symbol:cross-portal","The symbol style origin cannot be persisted because it refers to an item on a different portal than the one being saved to.",{symbol:this})):i.styleOrigin={styleName:t.styleName,name:t.name})}normalizeCtorArgs(t){return t instanceof Mr||t&&K8[t.type]?{symbolLayers:[t]}:Array.isArray(t)?{symbolLayers:t}:t}};h([f({json:{read:!1,write:!1}})],Dr.prototype,"color",null),h([f({type:Poe,nonNullable:!0,json:{write:!0}}),Ke(p4)],Dr.prototype,"symbolLayers",null),h([f({type:Sn})],Dr.prototype,"styleOrigin",void 0),h([Ae("styleOrigin")],Dr.prototype,"readStyleOrigin",null),h([$e("styleOrigin",{"styleOrigin.styleUrl":{type:String},"styleOrigin.styleName":{type:String},"styleOrigin.name":{type:String}})],Dr.prototype,"writeStyleOrigin",null),h([f({type:qc,json:{read:!1}})],Dr.prototype,"thumbnail",void 0),h([f({type:["point-3d","line-3d","polygon-3d","mesh-3d","label-3d"],readOnly:!0})],Dr.prototype,"type",void 0),Dr=h([I("esri.symbols.Symbol3D")],Dr);let Ld=class extends ee{constructor(t){super(t),this.visible=!0}clone(){throw new Error("Subclasses of Callout3D should implement their own clone method.")}};h([f({type:["line"],constructOnly:!0,json:{read:!1,write:{ignoreOrigin:!0,isRequired:!0}}})],Ld.prototype,"type",void 0),h([f({readOnly:!0})],Ld.prototype,"visible",void 0),Ld=h([I("esri.symbols.callouts.Callout3D")],Ld);var Z$;let n1=Z$=class extends ee{constructor(e){super(e),this.color=new X("white")}clone(){return new Z$({color:V(this.color)})}};h([f(Mu({colorRequiredOnWrite:!0}))],n1.prototype,"color",void 0),n1=Z$=h([I("esri.symbols.callouts.LineCallout3DBorder")],n1);const Ioe=n1;var Y$;let wa=Y$=class extends Ld{constructor(e){super(e),this.type="line",this.color=new X([0,0,0,1]),this.size=We(1),this.border=null}get visible(){return this.size>0&&this.color!=null&&this.color.a>0}clone(){return new Y$({color:V(this.color),size:this.size,border:V(this.border)})}};h([me({line:"line"})],wa.prototype,"type",void 0),h([f(Mu({colorRequiredOnWrite:!0}))],wa.prototype,"color",void 0),h([f({...jo,json:{write:{isRequired:!0}}})],wa.prototype,"size",void 0),h([f({type:Ioe,json:{write:!0}})],wa.prototype,"border",void 0),h([f({readOnly:!0})],wa.prototype,"visible",null),wa=Y$=h([I("esri.symbols.callouts.LineCallout3D")],wa);function XC(e){if(!e)return!1;const t=e.verticalOffset;return!(!t||t.screenLength<=0||t.maxWorldLength!=null&&t.maxWorldLength<=0)}function Q8(e){return!e||!e.supportsCallout||!e.supportsCallout()?!1:!!e.callout?.visible&&!!XC(e)}function KPe(e){return e.type==="point-3d"||e.type==="label-3d"}function QPe(e){return e.horizontalAlignment==="center"}const eV={types:{key:"type",base:Ld,typeMap:{line:wa}},json:{write:!0}};var J$;let Wl=J$=class extends ee{constructor(e){super(e),this.screenLength=0,this.minWorldLength=0,this.maxWorldLength=null}clone(){return new J$({screenLength:this.screenLength,minWorldLength:this.minWorldLength,maxWorldLength:this.maxWorldLength})}};h([f({...jo,json:{write:{isRequired:!0}}})],Wl.prototype,"screenLength",void 0),h([f({type:Number,nonNullable:!0,json:{write:!0,default:0}})],Wl.prototype,"minWorldLength",void 0),h([f({type:Number,json:{write:!0}})],Wl.prototype,"maxWorldLength",void 0),Wl=J$=h([I("esri.symbols.support.Symbol3DVerticalOffset")],Wl);var o1;const tV=ne.ofType({base:null,key:"type",typeMap:{text:mi}});let _n=o1=class extends Dr{constructor(e){super(e),this.verticalOffset=null,this.callout=null,this.styleOrigin=null,this.symbolLayers=new tV,this.type="label-3d"}supportsCallout(){return!0}hasVisibleCallout(){return Q8(this)}hasVisibleVerticalOffset(){return XC(this)}clone(){return new o1({styleOrigin:V(this.styleOrigin),symbolLayers:V(this.symbolLayers),thumbnail:V(this.thumbnail),callout:V(this.callout),verticalOffset:V(this.verticalOffset)})}static fromTextSymbol(e){return new o1({symbolLayers:new ne([mi.fromTextSymbol(e)])})}};h([f({type:Wl,json:{write:!0}})],_n.prototype,"verticalOffset",void 0),h([f(eV)],_n.prototype,"callout",void 0),h([f({json:{read:!1,write:!1}})],_n.prototype,"styleOrigin",void 0),h([f({type:tV})],_n.prototype,"symbolLayers",void 0),h([me({LabelSymbol3D:"label-3d"},{readOnly:!0})],_n.prototype,"type",void 0),_n=o1=h([I("esri.symbols.LabelSymbol3D")],_n);var a1;const iV=ne.ofType({base:null,key:"type",typeMap:{line:_r,path:Oi}}),Aoe=ne.ofType({base:null,key:"type",typeMap:{line:_r,path:Oi}});let Cn=a1=class extends Dr{constructor(e){super(e),this.symbolLayers=new iV,this.type="line-3d"}clone(){return new a1({styleOrigin:V(this.styleOrigin),symbolLayers:V(this.symbolLayers),thumbnail:V(this.thumbnail)})}static fromSimpleLineSymbol(e){return new a1({symbolLayers:new ne([_r.fromSimpleLineSymbol(e)])})}};h([f({type:iV,json:{type:Aoe}})],Cn.prototype,"symbolLayers",void 0),h([me({LineSymbol3D:"line-3d"},{readOnly:!0})],Cn.prototype,"type",void 0),Cn=a1=h([I("esri.symbols.LineSymbol3D")],Cn);var l1;const rV=ne.ofType({base:null,key:"type",typeMap:{fill:vr}});let Ra=l1=class extends Dr{constructor(e){super(e),this.symbolLayers=new rV,this.type="mesh-3d"}clone(){return new l1({styleOrigin:V(this.styleOrigin),symbolLayers:V(this.symbolLayers),thumbnail:V(this.thumbnail)})}static fromSimpleFillSymbol(e){return new l1({symbolLayers:new ne([vr.fromSimpleFillSymbol(e)])})}};h([f({type:rV})],Ra.prototype,"symbolLayers",void 0),h([me({MeshSymbol3D:"mesh-3d"},{readOnly:!0})],Ra.prototype,"type",void 0),Ra=l1=h([I("esri.symbols.MeshSymbol3D")],Ra);let Nm=class extends Kt{constructor(t){super(t),this.type="simple-line",this.width=.75}hash(){return`${this.type}.${this.width}`}};h([me({esriSLS:"simple-line"},{readOnly:!0})],Nm.prototype,"type",void 0),h([f({type:Number,cast:ct,json:{write:!0}})],Nm.prototype,"width",void 0),Nm=h([I("esri.symbols.LineSymbol")],Nm);var X$;let Hn=X$=class extends ee{constructor(e){super(e),this.placement="begin-end",this.type="line-marker",this.style="arrow"}writeStyle(e,t,i,r){t[i]=r?.origin==="web-map"?"arrow":e}set color(e){this._set("color",e)}readColor(e){return e?.[0]!=null?[e[0],e[1],e[2],e[3]/255]:e}writeColor(e,t,i,r){r?.origin==="web-map"||(t[i]=e)}clone(){return new X$({color:V(this.color),placement:this.placement,style:this.style})}hash(){return`${this.placement}.${this.color?.hash()}.${this.style}`}};h([f({type:["begin","end","begin-end"],json:{write:!0}})],Hn.prototype,"placement",void 0),h([me({"line-marker":"line-marker"},{readOnly:!0}),f({json:{origins:{"web-map":{write:!1}}}})],Hn.prototype,"type",void 0),h([f({type:Z8})],Hn.prototype,"style",void 0),h([$e("style")],Hn.prototype,"writeStyle",null),h([f({type:X,value:null,json:{write:{allowNull:!0}}})],Hn.prototype,"color",null),h([Ae("color")],Hn.prototype,"readColor",null),h([$e("color")],Hn.prototype,"writeColor",null),Hn=X$=h([I("esri.symbols.LineSymbolMarker")],Hn);const Loe=Hn;var K$;const E2=new Ye({esriSLSSolid:"solid",esriSLSDash:"dash",esriSLSDot:"dot",esriSLSDashDot:"dash-dot",esriSLSDashDotDot:"long-dash-dot-dot",esriSLSNull:"none",esriSLSShortDash:"short-dash",esriSLSShortDot:"short-dot",esriSLSShortDashDot:"short-dash-dot",esriSLSShortDashDotDot:"short-dash-dot-dot",esriSLSLongDash:"long-dash",esriSLSLongDashDot:"long-dash-dot"});let Nt=K$=class extends Nm{constructor(...e){super(...e),this.type="simple-line",this.style="solid",this.cap="round",this.join="round",this.marker=null,this.miterLimit=2}normalizeCtorArgs(e,t,i,r,s,n){if(e&&typeof e!="string")return e;const o={};return e!=null&&(o.style=e),t!=null&&(o.color=t),i!=null&&(o.width=ct(i)),r!=null&&(o.cap=r),s!=null&&(o.join=s),n!=null&&(o.miterLimit=ct(n)),o}clone(){return new K$({color:V(this.color),style:this.style,width:this.width,cap:this.cap,join:this.join,miterLimit:this.miterLimit,marker:this.marker?.clone()})}hash(){return`${super.hash()}.${this.color?.hash()}.${this.style}.${this.cap}.${this.join}.${this.miterLimit}.${this.marker?.hash()}`}};h([me({esriSLS:"simple-line"},{readOnly:!0})],Nt.prototype,"type",void 0),h([f({type:E2.apiValues,json:{read:E2.read,write:E2.write}})],Nt.prototype,"style",void 0),h([f({type:["butt","round","square"],json:{write:{overridePolicy:(e,t,i)=>({enabled:e!=="round"&&i?.origin==null})}}})],Nt.prototype,"cap",void 0),h([f({type:["miter","round","bevel"],json:{write:{overridePolicy:(e,t,i)=>({enabled:e!=="round"&&i?.origin==null})}}})],Nt.prototype,"join",void 0),h([f({types:{key:"type",base:null,defaultKeyValue:"line-marker",typeMap:{"line-marker":Loe}},json:{write:!0,origins:{"web-scene":{write:!1}}}})],Nt.prototype,"marker",void 0),h([f({type:Number,json:{read:!1,write:!1}})],Nt.prototype,"miterLimit",void 0),Nt=K$=h([I("esri.symbols.SimpleLineSymbol")],Nt);let kd=class extends Kt{constructor(t){super(t),this.outline=null,this.type=null}hash(){return`${this.type}.${this.outline?.hash()}`}};h([f({types:{key:"type",base:null,defaultKeyValue:"simple-line",typeMap:{"simple-line":Nt}},json:{default:null,write:!0}})],kd.prototype,"outline",void 0),h([f({type:["simple-fill","picture-fill"],readOnly:!0})],kd.prototype,"type",void 0),kd=h([I("esri.symbols.FillSymbol")],kd);function koe(e,t,i){return t.imageData?sD({mediaType:t.contentType||"image/png",isBase64:!0,data:t.imageData}):sV(t.url,i)}function sV(e,t){if(!qr(e)){const i=Ooe(t);if(i)return $g(i,"images",e)}return Ga(e,t)}function Roe(e,t,i,r){if(yh(e)){const s=Ap(e);if(!s)return;t.contentType=s.mediaType,t.imageData=s.data,i&&i.imageData===t.imageData&&i.url&&kp(i.url,t,"url",r)}else kp(e,t,"url",r)}const nV={json:{read:{source:["imageData","url"],reader:koe},write:{writer(e,t,i,r){Roe(e,t,this.source,r)}}}},oV={readOnly:!0,json:{read:{source:["imageData","url"],reader(e,t,i){const r={};return t.imageData&&(r.imageData=t.imageData),t.contentType&&(r.contentType=t.contentType),t.url&&(r.url=sV(t.url,i)),r}}}};function Ooe(e){if(!e)return null;const{origin:t,layer:i}=e;if(t!=="service"&&t!=="portal-item")return null;const r=i?.type;return r==="feature"||r==="stream"?i.parsedUrl?.path:r==="map-image"||r==="tile"?e.url?.path:null}var Q$;let Rr=Q$=class extends kd{constructor(...e){super(...e),this.type="picture-fill",this.url=null,this.xscale=1,this.yscale=1,this.width=12,this.height=12,this.xoffset=0,this.yoffset=0,this.source=null}normalizeCtorArgs(e,t,i,r){if(e&&typeof e!="string"&&e.imageData==null)return e;const s={};return e&&(s.url=e),t&&(s.outline=t),i!=null&&(s.width=ct(i)),r!=null&&(s.height=ct(r)),s}clone(){const e=new Q$({color:V(this.color),height:this.height,outline:V(this.outline),url:this.url,width:this.width,xoffset:this.xoffset,xscale:this.xscale,yoffset:this.yoffset,yscale:this.yscale});return e._set("source",V(this.source)),e}hash(){return`${super.hash()}.${this.color?.hash()}.${this.height}.${this.url}.${this.width}.${this.xoffset}.${this.xscale}.${this.yoffset}.${this.yscale}`}};h([me({esriPFS:"picture-fill"},{readOnly:!0})],Rr.prototype,"type",void 0),h([f(nV)],Rr.prototype,"url",void 0),h([f({type:Number,json:{write:!0}})],Rr.prototype,"xscale",void 0),h([f({type:Number,json:{write:!0}})],Rr.prototype,"yscale",void 0),h([f({type:Number,cast:ct,json:{write:!0}})],Rr.prototype,"width",void 0),h([f({type:Number,cast:ct,json:{write:!0}})],Rr.prototype,"height",void 0),h([f({type:Number,cast:ct,json:{write:!0}})],Rr.prototype,"xoffset",void 0),h([f({type:Number,cast:ct,json:{write:!0}})],Rr.prototype,"yoffset",void 0),h([f(oV)],Rr.prototype,"source",void 0),Rr=Q$=h([I("esri.symbols.PictureFillSymbol")],Rr);let Sa=class extends Kt{constructor(t){super(t),this.angle=0,this.type=null,this.xoffset=0,this.yoffset=0,this.size=9}hash(){return`${this.type}.${this.angle}.${this.size}.${this.xoffset}.${this.yoffset}`}};h([f({type:Number,json:{read:e=>e&&-1*e,write:(e,t)=>t.angle=e&&-1*e}})],Sa.prototype,"angle",void 0),h([f({type:["simple-marker","picture-marker"],readOnly:!0})],Sa.prototype,"type",void 0),h([f({type:Number,cast:ct,json:{write:!0}})],Sa.prototype,"xoffset",void 0),h([f({type:Number,cast:ct,json:{write:!0}})],Sa.prototype,"yoffset",void 0),h([f({cast:e=>e==="auto"?e:us(ct(e)),json:{write:!0}})],Sa.prototype,"size",void 0),Sa=h([I("esri.symbols.MarkerSymbol")],Sa);var eM;let gr=eM=class extends Sa{constructor(...e){super(...e),this.color=null,this.type="picture-marker",this.url=null,this.source=null,this.height=12,this.width=12,this.size=null}normalizeCtorArgs(e,t,i){if(e&&typeof e!="string"&&e.imageData==null)return e;const r={};return e&&(r.url=e),t!=null&&(r.width=ct(t)),i!=null&&(r.height=ct(i)),r}readHeight(e,t){return t.size||e}readWidth(e,t){return t.size||e}clone(){const e=new eM({angle:this.angle,height:this.height,url:this.url,width:this.width,xoffset:this.xoffset,yoffset:this.yoffset});return e._set("source",V(this.source)),e}hash(){return`${super.hash()}.${this.height}.${this.url}.${this.width}`}};h([f({json:{write:!1}})],gr.prototype,"color",void 0),h([me({esriPMS:"picture-marker"},{readOnly:!0})],gr.prototype,"type",void 0),h([f(nV)],gr.prototype,"url",void 0),h([f(oV)],gr.prototype,"source",void 0),h([f({type:Number,cast:ct,json:{write:!0}})],gr.prototype,"height",void 0),h([Ae("height",["height","size"])],gr.prototype,"readHeight",null),h([f({type:Number,cast:ct,json:{write:!0}})],gr.prototype,"width",void 0),h([f({json:{write:!1}})],gr.prototype,"size",void 0),gr=eM=h([I("esri.symbols.PictureMarkerSymbol")],gr);var Xu;const aV=ne.ofType({base:null,key:"type",typeMap:{icon:Fi,object:Mi,text:mi}});let xr=Xu=class extends Dr{constructor(e){super(e),this.verticalOffset=null,this.callout=null,this.symbolLayers=new aV,this.type="point-3d"}supportsCallout(){if((this.symbolLayers?this.symbolLayers.length:0)<1)return!1;for(const e of this.symbolLayers.items)switch(e.type){case"icon":case"text":case"object":continue;default:return!1}return!0}hasVisibleCallout(){return Q8(this)}hasVisibleVerticalOffset(){return XC(this)}clone(){return new Xu({verticalOffset:V(this.verticalOffset),callout:V(this.callout),styleOrigin:V(this.styleOrigin),symbolLayers:V(this.symbolLayers),thumbnail:V(this.thumbnail)})}static fromSimpleMarkerSymbol(e){return new Xu({symbolLayers:new ne([Fi.fromSimpleMarkerSymbol(e)])})}static fromPictureMarkerSymbol(e){return new Xu({symbolLayers:new ne([Fi.fromPictureMarkerSymbol(e)])})}static fromCIMSymbol(e){if(e.data?.symbol?.type!=="CIMPointSymbol")return null;const i=e.data.symbol;return new Xu(i?.callout?{symbolLayers:new ne([Fi.fromCIMSymbol(e)]),callout:new wa({size:.5,color:new X([0,0,0])}),verticalOffset:new Wl({screenLength:40})}:{symbolLayers:new ne([Fi.fromCIMSymbol(e)])})}static fromTextSymbol(e){return new Xu({symbolLayers:new ne([mi.fromTextSymbol(e)])})}};h([f({type:Wl,json:{write:!0}})],xr.prototype,"verticalOffset",void 0),h([f(eV)],xr.prototype,"callout",void 0),h([f({type:aV,json:{origins:{"web-scene":{write:!0}}}})],xr.prototype,"symbolLayers",void 0),h([me({PointSymbol3D:"point-3d"},{readOnly:!0})],xr.prototype,"type",void 0),xr=Xu=h([I("esri.symbols.PointSymbol3D")],xr);var Dm;const lV=ne.ofType({base:null,key:"type",typeMap:{extrude:va,fill:vr,icon:Fi,line:_r,object:Mi,text:mi,water:ba}});let zs=Dm=class extends Dr{constructor(e){super(e),this.symbolLayers=new lV,this.type="polygon-3d"}initialize(){const e=t=>{t.type==="line"&&cu(H.getLogger(this),"LineSymbol3DLayer can not be used as a SymbolLayer with a PolygonSymbol3D symbol anymore.",{replacement:"Use FillSymbol3DLayer.outline instead.",version:"4.28"}),t.type==="text"&&cu(H.getLogger(this),"TextSymbol3DLayer can not be used as a SymbolLayer with a PolygonSymbol3D symbol anymore.",{replacement:"Use Labels instead.",version:"4.28"})};for(const t of this.symbolLayers)e(t);this.addHandles(In((()=>this.symbolLayers),"after-add",(({item:t})=>e(t)),yu))}clone(){return new Dm({styleOrigin:V(this.styleOrigin),symbolLayers:V(this.symbolLayers),thumbnail:V(this.thumbnail)})}static fromJSON(e){const t=new Dm;if(t.read(e),t.symbolLayers.length===2&&t.symbolLayers.at(0).type==="fill"&&t.symbolLayers.at(1).type==="line"){const i=t.symbolLayers.at(0),r=t.symbolLayers.at(1);!r.enabled||e.symbolLayers?.[1]&&e.symbolLayers[1].enable===!1||(i.outline={size:r.size,color:r.material!=null?r.material.color:null}),t.symbolLayers.removeAt(1)}return t}static fromSimpleFillSymbol(e){return new Dm({symbolLayers:new ne([vr.fromSimpleFillSymbol(e)])})}};h([f({type:lV,json:{write:!0}})],zs.prototype,"symbolLayers",void 0),h([me({PolygonSymbol3D:"polygon-3d"},{readOnly:!0})],zs.prototype,"type",void 0),zs=Dm=h([I("esri.symbols.PolygonSymbol3D")],zs);var tM;const C2=new Ye({esriSFSSolid:"solid",esriSFSNull:"none",esriSFSHorizontal:"horizontal",esriSFSVertical:"vertical",esriSFSForwardDiagonal:"forward-diagonal",esriSFSBackwardDiagonal:"backward-diagonal",esriSFSCross:"cross",esriSFSDiagonalCross:"diagonal-cross"});let $r=tM=class extends kd{constructor(...e){super(...e),this.color=new X([0,0,0,.25]),this.outline=new Nt,this.type="simple-fill",this.style="solid"}normalizeCtorArgs(e,t,i){if(e&&typeof e!="string")return e;const r={};return e&&(r.style=e),t&&(r.outline=t),i&&(r.color=i),r}clone(){return new tM({color:V(this.color),outline:this.outline&&this.outline.clone(),style:this.style})}hash(){return`${super.hash()}${this.style}.${this.color&&this.color.hash()}`}};h([f()],$r.prototype,"color",void 0),h([f()],$r.prototype,"outline",void 0),h([me({esriSFS:"simple-fill"},{readOnly:!0})],$r.prototype,"type",void 0),h([f({type:C2.apiValues,json:{read:C2.read,write:C2.write}})],$r.prototype,"style",void 0),$r=tM=h([I("esri.symbols.SimpleFillSymbol")],$r);var iM;const P2=new Ye({esriSMSCircle:"circle",esriSMSSquare:"square",esriSMSCross:"cross",esriSMSX:"x",esriSMSDiamond:"diamond",esriSMSTriangle:"triangle",esriSMSPath:"path"});let Ct=iM=class extends Sa{constructor(...e){super(...e),this.color=new X([255,255,255,.25]),this.type="simple-marker",this.size=12,this.style="circle",this.outline=new Nt}normalizeCtorArgs(e,t,i,r){if(e&&typeof e!="string")return e;const s={};return e&&(s.style=e),t!=null&&(s.size=ct(t)),i&&(s.outline=i),r&&(s.color=r),s}writeColor(e,t){e&&this.style!=="x"&&this.style!=="cross"&&(t.color=e.toJSON()),e===null&&(t.color=null)}set path(e){this.style="path",this._set("path",e)}clone(){return new iM({angle:this.angle,color:V(this.color),outline:this.outline&&this.outline.clone(),path:this.path,size:this.size,style:this.style,xoffset:this.xoffset,yoffset:this.yoffset})}hash(){return`${super.hash()}.${this.color&&this.color.hash()}.${this.path}.${this.style}.${this.outline?.hash()}`}};h([f()],Ct.prototype,"color",void 0),h([$e("color")],Ct.prototype,"writeColor",null),h([me({esriSMS:"simple-marker"},{readOnly:!0})],Ct.prototype,"type",void 0),h([f()],Ct.prototype,"size",void 0),h([f({type:P2.apiValues,json:{read:P2.read,write:P2.write}})],Ct.prototype,"style",void 0),h([f({type:String,json:{write:!0}})],Ct.prototype,"path",null),h([f({types:{key:"type",base:null,defaultKeyValue:"simple-line",typeMap:{"simple-line":Nt}},json:{default:null,write:!0}})],Ct.prototype,"outline",void 0),Ct=iM=h([I("esri.symbols.SimpleMarkerSymbol")],Ct);var rM;let tt=rM=class extends Kt{constructor(...e){super(...e),this.backgroundColor=null,this.borderLineColor=null,this.borderLineSize=null,this.font=new os,this.horizontalAlignment="center",this.kerning=!0,this.haloColor=null,this.haloSize=null,this.rightToLeft=null,this.rotated=!1,this.text="",this.type="text",this.verticalAlignment="baseline",this.xoffset=0,this.yoffset=0,this.angle=0,this.width=null,this.lineWidth=192,this.lineHeight=1}normalizeCtorArgs(e,t,i){if(e&&typeof e!="string")return e;const r={};return e&&(r.text=e),t&&(r.font=t),i&&(r.color=i),r}writeLineWidth(e,t,i,r){r&&typeof r!="string"?r.origin:t[i]=e}castLineWidth(e){return ct(e)}writeLineHeight(e,t,i,r){r&&typeof r!="string"?r.origin:t[i]=e}clone(){return new rM({angle:this.angle,backgroundColor:V(this.backgroundColor),borderLineColor:V(this.borderLineColor),borderLineSize:this.borderLineSize,color:V(this.color),font:this.font&&this.font.clone(),haloColor:V(this.haloColor),haloSize:this.haloSize,horizontalAlignment:this.horizontalAlignment,kerning:this.kerning,lineHeight:this.lineHeight,lineWidth:this.lineWidth,rightToLeft:this.rightToLeft,rotated:this.rotated,text:this.text,verticalAlignment:this.verticalAlignment,width:this.width,xoffset:this.xoffset,yoffset:this.yoffset})}hash(){return`${this.backgroundColor?.hash()}.${this.borderLineColor}.${this.borderLineSize}.${this.color?.hash()}.${this.font&&this.font.hash()}.${this.haloColor?.hash()}.${this.haloSize}.${this.horizontalAlignment}.${this.kerning}.${this.rightToLeft}.${this.rotated}.${this.text}.${this.verticalAlignment}.${this.width}.${this.xoffset}.${this.yoffset}.${this.lineHeight}.${this.lineWidth}.${this.angle}`}};h([f({type:X,json:{write:!0}})],tt.prototype,"backgroundColor",void 0),h([f({type:X,json:{write:!0}})],tt.prototype,"borderLineColor",void 0),h([f({type:Number,json:{write:!0},cast:ct})],tt.prototype,"borderLineSize",void 0),h([f({type:os,json:{write:!0}})],tt.prototype,"font",void 0),h([f({...J8,json:{write:!0}})],tt.prototype,"horizontalAlignment",void 0),h([f({type:Boolean,json:{write:!0}})],tt.prototype,"kerning",void 0),h([f({type:X,json:{write:!0}})],tt.prototype,"haloColor",void 0),h([f({type:Number,cast:ct,json:{write:!0}})],tt.prototype,"haloSize",void 0),h([f({type:Boolean,json:{write:!0}})],tt.prototype,"rightToLeft",void 0),h([f({type:Boolean,json:{write:!0}})],tt.prototype,"rotated",void 0),h([f({type:String,json:{write:!0}})],tt.prototype,"text",void 0),h([me({esriTS:"text"},{readOnly:!0})],tt.prototype,"type",void 0),h([f({...X8,json:{write:!0}})],tt.prototype,"verticalAlignment",void 0),h([f({type:Number,cast:ct,json:{write:!0}})],tt.prototype,"xoffset",void 0),h([f({type:Number,cast:ct,json:{write:!0}})],tt.prototype,"yoffset",void 0),h([f({type:Number,json:{read:e=>e&&-1*e,write:(e,t)=>t.angle=e&&-1*e}})],tt.prototype,"angle",void 0),h([f({type:Number,json:{write:!0}})],tt.prototype,"width",void 0),h([f({type:Number})],tt.prototype,"lineWidth",void 0),h([$e("lineWidth")],tt.prototype,"writeLineWidth",null),h([Ke("lineWidth")],tt.prototype,"castLineWidth",null),h([f(Y8)],tt.prototype,"lineHeight",void 0),h([$e("lineHeight")],tt.prototype,"writeLineHeight",null),tt=rM=h([I("esri.symbols.TextSymbol")],tt);var sM;let Ei=sM=class extends Kt{constructor(e){super(e),this.color=null,this.styleName=null,this.portal=null,this.styleUrl=null,this.thumbnail=null,this.name=null,this.type="web-style"}get _fetchCacheKey(){const e=this.portal!=null?this.portal:Z.getDefault(),t=e.user?e.user.username:null;return`${this.styleName}:${this.styleUrl}:${this.name}:${t}:${e.url}`}read(e,t){this.portal=t?.portal,super.read(e,t)}clone(){return new sM({name:this.name,styleUrl:this.styleUrl,styleName:this.styleName,portal:this.portal})}fetchSymbol(e){return this._fetchSymbol(e)}async fetchCIMSymbol(e){PD(H.getLogger(this),"WebStyleSymbol.fetchCIMSymbol is deprecated in favour of WebStyleSymbol.fetchSymbol which now supports both web and cim symbology",{version:"4.33",replacement:"WebStyleSymbol.fetchSymbol",see:"https://arcg.is/0CXPTr#fetchSymbol",warnOnce:!0});const t=await this._fetchSymbol({...e,acceptedFormats:["cim"]});if(t?.type!=="cim")throw new j("webstylesymbol:fetchCIMSymbol","Resolved web style symbol is not of type 'cim'");return t}async _fetchSymbol(e){const t=e!=null?e.cache:null,i=t?this._fetchCacheKey:null;if(t!=null){const o=i&&t.get(i);if(o)return o.clone()}const{resolveWebStyleSymbol:r}=await J(()=>Promise.resolve().then(()=>kve),void 0);It(e);const s=r(this,{portal:this.portal},e);s.catch((o=>{H.getLogger(this).error("#fetchSymbol()","Failed to create symbol from style",o)}));const n=await s;return t?.set(i,n.clone()),n}};h([f({json:{write:!1}})],Ei.prototype,"color",void 0),h([f({type:String,json:{write:!0}})],Ei.prototype,"styleName",void 0),h([f({type:Z,json:{write:!1}})],Ei.prototype,"portal",void 0),h([f({type:String,json:{read:kb,write:kp}})],Ei.prototype,"styleUrl",void 0),h([f({type:qc,json:{read:!1}})],Ei.prototype,"thumbnail",void 0),h([f({type:String,json:{write:!0}})],Ei.prototype,"name",void 0),h([me({styleSymbolReference:"web-style"},{readOnly:!0})],Ei.prototype,"type",void 0),h([f()],Ei.prototype,"_fetchCacheKey",null),Ei=sM=h([I("esri.symbols.WebStyleSymbol")],Ei);function cw(e){if(!e)return!1;switch(e.type){case"picture-fill":case"picture-marker":case"simple-fill":case"simple-line":case"simple-marker":case"text":case"cim":return!0;default:return!1}}function qo(e){switch(e?.type){case"label-3d":case"line-3d":case"mesh-3d":case"point-3d":case"polygon-3d":return!0;default:return!1}}const kc={base:Kt,key:"type",typeMap:{"simple-fill":$r,"picture-fill":Rr,"picture-marker":gr,"simple-line":Nt,"simple-marker":Ct,text:tt,"label-3d":_n,"line-3d":Cn,"mesh-3d":Ra,"point-3d":xr,"polygon-3d":zs,"web-style":Ei,cim:er},errorContext:"symbol"},rIe={base:Kt,key:"type",typeMap:{"picture-marker":gr,"simple-marker":Ct,"point-3d":xr,cim:er},errorContext:"symbol"},sIe={base:Kt,key:"type",typeMap:{"simple-line":Nt,"line-3d":Cn,cim:er},errorContext:"symbol"},nIe={base:Kt,key:"type",typeMap:{"simple-fill":$r,"picture-fill":Rr,"polygon-3d":zs,cim:er},errorContext:"symbol"},oIe={base:Kt,key:"type",typeMap:{"picture-marker":gr,"simple-marker":Ct,text:tt,"web-style":Ei,cim:er},errorContext:"symbol"},Noe=Rg({types:kc}),Doe={base:Kt,key:"type",typeMap:{"simple-fill":$r,"picture-fill":Rr,"picture-marker":gr,"simple-line":Nt,"simple-marker":Ct,text:tt,"line-3d":Cn,"mesh-3d":Ra,"point-3d":xr,"polygon-3d":zs,"web-style":Ei,cim:er},errorContext:"symbol"},aIe={base:Kt,key:"type",typeMap:{text:tt,"label-3d":_n},errorContext:"symbol"},SL={base:Kt,key:"type",typeMap:{"line-3d":Cn,"mesh-3d":Ra,"point-3d":xr,"polygon-3d":zs,"web-style":Ei,cim:er},errorContext:"symbol"},lIe={base:Kt,key:"type",typeMap:{"label-3d":_n},errorContext:"symbol"},uV=hu(kc);var nM;function Foe(e){if(!e)return null;const t={};for(const i in e){const r=hh(e[i]);r&&(t[i]=r)}return Object.keys(t).length!==0?t:null}function zoe(e){if(e==null)return null;const t={};for(const i in e){const r=e[i];r&&(t[i]=r.toJSON())}return Object.keys(t).length!==0?t:null}var wp;let Ni=(wp=class extends xt.ClonableMixin(ee){constructor(t){super(t),this.isAggregate=!1,this.layer=null,this.origin=null,this.sourceLayer=null,this._version=0,Object.defineProperty(this,"uid",{value:M_(),configurable:!0}),Object.defineProperty(this,"_lastMeshTransform",{value:{},configurable:!0,writable:!0,enumerable:!1}),arguments.length>1&&WH(H.getLogger(this),"Graphic",{version:"4.30"})}initialize(){this._watchMeshGeometryChanges()}set aggregateGeometries(t){const i=this._get("aggregateGeometries");JSON.stringify(i)!==JSON.stringify(t)&&this._set("aggregateGeometries",t)}set attributes(t){const i=this._get("attributes");i!==t&&(this._set("attributes",t),this._notifyLayer("attributes",i,t))}set geometry(t){const i=this._get("geometry");i!==t&&(this._set("geometry",t),t?.type!=="mesh"&&this._notifyLayer("geometry",i,t))}set popupTemplate(t){const i=this._get("popupTemplate");i!==t&&(this._set("popupTemplate",t),this._notifyLayer("popupTemplate",i,t))}set symbol(t){const i=this._get("symbol");i!==t&&(this._set("symbol",t),this._notifyLayer("symbol",i,t))}get version(){return this._version}set visible(t){const i=this._get("visible");i!==t&&(this._set("visible",t),this._notifyLayer("visible",i,t))}cloneShallow(){return new nM({aggregateGeometries:this.aggregateGeometries,attributes:this.attributes,geometry:this.geometry,isAggregate:this.isAggregate,layer:this.layer,popupTemplate:this.popupTemplate,sourceLayer:this.sourceLayer,symbol:this.symbol,visible:this.visible,origin:this.origin})}getEffectivePopupTemplate(t=!1){if(this.popupTemplate)return this.popupTemplate;const i=this.origin&&"layer"in this.origin?this.origin.layer:null;for(const r of[i,this.sourceLayer,this.layer])if(r){if("popupTemplate"in r&&r.popupTemplate)return r.popupTemplate;if(t&&"defaultPopupTemplate"in r&&r.defaultPopupTemplate!=null)return r.defaultPopupTemplate}return null}getAttribute(t){return this.attributes?.[t]}setAttribute(t,i){if(this.attributes){const r=this.getAttribute(t);this.attributes[t]=i,this._notifyLayer("attributes",r,i,t)}else this.attributes={[t]:i}}getObjectId(){const t=this.sourceLayer??this.layer;return t?Yne(this,t):null}getGlobalId(){const t=this.sourceLayer??this.layer;return t&&"globalIdField"in t&&t.globalIdField?this.getAttribute(t.globalIdField):null}toJSON(){return{aggregateGeometries:zoe(this.aggregateGeometries),geometry:this.geometry!=null?this.geometry.toJSON():null,symbol:this.symbol!=null?this.symbol.toJSON():null,attributes:zy(this.attributes)?this.attributes.toJSON():{...this.attributes},popupTemplate:this.popupTemplate?.toJSON()??null}}notifyMeshTransformChanged(t={}){const{geometry:i}=this;if(i?.type==="mesh"){const r={origin:i.origin,transform:i.transform};this._notifyLayer("origin-transform",r,r,t.action)}}_notifyLayer(t,i,r,s){if(this._version++,!this.layer||!("graphicChanged"in this.layer))return;const n={graphic:this,property:t,oldValue:i,newValue:r};t==="origin-transform"&&(n.action=s),t==="attributes"&&(n.attributeName=s),this.layer.graphicChanged(n)}_watchMeshGeometryChanges(){this.addHandles([Yr((()=>this.geometry?.type==="mesh"&&this.geometry.vertexSpace.origin?{localMatrix:this.geometry.transform?.localMatrix,origin:this.geometry.vertexSpace.origin}:void 0),(({localMatrix:t,origin:i})=>{this._lastMeshTransform.localMatrix===t&&this._lastMeshTransform.origin===i||(this._lastMeshTransform.localMatrix=t,this._lastMeshTransform.origin=i,this.notifyMeshTransformChanged())})),Yr((()=>this.geometry?.type==="mesh"?{vertexAttributes:this.geometry.vertexAttributes}:void 0),(()=>{const t=this.geometry;t?.type==="mesh"&&t.vertexSpace.origin?(this._lastMeshTransform.localMatrix=t.transform?.localMatrix,this._lastMeshTransform.origin=t.vertexSpace.origin):(this._lastMeshTransform.localMatrix=void 0,this._lastMeshTransform.origin=void 0),this._notifyLayer("geometry",this.geometry,this.geometry)}),{equals:(t,i)=>t===i,sync:!0})])}},nM=wp,wp);h([f({value:null,json:{read:Foe}})],Ni.prototype,"aggregateGeometries",null),h([f({value:null})],Ni.prototype,"attributes",null),h([f({value:null,types:OC,json:{read:hh}})],Ni.prototype,"geometry",null),h([f({type:Boolean})],Ni.prototype,"isAggregate",void 0),h([f({clonable:!1})],Ni.prototype,"layer",void 0),h([f({clonable:"reference"})],Ni.prototype,"origin",void 0),h([f({type:Zne,value:null})],Ni.prototype,"popupTemplate",null),h([f({clonable:"reference"})],Ni.prototype,"sourceLayer",void 0),h([f({value:null,types:kc})],Ni.prototype,"symbol",null),h([f({clonable:!1,json:{read:!1,write:!1}})],Ni.prototype,"_version",void 0),h([f({type:Boolean,value:!0})],Ni.prototype,"visible",null),Ni=nM=h([I("esri.Graphic")],Ni);let Ey=class extends by{_own(t){t.layer&&"remove"in t.layer&&t.layer!==this.owner&&t.layer.remove(t),t.layer=this.owner}_release(t){t.layer===this.owner&&(t.layer=null)}};h([h4({Type:Ni,ensureType:Ui(Ni)})],Ey.prototype,"itemType",void 0),Ey=h([I("esri.support.GraphicsCollection")],Ey);let $l=class extends le{constructor(t){super(t),this.view=null,this.baseLayerViews=new ne,this.referenceLayerViews=new ne,this._loadingHandle=te((()=>this.view?.map?.basemap),(i=>{i&&i.load().catch((()=>{}))}),Pt)}destroy(){this._set("view",null),this._loadingHandle&&(this._loadingHandle.remove(),this._loadingHandle=null);for(const t of this.baseLayerViews)t.destroy();this.baseLayerViews.length=0;for(const t of this.referenceLayerViews)t.destroy();this.referenceLayerViews.length=0}get suspended(){return this.view?.suspended??!0}get updating(){return this.view?.suspended?!1:!!this.view?.map?.basemap?.loaded&&(this.baseLayerViews.some((i=>i.updating))||this.referenceLayerViews.some((i=>i.updating)))}};h([f({constructOnly:!0})],$l.prototype,"view",void 0),h([f({readOnly:!0})],$l.prototype,"baseLayerViews",void 0),h([f({readOnly:!0})],$l.prototype,"referenceLayerViews",void 0),h([f({readOnly:!0})],$l.prototype,"suspended",null),h([f({type:Boolean,readOnly:!0})],$l.prototype,"updating",null),$l=h([I("esri.views.BasemapView")],$l);const Voe=$l;let Qr=class extends le{constructor(t){super(t),this.factor=1.5,this.offset=ei(0,0),this.position=null,this.size=120,this.maskUrl=null,this.maskEnabled=!0,this.overlayUrl=null,this.overlayEnabled=!0,this.visible=!0}get version(){return this.commitProperty("factor"),this.commitProperty("offset"),this.commitProperty("position"),this.commitProperty("visible"),this.commitProperty("size"),this.commitProperty("maskUrl"),this.commitProperty("maskEnabled"),this.commitProperty("overlayUrl"),this.commitProperty("overlayEnabled"),(this._get("version")||0)+1}};h([f({type:Number})],Qr.prototype,"factor",void 0),h([f({nonNullable:!0})],Qr.prototype,"offset",void 0),h([f()],Qr.prototype,"position",void 0),h([f({type:Number,range:{min:0}})],Qr.prototype,"size",void 0),h([f()],Qr.prototype,"maskUrl",void 0),h([f()],Qr.prototype,"maskEnabled",void 0),h([f()],Qr.prototype,"overlayUrl",void 0),h([f()],Qr.prototype,"overlayEnabled",void 0),h([f({readOnly:!0})],Qr.prototype,"version",null),h([f({type:Boolean})],Qr.prototype,"visible",void 0),Qr=h([I("esri.views.Magnifier")],Qr);const cV=Qr;let u1=class{constructor(t){this._observable=new Og,this._map=new Map(t)}get size(){return ge(this._observable),this._map.size}clear(){this._map.size>0&&(this._map.clear(),this._observable.notify())}delete(t){const i=this._map.delete(t);return i&&this._observable.notify(),i}entries(){return ge(this._observable),this._map.entries()}forEach(t,i){ge(this._observable),this._map.forEach(((r,s)=>t.call(i,r,s,this)),i)}get(t){return ge(this._observable),this._map.get(t)}has(t){return ge(this._observable),this._map.has(t)}keys(){return ge(this._observable),this._map.keys()}set(t,i){return this._map.set(t,i),this._observable.notify(),this}values(){return ge(this._observable),this._map.values()}[Symbol.iterator](){return ge(this._observable),this._map[Symbol.iterator]()}[Symbol.dispose](){this._observable.destroy()}get[Symbol.toStringTag](){return this._map[Symbol.toStringTag]}};var oM;let Fm=oM=class extends ee{constructor(e){super(e),this.name=null,this.code=null}clone(){return new oM({name:this.name,code:this.code})}};h([f({type:String,json:{write:{isRequired:!0}}})],Fm.prototype,"name",void 0),h([f({type:[String,Number],json:{write:{isRequired:!0}}})],Fm.prototype,"code",void 0),Fm=oM=h([I("esri.layers.support.CodedValue")],Fm);const Uoe=new Ye({inherited:"inherited",codedValue:"coded-value",range:"range"});let iu=class extends ee{constructor(t){super(t),this.name=null,this.type=null}};h([f({type:String,json:{write:!0}})],iu.prototype,"name",void 0),h([me(Uoe),f({json:{write:{isRequired:!0}}})],iu.prototype,"type",void 0),iu=h([I("esri.layers.support.Domain")],iu);var aM,Sp;let Rd=(Sp=class extends iu{constructor(t){super(t),this.codedValues=null,this.type="coded-value"}getName(t){let i=null;if(this.codedValues){const r=String(t);this.codedValues.some((s=>(String(s.code)===r&&(i=s.name),!!i)))}return i}clone(){return new aM({codedValues:V(this.codedValues),name:this.name})}},aM=Sp,Sp);h([f({type:[Fm],json:{write:{isRequired:!0}}})],Rd.prototype,"codedValues",void 0),h([me({codedValue:"coded-value"})],Rd.prototype,"type",void 0),Rd=aM=h([I("esri.layers.support.CodedValueDomain")],Rd);var lM,xp;let Cy=(xp=class extends iu{constructor(t){super(t),this.type="inherited"}clone(){return new lM}},lM=xp,xp);h([me({inherited:"inherited"})],Cy.prototype,"type",void 0),Cy=lM=h([I("esri.layers.support.InheritedDomain")],Cy);var uM,$p;let wc=($p=class extends iu{constructor(t){super(t),this.maxValue=null,this.minValue=null,this.type="range"}clone(){return new uM({maxValue:this.maxValue,minValue:this.minValue,name:this.name})}},uM=$p,$p);h([f({json:{type:[Number],read:{source:"range",reader:(e,t)=>t.range?.[1]},write:{enabled:!1,overridePolicy(){return{enabled:this.maxValue!=null&&this.minValue==null}},target:"range",writer(e,t,i){t[i]=[this.minValue||0,e]},isRequired:!0}}})],wc.prototype,"maxValue",void 0),h([f({json:{type:[Number],read:{source:"range",reader:(e,t)=>t.range?.[0]},write:{target:"range",writer(e,t,i){t[i]=[e,this.maxValue||0]},isRequired:!0}}})],wc.prototype,"minValue",void 0),h([me({range:"range"})],wc.prototype,"type",void 0),wc=uM=h([I("esri.layers.support.RangeDomain")],wc);const joe={key:"type",base:iu,typeMap:{range:wc,"coded-value":Rd,inherited:Cy}};function Goe(e){if(!e?.type)return null;switch(e.type){case"range":return wc.fromJSON(e);case"codedValue":return Rd.fromJSON(e);case"inherited":return Cy.fromJSON(e)}return null}const Boe=new Ye({esriFieldTypeSmallInteger:"small-integer",esriFieldTypeInteger:"integer",esriFieldTypeSingle:"single",esriFieldTypeDouble:"double",esriFieldTypeLong:"long",esriFieldTypeString:"string",esriFieldTypeDate:"date",esriFieldTypeOID:"oid",esriFieldTypeGeometry:"geometry",esriFieldTypeBlob:"blob",esriFieldTypeRaster:"raster",esriFieldTypeGUID:"guid",esriFieldTypeGlobalID:"global-id",esriFieldTypeXML:"xml",esriFieldTypeBigInteger:"big-integer",esriFieldTypeDateOnly:"date-only",esriFieldTypeTimeOnly:"time-only",esriFieldTypeTimestampOffset:"timestamp-offset"});var cM;const qoe=new Ye({binary:"binary",coordinate:"coordinate",countOrAmount:"count-or-amount",dateAndTime:"date-and-time",description:"description",locationOrPlaceName:"location-or-place-name",measurement:"measurement",nameOrTitle:"name-or-title",none:"none",orderedOrRanked:"ordered-or-ranked",percentageOrRatio:"percentage-or-ratio",typeOrCategory:"type-or-category",uniqueIdentifier:"unique-identifier"});var Mp;let Wi=(Mp=class extends ee{constructor(t){super(t),this.alias=null,this.defaultValue=void 0,this.description=null,this.domain=null,this.editable=!0,this.length=void 0,this.name=null,this.nullable=!0,this.type=null,this.valueType=null,this.visible=!0}readDescription(t,{description:i}){let r=null;try{r=i?JSON.parse(i):null}catch{}return r?.value??null}readValueType(t,{description:i}){let r=null;try{r=i?JSON.parse(i):null}catch{}return r?qoe.fromJSON(r.fieldValueType):null}clone(){return new cM({alias:this.alias,defaultValue:this.defaultValue,description:this.description,domain:this.domain?.clone()??null,editable:this.editable,length:this.length,name:this.name,nullable:this.nullable,type:this.type,valueType:this.valueType,visible:this.visible})}},cM=Mp,Mp);h([f({type:String,json:{write:!0}})],Wi.prototype,"alias",void 0),h([f({type:[String,Number],json:{write:{allowNull:!0}}})],Wi.prototype,"defaultValue",void 0),h([f()],Wi.prototype,"description",void 0),h([Ae("description")],Wi.prototype,"readDescription",null),h([f({types:joe,json:{read:{reader:Goe},write:!0}})],Wi.prototype,"domain",void 0),h([f({type:Boolean,json:{write:!0}})],Wi.prototype,"editable",void 0),h([f({type:Ue,json:{write:{overridePolicy:e=>({enabled:Number.isFinite(e)})}}})],Wi.prototype,"length",void 0),h([f({type:String,json:{write:!0}})],Wi.prototype,"name",void 0),h([f({type:Boolean,json:{write:!0}})],Wi.prototype,"nullable",void 0),h([me(Boe)],Wi.prototype,"type",void 0),h([f()],Wi.prototype,"valueType",void 0),h([Ae("valueType",["description"])],Wi.prototype,"readValueType",null),h([f({type:Boolean,json:{read:!1}})],Wi.prototype,"visible",void 0),Wi=cM=h([I("esri.layers.support.Field")],Wi);var hM;let ad=hM=class extends ee{constructor(e){super(e),this.type="map-layer"}clone(){const{mapLayerId:e,gdbVersion:t}=this;return new hM({mapLayerId:e,gdbVersion:t})}};h([me({mapLayer:"map-layer"}),f({json:{write:{isRequired:!0}}})],ad.prototype,"type",void 0),h([f({type:Ue,json:{write:{isRequired:!0}}})],ad.prototype,"mapLayerId",void 0),h([f({type:String,json:{write:!0}})],ad.prototype,"gdbVersion",void 0),ad=hM=h([I("esri.layers.support.source.MapLayerSource")],ad);var dM;let da=dM=class extends ee{constructor(e){super(e),this.type="query-table"}clone(){const{workspaceId:e,query:t,oidFields:i,spatialReference:r,geometryType:s}=this,n={workspaceId:e,query:t,oidFields:i,spatialReference:r?.clone()??void 0,geometryType:s};return new dM(n)}};h([me({queryTable:"query-table"}),f({json:{write:{isRequired:!0}}})],da.prototype,"type",void 0),h([f({type:String,json:{write:!0}})],da.prototype,"workspaceId",void 0),h([f({type:String,json:{write:!0}})],da.prototype,"query",void 0),h([f({type:String,json:{write:!0}})],da.prototype,"oidFields",void 0),h([f({type:ae,json:{write:!0}})],da.prototype,"spatialReference",void 0),h([me(Lie)],da.prototype,"geometryType",void 0),da=dM=h([I("esri.layers.support.source.QueryTableDataSource")],da);var pM;let ld=pM=class extends ee{constructor(e){super(e),this.type="raster"}clone(){const{workspaceId:e,dataSourceName:t}=this;return new pM({workspaceId:e,dataSourceName:t})}};h([me({raster:"raster"}),f({json:{write:{isRequired:!0}}})],ld.prototype,"type",void 0),h([f({type:String,json:{write:!0}})],ld.prototype,"dataSourceName",void 0),h([f({type:String,json:{write:!0}})],ld.prototype,"workspaceId",void 0),ld=pM=h([I("esri.layers.support.source.RasterDataSource")],ld);var fM;let Ku=fM=class extends ee{constructor(e){super(e),this.type="table"}clone(){const{workspaceId:e,gdbVersion:t,dataSourceName:i}=this;return new fM({workspaceId:e,gdbVersion:t,dataSourceName:i})}};h([me({table:"table"}),f({json:{write:{isRequired:!0}}})],Ku.prototype,"type",void 0),h([f({type:String,json:{write:!0}})],Ku.prototype,"workspaceId",void 0),h([f({type:String,json:{write:!0}})],Ku.prototype,"gdbVersion",void 0),h([f({type:String,json:{write:!0}})],Ku.prototype,"dataSourceName",void 0),Ku=fM=h([I("esri.layers.support.source.TableDataSource")],Ku);var mM,yM;const Hoe=cr()({esriLeftInnerJoin:"left-inner-join",esriLeftOuterJoin:"left-outer-join"});let es=mM=class extends ee{constructor(e){super(e),this.type="join-table"}readLeftTableSource(e,t,i){return xL()(e,t,i)}castLeftTableSource(e){return hu(gM(),e)}readRightTableSource(e,t,i){return xL()(e,t,i)}castRightTableSource(e){return hu(gM(),e)}clone(){const{leftTableKey:e,rightTableKey:t,leftTableSource:i,rightTableSource:r,joinType:s}=this,n={leftTableKey:e,rightTableKey:t,leftTableSource:i?.clone()??void 0,rightTableSource:r?.clone()??void 0,joinType:s};return new mM(n)}};h([me({joinTable:"join-table"}),f({json:{write:{isRequired:!0}}})],es.prototype,"type",void 0),h([f({type:String,json:{write:!0}})],es.prototype,"leftTableKey",void 0),h([f({type:String,json:{write:!0}})],es.prototype,"rightTableKey",void 0),h([f({json:{write:!0}})],es.prototype,"leftTableSource",void 0),h([Ae("leftTableSource")],es.prototype,"readLeftTableSource",null),h([Ke("leftTableSource")],es.prototype,"castLeftTableSource",null),h([f({json:{write:!0}})],es.prototype,"rightTableSource",void 0),h([Ae("rightTableSource")],es.prototype,"readRightTableSource",null),h([Ke("rightTableSource")],es.prototype,"castRightTableSource",null),h([me(Hoe)],es.prototype,"joinType",void 0),es=mM=h([I("esri.layers.support.source.JoinTableDataSource")],es);let I2=null;function xL(){return I2||(I2=Rg({types:gM()})),I2}let A2=null;function gM(){return A2||(A2={key:"type",base:null,typeMap:{"data-layer":xa,"map-layer":ad}}),A2}const Woe={key:"type",base:null,typeMap:{"join-table":es,"query-table":da,raster:ld,table:Ku}};var Tp;let xa=(Tp=class extends ee{constructor(t){super(t),this.type="data-layer"}clone(){const{fields:t,dataSource:i}=this;return new yM({fields:t,dataSource:i})}},yM=Tp,Tp);h([me({dataLayer:"data-layer"}),f({json:{write:{isRequired:!0}}})],xa.prototype,"type",void 0),h([f({type:[Wi],json:{write:!0}})],xa.prototype,"fields",void 0),h([f({types:Woe,json:{write:!0}})],xa.prototype,"dataSource",void 0),xa=yM=h([I("esri.layers.support.source.DataLayerSource")],xa),xa.from=Ui(xa);let Qu=class extends xt.ClonableMixin(ee){constructor(t){super(t),this.onFields=null,this.operator=null,this.searchTerm=null,this.searchType=null}};h([f({type:[String],json:{write:{enabled:!0,overridePolicy(){return{enabled:this.onFields!=null&&this.onFields.length>0}}}}})],Qu.prototype,"onFields",void 0),h([f({type:String,json:{write:!0}})],Qu.prototype,"operator",void 0),h([f({type:String,json:{write:!0}})],Qu.prototype,"searchTerm",void 0),h([f({type:String,json:{write:!0}})],Qu.prototype,"searchType",void 0),Qu=h([I("esri.rest.support.FullTextSearch")],Qu);const Zoe=Qu;var _M;const $L=new Ye({upperLeft:"upper-left",lowerLeft:"lower-left"});let zl=_M=class extends ee{constructor(e){super(e),this.extent=null,this.mode="view",this.originPosition="upper-left",this.tolerance=1}clone(){return new _M(V({extent:this.extent,mode:this.mode,originPosition:this.originPosition,tolerance:this.tolerance}))}};h([f({type:ke,json:{write:{overridePolicy(){return{enabled:this.mode==="view"}}}}})],zl.prototype,"extent",void 0),h([f({type:["view","edit"],json:{write:!0}})],zl.prototype,"mode",void 0),h([f({type:String,json:{read:$L.read,write:$L.write}})],zl.prototype,"originPosition",void 0),h([f({type:Number,json:{write:{overridePolicy(){return{enabled:this.mode==="view"}}}}})],zl.prototype,"tolerance",void 0),zl=_M=h([I("esri.rest.support.QuantizationParameters")],zl);const Yoe=new Ye({esriSpatialRelIntersects:"intersects",esriSpatialRelContains:"contains",esriSpatialRelCrosses:"crosses",esriSpatialRelDisjoint:"disjoint",esriSpatialRelEnvelopeIntersects:"envelope-intersects",esriSpatialRelIndexIntersects:"index-intersects",esriSpatialRelOverlaps:"overlaps",esriSpatialRelTouches:"touches",esriSpatialRelWithin:"within",esriSpatialRelRelation:"relation"});var vM;const ML=new Ye({count:"count",sum:"sum",min:"min",max:"max",avg:"avg",stddev:"stddev",var:"var",exceedslimit:"exceedslimit",percentile_cont:"percentile-continuous",percentile_disc:"percentile-discrete",EnvelopeAggregate:"envelope-aggregate",CentroidAggregate:"centroid-aggregate",ConvexHullAggregate:"convex-hull-aggregate"});let cn=vM=class extends ee{constructor(e){super(e),this.maxPointCount=void 0,this.maxRecordCount=void 0,this.maxVertexCount=void 0,this.onStatisticField=null,this.outStatisticFieldName=null,this.statisticType=null,this.statisticParameters=null}writeStatisticParameters(e,t){this.statisticType!=="percentile-continuous"&&this.statisticType!=="percentile-discrete"||(t.statisticParameters=V(e))}clone(){return new vM({maxPointCount:this.maxPointCount,maxRecordCount:this.maxRecordCount,maxVertexCount:this.maxVertexCount,onStatisticField:this.onStatisticField,outStatisticFieldName:this.outStatisticFieldName,statisticType:this.statisticType,statisticParameters:V(this.statisticParameters)})}};h([f({type:Number,json:{write:!0}})],cn.prototype,"maxPointCount",void 0),h([f({type:Number,json:{write:!0}})],cn.prototype,"maxRecordCount",void 0),h([f({type:Number,json:{write:!0}})],cn.prototype,"maxVertexCount",void 0),h([f({type:String,json:{write:!0}})],cn.prototype,"onStatisticField",void 0),h([f({type:String,json:{write:!0}})],cn.prototype,"outStatisticFieldName",void 0),h([f({type:String,json:{read:{source:"statisticType",reader:ML.read},write:{target:"statisticType",writer:ML.write}}})],cn.prototype,"statisticType",void 0),h([f({type:Object})],cn.prototype,"statisticParameters",void 0),h([$e("statisticParameters")],cn.prototype,"writeStatisticParameters",null),cn=vM=h([I("esri.rest.support.StatisticDefinition")],cn);var c1;const Joe=new Ye({esriSRUnit_Meter:"meters",esriSRUnit_Kilometer:"kilometers",esriSRUnit_Foot:"feet",esriSRUnit_StatuteMile:"miles",esriSRUnit_NauticalMile:"nautical-miles",esriSRUnit_USNauticalMile:"us-nautical-miles"});var Xc;let ye=(Xc=class extends ee{static from(t){return cf(c1,t)}constructor(t){super(t),this.aggregateIds=null,this.cacheHint=void 0,this.compactGeometryEnabled=!1,this.datumTransformation=null,this.defaultSpatialReferenceEnabled=!1,this.distance=void 0,this.dynamicDataSource=void 0,this.formatOf3DObjects=null,this.fullText=null,this.gdbVersion=null,this.geometry=null,this.geometryPrecision=void 0,this.groupByFieldsForStatistics=null,this.having=null,this.historicMoment=null,this.maxAllowableOffset=void 0,this.maxRecordCountFactor=1,this.multipatchOption=null,this.num=void 0,this.objectIds=null,this.orderByFields=null,this.outFields=null,this.outSpatialReference=null,this.outStatistics=null,this.parameterValues=null,this.pixelSize=null,this.quantizationParameters=null,this.rangeValues=null,this.relationParameter=null,this.resultType=null,this.returnCentroid=!1,this.returnDistinctValues=!1,this.returnExceededLimitFeatures=!0,this.returnGeometry=!1,this.returnQueryGeometry=!1,this.returnM=void 0,this.returnZ=void 0,this.returnTrueCurves=void 0,this.sourceSpatialReference=null,this.spatialRelationship="intersects",this.start=void 0,this.sqlFormat=null,this.text=null,this.timeExtent=null,this.timeReferenceUnknownClient=!1,this.units=null,this.where=null}castDatumTransformation(t){return typeof t=="number"||typeof t=="object"?t:null}writeHistoricMoment(t,i){i.historicMoment=t&&t.getTime()}writeParameterValues(t,i){if(t){const r={};for(const s in t){const n=t[s];Array.isArray(n)?r[s]=n.map((o=>o instanceof Date?o.getTime():o)):n instanceof Date?r[s]=n.getTime():r[s]=n}i.parameterValues=r}}writeStart(t,i){i.resultOffset=this.start,i.resultRecordCount=this.num||10,i.where="1=1"}writeWhere(t,i){i.where=t||"1=1"}clone(){return new c1(V({aggregateIds:this.aggregateIds,cacheHint:this.cacheHint,compactGeometryEnabled:this.compactGeometryEnabled,datumTransformation:this.datumTransformation,defaultSpatialReferenceEnabled:this.defaultSpatialReferenceEnabled,distance:this.distance,fullText:this.fullText,formatOf3DObjects:this.formatOf3DObjects,gdbVersion:this.gdbVersion,geometry:this.geometry,geometryPrecision:this.geometryPrecision,groupByFieldsForStatistics:this.groupByFieldsForStatistics,having:this.having,historicMoment:this.historicMoment!=null?new Date(this.historicMoment.getTime()):null,maxAllowableOffset:this.maxAllowableOffset,maxRecordCountFactor:this.maxRecordCountFactor,multipatchOption:this.multipatchOption,num:this.num,objectIds:this.objectIds,orderByFields:this.orderByFields,outFields:this.outFields,outSpatialReference:this.outSpatialReference,outStatistics:this.outStatistics,parameterValues:this.parameterValues,pixelSize:this.pixelSize,quantizationParameters:this.quantizationParameters,rangeValues:this.rangeValues,relationParameter:this.relationParameter,resultType:this.resultType,returnDistinctValues:this.returnDistinctValues,returnGeometry:this.returnGeometry,returnCentroid:this.returnCentroid,returnExceededLimitFeatures:this.returnExceededLimitFeatures,returnQueryGeometry:this.returnQueryGeometry,returnM:this.returnM,returnZ:this.returnZ,returnTrueCurves:this.returnTrueCurves,dynamicDataSource:this.dynamicDataSource,sourceSpatialReference:this.sourceSpatialReference,spatialRelationship:this.spatialRelationship,start:this.start,sqlFormat:this.sqlFormat,text:this.text,timeExtent:this.timeExtent,timeReferenceUnknownClient:this.timeReferenceUnknownClient,units:this.units,where:this.where}))}},c1=Xc,Xc.MAX_MAX_RECORD_COUNT_FACTOR=5,Xc);h([f({json:{write:!0}})],ye.prototype,"aggregateIds",void 0),h([f({type:Boolean,json:{write:!0}})],ye.prototype,"cacheHint",void 0),h([f({type:Boolean,json:{default:!1,write:!0}})],ye.prototype,"compactGeometryEnabled",void 0),h([f({json:{write:!0}})],ye.prototype,"datumTransformation",void 0),h([Ke("datumTransformation")],ye.prototype,"castDatumTransformation",null),h([f({type:Boolean,json:{default:!1,write:!0}})],ye.prototype,"defaultSpatialReferenceEnabled",void 0),h([f({type:Number,json:{write:!0}})],ye.prototype,"distance",void 0),h([f({type:xa,json:{write:!0}})],ye.prototype,"dynamicDataSource",void 0),h([f({type:String,json:{write:!0}})],ye.prototype,"formatOf3DObjects",void 0),h([f({type:[Zoe],json:{write:{enabled:!0,overridePolicy(){return{enabled:this.fullText!=null&&this.fullText.length>0}}}}})],ye.prototype,"fullText",void 0),h([f({type:String,json:{write:!0}})],ye.prototype,"gdbVersion",void 0),h([f({types:OC,json:{read:hh,write:!0}})],ye.prototype,"geometry",void 0),h([f({type:Number,json:{write:!0}})],ye.prototype,"geometryPrecision",void 0),h([f({type:[String],json:{write:!0}})],ye.prototype,"groupByFieldsForStatistics",void 0),h([f({type:String,json:{write:!0}})],ye.prototype,"having",void 0),h([f({type:Date})],ye.prototype,"historicMoment",void 0),h([$e("historicMoment")],ye.prototype,"writeHistoricMoment",null),h([f({type:Number,json:{write:!0}})],ye.prototype,"maxAllowableOffset",void 0),h([f({type:Number,cast:e=>e<1?1:e>ye.MAX_MAX_RECORD_COUNT_FACTOR?ye.MAX_MAX_RECORD_COUNT_FACTOR:e,json:{write:{overridePolicy:e=>({enabled:e>1})}}})],ye.prototype,"maxRecordCountFactor",void 0),h([f({type:["xyFootprint"],json:{write:!0}})],ye.prototype,"multipatchOption",void 0),h([f({type:Number,json:{read:{source:"resultRecordCount"}}})],ye.prototype,"num",void 0),h([f({json:{write:!0}})],ye.prototype,"objectIds",void 0),h([f({type:[String],json:{write:!0}})],ye.prototype,"orderByFields",void 0),h([f({type:[String],json:{write:!0}})],ye.prototype,"outFields",void 0),h([f({type:ae,json:{name:"outSR",write:!0}})],ye.prototype,"outSpatialReference",void 0),h([f({type:[cn],json:{write:{enabled:!0,overridePolicy(){return{enabled:this.outStatistics!=null&&this.outStatistics.length>0}}}}})],ye.prototype,"outStatistics",void 0),h([f({json:{write:!0}})],ye.prototype,"parameterValues",void 0),h([$e("parameterValues")],ye.prototype,"writeParameterValues",null),h([f({type:he,json:{write:!0}})],ye.prototype,"pixelSize",void 0),h([f({type:zl,json:{write:!0}})],ye.prototype,"quantizationParameters",void 0),h([f({type:[Object],json:{write:!0}})],ye.prototype,"rangeValues",void 0),h([f({type:String,json:{read:{source:"relationParam"},write:{target:"relationParam",overridePolicy(){return{enabled:this.spatialRelationship==="relation"}}}}})],ye.prototype,"relationParameter",void 0),h([f({type:String,json:{write:!0}})],ye.prototype,"resultType",void 0),h([f({type:Boolean,json:{default:!1,write:!0}})],ye.prototype,"returnCentroid",void 0),h([f({type:Boolean,json:{default:!1,write:!0}})],ye.prototype,"returnDistinctValues",void 0),h([f({type:Boolean,json:{default:!0,write:!0}})],ye.prototype,"returnExceededLimitFeatures",void 0),h([f({type:Boolean,json:{write:!0}})],ye.prototype,"returnGeometry",void 0),h([f({type:Boolean,json:{default:!1,write:!0}})],ye.prototype,"returnQueryGeometry",void 0),h([f({type:Boolean,json:{default:!1,write:!0}})],ye.prototype,"returnM",void 0),h([f({type:Boolean,json:{write:{overridePolicy:e=>({enabled:e})}}})],ye.prototype,"returnZ",void 0),h([f({type:Boolean,json:{write:!0}})],ye.prototype,"returnTrueCurves",void 0),h([f({type:ae,json:{write:!0}})],ye.prototype,"sourceSpatialReference",void 0),h([me(Yoe,{ignoreUnknown:!1,name:"spatialRel"})],ye.prototype,"spatialRelationship",void 0),h([f({type:Number,json:{read:{source:"resultOffset"}}})],ye.prototype,"start",void 0),h([$e("start"),$e("num")],ye.prototype,"writeStart",null),h([f({type:String,json:{write:!0}})],ye.prototype,"sqlFormat",void 0),h([f({type:String,json:{write:!0}})],ye.prototype,"text",void 0),h([f({type:yr,json:{write:!0}})],ye.prototype,"timeExtent",void 0),h([f({type:Boolean,json:{default:!1,write:!0}})],ye.prototype,"timeReferenceUnknownClient",void 0),h([me(Joe,{ignoreUnknown:!1}),f({json:{write:{overridePolicy(e){return{enabled:!!e&&this.distance!=null}}}}})],ye.prototype,"units",void 0),h([f({type:String,json:{write:{overridePolicy(e){return{enabled:e!=null||this.start!=null&&this.start>0}}}}})],ye.prototype,"where",void 0),h([$e("where")],ye.prototype,"writeWhere",null),ye=c1=h([I("esri.rest.support.Query")],ye);function dl(e){return!(e==null||typeof e!="object"||!("createQuery"in e)||!e.createQuery)}let Ss=class extends Ja.EventedAccessor{constructor(t){super(t),this._selectionMap=new u1,this._sources=new ne,this._trashCan=[],this._layerEditHandles=new ne,this._vizTaskId=0,this.view=null,this.showHighlight=!0,this.highlightName="default"}initialize(){this.addHandles([te((()=>[this.view,this.showHighlight]),(()=>this._refreshVisualization())),te((()=>this.view),(t=>{t?.when().then((()=>this.syncSources()))}),Pt),In((()=>this.sources),"change",(t=>{const i=this._selectionMap,r=[];for(const s of t.removed){const n=i.get(s);n&&(i.delete(s),n.highlightHandle?.remove(),r.push({layer:s,selection:[],added:[],removed:[...n.selection]}))}this._refreshListeners(),r.length&&this._onSelectionChange(r)}),{onListenerAdd:()=>this._refreshListeners()})])}destroy(){this.clear(),this._layerEditHandles.drain(St)}get selections(){return Array.from(this._selectionMap.entries()).map((t=>{const[i,r]=t;return{layer:i,selection:[...r.selection]}}))}get count(){let t=0;for(const i of this._selectionMap.values())t+=i.selection.length;return t}get hasSelection(){return this.count>0}get sources(){return this._sources}set sources(t){Ha(t,this._sources)}syncSources(){const t=new Set,i=this.view?.map;if(!i)return;const r=s=>{DK(s)?(s.layers?.forEach(r),s.tables?.forEach(r)):NK(s)?(s.sublayers?.forEach(r),s.subtables?.forEach(r)):uA(s)?s.sublayers?.forEach(r):dl(s)&&t.add(s)};i.allLayers.forEach(r),i.allTables.forEach(r),this.sources=[...t]}async getSelectedFeatures(t,i={},r="layerView"){const{view:s,selections:n}=this;if(!s&&r==="layerView")return H.getLogger(this).warn("Cannot query layer views without a view."),[];const o=(t?.length?n.filter((a=>t.includes(a.layer))):n).map((async a=>{const{layer:l,selection:u}=a;if(!u.length)return;const c=id(l)?l.parent:l;if(c!=null){if(s&&r==="layerView"&&!TL(c)&&EL(c)){const d=await s.whenLayerView(c).catch((()=>null));if(d)return CL(d,u,i)}return CL(c,u,i)}})).filter(rr);return(await Promise.all(o)).filter(rr)}updateSelection(t){const i=new Map;for(const[n,o]of this._selectionMap)i.set(n,[...o.selection]);let r=!1;const s=t.current.concat(t.added);for(const n of s){const o=n.sourceLayer,a=n.getObjectId();if(this.sources.includes(o)&&(dl(o)||id(o))&&a!==null){const l=of(i,o,(()=>[]));l.includes(a)||(l.push(a),r=!0)}}for(const n of t.removed){const o=n.sourceLayer,a=n.getObjectId();if(this.sources.includes(o)&&(dl(o)||id(o))&&a!==null){const l=i.get(o),u=l?.indexOf(a);u!==void 0&&u>=0&&(l?.splice(u,1),r=!0)}}if(r){const{_selectionMap:n,_trashCan:o}=this,a=[];for(const[l,u]of i){const c=n.get(l);c!==void 0&&o.push(c),n.set(l,{selection:u}),a.push({layer:l,selection:u,...xI(c!==void 0?c.selection:[],u)})}this._onSelectionChange(a)}}setSelection(t,i){this._setSelection(t,i)}getSelection(t){return this._selectionMap.get(t)?.selection}appendToSelection(t,i){const r=this._selectionMap.get(t),s=r!==void 0?[...r.selection]:[];for(const n of i)s.includes(n)||s.push(n);this._setSelection(t,s)}removeFromSelection(t,i){const r=this._selectionMap.get(t);if(!r)return;const s=[];for(const n of r.selection)i.includes(n)||s.push(n);this._setSelection(t,s)}toggleInSelection(t,i){const r=this._selectionMap.get(t);if(!r||r.selection.length===0)return void this._setSelection(t,i);const s=new Set(r.selection),n=new Set(i),o=PW(s,n);this._setSelection(t,Array.from(o))}clear(){const t=this._selectionMap.values();this._trashCan.push(...t);const i=[];for(const[r,s]of this._selectionMap.entries())i.push({layer:r,added:[],removed:[...s.selection],selection:[]});this._selectionMap.clear(),this._onSelectionChange(i)}_onSelectionChange(t){this._refreshVisualization(),this.emit("selection-change",{view:this.view,changes:t})}_refreshVisualization(){for(this._vizTaskId++;this._trashCan.length>0;)this._trashCan.pop()?.highlightHandle?.remove();if(this.view==null)return;const{sources:t,view:i,_selectionMap:r,showHighlight:s}=this,n=this._vizTaskId;for(const o of t){const a=r.get(o),l=id(o)?o.parent:o;if(l!=null&&EL(l)){if(TL(l))continue;i.whenLayerView(l).then((u=>{a?.highlightHandle?.remove(),a!=null&&s&&n===this._vizTaskId&&"highlight"in u&&typeof u.highlight=="function"&&a.selection.length>0&&(a.highlightHandle=u.highlight(a.selection,this.highlightName))})).catch((()=>{a?.highlightHandle?.remove()}))}}}_refreshListeners(){this._layerEditHandles.drain(St);const t=new Set(this.sources.map((i=>id(i)?i.parent:i)));for(const i of t)dl(i)&&"on"in i&&i.on&&this._layerEditHandles.push(i.on("edits",(r=>this._onLayerEdit(r,i))))}_onLayerEdit(t,i){if(uA(i))this._onParentLayerEdit(t,i);else if(t.deletedFeatures.length&&this._selectionMap.has(i)){const r=[];t.deletedFeatures.forEach((({error:s,objectId:n})=>{n!=null&&s==null&&r.push(n)})),this.removeFromSelection(i,r)}}_onParentLayerEdit(t,i){const{deletedFeatures:r,edits:s,updatedFeatures:n}=t;if(s?.updateFeatures?.forEach((o=>{const a=o.getObjectId()??o.attributes[i.objectIdField];if(a==null||n.find((c=>c.objectId===a))?.error)return;const l=i.findSublayerForFeature(o);if(!dl(l))return;const u=i.sublayers.find((c=>!(!dl(c)||!this.getSelection(c)?.includes(a))));dl(u)&&u!==l&&(this.removeFromSelection(u,[a]),this.appendToSelection(l,[a]))})),r.length){const o=[];r.forEach((({error:a,objectId:l})=>{l!=null&&a==null&&o.push(l)})),i.sublayers.forEach((a=>{dl(a)&&this._selectionMap.has(a)&&this.removeFromSelection(a,o)}))}}_setSelection(t,i){if(!this.sources.includes(t))throw new Error(`Cannot set selection on layer ${t.title} because it is not in 'sources'`);const r=this._selectionMap.get(t);if(r===void 0||!Koe(r,{selection:i})){r!==void 0&&this._trashCan.push(r),this._selectionMap.set(t,{selection:[...i]});const s={layer:t,selection:[...i],...xI(r!==void 0?r.selection:[],i)};this._onSelectionChange([s])}}};h([f()],Ss.prototype,"_selectionMap",void 0),h([f()],Ss.prototype,"_sources",void 0),h([f({readOnly:!0,nonNullable:!0})],Ss.prototype,"selections",null),h([f({readOnly:!0,nonNullable:!0})],Ss.prototype,"count",null),h([f()],Ss.prototype,"view",void 0),h([f({readOnly:!0,nonNullable:!0})],Ss.prototype,"hasSelection",null),h([f()],Ss.prototype,"showHighlight",void 0),h([f()],Ss.prototype,"sources",null),h([f()],Ss.prototype,"highlightName",void 0),Ss=h([I("esri.views.SelectionManager")],Ss);const TL=e=>id(e)?e.parent?.isTable===!0:e.isTable,Xoe=e=>e.layer!==void 0,EL=e=>e?.when!==void 0,Koe=(e,t)=>{if(e==null&&t==null)return!0;if(e!=null&&t==null||e==null&&t!=null)return!1;if(e!=null&&t!=null&&e.selection!=null&&t.selection!=null){const i=[...e.selection],r=[...t.selection];if(i.length!==r.length)return!1;i.sort(),r.sort();for(let s=0;s<i.length;s++)if(i[s]!==r[s])return!1}return!0},CL=async(e,t,i={})=>{let r;if(Xoe(e)){const s=e;r=s===void 0?null:await s.queryFeatures(new ye({...i,objectIds:t})).then((n=>({data:n,layer:e.layer})))}else{const s=e;r=s===void 0?null:await s.queryFeatures(new ye({...i,objectIds:t})).then((n=>({data:n,layer:s})))}return r},Qoe=Ss;let zm=class extends xt.ClonableMixin(le){constructor(t){super(t),this.accentColor=new X([255,127,0]),this.textColor=new X([255,255,255])}};h([f({type:X,nonNullable:!0})],zm.prototype,"accentColor",void 0),h([f({type:X,nonNullable:!0})],zm.prototype,"textColor",void 0),zm=h([I("esri.views.Theme")],zm);const bM=zm;var PL;(function(e){e[e.Left=0]="Left",e[e.Middle=1]="Middle",e[e.Right=2]="Right"})(PL||(PL={}));const hV=["click","double-click","immediate-click","immediate-double-click","hold","drag","key-down","key-up","pointer-down","pointer-move","pointer-up","pointer-drag","mouse-wheel","pointer-enter","pointer-leave","gamepad","focus","blur"],dV={};function pV(e){return!!dV[e]}function eae(e){for(const t of e)if(!pV(t))return!1;return!0}hV.forEach((e=>{dV[e]=!0}));let fV=class{constructor(t){this._handlers=new Map,this._counter=0,this._handlerCounts=new Map,this.view=t,this.inputManager=null}connect(t){t&&this.disconnect(),this.inputManager=t,this._handlers.forEach((({handler:i,priority:r},s)=>this.inputManager?.installHandlers(s,[i],r)))}disconnect(){this.inputManager&&this._handlers.forEach(((t,i)=>this.inputManager?.uninstallHandlers(i))),this.inputManager=null}destroy(){this.disconnect(),this._handlers.clear(),this.view=null}on(t,i,r,s){const n=Array.isArray(t)?t:t.split(",");if(!eae(n))return n.some(pV)&&console.error("Error: registering input events and other events on the view at the same time is not supported."),null;let o,a;Array.isArray(i)?a=i:(o=i,a=[]),typeof r=="function"?o=r:s=r,s=s??Va.DEFAULT;const l=this._createUniqueGroupName(),u=new tae(this.view,n,a,o);this._handlers.set(l,{handler:u,priority:s});for(const c of n){const d=this._handlerCounts.get(c)||0;this._handlerCounts.set(c,d+1)}return this.inputManager&&this.inputManager.installHandlers(l,[u],s),ze((()=>this._removeHandler(l,n)))}hasHandler(t){return!!this._handlerCounts.get(t)}_removeHandler(t,i){if(this._handlers.has(t)){this._handlers.delete(t);for(const r of i){const s=this._handlerCounts.get(r);s===void 0||(s===1?this._handlerCounts.delete(r):this._handlerCounts.set(r,s-1))}}this.inputManager&&this.inputManager.uninstallHandlers(t)}_createUniqueGroupName(){return this._counter+=1,`viewEvents_${this._counter}`}},tae=class extends _i{constructor(t,i,r,s){super(!0),this._latestDragStart=void 0,this.view=t;for(const n of i)switch(n){case"click":this.registerIncoming("click",r,(o=>s(sae(t,o))));break;case"double-click":this.registerIncoming("double-click",r,(o=>s(nae(t,o))));break;case"immediate-click":this.registerIncoming("immediate-click",r,(o=>s(oae(t,o))));break;case"immediate-double-click":this.registerIncoming("immediate-double-click",r,(o=>s(aae(t,o))));break;case"hold":this.registerIncoming("hold",r,(o=>s(lae(t,o))));break;case"drag":this.registerIncoming("drag",r,(o=>{const a=this._wrapDrag(o);a&&s(a)}));break;case"key-down":this.registerIncoming("key-down",r,(o=>s(uae(o))));break;case"key-up":this.registerIncoming("key-up",r,(o=>s(cae(o))));break;case"pointer-down":this.registerIncoming("pointer-down",r,(o=>s(jf(o,"pointer-down"))));break;case"pointer-move":this.registerIncoming("pointer-move",r,(o=>s(jf(o,"pointer-move"))));break;case"pointer-up":this.registerIncoming("pointer-up",r,(o=>s(jf(o,"pointer-up"))));break;case"pointer-drag":this.registerIncoming("pointer-drag",r,(o=>s(hae(o))));break;case"mouse-wheel":this.registerIncoming("mouse-wheel",r,(o=>s(dae(o))));break;case"pointer-enter":this.registerIncoming("pointer-enter",r,(o=>s(jf(o,"pointer-enter"))));break;case"pointer-leave":this.registerIncoming("pointer-leave",r,(o=>s(jf(o,"pointer-leave"))));break;case"gamepad":this.registerIncoming("gamepad",r,(o=>{s(pae(o))}));break;case"focus":this.registerIncoming("focus",r,(o=>{s(iae(o))}));break;case"blur":this.registerIncoming("blur",r,(o=>{s(rae(o))}))}}_wrapDrag(t){const i=t.data,{x:r,y:s}=i.center,{action:n,pointerType:o,button:a}=i;if(n==="start"&&(this._latestDragStart=i),!this._latestDragStart)return;const l=i.pointer.native,u=i.buttons,{cancelable:c,timestamp:d}=t,m={x:this._latestDragStart.center.x,y:this._latestDragStart.center.y};return n==="end"&&(this._latestDragStart=void 0),{type:"drag",action:n,x:r,y:s,origin:m,pointerType:o,button:a,buttons:u,radius:i.radius,angle:_6(i.angle),native:l,timestamp:d,cancelable:c,stopPropagation:()=>t.stopPropagation(),defer:y=>t.defer(y),preventDefault:()=>t.preventDefault()}}};function iae(e){return{type:"focus",timestamp:e.timestamp,native:e.data.native,cancelable:e.cancelable,stopPropagation:()=>e.stopPropagation(),defer:t=>e.defer(t),preventDefault:()=>e.preventDefault()}}function rae(e){return{type:"blur",timestamp:e.timestamp,native:e.data.native,cancelable:e.cancelable,stopPropagation:()=>e.stopPropagation(),defer:t=>e.defer(t),preventDefault:()=>e.preventDefault()}}function sae(e,t){const{pointerType:i,button:r,buttons:s,x:n,y:o,native:a,eventId:l}=t.data,{cancelable:u,timestamp:c}=t;return{type:"click",pointerType:i,button:r,buttons:s,x:n,y:o,native:a,timestamp:c,screenPoint:ei(n,o),mapPoint:Jg(e,n,o),eventId:l,cancelable:u,stopPropagation:()=>t.stopPropagation(),defer:d=>t.defer(d),preventDefault:()=>t.preventDefault()}}function nae(e,t){const{pointerType:i,button:r,buttons:s,x:n,y:o,native:a,eventId:l}=t.data,{cancelable:u,timestamp:c}=t;return{type:"double-click",pointerType:i,button:r,buttons:s,x:n,y:o,native:a,timestamp:c,mapPoint:Jg(e,n,o),eventId:l,cancelable:u,stopPropagation:()=>t.stopPropagation(),defer:d=>t.defer(d),preventDefault:()=>t.preventDefault()}}function oae(e,t){const{pointerType:i,button:r,buttons:s,x:n,y:o,native:a,eventId:l}=t.data,u=a.pointerId,{cancelable:c,timestamp:d}=t;return{type:"immediate-click",pointerId:u,pointerType:i,button:r,buttons:s,x:n,y:o,native:a,timestamp:d,mapPoint:Jg(e,n,o),eventId:l,cancelable:c,stopPropagation:()=>t.stopPropagation(),defer:m=>t.defer(m),preventDefault:()=>t.preventDefault()}}function aae(e,t){const{pointerType:i,button:r,buttons:s,x:n,y:o,native:a,eventId:l}=t.data,u=a.pointerId,{cancelable:c,timestamp:d}=t;return{type:"immediate-double-click",pointerId:u,pointerType:i,button:r,buttons:s,x:n,y:o,native:a,timestamp:d,mapPoint:Jg(e,n,o),eventId:l,cancelable:c,stopPropagation:()=>t.stopPropagation(),defer:m=>t.defer(m),preventDefault:()=>t.preventDefault()}}function lae(e,t){const{pointerType:i,button:r,buttons:s,x:n,y:o,native:a}=t.data,{cancelable:l,timestamp:u}=t;return{type:"hold",pointerType:i,button:r,buttons:s,x:n,y:o,native:a,timestamp:u,mapPoint:Jg(e,n,o),cancelable:l,stopPropagation:()=>t.stopPropagation(),defer:c=>t.defer(c),preventDefault:()=>t.preventDefault()}}function Jg(e,t,i){return e.toMap(ei(t,i),{exclude:[]})}function uae(e){const{key:t,repeat:i,native:r}=e.data,{cancelable:s,timestamp:n}=e;return{type:"key-down",key:t,repeat:i,native:r,timestamp:n,cancelable:s,stopPropagation:()=>e.stopPropagation(),defer:o=>e.defer(o),preventDefault:()=>e.preventDefault()}}function cae(e){const{key:t,native:i}=e.data,{cancelable:r,timestamp:s}=e;return{type:"key-up",key:t,native:i,timestamp:s,cancelable:r,stopPropagation:()=>e.stopPropagation(),defer:n=>e.defer(n),preventDefault:()=>e.preventDefault()}}function jf(e,t){const{x:i,y:r,button:s,buttons:n,native:o,eventId:a}=e.data,l=o.pointerId,u=o.pointerType,{cancelable:c,timestamp:d}=e;return{type:t,x:i,y:r,pointerId:l,pointerType:u,button:s,buttons:n,native:o,timestamp:d,eventId:a,cancelable:c,stopPropagation:()=>e.stopPropagation(),defer:m=>e.defer(m),preventDefault:()=>e.preventDefault()}}function hae(e){const{x:t,y:i,buttons:r,native:s,eventId:n}=e.data.currentEvent,{button:o}=e.data.startEvent,a=e.data.startEvent.native.pointerId,l=e.data.startEvent.native.pointerType,u=e.data.action,c={x:e.data.startEvent.x,y:e.data.startEvent.y},{cancelable:d,timestamp:m}=e;return{type:"pointer-drag",x:t,y:i,pointerId:a,pointerType:l,button:o,buttons:r,action:u,origin:c,native:s,timestamp:m,eventId:n,cancelable:d,stopPropagation:()=>e.stopPropagation(),defer:y=>e.defer(y),preventDefault:()=>e.preventDefault()}}function dae(e){const{cancelable:t,data:i,timestamp:r}=e,{x:s,y:n,deltaY:o,native:a}=i;return{type:"mouse-wheel",x:s,y:n,deltaY:o,native:a,timestamp:r,cancelable:t,stopPropagation:()=>e.stopPropagation(),defer:l=>e.defer(l),preventDefault:()=>e.preventDefault()}}function pae(e){const{action:t,state:i,device:r}=e.data,{cancelable:s,timestamp:n}=e,{buttons:o,axes:a}=i;return{type:"gamepad",device:r,timestamp:n,action:t,buttons:o,axes:a,cancelable:s,stopPropagation:()=>e.stopPropagation(),defer:l=>e.defer(l),preventDefault:()=>e.preventDefault()}}var ig,IL,AL;(function(e){e[e.USER=0]="USER",e[e.MANAGER=1]="MANAGER"})(ig||(ig={})),(function(e){e[e.None=0]="None",e[e.Unfocused=1]="Unfocused",e[e.Focused=2]="Focused",e[e.Unselected=4]="Unselected",e[e.Selected=8]="Selected",e[e.All=15]="All"})(IL||(IL={})),(function(e){e[e.None=0]="None",e[e.Custom1=16]="Custom1",e[e.Custom2=32]="Custom2",e[e.Custom3=64]="Custom3",e[e.Custom4=128]="Custom4",e[e.Custom5=256]="Custom5",e[e.Custom6=512]="Custom6",e[e.Custom7=1024]="Custom7",e[e.Custom8=2048]="Custom8",e[e.Custom9=4096]="Custom9",e[e.Custom10=8192]="Custom10",e[e.Custom11=16384]="Custom11",e[e.Custom12=32768]="Custom12",e[e.All=65520]="All"})(AL||(AL={}));const fae="z",mae="r",mV={cancel:"Escape",complete:"Enter"},vIe={...mV,redo:mae,undo:fae,center:"Alt",constraint:"Shift",delete:["Backspace","Delete"],vertexAdd:"f",pan:" "},bIe={toggle:"Control"},wIe={enterInputMode:"Tab",commit:"Enter",discard:"Escape",next:"Tab"},SIe={moveUp:{key:"ArrowUp",modifier:"Shift",repeats:!0},moveDown:{key:"ArrowDown",modifier:"Shift",repeats:!0},moveLeft:{key:"ArrowLeft",modifier:"Shift",repeats:!0},moveRight:{key:"ArrowRight",modifier:"Shift",repeats:!0},scaleUp:{key:"+",modifier:"Shift"},scaleDown:{key:"-",modifier:"Shift"},factorModifier:{key:_8,continuePropagation:!0},toggleOpacity:"t",preserveAspectRatio:{key:"Shift",continuePropagation:!0},rotateIncrements:{key:"Shift",continuePropagation:!0}};let xIe=class{constructor(){this._bindings=new Map}add(t,i){return this.addToggle(t,(r=>{r.type==="key-down"&&i(r)}))}addToggle(t,i){const r=yae.fromDefinition(t,i),s=of(this._bindings,r.key,(()=>[]));return s.push(r),ze((()=>mE(s,r)))}register(t,i=Va.WIDGET){return gh([t.on("key-down",(r=>this.dispatch(t.inputManager,r)),i),t.on("key-up",(r=>this.dispatch(t.inputManager,r)),i)])}dispatch(t,i){const r=i.key,s=this._bindings.get(r);if(s)for(const n of s)n.process(t,i)}},yae=class wM{constructor(t,i,r,s,n){this.key=t,this.modifiers=i,this.repeats=r,this.continuePropagation=s,this.callback=n}process(t,i){if(!(i.key!==this.key||"repeat"in i&&i.repeat&&!this.repeats)){for(const r of this.modifiers)if(!t.isModifierKeyDown(r))return;this.continuePropagation||i.stopPropagation(),this.callback(i)}}static fromDefinition(t,i){if(typeof t=="string")return new wM(t,[],!1,!1,i);const{key:r,modifier:s,repeats:n,continuePropagation:o}=t;return new wM(r,s?Array.isArray(s)?s:[s]:[],!!n,!!o,i)}};function gae(e){return[e.on("before-add",(t=>{const i=t.item;if(i==null||e.includes(i))return H.getLogger("esri.views.interactive.interactiveToolUtils").warn("Tool is either already in the list of tools or tool is `null`. Not adding tool."),void t.preventDefault();i.onAdd()})),e.on("after-remove",(t=>{const i=t.item;i.active&&(i.view.activeTool=null),i.destroy()}))]}function SM(e){return e.visible&&e.getEditableFlag!=null&&e.getEditableFlag(ig.USER)&&e.getEditableFlag(ig.MANAGER)}function _ae(e){return e.type==="key-down"&&e.key===mV.cancel}function Wn(e){return ei(e.x,e.y)}function yV(e,t){const i=(e instanceof HTMLElement?e:e.surface)?.getBoundingClientRect();return i?ei(t.clientX-i.left,t.clientY-i.top):ei(0,0)}function gV(e,t){return t instanceof Event?yV(e,t):Wn(t)}function _V(e){if(e instanceof Event)return!0;if(typeof e=="object"&&"type"in e)switch(e.type){case"click":case"double-click":case"pointer-down":case"pointer-drag":case"pointer-enter":case"pointer-leave":case"pointer-up":case"pointer-move":case"immediate-click":case"immediate-double-click":case"hold":case"drag":case"mouse-wheel":return!0;default:return!1}return!1}let vae=class{constructor(){this._pointerLocations=new Map,this._hoveredManipulators=new Map,this._grabbedManipulators=new Map,this._draggedManipulators=new Map,this._stopDrag=!1,this._externallyDragging=!1,this._revertToNullActiveTool=!1,this._cursor=null}get cursor(){return this._cursor}hasFocusedManipulators(){return this._grabbedManipulators.size>0||this._draggedManipulators.size>0}handleInputEvent(t,i){const r=()=>t.stopPropagation();switch(t.type){case"pointer-move":kL(t.pointerType)&&this._pointerLocations.set(t.pointerId,{x:t.x,y:t.y,pointerType:t.pointerType});break;case"drag":this._grabbedManipulators.size>0?this._stopDrag=!0:t.action==="start"?this._externallyDragging=!0:t.action==="end"&&(this._externallyDragging=!1),this._stopDrag&&(r(),t.action==="end"&&(this._stopDrag=!1));break;case"pointer-down":{if(!RL(t))break;const s=Wn(t),n=zh(s,t.pointerType,i.forEachTool);if(n==null)break;const o=n.manipulator,a=n.tool;o==null||a==null||!o.interactive||o.grabbable&&o.grabbableForEvent(t)||!o.grabbing||o.dragging||this._releaseManipulatorBeforeDragging(o,t,i),o!=null&&a!=null&&o.interactive&&o.grabbable&&o.grabbableForEvent(t)&&!o.grabbing&&(this._grabbedManipulators.set(t.pointerId,{manipulator:o,tool:a,start:s,pointerType:t.pointerType}),this._grabbedManipulators.size===1&&i.activeTool==null&&(this._revertToNullActiveTool=!0,i.setActiveTool(n.tool)),o.grabbing=!0,o.events.emit("grab-changed",{action:"start",pointerType:t.pointerType,screenPoint:s}),r());break}case"pointer-up":this._draggedManipulators.has(t.pointerId)||this._handlePointerEnd(t,i);break;case"pointer-drag":{if(!RL(t))break;const s=this._grabbedManipulators.get(t.pointerId),n=s?.manipulator,o=s?.tool;if(n==null||o==null)break;const a=Wn(t);a.x=lr(a.x,0,i.view.width),a.y=lr(a.y,0,i.view.height);const l=s.start,u=this._draggedManipulators.get(t.pointerId);switch(t.action){case"start":case"update":t.action!=="update"&&this._grabbedManipulators.size!==1||(n.dragging=!0,u?n.events.emit("drag",{action:"update",start:l,screenPoint:a}):n.events.emit("drag",{action:"start",start:l,screenPoint:a,pointerType:t.pointerType}),this._draggedManipulators.set(t.pointerId,{tool:o,manipulator:n,start:l}));break;case"end":n.dragging=!1,u&&n.events.emit("drag",{action:"end",start:l,screenPoint:a}),this._draggedManipulators.delete(t.pointerId),this._handlePointerEnd(t,i)}r();break}case"immediate-click":{const s=Wn(t),n=zh(s,t.pointerType,i.forEachTool);if(bae(t)||i.forEachTool((u=>{if((n==null||n.tool!==u||u.automaticManipulatorSelection)&&u.manipulators){let c=!1;u.manipulators.forEach((({manipulator:d})=>{d.selected&&(d.selected=!1,c=!0)})),c&&u.onManipulatorSelectionChanged&&u.onManipulatorSelectionChanged()}})),n==null)break;const{manipulator:o,tool:a}=n;if(!o.interactive)break;o.selectable&&a.automaticManipulatorSelection&&(o.selected=!o.selected,a.onManipulatorSelectionChanged&&a.onManipulatorSelectionChanged());const l=t.native.shiftKey;o.events.emit("immediate-click",{screenPoint:s,button:t.button,pointerType:t.pointerType,shiftKey:l,stopPropagation:r}),L2(o,r);break}case"click":{const s=Wn(t),n=zh(s,t.pointerType,i.forEachTool),o=n?.manipulator;if(o==null||!o.interactive)break;const a=t.native.shiftKey;o.events.emit(t.type,{screenPoint:s,button:t.button,pointerType:t.pointerType,shiftKey:a}),r();break}case"double-click":{const s=Wn(t),n=zh(s,t.pointerType,i.forEachTool),o=n!=null?n.manipulator:null;if(o==null||!o.interactive)break;const a=t.native.shiftKey;o.events.emit("double-click",{screenPoint:s,button:t.button,pointerType:t.pointerType,shiftKey:a,stopPropagation:r}),L2(o,r);break}case"immediate-double-click":{const s=Wn(t),n=zh(s,t.pointerType,i.forEachTool),o=n!=null?n.manipulator:null;if(o==null||!o.interactive)break;const a=t.native.shiftKey;o.events.emit("immediate-double-click",{screenPoint:s,button:t.button,pointerType:t.pointerType,shiftKey:a,stopPropagation:r}),t.pointerType==="mouse"&&L2(o,r);break}}this._onFocusChange(i.forEachTool)}_releaseManipulatorBeforeDragging(t,i,r){t.grabbing=!1,t.events.emit("grab-changed",{action:"end",pointerType:i.pointerType,screenPoint:Wn(i)}),this._grabbedManipulators.forEach((({manipulator:s},n)=>{s===t&&this._grabbedManipulators.delete(n)})),this._afterManipulatorRelease(r.setActiveTool)}_handlePointerEnd(t,i){const r=this._grabbedManipulators.get(t.pointerId)?.manipulator;r!=null&&r.grabbing&&(r.grabbing=!1,r.events.emit("grab-changed",{action:"end",pointerType:t.pointerType,screenPoint:Wn(t)}),this._grabbedManipulators.delete(t.pointerId),this._afterManipulatorRelease(i.setActiveTool))}_onFocusChange(t){this._updateCursor(),this._updateFocusedManipulatorTools(t)}_updateCursor(){this._grabbedManipulators.size>0?this._cursor=LL(this._grabbedManipulators)||"grabbing":this._hoveredManipulators.size>0?this._cursor=LL(this._hoveredManipulators)||"pointer":this._cursor=null}_updateFocusedManipulatorTools(t){const i=new Set,r=new Set;this._grabbedManipulators.forEach((({tool:s})=>{i.add(s)})),this._hoveredManipulators.forEach((({tool:s})=>{r.add(s)})),t((s=>{s.hasGrabbedManipulators=i.has(s),s.hasHoveredManipulators=r.has(s);const n=this._grabbedManipulators.values(),o=ZH(n,(({tool:a})=>a===s));s.firstGrabbedManipulator=o!=null?o.manipulator:null}))}clearPointers(t,{forEachTool:i,setActiveTool:r},s=!0,n){const o=(a,l)=>a===t&&(n==null||n===l);this._grabbedManipulators.forEach((({tool:a,manipulator:l,pointerType:u},c)=>{o(a,l)&&(this._grabbedManipulators.delete(c),l.grabbing=!1,l.events.emit("grab-changed",{action:"end",screenPoint:null,pointerType:u}))})),this._draggedManipulators.forEach((({tool:a,manipulator:l},u)=>{o(a,l)&&(this._draggedManipulators.delete(u),l.dragging=!1,l.events.emit("drag",{action:"cancel"}))})),s&&this._hoveredManipulators.forEach((({tool:a,manipulator:l},u)=>{o(a,l)&&(this._hoveredManipulators.delete(u),l.hovering=!1)})),this._afterManipulatorRelease(r),this._onFocusChange(i)}updateHoveredStateFromKnownPointers(t){this._pointerLocations.forEach(((i,r)=>{this._updateHoveredStateForPointerAtScreenPosition(ei(i.x,i.y),r,i.pointerType,t)}))}handleHoverEvent(t,i){const r=t.type;r!=="pointer-up"&&r!=="immediate-click"&&r!=="pointer-move"||!kL(t.pointerType)||(r!=="pointer-up"&&this._externallyDragging?this._clearHoveredManipulatorStates(t.pointerId):this._updateHoveredStateForPointerAtScreenPosition(Wn(t),t.pointerId,t.pointerType,i))}_updateHoveredStateForPointerAtScreenPosition(t,i,r,s){let n=zh(t,r,s);const o=this._hoveredManipulators.get(i)?.manipulator;n==null||n.manipulator.interactive||(n=null),n!=null&&o===n.manipulator||(o!=null&&(o.hovering=!1),n!=null?(n.manipulator.hovering=!0,this._hoveredManipulators.set(i,n)):this._hoveredManipulators.delete(i),this._onFocusChange(s))}_afterManipulatorRelease(t){this._grabbedManipulators.size===0&&this._revertToNullActiveTool&&(t(null),this._revertToNullActiveTool=!1)}_clearHoveredManipulatorStates(t){this._hoveredManipulators.forEach((({manipulator:i},r)=>{t===r&&(this._hoveredManipulators.delete(t),i.hovering=!1)}))}};function LL(e){for(const{manipulator:t}of e.values())if(t!=null&&t.interactive){if(t.grabbing&&t.grabCursor)return t.grabCursor;if(t.cursor)return t.cursor}return null}function zh(e,t,i){let r=null;return i((s=>{if(s.manipulators==null||!SM(s))return!1;const n=s.manipulators.intersect(e,t);return n!=null&&(r={tool:s,manipulator:n},!0)})),r}function kL(e){return e==="mouse"}function RL(e){return e.pointerType!=="mouse"||e.button===0}function bae(e){return!!e.native.shiftKey}function L2(e,t){e?.consumesClicks&&t()}const OL="attached",k2="tools",wae=1e3;let Zn=class extends le{constructor(t){super(t),this._updatingHandles=new Bc,this._clock=af,this._manipulatorState=new vae,this.tools=new ne,this.cursor=null,this._interacting=!1,this._interactingTimeout=wae,this._interactingTimeoutHandle=null,this._forEachTool=i=>{for(const r of this.tools.items)if(i(r))return}}initialize(){this.addHandles([this.view.on(hV,(t=>{this._handleInputEvent(t)}),Va.TOOL),...gae(this.tools),this.tools.on("before-add",(({item:t})=>{this._updateToolEditableFlag(t)})),this.tools.on("before-remove",(({item:t})=>{this._manipulatorState.clearPointers(t,this._manipulatorStateEventArgs),this._updateCursor()})),this.tools.on("change",(()=>{this._refreshToolWatchers()}))])}destroy(){this.activeTool=null,this.tools.drain((t=>t.destroy())),this._clearInteractingTimeout(),this._interacting=!1,this._updatingHandles.destroy()}get _manipulatorStateEventArgs(){return{forEachTool:this._forEachTool,activeTool:this.activeTool,setActiveTool:t=>{this.activeTool=t},view:this.view}}set activeTool(t){if(t!=null&&!this.view.ready)return void H.getLogger(this).error("Cannot set active tool while view is not ready.");if(t===this.activeTool)return;const i=this.activeTool;this._set("activeTool",t),i?.deactivate(),t?.activate(),this._removeIncompleteTools(t);for(const r of this.tools){this._updateToolEditableFlag(r);const s=SM(r);this.activeTool!=null&&s||this._manipulatorState.clearPointers(r,this._manipulatorStateEventArgs,!s)}this._updateCursor()}get updating(){return this._updatingHandles.updating||this.tools.some((t=>t.updating))}get interacting(){return this._interacting}_clearInteractingTimeout(){this._interactingTimeoutHandle=St(this._interactingTimeoutHandle)}_startInteractingTimeout(){this._clearInteractingTimeout(),this._interactingTimeoutHandle=this._clock.setTimeout((()=>this._interacting=!1),this._interactingTimeout)}attach(){this.view.type==="3d"?this.addHandles([te((()=>{const{state:t}=this.view;return"camera"in t&&t.camera}),(()=>this._forEachManipulator((t=>t.onViewChange())))),this.view.elevationProvider?.on("elevation-change",(t=>this._forEachManipulator((i=>i.onElevationChange(t)))))],OL):this.addHandles(te((()=>this.view.extent),(()=>this._forEachManipulator((t=>t.onViewChange())))))}detach(){this.activeTool=null,this.tools.removeAll(),this.removeHandles(OL),this._clearInteractingTimeout(),this._interacting=!1}_forEachManipulator(t){this._forEachTool((i=>{i.manipulators&&i.manipulators.forEach((({manipulator:r})=>t(r,i)))}))}_handleInputEvent(t){let i=!1;const r={...t,stopPropagation:()=>{i=!0,t.stopPropagation()}};this.activeTool!=null?this.activeTool.handleInputEvent&&this.activeTool.handleInputEvent(r):this._forEachTool((s=>{!i&&s.visible&&s.handleInputEvent(r)})),!i&&_ae(t)&&this.activeTool&&(t.stopPropagation(),t.preventDefault(),this.activeTool.cancel(),this.activeTool=null),this._manipulatorState.handleInputEvent(r,this._manipulatorStateEventArgs),i||this.activeTool==null||this.activeTool.handleInputEventAfter(r),this._manipulatorState.handleHoverEvent(r,this._forEachTool),this._updateCursor(),t.type==="pointer-move"&&(this._manipulatorState.hasFocusedManipulators()||this.activeTool)&&(this._interacting=!0,this._startInteractingTimeout())}_refreshToolWatchers(){this.removeHandles(k2),this._forEachTool((t=>{if(t instanceof le){const i=te((()=>[t.cursor,t.visible,t.editable]),(()=>{SM(t)||this._manipulatorState.clearPointers(t,this._manipulatorStateEventArgs),this._updateCursor()}));this.addHandles(i,k2)}t.manipulators&&this.addHandles([t.manipulators.on("after-remove",(i=>{this._manipulatorState.clearPointers(t,this._manipulatorStateEventArgs,!0,i.item.manipulator)})),t.manipulators.on("change",(()=>{this._manipulatorState.updateHoveredStateFromKnownPointers(this._forEachTool),this._updateCursor()}))],k2)})),this._manipulatorState.updateHoveredStateFromKnownPointers(this._forEachTool),this._updateCursor()}_updateToolEditableFlag(t){t.setEditableFlag?.(ig.MANAGER,this.activeTool==null||t===this.activeTool)}_updateCursor(){let t=this._manipulatorState.cursor;t==null&&this._forEachTool((i=>!(i.cursor==null||!i.visible)&&(t=i.cursor,!0))),this._get("cursor")!==t&&this._set("cursor",t)}_removeIncompleteTools(t){this.tools.filter((i=>(t==null||i!==t)&&!i.created&&i.removeIncompleteOnCancel)).forEach((i=>{this.tools.remove(i)}))}get test(){}};h([f({constructOnly:!0,nonNullable:!0})],Zn.prototype,"view",void 0),h([f({value:null})],Zn.prototype,"activeTool",null),h([f({readOnly:!0,type:ne})],Zn.prototype,"tools",void 0),h([f({readOnly:!0})],Zn.prototype,"cursor",void 0),h([f({readOnly:!0})],Zn.prototype,"updating",null),h([f()],Zn.prototype,"_interacting",void 0),h([f({readOnly:!0})],Zn.prototype,"interacting",null),Zn=h([I("esri.views.ToolViewManager")],Zn);const Sae=new X("cyan"),xae=1,$ae=.25,Mae=new X("black"),Tae=.4,Eae=.2,EIe=.25,vV="default",Cae="temporary",Pae=new X("yellow");var xM;let ts=xM=class extends le{constructor(e){super(e),this.name=vV,this.color=Sae.clone(),this.haloColor=null,this.haloOpacity=xae,this.fillOpacity=$ae,this.shadowColor=Mae.clone(),this.shadowOpacity=Tae,this.shadowDifference=Eae,this.haloWidth=2.1,this.haloBlur=.8/this.haloWidth}equals(e){return this.color.equals(e.color)&&(this.haloColor||this.color).equals(e.haloColor||e.color)&&this.haloOpacity===e.haloOpacity&&this.fillOpacity===e.fillOpacity&&this.haloWidth===e.haloWidth&&this.haloBlur===e.haloBlur&&this.shadowColor.equals(e.shadowColor)&&this.shadowOpacity===e.shadowOpacity&&this.shadowDifference===e.shadowDifference}clone(){return new xM({...this,color:this.color.clone(),haloColor:this.haloColor?.clone(),shadowColor:this.shadowColor?.clone()})}assignFrom(e){this.color=e.color.clone(),this.haloColor=e.haloColor?.clone(),this.haloOpacity=e.haloOpacity,this.fillOpacity=e.fillOpacity,this.shadowColor=e.shadowColor.clone(),this.shadowDifference=e.shadowDifference,this.shadowOpacity=e.shadowOpacity,this.haloBlur=e.haloBlur,this.haloWidth=e.haloWidth}};h([f({type:String,constructOnly:!0,nonNullable:!0})],ts.prototype,"name",void 0),h([f({type:X,nonNullable:!0})],ts.prototype,"color",void 0),h([f({type:X})],ts.prototype,"haloColor",void 0),h([f({nonNullable:!0})],ts.prototype,"haloOpacity",void 0),h([f({nonNullable:!0})],ts.prototype,"fillOpacity",void 0),h([f({type:X,nonNullable:!0})],ts.prototype,"shadowColor",void 0),h([f({nonNullable:!0})],ts.prototype,"shadowOpacity",void 0),h([f({nonNullable:!0})],ts.prototype,"shadowDifference",void 0),h([f({nonNullable:!0})],ts.prototype,"haloWidth",void 0),h([f({nonNullable:!0})],ts.prototype,"haloBlur",void 0),ts=xM=h([I("esri.views.support.HighlightOptions")],ts);const ou=ts;function Iae(){return new(ne.ofType(ou))([new ou({name:vV}),new ou({name:Cae,color:Pae})])}let ud=class extends le{constructor(t){super(),this.nativeIndex=null,this._detectedDeviceType="unknown",t.mapping==="standard"?this._detectedDeviceType="standard":Aae.test(t.id)?this._detectedDeviceType="spacemouse":this._detectedDeviceType="unknown",this.nativeIndex=t.index}get native(){const t=navigator.getGamepads?navigator.getGamepads():[];return this.nativeIndex!=null&&this.nativeIndex<t.length?t[this.nativeIndex]:null}get deviceType(){return this._detectedDeviceType}get axisThreshold(){return Lae[this.deviceType]}};h([f({nonNullable:!0,readOnly:!0})],ud.prototype,"nativeIndex",void 0),h([f({type:String,readOnly:!0})],ud.prototype,"deviceType",null),h([f({type:Number,readOnly:!0})],ud.prototype,"axisThreshold",null),ud=h([I("esri.views.input.gamepad.GamepadInputDevice")],ud);const KC=ud,Aae=new RegExp("^(3dconnexion|space(mouse|navigator|pilot|explorer))","i"),Lae={standard:.15,spacemouse:.025,unknown:0};let Vm=class extends le{constructor(...t){super(...t),this.devices=new ne,this.enabledFocusMode="document"}};h([f({type:ne.ofType(KC),readOnly:!0})],Vm.prototype,"devices",void 0),h([f({type:["document","view","none"]})],Vm.prototype,"enabledFocusMode",void 0),Vm=h([I("esri.views.input.gamepad.GamepadSettings")],Vm);const kae=Vm;let h1=class extends le{constructor(){super(...arguments),this.gamepad=new kae}};h([f({readOnly:!0})],h1.prototype,"gamepad",void 0),h1=h([I("esri.views.input.Input")],h1);const Rae=h1,bV=()=>Fe.respectPrefersReducedMotion&&window.matchMedia("(prefers-reduced-motion: reduce)").matches,R2=()=>f({type:["pan","rotate","zoom","none"],nonNullable:!0});let ec=class extends le{constructor(t){super(t),this.dragPrimary="pan",this.dragSecondary="rotate",this.dragTertiary="zoom",this.mouseWheel="zoom"}};h([R2()],ec.prototype,"dragPrimary",void 0),h([R2()],ec.prototype,"dragSecondary",void 0),h([R2()],ec.prototype,"dragTertiary",void 0),h([f({type:["zoom","none"],nonNullable:!0})],ec.prototype,"mouseWheel",void 0),ec=h([I("esri.views.navigation.NavigationActionMap")],ec);const QC=ec;let Ml=class extends le{constructor(t){super(t),this.enabled=!0,this.device=null,this.mode="pan",this.tiltDirection="forward-down",this.velocityFactor=1}};h([f({type:Boolean,nonNullable:!0})],Ml.prototype,"enabled",void 0),h([f({type:KC})],Ml.prototype,"device",void 0),h([f({type:["pan","zoom"],nonNullable:!0})],Ml.prototype,"mode",void 0),h([f({type:["forward-down","forward-up"],nonNullable:!0})],Ml.prototype,"tiltDirection",void 0),h([f({type:Number,nonNullable:!0})],Ml.prototype,"velocityFactor",void 0),Ml=h([I("esri.views.navigation.gamepad.GamepadSettings")],Ml);const wV=Ml;let Tl=class extends le{constructor(t){super(t),this.actionMap=new QC,this.browserTouchPanEnabled=!0,this.gamepad=new wV,this.momentumEnabled=!0}get effectiveMomentumEnabled(){return this.momentumEnabled&&!bV()}get mouseWheelZoomEnabled(){return this.actionMap.mouseWheel==="zoom"}set mouseWheelZoomEnabled(t){ID(H.getLogger(this),"mouseWheelZoomEnabled",{replacement:"actionMap.mouseWheel",version:"4.32",warnOnce:!0}),this.actionMap.mouseWheel=t?"zoom":"none"}};h([f({type:QC,nonNullable:!0})],Tl.prototype,"actionMap",void 0),h([f({type:Boolean})],Tl.prototype,"browserTouchPanEnabled",void 0),h([f({type:wV,nonNullable:!0})],Tl.prototype,"gamepad",void 0),h([f({type:Boolean})],Tl.prototype,"momentumEnabled",void 0),h([f({type:Boolean})],Tl.prototype,"mouseWheelZoomEnabled",null),Tl=h([I("esri.views.navigation.Navigation")],Tl);const hw=Tl;function RIe(e,t,i){const r=SV(e),s=t,n=Oae(r,s,i);if(r){const o=Nr.deriveUnitFromSR(r,e.spatialReference).heightUnit;if(!i&&o!==r.heightUnit){const a=new j("layerview:unmatched-height-unit",`The vertical units of the layer must match the horizontal units (${o})`,{horizontalUnit:o});return new j("layerview:unsupported-height-model-info","The vertical coordinate system of the layer is not supported",{heightModelInfo:r,error:a})}}if(!Nae(e)||n===zr.Unsupported)return new j("layerview:unsupported-height-model-info","The vertical coordinate system of the layer is not supported",{heightModelInfo:r});switch(n){case zr.Units:{const o=r?.heightUnit||"unknown",a=s?.heightUnit||"unknown",l=new j("layerview:incompatible-height-unit",`The vertical units of the layer (${o}) must match the vertical units of the scene (${a})`,{layerUnit:o,sceneUnit:a});return new j("layerview:incompatible-height-model-info","The vertical coordinate system of the layer is incompatible with the scene",{layerHeightModelInfo:r,sceneHeightModelInfo:s,error:l})}case zr.HeightModel:{const o=r?.heightModel||"unknown",a=s?.heightModel||"unknown",l=new j("layerview:incompatible-height-model",`The height model of the layer (${o}) must match the height model of the scene (${a})`,{layerHeightModel:o,sceneHeightModel:a});return new j("layerview:incompatible-height-model-info","The vertical coordinate system of the layer is incompatible with the scene",{layerHeightModelInfo:r,sceneHeightModelInfo:s,error:l})}case zr.CRS:{const o=r?.vertCRS||"unknown",a=s?.vertCRS||"unknown",l=new j("layerview:incompatible-vertical-datum",`The vertical datum of the layer (${o}) must match the vertical datum of the scene (${a})`,{layerDatum:o,sceneDatum:a});return new j("layerview:incompatible-height-model-info","The vertical coordinate system of the layer is incompatible with the scene",{layerHeightModelInfo:r,sceneHeightModelInfo:s,error:l})}}return null}function Oae(e,t,i){if(!NL(e)||!NL(t))return zr.Unsupported;if(e==null||t==null)return zr.Ok;if(!i&&e.heightUnit!==t.heightUnit)return zr.Units;if(e.heightModel!==t.heightModel)return zr.HeightModel;switch(e.heightModel){case"gravity-related-height":return zr.Ok;case"ellipsoidal":return e.vertCRS===t.vertCRS?zr.Ok:zr.CRS;default:return zr.Unsupported}}var zr;function NL(e){return e==null||e.heightModel!=null&&e.heightUnit!=null}function Nae(e){return"heightModelInfo"in e&&e.heightModelInfo!=null||e.spatialReference!=null||!MV(e)}function SV(e){if(e.type==="integrated-mesh-3dtiles")return null;const t=e.url?Cg(e.url):void 0;return!(e.spatialReference?.vcsWkid==null&&t!=null&&t.serverType==="ImageServer")&&xV(e)&&e.heightModelInfo?e.heightModelInfo:MV(e)?Nr.deriveUnitFromSR(Fae,e.spatialReference):null}function xV(e){return"heightModelInfo"in e}function $V(e){if(e.type==="unknown"||!("capabilities"in e))return!1;switch(e.type){case"catalog":case"catalog-footprint":case"csv":case"feature":case"geojson":case"subtype-group":case"ogc-feature":case"oriented-imagery":case"wfs":case"knowledge-graph-sublayer":return!0;default:return!1}}function MV(e){return $V(e)?!!(e.capabilities&&e.capabilities.data&&e.capabilities.data.supportsZ):TV(e)}function Dae(e){return e.layers!=null||TV(e)||$V(e)||xV(e)}function TV(e){switch(e.type){case"building-scene":case"elevation":case"integrated-mesh":case"integrated-mesh-3dtiles":case"point-cloud":case"scene":case"voxel":return!0;case"base-dynamic":case"base-elevation":case"base-tile":case"bing-maps":case"catalog":case"catalog-footprint":case"catalog-dynamic-group":case"csv":case"dimension":case"geojson":case"feature":case"subtype-group":case"geo-rss":case"graphics":case"group":case"imagery":case"imagery-tile":case"kml":case"knowledge-graph":case"link-chart":case"knowledge-graph-sublayer":case"line-of-sight":case"map-image":case"map-notes":case"media":case"ogc-feature":case"open-street-map":case"oriented-imagery":case"parquet":case"route":case"stream":case"tile":case"unknown":case"unsupported":case"vector-tile":case"video":case"viewshed":case"wcs":case"web-tile":case"wfs":case"wms":case"wmts":case null:return!1}return!1}(function(e){e[e.Ok=0]="Ok",e[e.Units=1]="Units",e[e.HeightModel=2]="HeightModel",e[e.CRS=3]="CRS",e[e.Unsupported=4]="Unsupported"})(zr||(zr={}));const Fae=new Nr({heightModel:"gravity-related-height"});var Av;(function(e){e[e.Global=1]="Global",e[e.Local=2]="Local"})(Av||(Av={}));let $M,O2=null;async function zae(e){O2||(O2=J(()=>import("./geometryServiceUtils-DQplkJw6.js"),__vite__mapDeps([210,211])).then((t=>$M=t))),await O2,It(e)}async function EV(e,t,i,r){if(!e)return null;const s=e.spatialReference;return Xa()||qs(s,t)?xh(e,t):$M?$M.projectGeometry(e,t,i,r):(await Promise.race([zae(r),Wa(r)]),EV(e,t,i,r))}async function OIe(e,t){try{return e?.spatialReference?await lz(e,t):null}catch{return null}}let lt=class extends le{constructor(t){super(t),this.required={extent:!1,heightModelInfo:!1,tileInfo:!1},this.defaultSpatialReference=null,this.userSpatialReference=null,this.sourcePreloadCount=10,this.priorityCollection=null,this.requiresExtentInSpatialReference=!0,this.suspended=!1,this._projectExtentTask={task:null,input:null,output:null,spatialReference:null}}destroy(){this._projectExtentTask.task&&(this._projectExtentTask.task=Lp(this._projectExtentTask.task)),this._set("map",null)}get ready(){return!this._spatialReferenceTask.updating&&!this._tileInfoTask.updating&&!this._extentTask.updating}get heightModelInfoReady(){return!this._heightModelInfoTask.updating}get spatialReference(){return this.userSpatialReference??this._spatialReferenceTask.spatialReference}get extent(){return this._extentTask.extent}get heightModelInfo(){return this._heightModelInfoTask.heightModelInfo}get vcsWkid(){return this._heightModelInfoTask.vcsWkid}get latestVcsWkid(){return this._heightModelInfoTask.latestVcsWkid}get viewingMode(){return this.userSpatialReference==null||this.userSpatialReference.equals(this._spatialReferenceTask.spatialReference)?this._spatialReferenceTask.viewingMode:null}get tileInfo(){return this._tileInfoTask.tileInfo}get mapCollections(){const t=this.map?.(),i=[];return this.priorityCollection!=null&&i.push(this.priorityCollection),i.push({parent:t?.basemap,layers:t?.basemap?.baseLayers},{layers:t?.layers},{parent:t?.ground,layers:t?.ground?.layers},{parent:t?.basemap,layers:t?.basemap?.referenceLayers}),i}get _spatialReferenceTask(){if(this.suspended)return this._get("_spatialReferenceTask")??{updating:!1};let t;if(this._collectLayers(this.mapCollections,(r=>{const s=this._getSupportedSpatialReferences(r);if(s.length>0){const n=this._narrowDownSpatialReferenceCandidates(t,s);n!=null&&(t=n)}return t?.length===1}))&&t?.length!==1)return{updating:!0};const i=this._pickSpatialReferenceCandidate(t);return{spatialReference:i?.spatialReference??null,viewingMode:i?.viewingMode??null,updating:!1}}get _tileInfoTask(){if(!this.required.tileInfo)return this._get("_tileInfoTask")??{updating:!1};const t=this.map?.(),i=this.spatialReference;if(!i)return{updating:this._spatialReferenceTask.updating};let r;const s=this._collectLayers([{parent:t?.basemap,layers:t?.basemap?.baseLayers},{layers:t?.layers}],(n=>!(!("tileInfo"in n)||!n.tileInfo?.spatialReference.equals(i))&&(r=n,!0)),(n=>"tileInfo"in n));return r?{tileInfo:r.tileInfo,updating:!1}:{updating:s}}get _heightModelInfoTask(){if(!this.required.heightModelInfo||this.suspended&&this._get("_heightModelInfoTask")?.heightModelInfo)return this._get("_heightModelInfoTask")??{updating:!1};let t={};const i=this._collectLayers(this.mapCollections,(r=>{const s=SV(r);return!!s&&(t={heightModelInfo:s,vcsWkid:r.spatialReference?.vcsWkid,latestVcsWkid:r.spatialReference?.latestVcsWkid},!0)}),(r=>Dae(r)));return{...t,updating:i}}get _extentCandidatesTask(){if(this.suspended||!this.required.extent)return this._get("_extentCandidatesTask")??{updating:!1};if(!this.spatialReference)return{updating:this._spatialReferenceTask.updating};const t=[],i=this._collectLayers(this.mapCollections,(r=>{const s="fullExtents"in r&&r.fullExtents||(r.fullExtent!=null?[r.fullExtent]:[]),n=this.requiresExtentInSpatialReference?null:s[0],o=s.find((a=>a.spatialReference.equals(this.spatialReference)))??n;if(o)return t.push({extent:o,layer:r}),!0;if(this._getSupportedSpatialReferences(r).length>0)for(const a of s)t.push({extent:a,layer:r});return!1}));return{candidates:t,updating:i}}get _extentTask(){const{candidates:t,updating:i}=this._extentCandidatesTask;if(i)return{updating:i};if(t==null||t.length===0)return{updating:!1};if(!this.spatialReference)return{updating:this._spatialReferenceTask.updating};const r=this._pickExtentCandidate(t),s=this.spatialReference;return r.extent.equals(this._projectExtentTask.input)&&s.equals(this._projectExtentTask.spatialReference)?{extent:this._projectExtentTask.output,updating:this._projectExtentTask.task!=null&&!this._projectExtentTask.task.finished}:(this._projectExtentTask.task!=null&&(this._projectExtentTask.task=Lp(this._projectExtentTask.task)),this._projectExtentTask={input:r.extent.clone(),output:null,spatialReference:s.clone(),task:XE((async n=>{try{const o=await EV(r.extent,s,"portalItem"in r.layer?r.layer.portalItem:void 0,n);this._projectExtentTask={...this._projectExtentTask,task:null,output:o}}catch{if(js(n))return;this._projectExtentTask={...this._projectExtentTask,task:null}}}))},{updating:!0})}_narrowDownSpatialReferenceCandidates(t,i){if(t==null)return i;const r=new Array;for(const s of t)for(const n of i){if(!s.spatialReference.equals(n.spatialReference))continue;const o=Uae(s.viewingMode,n.viewingMode);if(o!==!1){r.push({spatialReference:s.spatialReference,viewingMode:o});break}}return r.length>0?r:null}_pickSpatialReferenceCandidate(t){const i=this.defaultSpatialReference;return t==null||t.length<1?i?{spatialReference:i,viewingMode:null}:null:(i!=null&&t.length>1&&t.some((({spatialReference:r})=>r.equals(i)))&&(t=t.filter((({spatialReference:r})=>r.equals(i)))),t.length>1&&t.some((({viewingMode:r})=>r!==Av.Local))&&(t=t.filter((({viewingMode:r})=>r!==Av.Local))),t[0])}_getSupportedSpatialReferences(t){const i="supportedSpatialReferences"in t&&t.supportedSpatialReferences||(t.spatialReference?[t.spatialReference]:[]);if(i.length===0)return[];const r=[];for(const s of i){const n=this.getSpatialReferenceSupport(s,t);if(n!=null){const o=n.constraints??[{spatialReference:s,viewingMode:null}];for(const{spatialReference:a,viewingMode:l}of o)this.requiresExtentInSpatialReference&&this.userSpatialReference!=null&&!a.equals(this.userSpatialReference)||r.push({spatialReference:a,viewingMode:l})}}return r}_pickExtentCandidate(t){const i=this.spatialReference;return t.find((({extent:r})=>i.equals(r.spatialReference)))||t[0]}_collectLayers(t,i,r=()=>!0){switch(this._loadMaybe(this.map?.())){case"loading":return!0;case"failed":return!1}const s=new Vae(r,i);for(const n of t)if(this._collectCollection(n,s),s.done||s.preloading===this.sourcePreloadCount)break;return s.updating}_collectCollection(t,i){if(t.layers){switch(this._loadMaybe(t.parent)){case"loading":return i.updating=!0,void++i.preloading;case"failed":return}for(const r of t.layers)if(i.layerFilter(r)){switch(this._loadMaybe(r)){case"failed":continue;case"loading":i.updating=!0,++i.preloading;break;case"loaded":if(i.updating||(i.done=i.pushLayer(r)),i.done||i.preloading===this.sourcePreloadCount)break;"layers"in r&&this._collectCollection({layers:r.layers},i)}if(i.done||i.preloading===this.sourcePreloadCount)break}}}_loadMaybe(t){return t&&"loadStatus"in t&&t.loadStatus!=null?t.loadStatus==="not-loaded"?(t.load().catch((i=>{Er(i)})),"loading"):t.loadStatus:"loaded"}};h([f()],lt.prototype,"required",void 0),h([f({constructOnly:!0})],lt.prototype,"map",void 0),h([f({constructOnly:!0})],lt.prototype,"getSpatialReferenceSupport",void 0),h([f()],lt.prototype,"defaultSpatialReference",void 0),h([f()],lt.prototype,"userSpatialReference",void 0),h([f()],lt.prototype,"sourcePreloadCount",void 0),h([f()],lt.prototype,"priorityCollection",void 0),h([f()],lt.prototype,"requiresExtentInSpatialReference",void 0),h([f()],lt.prototype,"suspended",void 0),h([f({readOnly:!0})],lt.prototype,"ready",null),h([f({readOnly:!0})],lt.prototype,"heightModelInfoReady",null),h([f({readOnly:!0})],lt.prototype,"spatialReference",null),h([f({readOnly:!0})],lt.prototype,"extent",null),h([f({readOnly:!0})],lt.prototype,"heightModelInfo",null),h([f({readOnly:!0})],lt.prototype,"vcsWkid",null),h([f({readOnly:!0})],lt.prototype,"latestVcsWkid",null),h([f({readOnly:!0})],lt.prototype,"viewingMode",null),h([f({readOnly:!0})],lt.prototype,"tileInfo",null),h([f({readOnly:!0})],lt.prototype,"mapCollections",null),h([f({readOnly:!0})],lt.prototype,"_spatialReferenceTask",null),h([f({readOnly:!0})],lt.prototype,"_tileInfoTask",null),h([f({readOnly:!0})],lt.prototype,"_heightModelInfoTask",null),h([f({readOnly:!0})],lt.prototype,"_extentCandidatesTask",null),h([f()],lt.prototype,"_extentTask",null),h([f()],lt.prototype,"_projectExtentTask",void 0),lt=h([I("esri.views.support.DefaultsFromMap")],lt);let Vae=class{constructor(t,i){this.layerFilter=t,this.pushLayer=i,this.preloading=-1,this.updating=!1,this.done=!1}};function Uae(e,t){return e!=null?t!=null?e===t&&e:e:t}function jae(e){return"tryRecycleWith"in e}let Gae=class{constructor(t,i,r){this.layer=t,this.view=i,this.layerViewImporter=r,this._controller=new AbortController,this._deferred=Gs(),this._started=!1,this.done=!1,this.promise=this._deferred.promise,kn(this._controller.signal,(()=>{this._recycleController?.abort();const s=new j("cancelled:layerview-create","layerview creation cancelled",{layer:t});this._deferred.reject(s)}))}tryRecycle(t){if(!this.done||!this.layerView||!jae(this.layerView))return null;this._recycleController?.abort(),this._recycleController=new AbortController;const i=this.layer.type,r=this._recycleController.signal;for(let s=0;s<t.length;s++){const n=t[s];if(n.type!==i)continue;const o=this.layerView.tryRecycleWith(n,{signal:r});if(o){t.splice(s,1),this.layer=n;const a=this.layerView,l=a.view;return this.promise=o.then((()=>(It(r),n.emit("layerview-destroy",{view:l,layerView:a}),l.emit("layerview-destroy",{view:l,layerView:a}),n.emit("layerview-create",{view:l,layerView:a}),l.emit("layerview-create",{view:l,layerView:a}),a))),this.promise}}return null}destroy(){this._controller.abort();const{layerView:t}=this;if(t){const{layer:i,view:r}=this;i.emit("layerview-destroy",{view:r,layerView:t}),r.emit("layerview-destroy",{layer:i,layerView:t})}this.done=!0,this.layer=null,this.layerView=null,this.view=null,this.layerViewImporter=null,this._map=null,this.promise=null,this._deferred=null}async start(){const{view:t}=this;if(this._started||!t.map)return;this._started=!0;const{_controller:{signal:i},layer:r}=this;this._map=t.map;try{let s,n;if(await r.load({signal:i}),r.prefetchResources&&await r.prefetchResources({signal:i}),Bae(r))s=await r.createLayerView(t,{signal:i});else{if(!this.layerViewImporter.hasLayerViewModule(r))throw new j("layer:view-not-supported","No layerview implementation was found");const l=await this.layerViewImporter.importLayerView(r);It(i),s="default"in l?new l.default({layer:r,view:t}):new l({layer:r,view:t})}const o=()=>{n=St(n),s.destroyed||s.destroy(),s.layer=null,s.parent=null,s.view=null,this.done=!0};n=kn(i,o),It(i);try{await s.when()}catch(l){throw o(),l}if(!this._map?.allLayers?.includes(r))return o(),void this._deferred.reject(new j("view:no-layerview-for-layer","The layer has been removed from the map",{layer:r}));this.layerView=s,r.emit("layerview-create",{view:t,layerView:s}),t.emit("layerview-create",{layer:r,layerView:s}),this.done=!0,this._deferred.resolve(s)}catch(s){r.emit("layerview-create-error",{view:t,error:s}),t.emit("layerview-create-error",{layer:r,error:s}),this.done=!0,this._deferred.reject(new j("layerview:create-error","layerview creation failed",{layer:r,error:s}))}}};function Bae(e){return e.createLayerView!==kt.prototype.createLayerView}function qae(e){return e!=null&&typeof e=="object"&&"layerViews"in e}let is=class extends le{constructor(t){super(t),this._layerLayerViewInfoMap=new Map,this._recyclingInfoMap=new Map,this._watchUpdatingTracking=new Bc,this.supportsGround=!0,this._preloadLayerViewModules=()=>{const i=this.view.map?.allLayers;if(i)for(const r of i)this.layerViewFilter?.(r)!==!1&&this.layerViewImporter.hasLayerViewModule(r)&&this.layerViewImporter.importLayerView(r)},this._reschedule=()=>this.destroyed?Promise.reject():(this._workPromise==null&&(this._workPromise=Gs(),this._workPromise.promise.catch((()=>{}))),this.removeHandles("reschedule"),this.addHandles(Lg(this._doWork),"reschedule"),this._workPromise.promise),this._doWork=()=>{const i=this.view.map;if(this.destroyed||!i)return void this.clear();if(this._map!==i&&(this.clear(),this._map=i),this._workPromise==null)return void this.notifyChange("updating");this.removeHandles("reschedule"),this.removeHandles("collection-change");const r=new Set,s=[],n=this.view.ready,o=c=>{if(c!=null){for(const d of c)if(d){if(this.layerViewFilter?.(d)===!1)continue;r.add(d);const m=this._layerLayerViewInfoMap.get(d);m&&n?m.start():m||this._recyclingInfoMap.has(d)||s.push(d),"layers"in d&&d.layers&&o(d.layers)}}};for(const c of this._rootCollectionNames)o(Mn(this,c));const a=new Array,l=c=>{const d=c.tryRecycle(s);d?(this._recyclingInfoMap.set(c.layer,c),this.notifyChange("updating"),d.then((()=>{this._recyclingInfoMap.delete(c.layer),this._layerLayerViewInfoMap.set(c.layer,c),this._reschedule(),this.notifyChange("updating")})).catch((m=>{Er(m)||(this._recyclingInfoMap.delete(c.layer),c.destroy(),this._reschedule(),this.notifyChange("updating"))}))):a.push(c)};for(const c of this._layerLayerViewInfoMap.values())r.has(c.layer)||(this._layerLayerViewInfoMap.delete(c.layer),l(c));for(const c of this._recyclingInfoMap.values())r.has(c.layer)||(this._recyclingInfoMap.delete(c.layer),l(c));for(const c of s)this._createLayerView(c);this._refreshCollections(),a.forEach((c=>c.destroy()));const u=[i?.ground?.layers,i?.basemap?.baseLayers,i?.basemap?.referenceLayers,i?.layers].filter((c=>!!c));r.forEach((c=>"layers"in c&&u.push(c.layers))),this.addHandles(u.map((c=>this._watchUpdatingTracking.addOnCollectionChange((()=>c),this._reschedule))),"collection-change"),this._workPromise.resolve(),this._workPromise=null}}initialize(){this.addHandles([In((()=>this.view?.map?.allLayers),"change",this._preloadLayerViewModules,{onListenerAdd:this._preloadLayerViewModules}),te((()=>{const t=this.view,i=t?.map;return[i?.basemap,i?.ground,i?.layers,t?.ready]}),(()=>this._reschedule()),br)]),this._preloadLayerViewModules(),this._reschedule()}destroy(){this.clear(),y2(this._recyclingInfoMap),y2(this._layerLayerViewInfoMap),this._watchUpdatingTracking.destroy(),this._map=null,this._workPromise!=null&&(this._workPromise.reject(yt()),this._workPromise=null)}get _layersToLayerViews(){const t=[["view.map.basemap.baseLayers","view.basemapView.baseLayerViews"],["view.map.layers","view.layerViews"],["view.map.basemap.referenceLayers","view.basemapView.referenceLayerViews"]];return this.supportsGround&&t.push(["view.map.ground.layers","view.groundView.layerViews"]),new Map(t)}get _rootCollectionNames(){return Array.from(this._layersToLayerViews.keys())}get updating(){return this._workPromise!=null||this._watchUpdatingTracking.updating||aH(this._layerLayerViewInfoMap,(t=>!t.done))||this._recyclingInfoMap.size>0}get updatingRemaining(){let t=0;for(const i of this._layerLayerViewInfoMap.values())i.done||++t;return t}clear(){this.destroyed||(this._clearCollections(),y2(this._layerLayerViewInfoMap))}async whenLayerView(t){if(await this._reschedule(),!this._layerLayerViewInfoMap.has(t)){if(this._recyclingInfoMap.has(t))return this._recyclingInfoMap.get(t).promise;throw new j("view:no-layerview-for-layer","No layerview has been found for the layer",{layer:t})}return this._layerLayerViewInfoMap.get(t).promise}isCreatingLayerViewsForLayer(t,i){this.commitProperty("updatingRemaining");const r=this._layerLayerViewInfoMap.get(t);if(!r?.done)return!0;const s=r.layerView;return!(!s||!i||s.parent===i)||!!(r.done&&s&&"layers"in t&&t.layers?.length)&&t.layers.some((n=>this.isCreatingLayerViewsForLayer(n,s)))}_refreshCollections(){for(const[t,i]of this._layersToLayerViews)this._populateLayerViewsOwners(Mn(this,t),Mn(this,i),this.view);this.notifyChange("updating"),this.notifyChange("updatingRemaining")}_clearCollections(){for(const t of this._layersToLayerViews.values())Mn(this,t)?.removeAll()}_populateLayerViewsOwners(t,i,r){if(!t||!i)return void i?.removeAll();let s=0;for(const n of t){const o=this._layerLayerViewInfoMap.get(n);if(!o?.layerView)continue;const a=o.layerView;a.layer=n,a.parent=r,i.at(s)!==a&&i.splice(s,0,a),"layers"in n&&qae(a)&&this._populateLayerViewsOwners(n.layers,a.layerViews,a),s+=1}s<i.length&&i.splice(s)}_createLayerView(t){t.load().catch((()=>{})),this.layerViewImporter.hasLayerViewModule(t)&&this.layerViewImporter.importLayerView(t);const i=new Gae(t,this.view,this.layerViewImporter);i.promise.then((()=>this._refreshCollections()),(r=>{r&&(Er(r)||r.name==="cancelled:layerview-create")||H.getLogger(this).error(`Failed to create layerview for layer title:'${t.title??"no title"}', id:'${t.id??"no id"}' of type '${t.type}'.`,{layer:t,error:r}),this._refreshCollections()})),this._layerLayerViewInfoMap.set(t,i),this.view.ready&&i.start(),this.notifyChange("updating"),this.notifyChange("updatingRemaining")}};h([f()],is.prototype,"_workPromise",void 0),h([f({readOnly:!0})],is.prototype,"_watchUpdatingTracking",void 0),h([f({readOnly:!0})],is.prototype,"_layersToLayerViews",null),h([f({readOnly:!0})],is.prototype,"_rootCollectionNames",null),h([f({constructOnly:!0})],is.prototype,"layerViewFilter",void 0),h([f()],is.prototype,"layerViewImporter",void 0),h([f()],is.prototype,"supportsGround",void 0),h([f({readOnly:!0})],is.prototype,"updating",null),h([f({readOnly:!0})],is.prototype,"updatingRemaining",null),h([f({constructOnly:!0})],is.prototype,"view",void 0),is=h([I("esri.views.support.LayerViewManager")],is);const Hae=is;let cd=class extends le{constructor(t){super(t),this.featureTitleFields=!1,this.utilityNetworkFields=!1,this.globalIdField=!1}};h([f()],cd.prototype,"featureTitleFields",void 0),h([f()],cd.prototype,"utilityNetworkFields",void 0),h([f()],cd.prototype,"globalIdField",void 0),cd=h([I("esri.views.support.RequiredFieldsOptions")],cd);const Wae=cd;var Um,Kc;let ue=(Kc=class extends Ja.EventedMixin(Xl.EsriPromiseMixin(le)){constructor(t){super(t),this._userSpatialReference=null,this._cursor=null,this.handles=new uf,this.updatingHandles=new Bc,this.allLayerViews=new ro({getCollections:()=>[this.basemapView?.baseLayerViews,this.groundView?.layerViews,this.layerViews,this.basemapView?.referenceLayerViews],getChildrenFunction:Yae}),this.analyses=new Tv,this.basemapView=null,this.displayFilterEnabled=!0,this.fatalError=null,this.graphics=new Ey,this.groundView=null,this.typeSpecificPreconditionsReady=!0,this.layerViews=new ne,this.magnifier=new cV,this.padding={left:0,top:0,right:0,bottom:0},this.ready=!1,this._readyStateWaitingTask=null,this.supportsGround=!0,this.type=null,this.scale=null,this.updating=!1,this.initialExtentRequired=!0,this.input=new Rae,this.navigation=new hw,this.layerViewManager=null,this.analysisViewManager=null,this.isHeightModelInfoRequired=!1,this.width=null,this.height=null,this.resizing=!1,this.suspended=!1,this.viewEvents=new fV(this),this.persistableViewModels=new ne,this.requiredFieldsOptions=new Wae,this._isValid=!1,this._readyCycleForced=!1,this._lockedSpatialReference=null,this._userTimeZone=null,this._lockedTimeZone=null,this._userTimeExtent=null,this._lockedTimeExtent=null,this.theme=null,this.handles.add(te((()=>this.preconditionsReady),(i=>{const r=this.ready;if(i?(this._lockedSpatialReference=this.spatialReference,this._lockedTimeZone=this.timeZone,this._lockedTimeExtent=this.timeExtent,Um.views.add(this)):(this._lockedSpatialReference=null,Um.views.remove(this)),this.notifyChange("spatialReference"),!i&&r)this.toolViewManager?.detach(),this.analysisViewManager!=null&&this.analysisViewManager.detach(),this.layerViewManager?.clear(),this._teardown();else if(i&&!r){try{this._startup()}catch(s){return void queueMicrotask((()=>{this.fatalError=new j("view:startup-error","View._startup failed",s)}))}this.analysisViewManager!=null&&this.analysisViewManager.attach(),this.toolViewManager.attach()}}),yu))}initialize(){this.addResolvingPromise(Promise.all([this.loadAsyncDependencies(),this.validate()]).then((()=>(this._isValid=!0,Vg((()=>this.ready)))))),this.basemapView=new Voe({view:this}),this.layerViewManager=new Hae({view:this,layerViewFilter:t=>this.layerViewFilter?.(t)??!0,layerViewImporter:{importLayerView:t=>this.importLayerView(t),hasLayerViewModule:t=>this.hasLayerViewModule(t)},supportsGround:this.supportsGround}),this.toolViewManager=new Zn({view:this}),this.selectionManager=new Qoe({view:this}),this.addHandles([Yr((()=>this.readyState==="map-content-error"&&!this.spatialReference),(()=>{H.getLogger(this).warn("#spatialReference","no spatial reference could be derived from the currently added map layers")})),te((()=>this.initialExtentRequired),(t=>this.defaultsFromMap.required={...this.defaultsFromMap.required,extent:t}),br),te((()=>this.ready),(t=>{this.defaultsFromMap&&(this.defaultsFromMap.suspended=t,this.defaultsFromMap.userSpatialReference=t?this.spatialReference:this._userSpatialReference)}),yu),te((()=>this._userSpatialReference),(t=>{this.defaultsFromMap&&(this.defaultsFromMap.userSpatialReference=t)}),br)])}destroy(){this.destroyed||(Um.views.remove(this),this.viewEvents.destroy(),this.allLayerViews.destroy(),this.navigation&&(this.navigation.destroy(),this._set("navigation",null)),this.graphics=Ot(this.graphics),this.analyses=Ot(this.analyses),this.defaultsFromMap.destroy(),this._set("defaultsFromMap",null),Ot(this.analysisViewManager),this.toolViewManager=Ot(this.toolViewManager),this.layerViewManager=Ot(this.layerViewManager),this.selectionManager=Ot(this.selectionManager),this.basemapView=Ot(this.basemapView),this.groundView?.destroy(),this.layerViews?.forEach((t=>t.destroy())),this.layerViews.length=0,this.invalidate(),this._emitter.clear(),this.handles.destroy(),this.map=Ot(this.map),this.updatingHandles.destroy())}_startup(){this._set("ready",!0)}_teardown(){this._set("ready",!1)}whenReady(){return Promise.resolve(this)}toMap(){return H.getLogger(this).error("#toMap()","Not implemented on this instance of View"),null}get activeTool(){return this.toolViewManager?.activeTool}set activeTool(t){this.toolViewManager&&(this.toolViewManager.activeTool=t)}get animation(){return this._get("animation")}set animation(t){this._set("animation",t)}get center(){return null}get defaultsFromMapSettings(){return{}}get defaultsFromMap(){return new lt({required:{tileInfo:!1,heightModelInfo:!1,extent:!1},map:()=>this.map,getSpatialReferenceSupport:(t,i)=>this.getSpatialReferenceSupport(t,i),...this.defaultsFromMapSettings})}get extent(){return this._get("extent")}set extent(t){this._set("extent",t)}get heightModelInfo(){return this.getDefaultHeightModelInfo()}get highlights(){return this._get("highlights")??Iae()}set highlights(t){this._set("highlights",Ha(t,this._get("highlights"),ne.ofType(ou)))}get interacting(){return this.navigating}get navigating(){return!1}get preconditionsReady(){return!this.destroying&&!this.destroyed&&!(this.fatalError||!this._isValid||this._readyCycleForced||!this.map||Ns.isLoadable(this.map)&&!this.map.loaded||this.width===0||this.height===0||!this.spatialReference||!this._validateSpatialReference(this.spatialReference)||!this._lockedSpatialReference&&!this.defaultsFromMap?.ready||!this.typeSpecificPreconditionsReady)}get resolution(){return 0}set map(t){t!==this._get("map")&&(t?.destroyed&&(H.getLogger(this).warn("#map","The provided map is already destroyed",{map:t}),t=null),Ns.isLoadable(t)&&t.load().catch((()=>{})),this.constructed&&!this.destroyed&&(this.forceReadyCycle(),this._lockedSpatialReference=null),this._set("map",t))}get readyState(){if(this.destroyed)return this._get("readyState");if(!this.map)return"missing-map";if("container"in this&&!this.container)return"missing-container";if(this.fatalError)return"rendering-error";if((this.defaultsFromMap?.ready??!1)&&!this.spatialReference){const t=!("loaded"in this.map)||this.map.loaded,i=this.map.ground.loaded,r=this.map.basemap?.loaded??!0;return t&&r&&i&&!this.map?.allLayers.length?"empty-map":(this._readyStateWaitingTask||(this._readyStateWaitingTask=XE((s=>mD(N("view-readyState-waiting-delay"),null,s))),this.addHandles(this._readyStateWaitingTask),this.addHandles(this._readyStateWaitingTask,"ready-state-task")),this._readyStateWaitingTask?.finished?"map-content-error":"loading")}return this._readyStateWaitingTask=Lp(this._readyStateWaitingTask),this.removeHandles("ready-state-task"),this.ready?"ready":"loading"}get spatialReference(){const t=this._userSpatialReference||this._lockedSpatialReference||this.getDefaultSpatialReference()||null;if(t&&this.defaultsFromMap?.required?.heightModelInfo){const i=t.clone();return i.vcsWkid=this.defaultsFromMap.vcsWkid,i.latestVcsWkid=this.defaultsFromMap.latestVcsWkid,i}return t}set spatialReference(t){const i=!ci(t,this._get("spatialReference"));this._set("_userSpatialReference",t),i&&(this._set("spatialReference",t),this._spatialReferenceChanged(t))}_spatialReferenceChanged(t){}get stationary(){return!this.animation&&!this.navigating&&!this.resizing}get timeExtent(){return this._userTimeExtent??this._lockedTimeExtent??this.getDefaultTimeExtent()??null}set timeExtent(t){this._userTimeExtent=t}get timeZone(){return this._userTimeZone??this._lockedTimeZone??this.getDefaultTimeZone()??On}set timeZone(t){this._userTimeZone=t,yK(t)||H.getLogger(this).warn("#timeZone",`the parsed value '${t}' may not be a valid IANA time zone`)}get tools(){return this.toolViewManager?.tools}get initialExtent(){return this.defaultsFromMap?.extent}get cursor(){return this.toolViewManager?.cursor??this._cursor??"default"}set cursor(t){this._cursor=t,this.notifyChange("cursor")}get size(){return[this.width,this.height]}get effectiveTheme(){return this.theme??new bM}whenLayerView(t){return this.layerViewManager?.whenLayerView(t)??Promise.reject()}getDefaultSpatialReference(){return this.defaultsFromMap?.spatialReference}getDefaultHeightModelInfo(){return(this.map&&"heightModelInfo"in this.map?this.map.heightModelInfo:void 0)??this.defaultsFromMap?.heightModelInfo??null}getDefaultTimeZone(){return null}getDefaultTimeExtent(){return null}importLayerView(t){throw new j("view:importLayerView-missing","importLayerView() not implemented")}hasLayerViewModule(t){return!1}async validate(){}async loadAsyncDependencies(){}invalidate(){this._isValid=!1}getSpatialReferenceSupport(){return{constraints:null}}_validateSpatialReference(t){return this.getSpatialReferenceSupport(t)!=null}when(t,i){return this.isResolved()&&!this.ready&&H.getLogger(this).warn("#when()","Calling view.when() while the view is no longer ready but was already resolved once will resolve immediately. Use reactiveUtils.whenOnce(() => view.ready).then(...) instead."),super.when(t,i)}forceReadyCycle(){this.ready&&(Yr((()=>this.destroyed||this.preconditionsReady===!1),(()=>this._readyCycleForced=!1),{once:!0}),this._readyCycleForced=!0)}addAndActivateTool(t){this.toolViewManager.tools.add(t),this.activeTool=t}tryFatalErrorRecovery(){this.fatalError=null}},Um=Kc,Kc.views=new ne,Kc);h([f()],ue.prototype,"_userSpatialReference",void 0),h([f()],ue.prototype,"activeTool",null),h([f({readOnly:!0})],ue.prototype,"allLayerViews",void 0),h([f(lL(Tv,"analyses"))],ue.prototype,"analyses",void 0),h([f()],ue.prototype,"animation",null),h([f()],ue.prototype,"basemapView",void 0),h([f()],ue.prototype,"center",null),h([f()],ue.prototype,"defaultsFromMapSettings",null),h([f()],ue.prototype,"defaultsFromMap",null),h([f()],ue.prototype,"displayFilterEnabled",void 0),h([f({type:ke})],ue.prototype,"extent",null),h([f()],ue.prototype,"fatalError",void 0),h([f(lL(Ey,"graphics"))],ue.prototype,"graphics",void 0),h([f()],ue.prototype,"groundView",void 0),h([f({readOnly:!0,type:Nr})],ue.prototype,"heightModelInfo",null),h([f({type:ne.ofType(ou)})],ue.prototype,"highlights",null),h([f({readOnly:!0})],ue.prototype,"interacting",null),h([f({constructOnly:!0})],ue.prototype,"layerViewFilter",void 0),h([f({readOnly:!0})],ue.prototype,"navigating",null),h([f({readOnly:!0,dependsOn:["fatalError","_isValid","_readyCycleForced","map","map.loaded?","width","height","spatialReference","_lockedSpatialReference","defaultsFromMap.ready","typeSpecificPreconditionsReady"]})],ue.prototype,"preconditionsReady",null),h([f({readOnly:!0})],ue.prototype,"typeSpecificPreconditionsReady",void 0),h([f({type:ne,readOnly:!0})],ue.prototype,"layerViews",void 0),h([f()],ue.prototype,"resolution",null),h([f({type:cV})],ue.prototype,"magnifier",void 0),h([f({value:null,type:Eie})],ue.prototype,"map",null),h([f()],ue.prototype,"padding",void 0),h([f({readOnly:!0})],ue.prototype,"ready",void 0),h([f()],ue.prototype,"_readyStateWaitingTask",void 0),h([f({readOnly:!0})],ue.prototype,"readyState",null),h([f({type:ae})],ue.prototype,"spatialReference",null),h([f()],ue.prototype,"stationary",null),h([f({readOnly:!0})],ue.prototype,"supportsGround",void 0),h([f({type:yr})],ue.prototype,"timeExtent",null),h([f({type:String,nonNullable:!0})],ue.prototype,"timeZone",null),h([f()],ue.prototype,"tools",null),h([f()],ue.prototype,"toolViewManager",void 0),h([f({readOnly:!0})],ue.prototype,"type",void 0),h([f({type:Number})],ue.prototype,"scale",void 0),h([f({readOnly:!0})],ue.prototype,"updating",void 0),h([f({readOnly:!0})],ue.prototype,"initialExtentRequired",void 0),h([f({readOnly:!0})],ue.prototype,"initialExtent",null),h([f()],ue.prototype,"cursor",null),h([f({readOnly:!0})],ue.prototype,"input",void 0),h([f({type:hw,nonNullable:!0})],ue.prototype,"navigation",void 0),h([f()],ue.prototype,"layerViewManager",void 0),h([f()],ue.prototype,"analysisViewManager",void 0),h([f()],ue.prototype,"selectionManager",void 0),h([f()],ue.prototype,"width",void 0),h([f()],ue.prototype,"height",void 0),h([f({readOnly:!0})],ue.prototype,"resizing",void 0),h([f({value:null,readOnly:!0})],ue.prototype,"size",null),h([f({readOnly:!0})],ue.prototype,"suspended",void 0),h([f({readOnly:!0})],ue.prototype,"viewEvents",void 0),h([f({readOnly:!0})],ue.prototype,"persistableViewModels",void 0),h([f()],ue.prototype,"_isValid",void 0),h([f()],ue.prototype,"_readyCycleForced",void 0),h([f()],ue.prototype,"_lockedSpatialReference",void 0),h([f()],ue.prototype,"_userTimeZone",void 0),h([f()],ue.prototype,"_lockedTimeZone",void 0),h([f()],ue.prototype,"_userTimeExtent",void 0),h([f()],ue.prototype,"_lockedTimeExtent",void 0),h([f({type:bM})],ue.prototype,"theme",void 0),h([f({readOnly:!0,type:bM})],ue.prototype,"effectiveTheme",null),ue=Um=h([I("esri.views.View")],ue);const N2=globalThis.$arcgis;N2&&!N2.views&&Object.defineProperty(N2,"views",{configurable:!1,enumerable:!0,writable:!1,value:ue.views});const Zae=ue;function Yae(e){return e.layerViews}function ap(e,t){return e[0]=t[0],e[1]=t[1],e}function Jt(e,t,i){return e[0]=t,e[1]=i,e}function CV(e,t,i){return e[0]=t[0]+i[0],e[1]=t[1]+i[1],e}function rg(e,t,i){return e[0]=t[0]-i[0],e[1]=t[1]-i[1],e}function PV(e,t,i){return e[0]=t[0]*i[0],e[1]=t[1]*i[1],e}function IV(e,t,i){return e[0]=t[0]/i[0],e[1]=t[1]/i[1],e}function Jae(e,t){return e[0]=Math.ceil(t[0]),e[1]=Math.ceil(t[1]),e}function Xae(e,t){return e[0]=Math.floor(t[0]),e[1]=Math.floor(t[1]),e}function Kae(e,t,i){return e[0]=Math.min(t[0],i[0]),e[1]=Math.min(t[1],i[1]),e}function Qae(e,t,i){return e[0]=Math.max(t[0],i[0]),e[1]=Math.max(t[1],i[1]),e}function ele(e,t){return e[0]=Math.round(t[0]),e[1]=Math.round(t[1]),e}function Xg(e,t,i){return e[0]=t[0]*i,e[1]=t[1]*i,e}function tle(e,t,i,r){return e[0]=t[0]+i[0]*r,e[1]=t[1]+i[1]*r,e}function dw(e,t){const i=t[0]-e[0],r=t[1]-e[1];return Math.sqrt(i*i+r*r)}function Lv(e,t){const i=t[0]-e[0],r=t[1]-e[1];return i*i+r*r}function kv(e){const t=e[0],i=e[1];return Math.sqrt(t*t+i*i)}function AV(e){const t=e[0],i=e[1];return t*t+i*i}function LV(e,t){return e[0]=-t[0],e[1]=-t[1],e}function ile(e,t){return e[0]=1/t[0],e[1]=1/t[1],e}function MM(e,t){const i=t[0],r=t[1];let s=i*i+r*r;return s>0&&(s=1/Math.sqrt(s),e[0]=t[0]*s,e[1]=t[1]*s),e}function kV(e,t){return e[0]*t[0]+e[1]*t[1]}function RV(e,t,i){const r=t[0]*i[1]-t[1]*i[0];return e[0]=e[1]=0,e[2]=r,e}function rle(e,t,i,r){const s=t[0],n=t[1];return e[0]=s+r*(i[0]-s),e[1]=n+r*(i[1]-n),e}function sle(e,t=1){const i=2*iw()*Math.PI;return e[0]=Math.cos(i)*t,e[1]=Math.sin(i)*t,e}function nle(e,t,i){const r=t[0],s=t[1];return e[0]=i[0]*r+i[2]*s,e[1]=i[1]*r+i[3]*s,e}function tr(e,t,i){const r=t[0],s=t[1];return e[0]=i[0]*r+i[2]*s+i[4],e[1]=i[1]*r+i[3]*s+i[5],e}function ole(e,t,i){const r=t[0],s=t[1];return e[0]=i[0]*r+i[3]*s+i[6],e[1]=i[1]*r+i[4]*s+i[7],e}function ale(e,t,i){const r=t[0],s=t[1];return e[0]=i[0]*r+i[4]*s+i[12],e[1]=i[1]*r+i[5]*s+i[13],e}function lle(e,t,i,r){const s=t[0]-i[0],n=t[1]-i[1],o=Math.sin(r),a=Math.cos(r);return e[0]=s*a-n*o+i[0],e[1]=s*o+n*a+i[1],e}function ule(e,t){const i=e[0],r=e[1],s=t[0],n=t[1];let o=i*i+r*r;o>0&&(o=1/Math.sqrt(o));let a=s*s+n*n;a>0&&(a=1/Math.sqrt(a));const l=(i*s+r*n)*o*a;return l>1?0:l<-1?Math.PI:Math.acos(l)}function cle(e){return"vec2("+e[0]+", "+e[1]+")"}function hle(e,t){return e[0]===t[0]&&e[1]===t[1]}function dle(e,t){const i=e[0],r=e[1],s=t[0],n=t[1],o=Tr();return Math.abs(i-s)<=o*Math.max(1,Math.abs(i),Math.abs(s))&&Math.abs(r-n)<=o*Math.max(1,Math.abs(r),Math.abs(n))}function ple(e,t,i,r,s){let n=t[0]-i[0],o=t[1]-i[1];const a=(r[0]*n+r[1]*o)*(s-1);return n=r[0]*a,o=r[1]*a,e[0]=t[0]+n,e[1]=t[1]+o,e}const fle=kv,eP=rg,mle=PV,yle=IV,gle=dw,_le=Lv,vle=AV;Object.freeze(Object.defineProperty({__proto__:null,add:CV,angle:ule,ceil:Jae,copy:ap,cross:RV,dist:gle,distance:dw,div:yle,divide:IV,dot:kV,equals:dle,exactEquals:hle,floor:Xae,inverse:ile,len:fle,length:kv,lerp:rle,max:Qae,min:Kae,mul:mle,multiply:PV,negate:LV,normalize:MM,projectAndScale:ple,random:sle,rotate:lle,round:ele,scale:Xg,scaleAndAdd:tle,set:Jt,sqrDist:_le,sqrLen:vle,squaredDistance:Lv,squaredLength:AV,str:cle,sub:eP,subtract:rg,transformMat2:nle,transformMat2d:tr,transformMat3:ole,transformMat4:ale},Symbol.toStringTag,{value:"Module"}));function Dt(){return[0,0]}function ble(e){return[e[0],e[1]]}function Kg(e,t){return[e,t]}function wle(e,t){return[e,t]}function Sle(e,t=Dt()){const i=Math.min(2,e.length);for(let r=0;r<i;++r)t[r]=e[r];return t}function OV(){return Dt()}function NV(){return Kg(1,1)}function DV(){return Kg(1,0)}function FV(){return Kg(0,1)}const xle=OV(),$le=NV(),Mle=DV(),Tle=FV();Object.freeze(Object.defineProperty({__proto__:null,ONES:$le,UNIT_X:Mle,UNIT_Y:Tle,ZEROS:xle,clone:ble,create:Dt,freeze:wle,fromArray:Sle,fromValues:Kg,ones:NV,unitX:DV,unitY:FV,zeros:OV},Symbol.toStringTag,{value:"Module"}));function Ele(e,t){return e[0]=t[0],e[1]=t[1],e[2]=t[2],e[3]=t[3],e[4]=t[4],e[5]=t[5],e}function Qg(e){return e[0]=1,e[1]=0,e[2]=0,e[3]=1,e[4]=0,e[5]=0,e}function Cle(e,t,i,r,s,n,o){return e[0]=t,e[1]=i,e[2]=r,e[3]=s,e[4]=n,e[5]=o,e}function tP(e,t){const i=t[0],r=t[1],s=t[2],n=t[3],o=t[4],a=t[5];let l=i*n-r*s;return l?(l=1/l,e[0]=n*l,e[1]=-r*l,e[2]=-s*l,e[3]=i*l,e[4]=(s*a-n*o)*l,e[5]=(r*o-i*a)*l,e):null}function Ple(e){return e[0]*e[3]-e[1]*e[2]}function so(e,t,i){const r=t[0],s=t[1],n=t[2],o=t[3],a=t[4],l=t[5],u=i[0],c=i[1],d=i[2],m=i[3],y=i[4],g=i[5];return e[0]=r*u+n*c,e[1]=s*u+o*c,e[2]=r*d+n*m,e[3]=s*d+o*m,e[4]=r*y+n*g+a,e[5]=s*y+o*g+l,e}function vu(e,t,i){const r=t[0],s=t[1],n=t[2],o=t[3],a=t[4],l=t[5],u=Math.sin(i),c=Math.cos(i);return e[0]=r*c+n*u,e[1]=s*c+o*u,e[2]=r*-u+n*c,e[3]=s*-u+o*c,e[4]=a,e[5]=l,e}function e0(e,t,i){const r=t[0],s=t[1],n=t[2],o=t[3],a=t[4],l=t[5],u=i[0],c=i[1];return e[0]=r*u,e[1]=s*u,e[2]=n*c,e[3]=o*c,e[4]=a,e[5]=l,e}function Fo(e,t,i){const r=t[0],s=t[1],n=t[2],o=t[3],a=t[4],l=t[5],u=i[0],c=i[1];return e[0]=r,e[1]=s,e[2]=n,e[3]=o,e[4]=r*u+n*c+a,e[5]=s*u+o*c+l,e}function pw(e,t){const i=Math.sin(t),r=Math.cos(t);return e[0]=r,e[1]=i,e[2]=-i,e[3]=r,e[4]=0,e[5]=0,e}function zV(e,t){return e[0]=t[0],e[1]=0,e[2]=0,e[3]=t[1],e[4]=0,e[5]=0,e}function iP(e,t){return e[0]=1,e[1]=0,e[2]=0,e[3]=1,e[4]=t[0],e[5]=t[1],e}function Ile(e){return"mat2d("+e[0]+", "+e[1]+", "+e[2]+", "+e[3]+", "+e[4]+", "+e[5]+")"}function Ale(e){return Math.sqrt(e[0]**2+e[1]**2+e[2]**2+e[3]**2+e[4]**2+e[5]**2+1)}function Lle(e,t,i){return e[0]=t[0]+i[0],e[1]=t[1]+i[1],e[2]=t[2]+i[2],e[3]=t[3]+i[3],e[4]=t[4]+i[4],e[5]=t[5]+i[5],e}function VV(e,t,i){return e[0]=t[0]-i[0],e[1]=t[1]-i[1],e[2]=t[2]-i[2],e[3]=t[3]-i[3],e[4]=t[4]-i[4],e[5]=t[5]-i[5],e}function kle(e,t,i){return e[0]=t[0]*i,e[1]=t[1]*i,e[2]=t[2]*i,e[3]=t[3]*i,e[4]=t[4]*i,e[5]=t[5]*i,e}function Rle(e,t,i,r){return e[0]=t[0]+i[0]*r,e[1]=t[1]+i[1]*r,e[2]=t[2]+i[2]*r,e[3]=t[3]+i[3]*r,e[4]=t[4]+i[4]*r,e[5]=t[5]+i[5]*r,e}function Ole(e,t){return e[0]===t[0]&&e[1]===t[1]&&e[2]===t[2]&&e[3]===t[3]&&e[4]===t[4]&&e[5]===t[5]}function Nle(e,t){const i=e[0],r=e[1],s=e[2],n=e[3],o=e[4],a=e[5],l=t[0],u=t[1],c=t[2],d=t[3],m=t[4],y=t[5],g=Tr();return Math.abs(i-l)<=g*Math.max(1,Math.abs(i),Math.abs(l))&&Math.abs(r-u)<=g*Math.max(1,Math.abs(r),Math.abs(u))&&Math.abs(s-c)<=g*Math.max(1,Math.abs(s),Math.abs(c))&&Math.abs(n-d)<=g*Math.max(1,Math.abs(n),Math.abs(d))&&Math.abs(o-m)<=g*Math.max(1,Math.abs(o),Math.abs(m))&&Math.abs(a-y)<=g*Math.max(1,Math.abs(a),Math.abs(y))}const Dle=so,Fle=VV;Object.freeze(Object.defineProperty({__proto__:null,add:Lle,copy:Ele,determinant:Ple,equals:Nle,exactEquals:Ole,frob:Ale,fromRotation:pw,fromScaling:zV,fromTranslation:iP,identity:Qg,invert:tP,mul:Dle,multiply:so,multiplyScalar:kle,multiplyScalarAndAdd:Rle,rotate:vu,scale:e0,set:Cle,str:Ile,sub:Fle,subtract:VV,translate:Fo},Symbol.toStringTag,{value:"Module"}));function zo(){return[1,0,0,1,0,0]}function zle(e){return[e[0],e[1],e[2],e[3],e[4],e[5]]}function Vle(e,t,i,r,s,n){return[e,t,i,r,s,n]}const Ule=zo();Object.freeze(Object.defineProperty({__proto__:null,IDENTITY:Ule,clone:zle,create:zo,fromValues:Vle},Symbol.toStringTag,{value:"Module"}));const D0={102100:{maxX:20037508342788905e-9,minX:-20037508342788905e-9,plus180Line:new Yt({paths:[[[20037508342788905e-9,-20037508342788905e-9],[20037508342788905e-9,20037508342788905e-9]]],spatialReference:ae.WebMercator}),minus180Line:new Yt({paths:[[[-20037508342788905e-9,-20037508342788905e-9],[-20037508342788905e-9,20037508342788905e-9]]],spatialReference:ae.WebMercator})},4326:{maxX:180,minX:-180,plus180Line:new Yt({paths:[[[180,-180],[180,180]]],spatialReference:ae.WGS84}),minus180Line:new Yt({paths:[[[-180,-180],[-180,180]]],spatialReference:ae.WGS84})}};function Rc(e,t){return Math.ceil((e-t)/(2*t))}function UV(e,t){const i=Py(e);for(const r of i)for(const s of r)s[0]+=t;return e}function Py(e){return gi(e)?e.rings:e.paths}function UIe(e,t){return t?{...t,query:{...e??{},...t.query}}:{query:e}}function jle(e){return typeof e=="string"?Li(e):V(e)}function Gle(e,t,i){const r={};for(const s in e){if(s==="declaredClass")continue;const n=e[s];if(n!=null&&typeof n!="function")if(Array.isArray(n))r[s]=n.map((o=>Gle(o)));else if(typeof n=="object")if(n.toJSON){const o=n.toJSON(i?.[s]);r[s]=t?o:JSON.stringify(o)}else r[s]=t?n:JSON.stringify(n);else r[s]=n}return r}function Ble(e,t){return e?t&&NE(e)?t:OE(e)??ot?.findCredential(e)?.token:null}async function jIe(e,t,i){const r=Ble(e,t);return r||(!ot&&Fe.request.useIdentity&&await J(()=>import("./IdentityManager-Dfl1HL-x.js"),[]),(await ot.getCredential(e,i))?.token)}async function qle(e,t,i,r){const s=jle(e),n=t[0].spatialReference,o={...r,responseType:"json",query:{...s.query,f:"json",sr:C4(n),target:JSON.stringify({geometryType:sw(t[0]),geometries:t}),cutter:JSON.stringify(i)}},a=await at(s.path+"/cut",o),{cutIndexes:l,geometries:u=[]}=a.data;return{cutIndexes:l,geometries:u.map((c=>{const d=hh(c);return d.spatialReference=n,d}))}}function Hle(e){return{geometryType:sw(e[0]),geometries:e.map((t=>t.toJSON()))}}function Wle(e,t,i){const r=Aie(t);return e.map((s=>{const n=r.fromJSON(s);return n.spatialReference=i,n}))}async function Zle(e,t,i){const r=typeof e=="string"?Li(e):e,s=t[0].spatialReference,n=sw(t[0]),o={...i,query:{...r.query,f:"json",sr:C4(s),geometries:JSON.stringify(Hle(t))}},{data:a}=await at(r.path+"/simplify",o);return Wle(a.geometries,n,s)}const jV=()=>H.getLogger("esri.geometry.support.normalizeUtils");function Yle(e){return e.type==="polygon"}function Jle(e){return e[0].type==="polygon"}function Xle(e){return e[0].type==="polyline"}function DL(e){const t=[];let i=0,r=0;for(let s=0;s<e.length;s++){const n=e[s];let o=null;for(let a=0;a<n.length;a++)o=n[a],t.push(o),a===0?(i=o[0],r=i):(i=Math.min(i,o[0]),r=Math.max(r,o[0]));o&&t.push([(i+r)/2,0])}return t}function GV(e,t){if(!(e instanceof Yt||e instanceof mt)){const s="straightLineDensify: the input geometry is neither polyline nor polygon";throw jV().error(s),new j("internal:geometry",s)}const i=Py(e),r=[];for(const s of i){const n=[];r.push(n),n.push([s[0][0],s[0][1]]);for(let o=0;o<s.length-1;o++){const a=s[o][0],l=s[o][1],u=s[o+1][0],c=s[o+1][1],d=Math.sqrt((u-a)*(u-a)+(c-l)*(c-l)),m=(c-l)/d,y=(u-a)/d,g=d/t;if(g>1){for(let S=1;S<=g-1;S++){const $=S*t,E=y*$+a,C=m*$+l;n.push([E,C])}const _=(d+Math.floor(g-1)*t)/2,v=y*_+a,b=m*_+l;n.push([v,b])}n.push([u,c])}}return Yle(e)?new mt({rings:r,spatialReference:e.spatialReference}):new Yt({paths:r,spatialReference:e.spatialReference})}function FL(e,t,i){if(t){const r=GV(e,1e6);e=Td(r,!0)}return i&&(e=UV(e,i)),e}function zL(e,t,i){if(Array.isArray(e)){const r=e[0];if(r>t){const s=Rc(r,t);e[0]=r+s*(-2*t)}else if(r<i){const s=Rc(r,i);e[0]=r+s*(-2*i)}}else{const r=e.x;if(r>t){const s=Rc(r,t);e=e.clone().offset(s*(-2*t),0)}else if(r<i){const s=Rc(r,i);e=e.clone().offset(s*(-2*i),0)}}return e}function Kle(e,t){let i=-1;for(let r=0;r<t.cutIndexes.length;r++){const s=t.cutIndexes[r],n=t.geometries[r],o=Py(n);for(let a=0;a<o.length;a++){const l=o[a];l.some((u=>{if(u[0]<180)return!0;{let c=0;for(let m=0;m<l.length;m++){const y=l[m][0];c=y>c?y:c}c=Number(c.toFixed(9));const d=-360*Rc(c,180);for(let m=0;m<l.length;m++){const y=n.getPoint(a,m);n.setPoint(a,m,y.clone().offset(d,0))}return!0}}))}if(s===i){if(Jle(e))for(const a of Py(n))e[s]=e[s].addRing(a);else if(Xle(e))for(const a of Py(n))e[s]=e[s].addPath(a)}else i=s,e[s]=n}return e}async function Qle(e,t,i){if(!Array.isArray(e))return Qle([e],t);t&&typeof t!="string"&&jV().warn("normalizeCentralMeridian()","The url object is deprecated, use the url string instead");const r=typeof t=="string"?t:t?.url??Fe.geometryServiceUrl;let s,n,o,a,l,u,c,d,m=0;const y=[],g=[];for(const E of e)if(E!=null)if(s||(s=E.spatialReference,n=ar(s),o=s.isWebMercator,u=o?102100:4326,a=D0[u].maxX,l=D0[u].minX,c=D0[u].plus180Line,d=D0[u].minus180Line),n)if(E.type==="mesh")g.push(E);else if(E.type==="point")g.push(zL(E.clone(),a,l));else if(E.type==="multipoint"){const C=E.clone();C.points=C.points.map((P=>zL(P,a,l))),g.push(C)}else if(E.type==="extent"){const C=E.clone()._normalize(!1,!1,n);g.push(C.rings?new mt(C):C)}else if(E.extent){const C=E.extent,P=Rc(C.xmin,l)*(2*a);let k=P===0?E.clone():UV(E.clone(),P);C.offset(P,0);let{xmin:F,xmax:D}=C;F=Number(F.toFixed(9)),D=Number(D.toFixed(9)),C.intersects(c)&&D!==a?(m=D>m?D:m,k=FL(k,o),y.push(k),g.push("cut")):C.intersects(d)&&F!==l?(m=D*(2*a)>m?D*(2*a):m,k=FL(k,o,360),y.push(k),g.push("cut")):g.push(k)}else g.push(E.clone());else g.push(E);else g.push(E);let _=Rc(m,a),v=-90;const b=_,S=new Yt;for(;_>0;){const E=360*_-180;S.addPath([[E,v],[E,-1*v]]),v*=-1,_--}if(y.length>0&&b>0){const E=Kle(y,await qle(r,y,S,i)),C=[],P=[];for(let D=0;D<g.length;D++){const U=g[D];if(U!=="cut")P.push(U);else{const W=E.shift(),Y=e[D];Y!=null&&Y.type==="polygon"&&Y.rings&&Y.rings.length>1&&W.rings.length>=Y.rings.length?(C.push(W),P.push("simplify")):P.push(o?jc(W):W)}}if(!C.length)return P;const k=await Zle(r,C,i),F=[];for(let D=0;D<P.length;D++){const U=P[D];U!=="simplify"?F.push(U):F.push(o?jc(k.shift()):k.shift())}return F}const $=[];for(let E=0;E<g.length;E++){const C=g[E];if(C!=="cut")$.push(C);else{const P=y.shift();$.push(o===!0?jc(P):P)}}return $}function eue(e){if(!e)return null;const t=e.extent;if(!t)return null;const i=e.spatialReference&&ar(e.spatialReference);if(!i)return t;const[r,s]=i.valid,n=2*s,{width:o}=t;let a,{xmin:l,xmax:u}=t;if([l,u]=[u,l],e.type==="extent"||o===0||o<=s||o>n||l<r||u>s)return t;switch(e.type){case"polygon":if(!(e.rings.length>1))return t;a=DL(e.rings);break;case"polyline":if(!(e.paths.length>1))return t;a=DL(e.paths);break;case"multipoint":a=e.points}const c=t.clone();for(let d=0;d<a.length;d++){let m=a[d][0];m<0?(m+=s,u=Math.max(m,u)):(m-=s,l=Math.min(m,l))}return c.xmin=l,c.xmax=u,c.width<o?(c.xmin-=s,c.xmax-=s,c):t}function rP(e,t,i){const r=ar(i);if(r==null)return e;const[s,n]=r.valid,o=2*n;let a=0,l=0;t>n?a=Math.ceil(Math.abs(t-n)/o):t<s&&(a=-Math.ceil(Math.abs(t-s)/o)),e>n?l=Math.ceil(Math.abs(e-n)/o):e<s&&(l=-Math.ceil(Math.abs(e-s)/o));let u=e+(a-l)*o;const c=u-t;return c>n?u-=o:c<s&&(u+=o),u}function GIe(e,t){const i=ar(t);if(i){const[r,s]=i.valid,n=s-r;if(e<r)for(;e<r;)e+=n;if(e>s)for(;e>s;)e-=n}return e}const BV=96,qV=39.37,tue=180/Math.PI;function HV(e){return e.wkid?e:e.spatialReference||ae.WGS84}function sP(e,t){return t.type?Jt(e,t.x,t.y):ap(e,t)}function WV(e){return Hs(e)}function fw(e,t,i=0){let r=e.width,s=e.height;if(i!==0){const a=mf(i),l=Math.abs(Math.cos(a)),u=Math.abs(Math.sin(a));r=e.width*l+e.height*u,s=e.width*u+e.height*l}const n=Math.max(1,t[0]),o=Math.max(1,t[1]);return Math.max(r/n,s/o)*uue(e.spatialReference)}async function jm(e,t,i,r){let s,n;if(!e||Array.isArray(e)&&!e.length)return null;if(ne.isCollection(e)&&(e=e.toArray()),Array.isArray(e)&&e.length&&typeof e[0]=="object"){const a=e.every((c=>"attributes"in c)),l=e.some((c=>!c.geometry));let u=e;if(a&&l&&t&&t.allLayerViews){const c=new Map;for(const g of e){const _=g.layer,v=c.get(_)||[],b=g.attributes[_.objectIdField];b!=null&&v.push(b),c.set(_,v)}const d=[];c.forEach(((g,_)=>{const v=t.allLayerViews?.find((b=>b.layer.id===_.id));if(v&&"queryFeatures"in v){const b=_.createQuery();b.objectIds=g,b.returnGeometry=!0,d.push(v.queryFeatures(b))}}));const m=await Promise.all(d),y=[];for(const g of m)if(g&&g.features&&g.features.length)for(const _ of g.features)_.geometry!=null&&y.push(_.geometry);u=y}for(const c of u)r=await jm(c,t,i,r);return r}if(Array.isArray(e)&&e.length===2&&typeof e[0]=="number"&&typeof e[1]=="number")s=new he(e);else if(e instanceof Ci)s=e;else if("geometry"in e){if(e.geometry)s=e.geometry;else if(e.layer){const a=e.layer,l=t.allLayerViews?.find((u=>u.layer.id===a.id));if(l&&"queryFeatures"in l){const u=a.createQuery();u.objectIds=[e.attributes[a.objectIdField]],u.returnGeometry=!0,s=(await l.queryFeatures(u))?.features?.[0]?.geometry}}}if(s==null)return null;switch(s.type){case"point":n=new ke({xmin:s.x,ymin:s.y,xmax:s.x,ymax:s.y,spatialReference:s.spatialReference});break;case"extent":case"multipoint":case"polygon":case"polyline":n=eue(s);break;default:n=s.extent}if(!n)return null;Xa()||qs(n.spatialReference,i)||await Wa();const o=xh(n,i);if(!o)return null;if(r){const a=o.center,l=a.clone();l.x=rP(a.x,r.center.x,i),l.x!==a.x&&o.centerAt(l),r=r.union(o)}else r=o;return r}function iue(e){if(e&&(!Array.isArray(e)||typeof e[0]!="number")&&(typeof e=="object"||Array.isArray(e)&&typeof e[0]=="object")){if("layer"in e&&e.layer?.minScale!=null&&e.layer.maxScale!=null){const t=e.layer;return{min:t.minScale,max:t.maxScale}}if(Array.isArray(e)&&e.length&&e.every((t=>"layer"in t))){let t=0,i=0;for(const r of e){const s=r.layer;s?.minScale&&s.maxScale&&(t=s.minScale<t?s.minScale:t,i=s.maxScale>i?s.maxScale:i)}return t&&i?{min:t,max:i}:null}}}function VL(e,t){const i=HV(e);return ci(i,t)||i.imageCoordinateSystem||t.imageCoordinateSystem?e:xh(e,t)}async function rue(e,t){if(!e||!t)return new Us({targetGeometry:new he,scale:0,rotation:0});let i=t.spatialReference;const{constraints:r,padding:s,viewpoint:n,size:o}=t,a=[s?o[0]-s.left-s.right:o[0],s?o[1]-s.top-s.bottom:o[1]];let l=null;e instanceof Us?l=e:e.viewpoint?l=e.viewpoint:e.target&&e.target.declaredClass==="esri.Viewpoint"&&(l=e.target);let u=null;l?.targetGeometry?u=l.targetGeometry:e instanceof ke?u=e:e instanceof Ci?u=await jm(e,t,i):e&&(u=await jm(e.center,t,i)||await jm(e.target,t,i)||await jm(e,t,i)),!u&&n?.targetGeometry?u=n.targetGeometry:!u&&t.extent&&(u=t.extent),i||(i=HV(t.spatialReference||t.extent||u)),Xa()||ci(u.spatialReference,i)||qs(u.spatialReference,i)||await Wa();const c=VL(u,i),d="center"in c?c.center:c;t.pickClosestTarget!==!1&&d.type==="point"&&n.targetGeometry?.type==="point"&&(d.x=rP(d.x,n.targetGeometry.x,d.spatialReference));let m=0;l?m=l.rotation:e.hasOwnProperty("rotation")?m=e.rotation:n&&(m=n.rotation);let y=0;y=l?.targetGeometry!=null&&l.targetGeometry.type==="point"?l.scale:"scale"in e&&e.scale?e.scale:"zoom"in e&&e.zoom!==-1&&r&&r.effectiveLODs?r.zoomToScale(e.zoom):Array.isArray(u)||u.type==="point"||u.type==="extent"&&u.width===0&&u.height===0?n.scale:fw(VL(u.extent,i),a,m);const g=iue(e.target??e);g&&(g.min&&g.min<y?y=g.min:g.max&&g.max>y&&(y=g.max));let _=new Us({targetGeometry:d,scale:y,rotation:m});return r&&(_=r.fit(_),r.constrainByGeometry(_),r.rotationEnabled||(_.rotation=n.rotation)),_}function or(e,t){const i=e.targetGeometry,r=t.targetGeometry;return i.x=r.x,i.y=r.y,i.spatialReference=r.spatialReference,e.scale=t.scale,e.rotation=t.rotation,e}function sue(e,t,i){return i?Jt(e,.5*(t[0]-i.right+i.left),.5*(t[1]-i.bottom+i.top)):Xg(e,t,.5)}const nue=(function(){const e=Dt();return function(t,i,r){const s=i.targetGeometry;sP(e,s);const n=.5*gf(i);return t.xmin=e[0]-n*r[0],t.ymin=e[1]-n*r[1],t.xmax=e[0]+n*r[0],t.ymax=e[1]+n*r[1],t.spatialReference=s.spatialReference,t}})();function oue(e,t,i,r,s){return TM(e,t,i.center),e.scale=fw(i,r),s?.constraints?.constrain(e),e}function aue(e,t,i,r){return aP(e,t,i,r),tP(e,e)}const ZV=(function(){const e=Dt();return function(t,i,r){return eP(t,cue(t,i),sue(e,i,r))}})(),lue=(function(){const e=zo(),t=Dt();return function(i,r,s,n){const o=gf(r),a=nP(r);return Jt(t,o,o),zV(e,t),vu(e,e,a),Fo(e,e,ZV(t,s,n)),Fo(e,e,[0,n.top-n.bottom]),Jt(i,e[4],e[5])}})();function gf(e){return e.scale*YV(e.targetGeometry?.spatialReference)}function YV(e){return jr(e)?1/(WV(e)*qV*BV):1}function nP(e){return kC(e.rotation)||0}function uue(e){return jr(e)?WV(e)*qV*BV:1}function cue(e,t){return Xg(e,t,.5)}const oP=(function(){const e=Dt(),t=Dt(),i=Dt();return function(r,s,n,o,a,l){return LV(e,s),Xg(t,n,.5*l),Jt(i,1/o*l,-1/o*l),iP(r,t),a&&vu(r,r,a),e0(r,r,i),Fo(r,r,e),r}})(),aP=(function(){const e=Dt();return function(t,i,r,s){const n=gf(i),o=nP(i);return sP(e,i.targetGeometry),oP(t,e,r,n,o,s)}})(),hue=(function(){const e=Dt();return function(t,i,r,s){const n=gf(i);return sP(e,i.targetGeometry),oP(t,e,r,n,0,s)}})();function JV(e){const t=ar(e);return t?t.valid[1]-t.valid[0]:0}function due(e,t){return Math.round(JV(e)/t)}const pue=(function(){const e=Dt(),t=Dt(),i=[0,0,0];return function(r,s,n){rg(e,r,s),MM(e,e),rg(t,r,n),MM(t,t),RV(i,e,t);let o=Math.acos(kV(e,t)/(kv(e)*kv(t)))*tue;return i[2]<0&&(o=-o),isNaN(o)&&(o=0),o}})(),fue=(function(){const e=Dt();return function(t,i,r,s){const n=t.targetGeometry;return or(t,i),lue(e,i,r,s),n.x+=e[0],n.y+=e[1],t}})(),TM=function(e,t,i){or(e,t);const r=e.targetGeometry;return r.x=i.x,r.y=i.y,r.spatialReference=i.spatialReference,e},mue=(function(){const e=Dt();return function(t,i,r,s,n){n||(n="center"),eP(e,r,s),Xg(e,e,.5);const o=e[0],a=e[1];switch(n){case"center":Jt(e,0,0);break;case"left":Jt(e,-o,0);break;case"top":Jt(e,0,a);break;case"right":Jt(e,o,0);break;case"bottom":Jt(e,0,-a);break;case"top-left":Jt(e,-o,a);break;case"bottom-left":Jt(e,-o,-a);break;case"top-right":Jt(e,o,a);break;case"bottom-right":Jt(e,o,-a)}return mw(t,i,e),t}})();function BIe(e,t,i){return or(e,t),e.rotation+=i,e}function yue(e,t,i){return or(e,t),e.rotation=i,e}const gue=(function(){const e=Dt();return function(t,i,r,s,n){return or(t,i),isNaN(r)||r===0||(KV(e,s,i,n),t.scale=i.scale*r,QV(e,e,t,n),mw(t,t,Jt(e,e[0]-s[0],s[1]-e[1]))),t}})();function UL(e,t,i){return or(e,t),e.scale=i,e}const XV=(function(){const e=Dt();return function(t,i,r,s,n,o){return or(t,i),isNaN(r)||r===0||(KV(e,n,i,o),t.scale=i.scale*r,t.rotation+=s,QV(e,e,t,o),mw(t,t,Jt(e,e[0]-n[0],n[1]-e[1]))),t}})(),qIe=(function(){const e=Dt(),t=Dt();return function(i,r,s,n,o,a,l){return ZV(t,a,l),CV(e,o,t),n?XV(i,r,s,n,e,a):gue(i,r,s,e,a)}})(),KV=(function(){const e=zo();return function(t,i,r,s){return tr(t,i,aue(e,r,s,1))}})(),QV=(function(){const e=zo();return function(t,i,r,s){return tr(t,i,aP(e,r,s,1))}})(),mw=(function(){const e=Dt(),t=zo();return function(i,r,s){or(i,r);const n=gf(r),o=i.targetGeometry;return pw(t,nP(r)),e0(t,t,Kg(n,n)),tr(e,s,t),o.x+=e[0],o.y+=e[1],i}})();function Ua(){const e=new Float32Array(6);return e[0]=1,e[3]=1,e}function _ue(e){const t=new Float32Array(6);return t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3],t[4]=e[4],t[5]=e[5],t}function vue(e,t,i,r,s,n){const o=new Float32Array(6);return o[0]=e,o[1]=t,o[2]=i,o[3]=r,o[4]=s,o[5]=n,o}function eU(e,t,i,r){const s=t[r],n=t[r+1];e[r]=i[0]*s+i[2]*n+i[4],e[r+1]=i[1]*s+i[3]*n+i[5]}function tU(e,t,i,r=0,s=0,n=2){const o=s||t.length/n;for(let a=r;a<o;a++)eU(e,t,i,a*n)}Object.freeze(Object.defineProperty({__proto__:null,clone:_ue,create:Ua,fromValues:vue,transform:eU,transformMany:tU},Symbol.toStringTag,{value:"Module"}));function bue(e,t){return e[0]=t[0],e[1]=t[1],e[2]=t[2],e[3]=t[4],e[4]=t[5],e[5]=t[6],e[6]=t[8],e[7]=t[9],e[8]=t[10],e}function wue(e,t){return e[0]=t[0],e[1]=t[1],e[2]=t[2],e[3]=t[3],e[4]=t[4],e[5]=t[5],e[6]=t[6],e[7]=t[7],e[8]=t[8],e}function iU(e,t,i,r,s,n,o,a,l,u){return e[0]=t,e[1]=i,e[2]=r,e[3]=s,e[4]=n,e[5]=o,e[6]=a,e[7]=l,e[8]=u,e}function rU(e){return e[0]=1,e[1]=0,e[2]=0,e[3]=0,e[4]=1,e[5]=0,e[6]=0,e[7]=0,e[8]=1,e}function Sue(e,t){if(e===t){const i=t[1],r=t[2],s=t[5];e[1]=t[3],e[2]=t[6],e[3]=i,e[5]=t[7],e[6]=r,e[7]=s}else e[0]=t[0],e[1]=t[3],e[2]=t[6],e[3]=t[1],e[4]=t[4],e[5]=t[7],e[6]=t[2],e[7]=t[5],e[8]=t[8];return e}function xue(e,t){const i=t[0],r=t[1],s=t[2],n=t[3],o=t[4],a=t[5],l=t[6],u=t[7],c=t[8],d=c*o-a*u,m=-c*n+a*l,y=u*n-o*l;let g=i*d+r*m+s*y;return g?(g=1/g,e[0]=d*g,e[1]=(-c*r+s*u)*g,e[2]=(a*r-s*o)*g,e[3]=m*g,e[4]=(c*i-s*l)*g,e[5]=(-a*i+s*n)*g,e[6]=y*g,e[7]=(-u*i+r*l)*g,e[8]=(o*i-r*n)*g,e):null}function $ue(e,t){const i=t[0],r=t[1],s=t[2],n=t[3],o=t[4],a=t[5],l=t[6],u=t[7],c=t[8];return e[0]=o*c-a*u,e[1]=s*u-r*c,e[2]=r*a-s*o,e[3]=a*l-n*c,e[4]=i*c-s*l,e[5]=s*n-i*a,e[6]=n*u-o*l,e[7]=r*l-i*u,e[8]=i*o-r*n,e}function Mue(e){const t=e[0],i=e[1],r=e[2],s=e[3],n=e[4],o=e[5],a=e[6],l=e[7],u=e[8];return t*(u*n-o*l)+i*(-u*s+o*a)+r*(l*s-n*a)}function lP(e,t,i){const r=t[0],s=t[1],n=t[2],o=t[3],a=t[4],l=t[5],u=t[6],c=t[7],d=t[8],m=i[0],y=i[1],g=i[2],_=i[3],v=i[4],b=i[5],S=i[6],$=i[7],E=i[8];return e[0]=m*r+y*o+g*u,e[1]=m*s+y*a+g*c,e[2]=m*n+y*l+g*d,e[3]=_*r+v*o+b*u,e[4]=_*s+v*a+b*c,e[5]=_*n+v*l+b*d,e[6]=S*r+$*o+E*u,e[7]=S*s+$*a+E*c,e[8]=S*n+$*l+E*d,e}function EM(e,t,i){const r=t[0],s=t[1],n=t[2],o=t[3],a=t[4],l=t[5],u=t[6],c=t[7],d=t[8],m=i[0],y=i[1];return e[0]=r,e[1]=s,e[2]=n,e[3]=o,e[4]=a,e[5]=l,e[6]=m*r+y*o+u,e[7]=m*s+y*a+c,e[8]=m*n+y*l+d,e}function sU(e,t,i){const r=t[0],s=t[1],n=t[2],o=t[3],a=t[4],l=t[5],u=t[6],c=t[7],d=t[8],m=Math.sin(i),y=Math.cos(i);return e[0]=y*r+m*o,e[1]=y*s+m*a,e[2]=y*n+m*l,e[3]=y*o-m*r,e[4]=y*a-m*s,e[5]=y*l-m*n,e[6]=u,e[7]=c,e[8]=d,e}function Tue(e,t,i){const r=i[0],s=i[1],n=i[2];return e[0]=r*t[0],e[1]=r*t[1],e[2]=r*t[2],e[3]=s*t[3],e[4]=s*t[4],e[5]=s*t[5],e[6]=n*t[6],e[7]=n*t[7],e[8]=n*t[8],e}function Eue(e,t,i){const r=i[0],s=i[1];return e[0]=r*t[0],e[1]=r*t[1],e[2]=r*t[2],e[3]=s*t[3],e[4]=s*t[4],e[5]=s*t[5],e}function Cue(e,t){return e[0]=1,e[1]=0,e[2]=0,e[3]=0,e[4]=1,e[5]=0,e[6]=t[0],e[7]=t[1],e[8]=1,e}function Pue(e,t){const i=Math.sin(t),r=Math.cos(t);return e[0]=r,e[1]=i,e[2]=0,e[3]=-i,e[4]=r,e[5]=0,e[6]=0,e[7]=0,e[8]=1,e}function Iue(e,t){return e[0]=t[0],e[1]=0,e[2]=0,e[3]=0,e[4]=t[1],e[5]=0,e[6]=0,e[7]=0,e[8]=1,e}function Aue(e,t){return e[0]=t[0],e[1]=t[1],e[2]=0,e[3]=t[2],e[4]=t[3],e[5]=0,e[6]=t[4],e[7]=t[5],e[8]=1,e}function Lue(e,t){const i=t[0],r=t[1],s=t[2],n=t[3],o=i+i,a=r+r,l=s+s,u=i*o,c=r*o,d=r*a,m=s*o,y=s*a,g=s*l,_=n*o,v=n*a,b=n*l;return e[0]=1-d-g,e[3]=c-b,e[6]=m+v,e[1]=c+b,e[4]=1-u-g,e[7]=y-_,e[2]=m-v,e[5]=y+_,e[8]=1-u-d,e}function kue(e,t){const i=t[0],r=t[1],s=t[2],n=t[4],o=t[5],a=t[6],l=t[8],u=t[9],c=t[10],d=c*o-a*u,m=-c*n+a*l,y=u*n-o*l,g=i*d+r*m+s*y;if(!g)return null;const _=1/g;return e[0]=d*_,e[1]=(-c*r+s*u)*_,e[2]=(a*r-s*o)*_,e[3]=m*_,e[4]=(c*i-s*l)*_,e[5]=(-a*i+s*n)*_,e[6]=y*_,e[7]=(-u*i+r*l)*_,e[8]=(o*i-r*n)*_,e}function Rue(e,t){const i=t[0],r=t[1],s=t[2],n=t[3],o=t[4],a=t[5],l=t[6],u=t[7],c=t[8],d=t[9],m=t[10],y=t[11],g=t[12],_=t[13],v=t[14],b=t[15],S=i*a-r*o,$=i*l-s*o,E=i*u-n*o,C=r*l-s*a,P=r*u-n*a,k=s*u-n*l,F=c*_-d*g,D=c*v-m*g,U=c*b-y*g,W=d*v-m*_,Y=d*b-y*_,re=m*b-y*v;let K=S*re-$*Y+E*W+C*U-P*D+k*F;return K?(K=1/K,e[0]=(a*re-l*Y+u*W)*K,e[1]=(l*U-o*re-u*D)*K,e[2]=(o*Y-a*U+u*F)*K,e[3]=(s*Y-r*re-n*W)*K,e[4]=(i*re-s*U+n*D)*K,e[5]=(r*U-i*Y-n*F)*K,e[6]=(_*k-v*P+b*C)*K,e[7]=(v*E-g*k-b*$)*K,e[8]=(g*P-_*E+b*S)*K,e):null}function Oue(e,t,i){return e[0]=2/t,e[1]=0,e[2]=0,e[3]=0,e[4]=-2/i,e[5]=0,e[6]=-1,e[7]=1,e[8]=1,e}function Nue(e){return"mat3("+e[0]+", "+e[1]+", "+e[2]+", "+e[3]+", "+e[4]+", "+e[5]+", "+e[6]+", "+e[7]+", "+e[8]+")"}function Due(e){return Math.sqrt(e[0]**2+e[1]**2+e[2]**2+e[3]**2+e[4]**2+e[5]**2+e[6]**2+e[7]**2+e[8]**2)}function Fue(e,t,i){return e[0]=t[0]+i[0],e[1]=t[1]+i[1],e[2]=t[2]+i[2],e[3]=t[3]+i[3],e[4]=t[4]+i[4],e[5]=t[5]+i[5],e[6]=t[6]+i[6],e[7]=t[7]+i[7],e[8]=t[8]+i[8],e}function nU(e,t,i){return e[0]=t[0]-i[0],e[1]=t[1]-i[1],e[2]=t[2]-i[2],e[3]=t[3]-i[3],e[4]=t[4]-i[4],e[5]=t[5]-i[5],e[6]=t[6]-i[6],e[7]=t[7]-i[7],e[8]=t[8]-i[8],e}function zue(e,t,i){return e[0]=t[0]*i,e[1]=t[1]*i,e[2]=t[2]*i,e[3]=t[3]*i,e[4]=t[4]*i,e[5]=t[5]*i,e[6]=t[6]*i,e[7]=t[7]*i,e[8]=t[8]*i,e}function Vue(e,t,i,r){return e[0]=t[0]+i[0]*r,e[1]=t[1]+i[1]*r,e[2]=t[2]+i[2]*r,e[3]=t[3]+i[3]*r,e[4]=t[4]+i[4]*r,e[5]=t[5]+i[5]*r,e[6]=t[6]+i[6]*r,e[7]=t[7]+i[7]*r,e[8]=t[8]+i[8]*r,e}function Uue(e,t){return e[0]===t[0]&&e[1]===t[1]&&e[2]===t[2]&&e[3]===t[3]&&e[4]===t[4]&&e[5]===t[5]&&e[6]===t[6]&&e[7]===t[7]&&e[8]===t[8]}function jue(e,t){const i=e[0],r=e[1],s=e[2],n=e[3],o=e[4],a=e[5],l=e[6],u=e[7],c=e[8],d=t[0],m=t[1],y=t[2],g=t[3],_=t[4],v=t[5],b=t[6],S=t[7],$=t[8],E=Tr();return Math.abs(i-d)<=E*Math.max(1,Math.abs(i),Math.abs(d))&&Math.abs(r-m)<=E*Math.max(1,Math.abs(r),Math.abs(m))&&Math.abs(s-y)<=E*Math.max(1,Math.abs(s),Math.abs(y))&&Math.abs(n-g)<=E*Math.max(1,Math.abs(n),Math.abs(g))&&Math.abs(o-_)<=E*Math.max(1,Math.abs(o),Math.abs(_))&&Math.abs(a-v)<=E*Math.max(1,Math.abs(a),Math.abs(v))&&Math.abs(l-b)<=E*Math.max(1,Math.abs(l),Math.abs(b))&&Math.abs(u-S)<=E*Math.max(1,Math.abs(u),Math.abs(S))&&Math.abs(c-$)<=E*Math.max(1,Math.abs(c),Math.abs($))}function Gue(e){const t=Tr(),i=e[0],r=e[1],s=e[2],n=e[3],o=e[4],a=e[5],l=e[6],u=e[7],c=e[8];return Math.abs(1-(i*i+n*n+l*l))<=t&&Math.abs(1-(r*r+o*o+u*u))<=t&&Math.abs(1-(s*s+a*a+c*c))<=t}const Bue=lP,que=nU;Object.freeze(Object.defineProperty({__proto__:null,add:Fue,adjoint:$ue,copy:wue,determinant:Mue,equals:jue,exactEquals:Uue,frob:Due,fromMat2d:Aue,fromMat4:bue,fromQuat:Lue,fromRotation:Pue,fromScaling:Iue,fromTranslation:Cue,identity:rU,invert:xue,isOrthoNormal:Gue,mul:Bue,multiply:lP,multiplyScalar:zue,multiplyScalarAndAdd:Vue,normalFromMat4:Rue,normalFromMat4Legacy:kue,projection:Oue,rotate:sU,scale:Tue,scaleByVec2:Eue,set:iU,str:Nue,sub:que,subtract:nU,translate:EM,transpose:Sue},Symbol.toStringTag,{value:"Module"}));function d1(){const e=new Float32Array(9);return e[0]=1,e[4]=1,e[8]=1,e}function Hue(e){const t=new Float32Array(9);return t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3],t[4]=e[4],t[5]=e[5],t[6]=e[6],t[7]=e[7],t[8]=e[8],t}function Wue(e,t,i,r,s,n,o,a,l){const u=new Float32Array(9);return u[0]=e,u[1]=t,u[2]=i,u[3]=r,u[4]=s,u[5]=n,u[6]=o,u[7]=a,u[8]=l,u}Object.freeze(Object.defineProperty({__proto__:null,clone:Hue,create:d1,fromValues:Wue},Symbol.toStringTag,{value:"Module"}));function sg(){return new Float32Array(2)}function Zue(e){const t=new Float32Array(2);return t[0]=e[0],t[1]=e[1],t}function dh(e,t){const i=new Float32Array(2);return i[0]=e,i[1]=t,i}function oU(){return sg()}function aU(){return dh(1,1)}function lU(){return dh(1,0)}function uU(){return dh(0,1)}const Yue=oU(),Jue=aU(),Xue=lU(),Kue=uU();Object.freeze(Object.defineProperty({__proto__:null,ONES:Jue,UNIT_X:Xue,UNIT_Y:Kue,ZEROS:Yue,clone:Zue,create:sg,fromValues:dh,ones:aU,unitX:lU,unitY:uU,zeros:oU},Symbol.toStringTag,{value:"Module"}));function Que(e){return e instanceof Float32Array&&e.length>=2}function ece(e){return Array.isArray(e)&&e.length>=2}function D2(e){return Que(e)||ece(e)}var CM;const Yo=[0,0];let pa=CM=class extends ee{constructor(e){super(e),this._viewpoint2D={center:Dt(),rotation:0,scale:0,spatialReference:void 0},this.center=[0,0],this.extent=new ke,this.id=0,this.inverseTransform=zo(),this.resolution=0,this.rotation=0,this.scale=0,this.transform=zo(),this.transformNoRotation=zo(),this.displayMat3=d1(),this.displayViewMat3=d1(),this.viewMat3=d1(),this.viewMat2d=Ua(),this.worldScreenWidth=0,this.size=[0,0]}set pixelRatio(e){this._set("pixelRatio",e),this._update()}set size(e){this._set("size",e),this._update()}set viewpoint(e){if(e){const t=this._viewpoint2D,i=e.targetGeometry;t.center[0]=i.x,t.center[1]=i.y,t.rotation=e.rotation,t.scale=e.scale,t.spatialReference=i.spatialReference}this._update()}get visibleArea(){const[e,t]=this.size;return[this.toMap([0,0],0,0),this.toMap([0,0],0,t),this.toMap([0,0],e,t),this.toMap([0,0],e,0)]}copy(e){const t=this.size,i=this.viewpoint;return i&&t?(this.viewpoint=or(i,e.viewpoint),this._set("size",ap(t,e.size))):(this.viewpoint=e.viewpoint.clone(),this._set("size",[e.size[0],e.size[1]])),this._set("pixelRatio",e.pixelRatio),this}clone(){return new CM({size:this.size,viewpoint:this.viewpoint.clone(),pixelRatio:this.pixelRatio})}toMap(e,t,i){return D2(t)?tr(e,t,this.inverseTransform):(Yo[0]=t,Yo[1]=i,tr(e,Yo,this.inverseTransform))}toScreen(e,t,i){return D2(t)?tr(e,t,this.transform):(Yo[0]=t,Yo[1]=i,tr(e,Yo,this.transform))}toScreenNoRotation(e,t,i){return D2(t)?tr(e,t,this.transformNoRotation):(Yo[0]=t,Yo[1]=i,tr(e,Yo,this.transformNoRotation))}wrapMapCoordinate(e,t){ap(e,t);const[i]=t,[r]=this.center,{extent:s,spatialReference:n}=this;let{xmin:o,xmax:a}=s;if(n.isWrappable){const l=JV(n)/2;o=Math.max(o,r-l),a=Math.min(a,r+l)}return(i<o||i>a)&&(e[0]=rP(i,r,n)),e}getScreenTransform(e,t){const{center:i}=this._viewpoint2D,r=this._get("pixelRatio")||1,s=this._get("size");return oP(e,i,s,t,0,r),e}_update(){const{center:e,spatialReference:t,scale:i,rotation:r}=this._viewpoint2D,s=this._get("pixelRatio")||1,n=this._get("size"),o=new Us({targetGeometry:new he(e[0],e[1],t),scale:i,rotation:r});if(this._set("viewpoint",o),!n||!t||!i)return;this.resolution=gf(o),this.rotation=r,this.scale=i,this.spatialReference=t,ap(this.center,e);const a=n[0]!==0?2/n[0]:0,l=n[1]!==0?-2/n[1]:0;iU(this.displayMat3,a,0,0,0,l,0,-1,1,1);const u=rU(this.viewMat3),c=dh(n[0]/2,n[1]/2),d=dh(-n[0]/2,-n[1]/2),m=kC(r);EM(u,u,c),sU(u,u,m),EM(u,u,d),lP(this.displayViewMat3,this.displayMat3,u);const y=iP(this.viewMat2d,c);return vu(y,y,m),Fo(y,y,d),nue(this.extent,o,n),aP(this.transform,o,n,s),tP(this.inverseTransform,this.transform),hue(this.transformNoRotation,o,n,s),this.worldScreenWidth=due(this.spatialReference,this.resolution),this._set("id",this.id+1),this.notifyChange("visibleArea"),this}};h([f({readOnly:!0})],pa.prototype,"id",void 0),h([f({value:1,json:{write:!0}})],pa.prototype,"pixelRatio",null),h([f({json:{write:!0}})],pa.prototype,"size",null),h([f()],pa.prototype,"spatialReference",void 0),h([f({type:Us,json:{write:!0}})],pa.prototype,"viewpoint",null),h([f({readOnly:!0})],pa.prototype,"visibleArea",null),pa=CM=h([I("esri.views.2d.ViewState")],pa);const jL=pa;var PM,IM;let Pa=PM=class extends le{constructor(){super(...arguments),this.left=0,this.top=0,this.right=0,this.bottom=0}clone(){return new PM({left:this.left,top:this.top,right:this.right,bottom:this.bottom})}};h([f()],Pa.prototype,"left",void 0),h([f()],Pa.prototype,"top",void 0),h([f()],Pa.prototype,"right",void 0),h([f()],Pa.prototype,"bottom",void 0),Pa=PM=h([I("esri.views.2d.PaddedViewState.Padding")],Pa);let hd=IM=class extends jL{constructor(...e){super(...e),this.paddedViewState=new jL,this._updateContent=(()=>{const t=Dt();return()=>{const i=this._get("size"),r=this._get("padding");if(!i||!r)return;const s=this.paddedViewState;Jt(t,r.left+r.right,r.top+r.bottom),rg(t,i,t),ap(s.size,t);const n=s.viewpoint;n&&(this.viewpoint=n)}})(),this.addHandles(te((()=>[this.size,this.padding]),(()=>this._updateContent()),yu)),this.padding=new Pa,this.size=[0,0]}set padding(e){this._set("padding",e||new Pa)}set viewpoint(e){if(e){this.paddedViewState.viewpoint=e;let t=e;const i=this._get("padding");i&&(t=fue(e.clone(),e,this._get("size"),i));const{targetGeometry:r,rotation:s,scale:n}=t,{x:o,y:a,spatialReference:l}=r,u=this._viewpoint2D;u.center[0]=o,u.center[1]=a,u.rotation=s,u.scale=n,u.spatialReference=l,this._update()}}clone(){return new IM({padding:this.padding.clone(),size:this.size.slice(),viewpoint:this.paddedViewState.viewpoint.clone(),pixelRatio:this.pixelRatio})}};h([f()],hd.prototype,"paddedViewState",void 0),h([f({type:Pa})],hd.prototype,"padding",null),h([f()],hd.prototype,"viewpoint",null),hd=IM=h([I("esri.views.2d.PaddedViewState")],hd);const uP=hd;var Ji;(function(e){e[e.ANIMATING=0]="ANIMATING",e[e.INTERACTING=1]="INTERACTING",e[e.IDLE=2]="IDLE"})(Ji||(Ji={}));const cU=Symbol("Yield");let tce=class{constructor(){this._tasks=new Array,this._numPendingTasks=Wp(0),this._running=Wp(!1)}get length(){return this._tasks.length}get updating(){return this._numPendingTasks.value>0}get running(){return this._running.value}_updateRunning(){this._running.value=this._tasks.length>0}destroy(){this.cancelAll()}runTask(t){if(this.length===0)return cU;for(;!t.done&&this._process(t);)t.madeProgress()}push(t,i,r){return new Promise(((s,n)=>{this._tasks.push(new GL(s,n,t,i,r)),++this._numPendingTasks.value,this._updateRunning()})).finally((()=>--this._numPendingTasks.value))}unshift(t,i,r){return new Promise(((s,n)=>{this._tasks.unshift(new GL(s,n,t,i,r)),++this._numPendingTasks.value,this._updateRunning()})).finally((()=>--this._numPendingTasks.value))}_process(t){if(this._tasks.length===0)return!1;const i=this._tasks.shift();this._updateRunning();try{const r=js(i.signal);if(r&&!i.abortCallback)i.reject(yt());else{const s=r?i.abortCallback?.(yt()):i.callback(t);Bo(s)?s.then(i.resolve,i.reject):i.resolve(s)}}catch(r){i.reject(r)}return!0}cancelAll(){const t=yt();for(const i of this._tasks)if(i.abortCallback){const r=i.abortCallback(t);i.resolve(r)}else i.reject(t);this._tasks.length=0,this._updateRunning()}},GL=class{constructor(t,i,r,s=void 0,n=void 0){this.resolve=t,this.reject=i,this.callback=r,this.signal=s,this.abortCallback=n}},Gm=class extends le{constructor(){super(...arguments),this.SCHEDULER_LOG_SLOW_TASKS=!1,this.FEATURE_SERVICE_SNAPPING_SOURCE_TILE_TREE_SHOW_TILES=!1}};h([f()],Gm.prototype,"SCHEDULER_LOG_SLOW_TASKS",void 0),h([f()],Gm.prototype,"FEATURE_SERVICE_SNAPPING_SOURCE_TILE_TREE_SHOW_TILES",void 0),Gm=h([I("esri.views.support.debugFlags")],Gm);const ice=new Gm;function rce(){return new Rv.Scheduler}var Ee;(function(e){e.RESOURCE_CONTROLLER_IMMEDIATE="immediate",e.RESOURCE_CONTROLLER="schedule",e.SLIDE="slide",e.STREAM_DATA_LOADER="stream loader",e.ELEVATION_QUERY="elevation query",e.TERRAIN_SURFACE="terrain",e.SURFACE_GEOMETRY_UPDATES="surface geometry updates",e.LOD_RENDERER="LoD renderer",e.GRAPHICS_CORE="Graphics3D",e.I3S_CONTROLLER="I3S",e.POINT_CLOUD_LAYER="point cloud",e.FEATURE_TILE_FETCHER="feature fetcher",e.OVERLAY="overlay",e.OVERLAY_RENDERER="overlay renderer",e.STAGE="stage",e.GRAPHICS_DECONFLICTOR="graphics deconflictor",e.FILTER_VISIBILITY="Graphics3D filter visibility",e.SCALE_VISIBILITY="Graphics3D scale visibility",e.FRUSTUM_VISIBILITY="Graphics3D frustum visibility",e.POINT_OF_INTEREST_FREQUENT="POI frequent",e.POINT_OF_INTEREST_INFREQUENT="POI infrequent",e.LABELER="labeler",e.FEATURE_QUERY_ENGINE="feature query",e.FEATURE_TILE_TREE="feature tile tree",e.FEATURE_TILE_TREE_ACTIVE="fast feature tile tree",e.ELEVATION_ALIGNMENT="elevation alignment",e.ELEVATION_ALIGNMENT_SCENE="elevation alignment scene",e.TEXT_TEXTURE_ATLAS="text texture atlas",e.TEXTURE_UNLOAD="texture unload",e.LINE_OF_SIGHT_TOOL="line of sight tool",e.LINE_OF_SIGHT_TOOL_INTERACTIVE="interactive line of sight tool",e.ELEVATION_PROFILE="elevation profile",e.SNAPPING="snapping",e.SHADOW_ACCUMULATOR="shadow accumulator",e.CLOUDS_GENERATOR="clouds generator",e.MAPVIEW_FETCH_QUEUE="mapview fetch queue",e.MAPVIEW_LAYERVIEW_UPDATE="mapview layerview update",e.MAPVIEW_VECTOR_TILE_PARSING_QUEUE="mapview vector tile parsing queue",e[e.NONE=0]="NONE",e[e.TEST_PRIO=1]="TEST_PRIO"})(Ee||(Ee={}));const Es=0,BL=new Map([[Ee.RESOURCE_CONTROLLER_IMMEDIATE,Es],[Ee.RESOURCE_CONTROLLER,4],[Ee.SLIDE,Es],[Ee.STREAM_DATA_LOADER,Es],[Ee.ELEVATION_QUERY,Es],[Ee.TERRAIN_SURFACE,1],[Ee.SURFACE_GEOMETRY_UPDATES,1],[Ee.LOD_RENDERER,2],[Ee.GRAPHICS_CORE,2],[Ee.I3S_CONTROLLER,2],[Ee.POINT_CLOUD_LAYER,2],[Ee.FEATURE_TILE_FETCHER,2],[Ee.CLOUDS_GENERATOR,2],[Ee.OVERLAY,4],[Ee.OVERLAY_RENDERER,4],[Ee.STAGE,4],[Ee.GRAPHICS_DECONFLICTOR,4],[Ee.FILTER_VISIBILITY,4],[Ee.SCALE_VISIBILITY,4],[Ee.FRUSTUM_VISIBILITY,4],[Ee.POINT_OF_INTEREST_FREQUENT,6],[Ee.POINT_OF_INTEREST_INFREQUENT,30],[Ee.LABELER,8],[Ee.FEATURE_QUERY_ENGINE,8],[Ee.FEATURE_TILE_TREE,16],[Ee.FEATURE_TILE_TREE_ACTIVE,Es],[Ee.ELEVATION_ALIGNMENT,12],[Ee.ELEVATION_ALIGNMENT_SCENE,14],[Ee.TEXT_TEXTURE_ATLAS,12],[Ee.TEXTURE_UNLOAD,12],[Ee.LINE_OF_SIGHT_TOOL,16],[Ee.LINE_OF_SIGHT_TOOL_INTERACTIVE,Es],[Ee.SNAPPING,Es],[Ee.SHADOW_ACCUMULATOR,30],[Ee.MAPVIEW_FETCH_QUEUE,Es],[Ee.MAPVIEW_LAYERVIEW_UPDATE,2],[Ee.MAPVIEW_VECTOR_TILE_PARSING_QUEUE,Es]]);function qL(e){return BL.has(e)?BL.get(e):typeof e=="number"?e:1}const sce=6.5,HL=1,nce=30,oce=1e3/30,ace=100,WL=.9;var Rv,Cu;(function(e){class t{get updating(){return this._updating.value}_updatingChanged(){this._updating.value=this._tasks.some((n=>n.needsUpdate))}constructor(){this._updating=Wp(!0),this._microTaskQueued=!1,this._frameNumber=0,this.performanceInfo={total:new ly("total"),tasks:new Map},this._frameTaskTimes=new Map,this._budget=new r,this._state=Ji.INTERACTING,this._tasks=new uy,this._runQueue=new uy,this._load=0,this._idleStateCallbacks=new uy,this._idleUpdatesStartFired=!1,this._forceTask=!1,this._debug=!1,this._debugHandle=te((()=>ice.SCHEDULER_LOG_SLOW_TASKS),(n=>this._debug=n),Pt);for(const n of Object.keys(Ee))this.performanceInfo.tasks.set(Ee[n],new ly(Ee[n]))}destroy(){this._tasks.toArray().forEach((n=>n.remove())),this._tasks.clear(),St(this._debugHandle),this._microTaskQueued=!1,this._updatingChanged()}taskRunningChanged(n){this._updatingChanged(),n&&this._budget.remaining>0&&!this._microTaskQueued&&(this._microTaskQueued=!0,queueMicrotask((()=>{this._microTaskQueued&&(this._microTaskQueued=!1,this._budget.remaining>0&&this._schedule()&&this._runFrame())})))}registerTask(n,o){const a=new i(this,n,o);return this._tasks.push(a),this._updatingChanged(),this.performanceInfo.tasks.has(n)||this.performanceInfo.tasks.set(n,new ly(n)),a}registerIdleStateCallbacks(n,o){const a={idleBegin:n,idleEnd:o};this._idleStateCallbacks.push(a),this.state===Ji.IDLE&&this._idleUpdatesStartFired&&a.idleBegin();const l=this;return{remove:()=>this._removeIdleStateCallbacks(a),set idleBegin(u){l._idleUpdatesStartFired&&(a.idleEnd(),l._state===Ji.IDLE&&u()),a.idleBegin=u},set idleEnd(u){a.idleEnd=u}}}get load(){return this._load}set state(n){this._state!==n&&(this._state=n,this.state!==Ji.IDLE&&this._idleUpdatesStartFired&&(this._idleUpdatesStartFired=!1,this._idleStateCallbacks.forAll((o=>o.idleEnd()))))}get state(){return this._state}frame(n){this._startFrameTaskTimes();const o=this._updateBudget(n);if(o){const a=this._budget.now();this._runFrame(),this._recordFrameTaskTimes(this._budget.now()-a)}else this._recordFrameTaskTimes(0);return o}_updateBudget(n){this._test&&(this._test.usedBudget=0),++this._frameNumber;let o=sce,a=n.frameDuration,l=HL;switch(this.state){case Ji.IDLE:o=0,a=Math.max(ace,n.frameDuration),l=nce;break;case Ji.INTERACTING:a=Math.max(oce,n.frameDuration);case Ji.ANIMATING:}return a=a-n.elapsedFrameTime-o,this.state!==Ji.IDLE&&a<HL&&!this._forceTask?(this._forceTask=!0,!1):(a=Math.max(a,l),this._budget.reset(a),this._updateLoad(),this._schedule())}_runFrame(){switch(this._forceTask=!1,this._microTaskQueued=!1,this.state){case Ji.IDLE:this._idleUpdatesStartFired||(this._idleUpdatesStartFired=!0,this._idleStateCallbacks.forAll((n=>n.idleBegin()))),this._runIdle();break;case Ji.INTERACTING:this._runInteracting();break;default:this._runAnimating()}this._test&&(this._test.usedBudget=this._budget.elapsed)}stopFrame(){this._budget.reset(0),this._budget.madeProgress()}_removeIdleStateCallbacks(n){this._idleUpdatesStartFired&&n.idleEnd(),this._idleStateCallbacks.removeUnordered(n)}removeTask(n){this._tasks.removeUnordered(n),this._runQueue.removeUnordered(n),this._updatingChanged()}_updateTask(n){this._tasks.forAll((o=>{o.name===n&&o.setPriority(n)}))}_getState(n){if(this._runQueue.some((a=>a.name===n)))return Cu.SCHEDULED;let o=Cu.IDLE;return this._tasks.forAll((a=>{a.name===n&&a.needsUpdate&&(a.schedulePriority<=1?o=Cu.READY:o!==Cu.READY&&(o=Cu.WAITING))})),o}_getRuntime(n){let o=0;return this._tasks.forAll((a=>{a.name===n&&(o+=a.runtime)})),o}_resetRuntimes(){this._tasks.forAll((n=>n.runtime=0))}_getRunning(){const n=new Map;if(this._tasks.forAll((a=>{a.needsUpdate&&n.set(a.name,(n.get(a.name)||0)+1)})),n.size===0)return null;let o="";return n.forEach(((a,l)=>{o+=a>1?` ${a}x ${l}`:` ${l}`})),o}_runIdle(){this._run()}_runInteracting(){this._run()}_runAnimating(){this._run()}_updateLoad(){const n=this._tasks.reduce(((o,a)=>a.needsUpdate?++o:o),0);this._load=this._load*WL+n*(1-WL)}_schedule(){for(this._runQueue.filterInPlace((n=>!!n.needsUpdate||(n.schedulePriority=n.basePriority,!1))),this._tasks.forAll((n=>{n.basePriority===Es&&n.needsUpdate&&!this._runQueue.includes(n)&&n.blockFrame!==this._frameNumber&&this._runQueue.unshift(n)}));this._runQueue.length===0;){let n=!1,o=0;if(this._tasks.forAll((a=>{a.needsUpdate&&a.schedulePriority!==0&&a.basePriority!==Es&&a.blockFrame!==this._frameNumber&&(n=!0,o=Math.max(o,a.basePriority),a.schedulePriority===1?(a.schedulePriority=0,this._runQueue.push(a)):--a.schedulePriority)})),!n)return this._updatingChanged(),!1}return this._updatingChanged(),!0}_run(){do for(;this._runQueue.length>0;){const n=this._budget.now(),o=this._runQueue.pop();this._budget.resetProgress();try{o.task.runTask(this._budget)===cU&&(o.blockFrame=this._frameNumber)}catch(l){H.getLogger("esri.views.support.Scheduler").error(`Exception in task "${o.name}"`,l),o.blockFrame=this._frameNumber}!this._budget.hasProgressed&&o.blockFrame!==this._frameNumber&&o.needsUpdate&&(o.name,Ee.I3S_CONTROLLER,o.blockFrame=this._frameNumber),o.schedulePriority=o.basePriority;const a=this._budget.now()-n;if(o.runtime+=a,this._frameTaskTimes.set(o.priority,this._frameTaskTimes.get(o.priority)+a),this._budget.remaining<=0)return void this._updatingChanged()}while(this._schedule());this._updatingChanged()}_startFrameTaskTimes(){for(const n of Object.keys(Ee))this._frameTaskTimes.set(Ee[n],0)}_recordFrameTaskTimes(n){this._frameTaskTimes.forEach(((o,a)=>this.performanceInfo.tasks.get(a).push(o))),this.performanceInfo.total.push(n)}get test(){return this._test}}e.Scheduler=t;class i{get task(){return this._task.value}get updating(){return this._queue.running}constructor(n,o,a){this._scheduler=n,this.name=o,this.blockFrame=0,this.runtime=0,this._queue=new tce,this._handles=new uf,this._basePriority=qL(o),this.schedulePriority=this._basePriority,this._task=Wp(a??this._queue),this._handles.add(Yr((()=>this.task.running),(l=>n.taskRunningChanged(l))))}remove(){this.processQueue(cP),this._scheduler.removeTask(this),this.schedule=ZL.schedule,this.reschedule=ZL.reschedule,this._handles.destroy()}get basePriority(){return this._basePriority}setPriority(n){if(this.name===n)return;this.name=n;const o=qL(n);this._basePriority!==Es&&this.schedulePriority===0||(this.schedulePriority=o),this._basePriority=o}get priority(){return this.name}set priority(n){this.setPriority(n)}get needsUpdate(){return this.updating||this.task.running}schedule(n,o,a){return this._queue.push(n,o,a)}reschedule(n,o,a){return this._queue.unshift(n,o,a)}processQueue(n){return this._queue.runTask(n)}}class r{constructor(){this._begin=performance?.now()??0,this._budget=0,this._done=!1,this._progressed=!1,this._enabled=!0}run(n){return!this.done&&(n()===!0&&this.madeProgress(),!0)}get done(){return this._done}get budget(){return this._budget}madeProgress(){return this._progressed=!0,this._done=this.elapsed>=this._budget&&this._enabled,this._done}get enabled(){return this._enabled}set enabled(n){this._enabled=n}reset(n){this._begin=this.now(),this._budget=n,this.resetProgress()}get remaining(){return Math.max(this._budget-this.elapsed,0)}now(){return performance.now()}get elapsed(){return this.now()-this._begin}resetProgress(){this._progressed=!1,this._done=!1}get hasProgressed(){return this._progressed}}e.Budget=r})(Rv||(Rv={})),(function(e){e.SCHEDULED="s",e.READY="r",e.WAITING="w",e.IDLE="i"})(Cu||(Cu={}));const cP=new Rv.Budget;cP.enabled=!1;let lce=class{remove(){}processQueue(){}schedule(t,i,r){try{if(js(i)){const s=yt();return r?Promise.resolve(r(s)):Promise.reject(s)}return RS(t(cP))}catch(s){return Promise.reject(s)}}reschedule(t,i,r){return this.schedule(t,i,r)}};const ZL=new lce;let uce=class{constructor(t){this.view=t,this._stationaryHandle=null,this._frameTaskHandle=null,this._updateParameters=null,this._updateRequested=!1,this._scheduler=rce(),this._schedulerHandle=Yr((()=>this._scheduler.updating),(()=>this.requestFrame())),this.stationary=!0,this.prepare=()=>{this._updateParameters&&(this._updateParameters.state=this.view.state,this._updateParameters.stationary=this.view.stationary,this._updateParameters.pixelRatio=window.devicePixelRatio,this._updateParameters.renderingOptions=this.view.renderingOptions,this._updateParameters.targetState.copy(this.view.state),this.view.animation?.target==null||Bo(this.view.animation.target)||(this._updateParameters.targetState.viewpoint=this.view.animation.target))},this.update=i=>{if(this._updateRequested=!1,this.view?.destroyed)return;const{allLayerViews:r,graphicsView:s,labelManager:n,state:{id:o}}=this.view;r?.forEach(this._updateLayerView,this),n!=null&&(n.lastUpdateId!==o&&(n.viewChange(),n.lastUpdateId=o),n.updateRequested&&n.processUpdate(this._updateParameters)),s!=null&&(s.lastUpdateId!==o&&(s.viewChange(),s.lastUpdateId=o),s.updateRequested&&s.processUpdate(this._updateParameters)),this.view.graphicsTileStore?.setViewState(this._updateParameters.state),this.view.animation?this._scheduler.state=Ji.ANIMATING:this.view.interacting?this._scheduler.state=Ji.INTERACTING:this._scheduler.state=Ji.IDLE,this._scheduler.frame(i)||this._updateRequested||this._scheduler.state!==Ji.IDLE||this._frameTaskHandle?.pause()}}destroy(){this.stop(),this._schedulerHandle.remove(),this._scheduler.destroy()}get scheduler(){return this._scheduler}start(){if(this._frameTaskHandle)return;const t=this.view;this.stationary=t.stationary,this._updateParameters={state:t.state,targetState:new uP,pixelRatio:window.devicePixelRatio,stationary:this.stationary,renderingOptions:t.renderingOptions},this._stationaryHandle=te((()=>t.stationary),(i=>{this.stationary=i,this.requestFrame()})),this._frameTaskHandle=Np(this),this.requestUpdate()}stop(){this._frameTaskHandle&&(this._updateRequested=!1,this._stationaryHandle?.remove(),this._frameTaskHandle.remove(),this._updateParameters=this._stationaryHandle=this._frameTaskHandle=null,this.stationary=!0)}requestUpdate(){this._updateRequested||(this._updateRequested=!0,this.requestFrame())}requestFrame(){this._frameTaskHandle&&this._frameTaskHandle.resume()}_updateLayerView(t){if(!t.attached)return void this.requestUpdate();const i=this.view.state,r=t.lastUpdateId;r!=null&&(this.stationary||t.moving)||(t.moving=!0),r!==i.id&&t.viewChange(),this.stationary&&t.moving&&(t.moving=!1,t.moveEnd()),t.lastUpdateId=i.id,t.updateRequested&&t.processUpdate(this._updateParameters),"layerViews"in t&&t.layerViews?.forEach(this._updateLayerView,this)}};function cce(e,t){const{spatialReference:i}=t,r=[t.x,t.y];let s,n,o,a;const l=[0,0],u=hce(e);for(let m=0;m<u.length;m++){const y=u[m];for(let g=0;g<y.length-1;g++){PQ(l,r,y,g);const _=dw(r,l);(s==null||_<s)&&(s=_,n=[...l],o=m,a=g)}}if(s==null||!n||o==null||a==null)throw new j("nearest-coordinate:failed","Failed to find the nearest coordinate");const[c,d]=n;return{coordinate:new he({x:c,y:d,spatialReference:i}),distance:s}}function hce(e){switch(e.type){case"extent":return[[[e.xmin,e.ymin],[e.xmin,e.ymax],[e.xmax,e.ymax],[e.xmax,e.ymin],[e.xmin,e.ymin]]];case"polygon":return e.rings;case"polyline":return e.paths}}var AM;let Sc=AM=class extends Bg.NumericIdentifiableMixin(le){constructor(e){super(e),this.geometry=null,this.spatialReference=null}get normalizedGeometry(){if(this.geometry==null||!this.spatialReference)return null;if(!this.spatialReference.equals(this.geometry.spatialReference))try{return xh(this.geometry,this.spatialReference)}catch(e){return H.getLogger(this).error("#constraints.geometry","could not project the geometry to the view's spatial reference",{geometry:this.geometry,spatialReference:this.spatialReference,error:e}),null}return this.geometry}constrain(e,t){if(this.normalizedGeometry==null)return e;const i=e.targetGeometry;if(this.normalizedGeometry.type==="extent"?Ng(this.normalizedGeometry,i):sC(this.normalizedGeometry,i))return e;const{coordinate:r}=cce(this.normalizedGeometry,i);return r&&(e.targetGeometry=r),e}clone(){return new AM({geometry:this.geometry?.clone(),spatialReference:this.spatialReference?.clone()})}};h([f({constructOnly:!0})],Sc.prototype,"geometry",void 0),h([f({readOnly:!0})],Sc.prototype,"normalizedGeometry",null),h([f({constructOnly:!0})],Sc.prototype,"spatialReference",void 0),Sc=AM=h([I("esri.views.2d.constraints.GeometryConstraint")],Sc);var LM;let Bm=LM=class extends Bg.NumericIdentifiableMixin(le){constructor(){super(...arguments),this.enabled=!0,this.rotationEnabled=!0}constrain(e,t){return this.enabled&&t&&(this.rotationEnabled||(e.rotation=t.rotation)),e}clone(){return new LM({enabled:this.enabled,rotationEnabled:this.rotationEnabled})}};h([f()],Bm.prototype,"enabled",void 0),h([f()],Bm.prototype,"rotationEnabled",void 0),Bm=LM=h([I("esri.views.2d.constraints.RotationConstraint")],Bm);const hU=Bm;var kM;let Ar=kM=class extends Bg.NumericIdentifiableMixin(le){constructor(e){super(e),this._lodByScale={},this._scales=[],this.effectiveLODs=null,this.effectiveMinZoom=-1,this.effectiveMaxZoom=-1,this.effectiveMinScale=0,this.effectiveMaxScale=0,this.lods=null,this.minZoom=-1,this.maxZoom=-1,this.minScale=0,this.maxScale=0,this.snapToZoom=!0}initialize(){let e,{lods:t,minScale:i,maxScale:r,minZoom:s,maxZoom:n}=this,o=-1,a=-1,l=!1,u=!1;if(i!==0&&r!==0&&i<r&&([i,r]=[r,i]),!t?.length)return this._set("effectiveMinScale",i),void this._set("effectiveMaxScale",r);t=t.map((c=>c.clone())),t.sort(((c,d)=>d.scale-c.scale)),t.forEach(((c,d)=>c.level=d));for(const c of t)!l&&i>0&&i>=c.scale&&(o=c.level,l=!0),!u&&r>0&&r>=c.scale&&(a=e?e.level:-1,u=!0),e=c;s===-1&&(s=i===0?0:o),n===-1&&(n=r===0?t.length-1:a),s=Math.max(s,0),s=Math.min(s,t.length-1),n=Math.max(n,0),n=Math.min(n,t.length-1),s>n&&([s,n]=[n,s]),i=t[s].scale,r=t[n].scale,t.splice(0,s),t.splice(n-s+1),t.forEach(((c,d)=>{this._lodByScale[c.scale]=c,this._scales[d]=c.scale})),this._set("effectiveLODs",t),this._set("effectiveMinZoom",s),this._set("effectiveMaxZoom",n),this._set("effectiveMinScale",i),this._set("effectiveMaxScale",r)}constrain(e,t){if(t&&e.scale===t.scale)return e;const i=this.effectiveMinScale,r=this.effectiveMaxScale,s=e.targetGeometry,n=t&&t.targetGeometry,o=r!==0&&e.scale<r,a=i!==0&&e.scale>i;if(o||a){const l=a?i:r;if(t&&n){const u=(l-t.scale)/(e.scale-t.scale);s.x=n.x+(s.x-n.x)*u,s.y=n.y+(s.y-n.y)*u}e.scale=l}return this.snapToZoom&&this.effectiveLODs&&(e.scale=this._getClosestScale(e.scale)),e}fit(e){if(!this.effectiveLODs||!this.snapToZoom)return this.constrain(e,null);const t=this.scaleToZoom(e.scale),i=Math.abs(t-Math.floor(t));return e.scale=this.zoomToScale(i>.99?Math.round(t):Math.floor(t)),e}zoomToScale(e){if(!this.effectiveLODs)return 0;e-=this.effectiveMinZoom,e=Math.max(0,e);const t=this._scales;if(e<=0)return t[0];if(e>=t.length)return t[t.length-1];const i=Math.floor(e),r=Math.ceil(e);return t[i]+(e-i)*(t[r]-t[i])}scaleToZoom(e){if(!this.effectiveLODs)return-1;const t=this._scales;let i,r;if(e>=t[0])return this.effectiveMinZoom;if(e<=t[t.length-1])return this.effectiveMaxZoom;for(let s=0;s<t.length-1;s++){if(i=t[s],r=t[s+1],r===e)return s+this.effectiveMinZoom+1;if(i>e&&r<e)return s+this.effectiveMinZoom+1-(e-r)/(i-r)}return-1}snapToClosestScale(e){if(!this.effectiveLODs)return e;const t=this.scaleToZoom(e);return this.zoomToScale(Math.round(t))}snapToNextScale(e,t=.5){if(!this.effectiveLODs)return e*t;const i=Math.round(this.scaleToZoom(e));return this.zoomToScale(i+1)}snapToPreviousScale(e,t=2){if(!this.effectiveLODs)return e*t;const i=Math.round(this.scaleToZoom(e));return this.zoomToScale(i-1)}clone(){return new kM({lods:this.lods,minZoom:this.minZoom,maxZoom:this.maxZoom,minScale:this.minScale,maxScale:this.maxScale})}_getClosestScale(e){return this._lodByScale[e]||(e=this._scales.reduce(((t,i)=>Math.abs(i-e)<=Math.abs(t-e)?i:t),this._scales[0])),this._lodByScale[e].scale}};h([f({readOnly:!0})],Ar.prototype,"effectiveLODs",void 0),h([f({readOnly:!0})],Ar.prototype,"effectiveMinZoom",void 0),h([f({readOnly:!0})],Ar.prototype,"effectiveMaxZoom",void 0),h([f({readOnly:!0})],Ar.prototype,"effectiveMinScale",void 0),h([f({readOnly:!0})],Ar.prototype,"effectiveMaxScale",void 0),h([f()],Ar.prototype,"lods",void 0),h([f()],Ar.prototype,"minZoom",void 0),h([f()],Ar.prototype,"maxZoom",void 0),h([f()],Ar.prototype,"minScale",void 0),h([f()],Ar.prototype,"maxScale",void 0),h([f()],Ar.prototype,"snapToZoom",void 0),Ar=kM=h([I("esri.views.2d.constraints.ZoomConstraint")],Ar);const dU=Ar,dce={base:null,key:"type",typeMap:{extent:ke,polygon:mt}};let jt=class extends le{constructor(t){super(t),this.lods=null,this.minScale=0,this.maxScale=0,this.minZoom=-1,this.maxZoom=-1,this.rotationEnabled=!0,this.snapToZoom=!0,this.customConstraints=new ne}destroy(){this.view=null}get effectiveLODs(){return this._zoom.effectiveLODs}get effectiveMinScale(){return this._zoom.effectiveMinScale}get effectiveMaxScale(){return this._zoom.effectiveMaxScale}get effectiveMinZoom(){return this._zoom.effectiveMinZoom}get effectiveMaxZoom(){return this._zoom.effectiveMaxZoom}set geometry(t){t?this._set("geometry",t):this._set("geometry",null)}get version(){return`${this._zoom?.uid}/${this._rotation?.uid}/${this._geometry?.uid}`}get _geometry(){const t=this._get("_geometry");return t&&this.geometry===t.geometry&&this.view?.constraintsInfo.spatialReference===t.spatialReference?t:new Sc({geometry:this.geometry,spatialReference:this.view?.constraintsInfo.spatialReference})}get _rotation(){return new hU({rotationEnabled:this.rotationEnabled})}get _zoom(){const t=this._get("_zoom"),i=this.lods||this.view?.constraintsInfo.lods,r=this.minZoom,s=this.maxZoom,n=this.minScale,o=this.maxScale,a=this.snapToZoom;return t&&t.lods===i&&t.minZoom===r&&t.maxZoom===s&&t.minScale===n&&t.maxScale===o&&t.snapToZoom===a?t:new dU({lods:i,minZoom:r,maxZoom:s,minScale:n,maxScale:o,snapToZoom:a})}canZoomInTo(t){const i=this.effectiveMaxScale;return i===0||t>=i}canZoomOutTo(t){const i=this.effectiveMinScale;return i===0||t<=i}constrain(t,i){return this._zoom.constrain(t,i),this._rotation.constrain(t,i),this._geometry.constrain(t,i),this.customConstraints.forEach((r=>r.constrain(t,i))),t}constrainByGeometry(t){return this._geometry.constrain(t),this.customConstraints.forEach((i=>i.applyPanConstraint?.(t))),t}fit(t){return this._zoom.fit(t)}zoomToScale(t){return this._zoom.zoomToScale(t)}scaleToZoom(t){return this._zoom.scaleToZoom(t)}snapScale(t){return this._zoom.snapToClosestScale(t)}snapToNextScale(t){return this._zoom.snapToNextScale(t)}snapToPreviousScale(t){return this._zoom.snapToPreviousScale(t)}};h([f({readOnly:!0})],jt.prototype,"effectiveLODs",null),h([f({readOnly:!0})],jt.prototype,"effectiveMinScale",null),h([f({readOnly:!0})],jt.prototype,"effectiveMaxScale",null),h([f({readOnly:!0})],jt.prototype,"effectiveMinZoom",null),h([f({readOnly:!0})],jt.prototype,"effectiveMaxZoom",null),h([f({types:dce,value:null})],jt.prototype,"geometry",null),h([f({type:[zi]})],jt.prototype,"lods",void 0),h([f()],jt.prototype,"minScale",void 0),h([f()],jt.prototype,"maxScale",void 0),h([f()],jt.prototype,"minZoom",void 0),h([f()],jt.prototype,"maxZoom",void 0),h([f()],jt.prototype,"rotationEnabled",void 0),h([f()],jt.prototype,"snapToZoom",void 0),h([f({type:ne})],jt.prototype,"customConstraints",void 0),h([f()],jt.prototype,"view",void 0),h([f({readOnly:!0})],jt.prototype,"version",null),h([f({type:Sc,readOnly:!0})],jt.prototype,"_geometry",null),h([f({type:hU})],jt.prototype,"_rotation",null),h([f({readOnly:!0,type:dU})],jt.prototype,"_zoom",null),jt=h([I("esri.views.2d.MapViewConstraints")],jt);const YL=jt;let Zi=class extends le{constructor(t){super(t),this.constraints=null,this.ready=!1,this.resizeAlign="center",this.addHandles([te((()=>this.constraints?.version),(i=>{this.constraints&&i&&this.ready&&(this.state.viewpoint=this.constraints.fit(this.state.paddedViewState.viewpoint))}),yu)])}get center(){if(!this.ready)return this._get("center");const{center:t,spatialReference:i}=this.state.paddedViewState;return this.state.commitProperty("id"),new he({x:t[0],y:t[1],spatialReference:i})}set center(t){if(t==null)return;if(!this.ready)return void this._set("center",t);let i;try{i=this._project(t,this.state.spatialReference)}catch(s){return void H.getLogger(this).error(new j("mapview:invalid-center","could not project the value in the view's spatial reference",{input:t,error:s}))}const r=this.viewpoint;TM(r,r,i),this.viewpoint=r}get extent(){return this.ready?(this.state.commitProperty("id"),this.state.paddedViewState.extent.clone()):this._get("extent")}set extent(t){if(t==null)return;if(!t.width||!t.height)return void H.getLogger(this).error(new j("mapview:invalid-extent","invalid extent size"));if(!this.ready)return this._set("extent",t),this._set("center",void 0),this._set("viewpoint",void 0),this._set("scale",void 0),void this._set("zoom",void 0);let i;try{i=this._project(t,this.state.spatialReference)}catch(s){return void H.getLogger(this).error(new j("mapview:invalid-extent","could not project the value in the view's spatial reference",{error:s}))}const r=this.viewpoint;oue(r,r,i,this.state.size,{constraints:this.constraints}),this.viewpoint=r}get padding(){return this.ready?this.state.padding:this._get("padding")}set padding(t){this.ready?(this.state.padding=t,this._set("padding",this.state.padding)):this._set("padding",t)}get resolution(){return this.ready?(this.state.commitProperty("id"),this.state.resolution):0}get rotation(){return this.ready?(this.state.commitProperty("id"),this.state.rotation):this._get("rotation")}set rotation(t){if(isNaN(t))return;if(!this.ready)return void this._set("rotation",t);const i=this.viewpoint;yue(i,i,t),this.viewpoint=i}get scale(){return this.ready?(this.state.commitProperty("id"),this.state.scale):this._get("scale")}set scale(t){if(!t||isNaN(t))return;if(!this.ready){this._set("scale",t),this._set("zoom",void 0);const r=this._get("extent");return void(r&&(this._set("extent",void 0),this._set("center",r.center)))}const i=this.viewpoint;UL(i,i,t),this.viewpoint=i}get viewpoint(){return this.ready?this.state.paddedViewState.viewpoint.clone():this._get("viewpoint")}set viewpoint(t){if(t==null)return;if(!this.ready)return this._set("viewpoint",t),this._set("extent",void 0),this._set("center",void 0),this._set("zoom",void 0),void this._set("scale",void 0);let i,r;try{i=this._project(t,this.state.spatialReference),!t.scale||isNaN(t.scale)?r=new j("mapview:invalid-viewpoint",`invalid scale value of ${t.scale}`):t.targetGeometry==null&&(r=new j("mapview:invalid-viewpoint","geometry not defined"))}catch(n){r=new j("mapview:invalid-viewpoint","could not project the value in the view's spatial reference",{error:n})}if(r)return void H.getLogger(this).error(r);this._scaleBeforeChangingSpatialReference=null;const s=new Us({targetGeometry:new he,scale:0,rotation:0});or(s,i),this.constraints?.constrain(s,this.state.paddedViewState.viewpoint),this.state.viewpoint=s,this._set("viewpoint",s)}get visibleArea(){return this.ready?this.state.visibleArea:null}get zoom(){return this.ready?this.constraints?.scaleToZoom(this.scale)??-1:this._get("zoom")}set zoom(t){if(!(t>=0))return;if(!this.ready){this._set("zoom",t),this._set("scale",void 0);const s=this._get("extent");return void(s&&(this._set("extent",void 0),this._set("center",s.center)))}const i=this.constraints?.zoomToScale(t)??0;if(!i)return void this._set("zoom",-1);const r=this.viewpoint;UL(r,r,i),this.viewpoint=r,this._set("zoom",this.constraints?.scaleToZoom(this.scale)??-1)}getUserStartupOptions(t){if(!t[0]&&!t[1])return{center:void 0,rotation:void 0,scale:void 0};const{padding:i,constraints:r}=this,s=this._get("center"),n=this._get("extent"),o=this._get("scale"),a=this._get("rotation"),l=this._get("viewpoint"),u=this._get("zoom"),c=u!=null&&r!=null&&r.zoomToScale(u)||void 0;let d,m,y;const g=l?.rotation,_=l?.targetGeometry;_?.type==="extent"?d=_:_?.type==="point"&&(m=_,y=l?.scale);const v=n??d;return{center:s??m??v?.center,rotation:a??g,scale:(o??c??y??(v&&fw(v,[t[0]-i.left-i.right,t[1]-i.top-i.bottom])))||void 0}}startup(t,i,r,s){const n=t.targetGeometry;try{this._project(t,r)}catch(o){H.getLogger(this).warn(new Bs("mapview:startup-projection-error","projection of initial viewpoint to the view's spatial reference, defaulting to the initial viewpoint.",{center:n.toJSON(),spatialReference:r,error:o})),t.targetGeometry=s||new he({x:0,y:0,spatialReference:r})}this.constraints?.fit(t),this._set("state",new uP({padding:this.padding,size:i,viewpoint:t})),this._set("ready",!0)}teardown(){this._set("ready",!1);const{center:[t,i],spatialReference:r,rotation:s,scale:n}=this.state.paddedViewState,o=new he({x:t,y:i,spatialReference:r});this._set("viewpoint",null),this._set("extent",null),this._set("center",o),this._set("zoom",-1),this._set("rotation",s),this._set("scale",n),this._set("state",null)}changeSpatialReference(t){const i=this.state.paddedViewState.clone();if(this._scaleBeforeChangingSpatialReference==null)this._scaleBeforeChangingSpatialReference=i.scale;else{const l=i.viewpoint.clone();l.scale=this._scaleBeforeChangingSpatialReference,i.viewpoint=l}const r=i.clone(),[s,n]=i.center;let o=null;try{o=this._project(new he({x:s,y:n,spatialReference:i.spatialReference}),t)}catch(l){QE()||H.getLogger(this).warn(new Bs("mapview:spatial-reference-change","could not project the view's center to the new spatial reference",{center:o?.toJSON(),spatialReference:t,error:l}))}o||(o=new he({x:0,y:0,spatialReference:t}));const a=TM(new Us({targetGeometry:new he,scale:0,rotation:0}),i.viewpoint,o);r.viewpoint=a;try{const u=[i.size[0]/2,i.size[1]/2],c=[u[0]+20,u[1]],d=i.toMap([0,0],c),{x:m,y}=this._project(new he({x:d[0],y:d[1],spatialReference:i.spatialReference}),t);d[0]=m,d[1]=y,r.toScreen(d,d);const g=pue(u,d,c),_=Math.hypot(d[0]-u[0],d[1]-u[1])/20;!Number.isFinite(_)||Math.abs(_)>4?(a.rotation=0,a.targetGeometry=new he({x:0,y:0,spatialReference:t})):(a.scale*=_,a.scale>N("mapview-srswitch-adjust-rotation-scale-threshold")?a.rotation=0:a.rotation+=Number.isFinite(g)?g:0)}catch{}this._get("constraints")?.constrain(a,void 0),this._get("state").viewpoint=a}resize(t,i){if(!this.ready)return;const r=this.state;let s=this.state.paddedViewState.viewpoint;const n=this.state.paddedViewState.size.slice();r.size=[t,i],mue(s,s,n,this.state.paddedViewState.size,this.resizeAlign),s=this.constraints?.constrain(s,void 0)??s,this.state.viewpoint=s}toMap(t){if(!this.ready)return null;const i=[0,0],[r,s]=this.state.toMap(i,[t.x,t.y]),n=this.state.spatialReference;return new he({x:r,y:s,spatialReference:n})}toScreen(t,i){if(!this.ready)return null;const r=this._project(t,this.state.spatialReference),s=[r.x,r.y];return i?.pickClosestTarget===!1||this.state.paddedViewState.wrapMapCoordinate(s,s),this.state.toScreen(s,s),ei(s[0],s[1])}_project(t,i){const r=t?.targetGeometry||t;if(!i)return t;if(!r)return null;if(i.imageCoordinateSystem||r.spatialReference?.imageCoordinateSystem||ci(i,r.spatialReference))return t;const s=xh(r,i);if(!s)throw new j("mapview:projection-not-possible","projecting input geometry to target spatial reference returned a null value",{geometry:r,spatialReference:i});return pce(t)?(t.targetGeometry=s,t):s}};function pce(e){return e?.declaredClass==="esri.Viewpoint"}h([f({type:he})],Zi.prototype,"center",null),h([f()],Zi.prototype,"constraints",void 0),h([f({type:ke})],Zi.prototype,"extent",null),h([f({value:{top:0,right:0,bottom:0,left:0},cast:e=>({top:0,right:0,bottom:0,left:0,...e})})],Zi.prototype,"padding",null),h([f()],Zi.prototype,"ready",void 0),h([f()],Zi.prototype,"resizeAlign",void 0),h([f({readOnly:!0})],Zi.prototype,"resolution",null),h([f({type:Number})],Zi.prototype,"rotation",null),h([f({type:Number})],Zi.prototype,"scale",null),h([f({readOnly:!0})],Zi.prototype,"state",void 0),h([f({type:Us})],Zi.prototype,"viewpoint",null),h([f({readOnly:!0})],Zi.prototype,"visibleArea",null),h([f()],Zi.prototype,"zoom",null),Zi=h([I("esri.views.2d.ViewStateManager")],Zi);const JL=160;let qm=class extends le{constructor(){super(...arguments),this._timer=void 0}get stationary(){return!this._timer}flip(){this._timestamp=performance.now(),this._timer==null&&(this._timer=setInterval((()=>{performance.now()-this._timestamp>=JL&&this.clear()}),JL))}clear(){this._timer&&(clearInterval(this._timer),this._timer=void 0)}};h([f()],qm.prototype,"_timer",void 0),h([f()],qm.prototype,"stationary",null),qm=h([I("esri.views.2d.support.StationaryManager")],qm);const fce=e=>{let t=class extends e{constructor(...i){super(...i),this.fullOpacity=1,this.stateManager=new Zi({constraints:new YL({view:this})}),this.stationaryManager=new qm,this.mapViewNavigation=null,this.renderingOptions={samplingMode:"dynamic",edgeLabelsVisible:!1,labelsAnimationTime:0,labelCollisionsEnabled:!1},this.frameTask=new uce(this),this.viewEvents=new fV(this),this.padding={top:0,right:0,bottom:0,left:0},this.addHandles([te((()=>this.viewpoint),(()=>this.stationaryManager.flip()),yu)])}get constraintsInfo(){return{lods:null,spatialReference:null}}get extent(){return this.stateManager?.extent??null}set extent(i){this.stateManager.extent=i}get state(){return this.stateManager.state}get interacting(){return!1}get stationary(){return!this.animation&&this.stationaryManager.stationary}set animation(i){const r=this._get("animation");if(i===r)return;if(r&&r.stop(),i!==this.animationManager.animation&&this.animationManager.stop(),!i||i.isFulfilled())return void this._set("animation",null);this._set("animation",i);const s=()=>{this.destroyed||i===this._get("animation")&&(this._set("animation",null),this.frameTask?.requestFrame())};i.when(s,s)}get constraints(){return this.stateManager?.constraints}set constraints(i){i.view=this;const r=this.stateManager.constraints;this.stateManager.constraints=i,r?.destroy()}get padding(){return this.stateManager?.padding}set padding(i){this.stateManager&&(this.stateManager.padding=i)}get resizeAlign(){return this.stateManager.resizeAlign}set resizeAlign(i){this.stateManager.resizeAlign=i}get rotation(){return this.stateManager.rotation??0}set rotation(i){const{rotationEnabled:r}=this.constraints;this.constraints.rotationEnabled=!0,this.stateManager.rotation=i,this.constraints.rotationEnabled=r}get viewpoint(){return this.stateManager.viewpoint??null}set viewpoint(i){this.stateManager.viewpoint=i,this.frameTask.requestFrame()}};return h([f({readOnly:!0})],t.prototype,"animationManager",void 0),h([f({readOnly:!0})],t.prototype,"fullOpacity",void 0),h([f()],t.prototype,"stateManager",void 0),h([f()],t.prototype,"constraintsInfo",null),h([f()],t.prototype,"extent",null),h([f({readOnly:!0})],t.prototype,"state",null),h([f({readOnly:!0})],t.prototype,"mapViewNavigation",void 0),h([f()],t.prototype,"renderingOptions",void 0),h([f({readOnly:!0})],t.prototype,"interacting",null),h([f()],t.prototype,"stationary",null),h([f()],t.prototype,"animation",null),h([f({type:YL})],t.prototype,"constraints",null),h([f()],t.prototype,"padding",null),h([f()],t.prototype,"resizeAlign",null),h([f()],t.prototype,"rotation",null),h([f({readOnly:!0})],t.prototype,"viewEvents",void 0),h([f({type:Us})],t.prototype,"viewpoint",null),t=h([I("esri.views.Viewport2DBaseMixin")],t),t};let El=class extends Xl{constructor(t){super(t),this.state="running",this.target=null,this._resolver=null}initialize(){this._resolver=Gs(),this.addResolvingPromise(this._resolver.promise)}get done(){return this.state==="finished"||this.state==="stopped"}stop(){this.state!=="stopped"&&this.state!=="finished"&&(this._set("state","stopped"),this._resolver?.reject(new j("view:animation-stopped","ViewAnimation stopped")))}finish(){this.state!=="stopped"&&this.state!=="finished"&&(this._set("state","finished"),this._resolver?.resolve())}update(t,i){i||(i=Bo(t)?"waiting-for-target":"running"),this._set("target",t),this._set("state",i)}};h([f({readOnly:!0})],El.prototype,"done",null),h([f({readOnly:!0,type:String})],El.prototype,"state",void 0),h([f()],El.prototype,"target",void 0),El=h([I("esri.views.ViewAnimation")],El),(function(e){e.State={RUNNING:"running",STOPPED:"stopped",FINISHED:"finished",WAITING_FOR_TARGET:"waiting-for-target"}})(El||(El={}));const RM=El;let p1=class extends le{constructor(t){super(t),this._gotoTask=null}destroy(){this._gotoTask=null}async goTo(t,i){if(!t)return void H.getLogger(this).error("#goTo()","target cannot be null or undefined");const r=new RM;this.view.animation=r,await Vg((()=>this.view.ready),i);const s={...i,animate:i?.animate??!bV(),animationMode:i?.animationMode??"auto"},{extent:n,spatialReference:o,size:a,viewpoint:l,constraints:u,padding:c,allLayerViews:d}=this.view,m=rue(t,{extent:n,spatialReference:o,size:a,viewpoint:l,constraints:u,padding:c,allLayerViews:d,pickClosestTarget:i?.pickClosestTarget??!0});return r?.update(m),this._gotoTask={},s.animate?this._gotoAnimated(m,s):this._gotoImmediate(m,s)}_gotoImmediate(t,i){const r=this._gotoTask,s=this.view.animation,n=t.then((o=>{if(It(i),r!==this._gotoTask)throw new j("view:goto-interrupted","Goto was interrupted");this.view.viewpoint=s.target=o,s.finish()}));return this._cancellableGoTo(r,s,n,i)}_gotoAnimated(t,i){const r=this._gotoTask,s=this.view.animation;if(!s)return Promise.resolve();const n=t.then((o=>{if(It(i),r!==this._gotoTask)throw new j("view:goto-interrupted","Goto was interrupted");return s.update(o),this.view.animationManager.animate(s,this.view.viewpoint,i),s.when().then((()=>{}),(()=>{}))}));return this._cancellableGoTo(r,s,n,i)}_cancellableGoTo(t,i,r,s){const n=()=>t===this._gotoTask;return fH(r,s).finally((()=>{n()&&(i.done||i.stop())}))}};h([f({constructOnly:!0})],p1.prototype,"view",void 0),p1=h([I("esri.views.2d.GoToManager")],p1);function pU(e,t){switch(t){case"primary":return e.pointerType==="touch"||e.button===0;case"secondary":return e.pointerType!=="touch"&&e.button===2;case"tertiary":return e.pointerType!=="touch"&&e.button===1}}function fU(e,t){return t.some((i=>pU(e,i)))}function XL(e,{dragPrimary:t,dragSecondary:i,dragTertiary:r}){return[{key:"primary",value:t},{key:"secondary",value:i},{key:"tertiary",value:r}].filter((s=>s.value===e)).map((s=>s.key))}let KL=class extends _i{constructor(t,i){super(!0),this._view=t,this.registerIncoming("double-click",i,(r=>this._handleDoubleClick(r,i)))}_handleDoubleClick(t,i){pU(t.data,"primary")&&(t.stopPropagation(),i?this._view.mapViewNavigation.zoomOut([t.data.x,t.data.y]):this._view.mapViewNavigation.zoomIn([t.data.x,t.data.y]))}},mce=class extends _i{constructor(t,i,r){super(!0),this.view=t,this.pointerType=i,this.registerIncoming("double-tap-drag",r,(s=>this._handleDoubleTapDrag(s)))}_handleDoubleTapDrag(t){const{data:i}=t,{pointerType:r}=i;if(r!==this.pointerType)return;t.stopPropagation();const{action:s,delta:n}=i,{view:o}=this,{mapViewNavigation:a}=o;switch(s){case"begin":{const{scale:l}=o;this._startScale=l,this._currentScale=l,this._previousDelta=n,a.begin();break}case"update":{if(this._previousDelta.y===n.y)return;this._previousDelta=n;const l=1.015**n.y,u=this._startScale*l,c=u/this._currentScale;a.setViewpointImmediate(c),this._currentScale=u;break}case"end":{const{constraints:l}=o,{effectiveLODs:u,snapToZoom:c}=l;if(!c||!u)return void a.end();const d=l.snapScale(this._currentScale),m=(n.y>0?Math.max(d,l.snapToPreviousScale(this._startScale)):Math.min(d,l.snapToNextScale(this._startScale)))/this._currentScale;a.zoom(m).then((()=>{a.end()}));break}}}},yw=class{constructor(t){this._callbacks=t,this._currentCount=0,this._callbacks.condition||(this._callbacks.condition=()=>!0)}handle(t){const i=t.data,r=i.pointers.size;switch(i.action){case"start":this._currentCount=r,this._emitStart(t);break;case"added":this._emitEnd(this._previousEvent),this._currentCount=r,this._emitStart(t);break;case"update":this._emitUpdate(t);break;case"removed":this._startEvent&&this._emitEnd(this._previousEvent),this._currentCount=r,this._emitStart(t);break;case"end":this._emitEnd(t),this._currentCount=0}this._previousEvent=t}_emitStart(t){this._startEvent=t,this._callbacks.condition?.(this._currentCount,t)&&this._callbacks.start(this._currentCount,t,this._startEvent)}_emitUpdate(t){this._callbacks.condition?.(this._currentCount,t)&&this._callbacks.update(this._currentCount,t,this._startEvent)}_emitEnd(t){this._callbacks.condition?.(this._currentCount,t)&&this._callbacks.end(this._currentCount,t,this._startEvent),this._startEvent=null}},yce=class extends _i{constructor(t,i,r){super(!0),this.view=t,this.pointerActions=i,this.registerIncoming("drag",r,(s=>this._handleDrag(s))),this.registerIncoming("pointer-down",(()=>this.stopMomentumNavigation()))}onInstall(t){super.onInstall(t),this._dragEventSeparator=new yw({start:(i,r)=>{this.view.mapViewNavigation.pan.begin(this.view,r.data),r.stopPropagation()},update:(i,r)=>{this.view.mapViewNavigation.pan.update(this.view,r.data),r.stopPropagation()},end:(i,r)=>{this.view.mapViewNavigation.pan.end(this.view,r.data),r.stopPropagation()},condition:(i,r)=>i===1&&fU(r.data,this.pointerActions)})}_handleDrag(t){const i=this.view.mapViewNavigation;i.pinch.zoomMomentum||i.pinch.rotateMomentum?this.stopMomentumNavigation():this._dragEventSeparator.handle(t)}stopMomentumNavigation(){this.view.mapViewNavigation.pan.stopMomentumNavigation()}},gce=class extends _i{constructor(t,i,r){super(!0),this._view=t,this.pointerActions=i;const s=this._view.mapViewNavigation;this._dragEventSeparator=new yw({start:(n,o)=>{s.rotate.begin(this._view,o.data),o.stopPropagation()},update:(n,o)=>{s.rotate.update(this._view,o.data),o.stopPropagation()},end:(n,o)=>{s.rotate.end(),o.stopPropagation()},condition:(n,o)=>n===1&&fU(o.data,this.pointerActions)}),this.registerIncoming("drag",r,(n=>this._dragEventSeparator.handle(n)))}};function mU(e){const t=e[0],i=e[1],r=e[2];return Math.sqrt(t*t+i*i+r*r)}function _ce(e,t){return e[0]=t[0],e[1]=t[1],e[2]=t[2],e}function vce(e,t,i,r){return e[0]=t,e[1]=i,e[2]=r,e}function bce(e,t,i){return e[0]=t[0]+i[0],e[1]=t[1]+i[1],e[2]=t[2]+i[2],e}function yU(e,t,i){return e[0]=t[0]-i[0],e[1]=t[1]-i[1],e[2]=t[2]-i[2],e}function gU(e,t,i){return e[0]=t[0]*i[0],e[1]=t[1]*i[1],e[2]=t[2]*i[2],e}function _U(e,t,i){return e[0]=t[0]/i[0],e[1]=t[1]/i[1],e[2]=t[2]/i[2],e}function wce(e,t){return e[0]=Math.ceil(t[0]),e[1]=Math.ceil(t[1]),e[2]=Math.ceil(t[2]),e}function Sce(e,t){return e[0]=Math.floor(t[0]),e[1]=Math.floor(t[1]),e[2]=Math.floor(t[2]),e}function xce(e,t){return e[0]=Math.abs(t[0]),e[1]=Math.abs(t[1]),e[2]=Math.abs(t[2]),e}function $ce(e,t){return e[0]=Math.sign(t[0]),e[1]=Math.sign(t[1]),e[2]=Math.sign(t[2]),e}function Mce(e,t,i){return e[0]=Math.min(t[0],i[0]),e[1]=Math.min(t[1],i[1]),e[2]=Math.min(t[2],i[2]),e}function Tce(e,t,i){return e[0]=Math.max(t[0],i[0]),e[1]=Math.max(t[1],i[1]),e[2]=Math.max(t[2],i[2]),e}function Ece(e,t=0,i=1){return e[0]=Math.min(Math.max(e[0],t),i),e[1]=Math.min(Math.max(e[1],t),i),e[2]=Math.min(Math.max(e[2],t),i),e}function Cce(e,t){return e[0]=Math.round(t[0]),e[1]=Math.round(t[1]),e[2]=Math.round(t[2]),e}function vU(e,t,i){return e[0]=t[0]*i,e[1]=t[1]*i,e[2]=t[2]*i,e}function Pce(e,t,i,r){return e[0]=t[0]+i[0]*r,e[1]=t[1]+i[1]*r,e[2]=t[2]+i[2]*r,e}function bU(e,t){const i=t[0]-e[0],r=t[1]-e[1],s=t[2]-e[2];return Math.sqrt(i*i+r*r+s*s)}function wU(e,t){const i=t[0]-e[0],r=t[1]-e[1],s=t[2]-e[2];return i*i+r*r+s*s}function SU(e){const t=e[0],i=e[1],r=e[2];return t*t+i*i+r*r}function Ice(e,t){return e[0]=-t[0],e[1]=-t[1],e[2]=-t[2],e}function Ace(e,t){return e[0]=1/t[0],e[1]=1/t[1],e[2]=1/t[2],e}function OM(e,t){const i=t[0],r=t[1],s=t[2];let n=i*i+r*r+s*s;return n>0&&(n=1/Math.sqrt(n),e[0]=t[0]*n,e[1]=t[1]*n,e[2]=t[2]*n),e}function xU(e,t){return e[0]*t[0]+e[1]*t[1]+e[2]*t[2]}function Lce(e,t,i){const r=t[0],s=t[1],n=t[2],o=i[0],a=i[1],l=i[2];return e[0]=s*l-n*a,e[1]=n*o-r*l,e[2]=r*a-s*o,e}function kce(e,t,i){const r=t[0],s=t[1],n=t[2],o=i[0],a=i[1],l=i[2],u=s*l-n*a,c=n*o-r*l,d=r*a-s*o,m=Math.sqrt(u*u+c*c+d*d);return e[0]=u/m,e[1]=c/m,e[2]=d/m,e}function Rce(e,t,i,r){const s=t[0],n=t[1],o=t[2];return e[0]=s+r*(i[0]-s),e[1]=n+r*(i[1]-n),e[2]=o+r*(i[2]-o),e}function Oce(e,t,i,r,s,n){const o=n*n,a=o*(2*n-3)+1,l=o*(n-2)+n,u=o*(n-1),c=o*(3-2*n);return e[0]=t[0]*a+i[0]*l+r[0]*u+s[0]*c,e[1]=t[1]*a+i[1]*l+r[1]*u+s[1]*c,e[2]=t[2]*a+i[2]*l+r[2]*u+s[2]*c,e}function Nce(e,t,i,r,s,n){const o=1-n,a=o*o,l=n*n,u=a*o,c=3*n*a,d=3*l*o,m=l*n;return e[0]=t[0]*u+i[0]*c+r[0]*d+s[0]*m,e[1]=t[1]*u+i[1]*c+r[1]*d+s[1]*m,e[2]=t[2]*u+i[2]*c+r[2]*d+s[2]*m,e}function Dce(e,t=1){const i=iw,r=2*i()*Math.PI,s=2*i()-1,n=Math.sqrt(1-s*s)*t;return e[0]=Math.cos(r)*n,e[1]=Math.sin(r)*n,e[2]=s*t,e}function Fce(e,t,i){const r=t[0],s=t[1],n=t[2];return e[0]=i[0]*r+i[4]*s+i[8]*n+i[12],e[1]=i[1]*r+i[5]*s+i[9]*n+i[13],e[2]=i[2]*r+i[6]*s+i[10]*n+i[14],e}function zce(e,t,i){const r=t[0],s=t[1],n=t[2];return e[0]=r*i[0]+s*i[3]+n*i[6],e[1]=r*i[1]+s*i[4]+n*i[7],e[2]=r*i[2]+s*i[5]+n*i[8],e}function Vce(e,t,i){const r=i[0],s=i[1],n=i[2],o=i[3],a=t[0],l=t[1],u=t[2],c=s*u-n*l,d=n*a-r*u,m=r*l-s*a,y=s*m-n*d,g=n*c-r*m,_=r*d-s*c,v=2*o;return e[0]=a+c*v+2*y,e[1]=l+d*v+2*g,e[2]=u+m*v+2*_,e}function Uce(e,t,i,r){const s=[],n=[];return s[0]=t[0]-i[0],s[1]=t[1]-i[1],s[2]=t[2]-i[2],n[0]=s[0],n[1]=s[1]*Math.cos(r)-s[2]*Math.sin(r),n[2]=s[1]*Math.sin(r)+s[2]*Math.cos(r),e[0]=n[0]+i[0],e[1]=n[1]+i[1],e[2]=n[2]+i[2],e}function jce(e,t,i,r){const s=[],n=[];return s[0]=t[0]-i[0],s[1]=t[1]-i[1],s[2]=t[2]-i[2],n[0]=s[2]*Math.sin(r)+s[0]*Math.cos(r),n[1]=s[1],n[2]=s[2]*Math.cos(r)-s[0]*Math.sin(r),e[0]=n[0]+i[0],e[1]=n[1]+i[1],e[2]=n[2]+i[2],e}function Gce(e,t,i,r){const s=[],n=[];return s[0]=t[0]-i[0],s[1]=t[1]-i[1],s[2]=t[2]-i[2],n[0]=s[0]*Math.cos(r)-s[1]*Math.sin(r),n[1]=s[0]*Math.sin(r)+s[1]*Math.cos(r),n[2]=s[2],e[0]=n[0]+i[0],e[1]=n[1]+i[1],e[2]=n[2]+i[2],e}function Bce(e,t){OM(QL,e),OM(ek,t);const i=xU(QL,ek);return i>1?0:i<-1?Math.PI:Math.acos(i)}const QL=Su(),ek=Su();function qce(e){return"vec3("+e[0]+", "+e[1]+", "+e[2]+")"}function Hce(e,t){return e[0]===t[0]&&e[1]===t[1]&&e[2]===t[2]}function Wce(e,t){if(e===t)return!0;const i=e[0],r=e[1],s=e[2],n=t[0],o=t[1],a=t[2],l=Tr();return Math.abs(i-n)<=l*Math.max(1,Math.abs(i),Math.abs(n))&&Math.abs(r-o)<=l*Math.max(1,Math.abs(r),Math.abs(o))&&Math.abs(s-a)<=l*Math.max(1,Math.abs(s),Math.abs(a))}function Zce(e,t,i){const r=i[0]-t[0],s=i[1]-t[1],n=i[2]-t[2];let o=r*r+s*s+n*n;return o>0?(o=1/Math.sqrt(o),e[0]=r*o,e[1]=s*o,e[2]=n*o,e):(e[0]=0,e[1]=0,e[2]=0,e)}const Yce=yU,Jce=gU,Xce=_U,Kce=bU,Qce=wU,ehe=mU,the=SU;Object.freeze(Object.defineProperty({__proto__:null,abs:xce,add:bce,angle:Bce,bezier:Nce,ceil:wce,clamp:Ece,copy:_ce,cross:Lce,crossAndNormalize:kce,direction:Zce,dist:Kce,distance:bU,div:Xce,divide:_U,dot:xU,equals:Wce,exactEquals:Hce,floor:Sce,hermite:Oce,inverse:Ace,len:ehe,length:mU,lerp:Rce,max:Tce,min:Mce,mul:Jce,multiply:gU,negate:Ice,normalize:OM,random:Dce,rotateX:Uce,rotateY:jce,rotateZ:Gce,round:Cce,scale:vU,scaleAndAdd:Pce,set:vce,sign:$ce,sqrDist:Qce,sqrLen:the,squaredDistance:wU,squaredLength:SU,str:qce,sub:Yce,subtract:yU,transformMat3:zce,transformMat4:Fce,transformQuat:Vce},Symbol.toStringTag,{value:"Module"}));function sn(e){let t=e*e;return e<0&&(t*=-1),t}function ihe(e){return e.translation[0]=0,e.translation[1]=0,e.translation[2]=0,e.heading=0,e.tilt=0,e}function rhe(e,t,i){const r=i,s=e.state,n=e.device,o=t.tiltDirection==="forward-down"?1:-1,a=1;return n.deviceType==="standard"?(r.translation[0]=sn(s.axes[0]),r.translation[1]=sn(s.axes[1]),r.translation[2]=sn(s.buttons[7])-sn(s.buttons[6]),r.heading=sn(s.axes[2]),r.tilt=sn(s.axes[3])):n.deviceType==="spacemouse"&&(r.translation[0]=1.2*sn(s.axes[0]),r.translation[1]=1.2*sn(s.axes[1]),r.translation[2]=2*-sn(s.axes[2]),r.heading=1.2*sn(s.axes[5]),r.tilt=1.2*sn(s.axes[3])),r.tilt*=o,vU(r.translation,r.translation,a),r}function she(e){return e.translation[0]===0&&e.translation[1]===0&&e.translation[2]===0&&e.heading===0&&e.tilt===0&&e.zoom===0}let nhe=class extends _i{constructor(t){super(!0),this._view=t,this._frameTask=null,this._watchHandles=new uf,this._currentDevice=null,this._transformation={translation:[0,0,0],heading:0,tilt:0,zoom:0},this._handle=this.registerIncoming("gamepad",(i=>this._handleGamePadEvent(i))),this._handle.pause()}onInstall(t){super.onInstall(t),this._watchHandles.add([te((()=>this._view.navigation.gamepad?.enabled),(i=>{i?(this._handle.resume(),this._frameTask||(this._frameTask=Np({update:r=>this._frameUpdate(r.deltaTime)}))):(this._handle.pause(),this._frameTask&&(this._frameTask.remove(),this._frameTask=null))}),Pt)])}onUninstall(){this._watchHandles.removeAll(),this._frameTask&&(this._frameTask.remove(),this._frameTask=null),super.onUninstall()}_handleGamePadEvent(t){const i=this._view.navigation.gamepad.device;i&&t.data.device!==i||this._currentDevice&&this._currentDevice!==t.data.device||(t.data.action==="end"?(this._currentDevice=null,ihe(this._transformation)):(this._currentDevice=t.data.device,rhe(t.data,this._view.navigation.gamepad,this._transformation)),this._frameTask?.resume())}_frameUpdate(t){const i=this._transformation;if(she(i))return void this._frameTask?.pause();const r=this._view.viewpoint.clone(),s=this._view.navigation.gamepad.velocityFactor,n=ahe*s*t;mw(r,r,[i.translation[0]*n,-i.translation[1]*n]);const o=1+i.translation[2]*lhe*t,a=this._view.constraints.rotationEnabled?-i.heading*ohe*t:0,l=this._view.size,u=[l[0]/2,l[1]];XV(r,r,o,a,u,l);const c=this._view.constraints.constrain(r,this._view.viewpoint);this._view.viewpoint=c}};const ohe=.06,ahe=.7,lhe=6e-4;function $U(e){const t=()=>e(document.visibilityState==="visible");return document.addEventListener("visibilitychange",t),ze((()=>document.removeEventListener("visibilitychange",t)))}let uhe=class extends _i{constructor(t,i,r){super(!0),this.view=t,this.keys=i,this._isSticky=!1,this._pressedKeys=new Set,this._timeout=void 0,this._currentDirection=void 0,this._stickyKeyDuration=200,this._handleKey=s=>{const n=this._keyMap[s.data.key];if(s.modifiers.has("Meta")||s.modifiers.has("Control"))return void this._stopMovement();if(n==null)return;s.stopPropagation(),s.preventDefault();const o=s.type==="key-down";if(this._pressedKeys[o?"add":"delete"](n),o){if(this._direction===n)return;this._direction=n,this._isSticky=!1,this._setTimeout((()=>{this._isSticky&&this._handlePopKey()}))}else{const a=this._timeout===void 0,l=this._pressedKeys.size>0;a||l?this._handlePopKey():this._isSticky=!0}},this._handlePopKey=()=>{this._direction=Array.from(this._pressedKeys).pop(),this._direction==null&&this._stopMovement()},this._stopMovement=()=>{this._isSticky=!1,this._direction=void 0,this._pressedKeys.clear(),this._setTimeout(void 0)},this._keyMap={[i.left]:"left",[i.right]:"right",[i.up]:"up",[i.down]:"down"},this.registerIncoming("key-down",r,this._handleKey),this.registerIncoming("key-up",r,this._handleKey),this.registerIncoming("blur",r,this._stopMovement),this._visibilityHandle=$U((s=>s?null:this._stopMovement()))}onUninstall(){this._stopMovement(),this._visibilityHandle?.remove()}get _direction(){return this._currentDirection}set _direction(t){const i=this._currentDirection!=null;if(t!=null){if(i||this.view.mapViewNavigation.begin(),this._currentDirection!==t)switch(t){case"left":this.view.mapViewNavigation.continuousPanLeft();break;case"right":this.view.mapViewNavigation.continuousPanRight();break;case"up":this.view.mapViewNavigation.continuousPanUp();break;case"down":this.view.mapViewNavigation.continuousPanDown()}}else i&&this.view.mapViewNavigation.stop();this._currentDirection=t}_setTimeout(t){clearTimeout(this._timeout),this._timeout=t===void 0?void 0:setTimeout((()=>{this._timeout=void 0,t()}),this._stickyKeyDuration)}},che=class extends _i{constructor(t,i,r){super(!0),this.view=t,this.keys=i,this._keyToDirection=new Map,this._pressed=!1,this._addKeysMapping(i),this.registerIncoming("key-down",r,(s=>this._handleKeyDown(s))),this.registerIncoming("key-up",r,(s=>this._handleKeyUp(s))),this.registerIncoming("blur",r,(()=>this._handleStop())),this._visibilityHandle=$U((s=>s?null:this._handleStop()))}onUninstall(){this._visibilityHandle?.remove(),this._handleStop()}_addKeysMapping(t){this._addKeyMapping(t.clockwise,"clockwise"),this._addKeyMapping(t.counterClockwise,"counterClockwise"),this._addKeyMapping(t.reset,"reset")}_addKeyMapping(t,i){for(const r of t)this._keyToDirection.set(r,i)}_handleKeyDown(t){t.data.repeat||this._handleKey(t,!0)}_handleKeyUp(t){this._handleKey(t,!1)}_handleStop(){this._pressed&&(this._pressed=!1,this.view.mapViewNavigation.stop())}_handleKey(t,i){const r=t.modifiers;if(r.size>0&&!r.has("Shift")||!this.view.constraints.rotationEnabled)return;const s=this._keyToDirection.get(t.data.key);if(this._pressed=s!=null,this._pressed){if(t.preventDefault(),i)switch(this.view.mapViewNavigation.begin(),s){case"clockwise":this.view.mapViewNavigation.continuousRotateClockwise();break;case"counterClockwise":this.view.mapViewNavigation.continuousRotateCounterclockwise();break;case"reset":this.view.mapViewNavigation.resetRotation()}else this._pressed=!1,this.view.mapViewNavigation.stop();t.stopPropagation()}}};var Od;(function(e){e[e.IN=0]="IN",e[e.OUT=1]="OUT"})(Od||(Od={}));let hhe=class extends _i{constructor(t,i,r){super(!0),this.view=t,this.keys=i,this._keysToZoomAction={},this.registerIncoming("key-down",r,(s=>this._handleKeyDown(s))),i.zoomIn.forEach((s=>this._keysToZoomAction[s]=Od.IN)),i.zoomOut.forEach((s=>this._keysToZoomAction[s]=Od.OUT))}_handleKeyDown(t){this._handleKey(t)}_handleKey(t){const i=t.modifiers;if(i.size>0&&!i.has("Shift"))return;const{key:r}=t.data;if(!(r in this._keysToZoomAction))return;const s=this._keysToZoomAction[r],{mapViewNavigation:n}=this.view;let o=null;switch(s){case Od.IN:o=n.zoomIn();break;case Od.OUT:o=n.zoomOut();break;default:return}n.begin(),o.then((()=>n.end())),t.stopPropagation()}};const dhe=.6;let phe=class extends _i{constructor(t,i){super(!0),this._view=t,this._canZoom=!0,this.registerIncoming("mouse-wheel",i,(r=>this._handleMouseWheel(r)))}_handleMouseWheel(t){if(this._view.navigation.actionMap.mouseWheel!=="zoom"||(t.preventDefault(),t.stopPropagation(),!this._canZoom))return;const i=this._view.mapViewNavigation,{x:r,y:s,deltaY:n}=t.data,o=1/dhe**(1/60*n),a=i.zoom(o,[r,s]);a&&(this._canZoom=!1,a.catch((()=>{})).then((()=>{this._canZoom=!0,i.end()})))}},fhe=class extends _i{constructor(t){super(!0),this.view=t,this.registerIncoming("drag",(r=>this._handleDrag(r))),this.registerIncoming("pointer-down",(()=>this._stopMomentumNavigation()));const i=this.view.mapViewNavigation;this._dragEventSeparator=new yw({start:(r,s)=>{i.pinch.begin(this.view,s.data),s.stopPropagation()},update:(r,s)=>{i.pinch.update(this.view,s.data),s.stopPropagation()},end:(r,s)=>{i.pinch.end(this.view),s.stopPropagation()},condition:r=>r>=2})}_handleDrag(t){this._dragEventSeparator.handle(t)}_stopMomentumNavigation(){this.view.mapViewNavigation.pinch.stopMomentumNavigation()}};function tk(e){const t=e.native;return t?{buttons:t.buttons.map((i=>i.pressed?i.value||1:0)),axes:t.axes.map((i=>ghe(i,e.axisThreshold)))}:{buttons:[],axes:[]}}function mhe(e,t){if(e.axes.length!==t.axes.length||e.buttons.length!==t.buttons.length)return!1;for(let i=0;i<e.axes.length;i++)if(e.axes[i]!==t.axes[i])return!1;for(let i=0;i<e.buttons.length;i++)if(e.buttons[i]!==t.buttons[i])return!1;return!0}function yhe(e){for(let t=0;t<e.axes.length;t++)if(e.axes[t]!==0)return!1;for(let t=0;t<e.buttons.length;t++)if(e.buttons[t]!==0)return!1;return!0}function ghe(e,t){const i=Math.abs(e);return i<t?0:Math.sign(e)*(i-t)/(1-t)}let _he=class{constructor(t,i){this._element=t,this._input=i,this._hasEventListeners=!1,this._onConnectGamepad=n=>{this._connectGamepad(n.gamepad)},this._onDisconnectGamepad=n=>{const o=n.gamepad,a=o.index,l=this._inputDevices[a];l&&(this._emitGamepadEvent(o,tk(l),!1),this._inputDevices.splice(a,1),this._latestUpdate.splice(a,1),this._input.gamepad.devices.remove(l),this.ensurePollingState())},this._frameTask=null,this._latestUpdate=new Array,this._inputDevices=new Array,this._callback=null;const r="getGamepads"in window.navigator,s=window.isSecureContext;this.supported=r&&s,this.supported&&(ik((n=>this._connectGamepad(n))),window.addEventListener("gamepadconnected",this._onConnectGamepad),window.addEventListener("gamepaddisconnected",this._onDisconnectGamepad),this.ensurePollingState())}destroy(){this.hasEventListeners=!1,this.supported&&(window.removeEventListener("gamepadconnected",this._onConnectGamepad),window.removeEventListener("gamepaddisconnected",this._onDisconnectGamepad))}set hasEventListeners(t){this._hasEventListeners!==t&&(this._hasEventListeners=t,this.ensurePollingState())}get _eventsEnabled(){return this.supported&&this._inputDevices.length>0&&this._hasEventListeners}set onEvent(t){this._callback=t}_connectGamepad(t){const i=new KC(t);i.deviceType!=="unknown"&&(this._inputDevices[t.index]=i,this._input.gamepad.devices.add(i)),this.ensurePollingState()}ensurePollingState(){this._eventsEnabled?this._startPolling():this._stopPolling()}_startPolling(){this._frameTask==null&&(this._frameTask=Np({update:()=>this._readGamepadState()}))}_stopPolling(){this._frameTask!=null&&(this._frameTask.remove(),this._frameTask=null,this._latestUpdate=new Array)}_readGamepadState(){const t=document.hasFocus(),i=this._element.contains(document.activeElement),r=this._input.gamepad.enabledFocusMode==="document"&&!t||this._input.gamepad.enabledFocusMode==="view"&&!i;ik((s=>{const n=this._inputDevices[s.index];if(!n)return;const o=this._latestUpdate[s.index],a=tk(n),l=r||yhe(a);o&&(o.timestamp===s.timestamp||!o.active&&l||mhe(o.state,a))||this._emitGamepadEvent(s,a,!l)}))}_emitGamepadEvent(t,i,r){const s=this._latestUpdate[t.index],n=s&&s.active;if(!n&&!r)return;const o=!n&&r?"start":n&&r?"update":"end";this._latestUpdate[t.index]={timestamp:t.timestamp,state:i,active:r},this._callback&&this._callback({device:this._inputDevices[t.index],state:i,action:o})}};function vhe(e){if(!e||!e.connected)return!1;for(let t=0;t<e.axes.length;t++)if(isNaN(e.axes[t]))return!1;return!0}function ik(e){for(const t of navigator.getGamepads())vhe(t)&&e(t)}const rk=N("edge"),bhe=N("chrome"),whe=N("ff"),She=N("safari"),sk="esri-view-surface",Vh={touchNone:`${sk}--touch-none`,touchPan:`${sk}--touch-pan`};var Qc;let xhe=(Qc=class{constructor(t,i){this._active={},this._callback=()=>{},this._activePointerCaptures=new Set,this._keyDownState=new Set,this._eventId=1,this._browserTouchPanningEnabled=!1,this._element=t,t.getAttribute("tabindex")||t.setAttribute("tabindex","0"),this._eventHandlers={"key-down":this._handleKey,"key-up":this._handleKey,"pointer-down":this._handlePointer,"pointer-move":this._handlePointerPreventDefault,"pointer-up":this._handlePointerPreventDefault,"pointer-enter":this._handlePointer,"pointer-leave":this._handlePointer,"pointer-cancel":this._handlePointer,"mouse-wheel":this._handleMouseWheel,"pointer-capture-lost":this._handlePointerCaptureLost},this._updateTouchAction(),this._element.addEventListener("keydown",this._preventAltKeyDefault),this._gamepadSource=new _he(t,i),this._gamepadSource.onEvent=r=>this._callback("gamepad",r)}destroy(){this._callback=()=>{},this.activeEvents=null,this._activePointerCaptures.forEach((t=>this._releasePointerCaptureSafe(t))),this._activePointerCaptures.clear(),this._gamepadSource=Ot(this._gamepadSource),this._removeTouchAction(),this._element.removeEventListener("keydown",this._preventAltKeyDefault)}get browserTouchPanningEnabled(){return this._browserTouchPanningEnabled}set browserTouchPanningEnabled(t){this._browserTouchPanningEnabled=t,this._updateTouchAction(),this._updateTouchEventHandling()}set onEventReceived(t){this._callback=t}set activeEvents(t){for(const i in this._active)if(!t||!t.has(i)){const r=this._active[i];this._element.removeEventListener(F2[i],r),delete this._active[i]}t&&t.forEach((i=>{if(!this._active[i]&&F2[i]){const r=(this._eventHandlers[i]||this._handleDefault).bind(this,i);this._element.addEventListener(F2[i],r),this._active[i]=r}})),this._gamepadSource&&(this._gamepadSource.hasEventListeners=t?.has("gamepad")??!1)}setPointerCapture(t,i){i?this._setPointerCaptureSafe(t.pointerId):(this._releasePointerCaptureSafe(t.pointerId),this._activePointerCaptures.delete(t.pointerId))}_updateTouchAction(){this._element.classList.remove(this._browserTouchPanningEnabled?Vh.touchNone:Vh.touchPan),this._element.classList.add(this._browserTouchPanningEnabled?Vh.touchPan:Vh.touchNone)}_updateTouchEventHandling(){this._browserTouchPanningEnabled?this._element.addEventListener("touchmove",this._preventMultiTouchPanning):this._element.removeEventListener("touchmove",this._preventMultiTouchPanning)}_removeTouchAction(){this._element.classList.remove(Vh.touchNone),this._element.classList.remove(Vh.touchPan),this._element.removeEventListener("touchmove",this._preventMultiTouchPanning)}_setPointerCaptureSafe(t){try{this._element.setPointerCapture(t),this._activePointerCaptures.add(t)}catch{}}_releasePointerCaptureSafe(t){try{if(this._element.hasPointerCapture&&!this._element.hasPointerCapture(t))return;this._element.releasePointerCapture(t)}catch{}}_updateNormalizedPointerLikeEvent(t,i){const r=yV(this._element,t);return Qc.test.disableSubpixelCoordinates&&(r.x=Math.round(r.x),r.y=Math.round(r.y)),i.x=r.x,i.y=r.y,i}_handleKey(t,i){const{key:r}=i;r&&t==="key-up"&&this._keyDownState.delete(r);const s={native:i,key:r,repeat:!!r&&this._keyDownState.has(r)};r&&t==="key-down"&&this._keyDownState.add(s.key),this._callback(t,s)}_handlePointer(t,i){const r=this._updateNormalizedPointerLikeEvent(i,{native:i,x:0,y:0,pointerType:i.pointerType,button:i.button,buttons:i.buttons,eventId:this._eventId++});this._callback(t,r)}_handlePointerPreventDefault(t,i){const r=this._updateNormalizedPointerLikeEvent(i,{native:i,x:0,y:0,pointerType:i.pointerType,button:i.button,buttons:i.buttons,eventId:this._eventId++});i.preventDefault(),this._callback(t,r)}_getDeltaFromTrackpadOrMouseWheel(t){return t.shiftKey&&N("mac")&&t.deltaY===0?t.deltaX:t.deltaY}_handleMouseWheel(t,i){let r=this._getDeltaFromTrackpadOrMouseWheel(i);switch(i.deltaMode){case 0:rk&&(r=r/document.documentElement.clientHeight*600);break;case 1:r*=30;break;case 2:r*=900}rk?r*=.7:bhe||She?r*=.6:whe&&(r*=1.375);const s=100,n=Math.abs(r);n>s&&(r=r/n*200/(1+Math.exp(-.02*(n-s))));const o=this._updateNormalizedPointerLikeEvent(i,{native:i,x:0,y:0,deltaY:r});this._callback(t,o)}_handlePointerCaptureLost(t,i){this._activePointerCaptures.delete(i.pointerId),this._handleDefault(t,i)}_handleDefault(t,i){const r={native:i};i.preventDefault(),this._callback(t,r)}_preventAltKeyDefault(t){t.key==="Alt"&&t.preventDefault()}_preventMultiTouchPanning(t){t.touches.length>1&&t.preventDefault()}},Qc.test={disableSubpixelCoordinates:!1},Qc);const F2={"key-down":"keydown","key-up":"keyup","pointer-down":"pointerdown","pointer-up":"pointerup","pointer-move":"pointermove","mouse-wheel":"wheel","pointer-capture-got":"gotpointercapture","pointer-capture-lost":"lostpointercapture","context-menu":"contextmenu","pointer-enter":"pointerenter","pointer-leave":"pointerleave","pointer-cancel":"pointercancel",focus:"focus",blur:"blur"};let $he=class extends _i{constructor(){super(!0),this.registerIncoming("context-menu",(t=>t.data.native.preventDefault()))}};const MU=()=>({maximumClickDelay:300}),Mhe=(e={})=>({...MU(),movementUntilMouseDrag:1.5,movementUntilPenDrag:6,movementUntilTouchDrag:6,holdDelay:500,...e}),hP=(e={})=>({...MU(),maximumDoubleClickDistance:10,maximumDoubleTouchDistance:35,maximumDoubleClickDelay:250,maximumDoubleTouchDelay:350,...e});function Ov(e,t){return Math.abs(t.x-e.x)+Math.abs(t.y-e.y)}function The(e,t){const i=t.x-e.x,r=t.y-e.y;return Math.sqrt(i*i+r*r)}function Ehe(e,t){if(t?(t.radius=0,t.center.x=0,t.center.y=0):t={radius:0,center:ei()},e.length===0)return t;if(e.length===1)return t.center.x=e[0].x,t.center.y=e[0].y,t;if(e.length===2){const[$,E]=e,[C,P]=[E.x-$.x,E.y-$.y];return t.radius=Math.sqrt(C*C+P*P)/2,t.center.x=($.x+E.x)/2,t.center.y=($.y+E.y)/2,t}let i=0,r=0;for(let $=0;$<e.length;$++)i+=e[$].x,r+=e[$].y;i/=e.length,r/=e.length;const s=e.map(($=>$.x-i)),n=e.map(($=>$.y-r));let o=0,a=0,l=0,u=0,c=0,d=0,m=0;for(let $=0;$<s.length;$++){const E=s[$],C=n[$],P=E*E,k=C*C;o+=P,a+=k,l+=E*C,u+=P*E,c+=k*C,d+=E*k,m+=C*P}const y=.5*(u+d),g=.5*(c+m),_=o*a-l*l,v=(y*a-g*l)/_,b=(o*g-l*y)/_,S=ei(v+i,b+r);return{radius:Math.sqrt(v*v+b*b+(o+a)/e.length),center:S}}function Hc(e){const{native:t}=e,{pointerId:i,button:r,pointerType:s}=t;return s==="mouse"?`${i}:${r}`:`${s}`}let Che=class extends _i{constructor(t={},i=af){super(!1),this._clock=i,this._doubleTapDragReady=!1,this._doubleTapDragActive=!1,this._dragStartCenter=ei(0,0),this._pointerState=new Map,this._parameters=hP(t),this._doubleTapDrag=this.registerOutgoing("double-tap-drag"),this._dragEventSeparator=new yw({start:(r,s)=>this._dragStart(r,s),update:(r,s)=>this._dragUpdate(s),end:(r,s)=>this._dragEnd(s)}),this.registerIncoming("drag",(r=>this._dragEventSeparator.handle(r))),this.registerIncoming("pointer-down",(r=>this._handlePointerDown(r))),this.registerIncoming("pointer-up",(()=>this._handlePointerUp()))}onUninstall(){this._pointerState.forEach((t=>{t.doubleTapTimeout=St(t.doubleTapTimeout)}))}get hasPendingInputs(){for(const t of this._pointerState.values())if(t.doubleTapTimeout!=null)return!0;return!1}_clearPointerDown(t){const i=this._pointerState.get(t);i&&(i.doubleTapTimeout=St(i.doubleTapTimeout),this._pointerState.delete(t),this.refreshHasPendingInputs())}_dragStart(t,i){if(!this._doubleTapDragReady||t!==1)return;this._doubleTapDragReady=!1,this._doubleTapDragActive=!0;const{data:r,modifiers:s}=i,{center:n}=r;this._dragStartCenter=n;const o=z2("begin",ei(0,0),r);this._doubleTapDrag.emit(o,void 0,s),i.stopPropagation()}_dragUpdate(t){if(!this._doubleTapDragActive)return;const{data:i,modifiers:r}=t,{center:s}=i,n=z2("update",ei(s.x-this._dragStartCenter.x,s.y-this._dragStartCenter.y),i);this._doubleTapDrag.emit(n,void 0,r),t.stopPropagation()}_dragEnd(t){if(!this._doubleTapDragActive)return;const{data:i,modifiers:r}=t,{center:s}=i,n=z2("end",ei(s.x-this._dragStartCenter.x,s.y-this._dragStartCenter.y),i);this._doubleTapDrag.emit(n,void 0,r),this._doubleTapDragActive=!1,t.stopPropagation()}_handlePointerDown(t){const{data:i}=t,r=Hc(i),s=this._pointerState.get(r),{pointerType:n}=i.native;if(s){const o=n==="touch"?this._parameters.maximumDoubleTouchDistance:this._parameters.maximumDoubleClickDistance;this._clearPointerDown(r),Ov(s.event.data,i)>o?this._storePointerDown(t):this._doubleTapDragReady=!0}else this._storePointerDown(t)}_handlePointerUp(){this._doubleTapDragReady=!1}_storePointerDown(t){const{data:i}=t,{pointerType:r}=i.native,s=Hc(i),n=r==="touch"?this._parameters.maximumDoubleTouchDelay:this._parameters.maximumDoubleClickDelay,o=this._clock.setTimeout((()=>this._clearPointerDown(s)),n);this._pointerState.set(s,{event:t,doubleTapTimeout:o}),this.refreshHasPendingInputs()}};function z2(e,t,i){const{button:r,buttons:s,pointer:n,pointers:o,pointerType:a,timestamp:l}=i;return{action:e,delta:t,button:r,buttons:s,pointer:n,pointers:o,pointerType:a,timestamp:l}}let Phe=class extends _i{constructor(t){super(!1),this._navigationTouch=t,this._startStateModifiers=new Set,this._activePointerMap=new Map,this._isDragging=!1,this._isCurrentDragSuppressed=!1,this._drag=this.registerOutgoing("drag"),this.registerIncoming("pointer-drag",this._handlePointerDrag.bind(this)),this.registerIncoming("pointer-up",this._handlePointerUpAndPointerLost.bind(this)),this.registerIncoming("pointer-capture-lost",this._handlePointerUpAndPointerLost.bind(this)),this.registerIncoming("pointer-cancel",this._handlePointerUpAndPointerLost.bind(this))}_createPayload(t,i,r,s){return{action:t,pointerType:this._pointerType,button:this._mouseButton,buttons:i.buttons,timestamp:s,pointers:Ihe(this._activePointerMap),pointer:i,angle:r.angle,radius:r.radius,center:r.center}}_addPointer(t){const i=t.native.pointerId,r=F0(this._activePointerMap).angle,s={event:t,initialAngle:0,lastAngle:0};this._activePointerMap.set(i,s);const n=f1(s,TU(this._activePointerMap));s.initialAngle=n,s.lastAngle=n,this._updatePointerAngles(r)}_updatePointer(t){if(t&&t.x==null&&t.y==null)return;const i=t.native.pointerId,r=this._activePointerMap.get(i);r?r.event=t:this._addPointer(t)}_removePointer(t){const i=F0(this._activePointerMap).angle;this._activePointerMap.delete(t),this._updatePointerAngles(i)}_updatePointerAngles(t){const i=F0(this._activePointerMap);this._activePointerMap.forEach((r=>{r.initialAngle=f1(r,i)-t,r.lastAngle=f1(r,i)-t}))}_emitEvent(t,i,r){const s=F0(this._activePointerMap);this._drag.emit(this._createPayload(t,i,s,r),void 0,this._startStateModifiers)}_handlePointerUpAndPointerLost(t){const i=t.data.native.pointerId,r=t.timestamp;this._activePointerMap.get(i)&&(this._activePointerMap.size===1?(this._updatePointer(t.data),!this._isCurrentDragSuppressed&&this._emitEvent("end",t.data,r),this._isDragging=!1,this._isCurrentDragSuppressed=!1,this._removePointer(i)):(this._removePointer(i),this._emitEvent("removed",t.data,t.timestamp)))}_handlePointerDrag(t){const i=t.data,r=i.currentEvent,s=t.timestamp;switch(i.action){case"start":case"update":this._isDragging?this._activePointerMap.has(r.native.pointerId)?(this._updatePointer(r),!this._isCurrentDragSuppressed&&this._emitEvent("update",r,s)):(this._addPointer(r),this._emitEvent("added",r,s),this._isCurrentDragSuppressed=this._isSuppressed):(this._updatePointer(r),this._pointerType=t.data.startEvent.pointerType,this._mouseButton=t.data.startEvent.button,this._startStateModifiers=t.modifiers,this._isDragging=!0,this._isCurrentDragSuppressed=this._isSuppressed,!this._isCurrentDragSuppressed&&this._emitEvent("start",r,s))}}get _isSuppressed(){return!!this._navigationTouch&&!this._navigationTouch.browserTouchPanEnabled&&this._pointerType==="touch"&&this._activePointerMap.size===1}};function TU(e){const t=[];return e.forEach((i=>{t.push(ei(i.event.x,i.event.y))})),Ehe(t)}function F0(e){const t=TU(e);let i=0;return e.forEach((r=>{let s=f1(r,t),n=s-r.lastAngle;for(;n>Math.PI;)n-=2*Math.PI;for(;n<-Math.PI;)n+=2*Math.PI;s=r.lastAngle+n,r.lastAngle=s;const o=s-r.initialAngle;i+=o})),i/=e.size||1,{angle:i,radius:t.radius,center:t.center}}function Ihe(e){const t=new Map;return e.forEach(((i,r)=>t.set(r,i.event))),t}function f1(e,t){const i=e.event,r=i.x-t.center.x,s=i.y-t.center.y;return Math.atan2(s,r)}var nk;(function(e){e[e.Left=0]="Left",e[e.Middle=1]="Middle",e[e.Right=2]="Right",e[e.Back=3]="Back",e[e.Forward=4]="Forward",e[e.Undefined=-1]="Undefined"})(nk||(nk={}));let Ahe=class extends _i{constructor(t={},i=af){super(!1),this._clock=i,this._pointerState=new Map,this._parameters=hP(t),this._immediateDoubleClick=this.registerOutgoing("immediate-double-click"),this.registerIncoming("pointer-down",this._handlePointerDown.bind(this)),this.registerIncoming("pointer-up",this._handlePointerUp.bind(this))}onUninstall(){this._pointerState.forEach((t=>{t.immediateDoubleClick&&t.immediateDoubleClick.timeoutHandle.remove()})),super.onUninstall()}_handlePointerDown(t){const i=t.data,r=Hc(i);if(!this._pointerState.has(r)){const s={downButton:i.native.button,x:i.x,y:i.y,immediateDoubleClick:null};this._pointerState.set(r,s),this.startCapturingPointer(i.native)}}_handlePointerUp(t){const i=t.data,r=Hc(i),s=this._pointerState.get(r);if(s&&s.downButton===i.native.button){const n=s.immediateDoubleClick,o=t.data.native.pointerType==="touch"?this._parameters.maximumDoubleTouchDistance:this._parameters.maximumDoubleClickDistance;n?(n.timeoutHandle.remove(),Ov(n,t.data)>o?this._startImmediateDoubleClick(t,s):(this._immediateDoubleClick.emit(t.data,void 0,n.modifiers),this._removeState(i))):Ov(s,t.data)>o?this._removeState(i):this._startImmediateDoubleClick(t,s)}}_startImmediateDoubleClick(t,i){const r=t.data.native.pointerType==="touch"?this._parameters.maximumDoubleTouchDelay:this._parameters.maximumDoubleClickDelay;i.immediateDoubleClick={x:t.data.x,y:t.data.y,modifiers:t.modifiers,timeoutHandle:this._clock.setTimeout((()=>this._removeState(t.data)),r)}}_removeState(t){const i=Hc(t);this._pointerState.delete(i),this.stopCapturingPointer(t.native),this.refreshHasPendingInputs()}},Lhe=class extends _i{constructor(t={},i=af){super(!1),this._clock=i,this._pointerState=new Map,this._parameters=Mhe(t),this._pointerDrag=this.registerOutgoing("pointer-drag"),this._immediateClick=this.registerOutgoing("immediate-click"),this._pointerHold=this.registerOutgoing("hold"),this.registerIncoming("pointer-down",(r=>this._handlePointerDown(r))),this.registerIncoming("pointer-up",(r=>this._handlePointerLoss(r,"pointer-up"))),this.registerIncoming("pointer-capture-lost",(r=>this._handlePointerLoss(r,"pointer-capture-lost"))),this.registerIncoming("pointer-cancel",(r=>this._handlePointerLoss(r,"pointer-cancel"))),this._moveHandle=this.registerIncoming("pointer-move",(r=>this._handlePointerMove(r))),this._moveHandle.pause()}onUninstall(){this._pointerState.forEach((t=>{t.holdTimeout=St(t.holdTimeout)})),super.onUninstall()}_handlePointerDown(t){const i=t.data,r=i.native.pointerId;let s=null;this._pointerState.size===0&&(s=this._clock.setTimeout((()=>{const o=this._pointerState.get(r);if(o){if(!o.isDragging){const a=o.previousEvent;this._pointerHold.emit(a,void 0,t.modifiers),o.holdEmitted=!0}o.holdTimeout=null}}),this._parameters.holdDelay));const n={startEvent:i,previousEvent:i,startTimestamp:t.timestamp,isDragging:!1,downButton:i.native.button,holdTimeout:s,modifiers:new Set};this._pointerState.set(r,n),this.startCapturingPointer(i.native),this._moveHandle.resume(),this._pointerState.size>1&&this._startDragging(t)}_handlePointerMove(t){const i=t.data,r=i.native.pointerId,s=this._pointerState.get(r);s&&(s.isDragging?this._pointerDrag.emit(z0("update",s,i),void 0,s.modifiers):The(i,s.startEvent)>this._getDragThreshold(i.native.pointerType)&&this._startDragging(t),s.previousEvent=i)}_getDragThreshold(t){switch(t){case"touch":return this._parameters.movementUntilTouchDrag;case"pen":return this._parameters.movementUntilPenDrag;default:return this._parameters.movementUntilMouseDrag}}_startDragging(t){const i=t.data,r=i.native.pointerId;this._pointerState.forEach((s=>{s.holdTimeout!=null&&(s.holdTimeout.remove(),s.holdTimeout=null),s.isDragging||(s.modifiers=t.modifiers,s.isDragging=!0,r===s.startEvent.native.pointerId?this._pointerDrag.emit(z0("start",s,i)):this._pointerDrag.emit(z0("start",s,s.previousEvent),t.timestamp))}))}_handlePointerLoss(t,i){const r=t.data,s=r.native.pointerId,n=this._pointerState.get(s);n&&(n.holdTimeout!=null&&(n.holdTimeout.remove(),n.holdTimeout=null),n.isDragging?this._pointerDrag.emit(z0("end",n,i==="pointer-up"?r:n.previousEvent),void 0,n.modifiers):i==="pointer-up"&&n.downButton===r.native.button&&t.timestamp-n.startTimestamp<=this._parameters.maximumClickDelay&&!n.holdEmitted&&this._immediateClick.emit(r),this._pointerState.delete(s),this.stopCapturingPointer(r.native),this._pointerState.size===0&&this._moveHandle.pause())}};function z0(e,t,i){return{action:e,startEvent:t.startEvent,previousEvent:t.previousEvent,currentEvent:i}}let khe=class extends _i{constructor(t={},i=af){super(!1),this._clock=i,this._pointerState=new Map,this._parameters=hP(t),this._click=this.registerOutgoing("click"),this._doubleClick=this.registerOutgoing("double-click"),this.registerIncoming("immediate-click",(r=>this._handleImmediateClick(r))),this.registerIncoming("pointer-down",(r=>this._handlePointerDown(r)))}onUninstall(){this._pointerState.forEach((t=>t.doubleClickTimer=St(t.doubleClickTimer)))}get hasPendingInputs(){for(const t of this._pointerState.values())if(t.doubleClickTimer!=null)return!0;return!1}_clearDoubleClickTimer(t,i){const r=this._pointerState.get(t);r&&(r.doubleClickTimer=St(r.doubleClickTimer),i&&this._click.emit(r.event.data,void 0,r.event.modifiers),this._pointerState.delete(t),this.refreshHasPendingInputs())}_doubleClickTimeoutExceeded(t){const i=this._pointerState.get(t);i.pointerDownCount===1&&this._click.emit(i.event.data,void 0,i.event.modifiers),i.doubleClickTimer=null,this._pointerState.delete(t),this.refreshHasPendingInputs()}_handleImmediateClick(t){const i=t.data,{pointerType:r}=i.native,s=Rhe(i);if(!this._pointerState.has(s))return void this._startClick(t);const n=this._pointerState.get(s),{data:o,modifiers:a}=n.event,l=r==="touch"?this._parameters.maximumDoubleTouchDistance:this._parameters.maximumDoubleClickDistance;Ov(o,i)>l?(this._clearDoubleClickTimer(s,!0),this._startClick(t)):(this._clearDoubleClickTimer(s,!1),n.pointerDownCount===2&&this._doubleClick.emit(o,void 0,a))}_handlePointerDown(t){const i=Hc(t.data),r=this._pointerState.get(i);r&&(r.pointerDownCount+=1)}_startClick(t){const{data:i}=t,{native:{pointerType:r}}=i,s=Hc(i),n=r==="touch"?this._parameters.maximumDoubleTouchDelay:this._parameters.maximumDoubleClickDelay,o=this._clock.setTimeout((()=>this._doubleClickTimeoutExceeded(s)),n);this._pointerState.set(s,{event:t,doubleClickTimer:o,pointerDownCount:1}),this.refreshHasPendingInputs()}};function Rhe(e){const{pointerId:t,pointerType:i,button:r}=e.native;return i==="mouse"?`${t}:${r}`:`${i}`}const V0={counter:"Control",pan:{left:"ArrowLeft",right:"ArrowRight",up:"ArrowUp",down:"ArrowDown"},zoom:{zoomIn:["=","+"],zoomOut:["-","_"]},rotate:{clockwise:["a","A"],counterClockwise:["d","D"],reset:["n","N"]}},ok=Symbol("handles");let tc=class extends le{initialize(){const t=()=>this.view?.ready;this.addHandles([Yr((()=>!t()),(()=>this._disconnect())),Yr(t,(()=>this._connect()))])}destroy(){this._disconnect()}get latestPointerType(){return this._inputManager?.latestPointerType}get latestPointerLocation(){return this._inputManager?.latestPointerLocation}get multiTouchActive(){return this._inputManager?.multiTouchActive??!1}isModifierKeyDown(t){return this._inputManager?.isModifierKeyDown(t)??!1}_disconnect(){this.view.viewEvents.disconnect(),this.removeHandles(ok),this._inputManager=Ot(this._inputManager)}_connect(){const t=this.view.surface,i=new xhe(t,this.view.input),r=[new Ahe,new Lhe,new khe,new Phe(this.view.navigation),new Che],s=new bs({eventSource:i,recognizers:r}),n=new yce(this.view,["primary"]),o=new gce(this.view,["secondary"]);s.installHandlers("prevent-context-menu",[new $he],Va.INTERNAL),s.installHandlers("navigation",[new fhe(this.view),new nhe(this.view),new phe(this.view),new KL(this.view),new KL(this.view,[V0.counter]),n,new uhe(this.view,V0.pan),new hhe(this.view,V0.zoom),new che(this.view,V0.rotate),o,new mce(this.view,"touch")],Va.INTERNAL),this.view.viewEvents.connect(s),this._source=i,this._inputManager=s,this.addHandles([te((()=>this.view?.navigation?.browserTouchPanEnabled),(a=>{this._source&&(this._source.browserTouchPanningEnabled=!a)}),Pt),te((()=>{const{actionMap:a}=this.view.navigation;return{panActions:XL("pan",a),rotateActions:XL("rotate",a)}}),(({panActions:a,rotateActions:l})=>{n.pointerActions=a,o.pointerActions=l}),br)],ok)}get test(){}};h([f()],tc.prototype,"view",void 0),h([f()],tc.prototype,"latestPointerType",null),h([f()],tc.prototype,"latestPointerLocation",null),h([f()],tc.prototype,"multiTouchActive",null),tc=h([I("esri.views.2d.input.MapViewInputManager")],tc);const Ohe=tc,Nhe=e=>{let t=class extends e{constructor(...i){super(...i),this.goToManager=new p1({view:this}),this.inputManager=new Ohe({view:this}),this.addHandles([this.on("resize",(r=>this.stateManager.resize(r.width,r.height)))])}get interacting(){return this.navigating}get stationary(){return!this.animation&&!this.navigating&&!this.resizing&&this.stationaryManager.stationary}on(i,r,s,n){return this.inputManager&&this.viewEvents.on(i,r,s,n)||super.on(i,r)}hasEventListener(i){return super.hasEventListener(i)||this.viewEvents.hasHandler(i)}goTo(i,r){return this.goToManager.goTo(i,r)}toMap(i){if(!this.ready)return null;const r=_V(i)?gV(this,i):i;return this.stateManager.toMap(r)}};return h([f()],t.prototype,"goToManager",void 0),h([f({readOnly:!0})],t.prototype,"interacting",null),h([f()],t.prototype,"stationary",null),h([f({readOnly:!0})],t.prototype,"inputManager",void 0),t=h([I("esri.views.Viewport2DMixin")],t),t};let ak=class{constructor(t){this._view=t,this.viewpoint=new Us({targetGeometry:new he,scale:0,rotation:0})}get view(){return this._view}get size(){const[t,i]=this._view.size;return Math.sqrt(t*t+i*i)}get scale(){return this.viewpoint.scale}get rotation(){return this.viewpoint.rotation}get center(){return this.viewpoint.targetGeometry}get scaleToResolutionFactor(){return YV(this.center.spatialReference)}pixelsPerPanAtZoom(t){return 1/(t*this.scaleToResolutionFactor)}zoomAtPixelsPerPan(t){return 1/(t*this.scaleToResolutionFactor)}pixelsPerRotate(){return this.size/2}compareTo(t,i){i.pan=j4(this.center,t.center);let r=Math.abs(t.rotation-this.rotation);r=r>=180?360-r:r,i.rotate=mf(r),i.sourceZoom=this.scale,i.targetZoom=t.scale}interpolate(t,i,r){const{pan:s,rotate:n,zoom:o,zoomOffset:a}=r,{center:l}=this;l.spatialReference=t.center.spatialReference,l.x=gm(t.center.x,i.center.x,s),l.y=gm(t.center.y,i.center.y,s),this.viewpoint.scale=gm(t.scale,i.scale+a,o);let u=t.rotation;const c=i.rotation;Math.abs(c-u)>=180&&(u+=360*(u<c?1:-1)),this.viewpoint.rotation=gm(u,c,n)}copyFrom(t){or(this.viewpoint,t.viewpoint),this._view=t.view}};function Gf(e,t,i,r){const s=3*e,n=3*(i-e)-s,o=1-s-n,a=3*t,l=3*(r-t)-a,u=1-a-l;function c(g){return((o*g+n)*g+s)*g}function d(g){return((u*g+l)*g+a)*g}function m(g){return(3*o*g+2*n)*g+s}function y(g,_){let v,b,S,$,E,C;for(S=g,C=0;C<8;C++){if($=c(S)-g,Math.abs($)<_)return S;if(E=m(S),Math.abs(E)<1e-6)break;S-=$/E}if(v=0,b=1,S=g,S<v)return v;if(S>b)return b;for(;v<b;){if($=c(S),Math.abs($-g)<_)return S;g>$?v=S:b=S,S=.5*(b-v)+v}return S}return function(g,_=1e-6){return d(y(g,_))}}const Ps={};Ps.ease=Gf(.25,.1,.25,1),Ps.linear=Gf(0,0,1,1),Ps.easeIn=Ps["ease-in"]=Gf(.42,0,1,1),Ps.easeOut=Ps["ease-out"]=Gf(0,0,.58,1),Ps.easeInOut=Ps["ease-in-out"]=Gf(.42,0,.58,1);const Dhe=e=>e,ng=e=>e*e,Nv=e=>1-ng(1-e),lk=e=>e<.5?ng(2*e)/2:(Nv(2*(e-.5))+1)/2,Dv=e=>e*e*e,NM=e=>1-Dv(1-e),uk=e=>e<.5?Dv(2*e)/2:(NM(2*(e-.5))+1)/2,Fv=e=>e*e*e*e,DM=e=>1-Fv(1-e),ck=e=>e<.5?Fv(2*e)/2:(DM(2*(e-.5))+1)/2,zv=e=>e*e*e*e*e,FM=e=>1-zv(1-e),hk=e=>e<.5?zv(2*e)/2:(FM(2*(e-.5))+1)/2,Vv=e=>1-Math.cos(e*Math.PI/2),zM=e=>1-Vv(1-e),dk=e=>e<.5?Vv(2*e)/2:(zM(2*(e-.5))+1)/2,Uv=e=>2**(10*(e-1)),jv=e=>1-Uv(1-e),pk=e=>e<.5?Uv(2*e)/2:(jv(2*(e-.5))+1)/2,Gv=e=>-(Math.sqrt(1-e*e)-1),VM=e=>1-Gv(1-e),fk=e=>e<.5?Gv(2*e)/2:(VM(2*(e-.5))+1)/2;function Ws(e){const t=2*(e-Math.sqrt((e-1)*e)),i=t/2/e;return r=>r<i?e*r*r:t*r-t+1}function Zs(e,t){return(i,r)=>i<t?t*e(i/t,r):1-e((1-i)/(1-t),r)*(1-t)}const mk=Zs(Ws(1),1),yk=Zs(Ws(1),0),Bv=Zs(Ws(1),.5),gk=Zs(Ws(2),1),_k=Zs(Ws(2),0),vk=Zs(Ws(2),.5),bk=Zs(Ws(3),1),wk=Zs(Ws(3),0),Sk=Zs(Ws(3),.5),xk=Zs(Ws(4),1),$k=Zs(Ws(4),0),Mk=Zs(Ws(4),.5),Tk={linear:Dhe,"in-quad":ng,"out-quad":Nv,"in-out-quad":lk,"in-coast-quad":mk,"out-coast-quad":yk,"in-out-coast-quad":Bv,"in-cubic":Dv,"out-cubic":NM,"in-out-cubic":uk,"in-coast-cubic":gk,"out-coast-cubic":_k,"in-out-coast-cubic":vk,"in-quart":Fv,"out-quart":DM,"in-out-quart":ck,"in-coast-quart":bk,"out-coast-quart":wk,"in-out-coast-quart":Sk,"in-quint":zv,"out-quint":FM,"in-out-quint":hk,"in-coast-quint":xk,"out-coast-quint":$k,"in-out-coast-quint":Mk,"in-sine":Vv,"out-sine":zM,"in-out-sine":dk,"in-expo":Uv,"out-expo":jv,"in-out-expo":pk,"in-circ":Gv,"out-circ":VM,"in-out-circ":fk,"quad-in":ng,"quad-out":Nv,"quad-in-out":lk,"quad-in-coast":mk,"quad-out-coast":yk,"quad-in-out-coast":Bv,"cubic-in":Dv,"cubic-out":NM,"cubic-in-out":uk,"cubic-in-coast":gk,"cubic-out-coast":_k,"cubic-in-out-coast":vk,"quart-in":Fv,"quart-out":DM,"quart-in-out":ck,"quart-in-coast":bk,"quart-out-coast":wk,"quart-in-out-coast":Sk,"quint-in":zv,"quint-out":FM,"quint-in-out":hk,"quint-in-coast":xk,"quint-out-coast":$k,"quint-in-out-coast":Mk,"sine-in":Vv,"sine-out":zM,"sine-in-out":dk,"expo-in":Uv,"expo-out":jv,"expo-in-out":pk,"circ-in":Gv,"circ-out":VM,"circ-in-out":fk,ease:e=>Ps.ease(e),"ease-in":e=>Ps.easeIn(e),"ease-out":e=>Ps.easeOut(e),"ease-in-out":e=>Ps.easeInOut(e)};let Fhe=class{constructor(){this.pan=0,this.rotate=0,this.fov=0,this.sourceZoom=0,this.targetZoom=0}};const qv={desiredScreenFlow:2,minDuration:500,maxDuration:8e3},EU={maxDuration:4e3};let zhe=class CU{constructor(t){this._createCamera=t,this.compared=new Fhe,this.segmentStart=0,this.segmentEnd=1,this.settings={desiredScreenFlow:qv.desiredScreenFlow},this.source=t(),this.target=t()}clone(){const t=new CU(this._createCamera);return t.copyFrom(this),t}copyFrom(t){this.update(t.source,t.target,t.settings)}update(t,i,r){this.source!==t&&this.source.copyFrom(t),this.target!==i&&this.target.copyFrom(i),this.source.compareTo(this.target,this.compared),this.settings.desiredScreenFlow=r.desiredScreenFlow??qv.desiredScreenFlow,this.desiredPixelFlow=this.settings.desiredScreenFlow*this.target.size,this.halfWindowSize=this.target.size/2}halfWindowPanAtZoom(t){const i=this.target.pixelsPerPanAtZoom(t);return this.halfWindowSize/i}get hasZoom(){return Math.abs(this.compared.sourceZoom-this.compared.targetZoom)>1e-5}get hasPan(){return this.compared.pan>Tr()}get hasFov(){return Math.abs(this.compared.fov)>Tr()}get hasRotate(){return this.compared.rotate>Tr()}},Vhe=class{constructor(){this.pan=0,this.rotate=0,this.zoom=0,this.fov=0,this.zoomOffset=0}},Uhe=class{constructor(){this.segments=new Array}get time(){return this.segments.reduce(((t,i)=>t+i.time),0)}interpolateComponentsAt(t,i){t=Math.min(Math.max(t,0),1),t*=this.time;let r=0,s=0;const n=this.definition,o=this.segments.reduce(((a,l)=>a||l.definition.hasZoom),!1);for(let a=0;a<this.segments.length;a++){const l=this.segments[a],u=l.definition;if(t<=l.time||a===this.segments.length-1){if(this.segmentInterpolateComponentsAt(l,l.time===0?0:t/l.time,i),n.hasPan&&!isNaN(i.pan)&&isFinite(n.compared.pan)?i.pan=(r+u.compared.pan*i.pan)/n.compared.pan:i.pan=1,n.hasRotate&&!isNaN(i.rotate)&&isFinite(n.compared.rotate)?i.rotate=(s+u.compared.rotate*i.rotate)/n.compared.rotate:i.rotate=1,o&&!isNaN(i.zoom)&&isFinite(u.compared.targetZoom)){const{sourceZoom:c,targetZoom:d}=u.compared,m=i.zoom*(d-c)+c,y=this.segments[0].definition.compared.sourceZoom,g=this.segments[this.segments.length-1].definition.compared.targetZoom,_=Math.abs(d-y)>Math.abs(c-y)?d:c;i.zoomOffset=_-g,i.zoom=(m-y)/(_-y)}else i.zoom=1;return i}t-=l.time,r+=u.compared.pan,s+=u.compared.rotate}}segmentInterpolateComponentsAt(t,i,r){t.interpolateComponentsAt(i,r)}},V2=class{get time(){return this._time}constructor(t){t&&this.update(t)}update(t){t&&(this.definition?this.definition.copyFrom(t):this.definition=t.clone()),this._updatePrecomputedVariables(),this._updatePixelFlow()}_updatePrecomputedVariables(){const t=this.definition,i=t.compared,r=i.sourceZoom,s=i.targetZoom;this._zoomSign=r>s?1:-1,this._panPixelsAtSource=i.pan*t.source.pixelsPerPanAtZoom(r);const n=(t.source.pixelsPerRotate()+t.target.pixelsPerRotate())/2;this._rotatePixels=i.rotate*n}_updatePixelFlow(){const t=this.definition.compared.sourceZoom,i=this.definition.compared.targetZoom,{hasZoom:r,hasPan:s,hasRotate:n}=this.definition;let o=0,a=0;r&&(s&&(o=(i/t-1)/(-1/(this._zoomSign*this.definition.halfWindowSize)*Math.LN2*this._panPixelsAtSource)),n&&(a=this._zoomSign*(Math.log(t/i)/Math.LN2)*this.definition.halfWindowSize/this._rotatePixels)),this._zoomPixelFlow=0,this._panPixelFlow=0,this._rotatePixelFlow=0;const l=this.definition.desiredPixelFlow;if(r&&s&&n){const u=o+a+o*a;this._zoomPixelFlow=o*a/u*l,this._panPixelFlow=a/u*l,this._rotatePixelFlow=o/u*l}else if(r&&s){const u=1+o;this._zoomPixelFlow=o/u*l,this._panPixelFlow=1/u*l}else if(r&&n){const u=1+a;this._zoomPixelFlow=a/u*l,this._rotatePixelFlow=1/u*l}else if(s&&n){const u=this._panPixelsAtSource/this._rotatePixels,c=1+u;this._panPixelFlow=u/c*l,this._rotatePixelFlow=1/c*l}else s?this._panPixelFlow=l:r?this._zoomPixelFlow=l:n&&(this._rotatePixelFlow=l);if(this._time=Math.max(this.rotateTime,this.zoomTime,this.panTime),this.fovTime>this._time){const u=this.fovTime/this._time;this._time=this.fovTime,this._zoomPixelFlow/=u,this._panPixelFlow/=u,this._rotatePixelFlow/=u}}get rotateTime(){return this.definition.hasRotate?this._rotatePixels/this._rotatePixelFlow:0}get zoomTime(){return this.definition.hasZoom?this._zoomSign*(Math.log(this.definition.compared.sourceZoom/this.definition.compared.targetZoom)/Math.LN2)*this.definition.halfWindowSize/this._zoomPixelFlow:0}get fovTime(){return this.definition.hasFov?Math.abs(this.definition.compared.fov)/jhe:0}get panTime(){if(!this.definition.hasPan)return 0;if(this.definition.hasZoom){const t=-1/(this._zoomSign*this.definition.halfWindowSize)*Math.LN2,i=t*this._panPixelsAtSource;return Math.log(i*(this._zoomPixelFlow/this._panPixelFlow)+1)/(t*this._zoomPixelFlow)}return this._panPixelsAtSource/this._panPixelFlow}_interpolateComponentsZoom(t){if(t===0||t===1)return t;if(this.definition.hasZoom){const i=this.definition.compared.sourceZoom,r=this.definition.compared.targetZoom;return(i*(i/r)**-t-i)/(r-i)}return t}_interpolateComponentsFov(t){if(t===0)return this.definition.segmentStart;if(t===1)return this.definition.segmentEnd;if(this.definition.hasFov){const{segmentStart:i,segmentEnd:r}=this.definition;return i+t*(r-i)}return this.definition.segmentStart}_interpolateComponentsPan(t){if(t===0||t===1)return t;if(this.definition.hasPan&&this.definition.hasZoom){const i=-1/(this._zoomSign*this.definition.halfWindowSize)*this._zoomPixelFlow;return 1/this._panPixelsAtSource*(this._panPixelFlow*(2**(i*t*this._time)-1))/(i*Math.LN2)}return t}_interpolateComponentsRotate(t){return t}interpolateComponentsAt(t,i){t=Math.min(Math.max(t,0),1),i.zoom=this._interpolateComponentsZoom(t),i.pan=this._interpolateComponentsPan(t),i.rotate=this._interpolateComponentsRotate(t),i.zoomOffset=0,i.fov=this._interpolateComponentsFov(t)}};const jhe=mf(45);function Ghe(e,t,i){const r=t-e.compared.sourceZoom,s=e.halfWindowPanAtZoom(r);return-e.halfWindowSize*(i.ascensionFactor*Math.LN2*e.compared.pan+s)*Math.log(e.compared.sourceZoom/t)/(e.desiredPixelFlow*Math.LN2*s)}function Bhe(e,t,i){const r=1/t,s=Math.log(e.compared.sourceZoom*r),n=1/e.desiredPixelFlow,o=1/Math.LN2,a=t-e.compared.sourceZoom,l=1/a,u=(i.ascensionFactor*Math.LN2*e.compared.pan+e.halfWindowPanAtZoom(a))/e.halfWindowPanAtZoom(1);return e.halfWindowSize*r*n*o*l*u-e.halfWindowSize*s*n*o*l+e.halfWindowSize*s*n*o*u/(a*a)}function qhe(e,t,i){const r=t-e.compared.sourceZoom,s=1/r,n=1/t,o=Math.log(e.compared.sourceZoom*n),a=(i.ascensionFactor*Math.LN2*e.compared.pan+e.halfWindowPanAtZoom(r))/e.halfWindowPanAtZoom(1);return e.halfWindowSize*s*(-2*s*n*a+2*s*o+2*n-2*o*a/(r*r)-a/(t*t))/(e.desiredPixelFlow*Math.LN2)}function Hhe(e,t){return-e.halfWindowSize*Math.log(e.compared.sourceZoom/t)/(e.desiredPixelFlow*Math.LN2)}function Whe(e,t){return e.halfWindowSize/(t*e.desiredPixelFlow*Math.LN2)}function Zhe(e,t){return-e.halfWindowSize/(t*t*e.desiredPixelFlow*Math.LN2)}function Yhe(e,t,i){return-e.compared.pan*e.halfWindowSize*(i.ascensionFactor+i.descensionFactor-1)/(e.desiredPixelFlow*e.halfWindowPanAtZoom(t))}function Jhe(e,t,i){return e.compared.pan*e.halfWindowSize*(i.ascensionFactor+i.descensionFactor-1)/(e.desiredPixelFlow*e.halfWindowPanAtZoom(t*t))}function Xhe(e,t,i){return-2*e.compared.pan*e.halfWindowSize*(i.ascensionFactor+i.descensionFactor-1)/(e.desiredPixelFlow*e.halfWindowPanAtZoom(t*t*t))}function Khe(e,t,i){return e.halfWindowSize*(-e.halfWindowPanAtZoom(t)-i.descensionFactor*Math.LN2*e.compared.pan+e.halfWindowPanAtZoom(e.compared.targetZoom))*Math.log(t/e.compared.targetZoom)/(e.desiredPixelFlow*Math.LN2*e.halfWindowPanAtZoom(-t+e.compared.targetZoom))}function Qhe(e,t,i){const r=Math.log(t/e.compared.targetZoom),s=1/e.desiredPixelFlow,n=1/Math.LN2,o=-t+e.compared.targetZoom,a=1/o,l=(-e.halfWindowPanAtZoom(t)-i.descensionFactor*Math.LN2*e.compared.pan+e.halfWindowPanAtZoom(e.compared.targetZoom))/e.halfWindowPanAtZoom(1);return-e.halfWindowSize*r*s*n*a+e.halfWindowSize*r*s*n*l/(o*o)+e.halfWindowSize*s*n*a*l/t}function ede(e,t,i){const r=t-e.compared.targetZoom,s=1/r,n=1/t,o=Math.log(t/e.compared.targetZoom),a=(e.halfWindowPanAtZoom(t)+i.descensionFactor*Math.LN2*e.compared.pan-e.halfWindowPanAtZoom(e.compared.targetZoom))/e.halfWindowPanAtZoom(1);return e.halfWindowSize*s*(-2*s*n*a-2*s*o+2*n+2*o*a/(r*r)-a/(t*t))/(e.desiredPixelFlow*Math.LN2)}function tde(e,t){return e.halfWindowSize*Math.log(t/e.compared.targetZoom)/(e.desiredPixelFlow*Math.LN2)}function ide(e,t){return e.halfWindowSize/(t*e.desiredPixelFlow*Math.LN2)}function rde(e,t){return-e.halfWindowSize/(t*t*e.desiredPixelFlow*Math.LN2)}function sde(e){const t=e.compared.sourceZoom-e.compared.targetZoom;if(t===0)return e.compared.pan*e.halfWindowSize/(e.desiredPixelFlow*e.halfWindowPanAtZoom(e.compared.sourceZoom));const i=Math.LN2*e.compared.pan,r=t,s=e.halfWindowPanAtZoom(r),n=e.halfWindowSize*Math.log(e.compared.sourceZoom/e.compared.targetZoom)/(e.desiredPixelFlow*Math.LN2*s);return e.compared.sourceZoom<=e.compared.targetZoom?n*(i-s):n*(i+s)}function nde(e,t){let i=ode(e,t);const r={ascensionFactor:t.ascensionFactor!=null?t.ascensionFactor:.5,descensionFactor:t.descensionFactor!=null?t.descensionFactor:.5},s=r.ascensionFactor===0,n=r.descensionFactor===0,o=s?Hhe:Ghe,a=s?Whe:Bhe,l=s?Zhe:qhe,u=n?tde:Khe,c=n?ide:Qhe,d=n?rde:ede,m=C=>o(e,C,r)+Yhe(e,C,r)+u(e,C,r),y=C=>a(e,C,r)+Jhe(e,C,r)+c(e,C,r),g=C=>l(e,C,r)+Xhe(e,C,r)+d(e,C,r);let _=m(i);const v=sde(e);let b;const S=t.maximumIterations||20,$=t.maximumDistance!=null?t.maximumDistance:1/0;for(b=0;b<S;b++){const C=t.desiredSlope??1e-6;let P=y(i);Math.abs(P)>C&&(P+=C);const k=P/g(i);if(isNaN(k)||i>=$&&k<0){if(!isFinite($))return null;i=$,_=m(i);break}if(i-=k,i<=e.compared.sourceZoom||i<=e.compared.targetZoom)return null;const F=m(i);if(Math.abs(F-_)/_<=.005)break;_=F}return isNaN(_)||_>v*(1-.3)||i<=e.compared.sourceZoom||i<=e.compared.targetZoom?null:i}function ode(e,t){const i=Math.max(e.compared.sourceZoom,e.compared.targetZoom),r=e.source.zoomAtPixelsPerPan(e.desiredPixelFlow/e.compared.pan)/2;return r<i?t.maximumDistance!=null?i+(t.maximumDistance-i)/2:1.5*i:t.maximumDistance?Math.min(t.maximumDistance,r):r}let ade=class extends Uhe{constructor(t,i){super(),this._preallocSegments=[new V2,new V2,new V2],this._ascensionSegment=null,this._descensionSegment=null,this.update(t,i)}update(t,i){if(!t)return;this.definition?this.definition.copyFrom(t):this.definition=t.clone();const r=i?.apex?nde(t,i.apex):null;this.segments.length=0,this._ascensionSegment=null,this._descensionSegment=null,r?this._updateWithApex(r,i?.apex):this._updateWithoutApex()}segmentInterpolateComponentsAt(t,i,r){t.interpolateComponentsAt(i,r),t===this._ascensionSegment?r.zoom=Nv(r.zoom):t===this._descensionSegment&&(r.zoom=ng(r.zoom))}_updateWithApex(t,i){const[r,s,n]=this._preallocSegments,o=i?.ascensionFactor??.5,a=Math.min(1-o,i?.ascensionFactor!=null&&i.descensionFactor!=null?i.descensionFactor:.5),l=1-o-a;r.definition?r.definition.copyFrom(this.definition):r.definition=this.definition.clone(),r.definition.compared.targetZoom=t,r.definition.compared.pan=this.definition.compared.pan*o,r.definition.compared.rotate=this.definition.compared.rotate*o,r.definition.segmentEnd=o,r.update(),this._ascensionSegment=r,this.segments.push(r),l>0&&(s.definition?s.definition.copyFrom(this.definition):s.definition=this.definition.clone(),s.definition.copyFrom(this.definition),s.definition.compared.sourceZoom=t,s.definition.compared.targetZoom=t,s.definition.compared.pan=this.definition.compared.pan*l,s.definition.compared.rotate=this.definition.compared.rotate*l,s.definition.segmentStart=r.definition.segmentEnd,s.definition.segmentEnd=r.definition.segmentEnd+l,s.update(),this.segments.push(s)),n.definition?n.definition.copyFrom(this.definition):n.definition=this.definition.clone(),n.definition.compared.sourceZoom=t,n.definition.compared.pan=this.definition.compared.pan*a,n.definition.compared.rotate=this.definition.compared.rotate*a,n.definition.segmentStart=o+l,n.update(),this._descensionSegment=n,this.segments.push(n)}_updateWithoutApex(){const[t]=this._preallocSegments;t.update(this.definition),this.segments.push(t)}};const lde=new Vhe;let ude=class{get time(){return this._time}get isLinear(){return this.path.segments.length===1}constructor(t){this._time=0,this._easing=Bv,this.definition=new zhe(t),this.path=new ade}update(t,i,r){this.definition.update(t,i,r),this.path.update(this.definition,r),this._time=this._applyTimeSettings(mW(isFinite(this.path.time)?this.path.time:0),r),this._easing=r.easing??(this._time>=1e3?Bv:jv)}cameraAt(t,i){t=Math.min(Math.max(0,t),1),t=this._normalizedEasing(t);const r=this.path.interpolateComponentsAt(t,lde);i.interpolate(this.definition.source,this.definition.target,r)}_normalizedEasing(t){const i=this._easing(0,this._time),r=this._easing(1,this._time);return(this._easing(t,this._time)-i)/(r-i)}_applyTimeSettings(t,i){const r=i.speedFactor!=null?i.speedFactor:1,s=i.minDuration??qv.minDuration/r,n=i.maxDuration??qv.maxDuration/r;return t=i.duration!=null?i.duration:Math.min(Math.max(t/r,s),n)}};const cde=2e3,hde=64;let dde=class{constructor(t){this._view=t,this._animation=new ude((()=>new ak(this._view))),this._current=new ak(this._view)}get _source(){return this._animation.definition.source}get _target(){return this._animation.definition.target}get duration(){return this._animation.time}get animation(){return this._animation}update(t,i,r={}){or(this._current.viewpoint,t),or(this._source.viewpoint,t),or(this._target.viewpoint,i),this._animation.update(this._source,this._target,r)}applyRatio(t,i){this._animation.cameraAt(i,this._current),or(t,this._current.viewpoint)}},dd=class extends le{constructor(t){super(t),this._animation=null,this._destinationViewState=new uP,this.updateFunction=null,this.easing=Tk.ease,this.viewpoint=new Us({targetGeometry:new he,scale:0,rotation:0}),this._updateTask=Np({postRender:this._postRender.bind(this)}),this._updateTask.pause(),this._transition=new dde(t.view)}destroy(){this._updateTask=St(this._updateTask)}get animation(){return this._animation}set animation(t){this._animation=t,this.view.animation=t}animate(t,i,r){this.stop();const s=this.viewpoint;or(s,i);const n=t.target;this._transition.update(this.viewpoint,n,{apex:{maximumDistance:Math.min(Math.min(i.scale,n.scale)*hde,this.view.constraints.effectiveMinScale),desiredSlope:5e-8},duration:r?.duration,maxDuration:r?.animationMode==="auto"?1/0:r?.maxDuration??EU.maxDuration,speedFactor:r?.speedFactor,easing:(typeof r?.easing=="string"?Tk[r.easing]:r?.easing)||this.easing}),r?.animationMode==="auto"&&(this._destinationViewState.copy(this.view.state),this._destinationViewState.viewpoint=n,pde(this._transition.animation,r,this.view.state,this._destinationViewState)||this._transition.update(this.viewpoint,n,{duration:0}));const o=()=>{this.animation===t&&this._updateTask&&(t.state==="finished"&&(this._transition.applyRatio(this.viewpoint,1),this.view.state&&(this.view.state.viewpoint=this.viewpoint.clone())),this.animation=null,this.updateFunction=null)};return t.when(o,o),this._startTime=performance.now(),this._updateTask.resume(),this.animation=t,t}animateContinuous(t,i){this.stop(),this.updateFunction=i,this.viewpoint=t;const r=new RM({target:t.clone()}),s=()=>{this.animation===r&&this._updateTask&&(this.animation=null,this.updateFunction=null)};return r.when(s,s),this._startTime=performance.now(),this._updateTask.resume(),this.animation=r,r}stop(){this.animation&&(this.animation.stop(),this.animation=null,this.updateFunction=null)}_postRender(t){const i=this.animation;if(i&&i.state!==RM.State.STOPPED){if(this.updateFunction)this.updateFunction(this.viewpoint,t.deltaTime),this.animation?.update(this.viewpoint);else{const r=performance.now()-this._startTime,s=this._transition.duration,n=s>0?r/s:1,o=n>=1;this._transition.applyRatio(this.viewpoint,n),o&&this.animation?.finish()}this.view.state&&(this.view.state.viewpoint=this.viewpoint.clone())}else this._updateTask.pause()}};function pde(e,t,i,r){if(t?.duration!=null)return!0;const{time:s,isLinear:n}=e,o=t?.speedFactor||1;if(s>(t?.maxDuration??EU.maxDuration/o))return!1;if(n){const l=Dt(),u=ei(...r.toScreen(l,...i.center)),c=ei(...i.toScreen(l,...r.center)),d=c!=null&&c.x>-1*i.size[0]&&c.x<(1.5+.5)*i.size[0]&&c.y>-1*i.size[1]&&c.y<(1.5+.5)*i.size[1],m=u!=null&&u.x>-1*r.size[0]&&u.x<(1.5+.5)*r.size[0]&&u.y>-1*r.size[1]&&u.y<(1.5+.5)*r.size[1];if(s>cde/o&&!d&&!m)return!1}return!0}h([f()],dd.prototype,"easing",void 0),h([f()],dd.prototype,"view",void 0),h([f()],dd.prototype,"viewpoint",void 0),dd=h([I("esri.views.2d.AnimationManager")],dd);const fde=dd;function pt(){return Promise.all([J(()=>import("./webglDeps-Bz7Uqddf.js"),__vite__mapDeps([212,213,214,215])),J(()=>import("./mapViewDeps-B_xX9WE2.js"),__vite__mapDeps([216,217,93,218,214,213,156,134,88,219,90,59,220,87,109,221,141,140,96,34,30,35,91,97,222,94,95,139,212,215,223,104,224,225,226,153,150,132,75,86,89,32,27,38,227,228,92,229,99,230,101,64,84,231,232,233,234,149,235]))])}const Bf=()=>pt().then((()=>J(()=>import("./TileLayerView2D-C-kci5w2.js"),__vite__mapDeps([236,88,221,220,87,59,213,109,141,140,96,34,30,35,139,223,218,214,156,134,219,90,104,224,225,75,93,217,91,97,94,95,153,150,132,230,86,89,32,27,38,101,64,84,237,238,239,234,240,202,241,232,233,242,243,244,245])))),Pu=()=>pt().then((()=>J(()=>import("./FeatureLayerView2D-cjK-Z-3C.js").then(e=>e.F),__vite__mapDeps([246,34,30,35,184,166,42,89,247,169,248,249,32,27,41,240,221,202,233,88,87,59,214,213,234,220,109,141,140,96,217,93,218,156,134,219,90,91,97,104,188,222,250,103,183,245,242])))),Ek={"base-dynamic":()=>pt().then((()=>J(()=>import("./BaseDynamicLayerView2D-BF_43uTD.js"),__vite__mapDeps([251,252,220,87,59,213,109,221,141,140,96,34,30,35,238,218,214,156,134,93,239,240,202,253,242])))),"base-tile":Bf,"bing-maps":Bf,catalog:()=>pt().then((()=>J(()=>import("./CatalogLayerView2D-DTxLk79_.js"),__vite__mapDeps([254,240,221,202])))),"catalog-dynamic-group":()=>pt().then((()=>J(()=>import("./CatalogDynamicGroupLayerView2D-DH6aaUE6.js"),__vite__mapDeps([255,240,221,202])))),"catalog-footprint":()=>pt().then((()=>J(()=>import("./CatalogFootprintLayerView2D-BQG8smXR.js"),__vite__mapDeps([256,246,34,30,35,184,166,42,89,247,169,248,249,32,27,41,240,221,202,233,88,87,59,214,213,234,220,109,141,140,96,217,93,218,156,134,219,90,91,97,104,188,222,250,103,183,245,242])))),csv:Pu,"geo-rss":()=>pt().then((()=>J(()=>import("./GeoRSSLayerView2D-DWHDHUxa.js"),__vite__mapDeps([257,169,240,221,202,231,232,233,88,87,59,214,213,234,220,109,141,140,96,34,30,35,217,93,218,156,134,219,90,91,97,230,86,89,32,27,38,101,64,84])))),feature:Pu,geojson:Pu,parquet:Pu,graphics:()=>pt().then((()=>J(()=>import("./GraphicsLayerView2D-CS_Yscos.js"),__vite__mapDeps([258,240,221,202,231,232,233,88,87,59,214,213,234,220,109,141,140,96,34,30,35,217,93,218,156,134,219,90,91,97,230,86,89,32,27,38,101,64,84])))),group:()=>pt().then((()=>J(()=>import("./GroupLayerView2D-CSg4nMws.js"),__vite__mapDeps([259,240,221,202])))),imagery:()=>pt().then((()=>J(()=>import("./ImageryLayerView2D-Cbud-YL0.js"),__vite__mapDeps([260,261,213,59,117,220,87,109,221,141,140,96,34,30,35,240,202,230,86,88,89,90,32,27,38,217,93,218,214,156,134,219,91,97,101,64,84,241,232,233,234,252,238,239,253,121,247,245,242])))),"imagery-tile":()=>pt().then((()=>J(()=>import("./ImageryTileLayerView2D-zliRcVi7.js"),__vite__mapDeps([262,263,261,213,59,117,220,87,109,221,141,140,96,34,30,35,240,202,120,264,234,218,214,156,134,93,239,219,90,265,121,247,245,242])))),kml:()=>pt().then((()=>J(()=>import("./KMLLayerView2D-BM7GLA-j.js"),__vite__mapDeps([266,267,169,238,221,218,214,213,156,134,93,239,252,220,87,59,109,141,140,96,34,30,35,240,202,231,232,233,88,234,217,219,90,91,97,230,86,89,32,27,38,101,64,84,229,99,121,226,212,215,153,150,132,224,264])))),"knowledge-graph":()=>pt().then((()=>J(()=>import("./KnowledgeGraphLayerView2D-k_LS9W1Y.js"),__vite__mapDeps([268,240,221,202])))),"link-chart":()=>pt().then((()=>J(()=>import("./KnowledgeGraphLayerView2D-k_LS9W1Y.js"),__vite__mapDeps([268,240,221,202])))),"knowledge-graph-sublayer":Pu,"map-image":()=>pt().then((()=>J(()=>import("./MapImageLayerView2D-DKv4Epf6.js"),__vite__mapDeps([269,252,220,87,59,213,109,221,141,140,96,34,30,35,238,218,214,156,134,93,239,240,202,230,86,88,89,90,32,27,38,217,219,91,97,101,64,84,241,232,233,234,253,247,242,243,244,245])))),"map-notes":()=>pt().then((()=>J(()=>import("./MapNotesLayerView2D-DRm0CyYv.js"),__vite__mapDeps([270,240,221,202,231,232,233,88,87,59,214,213,234,220,109,141,140,96,34,30,35,217,93,218,156,134,219,90,91,97,230,86,89,32,27,38,101,64,84])))),media:()=>pt().then((()=>J(()=>import("./MediaLayerView2D-Lr5NzpzR.js"),__vite__mapDeps([271,272,101,64,88,221,220,87,59,213,109,141,140,96,34,30,35,139,223,218,214,156,134,219,90,104,224,225,75,93,217,91,97,94,95,153,150,132,230,86,89,32,27,38,84,227,273,228,240,202])))),"ogc-feature":()=>pt().then((()=>J(()=>import("./OGCFeatureLayerView2D-BVqzpcdU.js"),__vite__mapDeps([274,246,34,30,35,184,166,42,89,247,169,248,249,32,27,41,240,221,202,233,88,87,59,214,213,234,220,109,141,140,96,217,93,218,156,134,219,90,91,97,104,188,222,250,103,183,245,242])))),"open-street-map":Bf,"oriented-imagery":Pu,route:()=>pt().then((()=>J(()=>import("./RouteLayerView2D-C9QbjRb3.js"),__vite__mapDeps([275,276,277,240,221,202,231,232,233,88,87,59,214,213,234,220,109,141,140,96,34,30,35,217,93,218,156,134,219,90,91,97,230,86,89,32,27,38,101,64,84])))),stream:()=>pt().then((()=>J(()=>import("./StreamLayerView2D-DKALRf3R.js"),__vite__mapDeps([278,169,246,34,30,35,184,166,42,89,247,248,249,32,27,41,240,221,202,233,88,87,59,214,213,234,220,109,141,140,96,217,93,218,156,134,219,90,91,97,104,188,222,250,103,183,245,242])))),"subtype-group":()=>pt().then((()=>J(()=>import("./SubtypeGroupLayerView2D-DA3FsmqP.js"),__vite__mapDeps([279,246,34,30,35,184,166,42,89,247,169,248,249,32,27,41,240,221,202,233,88,87,59,214,213,234,220,109,141,140,96,217,93,218,156,134,219,90,91,97,104,188,222,250,103,183,245,242])))),tile:Bf,"vector-tile":()=>pt().then((()=>J(()=>import("./VectorTileLayerView2D-DcFs8aVd.js"),__vite__mapDeps([280,139,75,225,140,141,213,220,87,59,109,221,96,34,30,35,234,45,142,143,240,202,242])))),video:()=>pt().then((()=>J(()=>import("./VideoLayerView2D-DwXs45kP.js"),__vite__mapDeps([281,282,283,273,109,220,87,59,213,221,141,140,96,34,30,35,217,93,218,214,156,134,88,219,90,91,97,228,240,202,231,232,233,234,230,86,89,32,27,38,101,64,84])))),wcs:()=>pt().then((()=>J(()=>import("./ImageryTileLayerView2D-zliRcVi7.js"),__vite__mapDeps([262,263,261,213,59,117,220,87,109,221,141,140,96,34,30,35,240,202,120,264,234,218,214,156,134,93,239,219,90,265,121,247,245,242])))),"web-tile":Bf,wfs:Pu,wms:()=>pt().then((()=>J(()=>import("./WMSLayerView2D-tcxmkIMR.js"),__vite__mapDeps([284,252,220,87,59,213,109,221,141,140,96,34,30,35,238,218,214,156,134,93,239,240,202,253,242,285,247])))),wmts:()=>pt().then((()=>J(()=>import("./WMTSLayerView2D-qc8fsRcq.js"),__vite__mapDeps([286,237,238,221,218,214,213,156,134,93,239,220,87,59,109,141,140,96,34,30,35,234,240,202,242])))),"line-of-sight":null,"base-elevation":null,"building-scene":null,dimension:null,elevation:null,"integrated-mesh":null,"integrated-mesh-3dtiles":null,"point-cloud":null,viewshed:null,voxel:null,scene:null,unknown:null,unsupported:null};function mde(e){const t=e.declaredClass?e.declaredClass.slice(e.declaredClass.lastIndexOf(".")+1):"Unknown",i=t.replaceAll(/([a-z])([A-Z])/g,"$1-$2").toLowerCase();return new j(`${i}:view-not-supported`,`${t} is not supported in 2D`)}const Ck={hasLayerViewModule:e=>Ek[e.type]!=null,importLayerView:e=>{const t=Ek[e.type];if(t==null)throw mde(e);return t(e)}};var as;let _f=(as=class{static getId(t,i,r,s){return typeof t=="object"?`${t.level}/${t.row}/${t.col}/${t.world}`:`${t}/${i}/${r}/${s}`}constructor(t,i,r,s){this.set(t,i,r,s)}get key(){return this}get id(){return this.toString()}get normalizedId(){return`${this.level}/${this.row}/${this.col}`}set id(t){this.set(t)}get hash(){const t=4095&this.row,i=4095&this.col,r=63&this.level;return(3&this.world)<<30|i<<22|t<<8|r}acquire(t,i,r,s){this.set(t,i,r,s)}contains(t){const i=t.level-this.level;return i>=0&&this.row===t.row>>i&&this.col===t.col>>i&&this.world===t.world}containsChild(t){const i=t.level-this.level;return i>0&&this.row===t.row>>i&&this.col===t.col>>i&&this.world===t.world}equals(t){return this.level===t.level&&this.row===t.row&&this.col===t.col&&this.world===t.world}clone(){return new as(this)}release(){this.level=0,this.row=0,this.col=0,this.world=0}set(t,i,r,s){if(t==null)this.level=0,this.row=0,this.col=0,this.world=0;else if(typeof t=="object")this.level=t.level||0,this.row=t.row||0,this.col=t.col||0,this.world=t.world||0;else if(typeof t=="string"){const[n,o,a,l]=t.split("/");this.level=parseFloat(n),this.row=parseFloat(o),this.col=parseFloat(a),this.world=parseFloat(l)}else this.level=+t,this.row=+i,this.col=+r,this.world=+s||0;return this}toString(){return`${this.level}/${this.row}/${this.col}/${this.world}`}getParentKey(){return this.level<=0?null:new as(this.level-1,this.row>>1,this.col>>1,this.world)}getNormalizedNeighbor(t,i,r){const s=this.clone();return s.col+=t,s.row+=i,r.normalizeKey(s),s}getChildKeys(){const t=this.level+1,i=this.row<<1,r=this.col<<1,s=this.world;return[new as(t,i,r,s),new as(t,i,r+1,s),new as(t,i+1,r,s),new as(t,i+1,r+1,s)]}compareRowMajor(t){return this.row<t.row?-1:this.row>t.row?1:this.col<t.col?-1:this.col>t.col?1:0}},as.pool=new _h(as,null,null,25,50),as);function Uh(e,t){return[e,t]}function Iu(e,t,i){return e[0]=t,e[1]=i,e}function yde(e,t,i,r,s){return e[0]=t,e[1]=i,e[2]=r,e[3]=s,e}const nn=new _f("0/0/0/0");let gde=class PU{static create(t,i,r=null){const s=ar(t.spatialReference),n=i.origin||Uh(t.origin.x,t.origin.y),o=Uh(t.size[0]*i.resolution,t.size[1]*i.resolution),a=Uh(-1/0,-1/0),l=Uh(1/0,1/0),u=Uh(1/0,1/0);r!=null&&(Iu(a,Math.max(0,Math.floor((r.xmin-n[0])/o[0])),Math.max(0,Math.floor((n[1]-r.ymax)/o[1]))),Iu(l,Math.max(0,Math.floor((r.xmax-n[0])/o[0])),Math.max(0,Math.floor((n[1]-r.ymin)/o[1]))),Iu(u,l[0]-a[0]+1,l[1]-a[1]+1));const{cols:c,rows:d}=i;let m,y,g,_;return!r&&c&&d&&(Iu(a,c[0],d[0]),Iu(l,c[1],d[1]),Iu(u,c[1]-c[0]+1,d[1]-d[0]+1)),t.isWrappable?(m=Uh(Math.ceil(Math.round((s.valid[1]-s.valid[0])/i.resolution)/t.size[0]),u[1]),y=!0,g=s.origin,_=s.valid):(m=u,y=!1),new PU(i.level,i.resolution,i.scale,n,a,l,u,o,m,y,g,_)}constructor(t,i,r,s,n,o,a,l,u,c,d,m){this.level=t,this.resolution=i,this.scale=r,this.origin=s,this.first=n,this.last=o,this.size=a,this.norm=l,this.worldSize=u,this.wrap=c,this._spatialReferenceOrigin=d,this._spatialReferenceValid=m}normalizeCol(t){if(!this.wrap)return t;const i=this.worldSize[0];return t<0?i-1-Math.abs((t+1)%i):t%i}normalizeKey(t){if(!this.wrap)return;const i=this.worldSize[0],r=t.col;r<0?(t.col=r+i,t.world-=1):r>=i&&(t.col=r-i,t.world+=1)}denormalizeCol(t,i){return this.wrap?this.worldSize[0]*i+t:t}getWorldForColumn(t){return this.wrap?Math.floor(t/this.worldSize[0]):0}getFirstColumnForWorld(t){return t*this.worldSize[0]+this.first[0]}getLastColumnForWorld(t){return t*this.worldSize[0]+this.first[0]+this.size[0]-1}getColumnForX(t){return(t-this.origin[0])/this.norm[0]}getXForColumn(t){const i=this.origin[0]+t*this.norm[0],r=this._spatialReferenceOrigin,s=this._spatialReferenceValid;return this.wrap&&r&&s?i===r[0]?s[0]:this.origin[0]===r[0]&&t===this.worldSize[0]?s[1]:i:i}getRowForY(t){return(this.origin[1]-t)/this.norm[1]}getYForRow(t){return this.origin[1]-t*this.norm[1]}getTileBounds(t,i,r=!1){nn.set(i);const s=r?nn.col:this.denormalizeCol(nn.col,nn.world),n=nn.row;return yde(t,this.getXForColumn(s),this.getYForRow(n+1),this.getXForColumn(s+1),this.getYForRow(n)),t}getTileCoords(t,i,r=!1){nn.set(i);const s=r?nn.col:this.denormalizeCol(nn.col,nn.world);return Array.isArray(t)?Iu(t,this.getXForColumn(s),this.getYForRow(nn.row)):(t.x=this.getXForColumn(s),t.y=this.getYForRow(nn.row)),t}};var eh;let dP=(eh=class{constructor(){this.spans=[]}acquire(t){this.lodInfo=t}release(){this.lodInfo=null,this.spans.length=0}*keys(){const t=this.lodInfo;for(const{row:i,colFrom:r,colTo:s}of this.spans)for(let n=r;n<=s;n++){const o=t.getWorldForColumn(n);yield new _f(t.level,i,t.normalizeCol(n),o)}}forEach(t,i){const{spans:r,lodInfo:s}=this,{level:n}=s;if(r.length!==0)for(const{row:o,colFrom:a,colTo:l}of r)for(let u=a;u<=l;u++)t.call(i,n,o,s.normalizeCol(u),s.getWorldForColumn(u))}},eh.pool=new _h(eh),eh),U2=class{constructor(t,i,r){this.row=t,this.colFrom=i,this.colTo=r}};const gt=new _f("0/0/0/0");let _de=class IU{static create(t,i){t[1]>i[1]&&([t,i]=[i,t]);const[r,s]=t,[n,o]=i,a=n-r,l=o-s,u=l!==0?a/l:0,c=(Math.ceil(s)-s)*u,d=(Math.floor(s)-s)*u;return new IU(r,Math.floor(s),Math.ceil(o),u,a<0?c:d,a<0?d:c,a<0?n:r,a<0?r:n)}constructor(t,i,r,s,n,o,a,l){this.x=t,this.ymin=i,this.ymax=r,this.invM=s,this.leftAdjust=n,this.rightAdjust=o,this.leftBound=a,this.rightBound=l}incrRow(){this.x+=this.invM}getLeftCol(){return Math.max(this.x+this.leftAdjust,this.leftBound)}getRightCol(){return Math.min(this.x+this.rightAdjust,this.rightBound)}};const Jr=[[0,0],[0,0],[0,0],[0,0]],vde=1e-6;let bde=class{constructor(t,i=null,r=t.lods[0].level,s=t.lods[t.lods.length-1].level){this.tileInfo=t,this.fullExtent=i,this.scales=[],this._infoByScale={},this._infoByLevel={};const n=t.lods.filter((a=>a.level>=r&&a.level<=s));this.minScale=n[0].scale,this.maxScale=n[n.length-1].scale;const o=this._lodInfos=n.map((a=>gde.create(t,a,i)));n.forEach(((a,l)=>{this._infoByLevel[a.level]=o[l],this._infoByScale[a.scale]=o[l],this.scales[l]=a.scale}),this),this._wrap=t.isWrappable}get spatialReference(){return this.tileInfo.spatialReference}getLODInfoAt(t){return this._infoByLevel[typeof t=="number"?t:t.level]}getTileBounds(t,i,r=!1){gt.set(i);const s=this._infoByLevel[gt.level];return s?s.getTileBounds(t,gt,r):t}getTileCoords(t,i,r=!1){gt.set(i);const s=this._infoByLevel[gt.level];return s?s.getTileCoords(t,gt,r):t}getTileCoverage(t,i=192,r=!0,s="closest"){if(!r&&(t.scale>this.minScale||t.scale<this.maxScale))return null;const n=s==="closest"?this.getClosestInfoForScale(t.scale):this.getSmallestInfoForScale(t.scale),o=dP.pool.acquire(n),a=this._wrap;let l,u,c,d=1/0,m=-1/0;const y=o.spans;Jr[0][0]=Jr[0][1]=Jr[1][1]=Jr[3][0]=-i,Jr[1][0]=Jr[2][0]=t.size[0]+i,Jr[2][1]=Jr[3][1]=t.size[1]+i;for(const b of Jr)t.toMap(b,b),b[0]=n.getColumnForX(b[0]),b[1]=n.getRowForY(b[1]);const g=[];let _=3;for(let b=0;b<4;b++){if(Jr[b][1]===Jr[_][1]){_=b;continue}const S=_de.create(Jr[b],Jr[_]);d=Math.min(S.ymin,d),m=Math.max(S.ymax,m),g[S.ymin]===void 0&&(g[S.ymin]=[]),g[S.ymin].push(S),_=b}if(d==null||m==null||m-d>100)return null;let v=[];for(l=d;l<m;){g[l]!=null&&(v=v.concat(g[l])),u=1/0,c=-1/0;for(let b=v.length-1;b>=0;b--){const S=v[b];u=Math.min(u,S.getLeftCol()),c=Math.max(c,S.getRightCol())}if(u=Math.floor(u),c=Math.floor(c),l>=n.first[1]&&l<=n.last[1])if(a)if(n.size[0]<n.worldSize[0]){const b=Math.floor(c/n.worldSize[0]);for(let S=Math.floor(u/n.worldSize[0]);S<=b;S++)y.push(new U2(l,Math.max(n.getFirstColumnForWorld(S),u),Math.min(n.getLastColumnForWorld(S),c)))}else y.push(new U2(l,u,c));else u>n.last[0]||c<n.first[0]||(u=Math.max(u,n.first[0]),c=Math.min(c,n.last[0]),y.push(new U2(l,u,c)));l+=1;for(let b=v.length-1;b>=0;b--){const S=v[b];S.ymax>=l?S.incrRow():v.splice(b,1)}}return o}getTileParentId(t){gt.set(t);const i=this._infoByLevel[gt.level],r=this._lodInfos.indexOf(i)-1;return r<0?null:(this._getTileIdAtLOD(gt,this._lodInfos[r],gt),gt.id)}getTileResolution(t){const i=this._infoByLevel[typeof t=="object"?t.level:t];return i?i.resolution:-1}getTileScale(t){const i=this._infoByLevel[t.level];return i?i.scale:-1}intersects(t,i){gt.set(i);const r=this._infoByLevel[gt.level],s=t.lodInfo;if(s.resolution>r.resolution){this._getTileIdAtLOD(gt,s,gt);const o=s.denormalizeCol(gt.col,gt.world);for(const a of t.spans)if(a.row===gt.row&&a.colFrom<=o&&a.colTo>=o)return!0}if(s.resolution<r.resolution){const[o,a,l,u]=t.spans.reduce(((_,v)=>(_[0]=Math.min(_[0],v.row),_[1]=Math.max(_[1],v.row),_[2]=Math.min(_[2],v.colFrom),_[3]=Math.max(_[3],v.colTo),_)),[1/0,-1/0,1/0,-1/0]),c=r.denormalizeCol(gt.col,gt.world),d=s.getColumnForX(r.getXForColumn(c)),m=s.getRowForY(r.getYForRow(gt.row)),y=s.getColumnForX(r.getXForColumn(c+1))-1,g=s.getRowForY(r.getYForRow(gt.row+1))-1;return!(d>u||y<l||m>a||g<o)}const n=s.denormalizeCol(gt.col,gt.world);return t.spans.some((o=>o.row===gt.row&&o.colFrom<=n&&o.colTo>=n))}normalizeBounds(t,i,r){if(t[0]=i[0],t[1]=i[1],t[2]=i[2],t[3]=i[3],this._wrap){const s=ar(this.tileInfo.spatialReference),n=-r*(s.valid[1]-s.valid[0]);t[0]+=n,t[2]+=n}return t}getSmallestInfoForScale(t){const i=this.scales;if(this._infoByScale[t])return this._infoByScale[t];if(t>i[0])return this._infoByScale[i[0]];for(let r=1;r<i.length-1;r++)if(t>i[r]+vde)return this._infoByScale[i[r-1]];return this._infoByScale[i[i.length-1]]}getClosestInfoForScale(t){const i=this.scales;return this._infoByScale[t]||(t=i.reduce(((r,s)=>Math.abs(s-t)<Math.abs(r-t)?s:r),i[0])),this._infoByScale[t]}scaleToLevel(t){const i=this.scales;if(this._infoByScale[t])return this._infoByScale[t].level;for(let r=i.length-1;r>=0;r--)if(t<i[r])return r===i.length-1?this._infoByScale[i[i.length-1]].level:this._infoByScale[i[r]].level+(i[r]-t)/(i[r]-i[r+1]);return this._infoByScale[i[0]].level}scaleToZoom(t){return this.tileInfo.scaleToZoom(t)}zoomToScale(t){return this.tileInfo.zoomToScale(t)}_getTileIdAtLOD(t,i,r){const s=this._infoByLevel[r.level];return t.set(r),i.resolution<s.resolution?null:(i.resolution===s.resolution||(t.level=i.level,t.col=Math.floor(r.col*s.resolution/i.resolution+.01),t.row=Math.floor(r.row*s.resolution/i.resolution+.01)),t)}},wde=class{constructor(t,i){this.item=t,this.controller=i,this.promise=null}},Sde=class{constructor(t){this._schedule=null,this._task=null,this._deferreds=new u1,this._controllers=new u1,this._processingItems=new u1,this._pausedSignal=Wp(!1),this.concurrency=1,t.concurrency&&(this.concurrency=t.concurrency),this._queue=new Zy(t.peeker),this.process=t.process;const i=t.scheduler;t.priority&&i&&(this._task=i.registerTask(t.priority,this))}destroy(){this.clear(),this._schedule=St(this._schedule),this._task=St(this._task)}get updating(){return!!this._task?.updating||this.running}get length(){return this._processingItems.size+this._queue.length}abort(t){const i=this._controllers.get(t);i&&i.abort()}clear(){this._queue.clear();const t=[];this._controllers.forEach((i=>t.push(i))),this._controllers.clear(),t.forEach((i=>i.abort())),this._processingItems.clear(),this._cancelNext()}forEach(t){this._deferreds.forEach(((i,r)=>t(r)))}get(t){const i=this._deferreds.get(t);return i?i.promise:void 0}isOngoing(t){return this._processingItems.has(t)}has(t){return this._deferreds.has(t)}pause(){this._pausedSignal.value||(this._pausedSignal.value=!0,this._cancelNext())}push(t,i){const r=this.get(t);if(r)return r;const s=new AbortController;let n=null;i&&(n=kn(i,(()=>s.abort())));const o=()=>{const c=this._processingItems.get(t);c&&c.controller.abort(),a(),u.reject(yt())},a=()=>{l.remove(),n?.remove(),this._removeItem(t),this._queue.remove(t),this._scheduleNext()},l=LE(s.signal,o),u=Gs();return this._deferreds.set(t,u),this._controllers.set(t,s),u.promise.then(a,a),this._queue.push(t),this._scheduleNext(),u.promise}last(){return this._queue.last()}lastPromise(){const t=this.last();return t?this.get(t):null}peek(){return this._queue.peek()}popLast(){const t=this._queue.popLast();return t&&(this._deferreds.get(t)?.reject(yt()),this._removeItem(t)),t}reset(){const t=Array.from(this._processingItems.values());this._processingItems.clear();for(const i of t)this._queue.push(i.item),i.controller.abort();this._scheduleNext()}resume(){this._pausedSignal.value&&(this._pausedSignal.value=!1,this._scheduleNext())}takeAll(){const t=[];for(;this._queue.length;)t.push(this._queue.pop());return this.clear(),t}get running(){return!this._pausedSignal.value&&this._queue.length>0&&this._processingItems.size<this.concurrency}runTask(t){for(;!t.done&&this._queue.length>0&&this._processingItems.size<this.concurrency;)this._process(this._queue.pop()),t.madeProgress()}_removeItem(t){this._deferreds.delete(t),this._controllers.delete(t),this._processingItems.delete(t)}_scheduleNext(){this._task||this._pausedSignal.value||this._schedule||(this._schedule=Lg((()=>{this._schedule=null,this._next()})))}_next(){for(;this._queue.length>0&&this._processingItems.size<this.concurrency;)this._process(this._queue.pop())}_cancelNext(){this._schedule&&(this._schedule.remove(),this._schedule=null)}_processResult(t,i){this._canProcessFulfillment(t)&&(this._scheduleNext(),this._deferreds.get(t.item).resolve(i))}_processError(t,i){this._canProcessFulfillment(t)&&(this._scheduleNext(),this._deferreds.get(t.item).reject(i))}_canProcessFulfillment(t){return!!this._deferreds.get(t.item)&&this._processingItems.get(t.item)===t}_process(t){if(t==null)return;let i;const r=new AbortController,s=new wde(t,r);this._processingItems.set(t,s);try{i=this.process(t,r.signal)}catch(n){this._processError(s,n)}Bo(i)?(s.promise=i,i.then((n=>this._processResult(s,n)),(n=>this._processError(s,n)))):this._processResult(s,i)}get test(){}};const Pk=[0,0];let fa=class extends le{constructor(t){super(t),this._keyToItem=new Map,this._tilesByScale=new Map,this.concurrency=6}initialize(){const{concurrency:t,process:i,scheduler:r,priority:s}=this;this._queue=new Sde({concurrency:t,scheduler:r,priority:s,process:(n,o)=>{const a=this._keyToItem.get(n);return i(a,{signal:o})},peeker:n=>this._peek(n)})}destroy(){this.clear(),this._queue=Ot(this._queue)}get length(){return this._queue?this._queue.length:0}abort(t){const i=typeof t=="string"?t:t.id;this._queue.abort(i)}clear(){this._queue.clear(),this._keyToItem.clear(),this._tilesByScale.clear()}has(t){return typeof t=="string"?this._keyToItem.has(t):this._keyToItem.has(t.id)}pause(){this._queue.pause()}push(t){const i=t.key.id;if(this._queue.has(i))return this._queue.get(i);const r=this._queue.push(i),s=this.tileInfoView.getTileScale(t.key),n=of(this._tilesByScale,s,(()=>new Set)),o=()=>{n.delete(t.key),n.size===0&&this._tilesByScale.delete(s),this._keyToItem.delete(i)};return n.add(t.key),this._keyToItem.set(i,t),r.then(o,o),r}reset(){this._queue.reset()}resume(){this._queue.resume()}_peek(t){if(!this.state)return t.values().next().value;const i=new Set;for(const o of t)i.add(this._keyToItem.get(o).key);const r=this.state.scale;let s,n=Number.POSITIVE_INFINITY;for(const[o,a]of this._tilesByScale)if(HD(a,(l=>i.has(l)))){const l=Math.abs(o-r);l<n&&(s=a,n=l)}return this._getClosestTileKey(s,t).id}_getClosestTileKey(t,i){const r=this.tileInfoView,s=this.state.center;let n,o=Number.POSITIVE_INFINITY;for(const a of t)if(i.has(a.id)){r.getTileCoords(Pk,a);const l=dw(Pk,s);l<o&&(o=l,n=a)}return n}};h([f({constructOnly:!0})],fa.prototype,"concurrency",void 0),h([f({constructOnly:!0})],fa.prototype,"priority",void 0),h([f({constructOnly:!0})],fa.prototype,"process",void 0),h([f({constructOnly:!0})],fa.prototype,"scheduler",void 0),h([f()],fa.prototype,"state",void 0),h([f({constructOnly:!0})],fa.prototype,"tileInfoView",void 0),fa=h([I("esri.views.2d.tiling.TileQueue")],fa);const O3e=fa;let xde=class{constructor(t,i,r){this.maxSize=t,this._tileInfoView=i,this._removedFunc=r,this._tilePerId=new Map,this._tileKeysPerLevel=[]}clear(){this._tilePerId.clear(),this._tileKeysPerLevel=[]}has(t){return this._tilePerId.has(t)}get(t){return this._tilePerId.get(t)}pop(t){const i=this._tilePerId.get(t);if(!i)return;const r=i.key.level,s=this._tileKeysPerLevel[r];Ik(this._tilePerId,t);for(let n=0;n<s.length;n++)if(s[n].id===t){s.splice(n,1);break}return i.visible=!0,i}add(t){t.visible=!1;const i=t.key,r=i.id;if(this._tilePerId.has(r))return;this._tilePerId.set(r,t);const s=i.level;this._tileKeysPerLevel[s]||(this._tileKeysPerLevel[s]=[]),this._tileKeysPerLevel[s].push(i)}prune(t,i,r){let s=this._tilePerId.size;if(s<=this.maxSize)return;let n=this._tileKeysPerLevel.length-1;for(;s>this.maxSize&&n>=0;)n!==t&&(s=this._pruneAroundCenterTile(s,i,r,n)),n--;s>this.maxSize&&(s=this._pruneAroundCenterTile(s,i,r,t))}_pruneAroundCenterTile(t,i,r,s){const n=this._tileKeysPerLevel[s];if(!n||n.length===0)return t;const{size:o,origin:a}=this._tileInfoView.tileInfo,l=r*o[0],u=r*o[1],c=[0,0],d=[0,0];for(n.sort(((m,y)=>(c[0]=a.x+l*(m.col+.5),c[1]=a.y-u*(m.row+.5),d[0]=a.x+l*(y.col+.5),d[1]=a.y-u*(y.row+.5),Lv(c,i)-Lv(d,i))));n.length>0;){const m=n.pop();if(this._removeTile(m.id),--t===this.maxSize)break}return t}_removeTile(t){const i=this._tilePerId.get(t);this._removedFunc&&i&&this._removedFunc(i),Ik(this._tilePerId,t)}};function Ik(e,t){e.delete(t)}const Au=new _f(0,0,0,0),Jo=new Map,qf=[],j2=[];let D3e=class{constructor(t){this._previousScale=Number.POSITIVE_INFINITY,this.cachePolicy="keep",this.coveragePolicy="closest",this.resampling=!0,this.tileIndex=new Map,this.tiles=[],this.buffer=192,this.acquireTile=t.acquireTile,this.releaseTile=t.releaseTile,this.tileInfoView=t.tileInfoView,t.resampling!=null&&(this.resampling=t.resampling),t.cachePolicy&&(this.cachePolicy=t.cachePolicy),t.coveragePolicy&&(this.coveragePolicy=t.coveragePolicy),t.buffer!=null&&(this.buffer=t.buffer),t.cacheSize&&(this._tileCache=new xde(t.cacheSize,this.tileInfoView,(i=>{this.releaseTile(i)})))}destroy(){this.tileIndex.clear()}update(t){const{resampling:i,tileIndex:r}=this,{scale:s,center:n,resolution:o}=t.state,{minScale:a,maxScale:l}=this.tileInfoView,u=!t.stationary&&s>this._previousScale;if(this._previousScale=s,!i&&(s>a||s<l))return this.tiles.length=0,void this.clear();const c=this.tileInfoView.getTileCoverage(t.state,this.buffer,this.resampling,this.coveragePolicy);if(!c)return this.tiles.length=0,void this.clear();const{spans:d,lodInfo:m}=c,{level:y}=m;this.tiles.length=0,r.forEach((b=>b.visible=!0));let g=0,_=0;if(d.length>0)for(const{row:b,colFrom:S,colTo:$}of d)for(let E=S;E<=$;E++){g++;const C=Au.set(y,b,m.normalizeCol(E),m.getWorldForColumn(E)).id;let P=r.get(C);if(P)P.isReady?(Jo.set(C,P),_++):u||this._addParentTile(C,Jo);else{if(this._tileCache?.has(C)){if(P=this._tileCache.pop(C),this.tileIndex.set(C,P),P.isReady){Jo.set(C,P),_++;continue}}else P=this.acquireTile(Au),this.tileIndex.set(C,P);u||this._addParentTile(C,Jo)}}const v=_===g;for(const[b,S]of r){if(Jo.has(b))continue;Au.set(b);const $=this.tileInfoView.intersects(c,Au),E=this.cachePolicy==="purge"?Au.level!==y:Au.level>y;!$||!u&&v?!E&&$||qf.push(S):S.isReady?E&&this.cachePolicy==="purge"&&this._hasReadyAncestor(Au,y)?qf.push(S):j2.push(S):E&&qf.push(S)}for(const b of j2)b.isReady&&Jo.set(b.key.id,b);for(const b of qf)this._tileCache?this._tileCache.add(b):this.releaseTile(b),r.delete(b.key.id);for(const b of Jo.values())this.tiles.push(b);for(const b of r.values())Jo.has(b.key.id)||(b.visible=!1);this._tileCache?.prune(y,n,o),dP.pool.release(c),j2.length=0,qf.length=0,Jo.clear()}clear(){const{tileIndex:t}=this;for(const i of t.values())this.releaseTile(i);t.clear()}refresh(t){for(const i of this.tileIndex.values())t(i);this._tileCache?.clear()}updateCacheSize(t){this._tileCache&&(this._tileCache.maxSize=t)}_addParentTile(t,i){let r=t,s=null;for(;r=this.tileInfoView.getTileParentId(r),r;)if(this.tileIndex.has(r)){if(s=this.tileIndex.get(r),s?.isReady){i.has(s.key.id)||i.set(s.key.id,s);break}}else if(this._tileCache?.has(r)&&(s=this._tileCache.pop(r),this.tileIndex.set(r,s),s?.isReady)){i.has(s.key.id)||i.set(s.key.id,s);break}}_hasReadyAncestor(t,i){const r=Qt();this.tileInfoView.getTileBounds(r,t,!0);for(const s of this.tileIndex.values())if(s.isReady&&s.key.level>=i&&s.key.level<t.level){const n=Qt();if(this.tileInfoView.getTileBounds(n,s.key,!0),YQ(n,r))return!0}return!1}},$de=class{constructor(t,i={}){this.events=new Ja,this._hasMajorPerformanceCaveat=!1,this._lastRenderFrameCounter=0,t!=null?(this._canvas=document.createElement("canvas"),this._canvas.setAttribute("style","width: 100%; height:100%; display:block; willChange:transform"),t.contains(this._canvas)||t.appendChild(this._canvas)):i.canvas!=null&&(this._canvas=i.canvas);const r={failIfMajorPerformanceCaveat:!0,alpha:!0,antialias:!1,depth:!0,stencil:!0,powerPreference:"high-performance"};let s=this._canvas.getContext("webgl2",r);s||(s=this._canvas.getContext("webgl2",{...r,failIfMajorPerformanceCaveat:!1}),this._hasMajorPerformanceCaveat=!0),this._gl=s,this._handles=gh([lf(this._canvas,"webglcontextlost",(n=>this.events.emit("webgl-context-lost",n)))])}destroy(){this._canvas.remove(),this._canvas=null,this._handles.remove(),this._gl=null}get gl(){return this._gl}get canvas(){return this._canvas}render(t,i){if(this._hasMajorPerformanceCaveat||N("esri-force-performance-mode")){if(++this._lastRenderFrameCounter>=N("esri-performance-mode-frames-between-render")&&(i(),this._lastRenderViewState=t.state.clone(),this._lastRenderFrameCounter=0),this._lastRenderViewState){const[r,s,n,o,a,l]=this._computeViewTransform(this._lastRenderViewState,t.state);this._canvas.style.transform=`matrix(${r}, ${s}, ${n}, ${o}, ${a}, ${l})`}}else i()}resize(t){const i=this._canvas,r=i.style,{state:{size:s},pixelRatio:n}=t,o=s[0],a=s[1],l=Math.round(o*n),u=Math.round(a*n);i.width===l&&i.height===u||(i.width=l,i.height=u),r.width=o+"px",r.height=a+"px"}_computeViewTransform(t,i){const[r,s]=t.center,[n,o]=i.center,[a,l]=t.toScreen([0,0],n,o),[u,c]=t.toScreen([0,0],r,s),d=u-a,m=c-l,y=t.scale/i.scale,g=i.rotation-t.rotation,_=zo();return Qg(_),e0(_,_,[y,y]),vu(_,_,mf(g)),Fo(_,_,[d,m]),_}};function Mde(e,t,i,r,s){AU(e,t,i||0,r||e.length-1,s||Tde)}function AU(e,t,i,r,s){for(;r>i;){if(r-i>600){var n=r-i+1,o=t-i+1,a=Math.log(n),l=.5*Math.exp(2*a/3),u=.5*Math.sqrt(a*l*(n-l)/n)*(o-n/2<0?-1:1);AU(e,t,Math.max(i,Math.floor(t-o*l/n+u)),Math.min(r,Math.floor(t+(n-o)*l/n+u)),s)}var c=e[t],d=i,m=r;for(Hf(e,i,t),s(e[r],c)>0&&Hf(e,i,r);d<m;){for(Hf(e,d,m),d++,m--;s(e[d],c)<0;)d++;for(;s(e[m],c)>0;)m--}s(e[i],c)===0?Hf(e,i,m):Hf(e,++m,r),m<=t&&(i=m+1),t<=m&&(r=m-1)}}function Hf(e,t,i){var r=e[t];e[t]=e[i],e[i]=r}function Tde(e,t){return e<t?-1:e>t?1:0}function Hv(e,t){if(!(this instanceof Hv))return new Hv(e,t);this._maxEntries=Math.max(4,e||9),this._minEntries=Math.max(2,Math.ceil(.4*this._maxEntries)),t&&(typeof t=="function"?this.toBBox=t:this._initFormat(t)),this.clear()}function Ede(e,t,i){if(!i)return t.indexOf(e);for(var r=0;r<t.length;r++)if(i(e,t[r]))return r;return-1}function jh(e,t){Hm(e,0,e.children.length,t,e)}function Hm(e,t,i,r,s){s||(s=pd(null)),s.minX=1/0,s.minY=1/0,s.maxX=-1/0,s.maxY=-1/0;for(var n,o=t;o<i;o++)n=e.children[o],Wm(s,e.leaf?r(n):n);return s}function Wm(e,t){return e.minX=Math.min(e.minX,t.minX),e.minY=Math.min(e.minY,t.minY),e.maxX=Math.max(e.maxX,t.maxX),e.maxY=Math.max(e.maxY,t.maxY),e}function Ak(e,t){return e.minX-t.minX}function Lk(e,t){return e.minY-t.minY}function G2(e){return(e.maxX-e.minX)*(e.maxY-e.minY)}function U0(e){return e.maxX-e.minX+(e.maxY-e.minY)}function Cde(e,t){return(Math.max(t.maxX,e.maxX)-Math.min(t.minX,e.minX))*(Math.max(t.maxY,e.maxY)-Math.min(t.minY,e.minY))}function Pde(e,t){var i=Math.max(e.minX,t.minX),r=Math.max(e.minY,t.minY),s=Math.min(e.maxX,t.maxX),n=Math.min(e.maxY,t.maxY);return Math.max(0,s-i)*Math.max(0,n-r)}function B2(e,t){return e.minX<=t.minX&&e.minY<=t.minY&&t.maxX<=e.maxX&&t.maxY<=e.maxY}function j0(e,t){return t.minX<=e.maxX&&t.minY<=e.maxY&&t.maxX>=e.minX&&t.maxY>=e.minY}function pd(e){return{children:e,height:1,leaf:!0,minX:1/0,minY:1/0,maxX:-1/0,maxY:-1/0}}function kk(e,t,i,r,s){for(var n,o=[t,i];o.length;)(i=o.pop())-(t=o.pop())<=r||(n=t+Math.ceil((i-t)/r/2)*r,Mde(e,n,t,i,s),o.push(t,n,n,i))}Hv.prototype={all:function(){return this._all(this.data,[])},search:function(e){var t=this.data,i=[],r=this.toBBox;if(!j0(e,t))return i;for(var s,n,o,a,l=[];t;){for(s=0,n=t.children.length;s<n;s++)o=t.children[s],j0(e,a=t.leaf?r(o):o)&&(t.leaf?i.push(o):B2(e,a)?this._all(o,i):l.push(o));t=l.pop()}return i},collides:function(e){var t=this.data,i=this.toBBox;if(!j0(e,t))return!1;for(var r,s,n,o,a=[];t;){for(r=0,s=t.children.length;r<s;r++)if(n=t.children[r],j0(e,o=t.leaf?i(n):n)){if(t.leaf||B2(e,o))return!0;a.push(n)}t=a.pop()}return!1},load:function(e){if(!e||!e.length)return this;if(e.length<this._minEntries){for(var t=0,i=e.length;t<i;t++)this.insert(e[t]);return this}var r=this._build(e.slice(),0,e.length-1,0);if(this.data.children.length)if(this.data.height===r.height)this._splitRoot(this.data,r);else{if(this.data.height<r.height){var s=this.data;this.data=r,r=s}this._insert(r,this.data.height-r.height-1,!0)}else this.data=r;return this},insert:function(e){return e!=null&&this._insert(e,this.data.height-1),this},clear:function(){return this.data=pd([]),this},remove:function(e,t){if(e==null)return this;for(var i,r,s,n,o=this.data,a=this.toBBox(e),l=[],u=[];o||l.length;){if(o||(o=l.pop(),r=l[l.length-1],i=u.pop(),n=!0),o.leaf&&(s=Ede(e,o.children,t))!==-1)return o.children.splice(s,1),l.push(o),this._condense(l),this;n||o.leaf||!B2(o,a)?r?(i++,o=r.children[i],n=!1):o=null:(l.push(o),u.push(i),i=0,r=o,o=o.children[0])}return this},toBBox:function(e){return e},compareMinX:Ak,compareMinY:Lk,toJSON:function(){return this.data},fromJSON:function(e){return this.data=e,this},_all:function(e,t){for(var i=[];e;)e.leaf?t.push.apply(t,e.children):i.push.apply(i,e.children),e=i.pop();return t},_build:function(e,t,i,r){var s,n=i-t+1,o=this._maxEntries;if(n<=o)return jh(s=pd(e.slice(t,i+1)),this.toBBox),s;r||(r=Math.ceil(Math.log(n)/Math.log(o)),o=Math.ceil(n/Math.pow(o,r-1))),(s=pd([])).leaf=!1,s.height=r;var a,l,u,c,d=Math.ceil(n/o),m=d*Math.ceil(Math.sqrt(o));for(kk(e,t,i,m,this.compareMinX),a=t;a<=i;a+=m)for(kk(e,a,u=Math.min(a+m-1,i),d,this.compareMinY),l=a;l<=u;l+=d)c=Math.min(l+d-1,u),s.children.push(this._build(e,l,c,r-1));return jh(s,this.toBBox),s},_chooseSubtree:function(e,t,i,r){for(var s,n,o,a,l,u,c,d;r.push(t),!t.leaf&&r.length-1!==i;){for(c=d=1/0,s=0,n=t.children.length;s<n;s++)l=G2(o=t.children[s]),(u=Cde(e,o)-l)<d?(d=u,c=l<c?l:c,a=o):u===d&&l<c&&(c=l,a=o);t=a||t.children[0]}return t},_insert:function(e,t,i){var r=this.toBBox,s=i?e:r(e),n=[],o=this._chooseSubtree(s,this.data,t,n);for(o.children.push(e),Wm(o,s);t>=0&&n[t].children.length>this._maxEntries;)this._split(n,t),t--;this._adjustParentBBoxes(s,n,t)},_split:function(e,t){var i=e[t],r=i.children.length,s=this._minEntries;this._chooseSplitAxis(i,s,r);var n=this._chooseSplitIndex(i,s,r),o=pd(i.children.splice(n,i.children.length-n));o.height=i.height,o.leaf=i.leaf,jh(i,this.toBBox),jh(o,this.toBBox),t?e[t-1].children.push(o):this._splitRoot(i,o)},_splitRoot:function(e,t){this.data=pd([e,t]),this.data.height=e.height+1,this.data.leaf=!1,jh(this.data,this.toBBox)},_chooseSplitIndex:function(e,t,i){var r,s,n,o,a,l,u,c;for(l=u=1/0,r=t;r<=i-t;r++)o=Pde(s=Hm(e,0,r,this.toBBox),n=Hm(e,r,i,this.toBBox)),a=G2(s)+G2(n),o<l?(l=o,c=r,u=a<u?a:u):o===l&&a<u&&(u=a,c=r);return c},_chooseSplitAxis:function(e,t,i){var r=e.leaf?this.compareMinX:Ak,s=e.leaf?this.compareMinY:Lk;this._allDistMargin(e,t,i,r)<this._allDistMargin(e,t,i,s)&&e.children.sort(r)},_allDistMargin:function(e,t,i,r){e.children.sort(r);var s,n,o=this.toBBox,a=Hm(e,0,t,o),l=Hm(e,i-t,i,o),u=U0(a)+U0(l);for(s=t;s<i-t;s++)n=e.children[s],Wm(a,e.leaf?o(n):n),u+=U0(a);for(s=i-t-1;s>=t;s--)n=e.children[s],Wm(l,e.leaf?o(n):n),u+=U0(l);return u},_adjustParentBBoxes:function(e,t,i){for(var r=i;r>=0;r--)Wm(t[r],e)},_condense:function(e){for(var t,i=e.length-1;i>=0;i--)e[i].children.length===0?i>0?(t=e[i-1].children).splice(t.indexOf(e[i]),1):this.clear():jh(e[i],this.toBBox)},_initFormat:function(e){var t=["return a"," - b",";"];this.compareMinX=new Function("a","b",t.join(e[0])),this.compareMinY=new Function("a","b",t.join(e[1])),this.toBBox=new Function("a","return {minX: a"+e[0]+", minY: a"+e[1]+", maxX: a"+e[2]+", maxY: a"+e[3]+"};")}};function Ide(e,{timeZone:t,timeExtent:i}){return{$view:{scale:e,timeZone:t,timeProperties:{currentStart:i?.start,currentEnd:i?.end}}}}let Rk=class LU{constructor(t,i){this.key=new _f(0,0,0,0),this.bounds=Qt(),this.objectIds=new Set,this.key.set(i);const r=t.getLODInfoAt(this.key);this.tileInfoView=t,this.tileInfoView.getTileBounds(this.bounds,this.key,!0),this.resolution=r.resolution,this.level=r.level,this.scale=r.scale,this.minScale=t.zoomToScale(r.level-1),this.maxScale=t.zoomToScale(r.level+1)}get lod(){return this.tileInfoView.getLODInfoAt(this.key)}get id(){return this.key.id}get extent(){return HQ(this.bounds,this.tileInfoView.tileInfo.spatialReference)}get transform(){return{originPosition:"upperLeft",scale:[this.resolution,this.resolution],translate:[this.bounds[0],this.bounds[3]]}}createArcadeEvaluationOptions(t){return Ide(this.scale,t)}createChildTiles(){const t=this.key.getChildKeys(),i=Sr.acquire();for(let r=0;r<t.length;r++)i[r]=new LU(this.tileInfoView,t[r]);return i}getQuantizationParameters(){return zl.fromJSON({mode:"view",originPosition:"upperLeft",tolerance:this.resolution,extent:{xmin:this.bounds[0],ymin:this.bounds[1],xmax:this.bounds[2],ymax:this.bounds[3],spatialReference:this.tileInfoView.tileInfo.spatialReference}})}};const Lu={added:[],removed:[]},q2=new Set,Ade=new _f(0,0,0,0);function Lde(e,t){const i=ar(t);if(!i)return null;const[r,s]=i.valid;return e[2]>s?[Qt([e[0],e[1],s,e[3]]),Qt([r,e[1],r+e[2]-s,e[3]])]:e[0]<r?[Qt([r,e[1],e[2],e[3]]),Qt([s-(r-e[0]),e[1],s,e[3]])]:null}let kde=class extends Ja{constructor(t){super(),this._tiles=new Map,this._index=Hv(9,N("esri-csp-restrictions")?i=>({minX:i.bounds[0],minY:i.bounds[1],maxX:i.bounds[2],maxY:i.bounds[3]}):[".bounds[0]",".bounds[1]",".bounds[2]",".bounds[3]"]),this.tiles=[],this.tileScheme=t}destroy(){this.clear()}clear(){this.tiles.length=0,this._tiles.clear(),this._index.clear()}has(t){return this._tiles.has(t)}get(t){return this._tiles.get(t)}getIntersectingTiles(t){if(!t||Kb(t)===0||Qb(t)===0)return[];const i=Lde(t,this.tileScheme.spatialReference);return i!=null?[...new Set([...this.boundsIntersections(i[0]),...this.boundsIntersections(i[1])])]:this.boundsIntersections(t)}boundsIntersections(t){return this._index.search({minX:t[0],minY:t[1],maxX:t[2],maxY:t[3]})}updateTiles(t){const i={added:[],removed:[]};for(const r of t.added)if(!this.has(r)){const s=new Rk(this.tileScheme,r);this._tiles.set(r,s),this._index.insert(s),i.added.push(s)}for(const r of t.removed)if(this.has(r)){const s=this.get(r);this._tiles.delete(r),this._index.remove(s),i.removed.push(s)}this.tiles.length=0,this._tiles.forEach((r=>this.tiles.push(r))),(i.added.length||i.removed.length)&&this.emit("update",i)}setViewState(t){const i=this.tileScheme.getTileCoverage(t,0);if(!i)return;const{spans:r,lodInfo:s}=i,{level:n}=s;if(r.length>0)for(const{row:o,colFrom:a,colTo:l}of r)for(let u=a;u<=l;u++){const c=Ade.set(n,o,s.normalizeCol(u),s.getWorldForColumn(u)).id;if(q2.add(c),!this.has(c)){const d=new Rk(this.tileScheme,c);this._tiles.set(c,d),this._index.insert(d),this.tiles.push(d),Lu.added.push(d)}}for(let o=this.tiles.length-1;o>=0;o--){const a=this.tiles[o];q2.has(a.id)||(this._tiles.delete(a.id),this.tiles.splice(o,1),this._index.remove(a),Lu.removed.push(a))}(Lu.added.length||Lu.removed.length)&&this.emit("update",Lu),dP.pool.release(i),q2.clear(),Lu.added.length=0,Lu.removed.length=0}};const U3e=1e-30,Nd=512,G0=16777216,j3e=8,kU=29,RU=24,G3e=4,B3e=0,q3e=0,H3e=0,W3e=1,Z3e=2,Y3e=3,J3e=4,X3e=5,K3e=6,Q3e=12,eAe=13,tAe=5,Rde=6,iAe=5,rAe=6;var Ok;(function(e){e[e.FilterFlags=0]="FilterFlags",e[e.Animation=1]="Animation",e[e.GPGPU=2]="GPGPU",e[e.VV=3]="VV",e[e.DD0=4]="DD0",e[e.DD1=5]="DD1",e[e.DD2=6]="DD2",e[e.LocalTimeOrigin=7]="LocalTimeOrigin"})(Ok||(Ok={}));const OU=6,Ode=1<<OU,sAe=Ode<<1,nAe=1.05,oAe=3,aAe=1,Nde=3,Dde=3,lAe=5,uAe=6,cAe=1.15,Fde=4,hAe=128,zde=256,dAe=zde-2*Fde,pAe=2,fAe=128,NU=1,mAe=10,Vde=1024,yAe=128,gAe=4,_Ae=1,vAe=1<<20,bAe=.75,wAe=10,SAe=.75,xAe=256,Ude=32,jde=512,$Ae=0,MAe=1,Gde=1,TAe=[0,0,0,0,0,0,0,0,0,0,0,0,1,1,1,1],EAe=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1],Wf=256;var Nk,Dk,Fk,zk,Vk,UM,Uk,jk,Xn,jM,Iy,Tt,Wv,Rs,GM,ni,ce,Zv,Jp,Wc,BM,og,Gk,Bk,qk;(function(e){e[e.DEPTH=256]="DEPTH",e[e.STENCIL=1024]="STENCIL",e[e.COLOR=16384]="COLOR"})(Nk||(Nk={})),(function(e){e[e.COLOR=6144]="COLOR",e[e.DEPTH=6145]="DEPTH",e[e.STENCIL=6146]="STENCIL",e[e.DEPTH_STENCIL=34041]="DEPTH_STENCIL"})(Dk||(Dk={})),(function(e){e[e.POINTS=0]="POINTS",e[e.LINES=1]="LINES",e[e.LINE_LOOP=2]="LINE_LOOP",e[e.LINE_STRIP=3]="LINE_STRIP",e[e.TRIANGLES=4]="TRIANGLES",e[e.TRIANGLE_STRIP=5]="TRIANGLE_STRIP",e[e.TRIANGLE_FAN=6]="TRIANGLE_FAN"})(Fk||(Fk={})),(function(e){e[e.ZERO=0]="ZERO",e[e.ONE=1]="ONE",e[e.SRC_COLOR=768]="SRC_COLOR",e[e.ONE_MINUS_SRC_COLOR=769]="ONE_MINUS_SRC_COLOR",e[e.SRC_ALPHA=770]="SRC_ALPHA",e[e.ONE_MINUS_SRC_ALPHA=771]="ONE_MINUS_SRC_ALPHA",e[e.DST_ALPHA=772]="DST_ALPHA",e[e.ONE_MINUS_DST_ALPHA=773]="ONE_MINUS_DST_ALPHA",e[e.DST_COLOR=774]="DST_COLOR",e[e.ONE_MINUS_DST_COLOR=775]="ONE_MINUS_DST_COLOR",e[e.SRC_ALPHA_SATURATE=776]="SRC_ALPHA_SATURATE",e[e.CONSTANT_COLOR=32769]="CONSTANT_COLOR",e[e.ONE_MINUS_CONSTANT_COLOR=32770]="ONE_MINUS_CONSTANT_COLOR",e[e.CONSTANT_ALPHA=32771]="CONSTANT_ALPHA",e[e.ONE_MINUS_CONSTANT_ALPHA=32772]="ONE_MINUS_CONSTANT_ALPHA"})(zk||(zk={})),(function(e){e[e.ADD=32774]="ADD",e[e.MIN=32775]="MIN",e[e.MAX=32776]="MAX",e[e.SUBTRACT=32778]="SUBTRACT",e[e.REVERSE_SUBTRACT=32779]="REVERSE_SUBTRACT"})(Vk||(Vk={})),(function(e){e[e.ARRAY_BUFFER=34962]="ARRAY_BUFFER",e[e.ELEMENT_ARRAY_BUFFER=34963]="ELEMENT_ARRAY_BUFFER",e[e.UNIFORM_BUFFER=35345]="UNIFORM_BUFFER",e[e.PIXEL_PACK_BUFFER=35051]="PIXEL_PACK_BUFFER",e[e.PIXEL_UNPACK_BUFFER=35052]="PIXEL_UNPACK_BUFFER",e[e.COPY_READ_BUFFER=36662]="COPY_READ_BUFFER",e[e.COPY_WRITE_BUFFER=36663]="COPY_WRITE_BUFFER",e[e.TRANSFORM_FEEDBACK_BUFFER=35982]="TRANSFORM_FEEDBACK_BUFFER"})(UM||(UM={})),(function(e){e[e.FRONT=1028]="FRONT",e[e.BACK=1029]="BACK",e[e.FRONT_AND_BACK=1032]="FRONT_AND_BACK"})(Uk||(Uk={})),(function(e){e[e.CW=2304]="CW",e[e.CCW=2305]="CCW"})(jk||(jk={})),(function(e){e[e.BYTE=5120]="BYTE",e[e.UNSIGNED_BYTE=5121]="UNSIGNED_BYTE",e[e.SHORT=5122]="SHORT",e[e.UNSIGNED_SHORT=5123]="UNSIGNED_SHORT",e[e.INT=5124]="INT",e[e.UNSIGNED_INT=5125]="UNSIGNED_INT",e[e.FLOAT=5126]="FLOAT",e[e.HALF_FLOAT=5131]="HALF_FLOAT"})(Xn||(Xn={})),(function(e){e[e.NEVER=512]="NEVER",e[e.LESS=513]="LESS",e[e.EQUAL=514]="EQUAL",e[e.LEQUAL=515]="LEQUAL",e[e.GREATER=516]="GREATER",e[e.NOTEQUAL=517]="NOTEQUAL",e[e.GEQUAL=518]="GEQUAL",e[e.ALWAYS=519]="ALWAYS"})(jM||(jM={})),(function(e){e[e.ZERO=0]="ZERO",e[e.KEEP=7680]="KEEP",e[e.REPLACE=7681]="REPLACE",e[e.INCR=7682]="INCR",e[e.DECR=7683]="DECR",e[e.INVERT=5386]="INVERT",e[e.INCR_WRAP=34055]="INCR_WRAP",e[e.DECR_WRAP=34056]="DECR_WRAP"})(Iy||(Iy={})),(function(e){e[e.NEAREST=9728]="NEAREST",e[e.LINEAR=9729]="LINEAR",e[e.NEAREST_MIPMAP_NEAREST=9984]="NEAREST_MIPMAP_NEAREST",e[e.LINEAR_MIPMAP_NEAREST=9985]="LINEAR_MIPMAP_NEAREST",e[e.NEAREST_MIPMAP_LINEAR=9986]="NEAREST_MIPMAP_LINEAR",e[e.LINEAR_MIPMAP_LINEAR=9987]="LINEAR_MIPMAP_LINEAR"})(Tt||(Tt={})),(function(e){e[e.CLAMP_TO_EDGE=33071]="CLAMP_TO_EDGE",e[e.REPEAT=10497]="REPEAT",e[e.MIRRORED_REPEAT=33648]="MIRRORED_REPEAT"})(Wv||(Wv={})),(function(e){e[e.TEXTURE_2D=3553]="TEXTURE_2D",e[e.TEXTURE_CUBE_MAP=34067]="TEXTURE_CUBE_MAP",e[e.TEXTURE_3D=32879]="TEXTURE_3D",e[e.TEXTURE_CUBE_MAP_POSITIVE_X=34069]="TEXTURE_CUBE_MAP_POSITIVE_X",e[e.TEXTURE_CUBE_MAP_NEGATIVE_X=34070]="TEXTURE_CUBE_MAP_NEGATIVE_X",e[e.TEXTURE_CUBE_MAP_POSITIVE_Y=34071]="TEXTURE_CUBE_MAP_POSITIVE_Y",e[e.TEXTURE_CUBE_MAP_NEGATIVE_Y=34072]="TEXTURE_CUBE_MAP_NEGATIVE_Y",e[e.TEXTURE_CUBE_MAP_POSITIVE_Z=34073]="TEXTURE_CUBE_MAP_POSITIVE_Z",e[e.TEXTURE_CUBE_MAP_NEGATIVE_Z=34074]="TEXTURE_CUBE_MAP_NEGATIVE_Z",e[e.TEXTURE_2D_ARRAY=35866]="TEXTURE_2D_ARRAY"})(Rs||(Rs={})),(function(e){e[e.MIN_LOD=33082]="MIN_LOD",e[e.MAX_LOD=33083]="MAX_LOD",e[e.BASE_LEVEL=33084]="BASE_LEVEL",e[e.MAX_LEVEL=33085]="MAX_LEVEL",e[e.MAX_TEXTURE_SIZE=3379]="MAX_TEXTURE_SIZE"})(GM||(GM={})),(function(e){e[e.ALPHA=6406]="ALPHA",e[e.RGB=6407]="RGB",e[e.RGBA=6408]="RGBA",e[e.LUMINANCE=6409]="LUMINANCE",e[e.LUMINANCE_ALPHA=6410]="LUMINANCE_ALPHA",e[e.RED=6403]="RED",e[e.RG=33319]="RG",e[e.RED_INTEGER=36244]="RED_INTEGER",e[e.RG_INTEGER=33320]="RG_INTEGER",e[e.RGB_INTEGER=36248]="RGB_INTEGER",e[e.RGBA_INTEGER=36249]="RGBA_INTEGER"})(ni||(ni={})),(function(e){e[e.RGBA4=32854]="RGBA4",e[e.R16F=33325]="R16F",e[e.RG16F=33327]="RG16F",e[e.RGB32F=34837]="RGB32F",e[e.RGBA16F=34842]="RGBA16F",e[e.R32F=33326]="R32F",e[e.RG32F=33328]="RG32F",e[e.RGBA32F=34836]="RGBA32F",e[e.R11F_G11F_B10F=35898]="R11F_G11F_B10F",e[e.RGB8=32849]="RGB8",e[e.RGBA8=32856]="RGBA8",e[e.RGB5_A1=32855]="RGB5_A1",e[e.R8=33321]="R8",e[e.RG8=33323]="RG8",e[e.R8I=33329]="R8I",e[e.R8UI=33330]="R8UI",e[e.R16I=33331]="R16I",e[e.R16UI=33332]="R16UI",e[e.R32I=33333]="R32I",e[e.R32UI=33334]="R32UI",e[e.RG8I=33335]="RG8I",e[e.RG8UI=33336]="RG8UI",e[e.RG16I=33337]="RG16I",e[e.RG16UI=33338]="RG16UI",e[e.RG32I=33339]="RG32I",e[e.RG32UI=33340]="RG32UI",e[e.RGB16F=34843]="RGB16F",e[e.RGB9_E5=35901]="RGB9_E5",e[e.SRGB8=35905]="SRGB8",e[e.SRGB8_ALPHA8=35907]="SRGB8_ALPHA8",e[e.RGB565=36194]="RGB565",e[e.RGBA32UI=36208]="RGBA32UI",e[e.RGB32UI=36209]="RGB32UI",e[e.RGBA16UI=36214]="RGBA16UI",e[e.RGB16UI=36215]="RGB16UI",e[e.RGBA8UI=36220]="RGBA8UI",e[e.RGB8UI=36221]="RGB8UI",e[e.RGBA32I=36226]="RGBA32I",e[e.RGB32I=36227]="RGB32I",e[e.RGBA16I=36232]="RGBA16I",e[e.RGB16I=36233]="RGB16I",e[e.RGBA8I=36238]="RGBA8I",e[e.RGB8I=36239]="RGB8I",e[e.R8_SNORM=36756]="R8_SNORM",e[e.RG8_SNORM=36757]="RG8_SNORM",e[e.RGB8_SNORM=36758]="RGB8_SNORM",e[e.RGBA8_SNORM=36759]="RGBA8_SNORM",e[e.RGB10_A2=32857]="RGB10_A2",e[e.RGB10_A2UI=36975]="RGB10_A2UI"})(ce||(ce={})),(function(e){e[e.DEPTH_COMPONENT=6402]="DEPTH_COMPONENT",e[e.DEPTH_STENCIL=34041]="DEPTH_STENCIL"})(Zv||(Zv={})),(function(e){e[e.DEPTH24_STENCIL8=35056]="DEPTH24_STENCIL8",e[e.DEPTH32F_STENCIL8=36013]="DEPTH32F_STENCIL8"})(Jp||(Jp={})),(function(e){e[e.DEPTH_COMPONENT16=33189]="DEPTH_COMPONENT16",e[e.DEPTH_COMPONENT24=33190]="DEPTH_COMPONENT24",e[e.DEPTH_COMPONENT32F=36012]="DEPTH_COMPONENT32F"})(Wc||(Wc={})),(function(e){e[e.STENCIL_INDEX8=36168]="STENCIL_INDEX8"})(BM||(BM={})),(function(e){e[e.FLOAT=5126]="FLOAT",e[e.UNSIGNED_BYTE=5121]="UNSIGNED_BYTE",e[e.UNSIGNED_INT_24_8=34042]="UNSIGNED_INT_24_8",e[e.UNSIGNED_SHORT_4_4_4_4=32819]="UNSIGNED_SHORT_4_4_4_4",e[e.UNSIGNED_SHORT_5_5_5_1=32820]="UNSIGNED_SHORT_5_5_5_1",e[e.UNSIGNED_SHORT_5_6_5=33635]="UNSIGNED_SHORT_5_6_5",e[e.BYTE=5120]="BYTE",e[e.UNSIGNED_SHORT=5123]="UNSIGNED_SHORT",e[e.SHORT=5122]="SHORT",e[e.UNSIGNED_INT=5125]="UNSIGNED_INT",e[e.INT=5124]="INT",e[e.HALF_FLOAT=5131]="HALF_FLOAT",e[e.UNSIGNED_INT_2_10_10_10_REV=33640]="UNSIGNED_INT_2_10_10_10_REV",e[e.UNSIGNED_INT_10F_11F_11F_REV=35899]="UNSIGNED_INT_10F_11F_11F_REV",e[e.UNSIGNED_INT_5_9_9_9_REV=35902]="UNSIGNED_INT_5_9_9_9_REV",e[e.FLOAT_32_UNSIGNED_INT_24_8_REV=36269]="FLOAT_32_UNSIGNED_INT_24_8_REV"})(og||(og={})),(function(e){e[e.STATIC_DRAW=35044]="STATIC_DRAW",e[e.DYNAMIC_DRAW=35048]="DYNAMIC_DRAW",e[e.STREAM_DRAW=35040]="STREAM_DRAW",e[e.STATIC_READ=35045]="STATIC_READ",e[e.DYNAMIC_READ=35049]="DYNAMIC_READ",e[e.STREAM_READ=35041]="STREAM_READ",e[e.STATIC_COPY=35046]="STATIC_COPY",e[e.DYNAMIC_COPY=35050]="DYNAMIC_COPY",e[e.STREAM_COPY=35042]="STREAM_COPY"})(Gk||(Gk={})),(function(e){e[e.FRAGMENT_SHADER=35632]="FRAGMENT_SHADER",e[e.VERTEX_SHADER=35633]="VERTEX_SHADER"})(Bk||(Bk={})),(function(e){e[e.FRAMEBUFFER=36160]="FRAMEBUFFER",e[e.READ_FRAMEBUFFER=36008]="READ_FRAMEBUFFER",e[e.DRAW_FRAMEBUFFER=36009]="DRAW_FRAMEBUFFER"})(qk||(qk={}));const CAe=33984;var Yv,Hk;(function(e){e[e.Texture=0]="Texture",e[e.TileTexture=1]="TileTexture",e[e.BufferObject=2]="BufferObject",e[e.VertexArrayObject=3]="VertexArrayObject",e[e.Shader=4]="Shader",e[e.Program=5]="Program",e[e.FramebufferObject=6]="FramebufferObject",e[e.Renderbuffer=7]="Renderbuffer",e[e.TransformFeedback=8]="TransformFeedback",e[e.Sync=9]="Sync",e[e.UNCOUNTED=10]="UNCOUNTED",e[e.LinesOfCode=10]="LinesOfCode",e[e.Uniform=11]="Uniform",e[e.COUNT=12]="COUNT"})(Yv||(Yv={})),(function(e){e[e.NONE=0]="NONE",e[e.BACK=1029]="BACK"})(Hk||(Hk={}));const PAe=36064,IAe=36065,AAe=36066,LAe=33306,kAe=36096,RAe=36128;var Ti,Wk,Zk,Yk,Jk,Xk,Kk,Vl,Qk;(function(e){e[e.COMPRESSED_RGB_S3TC_DXT1_EXT=33776]="COMPRESSED_RGB_S3TC_DXT1_EXT",e[e.COMPRESSED_RGBA_S3TC_DXT1_EXT=33777]="COMPRESSED_RGBA_S3TC_DXT1_EXT",e[e.COMPRESSED_RGBA_S3TC_DXT3_EXT=33778]="COMPRESSED_RGBA_S3TC_DXT3_EXT",e[e.COMPRESSED_RGBA_S3TC_DXT5_EXT=33779]="COMPRESSED_RGBA_S3TC_DXT5_EXT",e[e.COMPRESSED_R11_EAC=37488]="COMPRESSED_R11_EAC",e[e.COMPRESSED_SIGNED_R11_EAC=37489]="COMPRESSED_SIGNED_R11_EAC",e[e.COMPRESSED_RG11_EAC=37490]="COMPRESSED_RG11_EAC",e[e.COMPRESSED_SIGNED_RG11_EAC=37491]="COMPRESSED_SIGNED_RG11_EAC",e[e.COMPRESSED_RGB8_ETC2=37492]="COMPRESSED_RGB8_ETC2",e[e.COMPRESSED_SRGB8_ETC2=37493]="COMPRESSED_SRGB8_ETC2",e[e.COMPRESSED_RGB8_PUNCHTHROUGH_ALPHA1_ETC2=37494]="COMPRESSED_RGB8_PUNCHTHROUGH_ALPHA1_ETC2",e[e.COMPRESSED_SRGB8_PUNCHTHROUGH_ALPHA1_ETC2=37495]="COMPRESSED_SRGB8_PUNCHTHROUGH_ALPHA1_ETC2",e[e.COMPRESSED_RGBA8_ETC2_EAC=37496]="COMPRESSED_RGBA8_ETC2_EAC",e[e.COMPRESSED_SRGB8_ALPHA8_ETC2_EAC=37497]="COMPRESSED_SRGB8_ALPHA8_ETC2_EAC"})(Ti||(Ti={})),(function(e){e[e.FLOAT=5126]="FLOAT",e[e.FLOAT_VEC2=35664]="FLOAT_VEC2",e[e.FLOAT_VEC3=35665]="FLOAT_VEC3",e[e.FLOAT_VEC4=35666]="FLOAT_VEC4",e[e.INT=5124]="INT",e[e.INT_VEC2=35667]="INT_VEC2",e[e.INT_VEC3=35668]="INT_VEC3",e[e.INT_VEC4=35669]="INT_VEC4",e[e.BOOL=35670]="BOOL",e[e.BOOL_VEC2=35671]="BOOL_VEC2",e[e.BOOL_VEC3=35672]="BOOL_VEC3",e[e.BOOL_VEC4=35673]="BOOL_VEC4",e[e.FLOAT_MAT2=35674]="FLOAT_MAT2",e[e.FLOAT_MAT3=35675]="FLOAT_MAT3",e[e.FLOAT_MAT4=35676]="FLOAT_MAT4",e[e.SAMPLER_2D=35678]="SAMPLER_2D",e[e.SAMPLER_CUBE=35680]="SAMPLER_CUBE",e[e.UNSIGNED_INT=5125]="UNSIGNED_INT",e[e.UNSIGNED_INT_VEC2=36294]="UNSIGNED_INT_VEC2",e[e.UNSIGNED_INT_VEC3=36295]="UNSIGNED_INT_VEC3",e[e.UNSIGNED_INT_VEC4=36296]="UNSIGNED_INT_VEC4",e[e.FLOAT_MAT2x3=35685]="FLOAT_MAT2x3",e[e.FLOAT_MAT2x4=35686]="FLOAT_MAT2x4",e[e.FLOAT_MAT3x2=35687]="FLOAT_MAT3x2",e[e.FLOAT_MAT3x4=35688]="FLOAT_MAT3x4",e[e.FLOAT_MAT4x2=35689]="FLOAT_MAT4x2",e[e.FLOAT_MAT4x3=35690]="FLOAT_MAT4x3",e[e.SAMPLER_3D=35679]="SAMPLER_3D",e[e.SAMPLER_2D_SHADOW=35682]="SAMPLER_2D_SHADOW",e[e.SAMPLER_2D_ARRAY=36289]="SAMPLER_2D_ARRAY",e[e.SAMPLER_2D_ARRAY_SHADOW=36292]="SAMPLER_2D_ARRAY_SHADOW",e[e.SAMPLER_CUBE_SHADOW=36293]="SAMPLER_CUBE_SHADOW",e[e.INT_SAMPLER_2D=36298]="INT_SAMPLER_2D",e[e.INT_SAMPLER_3D=36299]="INT_SAMPLER_3D",e[e.INT_SAMPLER_CUBE=36300]="INT_SAMPLER_CUBE",e[e.INT_SAMPLER_2D_ARRAY=36303]="INT_SAMPLER_2D_ARRAY",e[e.UNSIGNED_INT_SAMPLER_2D=36306]="UNSIGNED_INT_SAMPLER_2D",e[e.UNSIGNED_INT_SAMPLER_3D=36307]="UNSIGNED_INT_SAMPLER_3D",e[e.UNSIGNED_INT_SAMPLER_CUBE=36308]="UNSIGNED_INT_SAMPLER_CUBE",e[e.UNSIGNED_INT_SAMPLER_2D_ARRAY=36311]="UNSIGNED_INT_SAMPLER_2D_ARRAY"})(Wk||(Wk={})),(function(e){e[e.OBJECT_TYPE=37138]="OBJECT_TYPE",e[e.SYNC_CONDITION=37139]="SYNC_CONDITION",e[e.SYNC_STATUS=37140]="SYNC_STATUS",e[e.SYNC_FLAGS=37141]="SYNC_FLAGS"})(Zk||(Zk={})),(function(e){e[e.UNSIGNALED=37144]="UNSIGNALED",e[e.SIGNALED=37145]="SIGNALED"})(Yk||(Yk={})),(function(e){e[e.ALREADY_SIGNALED=37146]="ALREADY_SIGNALED",e[e.TIMEOUT_EXPIRED=37147]="TIMEOUT_EXPIRED",e[e.CONDITION_SATISFIED=37148]="CONDITION_SATISFIED",e[e.WAIT_FAILED=37149]="WAIT_FAILED"})(Jk||(Jk={})),(function(e){e[e.SYNC_GPU_COMMANDS_COMPLETE=37143]="SYNC_GPU_COMMANDS_COMPLETE"})(Xk||(Xk={})),(function(e){e[e.SYNC_FLUSH_COMMANDS_BIT=1]="SYNC_FLUSH_COMMANDS_BIT"})(Kk||(Kk={})),(function(e){e[e.INVALID_ENUM=1280]="INVALID_ENUM",e[e.INVALID_VALUE=1281]="INVALID_VALUE",e[e.INVALID_OPERATION=1282]="INVALID_OPERATION",e[e.OUT_OF_MEMORY=1285]="OUT_OF_MEMORY",e[e.INVALID_FRAMEBUFFER_OPERATION=1286]="INVALID_FRAMEBUFFER_OPERATION",e[e.CONTEXT_LOST_WEBGL=37442]="CONTEXT_LOST_WEBGL"})(Vl||(Vl={})),(function(e){e[e.COMPLETION_STATUS_KHR=37297]="COMPLETION_STATUS_KHR"})(Qk||(Qk={}));const Bde=()=>H.getLogger("esri.views.webgl.checkWebGLError");function qde(e){switch(e){case Vl.INVALID_ENUM:return"Invalid Enum. An unacceptable value has been specified for an enumerated argument.";case Vl.INVALID_VALUE:return"Invalid Value. A numeric argument is out of range.";case Vl.INVALID_OPERATION:return"Invalid Operation. The specified command is not allowed for the current state.";case Vl.INVALID_FRAMEBUFFER_OPERATION:return"Invalid Framebuffer operation. The currently bound framebuffer is not framebuffer complete when trying to render to or to read from it.";case Vl.OUT_OF_MEMORY:return"Out of memory. Not enough memory is left to execute the command.";case Vl.CONTEXT_LOST_WEBGL:return"WebGL context has been lost";default:return"Unknown error"}}const DU=!!N("enable-feature:webgl-debug");function FU(){return DU}function OAe(){return DU}function ku(e,t=FU()){if(t){const i=e.getError();if(i){const r=qde(i),s=new Error().stack;Bde().error(new j("webgl-error","WebGL error occurred",{message:r,stack:s}))}}}var Jv;(function(e){e[e.TextureDescriptor=0]="TextureDescriptor",e[e.Texture=1]="Texture",e[e.Renderbuffer=2]="Renderbuffer"})(Jv||(Jv={}));function Hde(e){switch(e){case Xn.BYTE:case Xn.UNSIGNED_BYTE:return 1;case Xn.SHORT:case Xn.UNSIGNED_SHORT:case Xn.HALF_FLOAT:return 2;case Xn.FLOAT:case Xn.INT:case Xn.UNSIGNED_INT:return 4}}function Wde(e){const t=e.gl;switch(t.getError()){case t.NO_ERROR:return null;case t.INVALID_ENUM:return"An unacceptable value has been specified for an enumerated argument";case t.INVALID_VALUE:return"An unacceptable value has been specified for an argument";case t.INVALID_OPERATION:return"The specified command is not allowed for the current state";case t.INVALID_FRAMEBUFFER_OPERATION:return"The currently bound framebuffer is not framebuffer complete";case t.OUT_OF_MEMORY:return"Not enough memory is left to execute the command";case t.CONTEXT_LOST_WEBGL:return"WebGL context is lost"}return"Unknown error"}function NAe(e,t,i,r,s=0){const n=e.gl;e.bindBuffer(i);for(const o of r){const a=t.get(o.name);if(a==null){console.warn(`There is no location for vertex attribute '${o.name}' defined.`);continue}const l=s*o.stride;if(o.count<=4)n.vertexAttribPointer(a,o.count,o.type,o.normalized,o.stride,o.offset+l),n.enableVertexAttribArray(a),o.divisor>0&&e.gl.vertexAttribDivisor(a,o.divisor);else if(o.count===9)for(let u=0;u<3;u++)n.vertexAttribPointer(a+u,3,o.type,o.normalized,o.stride,o.offset+12*u+l),n.enableVertexAttribArray(a+u),o.divisor>0&&e.gl.vertexAttribDivisor(a+u,o.divisor);else if(o.count===16)for(let u=0;u<4;u++)n.vertexAttribPointer(a+u,4,o.type,o.normalized,o.stride,o.offset+16*u+l),n.enableVertexAttribArray(a+u),o.divisor>0&&e.gl?.vertexAttribDivisor(a+u,o.divisor);else console.error("Unsupported vertex attribute element count: "+o.count);if(FU()){const u=Wde(e),c=Hde(o.type),d=o.offset,m=Math.round(c/d)!==c/d?`. Offset not a multiple of stride. DataType requires ${c} bytes, but descriptor has an offset of ${d}`:"";u&&console.error(`Unable to bind vertex attribute "${o.name}" with baseInstanceOffset ${l}${m}:`,u,o)}}}function DAe(e,t,i,r){const s=e.gl;e.bindBuffer(i);for(const n of r){const o=t.get(n.name);if(n.count<=4)s.disableVertexAttribArray(o),n.divisor&&n.divisor>0&&e.gl?.vertexAttribDivisor(o,0);else if(n.count===9)for(let a=0;a<3;a++)s.disableVertexAttribArray(o+a),n.divisor&&n.divisor>0&&e.gl?.vertexAttribDivisor(o+a,0);else if(n.count===16)for(let a=0;a<4;a++)s.disableVertexAttribArray(o+a),n.divisor&&n.divisor>0&&e.gl?.vertexAttribDivisor(o+a,0);else console.error("Unsupported vertex attribute element count: "+n.count)}e.unbindBuffer(UM.ARRAY_BUFFER)}function Zde(e){switch(e){case ni.ALPHA:case ni.LUMINANCE:case ni.RED:case ni.RED_INTEGER:case ce.R8:case ce.R8I:case ce.R8UI:case ce.R8_SNORM:case BM.STENCIL_INDEX8:return 1;case ni.LUMINANCE_ALPHA:case ni.RG:case ni.RG_INTEGER:case ce.RGBA4:case ce.R16F:case ce.R16I:case ce.R16UI:case ce.RG8:case ce.RG8I:case ce.RG8UI:case ce.RG8_SNORM:case ce.RGB565:case ce.RGB5_A1:case Wc.DEPTH_COMPONENT16:return 2;case ni.RGB:case ni.RGB_INTEGER:case ce.RGB8:case ce.RGB8I:case ce.RGB8UI:case ce.RGB8_SNORM:case ce.SRGB8:case Wc.DEPTH_COMPONENT24:return 3;case ni.RGBA:case ni.RGBA_INTEGER:case ce.RGBA8:case ce.R32F:case ce.R11F_G11F_B10F:case ce.RG16F:case ce.R32I:case ce.R32UI:case ce.RG16I:case ce.RG16UI:case ce.RGBA8I:case ce.RGBA8UI:case ce.RGBA8_SNORM:case ce.SRGB8_ALPHA8:case ce.RGB9_E5:case ce.RGB10_A2UI:case ce.RGB10_A2:case Wc.DEPTH_COMPONENT32F:case Jp.DEPTH24_STENCIL8:return 4;case Jp.DEPTH32F_STENCIL8:return 5;case ce.RGB16F:case ce.RGB16I:case ce.RGB16UI:return 6;case ce.RG32F:case ce.RG32I:case ce.RG32UI:case ce.RGBA16F:case ce.RGBA16I:case ce.RGBA16UI:return 8;case ce.RGB32F:case ce.RGB32I:case ce.RGB32UI:return 12;case ce.RGBA32F:case ce.RGBA32I:case ce.RGBA32UI:return 16;case Ti.COMPRESSED_RGB_S3TC_DXT1_EXT:case Ti.COMPRESSED_RGBA_S3TC_DXT1_EXT:return .5;case Ti.COMPRESSED_RGBA_S3TC_DXT3_EXT:case Ti.COMPRESSED_RGBA_S3TC_DXT5_EXT:return 1;case Ti.COMPRESSED_R11_EAC:case Ti.COMPRESSED_SIGNED_R11_EAC:case Ti.COMPRESSED_RGB8_ETC2:case Ti.COMPRESSED_SRGB8_ETC2:case Ti.COMPRESSED_RGB8_PUNCHTHROUGH_ALPHA1_ETC2:case Ti.COMPRESSED_SRGB8_PUNCHTHROUGH_ALPHA1_ETC2:return .5;case Ti.COMPRESSED_RG11_EAC:case Ti.COMPRESSED_SIGNED_RG11_EAC:case Ti.COMPRESSED_RGBA8_ETC2_EAC:case Ti.COMPRESSED_SRGB8_ALPHA8_ETC2_EAC:return 1}return 0}let zU=class{constructor(t=0,i=t){this.width=t,this.height=i,this.type=Jv.TextureDescriptor,this.target=Rs.TEXTURE_2D,this.pixelFormat=ni.RGBA,this.dataType=og.UNSIGNED_BYTE,this.samplingMode=Tt.LINEAR,this.wrapMode=Wv.REPEAT,this.maxAnisotropy=1,this.flipped=!1,this.hasMipmap=!1,this.isOpaque=!1,this.unpackAlignment=4,this.preMultiplyAlpha=!1,this.compareEnabled=!1,this.linearFilterDepth=!1,this.depth=1,this.isImmutable=!1}};function Yde(e){return e.width<=0||e.height<=0||e.depth<=0?0:Math.round(e.width*e.height*e.depth*(e.hasMipmap?4/3:1)*(e.internalFormat==null?4:Zde(e.internalFormat))*(e.target===Rs.TEXTURE_CUBE_MAP?6:1))}const Zf=()=>H.getLogger("esri/views/webgl/textureUtils");function Yf(e){const{width:t,height:i,depth:r}=e;(t!=null&&t<0||i!=null&&i<0||r!=null&&r<0)&&Zf().error("Negative dimension parameters are not allowed!");const{internalFormat:s}=e;if(s&&(VU(s)||UU(s))){const{linearFilterDepth:n,compareEnabled:o,samplingMode:a,hasMipmap:l}=e;l&&Zf().error("Depth textures cannot have mipmaps"),n?a!==Tt.LINEAR&&a!==Tt.NEAREST&&Zf().error("Depth textures cannot sample mipmaps"):(a!==Tt.NEAREST&&Zf().error("Depth textures without filtering must use NEAREST filtering"),o&&Zf().error("Depth textures without filtering cannot use compare function"))}}function Jde(e){return e in ce}function VU(e){return e in Wc}function UU(e){return e in Jp}function Xde(e){return e!=null&&e in Ti}function fd(e){return e!=null&&"type"in e&&e.type==="compressed"}function Kde(e){return e!=null&&"byteLength"in e}function eR(e){return e!=null&&!fd(e)&&!Kde(e)}function Gh(e){return e===Rs.TEXTURE_3D||e===Rs.TEXTURE_2D_ARRAY}function tR(e,t,i,r=1){let s=Math.max(t,i);return e===Rs.TEXTURE_3D&&(s=Math.max(s,r)),Math.floor(Math.log2(s))+1}function B0(e){if(e.internalFormat!=null)return e.internalFormat;switch(e.dataType){case og.FLOAT:switch(e.pixelFormat){case ni.RGBA:return ce.RGBA32F;case ni.RGB:return ce.RGB32F;default:throw new j("texture:unknown-format","Unable to derive format")}case og.UNSIGNED_BYTE:switch(e.pixelFormat){case ni.RGBA:return ce.RGBA8;case ni.RGB:return ce.RGB8}}const{pixelFormat:t}=e;return e.internalFormat=t===Zv.DEPTH_STENCIL?Jp.DEPTH24_STENCIL8:t===Zv.DEPTH_COMPONENT?Wc.DEPTH_COMPONENT24:t,e.internalFormat}function Qde(e){let t="width"in e?e.width:e.codedWidth,i="height"in e?e.height:e.codedHeight;return e instanceof HTMLVideoElement&&(t=e.videoWidth,i=e.videoHeight),{width:t,height:i,depth:1}}let epe=class jU extends zU{constructor(t,i){switch(super(),this.context=t,Object.assign(this,i),this.internalFormat){case ce.R16F:case ce.R32F:case ce.R8_SNORM:case ce.R8:this.pixelFormat=ni.RED;break;case ce.R8I:case ce.R8UI:case ce.R16I:case ce.R16UI:case ce.R32I:case ce.R32UI:this.pixelFormat=ni.RED_INTEGER}}static validate(t,i){return new jU(t,i)}};const Xo=()=>H.getLogger("esri/views/webgl/Texture");var ai;let tpe=(ai=class{constructor(t,i=null,r=null){if(this.type=Jv.Texture,this._glName=null,this._samplingModeDirty=!1,this._wrapModeDirty=!1,this._shadowFilterDirty=!1,this._wasImmutablyAllocated=!1,"context"in t)this._descriptor=t,r=i;else{const s=epe.validate(t,i);if(!s)throw new j("texture:invalid-descriptor","Texture descriptor invalid");this._descriptor=s}this._descriptor.target===Rs.TEXTURE_CUBE_MAP?this._setDataCubeMap(r):this.setData(r)}get glName(){return this._glName}get descriptor(){return this._descriptor}get usedMemory(){return Yde(this._descriptor)}get cachedMemory(){return this.usedMemory}get isDirty(){return this._samplingModeDirty||this._wrapModeDirty||this._shadowFilterDirty}get hasWebGLTextureObject(){return!!this._glName}dispose(){this.abortCompression(),this._descriptor.context.gl&&this.hasWebGLTextureObject&&(this._descriptor.context.instanceCounter.decrement(Yv.Texture,this),this._descriptor.context.unbindTexture(this),this._descriptor.context.gl.deleteTexture(this._glName),this._glName=null)}release(){this.dispose()}resize(t,i){const r=this._descriptor;if(r.width!==t||r.height!==i){if(this._wasImmutablyAllocated)throw new j("texture:immutable-resize","Immutable textures can't be resized!");r.width=t,r.height=i,this._descriptor.target===Rs.TEXTURE_CUBE_MAP?this._setDataCubeMap(null):this.setData(null)}}enableCompression(t){this._descriptor.compress=t}disableCompression(){this._descriptor.compress=void 0}setData(t){this.abortCompression(),!fd(t)&&this._descriptor.internalFormat&&this._descriptor.internalFormat in Ti&&(this._descriptor.internalFormat=void 0),this._setData(t),!fd(t)&&this._descriptor.compress&&this._compressOnWorker(t)}updateData(t,i,r,s,n,o,a=0){o||Xo().error("An attempt to use uninitialized data!"),this.hasWebGLTextureObject||Xo().error("An attempt to update uninitialized texture!");const l=this._descriptor;l.internalFormat=B0(l);const{context:u,pixelFormat:c,dataType:d,target:m,isImmutable:y}=l;if(y&&!this._wasImmutablyAllocated)throw new j("texture:uninitialized","Cannot update immutable texture before allocation!");const g=u.bindTexture(this,ai.TEXTURE_UNIT_FOR_UPDATES,!0);(i<0||r<0||i+s>l.width||r+n>l.height)&&Xo().error("An attempt to update out of bounds of the texture!"),this._configurePixelStorage();const{gl:_}=u;a&&(s&&n||Xo().warn("Must pass width and height if `UNPACK_SKIP_ROWS` is used"),_.pixelStorei(_.UNPACK_SKIP_ROWS,a)),eR(o)?_.texSubImage2D(m,t,i,r,s,n,c,d,o):fd(o)?_.compressedTexSubImage2D(m,t,i,r,s,n,l.internalFormat,o.levels[t]):_.texSubImage2D(m,t,i,r,s,n,c,d,o),a&&_.pixelStorei(_.UNPACK_SKIP_ROWS,0),u.bindTexture(g,ai.TEXTURE_UNIT_FOR_UPDATES)}updateData3D(t,i,r,s,n,o,a,l){l||Xo().error("An attempt to use uninitialized data!"),this.hasWebGLTextureObject||Xo().error("An attempt to update an uninitialized texture!");const u=this._descriptor;u.internalFormat=B0(u);const{context:c,pixelFormat:d,dataType:m,isImmutable:y,target:g}=u;if(y&&!this._wasImmutablyAllocated)throw new j("texture:uninitialized","Cannot update immutable texture before allocation!");Gh(g)||Xo().warn("Attempting to set 3D texture data on a non-3D texture");const _=c.bindTexture(this,ai.TEXTURE_UNIT_FOR_UPDATES);c.setActiveTexture(ai.TEXTURE_UNIT_FOR_UPDATES),(i<0||r<0||s<0||i+n>u.width||r+o>u.height||s+a>u.depth)&&Xo().error("An attempt to update out of bounds of the texture!"),this._configurePixelStorage();const{gl:v}=c;if(fd(l))l=l.levels[t],v.compressedTexSubImage3D(g,t,i,r,s,n,o,a,u.internalFormat,l);else{const b=l;v.texSubImage3D(g,t,i,r,s,n,o,a,d,m,b)}c.bindTexture(_,ai.TEXTURE_UNIT_FOR_UPDATES)}generateMipmap(){const t=this._descriptor;if(t.width===0||t.height===0)return;if(!t.hasMipmap){if(this._wasImmutablyAllocated)throw new j("texture:immutable-change","Cannot add mipmaps to immutable texture after allocation");t.hasMipmap=!0,this._samplingModeDirty=!0,Yf(t)}t.samplingMode===Tt.LINEAR?(this._samplingModeDirty=!0,t.samplingMode=Tt.LINEAR_MIPMAP_NEAREST):t.samplingMode===Tt.NEAREST&&(this._samplingModeDirty=!0,t.samplingMode=Tt.NEAREST_MIPMAP_NEAREST);const i=this._descriptor.context.bindTexture(this,ai.TEXTURE_UNIT_FOR_UPDATES);this._descriptor.context.setActiveTexture(ai.TEXTURE_UNIT_FOR_UPDATES),this._descriptor.context.gl.generateMipmap(t.target),this._descriptor.context.bindTexture(i,ai.TEXTURE_UNIT_FOR_UPDATES)}clearMipmap(){const t=this._descriptor;if(t.hasMipmap){if(this._wasImmutablyAllocated)throw new j("texture:immutable-change","Cannot delete mipmaps to immutable texture after allocation");t.hasMipmap=!1,this._samplingModeDirty=!0,Yf(t)}t.samplingMode===Tt.LINEAR_MIPMAP_NEAREST?(this._samplingModeDirty=!0,t.samplingMode=Tt.LINEAR):t.samplingMode===Tt.NEAREST_MIPMAP_NEAREST&&(this._samplingModeDirty=!0,t.samplingMode=Tt.NEAREST)}setSamplingMode(t){t!==this._descriptor.samplingMode&&(this._descriptor.samplingMode=t,this._samplingModeDirty=!0)}setWrapMode(t){t!==this._descriptor.wrapMode&&(this._descriptor.wrapMode=t,Yf(this._descriptor),this._wrapModeDirty=!0)}setShadowFiltering(t){t!==this._descriptor.linearFilterDepth&&(this._descriptor.linearFilterDepth=this._descriptor.compareEnabled=t,this.setSamplingMode(t?Tt.LINEAR:Tt.NEAREST),Yf(this._descriptor),this._shadowFilterDirty=!0)}applyChanges(){this._samplingModeDirty&&(this._applySamplingMode(),this._samplingModeDirty=!1),this._wrapModeDirty&&(this._applyWrapMode(),this._wrapModeDirty=!1),this._shadowFilterDirty&&(this._applyShadowMode(),this._shadowFilterDirty=!1)}abortCompression(){this._compressionAbortController=Lp(this._compressionAbortController)}_setData(t,i){const r=this._descriptor,s=r.context?.gl;if(!s)return;ku(s),this.hasWebGLTextureObject||(this._glName=s.createTexture(),r.context.instanceCounter.increment(Yv.Texture,this)),Yf(r);const n=r.context.bindTexture(this,ai.TEXTURE_UNIT_FOR_UPDATES);r.context.setActiveTexture(ai.TEXTURE_UNIT_FOR_UPDATES),this._configurePixelStorage(),ku(s);const o=i??r.target,a=Gh(o);if(eR(t))this._setDataFromTexImageSource(t,o);else{const{width:l,height:u,depth:c}=r;if(l==null||u==null)throw new j("texture:missing-size","Width and height must be specified!");if(a&&c==null)throw new j("texture:missing-depth","Depth must be specified!");if(r.internalFormat=B0(r),r.isImmutable&&!this._wasImmutablyAllocated&&this._texStorage(o,r.internalFormat,r.hasMipmap,l,u,c),fd(t)){if(!Xde(r.internalFormat))throw new j("texture:format-mismatch","Attempting to use compressed data with an uncompressed format!");this._setDataFromCompressedSource(t,r.internalFormat,o)}else this._texImage(o,0,r.internalFormat,l,u,c,t),ku(s),r.hasMipmap&&this.generateMipmap()}this._applySamplingMode(),this._applyWrapMode(),this._applyAnisotropicFilteringParameters(),this._applyShadowMode(),ku(s),r.context.bindTexture(n,ai.TEXTURE_UNIT_FOR_UPDATES)}_setDataCubeMap(t=null){for(let i=Rs.TEXTURE_CUBE_MAP_POSITIVE_X;i<=Rs.TEXTURE_CUBE_MAP_NEGATIVE_Z;i++)this._setData(t,i)}_configurePixelStorage(){const t=this._descriptor.context.gl,{unpackAlignment:i,flipped:r,preMultiplyAlpha:s}=this._descriptor;t.pixelStorei(t.UNPACK_ALIGNMENT,i),t.pixelStorei(t.UNPACK_FLIP_Y_WEBGL,r?1:0),t.pixelStorei(t.UNPACK_PREMULTIPLY_ALPHA_WEBGL,s?1:0)}_setDataFromTexImageSource(t,i){const{gl:r}=this._descriptor.context,s=this._descriptor;s.internalFormat=B0(s);const n=Gh(i),{width:o,height:a,depth:l}=Qde(t);s.width&&s.height,s.width||(s.width=o),s.height||(s.height=a),n&&s.depth,n&&(s.depth=l),s.isImmutable&&!this._wasImmutablyAllocated&&this._texStorage(i,s.internalFormat,s.hasMipmap,o,a,l),this._texImage(i,0,s.internalFormat,o,a,l,t),ku(r),s.hasMipmap&&(this.generateMipmap(),ku(r))}_setDataFromCompressedSource(t,i,r){const s=this._descriptor,{width:n,height:o,depth:a}=s,l=t.levels,u=tR(r,n,o,a),c=Math.min(u,l.length)-1;this._descriptor.context.gl.texParameteri(s.target,GM.MAX_LEVEL,c),this._forEachMipmapLevel(((d,m,y,g)=>{const _=l[Math.min(d,l.length-1)];this._compressedTexImage(r,d,i,m,y,g,_)}),c)}_texStorage(t,i,r,s,n,o){const{gl:a}=this._descriptor.context;if(!Jde(i)&&!VU(i)&&!UU(i))throw new j("texture:missing-format","Immutable textures must have a sized internal format");if(!this._descriptor.isImmutable)return;const l=r?tR(t,s,n,o):1;if(Gh(t)){if(o==null)throw new j("texture:missing-depth","Missing depth dimension for 3D texture upload");a.texStorage3D(t,l,i,s,n,o)}else a.texStorage2D(t,l,i,s,n);this._wasImmutablyAllocated=!0}_texImage(t,i,r,s,n,o,a){const l=this._descriptor.context.gl,u=Gh(t),{isImmutable:c,pixelFormat:d,dataType:m}=this._descriptor;if(c){if(a!=null){const y=a;if(u){if(o==null)throw new j("texture:missing-depth","Missing depth dimension for 3D texture upload");l.texSubImage3D(t,i,0,0,0,s,n,o,d,m,y)}else l.texSubImage2D(t,i,0,0,s,n,d,m,y)}}else{const y=a;if(u){if(o==null)throw new j("texture:missing-depth","Missing depth dimension for 3D texture upload");l.texImage3D(t,i,r,s,n,o,0,d,m,y)}else l.texImage2D(t,i,r,s,n,0,d,m,y)}}_compressedTexImage(t,i,r,s,n,o,a){const l=this._descriptor.context.gl,u=Gh(t);if(this._descriptor.isImmutable){if(a!=null)if(u){if(o==null)throw new j("texture:missing-depth","Missing depth dimension for 3D texture upload");l.compressedTexSubImage3D(t,i,0,0,0,s,n,o,r,a)}else l.compressedTexSubImage2D(t,i,0,0,s,n,r,a)}else if(u){if(o==null)throw new j("texture:missing-depth","Missing depth dimension for 3D texture upload");l.compressedTexImage3D(t,i,r,s,n,o,0,a)}else l.compressedTexImage2D(t,i,r,s,n,0,a)}async _compressOnWorker(t){const{width:i,height:r,context:s,flipped:n,preMultiplyAlpha:o,hasMipmap:a}=this._descriptor,l=this._descriptor.compress?.compressionTracker,u=this._descriptor.compress?.compressionCallback,{compressedTextureETC:c,compressedTextureS3TC:d}=s.capabilities;if(!ai.compressionWorkerHandle?.isCompressible(t,this._descriptor)||!c&&!d)return;this.abortCompression();const m=new AbortController;this._compressionAbortController=m,l?.increment();try{let y;t instanceof Uint8Array?y=t.buffer:(y=await createImageBitmap(t,{imageOrientation:n?"flipY":"none"}),It(m));const g={data:y,width:i,height:r,needsFlip:t instanceof Uint8Array&&this.descriptor.flipped,components:this._descriptor.pixelFormat===ni.RGBA?4:3,preMultiplyAlpha:o,hasMipmap:a,hasETC:!!c,hasS3TC:!!d},_=await ai.compressionWorkerHandle.invoke(g,m.signal,"low");if(It(m),_.compressedTexture&&this.hasWebGLTextureObject){const v=this.usedMemory;this._descriptor.internalFormat=_.internalFormat,this._setData(_.compressedTexture),u?.(v-this.usedMemory)}}catch(y){Er(y)||Xo().error("Texture compression failed!")}finally{l?.decrement(),this._compressionAbortController?.signal.aborted&&(this._compressionAbortController=null)}}_forEachMipmapLevel(t,i=1/0){let{width:r,height:s,depth:n,hasMipmap:o,target:a}=this._descriptor;const l=a===Rs.TEXTURE_3D;if(r==null||s==null||l&&n==null)throw new j("texture:missing-size","Missing texture dimensions for mipmap calculation");for(let u=0;t(u,r,s,n),o&&(r!==1||s!==1||l&&n!==1)&&!(u>=i);++u)r=Math.max(1,r>>1),s=Math.max(1,s>>1),l&&(n=Math.max(1,n>>1))}_applySamplingMode(){const t=this._descriptor,i=t.context?.gl;let r=t.samplingMode,s=t.samplingMode;r===Tt.LINEAR_MIPMAP_NEAREST||r===Tt.LINEAR_MIPMAP_LINEAR?(r=Tt.LINEAR,t.hasMipmap||(s=Tt.LINEAR)):r!==Tt.NEAREST_MIPMAP_NEAREST&&r!==Tt.NEAREST_MIPMAP_LINEAR||(r=Tt.NEAREST,t.hasMipmap||(s=Tt.NEAREST)),i.texParameteri(t.target,i.TEXTURE_MAG_FILTER,r),i.texParameteri(t.target,i.TEXTURE_MIN_FILTER,s)}_applyWrapMode(){const t=this._descriptor,i=t.context?.gl;typeof t.wrapMode=="number"?(i.texParameteri(t.target,i.TEXTURE_WRAP_S,t.wrapMode),i.texParameteri(t.target,i.TEXTURE_WRAP_T,t.wrapMode)):(i.texParameteri(t.target,i.TEXTURE_WRAP_S,t.wrapMode.s),i.texParameteri(t.target,i.TEXTURE_WRAP_T,t.wrapMode.t))}_applyShadowMode(){const t=this._descriptor,i=t.context?.gl,r=t.compareEnabled?i.COMPARE_REF_TO_TEXTURE:i.NONE;i.texParameteri(t.target,i.TEXTURE_COMPARE_MODE,r),t.compareEnabled&&i.texParameteri(t.target,i.TEXTURE_COMPARE_FUNC,i.GREATER),ku(i)}_applyAnisotropicFilteringParameters(){const t=this._descriptor,i=t.context.capabilities.textureFilterAnisotropic;i&&t.context.gl.texParameterf(t.target,i.TEXTURE_MAX_ANISOTROPY,t.maxAnisotropy??1)}},ai.TEXTURE_UNIT_FOR_UPDATES=0,ai.compressionWorkerHandle=null,ai);const H2=()=>H.getLogger("esri.views.2d.engine.webgl.painter.highlight.HighlightGradient");function ipe(e,t){t.fillColor[0]=e.color.r/255,t.fillColor[1]=e.color.g/255,t.fillColor[2]=e.color.b/255,t.fillColor[3]=e.color.a,e.haloColor?(t.outlineColor[0]=e.haloColor.r/255,t.outlineColor[1]=e.haloColor.g/255,t.outlineColor[2]=e.haloColor.b/255,t.outlineColor[3]=e.haloColor.a):(t.outlineColor[0]=t.fillColor[0],t.outlineColor[1]=t.fillColor[1],t.outlineColor[2]=t.fillColor[2],t.outlineColor[3]=t.fillColor[3]),t.fillColor[3]*=e.fillOpacity,t.outlineColor[3]*=e.haloOpacity,t.fillColor[0]*=t.fillColor[3],t.fillColor[1]*=t.fillColor[3],t.fillColor[2]*=t.fillColor[3],t.outlineColor[0]*=t.outlineColor[3],t.outlineColor[1]*=t.outlineColor[3],t.outlineColor[2]*=t.outlineColor[3],t.outlineWidth=(1-e.haloBlur)*e.haloWidth,t.outerHaloWidth=e.haloBlur*e.haloWidth/2,t.innerHaloWidth=e.haloBlur*e.haloWidth/2,t.outlinePosition=0}const rpe=[0,0,0,0];let GU=class{constructor(){this.type="single",this._highlightOptions=new ou,this._convertedHighlightOptions={fillColor:[0,0,0,0],outlineColor:[0,0,0,0],outlinePosition:0,outlineWidth:0,innerHaloWidth:0,outerHaloWidth:0},this._optionsShadeTexKey="",this._texelData=new Uint8Array(4*Wf),this._minMaxDistance=[0,0]}setHighlightOptions(t){this._highlightOptions=t}applyHighlightOptions(t,i){this._updateGradientTexture(t),t.bindTexture(this._shadeTex,Rde),i.setUniform2fv("u_minMaxDistance",this._minMaxDistance)}destroy(){this._shadeTex?.dispose(),this._shadeTex=null}getReasonsWithGradients(){return[{activeReasons:(1<<OU)-1,activeGradient:this}]}_updateGradientTexture(t){const i=spe(this._highlightOptions);if(i===this._optionsShadeTexKey)return;this._optionsShadeTexKey=i,ipe(this._highlightOptions,this._convertedHighlightOptions);const r=this._convertedHighlightOptions,s=r.outlinePosition-r.outlineWidth/2-r.outerHaloWidth,n=r.outlinePosition-r.outlineWidth/2,o=r.outlinePosition+r.outlineWidth/2,a=r.outlinePosition+r.outlineWidth/2+r.innerHaloWidth,l=Math.sqrt(Math.PI/2)*Gde,u=Math.abs(s)>l?Math.round(10*(Math.abs(s)-l))/10:0,c=Math.abs(a)>l?Math.round(10*(Math.abs(a)-l))/10:0;let d;u&&!c?H2().error("The outer rim of the highlight is "+u+"px away from the edge of the feature; consider reducing some width values or shifting the outline position towards positive values (inwards)."):!u&&c?H2().error("The inner rim of the highlight is "+c+"px away from the edge of the feature; consider reducing some width values or shifting the outline position towards negative values (outwards)."):u&&c&&H2().error("The highlight is "+Math.max(u,c)+"px away from the edge of the feature; consider reducing some width values.");const m=[void 0,void 0,void 0,void 0];function y(_,v,b){m[0]=(1-b)*_[0]+b*v[0],m[1]=(1-b)*_[1]+b*v[1],m[2]=(1-b)*_[2]+b*v[2],m[3]=(1-b)*_[3]+b*v[3]}const{_texelData:g}=this;for(let _=0;_<Wf;++_)d=s+_/(Wf-1)*(a-s),d<s?(m[0]=0,m[1]=0,m[2]=0,m[3]=0):d<n?y(rpe,r.outlineColor,(d-s)/(n-s)):d<o?[m[0],m[1],m[2],m[3]]=r.outlineColor:d<a?y(r.outlineColor,r.fillColor,(d-o)/(a-o)):[m[0],m[1],m[2],m[3]]=r.fillColor,g[4*_]=255*m[0],g[4*_+1]=255*m[1],g[4*_+2]=255*m[2],g[4*_+3]=255*m[3];if(this._minMaxDistance[0]=s,this._minMaxDistance[1]=a,!this._shadeTex){const _=new zU;_.wrapMode=Wv.CLAMP_TO_EDGE,_.width=Wf,_.height=1,this._shadeTex=new tpe(t,_)}this._shadeTex.updateData(0,0,0,Wf,1,this._texelData)}};function spe(e){return`${e.color};${e.haloColor};${e.haloOpacity};${e.fillOpacity};${e.haloWidth};${e.haloBlur}`}let npe=class{constructor(){this.type="multi",this.gradients=[]}setHighlightOptions(t){for(let i=0;i<t.length;i++)this.gradients[i]||(this.gradients[i]=new GU),this.gradients[i].setHighlightOptions(t[i]);for(let i=t.length+1;i<this.gradients.length;i++)this.gradients[i].destroy();this.gradients.length=t.length}destroy(){for(const t of this.gradients)t.destroy()}getReasonsWithGradients(){let t=1;const i=[];for(let r=0;r<this.gradients.length;r++){const s=this.gradients[r];i.push({activeReasons:t,activeGradient:s}),t<<=1}return i}};var iR,rR,sR,nR,oR,aR,Xv,lR,uR;(function(e){e[e.FILL=0]="FILL",e[e.LINE=1]="LINE",e[e.MARKER=2]="MARKER",e[e.TEXT=3]="TEXT",e[e.LABEL=4]="LABEL"})(iR||(iR={})),(function(e){e[e.NONE=0]="NONE",e[e.MAP=1]="MAP",e[e.LABEL=2]="LABEL",e[e.LABEL_ALPHA=4]="LABEL_ALPHA",e[e.HITTEST=8]="HITTEST",e[e.HIGHLIGHT=16]="HIGHLIGHT",e[e.CLIP=32]="CLIP",e[e.DEBUG=64]="DEBUG",e[e.NUM_DRAW_PHASES=9]="NUM_DRAW_PHASES"})(rR||(rR={})),(function(e){e[e.SIZE=0]="SIZE",e[e.COLOR=1]="COLOR",e[e.OPACITY=2]="OPACITY",e[e.ROTATION=3]="ROTATION"})(sR||(sR={})),(function(e){e[e.MINMAX_TARGETS_OUTLINE=128]="MINMAX_TARGETS_OUTLINE",e[e.SCALE_TARGETS_OUTLINE=256]="SCALE_TARGETS_OUTLINE",e[e.FIELD_TARGETS_OUTLINE=512]="FIELD_TARGETS_OUTLINE",e[e.UNIT_TARGETS_OUTLINE=1024]="UNIT_TARGETS_OUTLINE"})(nR||(nR={})),(function(e){e[e.SPRITE=0]="SPRITE",e[e.GLYPH=1]="GLYPH"})(oR||(oR={})),(function(e){e[e.DEFAULT=0]="DEFAULT",e[e.SIMPLE=1]="SIMPLE",e[e.DOT_DENSITY=2]="DOT_DENSITY",e[e.OUTLINE_FILL=3]="OUTLINE_FILL",e[e.OUTLINE_FILL_SIMPLE=4]="OUTLINE_FILL_SIMPLE",e[e.HEATMAP=5]="HEATMAP",e[e.PIE_CHART=6]="PIE_CHART"})(aR||(aR={})),(function(e){e[e.All=0]="All",e[e.Highlight=1]="Highlight",e[e.InsideEffect=2]="InsideEffect",e[e.OutsideEffect=3]="OutsideEffect"})(Xv||(Xv={})),(function(e){e[e.BATCHING=0]="BATCHING",e[e.STRICT_ORDER=1]="STRICT_ORDER",e[e.STRICT_MARKERS_AND_TEXT=2]="STRICT_MARKERS_AND_TEXT"})(lR||(lR={})),(function(e){e[e.FILL=0]="FILL",e[e.LINE=1]="LINE",e[e.MARKER=2]="MARKER",e[e.TEXT=3]="TEXT"})(uR||(uR={}));const BU={color:{write:[!0,!0,!0,!0],blendMode:"composite"},depth:!1,stencil:{write:!1,test:{ref:e=>e.stencilRef,compare:jM.EQUAL,mask:255,op:{fail:Iy.KEEP,zFail:Iy.KEEP,zPass:Iy.REPLACE}}}},ope={color:{write:[!0,!0,!0,!0],blendMode:"additive"},depth:!1,stencil:!1},ape={...BU,color:{write:[!0,!0,!0,!0],blendMode:"delete"}};function lpe({pixelRatio:e,state:t,displayLevel:i,requiredLevel:r},s){const n=1/2**(i-s.key.level),o=1/2**(r-s.key.level);return{displayMat3:t.displayMat3,displayViewMat3:t.displayViewMat3,displayViewScreenMat3:s.transforms.displayViewScreenMat3,viewMat3:t.viewMat3,tileMat3:s.transforms.tileMat3,displayZoomFactor:n,requiredZoomFactor:o,tileOffset:[s.x,s.y],currentScale:t.scale,currentZoom:i,metersPerSRUnit:Hs(t.spatialReference),rotation:t.rotation,pixelRatio:e}}function qU(e){return e.passOptions?.type==="highlight"}function HU(e){return e.passOptions?.type==="hittest"}function upe(e){if(!HU(e))return null;const{position:t,distance:i,smallSymbolDistance:r,smallSymbolSizeThreshold:s}=e.passOptions;return{position:t,distance:i,smallSymbolDistance:r,smallSymbolSizeThreshold:s}}function cpe(e){if(!qU(e))return null;const{activeReasons:t,highlightAll:i}=e.passOptions;return{activeReasons:t,highlightAll:i?1:0}}function UAe(e,t,i){const r={};for(const s in i)typeof i[s]!="function"?r[s]=i[s]:r[s]=i[s](e,t);return r}function jAe(e,t){const{attributeView:i,context:r}=e;return{storage:i.getUniforms(r),view:lpe(e,t),hittestRequest:upe(e),highlight:cpe(e)}}function GAe(e){return{inside:e.selection===Xv.InsideEffect,outside:e.selection===Xv.OutsideEffect}}function hpe(e){return HU(e)?ope:qU(e)&&e.passOptions.stepType==="clear"?ape:BU}function BAe(e){const{row:t,col:i}=e.key,r=i*Nd,s=t*Nd;return{tileOffsetFromLocalOrigin:[r%G0,s%G0],maxIntsToLocalOrigin:[Math.floor(r/G0),Math.floor(s/G0)]}}const dpe=new Ye({esriGeometryPoint:"point",esriGeometryMultipoint:"multipoint",esriGeometryPolyline:"polyline",esriGeometryPolygon:"polygon",esriGeometryMultiPatch:"multipatch",mesh:"mesh"});function qAe(e){return dpe.toJSON(e)}function HAe(e){const{bandCount:t,attributeTable:i,colormap:r,pixelType:s}=e.raster.rasterInfo;return t===1&&(i!=null||r!=null||s==="u8"||s==="s8")}function ppe(e,t){return t==null?(e?.destroy(),null):(e?.type==="single"&&Array.isArray(t)&&(e.destroy(),e=null),e?.type!=="multi"||Array.isArray(t)||(e.destroy(),e=null),e||(e=Array.isArray(t)?new npe:new GU),Array.isArray(t)?e.type==="multi"&&e.setHighlightOptions(t):e.type==="single"&&e.setHighlightOptions(t),e)}function WAe(e,t,i,r){const{painter:s,highlightGradient:n}=e,{highlight:o}=s.effects;if(!n)return;const a=e.passOptions,l=n.getReasonsWithGradients();for(let u=0;u<l.length;u++){const c={...e,passOptions:{type:"highlight",activeGradient:l[u].activeGradient,activeReasons:l[u].activeReasons,stepType:"burn",highlightAll:t}};if(o.bind(c),i(c),u<l.length-1){let m=0;for(let y=u+1;y<l.length;y++)m|=l[y].activeReasons;i({...e,passOptions:{type:"highlight",activeGradient:l[u].activeGradient,activeReasons:m,stepType:"clear",highlightAll:t}})}const d={...e,passOptions:{type:"highlight",activeGradient:l[u].activeGradient,activeReasons:l[u].activeReasons,stepType:"draw",highlightAll:t}};s.setPipelineState(hpe(e)),s.updatePipelineState(e.context),o.draw(d),o.unbind()}e.passOptions=a}const q0=e=>parseFloat(e)/100;function fpe(e,t,i){const r=typeof e.left=="string"?q0(e.left)*t:e.left,s=typeof e.right=="string"?q0(e.right)*t:e.right,n=typeof e.top=="string"?q0(e.top)*i:e.top,o=typeof e.bottom=="string"?q0(e.bottom)*i:e.bottom,a=n;return{xmin:r,xmax:Math.max(t-s,r),ymin:a,ymax:Math.max(i-o,n)}}function WU(e,t,i,r){switch(t.type){case"rect":{const{width:s,height:n}=e,{xmin:o,xmax:a,ymin:l,ymax:u}=fpe(t,s,n),{x:c,y:d}=i;return c>o&&c<a&&d>l&&d<u}case"path":return t.path.length===0||!Array.isArray(t.path[0][0])||nC(t.path,[i.x,i.y]);case"geometry":return t.geometry==null||(t.geometry.type==="polygon"?sC(t.geometry,r):Ng(t.geometry,r))}}function mpe(e){if(!e.highlights)return null;const t=e.highlights.findIndex((i=>i.name==="default"));return t===-1?null:e.highlights.items[t]}function ype(e,t){if(!e.highlights){if(!t)return;e.highlights=new ne([new ou])}const i=e.highlights.findIndex((r=>r.name==="default"));t?e.highlights.items[i].assignFrom(t):(e.highlights.removeAt(i),e.highlights.length===0&&(e.highlights=null))}async function gpe(e,t,i){const r=_V(t)?gV(e,t):t;if(!e.ready||isNaN(r.x)||isNaN(r.y))return{screenPoint:r,results:[]};let s=new Set;const n=new Set;let o=!1,a=null,l=null;i?.include?hR(i.include,cR(e,(m=>{s.add(m),W2(m,(y=>n.add(y)))}),((m,y)=>{n.add(m),s.add(y)}),(m=>{a||(a=new Set),a.add(m)}),(m=>s.add(m)),(()=>o=!0))):(o=!0,s=new Set(e.allLayerViews),s.forEach((m=>{W2(m,(y=>n.add(y)))}))),i?.exclude&&hR(i.exclude,cR(e,(m=>{s.delete(m),W2(m,(y=>n.delete(y)))}),(m=>n.delete(m)),(m=>{l||(l=new Set),l.add(m)})));const u=e.toMap(r),c=e.allLayerViews.filter((m=>!m.suspended&&s.has(m)&&m.clips.every((y=>WU(e,y,r,u))))).reverse();let d=[...o?e.graphicsView.hitTest(u).map((m=>({type:"graphic",graphic:m,layer:null,mapPoint:u}))):[],...await Promise.all(c.map((m=>m.hitTest(u,r))).toArray())].filter(rr).flat().filter(rr);return d=d.filter((m=>m.type!=="graphic"||m.layer?.type!=="subtype-group"||n.has(m.graphic.layer))),a&&(d=d.filter((m=>!("graphic"in m)||!m.graphic||a?.has(qM(m.graphic))))),l&&(d=d.filter((m=>!("graphic"in m)||!m.graphic||!l?.has(qM(m.graphic))))),{screenPoint:r,results:d}}function cR(e,t,i,r,s,n){return o=>{if(o instanceof Ni){if(o.layer===e)n?.();else{const a=e.allLayerViews.find((l=>l.layer===o.layer));a&&s?.(a)}r(qM(o))}else if(!("layer"in o&&"element"in o))if(o.type==="subtype-sublayer"){const a=e.allLayerViews.find((l=>l.layer===o.parent));a&&i(o,a)}else{const a=e.allLayerViews.find((l=>l.layer===o));a&&t(a)}}}function hR(e,t){if(e)if(q1(e))for(const i of e)if(q1(i))for(const r of i)t(r);else t(i);else t(e)}function qM(e){const t=e.getObjectId();return t?`${e.layer?.uid??e.sourceLayer?.uid??"MapView"}/${t}`:`"MapView/${e.uid}`}function W2({layer:e},t){e?.type==="subtype-group"&&e.sublayers.forEach((i=>{t(i)}))}let Jf=null,Kv=!0;function _pe(e,t,i){if(!e||!t)throw new Error("Cannot construct image data without dimensions");if(Kv)try{return new ImageData(e,t)}catch{Kv=!1}return ZU(e,t,i)}function ZAe(e,t,i,r){if(!t||!i)throw new Error("Cannot construct image data without dimensions");if(Kv)try{return new ImageData(e,t,i)}catch{Kv=!1}const s=ZU(t,i,r);return s.data.set(e,0),s}function vpe(){return Jf||(Jf=document.createElement("canvas"),Jf.width=1,Jf.height=1),Jf}function ZU(e,t,i){return i||(i=vpe()),i.getContext("2d").createImageData(e,t)}async function bpe(e,t){const i=window.URL.createObjectURL(e);try{const{data:r}=await at(i,{...t,responseType:"image"});return r}catch(r){throw Er(r)?r:new j("invalid-image",`Could not fetch requested image at ${i}`)}finally{window.URL.revokeObjectURL(i)}}async function wpe(e,t){const{arrayBuffer:i,mediaType:r}=await Spe(e,t),s=r==="image/png";if(r==="image/gif"){const{isAnimatedGIF:n,parseGif:o}=await J(()=>import("./gif-DRVL5M00.js"),[]);if(n(i))return o(i,t)}if(s){const{isAnimatedPNG:n,parseApng:o}=await J(()=>import("./apng--pyDaOiO.js"),__vite__mapDeps([287,19]));if(n(i))return o(i,t)}return bpe(new Blob([i],{type:r}),t)}async function Spe(e,t){const i=Ap(e);if(i?.isBase64)return{arrayBuffer:KN(i.data),mediaType:i.mediaType};const r=await at(e,{responseType:"array-buffer",...t});return{arrayBuffer:r.data,mediaType:r.getHeader?.("Content-Type")??""}}function YU(e,t,i){const{ctx:r,canvas:s}=XU(e,i),n=r.getImageData(0,0,e.width,e.height),o=QU(s,t);return KU(s),{dataUrl:o,data:n}}function JU(e,t){const{ctx:i,canvas:r}=XU(e,t),s=i.getImageData(0,0,e.width,e.height);return KU(r),s}function XU(e,t){const i=xpe();t.premultipliedAlpha&&Epe(e),i.width=e.width,i.height=e.height;const r=i.getContext("2d",{willReadFrequently:!0});return r.putImageData(e,0,0),t.flipY&&Tpe(r),{ctx:r,canvas:i}}function KU(e){e.width=0,e.height=0}function xpe(){return Z2==null&&(Z2=document.createElement("canvas")),Z2}let Z2=null;function QU(e,t){const i=Cpe[t.format],r=t.quality/100;return e.toDataURL(i,r)}function e9(e,t){const i=Mpe(e),r=Ipe[i];return{format:i,quality:lr(t??r,0,100)}}function t9(e,t){return t/Math.max(e[0],e[1])}function $pe(e,t,i,r=0,s=0,n=e.width-r,o=e.height-s,a=!1){const{data:l}=e,{width:u,height:c,data:d}=t,m=n/u,y=o/c,g=Math.ceil(m/2),_=Math.ceil(y/2),v=e.width;for(let b=0;b<c;b++)for(let S=0;S<u;S++){const $=4*(S+(a?c-b-1:b)*u);let E=0,C=0,P=0,k=0,F=0,D=0;const U=(b+.5)*y;for(let W=Math.floor(b*y);W<(b+1)*y;W++){const Y=Math.abs(U-(W+.5))/_,re=(S+.5)*m,K=Y*Y;for(let Ce=Math.floor(S*m);Ce<(S+1)*m;Ce++){const Ve=Math.abs(re-(Ce+.5))/g,Je=Math.sqrt(K+Ve*Ve);if(Je>=1)continue;let Oe=2*Je*Je*Je-3*Je*Je+1;const Lt=4*(r+Ce+(s+W)*v);D+=Oe*l[Lt+3],C+=Oe,!i&&l[Lt+3]<255&&(Oe=Oe*l[Lt+3]/255),P+=Oe*l[Lt],k+=Oe*l[Lt+1],F+=Oe*l[Lt+2],E+=Oe}}d[$]=P/E,d[$+1]=k/E,d[$+2]=F/E,d[$+3]=D/C}return t}function Mpe(e){switch(e){case"png":case"jpg":case"jpeg":return e;default:return Ppe}}function Tpe(e){e.save(),e.globalCompositeOperation="copy",e.scale(1,-1),e.translate(0,-e.canvas.height),e.drawImage(e.canvas,0,0),e.restore()}function Epe(e){const t=e.data,i=t.length;for(let r=0;r<i;r+=4){const s=t[r+3];if(s!==255&&s>0){const n=255/s;t[r]=t[r]*n,t[r+1]=t[r+1]*n,t[r+2]=t[r+2]*n}}}const Cpe={png:"image/png",jpg:"image/jpeg",jpeg:"image/jpeg"},dR=98,Ppe="png",Ipe={png:100,jpg:dR,jpeg:dR},YAe=Object.freeze(Object.defineProperty({__proto__:null,createEmptyImageData:_pe,encode:YU,encodeData:JU,getFormatAndQuality:e9,getMaximumResolutionScale:t9,resampleHermite:$pe,toDataUrl:QU},Symbol.toStringTag,{value:"Module"})),i9={flipY:!0,premultipliedAlpha:!0};async function Ape(e,t){const i=await r9(e,t),{format:r,quality:s}=e9(t?.format,t?.quality);return YU(i,{format:r,quality:s},i9)}async function Lpe(e,t){const i=await r9(e,t);return JU(i,i9)}function r9(e,t){const i=Ope(t||{},Rpe(e.stage,e.size),e.size,e.padding),r=kpe(t,e.allLayerViews);return e.stage.takeScreenshot(i,r,e.backgroundColor,t?.rotation)}function kpe(e={},t){if(!e.layers)return;const i=[];return e.layers.forEach((r=>{const s=t.find((n=>n.layer.id===r.id));s?.container&&i.push(s.container)})),i}function Rpe(e,t){return Math.min(4,t9(t,Math.min(4096,e.context.parameters.maxTextureSize)))}function Ope(e,t,i,r){e.ignorePadding&&(r={left:0,right:0,top:0,bottom:0});let s=null;e.width!=null&&e.height!=null?s=[e.width,e.height]:e.width==null&&e.height!=null?s=[e.height,e.height]:e.width!=null&&e.height==null?s=[e.width,e.width]:e.width==null&&e.height==null&&(s=null);const n=i[0]-(r.left+r.right),o=i[1]-(r.top+r.bottom);let a,l,u=e.area||{x:0,y:0,width:n,height:o};if(s){const c=n/o,d=s[0]/s[1];if(d>c){const m=u.width/d;u={x:u.x,y:Math.round(u.y+(u.height-m)/2),width:u.width,height:Math.round(m)}}else{const m=u.height*d;u={x:Math.round(u.x+(u.width-m)/2),y:u.y,width:Math.round(m),height:u.height}}}else s=[u.width,u.height];return s[0]>u.width?(a=Math.min(s[0]/u.width,t),l=s[0]/u.width/a):(a=1,l=s[0]/u.width),{cropArea:{x:Math.round((u.x+r.left)*a),y:Math.round((u.y+r.top)*a),width:Math.round(u.width*a),height:Math.round(u.height*a)},outputScale:l,resolutionScale:a}}const Npe=e=>e.includes("Brush");let s9=class{constructor(){this._names=new Map}begin(t){this._names.has(t)||(this._names.set(t,!1),Npe(t)&&this.record("Esri.FirstDraw"),performance.mark(`Esri.${t}.Start`))}end(t){this._names.has(t)&&!this._names.get(t)&&(this._names.set(t,!0),performance.mark(`Esri.${t}.End`))}record(t){this._names.has(t)||(this._names.set(t,!0),performance.mark(`Esri.${t}`))}},Dpe=class{constructor(t){this.getUnmaskedRenderer=t}};function Fpe(e){const t=e.getExtension("WEBGL_debug_renderer_info");return t?new Dpe((()=>e.getParameter(t.UNMASKED_RENDERER_WEBGL))):null}let pR;function zpe(){return pR??=jpe(),pR}let Vpe=class{constructor(){this.available=!1,this.majorPerformanceCaveat=!1,this.maxTextureSize=0,this.supportsVertexShaderSamplers=!1,this.supportsHighPrecisionFragment=!1,this.supportsColorBufferFloat=!1,this.supportsColorBufferFloatBlend=!1,this.supportsColorBufferHalfFloat=!1,this.unmaskedRenderer="unloaded"}};function Upe(e){if(typeof WebGL2RenderingContext>"u")return null;const t=document.createElement("canvas");if(!t)return null;let i=t.getContext("webgl2",{failIfMajorPerformanceCaveat:!0});if(i==null&&(i=t.getContext("webgl2"),i!=null&&(e.majorPerformanceCaveat=!0,e.unmaskedRenderer=Fpe(i)?.getUnmaskedRenderer()??"unknown")),i==null)return i;e.available=!0,e.maxTextureSize=i.getParameter(i.MAX_TEXTURE_SIZE),e.supportsVertexShaderSamplers=i.getParameter(i.MAX_VERTEX_TEXTURE_IMAGE_UNITS)>0;const r=i.getShaderPrecisionFormat(i.FRAGMENT_SHADER,i.HIGH_FLOAT);return r&&(e.supportsHighPrecisionFragment=r.precision>0),i}function jpe(){const e=new Vpe,t=Upe(e);return t==null||(e.supportsColorBufferFloat=t.getExtension("EXT_color_buffer_float")!==null,e.supportsColorBufferFloatBlend=t.getExtension("EXT_float_blend")!==null,e.supportsColorBufferHalfFloat=e.supportsColorBufferFloat||t.getExtension("EXT_color_buffer_half_float")!==null),e}function Gpe(e){const t=zpe();return t.available?e==="3d"&&t.majorPerformanceCaveat?new j("webgl:major-performance-caveat-detected",`Your WebGL implementation (${t.unmaskedRenderer}) doesn't seem to support hardware accelerated rendering. Check your browser settings or if your GPU is in a blocklist.`):t.supportsHighPrecisionFragment?t.supportsVertexShaderSamplers?null:new j("webgl:vertex-shader-samplers-required","WebGL support for vertex shader samplers is required but not supported."):new j("webgl:high-precision-fragment-required","WebGL support for high precision fragment shaders is required but not supported."):new j("webgl:required","WebGL2 is required but not supported.",new Error().stack)}function Bpe(e){return e&&"nodeType"in e}function qpe(e){return e&&typeof e.render=="function"}const fR={component:"esri-component"};let ic=class extends le{constructor(){super(...arguments),this.widget=null}destroy(){this.node=null,this.widget?.destroy()}get id(){return this._get("id")??this.widget?.id??this.node?.id}set id(t){this._set("id",t)}set node(t){const i=this._get("node");t!==i&&(t&&t.classList.add(fR.component),i&&i.classList.remove(fR.component),this._set("node",t))}castNode(t){return this.widget?.destroy(),t?typeof t=="string"||Bpe(t)?(this._set("widget",null),DC(t)):(qpe(t)&&!t.domNode&&(t.domNode=document.createElement("div")),this._set("widget",t),t.domNode):(this._set("widget",null),null)}};h([f()],ic.prototype,"id",null),h([f()],ic.prototype,"node",null),h([Ke("node")],ic.prototype,"castNode",null),h([f({readOnly:!0})],ic.prototype,"widget",void 0),ic=h([I("esri.views.ui.Component")],ic);const m1=ic,n9="calcite-mode-",o9="dark",Hpe="light",Wpe=/\W/g,Zpe="--esri-calcite-mode-name";function a9(){return getComputedStyle(document.body).getPropertyValue(Zpe).replaceAll(Wpe,"").toLowerCase()}function l9(){return a9()===o9}function Ype(){const e=a9();switch(e){case o9:case Hpe:return`${n9}${e}`;default:return null}}function Jpe(e){const t=Ype();t&&(Xpe(e),e.classList.add(t))}function Xpe(e){Array.from(e.classList).forEach((t=>{t.startsWith(n9)&&e.classList.remove(t)}))}const gw=new Map;function u9(){gw.clear()}function Kpe(e){return gw.get(e)}function Qpe(e,t){gw.set(e,t)}function Y2(e){gw.delete(e)}function Dd(...e){const t=Sr.acquire();for(let r=0;r<e.length;r++){const s=e[r],n=typeof s;if(n==="string")t.push(s);else if(Array.isArray(s))t.push.apply(t,s);else if(n==="object")for(const o in s)s[o]&&t.push(o)}const i=t.join(" ");return Sr.release(t),i}(()=>{const e=new Map,t=new ResizeObserver((r=>{u9();for(const s of r)e.get(s.target)?.(s)})),i=(r,s,n)=>(e.set(r,s),t.observe(r,n),ze((()=>{t.unobserve(r),e.delete(r)})));return(r,s,n)=>{let o=null;return gh([te((()=>typeof r=="function"?r():r),(a=>{o?.remove(),a&&(o=i(a,s,n))}),br),ze((()=>o?.remove()))])}})();function _w(e){const t=e?.closest("[dir]");return t!==null&&t instanceof HTMLElement&&t.dir==="rtl"||document.dir==="rtl"}function eLe(e){const t="data-node-ref";this[e.getAttribute(t)]=null}function tLe(e){const t="data-node-ref";this[e.getAttribute(t)]=e}function efe(e){return e==="Enter"||e===" "}async function tfe(e,t){await $W(Eg(t));const i=typeof e=="function"?e():e;i&&("setFocus"in i&&typeof i.setFocus=="function"?await i.setFocus():i instanceof HTMLElement&&i.focus())}const ife={left:0,top:0,bottom:0,right:0},c9={bottom:30,top:15,right:15,left:15},Ko="esri-ui",Pr={ui:Ko,corner:`${Ko}-corner`,innerContainer:`${Ko}-inner-container`,manualContainer:`${Ko}-manual-container`,cornerContainer:`${Ko}-corner-container`,topLeft:`${Ko}-top-left`,topRight:`${Ko}-top-right`,bottomLeft:`${Ko}-bottom-left`,bottomRight:`${Ko}-bottom-right`};function rfe(e){return e&&!e._started&&typeof e.postMixInProperties=="function"&&typeof e.buildRendering=="function"&&typeof e.postCreate=="function"&&typeof e.startup=="function"}function H0(e){return e===0?"0":`${e}px`}function J2(e){const t=typeof e=="object"&&e!==null&&Object.getPrototypeOf(e);return(t===null||t===Object.prototype)&&("component"in e||"index"in e||"position"in e)?e:null}function X2(e,{top:t,bottom:i,left:r,right:s}){e.style.top=t,e.style.bottom=i,e.style.left=r,e.style.right=s}let Yn=class extends Ja.EventedAccessor{constructor(t){super(t),this._cornerNameToContainerLookup={},this._positionNameToContainerLookup={},this._components=new Array,this._componentMap=new Map,this._removeWidgetHandleKey=Symbol("componentOnRemoveSymbol"),this._locale=Hr(),this.view=null,this._applyViewPadding=()=>{const i=this.container;i&&X2(i,this._toPixelPosition(this._getViewPadding()))},this._applyUIPadding=()=>{const i=this._innerContainer;i&&X2(i,this._toPixelPosition(this.padding))},this._initContainers()}initialize(){this.addHandles([te((()=>[this.view?.padding,this.container]),this._applyViewPadding,Pt),te((()=>this.padding),this._applyUIPadding,Pt),te((()=>[this.container,this._locale]),(([t,i])=>{t&&t.setAttribute("lang",i)}),Pt),aC((t=>{this._locale=t}))])}destroy(){this.container=null;for(const t of this._components)t.destroy();this._components.length=0,this._componentMap.clear()}set container(t){const i=this._get("container");t!==i&&(t&&(t.classList.add(Pr.ui),Jpe(t),this._attachContainers(t)),i&&(i.classList.remove(Pr.ui),X2(i,{top:"",bottom:"",left:"",right:""}),i.textContent=""),this._set("container",t))}get height(){const t=this.view?.height??0;if(t===0)return t;const i=this._getViewPadding(),{top:r,bottom:s}=i;return Math.max(t-r-s,0)}get padding(){return this._get("padding")}set padding(t){this._overrideIfSome("padding",t)}castPadding(t){return typeof t=="number"?{bottom:t,top:t,right:t,left:t}:{...c9,...t}}get width(){const t=this.view?.width??0;if(t===0)return t;const i=this._getViewPadding(),{left:r,right:s}=i;return Math.max(t-r-s,0)}add(t,i){let r,s,n;if(Array.isArray(t))return void t.forEach((a=>this.add(a,i)));const o=J2(t);o&&({index:r,position:i,component:t,key:s}=o),i&&typeof i=="object"&&({index:r,key:s,position:i,internal:n}=i),!t||i&&!this._isValidPosition(i)||this._add(t,i,r??this._getNumComponentsAtPosition(i),s,n)}remove(t,i){if(!t)return;if(Array.isArray(t))return t.map((s=>this.remove(s,i)));const r=this._find(t);if(r){const s=this._componentMap.get(r);if(!s||s.key!==i)return;const n=this._components.indexOf(r);return r.node.parentNode?.removeChild(r.node),this._componentMap.delete(r),r.widget?.removeHandlesReference(this._removeWidgetHandleKey),this._components.forEach((a=>{const l=this._componentMap.get(a);l&&l.position===s.position&&l.index>s.index&&l.index--})),this._components.splice(n,1)[0]}}empty(t,i={removeInternal:!1}){if(Array.isArray(t)){for(const n of t)this.empty(n,i);return}const r=this._positionNameToContainerLookup[t??"manual"],s=Array.prototype.slice.call(r.children).map((n=>this._findByNode(n))).filter((n=>n==null?!1:!(this._componentMap.get(n)?.internal??!1)||i.removeInternal));for(const n of s)this.remove(n)}move(t,i){if(Array.isArray(t)&&t.forEach((o=>this.move(o,i))),!t)return;let r;const s=J2(t)||J2(i);if(s&&(r=s.index,i=s.position,t=s.component||t),i&&!this._isValidPosition(i))return;const n=this.remove(t);n&&this.add(n,{position:i,index:r})}find(t){if(!t)return null;const i=this._findById(t);return i&&(i.widget||i.node)}getComponents(t,i={includeInternal:!1}){return t?Array.isArray(t)?t.flatMap((r=>this._getComponentsAtPosition(r,i))):this._getComponentsAtPosition(t,i):this._components.filter((r=>i.includeInternal||!this._componentMap.get(r)?.internal)).map((({widget:r,node:s})=>r??s))}getPosition(t){for(const i in this._positionNameToContainerLookup)if(this._positionNameToContainerLookup[i].contains(t))return i;return null}_add(t,i,r,s,n){t instanceof m1||(t=new m1({node:t}));const{widget:o}=t;o!=null&&o instanceof le&&o.addHandles(ze((()=>{queueMicrotask((()=>this.remove(t)))})),this._removeWidgetHandleKey),this._components.some((a=>this._componentMap.get(a)?.position===i&&this._componentMap.get(a)?.index===r))&&this._components.forEach((a=>{const l=this._componentMap.get(a);l&&l.position===i&&l.index>=r&&l.index++})),this._place({component:t,position:i,index:r}),this._components.push(t),this._componentMap.set(t,{key:s,position:i,internal:n,index:r})}_find(t){return t?t instanceof m1?this._findByComponent(t):typeof t=="string"?this._findById(t):"domNode"in t?this._findByNode(t.domNode):this._findByNode(t):null}_getViewPadding(){return this.view?.padding??ife}_attachContainers(t){t.appendChild(this._innerContainer),t.appendChild(this._manualContainer)}_initContainers(){const t=document.createElement("div");t.classList.add(Pr.innerContainer,Pr.cornerContainer);const i=document.createElement("div");i.classList.add(Pr.innerContainer,Pr.manualContainer);const r=document.createElement("div");r.classList.add(Pr.topLeft,Pr.corner),t.appendChild(r);const s=document.createElement("div");s.classList.add(Pr.topRight,Pr.corner),t.appendChild(s);const n=document.createElement("div");n.classList.add(Pr.bottomLeft,Pr.corner),t.appendChild(n);const o=document.createElement("div");o.classList.add(Pr.bottomRight,Pr.corner),t.appendChild(o),this._innerContainer=t,this._manualContainer=i;const a=_w();this._cornerNameToContainerLookup={"top-left":r,"top-right":s,"bottom-left":n,"bottom-right":o,"top-leading":a?s:r,"top-trailing":a?r:s,"bottom-leading":a?o:n,"bottom-trailing":a?n:o},this._positionNameToContainerLookup={manual:i,...this._cornerNameToContainerLookup}}_isValidPosition(t){return!!this._positionNameToContainerLookup[t]}_place(t){const i=t.position??"manual",{component:r,index:s}=t,n=this._positionNameToContainerLookup[i],o=s!=null&&s>-1;if(rfe(r.widget)&&r.widget.startup(),!o)return void n.appendChild(r.node);const a=Array.from(n.children);if(a.length!==0){for(const l of a){const u=this._findByNode(l);if(u&&s<(this._componentMap.get(u)?.index??0))return void l.parentNode?.insertBefore(r.node,l)}n.appendChild(r.node)}else n.appendChild(r.node)}_toPixelPosition(t){return{top:H0(t.top),left:H0(t.left),right:H0(t.right),bottom:H0(t.bottom)}}_findByComponent(t){return this._components.find((i=>i===t))??null}_findById(t){return this._components.find((({id:i})=>i===t))??null}_findByNode(t){return t?this._components.find((({node:i})=>i===t)):null}_getComponentsAtPosition(t,i){const r=this._positionNameToContainerLookup[t];return Array.prototype.slice.call(r.children).map((s=>this._findByNode(s))).filter(rr).filter((s=>i.includeInternal||!this._componentMap.get(s)?.internal)).map((({widget:s,node:n})=>s??n))}_getNumComponentsAtPosition(t){return this._positionNameToContainerLookup[t]?.children.length??0}};h([f()],Yn.prototype,"_locale",void 0),h([f()],Yn.prototype,"container",null),h([f()],Yn.prototype,"height",null),h([f({value:c9})],Yn.prototype,"padding",null),h([Ke("padding")],Yn.prototype,"castPadding",null),h([f()],Yn.prototype,"view",void 0),h([f()],Yn.prototype,"width",null),Yn=h([I("esri.views.ui.UI")],Yn);const sfe=Yn,nfe={handleInterceptedEvent:(e,t,i,r)=>(e.scheduleRender(),t.properties[`on${r.type}`].apply(t.properties.bind||i,[r]))},ofe={namespace:void 0,performanceLogger:()=>{},eventHandlerInterceptor:void 0,styleApplyer:(e,t,i)=>{t.charAt(0)==="-"?e.style.setProperty(t,i):e.style[t]=i}},afe=e=>({...ofe,...e}),lfe=(e,t)=>{const i=[];for(;e&&e!==t;)i.push(e),e=e.parentNode;return i},ufe=(e,t)=>e.find(t),mR=(e,t,i=!1)=>{let r=e;return t.forEach(((s,n)=>{const o=r?.children?ufe(r.children,(a=>a.domNode===s)):void 0;i&&!o&&n!==t.length-1||(r=o)})),r},cfe=e=>{let t;const i={...nfe,...e},r=afe(i),s=r.performanceLogger;let n,o=!0,a=!1;const l=[],u=[],c=(m,y,g)=>{let _;r.eventHandlerInterceptor=(b,S,$,E)=>function(C){let P;s("domEvent",C);const k=lfe(C.currentTarget,_.domNode),F=k.some((U=>customElements.get(U?.tagName?.toLowerCase())));if(C.eventPhase===Event.CAPTURING_PHASE||!F)k.reverse(),P=mR(_.getLastRender(),k);else{const U=C.composedPath(),W=U.slice(U.indexOf(C.currentTarget),U.indexOf(_.domNode)).reverse();P=mR(_.getLastRender(),W,!0)}let D;return P&&(D=i.handleInterceptedEvent(t,P,this,C)),s("domEventProcessed",C),D},i.postProcessProjectionOptions?.(r);const v=g();_=m(y,v,r),r.eventHandlerInterceptor=void 0,l.push(_),u.push(g),i.afterFirstVNodeRendered&&i.afterFirstVNodeRendered(_,v)};let d=()=>{if(n=void 0,o){o=!1,s("renderStart",void 0);for(let m=0;m<l.length;m++){const y=u[m]();s("rendered",void 0);try{l[m].update(y)}catch(g){console.error(g)}s("patched",void 0)}s("renderDone",void 0),o=!0}};return i.modifyDoRenderImplementation&&(d=i.modifyDoRenderImplementation(d,l,u)),t={renderNow:d,scheduleRender:()=>{n||a||(n=requestAnimationFrame(d))},stop:()=>{n&&(cancelAnimationFrame(n),n=void 0),a=!0},resume:()=>{a=!1,o=!0,t.scheduleRender()},append:(m,y)=>{c(tu.append,m,y)},insertBefore:(m,y)=>{c(tu.insertBefore,m,y)},merge:(m,y)=>{c(tu.merge,m,y)},replace:(m,y)=>{c(tu.replace,m,y)},detach:m=>{for(let y=0;y<u.length;y++)if(u[y]===m)return u.splice(y,1),l.splice(y,1)[0];throw new Error("renderFunction was not found")}},t};class ag{constructor(){this.promise=new Promise((t,i)=>{this.resolve=t,this.reject=i})}}const hfe=(e,t)=>{let i=e;for(;i;){if(i===t)return!0;if(!i.parentNode)return!1;i.parentNode instanceof ShadowRoot?i=i.parentNode.host:i=i.parentNode}return!1},dfe=(e,t,i)=>{const r=pfe(t).subscribe;return r(s=>{s.some(o=>hfe(e,o.target))&&i()})},K2={},pfe=e=>{const t=e.join(","),i=K2[t];if(i!==void 0)return i;const r=new Set,s=new MutationObserver(o=>r.forEach(a=>a(o)));globalThis.document&&s.observe(document.documentElement,{attributes:!0,attributeFilter:e,subtree:!0});const n={subscribe:o=>(r.add(o),()=>{r.delete(o),r.size===0&&(s.disconnect(),K2[t]=void 0)})};return K2[t]=n,n},ffe=(e,t)=>{let i=e;for(;i;){const r=i.closest?.(t);if(r)return r;const s=i.getRootNode?.();if(s===globalThis.document)return null;i=s.host}return null},mfe=(e,t,i)=>ffe(e,`[${t}]`)?.getAttribute(t)??i,Rt=(e,t,...i)=>{try{return e?.call(t,...i)}catch(r){console.error(r,e)}},HM=async(e,t,...i)=>{try{return await e?.call(t,...i)}catch(r){console.error(r,e)}},yfe="ar,bg,bs,ca,cs,da,de,el,en,es,et,fi,fr,he,hr,hu,id,it,ja,ko,lt,lv,nl,nb,no,pl,pt-BR,pt-PT,ro,ru,sk,sl,sr,sv,th,tr,uk,vi,zh-CN,zh-HK,zh-TW".split(","),gfe=new Set(yfe),Qv="en",_fe={pt:"pt-PT",nb:"no",nn:"no",zh:"zh-CN"},vfe=async(e,t,i="")=>{const r=`${t}/${i}`,s=`${r}${e}.json`;return Q2[s]??(Q2[s]=h9(e,r)),await Q2[s]},Q2={},h9=async(e,t)=>{const i=`${t}${e}.json`;try{const r=await fetch(i);if(r.ok)return await r.json()}catch(r){return console.error(r),{}}return e===Qv?{}:await h9(Qv,t)},bfe=e=>{const t=mfe(e,"lang",globalThis.navigator?.language||Qv);return{lang:t,t9nLocale:d9(t)}},d9=e=>{const[t,i]=e.split("-"),r=t.toLowerCase();let s=r;return i&&(s=`${r}-${i.toUpperCase()}`),s=_fe[s]??s,gfe.has(s)?s:i?d9(r):Qv},rLe=(e,t,i,r)=>{let s;const n=()=>wfe(e,t(),r).then(o=>{(s?.lang!==o.lang||s.t9nLocale!==o.t9nLocale||s.t9nStrings!==o.t9nStrings)&&i(o),s=o}).catch(console.error);return queueMicrotask(n),dfe(e,["lang"],n)},wfe=async(e,t,i=e.localName.split("-").slice(1).join("-"))=>{const{lang:r,t9nLocale:s}=bfe(e),n=`${t}/${i}/t9n`,a=i===null?{}:await vfe(s,n,"messages.");return{lang:r,t9nLocale:s,t9nStrings:a}},Sfe=e=>e.replace(xfe,(t,i)=>`${i===0?"":"-"}${t.toLowerCase()}`),xfe=/[A-Z]+(?![a-z])|[A-Z]/gu,$fe=(e,t)=>{const i=t/Mfe;let r=0;const s=setInterval(()=>{r+=i,r>=t&&(clearInterval(s),e())},i);return s},Mfe=4;/**
 * @license
 * Copyright 2019 Google LLC
 * SPDX-License-Identifier: BSD-3-Clause
 */const y1=globalThis,pP=y1.ShadowRoot&&(y1.ShadyCSS===void 0||y1.ShadyCSS.nativeShadow)&&"adoptedStyleSheets"in Document.prototype&&"replace"in CSSStyleSheet.prototype,fP=Symbol(),yR=new WeakMap;let p9=class{constructor(t,i,r){if(this._$cssResult$=!0,r!==fP)throw Error("CSSResult is not constructable. Use `unsafeCSS` or `css` instead.");this.cssText=t,this.t=i}get styleSheet(){let t=this.o;const i=this.t;if(pP&&t===void 0){const r=i!==void 0&&i.length===1;r&&(t=yR.get(i)),t===void 0&&((this.o=t=new CSSStyleSheet).replaceSync(this.cssText),r&&yR.set(i,t))}return t}toString(){return this.cssText}};const Tfe=e=>new p9(typeof e=="string"?e:e+"",void 0,fP),nLe=(e,...t)=>{const i=e.length===1?e[0]:t.reduce(((r,s,n)=>r+(o=>{if(o._$cssResult$===!0)return o.cssText;if(typeof o=="number")return o;throw Error("Value passed to 'css' function must be a 'css' function result: "+o+". Use 'unsafeCSS' to pass non-literal values, but take care to ensure page security.")})(s)+e[n+1]),e[0]);return new p9(i,e,fP)},Efe=(e,t)=>{if(pP)e.adoptedStyleSheets=t.map((i=>i instanceof CSSStyleSheet?i:i.styleSheet));else for(const i of t){const r=document.createElement("style"),s=y1.litNonce;s!==void 0&&r.setAttribute("nonce",s),r.textContent=i.cssText,e.appendChild(r)}},gR=pP?e=>e:e=>e instanceof CSSStyleSheet?(t=>{let i="";for(const r of t.cssRules)i+=r.cssText;return Tfe(i)})(e):e;/**
 * @license
 * Copyright 2017 Google LLC
 * SPDX-License-Identifier: BSD-3-Clause
 */const{is:Cfe,defineProperty:Pfe,getOwnPropertyDescriptor:Ife,getOwnPropertyNames:Afe,getOwnPropertySymbols:Lfe,getPrototypeOf:kfe}=Object,vw=globalThis,_R=vw.trustedTypes,Rfe=_R?_R.emptyScript:"",Ofe=vw.reactiveElementPolyfillSupport,Ay=(e,t)=>e,WM={toAttribute(e,t){switch(t){case Boolean:e=e?Rfe:null;break;case Object:case Array:e=e==null?e:JSON.stringify(e)}return e},fromAttribute(e,t){let i=e;switch(t){case Boolean:i=e!==null;break;case Number:i=e===null?null:Number(e);break;case Object:case Array:try{i=JSON.parse(e)}catch{i=null}}return i}},mP=(e,t)=>!Cfe(e,t),vR={attribute:!0,type:String,converter:WM,reflect:!1,useDefault:!1,hasChanged:mP};Symbol.metadata??=Symbol("metadata"),vw.litPropertyMetadata??=new WeakMap;let md=class extends HTMLElement{static addInitializer(t){this._$Ei(),(this.l??=[]).push(t)}static get observedAttributes(){return this.finalize(),this._$Eh&&[...this._$Eh.keys()]}static createProperty(t,i=vR){if(i.state&&(i.attribute=!1),this._$Ei(),this.prototype.hasOwnProperty(t)&&((i=Object.create(i)).wrapped=!0),this.elementProperties.set(t,i),!i.noAccessor){const r=Symbol(),s=this.getPropertyDescriptor(t,r,i);s!==void 0&&Pfe(this.prototype,t,s)}}static getPropertyDescriptor(t,i,r){const{get:s,set:n}=Ife(this.prototype,t)??{get(){return this[i]},set(o){this[i]=o}};return{get:s,set(o){const a=s?.call(this);n?.call(this,o),this.requestUpdate(t,a,r)},configurable:!0,enumerable:!0}}static getPropertyOptions(t){return this.elementProperties.get(t)??vR}static _$Ei(){if(this.hasOwnProperty(Ay("elementProperties")))return;const t=kfe(this);t.finalize(),t.l!==void 0&&(this.l=[...t.l]),this.elementProperties=new Map(t.elementProperties)}static finalize(){if(this.hasOwnProperty(Ay("finalized")))return;if(this.finalized=!0,this._$Ei(),this.hasOwnProperty(Ay("properties"))){const i=this.properties,r=[...Afe(i),...Lfe(i)];for(const s of r)this.createProperty(s,i[s])}const t=this[Symbol.metadata];if(t!==null){const i=litPropertyMetadata.get(t);if(i!==void 0)for(const[r,s]of i)this.elementProperties.set(r,s)}this._$Eh=new Map;for(const[i,r]of this.elementProperties){const s=this._$Eu(i,r);s!==void 0&&this._$Eh.set(s,i)}this.elementStyles=this.finalizeStyles(this.styles)}static finalizeStyles(t){const i=[];if(Array.isArray(t)){const r=new Set(t.flat(1/0).reverse());for(const s of r)i.unshift(gR(s))}else t!==void 0&&i.push(gR(t));return i}static _$Eu(t,i){const r=i.attribute;return r===!1?void 0:typeof r=="string"?r:typeof t=="string"?t.toLowerCase():void 0}constructor(){super(),this._$Ep=void 0,this.isUpdatePending=!1,this.hasUpdated=!1,this._$Em=null,this._$Ev()}_$Ev(){this._$ES=new Promise((t=>this.enableUpdating=t)),this._$AL=new Map,this._$E_(),this.requestUpdate(),this.constructor.l?.forEach((t=>t(this)))}addController(t){(this._$EO??=new Set).add(t),this.renderRoot!==void 0&&this.isConnected&&t.hostConnected?.()}removeController(t){this._$EO?.delete(t)}_$E_(){const t=new Map,i=this.constructor.elementProperties;for(const r of i.keys())this.hasOwnProperty(r)&&(t.set(r,this[r]),delete this[r]);t.size>0&&(this._$Ep=t)}createRenderRoot(){const t=this.shadowRoot??this.attachShadow(this.constructor.shadowRootOptions);return Efe(t,this.constructor.elementStyles),t}connectedCallback(){this.renderRoot??=this.createRenderRoot(),this.enableUpdating(!0),this._$EO?.forEach((t=>t.hostConnected?.()))}enableUpdating(t){}disconnectedCallback(){this._$EO?.forEach((t=>t.hostDisconnected?.()))}attributeChangedCallback(t,i,r){this._$AK(t,r)}_$ET(t,i){const r=this.constructor.elementProperties.get(t),s=this.constructor._$Eu(t,r);if(s!==void 0&&r.reflect===!0){const n=(r.converter?.toAttribute!==void 0?r.converter:WM).toAttribute(i,r.type);this._$Em=t,n==null?this.removeAttribute(s):this.setAttribute(s,n),this._$Em=null}}_$AK(t,i){const r=this.constructor,s=r._$Eh.get(t);if(s!==void 0&&this._$Em!==s){const n=r.getPropertyOptions(s),o=typeof n.converter=="function"?{fromAttribute:n.converter}:n.converter?.fromAttribute!==void 0?n.converter:WM;this._$Em=s;const a=o.fromAttribute(i,n.type);this[s]=a??this._$Ej?.get(s)??a,this._$Em=null}}requestUpdate(t,i,r){if(t!==void 0){const s=this.constructor,n=this[t];if(r??=s.getPropertyOptions(t),!((r.hasChanged??mP)(n,i)||r.useDefault&&r.reflect&&n===this._$Ej?.get(t)&&!this.hasAttribute(s._$Eu(t,r))))return;this.C(t,i,r)}this.isUpdatePending===!1&&(this._$ES=this._$EP())}C(t,i,{useDefault:r,reflect:s,wrapped:n},o){r&&!(this._$Ej??=new Map).has(t)&&(this._$Ej.set(t,o??i??this[t]),n!==!0||o!==void 0)||(this._$AL.has(t)||(this.hasUpdated||r||(i=void 0),this._$AL.set(t,i)),s===!0&&this._$Em!==t&&(this._$Eq??=new Set).add(t))}async _$EP(){this.isUpdatePending=!0;try{await this._$ES}catch(i){Promise.reject(i)}const t=this.scheduleUpdate();return t!=null&&await t,!this.isUpdatePending}scheduleUpdate(){return this.performUpdate()}performUpdate(){if(!this.isUpdatePending)return;if(!this.hasUpdated){if(this.renderRoot??=this.createRenderRoot(),this._$Ep){for(const[s,n]of this._$Ep)this[s]=n;this._$Ep=void 0}const r=this.constructor.elementProperties;if(r.size>0)for(const[s,n]of r){const{wrapped:o}=n,a=this[s];o!==!0||this._$AL.has(s)||a===void 0||this.C(s,void 0,n,a)}}let t=!1;const i=this._$AL;try{t=this.shouldUpdate(i),t?(this.willUpdate(i),this._$EO?.forEach((r=>r.hostUpdate?.())),this.update(i)):this._$EM()}catch(r){throw t=!1,this._$EM(),r}t&&this._$AE(i)}willUpdate(t){}_$AE(t){this._$EO?.forEach((i=>i.hostUpdated?.())),this.hasUpdated||(this.hasUpdated=!0,this.firstUpdated(t)),this.updated(t)}_$EM(){this._$AL=new Map,this.isUpdatePending=!1}get updateComplete(){return this.getUpdateComplete()}getUpdateComplete(){return this._$ES}shouldUpdate(t){return!0}update(t){this._$Eq&&=this._$Eq.forEach((i=>this._$ET(i,this[i]))),this._$EM()}updated(t){}firstUpdated(t){}};md.elementStyles=[],md.shadowRootOptions={mode:"open"},md[Ay("elementProperties")]=new Map,md[Ay("finalized")]=new Map,Ofe?.({ReactiveElement:md}),(vw.reactiveElementVersions??=[]).push("2.1.1");/**
 * @license
 * Copyright 2017 Google LLC
 * SPDX-License-Identifier: BSD-3-Clause
 */const yP=globalThis,eb=yP.trustedTypes,bR=eb?eb.createPolicy("lit-html",{createHTML:e=>e}):void 0,f9="$lit$",Zl=`lit$${Math.random().toFixed(9).slice(2)}$`,m9="?"+Zl,Nfe=`<${m9}>`,ph=document,lg=()=>ph.createComment(""),ug=e=>e===null||typeof e!="object"&&typeof e!="function",gP=Array.isArray,Dfe=e=>gP(e)||typeof e?.[Symbol.iterator]=="function",eS=`[ 	
\f\r]`,Xf=/<(?:(!--|\/[^a-zA-Z])|(\/?[a-zA-Z][^>\s]*)|(\/?$))/g,wR=/-->/g,SR=/>/g,Ru=RegExp(`>|${eS}(?:([^\\s"'>=/]+)(${eS}*=${eS}*(?:[^ 	
\f\r"'\`<>=]|("|')|))|$)`,"g"),xR=/'/g,$R=/"/g,y9=/^(?:script|style|textarea|title)$/i,g9=e=>(t,...i)=>({_$litType$:e,strings:t,values:i}),aLe=g9(1),lLe=g9(2),bu=Symbol.for("lit-noChange"),Xt=Symbol.for("lit-nothing"),MR=new WeakMap,Oc=ph.createTreeWalker(ph,129);function _9(e,t){if(!gP(e)||!e.hasOwnProperty("raw"))throw Error("invalid template strings array");return bR!==void 0?bR.createHTML(t):t}const Ffe=(e,t)=>{const i=e.length-1,r=[];let s,n=t===2?"<svg>":t===3?"<math>":"",o=Xf;for(let a=0;a<i;a++){const l=e[a];let u,c,d=-1,m=0;for(;m<l.length&&(o.lastIndex=m,c=o.exec(l),c!==null);)m=o.lastIndex,o===Xf?c[1]==="!--"?o=wR:c[1]!==void 0?o=SR:c[2]!==void 0?(y9.test(c[2])&&(s=RegExp("</"+c[2],"g")),o=Ru):c[3]!==void 0&&(o=Ru):o===Ru?c[0]===">"?(o=s??Xf,d=-1):c[1]===void 0?d=-2:(d=o.lastIndex-c[2].length,u=c[1],o=c[3]===void 0?Ru:c[3]==='"'?$R:xR):o===$R||o===xR?o=Ru:o===wR||o===SR?o=Xf:(o=Ru,s=void 0);const y=o===Ru&&e[a+1].startsWith("/>")?" ":"";n+=o===Xf?l+Nfe:d>=0?(r.push(u),l.slice(0,d)+f9+l.slice(d)+Zl+y):l+Zl+(d===-2?a:y)}return[_9(e,n+(e[i]||"<?>")+(t===2?"</svg>":t===3?"</math>":"")),r]};let ZM=class v9{constructor({strings:t,_$litType$:i},r){let s;this.parts=[];let n=0,o=0;const a=t.length-1,l=this.parts,[u,c]=Ffe(t,i);if(this.el=v9.createElement(u,r),Oc.currentNode=this.el.content,i===2||i===3){const d=this.el.content.firstChild;d.replaceWith(...d.childNodes)}for(;(s=Oc.nextNode())!==null&&l.length<a;){if(s.nodeType===1){if(s.hasAttributes())for(const d of s.getAttributeNames())if(d.endsWith(f9)){const m=c[o++],y=s.getAttribute(d).split(Zl),g=/([.?@])?(.*)/.exec(m);l.push({type:1,index:n,name:g[2],strings:y,ctor:g[1]==="."?Vfe:g[1]==="?"?Ufe:g[1]==="@"?jfe:ww}),s.removeAttribute(d)}else d.startsWith(Zl)&&(l.push({type:6,index:n}),s.removeAttribute(d));if(y9.test(s.tagName)){const d=s.textContent.split(Zl),m=d.length-1;if(m>0){s.textContent=eb?eb.emptyScript:"";for(let y=0;y<m;y++)s.append(d[y],lg()),Oc.nextNode(),l.push({type:2,index:++n});s.append(d[m],lg())}}}else if(s.nodeType===8)if(s.data===m9)l.push({type:2,index:n});else{let d=-1;for(;(d=s.data.indexOf(Zl,d+1))!==-1;)l.push({type:7,index:n}),d+=Zl.length-1}n++}}static createElement(t,i){const r=ph.createElement("template");return r.innerHTML=t,r}};function Xp(e,t,i=e,r){if(t===bu)return t;let s=r!==void 0?i._$Co?.[r]:i._$Cl;const n=ug(t)?void 0:t._$litDirective$;return s?.constructor!==n&&(s?._$AO?.(!1),n===void 0?s=void 0:(s=new n(e),s._$AT(e,i,r)),r!==void 0?(i._$Co??=[])[r]=s:i._$Cl=s),s!==void 0&&(t=Xp(e,s._$AS(e,t.values),s,r)),t}let zfe=class{constructor(t,i){this._$AV=[],this._$AN=void 0,this._$AD=t,this._$AM=i}get parentNode(){return this._$AM.parentNode}get _$AU(){return this._$AM._$AU}u(t){const{el:{content:i},parts:r}=this._$AD,s=(t?.creationScope??ph).importNode(i,!0);Oc.currentNode=s;let n=Oc.nextNode(),o=0,a=0,l=r[0];for(;l!==void 0;){if(o===l.index){let u;l.type===2?u=new bw(n,n.nextSibling,this,t):l.type===1?u=new l.ctor(n,l.name,l.strings,this,t):l.type===6&&(u=new Gfe(n,this,t)),this._$AV.push(u),l=r[++a]}o!==l?.index&&(n=Oc.nextNode(),o++)}return Oc.currentNode=ph,s}p(t){let i=0;for(const r of this._$AV)r!==void 0&&(r.strings!==void 0?(r._$AI(t,r,i),i+=r.strings.length-2):r._$AI(t[i])),i++}},bw=class b9{get _$AU(){return this._$AM?._$AU??this._$Cv}constructor(t,i,r,s){this.type=2,this._$AH=Xt,this._$AN=void 0,this._$AA=t,this._$AB=i,this._$AM=r,this.options=s,this._$Cv=s?.isConnected??!0}get parentNode(){let t=this._$AA.parentNode;const i=this._$AM;return i!==void 0&&t?.nodeType===11&&(t=i.parentNode),t}get startNode(){return this._$AA}get endNode(){return this._$AB}_$AI(t,i=this){t=Xp(this,t,i),ug(t)?t===Xt||t==null||t===""?(this._$AH!==Xt&&this._$AR(),this._$AH=Xt):t!==this._$AH&&t!==bu&&this._(t):t._$litType$!==void 0?this.$(t):t.nodeType!==void 0?this.T(t):Dfe(t)?this.k(t):this._(t)}O(t){return this._$AA.parentNode.insertBefore(t,this._$AB)}T(t){this._$AH!==t&&(this._$AR(),this._$AH=this.O(t))}_(t){this._$AH!==Xt&&ug(this._$AH)?this._$AA.nextSibling.data=t:this.T(ph.createTextNode(t)),this._$AH=t}$(t){const{values:i,_$litType$:r}=t,s=typeof r=="number"?this._$AC(t):(r.el===void 0&&(r.el=ZM.createElement(_9(r.h,r.h[0]),this.options)),r);if(this._$AH?._$AD===s)this._$AH.p(i);else{const n=new zfe(s,this),o=n.u(this.options);n.p(i),this.T(o),this._$AH=n}}_$AC(t){let i=MR.get(t.strings);return i===void 0&&MR.set(t.strings,i=new ZM(t)),i}k(t){gP(this._$AH)||(this._$AH=[],this._$AR());const i=this._$AH;let r,s=0;for(const n of t)s===i.length?i.push(r=new b9(this.O(lg()),this.O(lg()),this,this.options)):r=i[s],r._$AI(n),s++;s<i.length&&(this._$AR(r&&r._$AB.nextSibling,s),i.length=s)}_$AR(t=this._$AA.nextSibling,i){for(this._$AP?.(!1,!0,i);t!==this._$AB;){const r=t.nextSibling;t.remove(),t=r}}setConnected(t){this._$AM===void 0&&(this._$Cv=t,this._$AP?.(t))}},ww=class{get tagName(){return this.element.tagName}get _$AU(){return this._$AM._$AU}constructor(t,i,r,s,n){this.type=1,this._$AH=Xt,this._$AN=void 0,this.element=t,this.name=i,this._$AM=s,this.options=n,r.length>2||r[0]!==""||r[1]!==""?(this._$AH=Array(r.length-1).fill(new String),this.strings=r):this._$AH=Xt}_$AI(t,i=this,r,s){const n=this.strings;let o=!1;if(n===void 0)t=Xp(this,t,i,0),o=!ug(t)||t!==this._$AH&&t!==bu,o&&(this._$AH=t);else{const a=t;let l,u;for(t=n[0],l=0;l<n.length-1;l++)u=Xp(this,a[r+l],i,l),u===bu&&(u=this._$AH[l]),o||=!ug(u)||u!==this._$AH[l],u===Xt?t=Xt:t!==Xt&&(t+=(u??"")+n[l+1]),this._$AH[l]=u}o&&!s&&this.j(t)}j(t){t===Xt?this.element.removeAttribute(this.name):this.element.setAttribute(this.name,t??"")}},Vfe=class extends ww{constructor(){super(...arguments),this.type=3}j(t){this.element[this.name]=t===Xt?void 0:t}},Ufe=class extends ww{constructor(){super(...arguments),this.type=4}j(t){this.element.toggleAttribute(this.name,!!t&&t!==Xt)}},jfe=class extends ww{constructor(t,i,r,s,n){super(t,i,r,s,n),this.type=5}_$AI(t,i=this){if((t=Xp(this,t,i,0)??Xt)===bu)return;const r=this._$AH,s=t===Xt&&r!==Xt||t.capture!==r.capture||t.once!==r.once||t.passive!==r.passive,n=t!==Xt&&(r===Xt||s);s&&this.element.removeEventListener(this.name,this,r),n&&this.element.addEventListener(this.name,this,t),this._$AH=t}handleEvent(t){typeof this._$AH=="function"?this._$AH.call(this.options?.host??this.element,t):this._$AH.handleEvent(t)}},Gfe=class{constructor(t,i,r){this.element=t,this.type=6,this._$AN=void 0,this._$AM=i,this.options=r}get _$AU(){return this._$AM._$AU}_$AI(t){Xp(this,t)}};const mLe={I:bw},Bfe=yP.litHtmlPolyfillSupport;Bfe?.(ZM,bw),(yP.litHtmlVersions??=[]).push("3.3.1");const qfe=(e,t,i)=>{const r=i?.renderBefore??t;let s=r._$litPart$;if(s===void 0){const n=i?.renderBefore??null;r._$litPart$=s=new bw(t.insertBefore(lg(),n),n,void 0,i??{})}return s._$AI(e),s};/**
 * @license
 * Copyright 2017 Google LLC
 * SPDX-License-Identifier: BSD-3-Clause
 */const _P=globalThis;let Zc=class extends md{constructor(){super(...arguments),this.renderOptions={host:this},this._$Do=void 0}createRenderRoot(){const t=super.createRenderRoot();return this.renderOptions.renderBefore??=t.firstChild,t}update(t){const i=this.render();this.hasUpdated||(this.renderOptions.isConnected=this.isConnected),super.update(t),this._$Do=qfe(i,this.renderRoot,this.renderOptions)}connectedCallback(){super.connectedCallback(),this._$Do?.setConnected(!0)}disconnectedCallback(){super.disconnectedCallback(),this._$Do?.setConnected(!1)}render(){return bu}};Zc._$litElement$=!0,Zc.finalized=!0,_P.litElementHydrateSupport?.({LitElement:Zc});const Hfe=_P.litElementPolyfillSupport;Hfe?.({LitElement:Zc});(_P.litElementVersions??=[]).push("4.2.1");const vP=Symbol.for("controller"),Wfe=e=>typeof e=="object"&&e!==null&&(vP in e||"hostConnected"in e||"hostDisconnected"in e||"hostUpdate"in e||"hostUpdated"in e),gLe=e=>typeof e?.then=="function";let Zm;const Ym=e=>{Zm!==e&&(Zm=e,queueMicrotask(()=>Zm===e?Zm=void 0:0))},Sw=e=>Zm;let rc=[];const Zfe=e=>{if(e===void 0){rc=[];return}const t=rc.indexOf(e);rc=t===-1?[...rc,e]:rc.slice(0,t+1),queueMicrotask(()=>rc=[])},Yfe=()=>rc;let Fd;const _Le=e=>{Fd!==e&&(Fd=e,queueMicrotask(()=>Fd===e?Fd=void 0:0))},Jfe=()=>{const e=Fd;return Fd=void 0,e},Xfe=async(e,t)=>{const i=bP(e);if(i===void 0)return e;if(await i.ready,typeof t=="function"){const r=i.watchExports(s=>t(s,r))}return i.exports},Kfe=async e=>{const t=bP(e);return await t.ready,t},bP=e=>{const i=Sw().manager.X(e);if(i!==void 0)return i;if(Wfe(e))return e;const r=Jfe();if(r!==void 0)return r};let YM=!1;const vLe=e=>{YM=!0;try{return e()}finally{YM=!1}},Qfe=(e,t,i)=>{const r=Object.keys(e),s=r.length;zd===void 0&&queueMicrotask(wP),zd??=new Map;let n=zd.get(e);return n===void 0&&(n={callbacks:[],keyCount:s},zd.set(e,n)),n.keyCount!==s&&(n.callbacks.forEach(o=>o(r)),n.callbacks=[],n.keyCount=s),n.callbacks.push(o=>{const a=u=>Rt(t,null,u),l=o[s];l===void 0?a(void 0):e[l]===i?a(l):a(void 0)}),i};let zd;const wP=()=>{zd?.forEach(({callbacks:e},t)=>{const i=Object.keys(t);e.forEach(r=>r(i))}),zd=void 0},eme=(e,t,i)=>{const r=e.manager;return r.V!==Xt&&r.V!==i&&r.S(void 0,void 0),r.T.length===0&&queueMicrotask(()=>r.S(void 0,void 0)),r.V=i,r.T.push((s,n)=>Rt(t,void 0,i===n?s:void 0)),i},tme=(e=[Sw(),...Yfe()],t,i)=>{const r=Array.isArray(e)?e:[e];let s=r.length+1;const n=o=>{s-=1,o!==void 0&&(s=Math.min(s,0)),s===0&&t(o)};r.forEach(o=>Qfe(o,a=>n(a===void 0?void 0:{key:a,host:o,isReactive:!1}),i));for(const o of r)if("manager"in o&&o.manager.component===o){eme(o,a=>n(a===void 0?void 0:{key:a,host:o,isReactive:!0}),i);break}return i},ime=(e="",t={},i=Sw())=>{const r={emit:s=>{e===""&&wP();const n=new CustomEvent(e,{detail:s,cancelable:!0,bubbles:!0,composed:!0,...t});return i.el.dispatchEvent(n),n}};return e===""&&tme(void 0,s=>e=s.key,r),r},bLe=ime.bind(null,"");var w9;w9=vP;class rme{constructor(t){this.#i=[],this.#e=[],this.#r=[],this.#l=[],this.#u=[],this.#c=[],this.#h=[],this.#d=[],this.#o=[],this.#a=!1,this.P=new ag,this.connectedCalled=!1,this.loadedCalled=!1,this[w9]=!0,this.#n=[];const i=this,r=t??Sw();i.#t=r,i.ready=i.P.promise,i.#s=ER(i),i.component=r,i.#t.addController(i),i.#t.manager===void 0||(Zfe(i),queueMicrotask(()=>i.catchUpLifecycle()))}#i;#e;#r;#l;#u;#c;#h;#d;#o;#a;#t;catchUpLifecycle(){const{manager:t}=this.#t;t.connectedCalled&&!this.connectedCalled&&this.triggerConnected(),t.#a&&this.triggerLoad().then(()=>t.loadedCalled&&this.triggerLoaded()).catch(console.error)}#s;get exports(){return this.#s}set exports(t){const i=this.#s;i!==t&&(this.#s=t,this.#n.forEach(Rt),this.connectedCalled&&this.O!==!1&&this.#t.requestUpdate(this.O,i)),this.P.resolve(t)}setProvisionalExports(t,i=!0){this.#s=i?ER(t):t,this.#n.forEach(Rt)}#n;watchExports(t){const i=()=>t(this.#s);return this.#n.push(i),()=>void this.#n.splice(this.#n.indexOf(i),1)}get use(){return Ym(this.#t),Xfe}get useRef(){return Ym(this.#t),Kfe}get useRefSync(){return Ym(this.#t),bP}controllerRemoved(){this.#t.el.isConnected&&this.triggerDisconnected(),this.triggerDestroy()}onConnected(t){this.#i.push(t)}onDisconnected(t){this.#e.push(t)}onLoad(t){this.#r.push(t)}onLoaded(t){this.#l.push(t)}onUpdate(t){this.#u.push(t)}onUpdated(t){this.#c.push(t)}onDestroy(t){this.#h.push(t)}onLifecycle(t){this.#d.push(t),this.connectedCalled&&this.#t.el.isConnected&&this.#p(t)}triggerConnected(){const t=this;t.hostConnected&&Rt(t.hostConnected,t),t.#i.forEach(Rt),t.triggerLifecycle(),t.connectedCalled=!0}triggerDisconnected(){const t=this;t.hostDisconnected&&Rt(t.hostDisconnected,t),t.#e.forEach(Rt),t.#o.forEach(Rt),t.#o=[]}async triggerLoad(){if(this.#a)return;this.#a=!0;const t=this;t.hostLoad&&await HM(t.hostLoad,t),this.#r.length>0&&await Promise.allSettled(this.#r.map(HM)),this.P.resolve(this.#s)}triggerLoaded(){this.loadedCalled||(this.hostLoaded&&Rt(this.hostLoaded,this),this.#l.forEach(Rt),this.loadedCalled=!0)}triggerUpdate(t){this.hostUpdate&&Rt(this.hostUpdate,this,t),this.#u.forEach(TR,t)}triggerUpdated(t){this.hostUpdated&&Rt(this.hostUpdated,this,t),this.#c.forEach(TR,t)}triggerDestroy(){this.hostDestroy&&Rt(this.hostDestroy,this),this.#h.forEach(Rt)}triggerLifecycle(){this.hostLifecycle&&this.#p(()=>this.hostLifecycle()),this.#d.forEach(this.#p,this)}#p(t){Ym(this.#t);const i=Rt(t);(Array.isArray(i)?i:[i]).forEach(s=>{typeof s=="function"?this.#o.push(s):typeof s=="object"&&typeof s.remove=="function"&&this.#o.push(s.remove)})}}function TR(e){Rt(e,void 0,this)}const sme=rme,ER=e=>{if(typeof e!="object"&&typeof e!="function"||e===null)return e;const t={get(r,s,n){if(!((s==="exports"||s==="_exports")&&s in r&&r[s]===i)&&(s in r||s in Promise.prototype||typeof s=="symbol"))return typeof r=="function"?r[s]:Reflect.get(r,s,n)}},i=new Proxy(e,t);return i},nme=1,ome=2,ame=4,lme=8,ume=16,cme=32,hme=64,S9=e=>{let t=e;for(;t=t.parentNode??t.host;)if(t?.constructor?.lumina){const i=t;return i.manager?.loadedCalled||(i.J??i._offspring).push(e),(i.I??i._postLoad).promise}return!1},CR={};function x9(){}const g1=Object.defineProperty,dme=globalThis.HTMLElement??x9;var Or,ka,Ep,bg,JM;const dI=class dI extends dme{constructor(){var s;super();Js(this,bg);Js(this,Or);Js(this,ka);Js(this,Ep);Xs(this,ka,{}),Xs(this,Ep,[]),this.I=new ag,this.H=new ag,this.J=[];const i=this,r=i.constructor;i._offspring=i.J,i._postLoad=i.I,r.C?.forEach(n=>{Object.hasOwn(i,n)&&(et(i,ka)[n]=i[n],delete i[n])}),r.A?Tf(s=i,bg,JM).call(s,{a:r.A}):r.B.then(async n=>{var o;await r.K.p,Tf(o=i,bg,JM).call(o,await(n.default?.then(a=>typeof a=="function"?{a}:a)??n))}).catch(n=>{i.H.reject(n),setTimeout(()=>{throw n})})}static F(){for(const i of this.C??[])g1(this.prototype,i,{configurable:!0,enumerable:!0,get(){return et(this,ka)[i]},set(r){et(this,ka)[i]=r}});for(const i of this.E??[])g1(this.prototype,i,{async value(...r){return et(this,Or)||await this.H.promise,await et(this,Or)[i](...r)},configurable:!0});for(const i of this.D??[])g1(this.prototype,i,{value(...r){return et(this,Or)[i](...r)},configurable:!0})}get manager(){return et(this,Or)?.manager}attributeChangedCallback(i,r,s){et(this,Or)?.attributeChangedCallback(i,r,s),et(this,Or)||et(this,Ep).push(i)}connectedCallback(){et(this,Or)?et(this,Or).connectedCallback?.():queueMicrotask(()=>this.G=S9(this))}disconnectedCallback(){et(this,Or)?.disconnectedCallback?.()}async componentOnReady(){return await this.H.promise,this}addController(){}requestUpdate(){et(this,Or)?.requestUpdate()}};Or=new WeakMap,ka=new WeakMap,Ep=new WeakMap,bg=new WeakSet,JM=function(i){const r=this.constructor,s=r.L,n=et(this,ka),o=Object.values(i).find(m=>m.L===s),a=`${s}--lazy`;let l=o;for(;l&&!Object.hasOwn(l,"lumina");)l=Object.getPrototypeOf(l);fme(l),!r.A&&(r.A=o,customElements.define(a,o)),o.N=this;const c=document.createElement(a);o.N=void 0,Xs(this,Or,c),Xs(this,ka,c),et(this,Ep).forEach(m=>c.attributeChangedCallback(m,null,this.getAttribute(m))),Object.entries(n).forEach(pme,c);const d=this.isConnected;(d||this.G)&&(c.connectedCallback?.(),d||c.disconnectedCallback())},dI.lumina=!0;let PR=dI;function pme([e,t]){this[e]=t}const fme=e=>{const t=e.prototype,i=Element.prototype;Object.hasOwn(t,"isConnected")||(t.setAttribute=function(s,n){i.setAttribute.call(this.el,s,n)},t.removeAttribute=function(s){i.removeAttribute.call(this.el,s)},g1(t,"isConnected",{get(){return Reflect.get(i,"isConnected",this.el)}}))};/**
 * @license
 * Copyright 2017 Google LLC
 * SPDX-License-Identifier: BSD-3-Clause
 */const $9={ATTRIBUTE:1,CHILD:2,PROPERTY:3,BOOLEAN_ATTRIBUTE:4},M9=e=>(...t)=>({_$litDirective$:e,values:t});let T9=class{constructor(t){}get _$AU(){return this._$AM._$AU}_$AT(t,i,r){this._$Ct=t,this._$AM=i,this._$Ci=r}_$AS(t,i){return this.update(t,i)}update(t,i){return this.render(...i)}};/**
 * @license
 * Copyright 2018 Google LLC
 * SPDX-License-Identifier: BSD-3-Clause
 */const mme=M9(class extends T9{constructor(e){if(super(e),e.type!==$9.ATTRIBUTE||e.name!=="class"||e.strings?.length>2)throw Error("`classMap()` can only be used in the `class` attribute and must be the only part in the attribute.")}render(e){return" "+Object.keys(e).filter((t=>e[t])).join(" ")+" "}update(e,[t]){if(this.st===void 0){this.st=new Set,e.strings!==void 0&&(this.nt=new Set(e.strings.join(" ").split(/\s/).filter((r=>r!==""))));for(const r in t)t[r]&&!this.nt?.has(r)&&this.st.add(r);return this.render(t)}const i=e.element.classList;for(const r of this.st)r in t||(i.remove(r),this.st.delete(r));for(const r in t){const s=!!t[r];s===this.st.has(r)||this.nt?.has(r)||(s?(i.add(r),this.st.add(r)):(i.remove(r),this.st.delete(r)))}return bu}});/**
 * @license
 * Copyright 2018 Google LLC
 * SPDX-License-Identifier: BSD-3-Clause
 */const E9="important",yme=" !"+E9,gme=M9(class extends T9{constructor(e){if(super(e),e.type!==$9.ATTRIBUTE||e.name!=="style"||e.strings?.length>2)throw Error("The `styleMap` directive must be used in the `style` attribute and must be the only part in the attribute.")}render(e){return Object.keys(e).reduce(((t,i)=>{const r=e[i];return r==null?t:t+`${i=i.includes("-")?i:i.replace(/(?:^(webkit|moz|ms|o)|)(?=[A-Z])/g,"-$&").toLowerCase()}:${r};`}),"")}update(e,[t]){const{style:i}=e.element;if(this.ft===void 0)return this.ft=new Set(Object.keys(t)),this.render(t);for(const r of this.ft)t[r]==null&&(this.ft.delete(r),r.includes("-")?i.removeProperty(r):i[r]=null);for(const r in t){const s=t[r];if(s!=null){this.ft.add(r);const n=typeof s=="string"&&s.endsWith(yme);r.includes("-")||n?i.setProperty(r,n?s.slice(0,-11):s,n?E9:""):i[r]=s}}return bu}});class _me extends sme{constructor(t){super(t),this.destroyed=!1,this.R=!1,this.V=Xt,this.T=[],this.#r=new WeakMap,this.#e=t,this.exports=void 0,this.hasDestroy=XM in t&&typeof t.destroy=="function",Zc.prototype.addController.call(t,{hostConnected:()=>{if(this.destroyed){const i=t.el.localName;throw t.el.remove(),new Error(`The ${i} component has already been destroyed. It cannot be used again. If you meant to disconnect and reconnect a component without automatic destroy, set the ${XM} prop.`)}this.#i!==void 0&&clearTimeout(this.#i),wP();for(const i of t.M)"triggerConnected"in i?i.triggerConnected():Rt(i.hostConnected,i)},hostDisconnected:()=>{for(const i of t.M)"triggerDisconnected"in i?i.triggerDisconnected():Rt(i.hostDisconnected,i);this.hasDestroy&&!this.destroyed&&this.U()},hostUpdate:()=>{for(const i of t.M)"triggerUpdate"in i?i.triggerUpdate(this.Q):Rt(i.hostUpdate,i,this.Q)},hostUpdated:()=>{for(const i of t.M)"triggerUpdated"in i?i.triggerUpdated(this.Q):Rt(i.hostUpdated,i,this.Q);this.Q=void 0}}),queueMicrotask(()=>this.R=!0),Ym(t)}#i;#e;async destroy(){if(!this.destroyed){this.#e.el.isConnected&&(this.hasDestroy=!1,this.#e.el.remove()),this.#i=void 0,this.destroyed=!0;for(const t of this.#e.M)"triggerDestroy"in t?t.triggerDestroy():Rt(t.hostDestroy,t);this.#e.M.splice(0)}}U(){if(this.#i!==void 0&&clearTimeout(this.#i),!this.#e.el.isConnected&&!this.#e.autoDestroyDisabled){const t=()=>void this.#e.destroy();this.#i=$fe(t,vme)}}S(t,i){const r=this.T;this.V=Xt,this.T=[],r.forEach(s=>s(t,i))}#r;W(t,i){(typeof i=="object"&&i!==null||typeof i=="function")&&this.#r.set(i,t)}X(t){if(typeof t=="object"&&t!==null||typeof t=="function")return this.#r.get(t)}}let vme=1e3;const XM="autoDestroyDisabled";var Fc,wg,Sg,zc,to,sf,C9,P9;const Fy=class Fy extends Zc{constructor(){super();Js(this,sf);Js(this,Fc);Js(this,wg);Js(this,Sg);Js(this,zc);Js(this,to);this.M=[],this.manager=new _me(this);const i=this,r=i.constructor,s=r.N,n=r.K.o,o=Fy.prototype.shouldUpdate;Xs(i,zc,s?.H??new ag),i.I=s?.I??new ag,i.J=s?.J??[],i._offspring=i.J,i._postLoad=i.I,i.el=s??i,Xs(i,Sg,i.enableUpdating),i.enableUpdating=x9,i.shouldUpdate!==o&&(Xs(i,wg,i.shouldUpdate),i.shouldUpdate=o),n&&(Xs(i,Fc,new Map),r.elementProperties.forEach((a,l)=>et(i,Fc).set(l,n())))}static finalizeStyles(i){const r=super.finalizeStyles(i),s=this.shadowRootOptions===CR;return this.K?.commonStyles===void 0||s?r:[this.K.commonStyles,...r]}static createProperty(i,r){const s=typeof r=="number"?r:Array.isArray(r)?r[0]:0,n=Array.isArray(r)?r[1]:void 0,o=n?.hasChanged??mP,a={attribute:s&nme&&typeof i=="string"?Sfe(i):!1,reflect:!!(s&ome),type:s&ame?Boolean:s&lme?Number:void 0,state:!!(s&ume),readOnly:!!(s&cme),noAccessor:!!(s&hme),c:!1,...n,hasChanged(l,u){const c=o(l,u);return a.c=c,c}};super.createProperty(i,a)}static getPropertyDescriptor(i,r,s){const n=this.K,o=super.getPropertyDescriptor(i,r,s);return s.d=o,{...o,get(){return n.t?.(et(this,Fc).get(i)),o.get?.call(this)},set(a){const l=this.manager;if(s.readOnly&&!YM&&(l.R||l.connectedCalled))throw Error(`Cannot assign to read-only property "${i}" of ${this.el.localName}. Trying to assign "${a}"`);o.set.call(this,a??void 0),s.c&&et(this,Fc)?.get(i)?.notify(),l.T.length>0&&l?.S(i,a)}}}connectedCallback(){if(this.el.hasAttribute("defer-hydration"))return;const i=this.constructor.K.c?.(()=>this.requestUpdate());Xs(this,to,i);const r=!this.manager.connectedCalled;super.connectedCallback(),r?queueMicrotask(()=>Tf(this,sf,P9).call(this).catch(s=>{et(this,zc).reject(s),setTimeout(()=>{throw s})})):i&&this.requestUpdate()}disconnectedCallback(){super.disconnectedCallback(),et(this,to)?.destroy(),Xs(this,to,void 0)}createRenderRoot(){const i=this.el.shadowRoot,r=this.constructor,s=r.shadowRootOptions,o=i??(s===CR?this.el:this.el.attachShadow(s));if(i)return Zc.prototype.createRenderRoot.call(this),i;if(this.isConnected){const a=o.getRootNode();a.adoptedStyleSheets=[...a.adoptedStyleSheets,...r.elementStyles.map(l=>"styleSheet"in l?l.styleSheet:l)]}return o}shouldUpdate(i){var r;return this.manager.Q=i,((r=et(this,wg))==null?void 0:r.call(this,i))??!0}update(i){et(this,to)?Tf(this,sf,C9).call(this,i):super.update(i)}listen(i,r,s){const n=r?.bind(this)??r;this.manager.onLifecycle(()=>(this.el.addEventListener(i,n,s),()=>this.el.removeEventListener(i,n,s)))}listenOn(i,r,s,n){const o=s?.bind(this)??s;this.manager.onLifecycle(()=>(i.addEventListener(r,o,n),()=>i.removeEventListener(r,o,n)))}async componentOnReady(){return await et(this,zc).promise,this}addController(i){this.M.push(i),!(vP in i)&&this.renderRoot&&this.el.isConnected&&i.hostConnected?.()}removeController(i){this.M.splice(this.M.indexOf(i),1),i.controllerRemoved?.()}};Fc=new WeakMap,wg=new WeakMap,Sg=new WeakMap,zc=new WeakMap,to=new WeakMap,sf=new WeakSet,C9=function(i){try{et(this,to).clear(),this.constructor.K.r(et(this,to),()=>wI(Fy.prototype,this,"update").call(this,i))}catch(r){throw et(this,to).clear(),r}},P9=async function(){const i=this.el.G??S9(this.el);i&&await i;const r=[];for(const n of this.M)"triggerLoad"in n?r.push(n.triggerLoad()):r.push(HM(n.hostLoad,n));await Promise.all(r),await this.load?.(),this.manager.hasDestroy&&this.manager.onUpdate(n=>n.has(XM)&&this.manager.U()),et(this,Sg).call(this,!0),this.performUpdate(),this.I.resolve(),await Promise.resolve();const s=this.J.filter(n=>!n.manager?.loadedCalled);s.length&&await Promise.allSettled(s.map(async n=>await n.componentOnReady())),this.J.length=0,this.el.setAttribute(this.constructor.K.hydratedAttribute,"");for(const n of this.M)"triggerLoaded"in n?n.triggerLoaded():Rt(n.hostLoaded,n);this.loaded?.(),et(this,zc).resolve()},Fy.lumina=!0;let IR=Fy;const bme=e=>{let t;const i=s=>{t=new URL(s,globalThis.location?.href||void 0).href},r={...e,getAssetPath(s){const n=new URL(s,t);return n.origin!==globalThis.location?.origin?n.href:n.pathname},setAssetPath:i,customElement(s,n){n.K=r,n.L=s,customElements.get(s)||customElements.define(s,n)}};return i(e.defaultAssetPath),r},SLe=e=>typeof e=="object"&&e!=null?mme(e):e,xLe=e=>typeof e=="object"&&e!=null?gme(e):e,$Le=Xt;function MLe(e,t,i){i==null?e.removeAttribute(t):e.setAttribute(t,i)}const TLe={toAttribute:e=>e===!0?"":e===!1?null:e};/*! All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://github.com/Esri/calcite-design-system/blob/dev/LICENSE.md for details.
v3.2.1 */const wme="calcite-mode-auto",Sme="calcite-mode-dark",ELe={rtl:"calcite--rtl"},CLe={filter:250,nextTick:0,resize:150,reposition:100},PLe=25;function AR(){const{classList:e}=document.body,t=window.matchMedia("(prefers-color-scheme: dark)").matches,i=()=>e.contains(Sme)||e.contains(wme)&&t?"dark":"light",r=o=>document.body.dispatchEvent(new CustomEvent("calciteModeChange",{bubbles:!0,detail:{mode:o}})),s=o=>{n!==o&&r(o),n=o};let n=i();r(n),window.matchMedia("(prefers-color-scheme: dark)").addEventListener("change",o=>s(o.matches?"dark":"light")),new MutationObserver(()=>s(i())).observe(document.body,{attributes:!0,attributeFilter:["class"]})}const Ly=globalThis.calciteConfig,ILe=Ly?.focusTrapStack||[],ALe=Ly?.logLevel||"info",LR="3.2.1",xme="2025-05-29",$me="618973fec";function Mme(){if(Ly&&Ly.version)return;console.info(`Using Calcite Components ${LR} [Date: ${xme}, Revision: ${$me}]`);const e=Ly||globalThis.calciteConfig||{};Object.defineProperty(e,"version",{value:LR,writable:!1}),globalThis.calciteConfig=e}function Tme(){document.readyState==="interactive"?AR():document.addEventListener("DOMContentLoaded",()=>AR(),{once:!0}),Mme()}Tme();const Eme=bme({defaultAssetPath:"https://js.arcgis.com/calcite-components/3.2.1/",hydratedAttribute:"calcite-hydrated"}),{customElement:LLe,getAssetPath:kLe,setAssetPath:Cme}=Eme;/*! All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://github.com/Esri/calcite-design-system/blob/dev/LICENSE.md for details.
v3.2.1 */let I9=!1;const Pme=e=>{I9=!0,Cme(e)};let A9;function Ime(){I9||Pme(ks(vt(A9)))}function t0(e){const t=[];for(const i of Object.keys(e))customElements.get(`calcite-${i}`)||t.push(e[i]?.());return t.length>0?Promise.all(t):null}A9="components/assets";const L9=Symbol("widget"),k9=Symbol("widget-test-data"),Ame=[],Lme={},tb=new WeakMap;function R9(e,t){let i=t.children;if(i?.length)for(let s=0;s<i.length;++s)i[s]=R9(e,i[s]);else i=Ame;const r=t.vnodeSelector;if(ib(r)){const s=t.properties||Lme,n=s.key||r,o={key:n,afterCreate:kme,afterUpdate:Rme,afterRemoved:O9,parentWidget:e,widgetConstructor:r,widgetProperties:{...s,key:n,children:i}};return{vnodeSelector:r.vnodeSelector,properties:o,children:void 0,text:void 0,domNode:null}}return t}function kme(e,t,i,{parentWidget:r,widgetConstructor:s,widgetProperties:n}){const o=new s(n);o.container=e,tb.set(e,o),o.afterCreate?.(o,e),r.addHandles(ze((()=>O9(e)))),queueMicrotask((()=>{o[k9].projector.renderNow()}))}function Rme(e,t,i,{widgetProperties:r}){const s=tb.get(e);s&&(s.set(r),s.afterUpdate?.(s,e))}function O9(e){const t=tb.get(e);t&&(t.afterRemoved?.(t,e),t.destroy(),tb.delete(e))}function ib(e){return typeof e=="function"&&e[L9]}const kR=new Set;function Ome(e){kR.add(e),e.finally((()=>kR.delete(e)))}function Nme(e){return ze()}var RR;let Dme=0;function N9(e,t){const i=Object.prototype.hasOwnProperty;for(const r in t)i.call(t,r)&&i.call(e,r)&&(e[r]!=null&&t[r]!=null&&typeof e[r]=="object"&&typeof t[r]=="object"?N9(e[r],t[r]):e[r]=t[r]);return e}const Fme=cfe({postProcessProjectionOptions(e){const t=e.eventHandlerInterceptor,i=/capture$/i;e.eventHandlerInterceptor=(r,s,n,o)=>{const a=t?.(r,s,n,o),l=i.test(r);if(!((r=r.replace(i,"")).toLowerCase()in n)||l){const u=r[2].toLowerCase()+r.slice(3),c=y=>a?.call(n,y);n.addEventListener(u,c,l);const d=()=>n.removeEventListener(u,c,l),m=o.afterRemoved;o.afterRemoved=y=>{m?.(y),d()}}return a}},handleInterceptedEvent(e,t,i,r){const{eventPhase:s,type:n}=r,o=s===Event.CAPTURING_PHASE;let a=`on${n}${o?"capture":""}`;const l=t.properties;(l&&a in l||(a=`on${n[0].toUpperCase()}${n.slice(1)}${o?"Capture":""}`,l&&a in l))&&(u9(),e.scheduleRender(),l[a].call(l.bind||i,r))}});let tS=!1;var th;let xi=(th=class extends Xl.EsriPromiseMixin(Ja.EventedAccessor){constructor(t,i){super(t,i),this._attached=!1,this._projector=Fme,this._readyForTrueRender=!1,this.key=this,this.autoRenderingEnabled=!0,this._loadLocale=yD((async()=>{if(this._messageBundleProps?.length){const l=await Promise.allSettled(this._messageBundleProps.map((async({bundlePath:u,propertyName:c})=>{if(this.destroyed)return;let d=await uC(u);this.uiStrings&&Object.keys(this.uiStrings)&&(d=N9(V(d),this.uiStrings)),this[c]=d})));if(this.destroyed)return;for(const u of l)u.status==="rejected"&&H.getLogger(this).error("widget-intl:locale-error",this.declaredClass,u.reason)}await this.loadLocale()})),this.addHandles(Nme()),Ime();const r="esri-widget-uid-"+Ug(),s=this.render.bind(this);this._trackingTarget=new Nb((()=>{this.autoRenderingEnabled&&this.scheduleRender()}));const n=()=>({vnodeSelector:"div",properties:{key:`${r}-hidden`,class:"",styles:{display:"none"}},domNode:null,children:void 0,text:void 0}),o=()=>{if(!this._readyForTrueRender||this.destroyed)return null;const l=s()??n(),u=l.properties??={};if(u.key??=r,ib(l.vnodeSelector)){if(!this.visible)return n()}else this.visible?u.styles||(u.styles={}):(u.class="",u.styles={display:"none"}),u.styles.display??="";let c=0;return l.children?.forEach((d=>{ib(d.vnodeSelector)||(d.properties??={},d.properties.key??=`${this.id}--${c++}`)})),R9(this,l)};this.render=()=>{if(tS)return o();let l=Kpe(this)??null;if(l)return l;this._trackingTarget.clear(),tS=!0;try{l=qa(this._trackingTarget,o)}catch(u){throw H.getLogger(this).error(u),u}finally{tS=!1}return l&&Qpe(this,l),l};const a=this.beforeFirstRender();a?this._resourcesFetch=a.then((()=>{this._readyForTrueRender=!0,this._postInitialize()})):(this._resourcesFetch=Promise.resolve().then((()=>{this._postInitialize()})),this._readyForTrueRender=!0),this.addResolvingPromise(this._resourcesFetch),Ome(this._resourcesFetch)}normalizeCtorArgs(t,i){const r={...t};return i&&(r.container=i),r}postInitialize(){}beforeFirstRender(){const t=this.loadDependencies();return this._messageBundleProps?.length||t?Promise.all([t,this._loadLocale()]).then((()=>{})).catch(kI):null}loadDependencies(){return null}loadLocale(){return null}destroy(){this.destroyed||(Ot(this._trackingTarget),Ot(this.viewModel),this._detach(this.container),this._set("container",null),this._emitter.clear(),this.render=()=>null,this._projector=null,Y2(this))}set container(t){this._get("container")||this._set("container",t)}castContainer(t){return DC(t)}get domNode(){return this.container}set domNode(t){this.container=t}get icon(){return null}set icon(t){this._overrideIfSome("icon",t)}get id(){return this._get("id")||this.container?.id||Date.now().toString(16)+"-widget-"+Dme++}set id(t){t&&this._set("id",t)}get label(){return this.declaredClass.split(".").pop()}set label(t){this._overrideIfSome("label",t)}get renderable(){return this._resourcesFetch}get visible(){return this._get("visible")}set visible(t){this._set("visible",t)}get[(RR=L9,k9)](){return{projector:this._projector}}render(){throw new Error("not implemented")}scheduleRender(){this.destroyed||(Y2(this),this._projector.scheduleRender())}classes(...t){return Dd.apply(this,t)}renderNow(){Y2(this),this._projector.renderNow()}_postInitialize(){if(this.destroyed)return;this.scheduleRender(),this._delegatedEventNames?.length&&this.addHandles(te((()=>this.viewModel),((i,r)=>{r&&this.removeHandles("delegated-events"),i&&Lb(i)&&this.addHandles(this._delegatedEventNames.map((s=>lf(i,s,(n=>{this.emit(s,n)})))),"delegated-events")}),br)),this.postInitialize();const t=async()=>{await this._loadLocale().catch(kI),this.scheduleRender()};this.addHandles([aC(t),te((()=>this.uiStrings),t)]),this.addHandles(Yr((()=>this.container),(i=>{this.destroyed||this._attach(i)}),{initial:!0,once:!0}))}_attach(t){t&&(this._projector.merge(t,this.render),this._attached=!0)}_detach(t){this._attached&&(this._projector.detach(this.render),this._attached=!1),t?.parentNode?.removeChild(t)}},th[RR]=!0,th.vnodeSelector="div",th);h([f()],xi.prototype,"_readyForTrueRender",void 0),h([f({value:null})],xi.prototype,"container",null),h([Ke("container")],xi.prototype,"castContainer",null),h([f()],xi.prototype,"icon",null),h([f()],xi.prototype,"id",null),h([f()],xi.prototype,"label",null),h([f()],xi.prototype,"renderable",null),h([f()],xi.prototype,"uiStrings",void 0),h([f()],xi.prototype,"viewModel",void 0),h([f({value:!0})],xi.prototype,"visible",null),h([f()],xi.prototype,"key",void 0),h([f()],xi.prototype,"children",void 0),h([f()],xi.prototype,"afterCreate",void 0),h([f()],xi.prototype,"afterUpdate",void 0),h([f()],xi.prototype,"afterRemoved",void 0),xi=h([I("esri.widgets.Widget")],xi);const vi=xi;var OR,NR,DR,FR,zR,VR,UR,jR,GR,BR,qR,HR,WR,ZR,YR;(function(e){e.U8="U8",e.I8="I8",e.U16="U16",e.I16="I16",e.U32="U32",e.I32="I32",e.F32="F32",e.F64="F64",e.Utf8String="Utf8String",e.NotSet="NotSet"})(OR||(OR={})),(function(e){e.Png="Png",e.Jpeg="Jpeg",e.Dds="Dds",e.Raw="Raw",e.Dxt1="Dxt1",e.Dxt5="Dxt5",e.Bc7="Bc7",e.Basis="Basis",e.Etc1="Etc1",e.Etc2="Etc2",e.Astc="Astc",e.Pvrtc="Pvrtc",e.NotSet="NotSet"})(NR||(NR={})),(function(e){e.Position="Position",e.Normal="Normal",e.TexCoord="TexCoord",e.Color="Color",e.Tangent="Tangent",e.FeatureIndex="FeatureIndex",e.UvRegion="UvRegion",e.FeatureVariable="FeatureVariable",e.NotSet="NotSet"})(DR||(DR={})),(function(e){e.Opaque="Opaque",e.Mask="Mask",e.Blend="Blend"})(FR||(FR={})),(function(e){e.None="None",e.Mask="Mask",e.Alpha="Alpha",e.PreMultAlpha="PreMultAlpha",e.NotSet="NotSet"})(zR||(zR={})),(function(e){e.Points="Points",e.Lines="Lines",e.LineStrip="LineStrip",e.Triangles="Triangles",e.TriangleStrip="TriangleStrip",e.NotSet="NotSet"})(VR||(VR={})),(function(e){e.None="None",e.WrapXBit="WrapXBit",e.WrapYBit="WrapYBit",e.WrapXy="WrapXy",e.NotSet="NotSet"})(UR||(UR={})),(function(e){e.Linear="Linear",e.Nearest="Nearest",e.NotSet="NotSet"})(jR||(jR={})),(function(e){e.Linear="Linear",e.Nearest="Nearest",e.NearestMipmapNearest="NearestMipmapNearest",e.LinearMipmapNearest="LinearMipmapNearest",e.NearestMipmapLinear="NearestMipmapLinear",e.LinearMipmapLinear="LinearMipmapLinear",e.NotSet="NotSet"})(GR||(GR={})),(function(e){e.FeatureId="FeatureId",e.GlobalUid="GlobalUid",e.UnspecifiedDateTime="UnspecifiedDateTime",e.EcmaIso8601DateTime="EcmaIso8601DateTime",e.EcmaIso8601DateOnly="EcmaIso8601DateOnly",e.TimeOnly="TimeOnly",e.TimeStamp="TimeStamp",e.ColorRgb="ColorRgb",e.ColorRgba="ColorRgba",e.Unrecognized="Unrecognized",e.NotSet="NotSet"})(BR||(BR={})),(function(e){e.Texture="Texture",e.VertexAtrb="VertexAtrb",e.Implicit="Implicit",e.NotSet="NotSet"})(qR||(qR={})),(function(e){e.Front="Front",e.Back="Back",e.None="None",e.NotSet="NotSet"})(HR||(HR={})),(function(e){e.Pbr="Pbr",e.Unlit="Unlit"})(WR||(WR={})),(function(e){e.Rgb8="Rgb8",e.Rgba8="Rgba8",e.R8="R8",e.Bgr8="Bgr8",e.Bgra8="Bgra8",e.Rg8="Rg8",e.Ga8="Ga8",e.Etc1="Etc1",e.Etc2="Etc2",e.Dxt1="Dxt1",e.Dxt5="Dxt5",e.Bc7="Bc7",e.NotSet="NotSet"})(ZR||(ZR={})),(function(e){e[e.Succeeded=0]="Succeeded",e[e.Failed=1]="Failed",e[e.MissingInputs=2]="MissingInputs"})(YR||(YR={}));const zme=new Map;function Vme(e){return zme.get(e)}function JR(e,t){return e&&"copyright"in e&&(!t||typeof e.originOf=="function"&&e.originOf("copyright")==="user")}function Ume(e,t){return e.length!==t.length||e.some(((i,r)=>i.text!==t[r].text))}function Kf(e,t,i){!i||!t||e.find((r=>r.layerView===t&&r.text===i))||e.push({text:i,layerView:t})}function jme(e){return e.type==="bing-maps"}const Qo=[];let yd=class extends le{constructor(t){super(t),this._clear=()=>{this._fetchedAttributionData.clear(),this._pendingAttributions.clear(),this.removeHandles("suspension"),this.notifyChange("state")},this._pendingAttributions=new Set,this._fetchedAttributionData=new Map,this.items=new ne,this.view=null,this._allLayerViewsChange=i=>{this.removeHandles("suspension"),this.removeHandles("visible-geometry-changed");const r=this.view?.allLayerViews;r&&(this.addHandles(r.map((s=>te((()=>[s.suspended,s.layer?.attributionVisible]),(()=>this._updateAttributionItems())))).toArray(),"suspension"),r.forEach((s=>{s.declaredClass==="esri.views.3d.layers.Tiles3DLayerView3D"&&this.addHandles(s.on("visible-geometry-changed",(()=>this._updateAttributionItems())),"visible-geometry-changed")}))),i?.removed&&i.removed.forEach((s=>{this._pendingAttributions.delete(s),this._fetchedAttributionData.delete(s)})),this._updateAttributionItems()},this.addHandles([In((()=>this.view?.allLayerViews),"change",(i=>this._allLayerViewsChange(i)),{onListenerAdd:()=>this._allLayerViewsChange(),onListenerRemove:this._clear}),Yr((()=>this.view?.stationary===!0),(()=>this._updateAttributionItems()))])}destroy(){this.view=null,this._fetchedAttributionData.clear(),this._pendingAttributions.clear(),this.items.removeAll()}get state(){return this.view?.ready?this._pendingAttributions.size>0?"loading":"ready":"disabled"}_updateAttributionItems(){const t=this.view,i=t?.allLayerViews;if(Qo.length=0,!t||!i)return void this._clear();i.forEach((s=>{if(s.suspended||!s.layer?.attributionVisible)return;const n=s.layer;if(JR(n,"user"))return void Kf(Qo,s,n.copyright);if(n.hasAttributionData){if(this._fetchedAttributionData.has(s)){const a=this._fetchedAttributionData.get(s);return void(a?Kf(Qo,s,this._getDynamicAttribution(a,t,n)):JR(n)&&Kf(Qo,s,n.copyright))}return void this._fetchAttributionData(s)}const o="portalItem"in n?n.portalItem?.accessInformation:void 0;Kf(Qo,s,o||n.copyright)}));const r=i.find((s=>s.layer?.type==="integrated-mesh-3dtiles"));if(this.view&&r){const s=Vme(this.view);if(s){const n=s.getAttributionText();for(let o=0;o<n.length;++o)Kf(Qo,r,n[o])}}Ume(this.items,Qo)&&(this.items.removeAll(),this.items.addMany(Qo)),Qo.length=0,this.notifyChange("state")}async _fetchAttributionData(t){if(this._pendingAttributions.has(t))return;this._pendingAttributions.add(t);const i=await b4(t.layer.fetchAttributionData());if(this._pendingAttributions.has(t)){const r=i.ok?this._createContributionIndex(i.value,jme(t.layer)):null;this._pendingAttributions.delete(t),this._fetchedAttributionData.set(t,r)}this._updateAttributionItems()}_createContributionIndex(t,i){const r=t.contributors,s={};if(!r)return s;for(let n=0;n<r.length;n++){const o=r[n],a=o.coverageAreas;if(!a)return;for(const l of a){const u=l.bbox,c=l.zoomMin-(i&&l.zoomMin?1:0),d=l.zoomMax-(i&&l.zoomMax?1:0),m=new ke({xmin:u[1],ymin:u[0],xmax:u[3],ymax:u[2],spatialReference:ae.WGS84}),y={extent:jc(m),attribution:o.attribution||"",score:l.score!=null?l.score:100,id:n};for(let g=c;g<=d;g++)s[g]??=[],s[g].push(y)}}return s.maxKey=Math.max.apply(null,Object.keys(s)),s}_getDynamicAttribution(t,i,r){const{extent:s,scale:n}=i;let o=r.tileInfo?.scaleToZoom(n)??0;if(o=Math.min(t.maxKey??0,Math.round(o)),!s||o==null||o<=-1)return"";const a=t[o],l=Vb(s.center.clone().normalize(),ae.WebMercator),u=new Set;return a?a.filter((c=>{const d=c.id,m=!u.has(d)&&l&&c.extent&&Ng(c.extent,l);return m&&u.add(d),m})).sort(((c,d)=>d.score-c.score||c.objectId-d.objectId)).map((c=>c.attribution)).join(", "):""}};h([f({readOnly:!0,type:ne})],yd.prototype,"items",void 0),h([f({readOnly:!0})],yd.prototype,"state",null),h([f()],yd.prototype,"view",void 0),yd=h([I("esri.widgets.Attribution.AttributionViewModel")],yd);const D9=yd,Ai={button:"esri-button",buttonDisabled:"esri-button--disabled",buttonHalf:"esri-button--half",buttonSecondary:"esri-button--secondary",buttonSmall:"esri-button--small",buttonTertiary:"esri-button--tertiary",buttonThird:"esri-button--third",disabled:"esri-disabled",empty:"esri-widget__content--empty",heading:"esri-widget__heading",interactive:"esri-interactive",loaderAnimation:"esri-widget__loader-animation",panel:"esri-widget--panel",table:"esri-widget__table",widget:"esri-widget",widgetButton:"esri-widget--button"};function Gme(){return function(e,t){if(!e[t])throw new TypeError(`Cannot auto bind undefined function '${String(t)}'`);return{value:qme(e[t])}}}function Bme(e){const t=e?.type;return e instanceof KeyboardEvent||t==="keyup"||t==="keydown"||t==="keypress"}function qme(e){return function(t,...i){Bme(t)?efe(t.key)&&(t.preventDefault(),t.stopPropagation(),t.target.click()):e.call(this,t,...i)}}function Go(e){return(t,i)=>{t.hasOwnProperty("_messageBundleProps")||(t._messageBundleProps=t._messageBundleProps?t._messageBundleProps.slice():[]),t._messageBundleProps.push({bundlePath:e,propertyName:i})}}var Hme=function(e){return{vnodeSelector:"",properties:void 0,children:void 0,text:e.toString(),domNode:null}},F9=function(e,t){for(var i=0,r=e.length;i<r;i++){var s=e[i];Array.isArray(s)?F9(s,t):s!=null&&s!==!1&&(s.hasOwnProperty("vnodeSelector")||(s=Hme(s)),t.push(s))}},Wme=function(e,t){for(var i=[],r=2;r<arguments.length;r++)i[r-2]=arguments[r];if(i.length===1&&typeof i[0]=="string")return{vnodeSelector:e,properties:t||void 0,children:void 0,text:i[0],domNode:null};var s=[];return F9(i,s),{vnodeSelector:e,properties:t||void 0,children:s,text:void 0,domNode:null}};function L(e,t,...i){return typeof e!="function"||ib(e)?Wme(e,t??null,...i):e(t,...i)}function OLe(...e){return e}const Bh="esri-attribution",qh={base:Bh,poweredBy:`${Bh}__powered-by`,sources:`${Bh}__sources`,open:`${Bh}--open`,sourcesOpen:`${Bh}__sources--open`,link:`${Bh}__link`};let fr=class extends vi{constructor(t,i){super(t,i),this._isOpen=!1,this._attributionTextOverflowed=!1,this._prevSourceNodeHeight=0,this._resizeObserver=new ResizeObserver((r=>r.forEach((({target:s})=>this._checkSourceTextOverflow(s))))),this.itemDelimiter=" | ",this.messages=null,this.viewModel=new D9}initialize(){this.addHandles(In((()=>this.viewModel?.items),"change",(()=>this.scheduleRender())))}destroy(){this._resizeObserver?.disconnect()}get _isInteractive(){return this._isOpen||this._attributionTextOverflowed}get attributionText(){return this.viewModel.items.reduce(((t,i)=>(t.includes(i.text)||t.push(i.text),t)),[]).join(this.itemDelimiter)}get icon(){return"description"}set icon(t){this._overrideIfSome("icon",t)}get label(){return this.messages?.widgetLabel??""}set label(t){this._overrideIfSome("label",t)}get view(){return this.viewModel.view}set view(t){this.viewModel.view=t}render(){const t={[qh.open]:this._isOpen};return L("div",{bind:this,class:this.classes(qh.base,Ai.widget,t),dir:"ltr",onclick:this._toggleState,onkeydown:this._toggleState},this._renderSourcesNode(),this._renderPoweredBy())}_renderPoweredBy(){return L("div",{class:qh.poweredBy},"Powered by"," ",L("a",{class:qh.link,href:"https://www.esri.com/",rel:"noreferrer",target:"_blank"},"Esri"))}_renderSourcesNode(){const t=this._isOpen,i=this._isInteractive,r=i?0:void 0,{attributionText:s}=this,n={[qh.sourcesOpen]:t,[Ai.interactive]:i};return L("div",{afterCreate:this._afterSourcesNodeCreate,bind:this,class:this.classes(qh.sources,n),innerHTML:s,tabIndex:r})}_afterSourcesNodeCreate(t){this._prevSourceNodeHeight=t.clientWidth,this._resizeObserver.observe(t)}_checkSourceTextOverflow(t){let i=!1;const{clientHeight:r,clientWidth:s,scrollWidth:n}=t,o=n>s,a=this._attributionTextOverflowed!==o;if(this._attributionTextOverflowed=o,a&&(i=!0),this._isOpen){const l=r<this._prevSourceNodeHeight;this._prevSourceNodeHeight=r,l&&(this._isOpen=!1,i=!0)}i&&this.scheduleRender()}_toggleState(){this._isInteractive&&(this._isOpen=!this._isOpen)}};h([f()],fr.prototype,"_isOpen",void 0),h([f()],fr.prototype,"_isInteractive",null),h([f()],fr.prototype,"_attributionTextOverflowed",void 0),h([f()],fr.prototype,"_prevSourceNodeHeight",void 0),h([f({readOnly:!0,dependsOn:["viewModel.items.length","itemDelimiter"]})],fr.prototype,"attributionText",null),h([f()],fr.prototype,"icon",null),h([f()],fr.prototype,"itemDelimiter",void 0),h([f()],fr.prototype,"label",null),h([f(),Go("esri/widgets/Attribution/t9n/Attribution")],fr.prototype,"messages",void 0),h([f()],fr.prototype,"view",null),h([f({type:D9})],fr.prototype,"viewModel",void 0),h([Gme()],fr.prototype,"_toggleState",null),fr=h([I("esri.widgets.Attribution")],fr);const Zme=fr;function Yme(){const e=N("mapview-essential-goto-duration");return e==null?e:e}function Jme(e){return e?.spatialReference?.isWebMercator||e?.spatialReference?.isGeographic||!1}function Xme(e,t,i){return e.goTo(t,i)}const Kme=e=>{let t=class extends e{constructor(...i){super(...i),this.goToOverride=null,this.view=null}callGoTo(i){const{view:r}=this;return Tg(r),this.goToOverride?this.goToOverride(r,i):Xme(r,i.target,i.options)}};return h([f()],t.prototype,"goToOverride",void 0),h([f()],t.prototype,"view",void 0),t=h([I("esri.widgets.support.GoTo")],t),t};let sc=class extends Kme(le){constructor(t){super(t),this.orientation={x:0,y:0,z:0},this.view=null,this._updateForCamera=this._updateForCamera.bind(this),this._updateForRotation=this._updateForRotation.bind(this),this._updateRotationWatcher=this._updateRotationWatcher.bind(this)}initialize(){this._watchForView(Pt)}destroy(){this.view=null}get canShowNorth(){return Jme(this.view)}get state(){return!this.view?.ready||this.view.type==="2d"&&!this.view.constraints.rotationEnabled?"disabled":this.canShowNorth?"compass":"rotation"}reset(){this.view?.ready&&(this.view?.type==="2d"?this.callGoTo({target:{rotation:0},options:{animationMode:"always",duration:Yme()}}):this.callGoTo({target:{heading:0}}))}_updateForRotation(t){t!=null&&this._set("orientation",{z:t})}_updateForCamera(t){if(!t)return;const i=-t.heading;this._set("orientation",{x:0,y:0,z:i})}_updateRotationWatcher(t){this.removeAllHandles(),this._watchForView(),t&&this.addHandles(t.type==="2d"?te((()=>t?.rotation),this._updateForRotation,Pt):te((()=>t?.camera),this._updateForCamera,Pt))}_watchForView(t){this.addHandles(te((()=>this.view),this._updateRotationWatcher,t))}};h([f({readOnly:!0})],sc.prototype,"canShowNorth",null),h([f({readOnly:!0})],sc.prototype,"orientation",void 0),h([f({readOnly:!0})],sc.prototype,"state",null),h([f()],sc.prototype,"view",void 0),sc=h([I("esri.widgets.Compass.CompassViewModel")],sc);const z9=sc,XR="esri-compass",KR={base:XR,iconContainer:`${XR}__icon-container`};let ma=class extends vi{constructor(t,i){super(t,i),this.messages=null,this.viewModel=new z9,this._reset=()=>{this.viewModel.reset()},this._toRotationTransform=r=>({transform:`rotateZ(${r.z}deg)`})}loadDependencies(){return t0({button:()=>J(()=>import("./index-vZZaxJvd.js"),__vite__mapDeps([288,289,290,291,292,293,294,295,296,297,298,299,300])),icon:()=>J(()=>import("./index-DRsyYTwk.js").then(t=>t.i),__vite__mapDeps([292,293,294]))})}get goToOverride(){return this.viewModel.goToOverride}set goToOverride(t){this.viewModel.goToOverride=t}get icon(){return this.viewModel.state==="rotation"?"arrow-up":"compass-needle"}set icon(t){this._overrideIfSome("icon",t)}get label(){return this.messages?.widgetLabel??""}set label(t){this._overrideIfSome("label",t)}get view(){return this.viewModel.view}set view(t){this.viewModel.view=t}reset(){return this.viewModel.reset()}render(){const{orientation:t,state:i}=this.viewModel,{messages:r}=this;return L("div",{class:this.classes(KR.base,Ai.widget)},L("calcite-button",{class:Ai.widgetButton,disabled:i==="disabled",kind:"neutral",label:r.reset,onclick:this._reset,round:!0,scale:"s",title:r.reset},L("div",{"aria-hidden":"true",class:KR.iconContainer,title:r.reset},L("calcite-icon",{icon:this.icon,styles:this._toRotationTransform(t)}))))}};h([f()],ma.prototype,"goToOverride",null),h([f()],ma.prototype,"icon",null),h([f()],ma.prototype,"label",null),h([f(),Go("esri/widgets/Compass/t9n/Compass")],ma.prototype,"messages",void 0),h([f()],ma.prototype,"view",null),h([f({type:z9})],ma.prototype,"viewModel",void 0),ma=h([I("esri.widgets.Compass")],ma);const Qme=ma,QR="esri-navigation-toggle",eO={base:QR,isLayoutHorizontal:`${QR}--horizontal`};let gd=class extends le{constructor(t){super(t),this._navigationMode="pan",this.view=null,t?.isDefaultViewModel||HH(H.getLogger(this),"Navigation Toggle","arcgis-navigation-toggle",{version:"4.33"})}normalizeCtorArgs(t={}){const{isDefaultViewModel:i,...r}=t;return r}initialize(){this.addHandles(Yr((()=>this.view?.navigation?.actionMap),(()=>this._updateNavigationActionMap())))}destroy(){this.view=null}get state(){return this.view?.ready&&this.view?.type==="3d"?"ready":"disabled"}get navigationMode(){return this._navigationMode}set navigationMode(t){this._navigationMode=t,this._updateNavigationActionMap()}toggle(){this.state!=="disabled"&&(this.navigationMode=this.navigationMode!=="pan"?"pan":"rotate")}_updateNavigationActionMap(){const t=this.view?.navigation?.actionMap;if(!t)return;const i=this._navigationMode==="pan";t.dragPrimary=i?"pan":"rotate",t.dragSecondary=i?"rotate":"pan"}};h([f({readOnly:!0})],gd.prototype,"state",null),h([f()],gd.prototype,"_navigationMode",void 0),h([f()],gd.prototype,"view",void 0),gd=h([I("esri.widgets.NavigationToggle.NavigationToggleViewModel")],gd);const V9=gd;let ya=class extends vi{constructor(t,i){super(t,i),this.messages=null,this.viewModel=new V9({isDefaultViewModel:!0}),this.toggle=()=>this.viewModel.toggle(),this._panButton=null,this._rotateButton=null,this._toggle=()=>{const r=this.viewModel?.navigationMode==="pan"?this._rotateButton:this._panButton;tfe(r),this.toggle()},t?.isDefaultUI||DE(H.getLogger(this),"Navigation Toggle","arcgis-navigation-toggle",{version:"4.32"})}normalizeCtorArgs(t={}){const{isDefaultUI:i,...r}=t;return r}loadDependencies(){return t0({button:()=>J(()=>import("./index-vZZaxJvd.js"),__vite__mapDeps([288,289,290,291,292,293,294,295,296,297,298,299,300]))})}get icon(){return"move"}set icon(t){this._overrideIfSome("icon",t)}get label(){return this.messages?.widgetLabel??""}set label(t){this._overrideIfSome("label",t)}set layout(t){t!=="horizontal"&&(t="vertical"),this._set("layout",t)}get view(){return this.viewModel.view}set view(t){this.viewModel.view=t}render(){const t=this.viewModel?.state==="disabled",i=this.viewModel?.navigationMode==="pan",r=this.messages.toggle;return L("div",{class:this.classes(eO.base,Ai.widget,{[eO.isLayoutHorizontal]:this.layout==="horizontal"})},L("calcite-button",{afterCreate:s=>{this._panButton=s},appearance:i?"outline-fill":"solid",class:Ai.widgetButton,disabled:t,iconStart:"move",kind:"neutral",label:r,onclick:this._toggle,tabIndex:i?void 0:-1,title:r}),L("calcite-button",{afterCreate:s=>{this._rotateButton=s},appearance:i?"solid":"outline-fill",class:Ai.widgetButton,disabled:t,iconStart:"rotate",kind:"neutral",label:r,onclick:this._toggle,tabIndex:i?-1:void 0,title:r}))}};h([f()],ya.prototype,"icon",null),h([f()],ya.prototype,"label",null),h([f({value:"vertical"})],ya.prototype,"layout",null),h([f(),Go("esri/widgets/NavigationToggle/t9n/NavigationToggle")],ya.prototype,"messages",void 0),h([f()],ya.prototype,"view",null),h([f({type:V9})],ya.prototype,"viewModel",void 0),ya=h([I("esri.widgets.NavigationToggle")],ya);const eye=ya;let nc=class extends le{get canZoomIn(){if(!this.view?.ready)return!1;const i=this.view?.constraints?.effectiveMaxScale;return i===0||this._scale>i}get canZoomOut(){const{view:t}=this;if(!t?.ready)return!1;const r=t.constraints?.effectiveMinScale;return r===0||this._scale<r}get _scale(){const t=this.view?.animation?.target;return(t&&"then"in t?void 0:t?.scale)??this.view?.scale??0}};h([f({readOnly:!0})],nc.prototype,"canZoomIn",null),h([f({readOnly:!0})],nc.prototype,"canZoomOut",null),h([f()],nc.prototype,"view",void 0),h([f()],nc.prototype,"_scale",null),nc=h([I("esri.widgets.Zoom.ZoomConditions2D")],nc);const tye=nc;let _d=class extends le{get canZoomIn(){return!!this.view.ready}get canZoomOut(){return!!this.view.ready}};h([f({readOnly:!0})],_d.prototype,"canZoomIn",null),h([f({readOnly:!0})],_d.prototype,"canZoomOut",null),h([f()],_d.prototype,"view",void 0),_d=h([I("esri.widgets.Zoom.ZoomConditions3D")],_d);const iye=_d;let Cl=class extends le{constructor(t){super(t)}destroy(){this.view=null}get canZoomIn(){return this._zoomConditions!=null&&this._zoomConditions.canZoomIn}get canZoomOut(){return this._zoomConditions!=null&&this._zoomConditions?.canZoomOut}get state(){return this.view?.ready?"ready":"disabled"}set view(t){t?t.type==="2d"?this._zoomConditions=new tye({view:t}):t.type==="3d"&&(this._zoomConditions=new iye({view:t})):this._zoomConditions=null,this._set("view",t)}zoomIn(){const t=this.view;this.canZoomIn&&t&&(t.type==="2d"?t.mapViewNavigation.zoomIn():RI(t.goTo({zoomFactor:2})))}zoomOut(){const t=this.view;this.canZoomOut&&t&&(t.type==="2d"?t.mapViewNavigation.zoomOut():RI(t.goTo({zoomFactor:.5})))}};h([f()],Cl.prototype,"_zoomConditions",void 0),h([f()],Cl.prototype,"canZoomIn",null),h([f()],Cl.prototype,"canZoomOut",null),h([f({readOnly:!0})],Cl.prototype,"state",null),h([f()],Cl.prototype,"view",null),Cl=h([I("esri.widgets.Zoom.ZoomViewModel")],Cl);const U9=Cl,tO={base:"esri-zoom",horizontalLayout:"esri-zoom--horizontal"};let ga=class extends vi{constructor(t,i){super(t,i),this.messages=null,this.viewModel=new U9,this.zoomIn=()=>this.viewModel.zoomIn(),this.zoomOut=()=>this.viewModel.zoomOut()}loadDependencies(){return t0({button:()=>J(()=>import("./index-vZZaxJvd.js"),__vite__mapDeps([288,289,290,291,292,293,294,295,296,297,298,299,300]))})}get icon(){return"magnifying-glass-plus"}set icon(t){this._overrideIfSome("icon",t)}get label(){return this.messages?.widgetLabel??""}set label(t){this._overrideIfSome("label",t)}set layout(t){t!=="horizontal"&&(t="vertical"),this._set("layout",t)}set view(t){this.viewModel.view=t}get view(){return this.viewModel.view}render(){const t={[tO.horizontalLayout]:this.layout==="horizontal"},{canZoomIn:i,canZoomOut:r}=this.viewModel,{zoomIn:s,zoomOut:n}=this.messages;return L("div",{class:this.classes(tO.base,Ai.widget,t)},L("calcite-button",{class:Ai.widgetButton,disabled:!i,iconStart:"plus",kind:"neutral",label:s,onclick:this.zoomIn,title:s}),L("calcite-button",{class:Ai.widgetButton,disabled:!r,iconStart:"minus",kind:"neutral",label:n,onclick:this.zoomOut,title:n}))}};h([f()],ga.prototype,"icon",null),h([f()],ga.prototype,"label",null),h([f({value:"vertical"})],ga.prototype,"layout",null),h([f(),Go("esri/widgets/Zoom/t9n/Zoom")],ga.prototype,"messages",void 0),h([f()],ga.prototype,"view",null),h([f({type:U9})],ga.prototype,"viewModel",void 0),ga=h([I("esri.widgets.Zoom")],ga);const rye=ga;function sye(e){return e?.view!==void 0}let _1=class extends sfe{constructor(t){super(t),this._defaultPositionLookup={attribution:"manual",compass:"top-left","navigation-toggle":"top-left",zoom:"top-left"},this.components=[],this._updateViewAwareWidgets=i=>{this.components.forEach((r=>{const s=this._find(r),n=s?.widget;sye(n)&&(n.view=i)}))},this._componentsWatcher=(i,r)=>{this._removeComponents(r),this._addComponents(i),this._adjustPadding(i)}}initialize(){this.addHandles([te((()=>this.components),this._componentsWatcher,Pt),te((()=>this.view),this._updateViewAwareWidgets,Pt)])}_add(t,i,r,s,n){let o=t;if(typeof t=="string"&&this._defaultPositionLookup[t]){if(this._find(t))return;o=this._createComponent(t)}super._add(o,i,r,s,n)}_removeComponents(t){t.forEach((i=>{const r=this._find(i);r&&(this.remove(r),r.destroy())}))}_adjustPadding(t){if(!t.includes("attribution")&&!this._isOverridden("padding")){const{top:i}=this.padding;this.padding=i}}_addComponents(t){this.constructed&&t.forEach((i=>this.add(this._createComponent(i),this._defaultPositionLookup[i])))}_createComponent(t){const i=this._createWidget(t);return new m1({id:t,node:i})}_createWidget(t){const i=this.view;switch(t){case"attribution":return new Zme({view:i});case"compass":return new Qme({view:i});case"navigation-toggle":return new eye({view:i,isDefaultUI:!0});case"zoom":return new rye({view:i})}}};h([f()],_1.prototype,"components",void 0),_1=h([I("esri.views.ui.DefaultUI")],_1);const j9=_1;let v1=class extends j9{constructor(t){super(t),this.components=["attribution","zoom"]}};h([f()],v1.prototype,"components",void 0),v1=h([I("esri.views.ui.2d.DefaultUI2D")],v1);const G9=v1;let B9=class KM{constructor(t,i,r=""){this.major=t,this.minor=i,this._context=r}lessThan(t,i){return this.major<t||t===this.major&&this.minor<i}greaterEqual(t,i){return!this.lessThan(t,i)}validate(t){if(this.major!==t.major){const i=this._context&&this._context+":",r=this._context&&this._context+" ";throw new j(i+"unsupported-version",`Required major ${r}version is '${this.major}', but got '\${version.major}.\${version.minor}'`,{version:t})}}clone(){return new KM(this.major,this.minor,this._context)}static parse(t,i=""){const[r,s]=t.split("."),n=/^\s*\d+\s*$/;if(!r?.match||!n.test(r))throw new j((i&&i+":")+"invalid-version","Expected major version to be a number, but got '${version}'",{version:t});if(!s?.match||!n.test(s))throw new j((i&&i+":")+"invalid-version","Expected minor version to be a number, but got '${version}'",{version:t});const o=parseInt(r,10),a=parseInt(s,10);return new KM(o,a,i)}},nye=class extends B9{constructor(t,i){super(t,i,"webmap")}};function iS(e){return e!=null&&typeof e=="object"&&"declaredClass"in e&&e.declaredClass==="esri.WebMap"}new nye(2,34);var QM;let b1=QM=class extends ee{constructor(e){super(e),this.color=new X([0,0,0,1])}clone(){return new QM(V({color:this.color}))}};h([f({type:X,json:{write:!0}})],b1.prototype,"color",void 0),b1=QM=h([I("esri.webmap.background.ColorBackground")],b1);const oye=b1;let q9,H9,W9,Z9,Y9,J9,X9;async function aye(){const[,{GraphicsView2D:e,GraphicContainer:t,LabelManager:i,MapViewNavigation:r,MagnifierView2D:s,GridView2D:n,Stage:o}]=await Promise.all([J(()=>import("./webglDeps-Bz7Uqddf.js"),__vite__mapDeps([212,213,214,215])),J(()=>import("./mapViewDeps-B_xX9WE2.js"),__vite__mapDeps([216,217,93,218,214,213,156,134,88,219,90,59,220,87,109,221,141,140,96,34,30,35,91,97,222,94,95,139,212,215,223,104,224,225,226,153,150,132,75,86,89,32,27,38,227,228,92,229,99,230,101,64,84,231,232,233,234,149,235]))]);H9=e,W9=t,Z9=i,Y9=r,J9=s,X9=n,q9=o}var Cp;let Ne=(Cp=class extends Nhe(fce(nre(Cse(mse(Zae))))){constructor(t){super(t),this._magnifierView=null,this._gridView=null,this.stage=null,this._resolveWhenReady=[],this.rootLayerViews=new ro({getCollections:()=>[this.basemapView?.baseLayerViews,this.layerViews,this.basemapView?.referenceLayerViews],getChildrenFunction:()=>null}),this.featuresTilingScheme=null,this.graphicsView=null,this.labelManager=null,this.navigation=new hw({actionMap:new QC({dragTertiary:"none"})}),this.renderingOptions={samplingMode:"dynamic",edgeLabelsVisible:!0,labelsAnimationTime:125,labelCollisionsEnabled:!0},this.supersampleScreenshotsEnabled=!0,this.supportsGround=!1,this.floors=new ne,this.grid=null,this.map=null,this.spatialReferenceLocked=!1,this.timeline=new s9,this.type="2d",this.view2dType=null,this.ui=new G9,this.test={takeScreenshot:async i=>Lpe(this._getScreenshotView(i),i)},this.padding={top:0,right:0,bottom:0,left:0},ire()}destroy(){this.layerViewManager.clear(),this._set("preconditionsReady",!1),this.frameTask=Ot(this.frameTask),this.goToManager.destroy(),this.rootLayerViews.destroy(),this.inputManager.destroy(),this._set("inputManager",null)}get graphicsTileStore(){return new kde(this.featuresTilingScheme)}get constraintsInfo(){const t=this.defaultsFromMap?.tileInfo,i=this.spatialReference;return{lods:t?.spatialReference?.equals(i)?t.lods:null,spatialReference:i}}get initialExtentRequired(){if(!this.stateManager)return!1;const{scale:t,constraints:i,center:r,viewpoint:s,extent:n}=this;let o=this.zoom;return!(this.map&&"initialViewProperties"in this.map&&this.map.initialViewProperties?.viewpoint)&&!n&&(i?.effectiveLODs||(o=-1),(!r||t===0&&o===-1)&&(s?.targetGeometry==null||s.targetGeometry.type!=="extent"&&!s.scale))}get defaultsFromMapSettings(){return{required:{extent:!1,heightModelInfo:!1,tileInfo:!0},requiresExtentInSpatialReference:this.spatialReferenceLocked}}get scheduler(){return this.frameTask.scheduler}get typeSpecificPreconditionsReady(){const t=this._getDefaultViewpoint();if(!t)return!1;const i=t.targetGeometry,r=this.spatialReference;return nz(i.spatialReference,r)}get background(){return iS(this.map)?this.map.initialViewProperties.background:null}set background(t){this._override("background",t)}get center(){return this.stateManager?.center??null}set center(t){this.stateManager.center=t}get highlightOptions(){return mpe(this)}set highlightOptions(t){ype(this,t)}get padding(){return this.stateManager?.padding}set padding(t){this.stateManager&&(this.stateManager.padding=t)}get rendering(){return this.stage?.renderRequested??!1}get resolution(){return this.stateManager.resolution??0}get scale(){return this.stateManager?.scale??0}set scale(t){this.stateManager&&(this.stateManager.scale=t)}get tileInfo(){return this.featuresTilingScheme?.tileInfo}get updating(){const t=!(!this.magnifier.visible||this.magnifier.position===null||!this._magnifierView?.updatingHandles.updating),i=!this.destroyed&&(!this.layerViewManager||!this.labelManager||!this.graphicsView||this.layerViewManager.updating===!0||this.labelManager.updating===!0||this.graphicsView.updating===!0||this.allLayerViews.some((r=>!r.destroyed&&!("layerViews"in r)&&r.updating===!0))||t);if(N("esri-2d-log-updating")){const r=this.allLayerViews.reduce(((s,n)=>({...s,[`${n.layer.id}(${n.layer.type})`]:!n.destroyed&&!("layerViews"in n)&&n.updating})),{});console.log(`Updating MapView: ${i}
-> Null LayerViewManager: ${!this.layerViewManager}
-> Null LabelManager: ${!this.labelManager}
-> Null GraphicsView: ${!this.graphicsView}
-> layerViewManager.updating: ${this.layerViewManager?.updating}
-> labelManager.updating: ${this.labelManager?.updating}
-> graphicsView.updating: ${this.graphicsView?.updating}
-> allLayerViews: ${JSON.stringify(r)}
-> updatingMagnifier: ${t}
`)}return i}get visibleArea(){const t=this.stateManager.visibleArea;return t&&new mt({rings:[t.map((i=>[i[0],i[1]]))],spatialReference:this.spatialReference})}get zoom(){return this.stateManager.zoom??-1}set zoom(t){this.stateManager.zoom=t}get navigating(){return this.mapViewNavigation?.interacting??!1}async hitTest(t,i){return gpe(this,t,i)}async takeScreenshot(t){return Ape(this._getScreenshotView(t),t)}toScreen(t,i){return this.stateManager.toScreen(t,i)}whenLayerView(t){return super.whenLayerView(t)}graphicChanged(t){this.graphicsView&&this.graphicsView.graphicUpdateHandler(t)}whenReady(){return new Promise((t=>{this.ready?t(this):this._resolveWhenReady.push(t)}))}forceDOMReadyCycle(){this.forceReadyCycle()}getDefaultSpatialReference(){return this.map&&"initialViewProperties"in this.map&&this.map.initialViewProperties.spatialReference||this.defaultsFromMap?.spatialReference||null}getDefaultTimeZone(){return iS(this.map)?this.map.initialViewProperties.timeZone:null}getDefaultTimeExtent(){return iS(this.map)?this.map.initialViewProperties.timeExtent:null}hasLayerViewModule(t){return Ck.hasLayerViewModule(t)}importLayerView(t){return Ck.importLayerView(t)}pixelSizeAt(){return this.ready?this.resolution:(H.getLogger(this).error("#pixelSizeAt()","Map view cannot be used before it is ready"),null)}async popupHitTest(t){const i=this.toMap(t),r=await this.hitTest(t),s=this.allLayerViews.toArray().filter((u=>u.clips.every((c=>WU(this,c,t,i))))).reverse(),n=new globalThis.Map(s.map((u=>[u.layer.uid,u]))),o=[];let a=0,l=0;for(;a<r.results.length||l<s.length;){const u=r.results.at(a);if(u&&u.type!=="graphic"){++a;continue}const c=n.get((u?.layer??u?.graphic.layer)?.uid);if((!u||c)&&l<s.length&&s.at(l)!==c){const d=s.at(l);"fetchPopupFeaturesAtLocation"in d&&o.push({mapPoint:i,layerView:d}),++l}else u&&(o.push({graphic:u.graphic,layerView:c}),++a)}return{hits:o,location:i}}requestUpdate(){this.ready&&this.frameTask.requestUpdate()}async validate(){let t=Gpe(this.type);if(N("safari")&&N("safari")<9&&(t=new j("mapview:browser-not-supported","This browser is not supported by MapView (Safari < 9)",{type:"safari",requiredVersion:9,detectedVersion:N("safari")})),t!=null){H.getLogger(this).warn("#validate()",t.message);const i=document.createElement("div");i.setAttribute("style","display: flex; flex-direction: column; gap: 8px; padding: 20px; height: 100%; justify-content: center; color: black; background: white; font-family: sans-serif;");const r=document.createElement("div");r.innerHTML="Unable to display map. WebGL2 support is required.",r.setAttribute("style","font-size: 24px; font-weight: bold;");const s=document.createElement("div");s.innerHTML="Ensure that your browser and hardware meet the minimum requirements.",s.setAttribute("style","font-size: 18px;");const n=document.createElement("a");throw n.innerHTML="https://esriurl.com/systemRequirements",n.target="_blank",n.setAttribute("style","font-size: 18px;"),n.href="https://esriurl.com/systemRequirements",i.appendChild(r),i.appendChild(s),i.appendChild(n),this.surface.appendChild(i),t}}loadAsyncDependencies(){return aye()}_getDefaultViewpoint(){const{constraints:t,initialExtent:i,map:r,padding:s,size:n}=this;if(!t)return null;const o=r&&"initialViewProperties"in r?r.initialViewProperties:void 0,a=this.stateManager.getUserStartupOptions(this.size),l=o?.viewpoint,u=l?.targetGeometry?.extent??i,c=u?.center,d=l?.rotation??0,m=l?.scale||u&&fw(u,[n[0]-s.left-s.right,n[1]-s.top-s.bottom]),y=a.center??c,g=a.rotation??d,_=a.scale??m;return y&&_?new Us({targetGeometry:y,scale:_,rotation:g}):null}_startup(){this.timeline.begin("MapView Startup");const t=this._getDefaultViewpoint();this.stateManager.startup(t,this.size,this.spatialReference,this.defaultsFromMap.extent?.center),this.graphics.owner=this;const i=new $de(this.surface),r=new q9(this.surface,{canvas:this.renderCanvas,contextOptions:{disabledExtensions:this.deactivatedWebGLExtensions,debugWebGLExtensions:this.debugWebGLExtensions},renderingOptions:this.renderingOptions,timeline:this.timeline},i);this.stage=r,this._magnifierView=new J9,this._magnifierView.magnifier=this.magnifier,this._gridView=new X9;const s=new Z9({view:this});this._set("labelManager",s);const n=new fde({view:this});this._set("animationManager",n);const o=new Y9({view:this,animationManager:n});this._set("mapViewNavigation",o),this._setupSpatialReferenceDependentProperties(),this.addHandles([this.rootLayerViews.on("change",(()=>this._updateStageChildren())),r.on("webgl-error",(l=>this.fatalError=l.error)),te((()=>this.stationary),(l=>r.stationary=l),br),te((()=>this.background),(l=>{r.backgroundColor=l?.color,this._magnifierView.backgroundColor=l?.color}),br),te((()=>this.magnifier),(l=>this._magnifierView.magnifier=l),br),te((()=>this.grid),(l=>this._gridView.grid=l),br),te((()=>this.renderingOptions),(l=>r.renderingOptions=l),br),te((()=>this.highlights.items.map((l=>({name:l.name,options:{fillColor:l.color,haloColor:l.haloColor,fillOpacity:l.fillOpacity,haloOpacity:l.haloOpacity,haloWidth:l.haloWidth,haloBlur:l.haloBlur}})))),(()=>{r.highlightGradient=ppe(r.highlightGradient,this.highlights.items)}),br),te((()=>this.state.id),(()=>r.state=this.state),br)],"map-view"),this._updateStageChildren();const a=this._resolveWhenReady;this._resolveWhenReady=[],a.forEach((l=>l(this))),this.timeline.end("MapView Startup"),this.frameTask.start(),this._set("ready",!0)}_teardown(){this._destroySpatialReferenceDependentProperties(),this.removeHandles("map-view"),this.mapViewNavigation.destroy(),this._set("mapViewNavigation",null),this.animation=null,this.animationManager.destroy(),this._set("animationManager",null),this.layerViewManager.clear(),this.labelManager.destroy(),this._magnifierView.destroy(),this._gridView.destroy(),this.stage.destroy(),this.stage=null,this._set("graphicsView",null),this._magnifierView=null,this._gridView=null,this._set("labelManager",null),this._set("mapViewNavigation",null),this.graphics.owner=null,this.frameTask.stop(),this.stationaryManager.clear(),this._set("ready",!1),this.stateManager.teardown()}_updateStageChildren(){this.stage.removeAllChildren(),this.rootLayerViews.forEach((i=>{this.stage.addChild(i.container)}));const t=this.graphicsView;this.stage.addChild(t.container),this.stage.addChild(this._magnifierView),this.stage.addChild(this._gridView)}_setupSpatialReferenceDependentProperties(){const t=new bde(Ri.create({spatialReference:this.spatialReference,size:512,numLODs:36}));this._set("featuresTilingScheme",t);const i=new H9({view:this,graphics:this.graphics,requestUpdateCallback:()=>this.requestUpdate(),container:new W9(t)});this._set("graphicsView",i)}_destroySpatialReferenceDependentProperties(){const t=this.graphicsView;this._set("graphicsView",null),t.destroy(),this._set("featuresTilingScheme",null)}_getScreenshotView(t){const{allLayerViews:i,padding:r,size:s,stage:n}=this;return{allLayerViews:i,backgroundColor:t?.ignoreBackground?null:this.background?.color,padding:r,size:s,stage:n}}_spatialReferenceChanged(t){if(this.ready){this.frameTask.stop();for(const i of this.allLayerViews)i.processDetach();this._destroySpatialReferenceDependentProperties(),this.stateManager.changeSpatialReference(t),this.stage.state=this.state,this._setupSpatialReferenceDependentProperties();for(const i of this.allLayerViews)i.processAttach();this.frameTask.requestFrame(),this.frameTask.start(),this._updateStageChildren()}}},Cp.type="2d",Cp);h([f({constructOnly:!0})],Ne.prototype,"deactivatedWebGLExtensions",void 0),h([f({constructOnly:!0})],Ne.prototype,"debugWebGLExtensions",void 0),h([f({readOnly:!0})],Ne.prototype,"featuresTilingScheme",void 0),h([f({readOnly:!0})],Ne.prototype,"graphicsTileStore",null),h([f()],Ne.prototype,"graphicsView",void 0),h([f()],Ne.prototype,"constraintsInfo",null),h([f()],Ne.prototype,"initialExtentRequired",null),h([f()],Ne.prototype,"labelManager",void 0),h([f({type:hw,nonNullable:!0})],Ne.prototype,"navigation",void 0),h([f({constructOnly:!0})],Ne.prototype,"renderCanvas",void 0),h([f()],Ne.prototype,"renderingOptions",void 0),h([f({constructOnly:!0})],Ne.prototype,"supersampleScreenshotsEnabled",void 0),h([f({readOnly:!0})],Ne.prototype,"supportsGround",void 0),h([f()],Ne.prototype,"defaultsFromMapSettings",null),h([f({readOnly:!0})],Ne.prototype,"typeSpecificPreconditionsReady",null),h([f({type:oye})],Ne.prototype,"background",null),h([f()],Ne.prototype,"center",null),h([f({type:ne})],Ne.prototype,"floors",void 0),h([f()],Ne.prototype,"grid",void 0),h([f({type:ou})],Ne.prototype,"highlightOptions",null),h([f()],Ne.prototype,"map",void 0),h([f()],Ne.prototype,"padding",null),h([f({readOnly:!0})],Ne.prototype,"rendering",null),h([f({readOnly:!0})],Ne.prototype,"resolution",null),h([f()],Ne.prototype,"scale",null),h([f({constructOnly:!0})],Ne.prototype,"spatialReferenceLocked",void 0),h([f({readOnly:!0})],Ne.prototype,"tileInfo",null),h([f({type:s9,readOnly:!0})],Ne.prototype,"timeline",void 0),h([f({readOnly:!0})],Ne.prototype,"type",void 0),h([f({readOnly:!0})],Ne.prototype,"updating",null),h([f({readOnly:!0})],Ne.prototype,"view2dType",void 0),h([f({readOnly:!0})],Ne.prototype,"visibleArea",null),h([f()],Ne.prototype,"zoom",null),h([f({readOnly:!0})],Ne.prototype,"navigating",null),h([f(),Ke((e=>e instanceof j9?e:cf(G9,e)))],Ne.prototype,"ui",void 0),Ne=h([I("esri.views.View2D")],Ne);const lye=Ne;let w1=class extends lye{constructor(t){super(t),this.view2dType="map"}};h([f({readOnly:!0})],w1.prototype,"view2dType",void 0),w1=h([I("esri.views.MapView")],w1);const YLe=w1;let xs=class extends le{constructor(t){super(t),this._basemapCache={},this._loadingProjectionEngine=!1,this.nextBasemap=G_("hybrid",this._basemapCache),this.view=null}initialize(){te((()=>this.nextBasemap),(t=>{t&&!t.loaded&&t.load().catch((()=>{}))}),Pt)}destroy(){this.view=null,Vz(this._basemapCache),this._basemapCache=null}get _nextBasemapSpatialReferenceTask(){return uie(this.view,this.nextBasemap)}get _viewSpatialReferenceLocked(){const{view:t}=this;return!t||!("spatialReferenceLocked"in t)||t.spatialReferenceLocked}get activeBasemap(){return G_(this.view?.map?.basemap??"topo-vector",this._basemapCache)}castNextBasemap(t){return G_(t,this._basemapCache)}get state(){const{view:t}=this;if(!t?.ready||this._nextBasemapSpatialReferenceTask.updating)return"disabled";const{spatialReference:i}=this._nextBasemapSpatialReferenceTask;return this._viewSpatialReferenceLocked&&i!=null&&!t.spatialReference.equals(i)?"incompatible-next-basemap":this._loadingProjectionEngine?"loading":"ready"}async toggle(){const{activeBasemap:t,nextBasemap:i,state:r,view:s}=this;if(!s||r==="disabled"||r==="incompatible-next-basemap")return;const n=this._viewSpatialReferenceLocked;if(!n){if(await Vg((()=>!this._nextBasemapSpatialReferenceTask.updating)),i!==this.nextBasemap||t!==this.activeBasemap)return;const{spatialReference:o}=this._nextBasemapSpatialReferenceTask;if(o==null||ci(s.spatialReference,o)||Xa()||qs(s.spatialReference,o)||(this._loadingProjectionEngine=!0,await Wa(),this._loadingProjectionEngine=!1),i!==this.nextBasemap||t!==this.activeBasemap)return}s.map.basemap=i,n||this._nextBasemapSpatialReferenceTask.spatialReference==null||ci(s.spatialReference,this._nextBasemapSpatialReferenceTask.spatialReference)||(s.spatialReference=this._nextBasemapSpatialReferenceTask.spatialReference),this.nextBasemap=t}static getThumbnailUrl(t){return zz(t)}};h([f()],xs.prototype,"_loadingProjectionEngine",void 0),h([f({readOnly:!0})],xs.prototype,"_nextBasemapSpatialReferenceTask",null),h([f({readOnly:!0})],xs.prototype,"_viewSpatialReferenceLocked",null),h([f({readOnly:!0})],xs.prototype,"activeBasemap",null),h([f()],xs.prototype,"nextBasemap",void 0),h([Ke("nextBasemap")],xs.prototype,"castNextBasemap",null),h([f({readOnly:!0})],xs.prototype,"state",null),h([f()],xs.prototype,"view",void 0),h([f()],xs.prototype,"toggle",null),xs=h([I("esri.widgets.BasemapToggle.BasemapToggleViewModel")],xs);const K9=xs,Ou="esri-basemap-toggle",Qf="esri-basemap-thumbnail",Vn={base:Ou,secondaryBasemapImage:`${Ou}__image--secondary`,container:`${Qf} ${Ou}__container`,image:`${Qf}__image ${Ou}__image`,imageLoading:`${Ou}__image--loading`,overlay:`${Qf}__overlay ${Ou}__image-overlay`,title:`${Qf}__title ${Ou}__title`,overlayScrim:`${Qf}__overlay-scrim`};function iO(e){const t=zz(e);return t?{backgroundImage:"url("+t+")"}:{backgroundImage:""}}const rO={title:!1};let $s=class extends vi{constructor(t,i){super(t,i),this.messages=null,this.viewModel=new K9,this.visibleElements={...rO},this.toggle=()=>this.viewModel.toggle(),DE(H.getLogger(this),"Basemap Toggle","arcgis-basemap-toggle",{version:"4.32"})}loadDependencies(){return t0({button:()=>J(()=>import("./index-vZZaxJvd.js"),__vite__mapDeps([288,289,290,291,292,293,294,295,296,297,298,299,300])),icon:()=>J(()=>import("./index-DRsyYTwk.js").then(t=>t.i),__vite__mapDeps([292,293,294])),scrim:()=>J(()=>import("./index-BkkOStNF.js"),__vite__mapDeps([301,289,290,291,295,294,293]))})}get activeBasemap(){return this.viewModel.activeBasemap}get icon(){return"layer-basemap"}set icon(t){this._overrideIfSome("icon",t)}get label(){return this.messages?.widgetLabel??""}set label(t){this._overrideIfSome("label",t)}get nextBasemap(){return this.viewModel.nextBasemap}set nextBasemap(t){this.viewModel.nextBasemap=t}get view(){return this.viewModel.view}set view(t){this.viewModel.view=t}castVisibleElements(t){return{...rO,...t}}render(){const t=this.viewModel,i=t.state==="disabled"?null:t.activeBasemap,r=t.state==="disabled"?null:t.nextBasemap,s=t.state==="loading",n=t.state==="incompatible-next-basemap",o=r?.title??"",a=r&&r.loadStatus!=="loaded";let l;const u=this.visibleElements.title&&o,c=n;return(u||c)&&(l=L("div",{class:Vn.overlay,key:"overlay"},u?L("span",{class:Vn.title,title:o},o):null,c?L("calcite-scrim",{class:Vn.overlayScrim,title:this.messages.incompatibleSpatialReference},L("calcite-icon",{icon:"exclamation-mark-triangle"})):null)),L("div",{class:this.classes(Vn.base,Ai.widget)},L("calcite-button",{appearance:"transparent","data-basemap-id":r?r.id:"",disabled:n,kind:"neutral",label:this.label,onclick:()=>{this.toggle()},title:this.label},L("div",{class:this.classes(Vn.container,Vn.secondaryBasemapImage)},L("div",{class:Vn.image,styles:iO(i)})),L("div",{class:Vn.container},L("div",{class:this.classes(Vn.image,a?Vn.imageLoading:null),styles:iO(r)},a||s?L("calcite-scrim",null,L("span",{"aria-hidden":"true",class:Ai.loaderAnimation,role:"presentation"})):null),l)))}};h([f({readOnly:!0})],$s.prototype,"activeBasemap",null),h([f()],$s.prototype,"icon",null),h([f()],$s.prototype,"label",null),h([f(),Go("esri/widgets/BasemapToggle/t9n/BasemapToggle")],$s.prototype,"messages",void 0),h([f()],$s.prototype,"nextBasemap",null),h([f()],$s.prototype,"view",null),h([f({type:K9})],$s.prototype,"viewModel",void 0),h([f()],$s.prototype,"visibleElements",void 0),h([Ke("visibleElements")],$s.prototype,"castVisibleElements",null),$s=h([I("esri.widgets.BasemapToggle")],$s);const KLe=$s;function uye(e){const t="metric";if(e==null)return t;const i=e.map,r=(i&&"portalItem"in i?i.portalItem?.portal:null)??Z.getDefault();switch(r.user?.units??r.units){case t:return t;case"english":return"imperial"}return xY(e.spatialReference)??t}const cye={readOnly:!0,get(){return uye(this.view)}},hr="esri-scale-bar",ht={base:hr,labelContainer:`${hr}__label-container`,rulerLabelContainer:`${hr}__label-container--ruler`,lineLabelContainer:`${hr}__label-container--line`,topLabelContainer:`${hr}__label-container--top`,bottomLabelContainer:`${hr}__label-container--bottom`,label:`${hr}__label`,line:`${hr}__line`,topLine:`${hr}__line--top`,bottomLine:`${hr}__line--bottom`,ruler:`${hr}__ruler`,rulerBlock:`${hr}__ruler-block`,barContainer:`${hr}__bar-container`,rulerBarContainer:`${hr}__bar-container--ruler`,lineBarContainer:`${hr}__bar-container--line`};function Q9(e){if(!e)return null;const t=e.wkid;if(t)return bee[t];const i=e.wkt2??e.wkt;return i?hye(i):null}function hye(e){const t=_ee.exec(e);if(!t||t.length!==2)return null;const i=t[1].split(",");if(!i||i.length<3)return null;const r=parseFloat(i[1]),s=parseFloat(i[2]);return isNaN(r)||isNaN(s)?null:{a:r,f:s===0?0:1/s}}function xw(e){const t=Q9(e);if(dye(t))return t;const i=t.a*(1-t.f);return Object.assign(t,{b:i,eSq:1-(i/t.a)**2,radius:(2*t.a+i)/3,densificationRatio:1e4/((2*t.a+i)/3)})}function dye(e){return e!=null&&"b"in e&&"eSq"in e&&"radius"in e}function W0(e,t,i){const{a:r,eSq:s}=xw(i),n=Math.sqrt(s),o=Math.sin(t[1]*Vr),a=r*t[0]*Vr;let l;return s>0?l=r*((1-s)*(o/(1-s*(o*o))-1/(2*n)*Math.log((1-n*o)/(1+n*o))))*.5:l=r*o,e[0]=a,e[1]=l,e}function i0(e){return vh(e)&&!!Q9(e)}function QLe(e,t="square-meters"){if(e.some((o=>!i0(o.spatialReference))))throw new j("geodesic-areas:invalid-spatial-reference","the input geometries spatial reference is not supported");const i=[];for(let o=0;o<e.length;o++){const a=e[o],l=a.spatialReference,{radius:u,densificationRatio:c}=xw(l),d=u*c;i.push(fye(a,d))}const r=[],s=[0,0],n=[0,0];for(let o=0;o<i.length;o++){const{rings:a,spatialReference:l}=i[o];let u=0;for(let c=0;c<a.length;c++){const d=a[c];W0(s,d[0],l),W0(n,d[d.length-1],l);let m=n[0]*s[1]-s[0]*n[1];for(let y=0;y<d.length-1;y++)W0(s,d[y+1],l),W0(n,d[y],l),m+=n[0]*s[1]-s[0]*n[1];u+=m}u=it(u,"square-meters",t),r.push(u/-2)}return r}function pye(e,t="meters"){if(!e)throw new j("geodesic-lengths:invalid-geometries","the input geometries type is not supported");if(e.some((r=>!i0(r.spatialReference))))throw new j("geodesic-lengths:invalid-spatial-reference","the input geometries spatial reference is not supported");const i=[];for(let r=0;r<e.length;r++){const s=e[r],{spatialReference:n}=s,o=s.type==="polyline"?s.paths:s.rings;let a=0;for(let l=0;l<o.length;l++){const u=o[l];let c=0;for(let d=1;d<u.length;d++){const m=u[d-1][0],y=u[d][0],g=u[d-1][1],_=u[d][1];if(g!==_||m!==y){const v=new e7;t7(v,[m,g],[y,_],n),c+=v.distance}}a+=c}a=it(a,"meters",t),i.push(a)}return i}function fye(e,t){if(e.type!=="polyline"&&e.type!=="polygon")throw new j("geodesic-densify:invalid-geometry","the input geometry is neither polyline nor polygon");const{spatialReference:i}=e;if(!i0(i))throw new j("geodesic-densify:invalid-spatial-reference","the input geometry spatial reference is not supported");const r=e.type==="polyline"?e.paths:e.rings,s=[],n=[0,0],o=new e7;for(const l of r){const u=[];s.push(u),u.push([l[0][0],l[0][1]]);let c,d,m=l[0][0],y=l[0][1];for(let g=0;g<l.length-1;g++){if(c=l[g+1][0],d=l[g+1][1],m===c&&y===d)continue;const _=[m,y];t7(o,[m,y],[c,d],i);const{azimuth:v,distance:b}=o,S=b/t;if(S>1){for(let $=1;$<=S-1;$++)rS(n,_,v,$*t,i),u.push(n.slice());rS(n,_,v,(b+Math.floor(S-1)*t)/2,i),u.push(n.slice())}rS(n,_,v,b,i),u.push(n.slice()),m=n[0],y=n[1]}}const a=cf(ae,i);return e.type==="polyline"?new Yt({paths:s,spatialReference:a}):new mt({rings:s,spatialReference:a})}let e7=class{constructor(t=0,i=void 0,r=void 0){this.distance=t,this.azimuth=i,this.reverseAzimuth=r}};function rS(e,t,i,r,s){const n=t[0],o=t[1],a=n*Vr,l=o*Vr,u=(i??0)*Vr,{a:c,b:d,f:m}=xw(s),y=Math.sin(u),g=Math.cos(u),_=(1-m)*Math.tan(l),v=1/Math.sqrt(1+_*_),b=_*v,S=Math.atan2(_,g),$=v*y,E=$*$,C=1-E,P=C*(c*c-d*d)/(d*d),k=1+P/16384*(4096+P*(P*(320-175*P)-768)),F=P/1024*(256+P*(P*(74-47*P)-128));let D,U,W,Y=r/(d*k),re=2*Math.PI;for(;Math.abs(Y-re)>1e-12;)W=Math.cos(2*S+Y),D=Math.sin(Y),U=Math.cos(Y),re=Y,Y=r/(d*k)+F*D*(W+F/4*(U*(2*W*W-1)-F/6*W*(4*D*D-3)*(4*W*W-3)));const K=b*D-v*U*g,Ce=Math.atan2(b*U+v*D*g,(1-m)*Math.sqrt(E+K*K)),Ve=m/16*C*(4+m*(4-3*C)),Je=Math.atan2(D*y,v*U-b*D*g)-(1-Ve)*m*$*(Y+Ve*D*(W+Ve*U*(2*W*W-1)));return e[0]=(a+Je)/Vr,e[1]=Ce/Vr,e}function t7(e,t,i,r){const s=t[0]*Vr,n=t[1]*Vr,o=i[0]*Vr,a=i[1]*Vr,{a:l,b:u,f:c,radius:d}=xw(r),m=o-s,y=Math.atan((1-c)*Math.tan(n)),g=Math.atan((1-c)*Math.tan(a)),_=Math.sin(y),v=Math.cos(y),b=Math.sin(g),S=Math.cos(g);let $,E,C,P,k,F,D,U,W,Y,re=1e3,K=m;do{if(D=Math.sin(K),U=Math.cos(K),C=Math.sqrt(S*D*(S*D)+(v*b-_*S*U)*(v*b-_*S*U)),C===0)return e.distance=0,e.azimuth=void 0,e.reverseAzimuth=void 0,e;k=_*b+v*S*U,F=Math.atan2(C,k),W=v*S*D/C,E=1-W*W,P=k-2*_*b/E,isNaN(P)&&(P=0),Y=c/16*E*(4+c*(4-3*E)),$=K,K=m+(1-Y)*c*W*(F+Y*C*(P+Y*k*(2*P*P-1)))}while(Math.abs(K-$)>1e-12&&--re>0);if(re===0){const Dn=d,Cr=Math.acos(Math.sin(n)*Math.sin(a)+Math.cos(n)*Math.cos(a)*Math.cos(o-s))*Dn,Fn=o-s,Ho=Math.sin(Fn)*Math.cos(a),Ph=Math.cos(n)*Math.sin(a)-Math.sin(n)*Math.cos(a)*Math.cos(Fn),Wo=Math.atan2(Ho,Ph);return e.azimuth=Wo/Vr,e.distance=Cr,e.reverseAzimuth=void 0,e}const Ce=E*(l*l-u*u)/(u*u),Ve=Ce/1024*(256+Ce*(Ce*(74-47*Ce)-128)),Je=u*(1+Ce/16384*(4096+Ce*(Ce*(320-175*Ce)-768)))*(F-Ve*C*(P+Ve/4*(k*(2*P*P-1)-Ve/6*P*(4*C*C-3)*(4*P*P-3)))),Oe=Math.atan2(S*Math.sin(K),v*b-_*S*Math.cos(K)),Lt=Math.atan2(v*Math.sin(K),v*b*Math.cos(K)-_*S);return e.azimuth=Oe/Vr,e.distance=Je,e.reverseAzimuth=Lt/Vr,e}function tke(e){return i0(e)?e:Rn(e)?ae.WGS84:null}function mye(e){return e!=null&&typeof e=="object"&&e.type==="2d"&&e.view2dType==="linkchart"}function yye(e){return e>.5?{min:.5,max:1}:e>.2?{min:.2,max:.5}:{min:.1,max:.2}}function gye(e,t){switch(t){case"metric":return e>1e3?{distance:it(e,"meters","kilometers"),unit:"kilometer"}:e>1?{distance:e,unit:"meter"}:e>.01?{distance:it(e,"meters","centimeters"),unit:"centimeter"}:{distance:it(e,"meters","millimeters"),unit:"millimeter"};case"imperial":return e>1609.344?{distance:it(e,"meters","miles"),unit:"mile"}:e>.3048?{distance:it(e,"meters","feet"),unit:"foot"}:{distance:it(e,"meters","inches"),unit:"inch"}}}function _ye(e){const{isWebMercator:t,wkt:i,wkt2:r}=e;return t||((r||i)?.includes("WGS_1984_Web_Mercator")??!1)}function sO({state:{paddedViewState:e},spatialReference:t,width:i}){return t.isWrappable&&e.worldScreenWidth<i}function nO(e,t){const{x:i,y:r}=e?Td(t,!0):t;return[i,r]}let vd=class extends le{constructor(t){super(t),this.scaleComputedFrom=ei(),this.view=null}get state(){return this.view?.ready&&this.view.type==="2d"?mye(this.view)&&!this.view.inGeographicLayout?"disabled":"ready":"disabled"}getScaleBarProperties(t,i){if(this.state==="disabled"||isNaN(t)||!i||!this.view)return null;const r=this._getDistanceInMeters();return r==null?null:this._getScaleBarProps(t,r,i)}_getDistanceInMeters(){const{state:t,spatialReference:i}=this.view;if(!jr(i))return null;const{isGeographic:r}=i,s=_ye(i);if(!r&&!s)return t.extent.width*(F4(i)??1);const[n,o]=this._getScaleMeasuringPoints(),a=s||r&&!i0(i)?ae.WGS84:i,l=new Yt({paths:[[nO(s,n),nO(s,o)]],spatialReference:a}),u=GV(l,10);let c;try{[c]=pye([u],"meters")}catch{return null}return c}_getScaleMeasuringPoints(){const t=this.view,{width:i,height:r,position:s,spatialReference:n}=t;if(sO(t)){const u=ar(n),{valid:c}=u;return[new he(c[0],0,n),new he(c[1],0,n)]}let o=this.scaleComputedFrom.y-s[1];o>r?o=r:o<0&&(o=0);const a=ei(0,o),l=ei(i,o);return[t.toMap(a),t.toMap(l)]}_getScaleBarProps(t,i,r){const s=this.view,n=t*i/(sO(s)?s.state.paddedViewState.worldScreenWidth:s.width);if(n<.001)return null;const o=gye(n,r),{distance:a,unit:l}=o;let u=a,c=0;for(;u>=1;)u/=10,c++;const{min:d,max:m}=yye(u),y=m/u>=u/d?d:m;return{length:t*(y/u),value:10**c*y,unit:l}}};h([f()],vd.prototype,"scaleComputedFrom",void 0),h([f({readOnly:!0})],vd.prototype,"state",null),h([f()],vd.prototype,"view",void 0),vd=h([I("esri.widgets.ScaleBar.ScaleBarViewModel")],vd);const vye=vd;function oO(e,t){return mu(e,{style:"unit",unit:t,unitDisplay:"short"})}let hn=class extends vi{constructor(t,i){super(t,i),this.messages=null,this.style="line",this.viewModel=new vye,DE(H.getLogger(this),"Scale Bar","arcgis-scale-bar",{version:"4.32"})}initialize(){this.addHandles(te((()=>{const{view:t}=this;return[t?.stationary,t?.center,t?.scale,t?.zoom]}),(([t])=>{t&&this.scheduleRender()})))}get icon(){return"actual-size"}set icon(t){this._overrideIfSome("icon",t)}get label(){return this.messages?.widgetLabel??""}set label(t){this._overrideIfSome("label",t)}get unit(){return this._defaultUnit}set unit(t){this._overrideIfSome("unit",t)}get view(){return this.viewModel.view}set view(t){this.viewModel.view=t}render(){const t=this.viewModel.state==="disabled",i={[Ai.disabled]:t};let r,s;if(!t){const{unit:n,style:o}=this,a=n==="metric"||n==="dual",l=100,u=n==="dual"?"line":o;if(n==="imperial"||n==="dual"){const c=this.viewModel.getScaleBarProperties(l,"imperial");c&&(s=u==="ruler"?this._renderRuler(c):this._renderLine(c,"bottom"))}if(a){const c=this.viewModel.getScaleBarProperties(l,"metric");c&&(r=u==="ruler"?this._renderRuler(c):this._renderLine(c,"top"))}}return L("div",{afterCreate:this._handleRootCreateOrUpdate,afterUpdate:this._handleRootCreateOrUpdate,bind:this,class:this.classes(ht.base,Ai.widget,i)},r,s)}_renderRuler(t){const{length:i,unit:r,value:s}=t,n=Math.round(i),o=oO(s,r);return L("div",{class:this.classes(ht.barContainer,ht.rulerBarContainer),key:ht.rulerBarContainer},L("div",{class:ht.ruler,styles:{width:`${n}px`}},L("div",{class:ht.rulerBlock}),L("div",{class:ht.rulerBlock}),L("div",{class:ht.rulerBlock}),L("div",{class:ht.rulerBlock})),L("div",{class:this.classes(ht.labelContainer,ht.rulerLabelContainer)},L("div",{class:ht.label},"0"),L("div",{class:ht.label},o)))}_renderLine(t,i){const{length:r,unit:s,value:n}=t,o=Math.round(r),a=oO(n,s),l={[ht.topLabelContainer]:i==="top",[ht.bottomLabelContainer]:i==="bottom"},u=L("div",{class:this.classes(ht.labelContainer,ht.lineLabelContainer,l),key:ht.labelContainer},L("div",{class:ht.label},a)),c={[ht.topLine]:i==="top",[ht.bottomLine]:i==="bottom"},d=L("div",{class:this.classes(ht.line,c),key:ht.line,styles:{width:`${o}px`}});return L("div",{class:this.classes(ht.barContainer,ht.lineBarContainer),key:ht.lineBarContainer},[d,u])}_handleRootCreateOrUpdate(t){if(!this.viewModel)return;const{scaleComputedFrom:i}=this.viewModel,r=t.getBoundingClientRect(),s=r.left+window.pageXOffset,n=r.top+window.pageYOffset,o=ei(s,n);(o.x!==i.x||o.y!==i.y)&&(this.viewModel.scaleComputedFrom=o)}};h([f(cye)],hn.prototype,"_defaultUnit",void 0),h([f()],hn.prototype,"icon",null),h([f()],hn.prototype,"label",null),h([f(),Go("esri/widgets/ScaleBar/t9n/ScaleBar")],hn.prototype,"messages",void 0),h([f({type:["ruler","line"]})],hn.prototype,"style",void 0),h([f({type:["metric","imperial","dual"]})],hn.prototype,"unit",null),h([f()],hn.prototype,"view",null),h([f()],hn.prototype,"viewModel",void 0),hn=h([I("esri.widgets.ScaleBar")],hn);const ske=hn;function aO(e,t){const i=e.featureReduction;return i&&i.type!=="selection"&&(!("maxScale"in i)||!i.maxScale||i.maxScale<t.scale)?i:null}let lO=class extends SyntaxError{constructor(t,i,r,s){super(t),this.expected=i,this.found=r,this.location=s,this.name="SyntaxError"}format(t){let i="Error: "+this.message;if(this.location){let r=null;const s=t.find((l=>l.source===this.location.source));s&&(r=s.text.split(/\r\n|\n|\r/g));const n=this.location.start,o=this.location.source&&typeof this.location.source.offset=="function"?this.location.source.offset(n):n,a=this.location.source+":"+o.line+":"+o.column;if(r){const l=this.location.end,u="".padEnd(o.line.toString().length," "),c=r[n.line-1],d=(n.line===l.line?l.column:c.length+1)-n.column||1;i+=`
 --> `+a+`
`+u+` |
`+o.line+" | "+c+`
`+u+" | "+"".padEnd(n.column-1," ")+"".padEnd(d,"^")}else i+=`
 at `+a}return i}static buildMessage(t,i){function r(m){return m.codePointAt(0).toString(16).toUpperCase()}const s=Object.prototype.hasOwnProperty.call(RegExp.prototype,"unicode")?new RegExp("[\\p{C}\\p{Mn}\\p{Mc}]","gu"):null;function n(m){return s?m.replace(s,(y=>"\\u{"+r(y)+"}")):m}function o(m){return n(m.replace(/\\/g,"\\\\").replace(/"/g,'\\"').replace(/\0/g,"\\0").replace(/\t/g,"\\t").replace(/\n/g,"\\n").replace(/\r/g,"\\r").replace(/[\x00-\x0F]/g,(y=>"\\x0"+r(y))).replace(/[\x10-\x1F\x7F-\x9F]/g,(y=>"\\x"+r(y))))}function a(m){return n(m.replace(/\\/g,"\\\\").replace(/\]/g,"\\]").replace(/\^/g,"\\^").replace(/-/g,"\\-").replace(/\0/g,"\\0").replace(/\t/g,"\\t").replace(/\n/g,"\\n").replace(/\r/g,"\\r").replace(/[\x00-\x0F]/g,(y=>"\\x0"+r(y))).replace(/[\x10-\x1F\x7F-\x9F]/g,(y=>"\\x"+r(y))))}const l={literal:m=>'"'+o(m.text)+'"',class(m){const y=m.parts.map((g=>Array.isArray(g)?a(g[0])+"-"+a(g[1]):a(g)));return"["+(m.inverted?"^":"")+y.join("")+"]"+(m.unicode?"u":"")},any:()=>"any character",end:()=>"end of input",other:m=>m.description};function u(m){return l[m.type](m)}function c(m){const y=m.map(u);if(y.sort(),y.length>0){let g=1;for(let _=1;_<y.length;_++)y[_-1]!==y[_]&&(y[g]=y[_],g++);y.length=g}switch(y.length){case 1:return y[0];case 2:return y[0]+" or "+y[1];default:return y.slice(0,-1).join(", ")+", or "+y[y.length-1]}}function d(m){return m?'"'+o(m)+'"':"end of input"}return"Expected "+c(t)+" but "+d(i)+" found."}};function bye(e,t){const i={},r=(t=t!==void 0?t:{}).grammarSource,s={start:gI};let n=gI;const o="none",a=")",l=",",u="(",c="%",d="px",m="cm",y="mm",g="in",_="pt",v="pc",b="deg",S="rad",$="grad",E="turn",C="#",P=".",k="e",F=/^[ \t\n\r]/,D=/^[a-z\-]/,U=/^[0-9a-fA-F]/,W=/^[+\-]/,Y=/^[0-9]/,re=tl("none"),K=bi("none",!1),Ce=bi(")",!1),Ve=bi(",",!1),Je=Mf([" ","	",`
`,"\r"],!1,!1,!1),Oe=tl("function"),Lt=bi("(",!1),Dn=tl("identifier"),Cr=Mf([["a","z"],"-"],!1,!1,!1),Fn=tl("percentage"),Ho=bi("%",!1),Ph=tl("length"),Wo=bi("px",!1),Ih=bi("cm",!1),pB=bi("mm",!1),fB=bi("in",!1),mB=bi("pt",!1),yB=bi("pc",!1),gB=tl("angle"),_B=bi("deg",!1),vB=bi("rad",!1),bB=bi("grad",!1),wB=bi("turn",!1),SB=tl("number"),xB=tl("color"),$B=bi("#",!1),pI=Mf([["0","9"],["a","f"],["A","F"]],!1,!1,!1),fI=Mf(["+","-"],!1,!1,!1),el=Mf([["0","9"]],!1,!1,!1),MB=bi(".",!1),TB=bi("e",!1);function EB(){return[]}function CB(A,G){return{type:"function",name:A,parameters:G||[]}}function PB(A,G){return G.length>0?lq(A,G,3):[A]}function IB(A){return{type:"quantity",value:A.value,unit:A.unit}}function AB(A){return{type:"color",colorType:A.type,value:A.value}}function x$e(A){return A}function LB(){return c0()}function kB(A){return{value:A,unit:"%"}}function RB(A){return{value:A,unit:"px"}}function OB(A){return{value:A,unit:"cm"}}function NB(A){return{value:A,unit:"mm"}}function DB(A){return{value:A,unit:"in"}}function FB(A){return{value:A,unit:"pt"}}function zB(A){return{value:A,unit:"pc"}}function VB(A){return{value:A,unit:"deg"}}function UB(A){return{value:A,unit:"rad"}}function jB(A){return{value:A,unit:"grad"}}function GB(A){return{value:A,unit:"turn"}}function BB(A){return{value:A,unit:null}}function qB(){return{type:"hex",value:c0()}}function HB(A){return{type:"function",value:A}}function WB(){return{type:"named",value:c0()}}function ZB(){return parseFloat(c0())}let B=0|t.peg$currPos,$t=B;const Ah=[{line:1,column:1}];let $f,Ys=B,u0=t.peg$maxFailExpected||[],de=0|t.peg$silentFails;if(t.startRule){if(!(t.startRule in s))throw new Error(`Can't start parsing from rule "`+t.startRule+'".');n=s[t.startRule]}function c0(){return e.substring($t,B)}function YB(A=B){const G=e.codePointAt(A);return G===void 0?"":String.fromCodePoint(G)}function bi(A,G){return{type:"literal",text:A,ignoreCase:G}}function Mf(A,G,Q,we){return{type:"class",parts:A,inverted:G,ignoreCase:Q,unicode:we}}function JB(){return{type:"end"}}function tl(A){return{type:"other",description:A}}function mI(A){let G,Q=Ah[A];if(Q)return Q;if(A>=Ah.length)G=Ah.length-1;else for(G=A;!Ah[--G];);for(Q=Ah[G],Q={line:Q.line,column:Q.column};G<A;)e.charCodeAt(G)===10?(Q.line++,Q.column=1):Q.column++,G++;return Ah[A]=Q,Q}function yI(A,G,Q){const we=mI(A),Qe=mI(G);return{source:r,start:{offset:A,line:we.line,column:we.column},end:{offset:G,line:Qe.line,column:Qe.column}}}function Pe(A){B<Ys||(B>Ys&&(Ys=B,u0=[]),u0.push(A))}function XB(A,G,Q){return new lO(lO.buildMessage(A,G),A,G,Q)}function gI(){let A;return A=KB(),A===i&&(A=QB()),A}function KB(){let A,G;return de++,A=B,wi(),e.substr(B,4)===o?(G=o,B+=4):(G=i,de===0&&Pe(K)),G!==i?(wi(),$t=A,A=EB()):(B=A,A=i),de--,A===i&&de===0&&Pe(re),A}function QB(){let A,G;if(A=[],G=Vw(),G!==i)for(;G!==i;)A.push(G),G=Vw();else A=i;return A}function Vw(){let A,G,Q,we;return A=B,wi(),G=tq(),G!==i?(wi(),Q=eq(),Q===i&&(Q=null),wi(),e.charCodeAt(B)===41?(we=a,B++):(we=i,de===0&&Pe(Ce)),we!==i?(wi(),$t=A,A=CB(G,Q)):(B=A,A=i)):(B=A,A=i),A}function eq(){let A,G,Q,we,Qe,Ut,hi,ji;if(A=B,G=Uw(),G!==i){for(Q=[],we=B,Qe=wi(),e.charCodeAt(B)===44?(Ut=l,B++):(Ut=i,de===0&&Pe(Ve)),Ut===i&&(Ut=null),hi=wi(),ji=Uw(),ji!==i?(Qe=[Qe,Ut,hi,ji],we=Qe):(B=we,we=i);we!==i;)Q.push(we),we=B,Qe=wi(),e.charCodeAt(B)===44?(Ut=l,B++):(Ut=i,de===0&&Pe(Ve)),Ut===i&&(Ut=null),hi=wi(),ji=Uw(),ji!==i?(Qe=[Qe,Ut,hi,ji],we=Qe):(B=we,we=i);$t=A,A=PB(G,Q)}else B=A,A=i;return A}function Uw(){let A,G;return A=B,G=iq(),G===i&&(G=rq(),G===i&&(G=sq(),G===i&&(G=nq()))),G!==i&&($t=A,G=IB(G)),A=G,A===i&&(A=B,G=oq(),G!==i&&($t=A,G=AB(G)),A=G),A}function wi(){let A,G;for(de++,A=[],G=e.charAt(B),F.test(G)?B++:(G=i,de===0&&Pe(Je));G!==i;)A.push(G),G=e.charAt(B),F.test(G)?B++:(G=i,de===0&&Pe(Je));return de--,A}function tq(){let A,G,Q;return de++,A=B,G=_I(),G!==i?(e.charCodeAt(B)===40?(Q=u,B++):(Q=i,de===0&&Pe(Lt)),Q!==i?($t=A,A=G):(B=A,A=i)):(B=A,A=i),de--,A===i&&(G=i,de===0&&Pe(Oe)),A}function _I(){let A,G,Q;if(de++,A=B,G=[],Q=e.charAt(B),D.test(Q)?B++:(Q=i,de===0&&Pe(Cr)),Q!==i)for(;Q!==i;)G.push(Q),Q=e.charAt(B),D.test(Q)?B++:(Q=i,de===0&&Pe(Cr));else G=i;return G!==i&&($t=A,G=LB()),A=G,de--,A===i&&(G=i,de===0&&Pe(Dn)),A}function iq(){let A,G,Q;return de++,A=B,wi(),G=ms(),G!==i?(e.charCodeAt(B)===37?(Q=c,B++):(Q=i,de===0&&Pe(Ho)),Q!==i?($t=A,A=kB(G)):(B=A,A=i)):(B=A,A=i),de--,A===i&&de===0&&Pe(Fn),A}function rq(){let A,G,Q;return de++,A=B,wi(),G=ms(),G!==i?(e.substr(B,2)===d?(Q=d,B+=2):(Q=i,de===0&&Pe(Wo)),Q!==i?($t=A,A=RB(G)):(B=A,A=i)):(B=A,A=i),A===i&&(A=B,wi(),G=ms(),G!==i?(e.substr(B,2)===m?(Q=m,B+=2):(Q=i,de===0&&Pe(Ih)),Q!==i?($t=A,A=OB(G)):(B=A,A=i)):(B=A,A=i),A===i&&(A=B,wi(),G=ms(),G!==i?(e.substr(B,2)===y?(Q=y,B+=2):(Q=i,de===0&&Pe(pB)),Q!==i?($t=A,A=NB(G)):(B=A,A=i)):(B=A,A=i),A===i&&(A=B,wi(),G=ms(),G!==i?(e.substr(B,2)===g?(Q=g,B+=2):(Q=i,de===0&&Pe(fB)),Q!==i?($t=A,A=DB(G)):(B=A,A=i)):(B=A,A=i),A===i&&(A=B,wi(),G=ms(),G!==i?(e.substr(B,2)===_?(Q=_,B+=2):(Q=i,de===0&&Pe(mB)),Q!==i?($t=A,A=FB(G)):(B=A,A=i)):(B=A,A=i),A===i&&(A=B,wi(),G=ms(),G!==i?(e.substr(B,2)===v?(Q=v,B+=2):(Q=i,de===0&&Pe(yB)),Q!==i?($t=A,A=zB(G)):(B=A,A=i)):(B=A,A=i)))))),de--,A===i&&de===0&&Pe(Ph),A}function sq(){let A,G,Q;return de++,A=B,G=ms(),G!==i?(e.substr(B,3)===b?(Q=b,B+=3):(Q=i,de===0&&Pe(_B)),Q!==i?($t=A,A=VB(G)):(B=A,A=i)):(B=A,A=i),A===i&&(A=B,G=ms(),G!==i?(e.substr(B,3)===S?(Q=S,B+=3):(Q=i,de===0&&Pe(vB)),Q!==i?($t=A,A=UB(G)):(B=A,A=i)):(B=A,A=i),A===i&&(A=B,G=ms(),G!==i?(e.substr(B,4)===$?(Q=$,B+=4):(Q=i,de===0&&Pe(bB)),Q!==i?($t=A,A=jB(G)):(B=A,A=i)):(B=A,A=i),A===i&&(A=B,G=ms(),G!==i?(e.substr(B,4)===E?(Q=E,B+=4):(Q=i,de===0&&Pe(wB)),Q!==i?($t=A,A=GB(G)):(B=A,A=i)):(B=A,A=i)))),de--,A===i&&(G=i,de===0&&Pe(gB)),A}function nq(){let A,G;return de++,A=B,wi(),G=ms(),G!==i?($t=A,A=BB(G)):(B=A,A=i),de--,A===i&&de===0&&Pe(SB),A}function oq(){let A,G,Q,we;if(de++,A=B,e.charCodeAt(B)===35?(G=C,B++):(G=i,de===0&&Pe($B)),G!==i){if(Q=[],we=e.charAt(B),U.test(we)?B++:(we=i,de===0&&Pe(pI)),we!==i)for(;we!==i;)Q.push(we),we=e.charAt(B),U.test(we)?B++:(we=i,de===0&&Pe(pI));else Q=i;Q!==i?($t=A,A=qB()):(B=A,A=i)}else B=A,A=i;return A===i&&(A=B,G=Vw(),G!==i&&($t=A,G=HB(G)),A=G,A===i&&(A=B,G=_I(),G!==i&&($t=A,G=WB()),A=G)),de--,A===i&&(G=i,de===0&&Pe(xB)),A}function ms(){let A,G,Q,we,Qe,Ut,hi,ji;for(A=B,G=e.charAt(B),W.test(G)?B++:(G=i,de===0&&Pe(fI)),G===i&&(G=null),Q=B,we=[],Qe=e.charAt(B),Y.test(Qe)?B++:(Qe=i,de===0&&Pe(el));Qe!==i;)we.push(Qe),Qe=e.charAt(B),Y.test(Qe)?B++:(Qe=i,de===0&&Pe(el));if(e.charCodeAt(B)===46?(Qe=P,B++):(Qe=i,de===0&&Pe(MB)),Qe!==i){if(Ut=[],hi=e.charAt(B),Y.test(hi)?B++:(hi=i,de===0&&Pe(el)),hi!==i)for(;hi!==i;)Ut.push(hi),hi=e.charAt(B),Y.test(hi)?B++:(hi=i,de===0&&Pe(el));else Ut=i;Ut!==i?(we=[we,Qe,Ut],Q=we):(B=Q,Q=i)}else B=Q,Q=i;if(Q===i)if(Q=[],we=e.charAt(B),Y.test(we)?B++:(we=i,de===0&&Pe(el)),we!==i)for(;we!==i;)Q.push(we),we=e.charAt(B),Y.test(we)?B++:(we=i,de===0&&Pe(el));else Q=i;if(Q!==i){if(we=B,e.charCodeAt(B)===101?(Qe=k,B++):(Qe=i,de===0&&Pe(TB)),Qe!==i){if(Ut=e.charAt(B),W.test(Ut)?B++:(Ut=i,de===0&&Pe(fI)),Ut===i&&(Ut=null),hi=[],ji=e.charAt(B),Y.test(ji)?B++:(ji=i,de===0&&Pe(el)),ji!==i)for(;ji!==i;)hi.push(ji),ji=e.charAt(B),Y.test(ji)?B++:(ji=i,de===0&&Pe(el));else hi=i;hi!==i?(Qe=[Qe,Ut,hi],we=Qe):(B=we,we=i)}else B=we,we=i;we===i&&(we=null),$t=A,A=ZB()}else B=A,A=i;return A}function aq(A,G){return A.map((function(Q){return Q[G]}))}function lq(A,G,Q){return[A].concat(aq(G,Q))}$f=n();const jw=$f!==i&&B===e.length;function vI(){throw $f!==i&&B<e.length&&Pe(JB()),XB(u0,Ys<e.length?YB(Ys):null,Ys<e.length?yI(Ys,Ys+1):yI(Ys,Ys))}return t.peg$library?{peg$result:$f,peg$currPos:B,peg$FAILED:i,peg$maxFailExpected:u0,peg$maxFailPos:Ys,peg$success:jw,peg$throw:jw?void 0:vI}:jw?$f:void vI()}function SP(e){if(!e||e.length===0)return null;if(typeof e=="string"){const i=uO(e);return i&&i.length!==0?i:null}const t=e.map((i=>{if(!Number.isFinite(i.scale)||i.scale<=0)throw new j("effect:invalid-scale","scale must be finite and greater than 0",{stop:i});return{scale:i.scale,effects:uO(i.value)}}));t.sort(((i,r)=>r.effects.length-i.effects.length));for(let i=0;i<t.length-1;i++){if(!Oz(t[i].effects,t[i+1].effects))throw new j("effect:interpolation-impossible","Cannot interpolate by scale between 2 lists of mixed effects",{a:t[i].effects,b:t[i+1].effects});Nz(t[i].effects,t[i+1].effects)}return t.sort(((i,r)=>r.scale-i.scale)),t}function uO(e){let t;if(!e)return[];try{t=bye(e)}catch(i){throw new j("effect:invalid-syntax","Invalid effect syntax",{value:e,error:i})}return t.map((i=>wye(i)))}function wye(e){try{switch(e.name){case"grayscale":case"sepia":case"saturate":case"invert":case"brightness":case"contrast":return Sye(e);case"opacity":return xye(e);case"hue-rotate":return $ye(e);case"blur":return Mye(e);case"drop-shadow":return Tye(e);case"bloom":return Eye(e)}}catch(t){throw t.details.filter=e,t}throw new j("effect:unknown-effect",`Effect '${e.name}' is not supported`,{effect:e})}function Sye(e){let t=1;return vf(e.parameters,1),e.parameters.length===1&&(t=vn(e.parameters[0])),new Ux(e.name,t)}function xye(e){let t=1;return vf(e.parameters,1),e.parameters.length===1&&(t=vn(e.parameters[0])),new kz(t)}function $ye(e){let t=0;return vf(e.parameters,1),e.parameters.length===1&&(t=kye(e.parameters[0])),new Az(t)}function Mye(e){let t=0;return vf(e.parameters,1),e.parameters.length===1&&(t=MP(e.parameters[0]),r0(t,e.parameters[0])),new Tz(t)}function Tye(e){const t=[];let i=null;for(const r of e.parameters)if(r.type==="color"){if(t.length&&Object.freeze(t),i)throw new j("effect:type-error","Accepts only one color",{});i=Rye(r)}else{const s=MP(r);if(Object.isFrozen(t))throw new j("effect:type-error","<length> parameters not consecutive",{lengths:t});t.push(s),t.length===3&&r0(s,r)}if(t.length<2||t.length>3)throw new j("effect:type-error",`Expected <length>{2,3}, Actual: <length>{${t.length}}`,{lengths:t});return new Pz(t[0],t[1],t[2]||0,i||i7("black"))}function Eye(e){let t=1,i=0,r=0;return vf(e.parameters,3),e.parameters[0]&&(t=vn(e.parameters[0])),e.parameters[1]&&(i=MP(e.parameters[1]),r0(i,e.parameters[1])),e.parameters[2]&&(r=vn(e.parameters[2])),new $z(t,i,r)}function vf(e,t){if(e.length>t)throw new j("effect:type-error",`Function supports up to ${t} parameters, Actual: ${e.length}`,{parameters:e})}function $w(e){if(e.type==="color")return"<color>";if(e.unit){if(e.unit in $P)return"<length>";if(e.unit in xP)return"<angle>";if(e.unit==="%")return"<percentage>"}return"<double>"}function r0(e,t){if(e<0)throw new j("effect:type-error",`Negative values are not allowed, Actual: ${e}`,{term:t})}function Cye(e){if(e.type!=="quantity"||e.unit!==null)throw new j("effect:type-error",`Expected <double>, Actual: ${$w(e)}`,{term:e})}function Pye(e){if(e.type!=="quantity"||e.unit!==null&&e.unit!=="%")throw new j("effect:type-error",`Expected <double> or <percentage>, Actual: ${$w(e)}`,{term:e})}const xP={deg:1,grad:.9,rad:180/Math.PI,turn:360};function Iye(e){if(e.type!=="quantity"||!(e.value===0&&e.unit===null||e.unit&&xP[e.unit]!=null))throw new j("effect:type-error",`Expected <angle>, Actual: ${$w(e)}`,{term:e})}const $P={px:1,cm:96/2.54,mm:96/2.54/10,in:96,pc:16,pt:96/72};function Aye(e){if(e.type!=="quantity"||!(e.value===0&&e.unit===null||e.unit&&$P[e.unit]!=null))throw new j("effect:type-error",`Expected <length>, Actual: ${$w(e)}`,{term:e})}function vn(e){Pye(e);const t=e.value;return r0(t,e),e.unit==="%"?.01*t:t}function Lye(e){return Cye(e),r0(e.value,e),e.value}function kye(e){return Iye(e),e.value*xP[e.unit]||0}function MP(e){return Aye(e),e.value*$P[e.unit]||0}function Rye(e){switch(e.colorType){case"hex":return tQ(e.value);case"named":return i7(e.value);case"function":return Dye(e.value)}}function i7(e){if(!h6(e))throw new j("effect:unknown-color",`color '${e}' isn't valid`,{namedColor:e});return eQ(e)}const Oye=/^rgba?/i,Nye=/^hsla?/i;function Dye(e){if(vf(e.parameters,4),Oye.test(e.name))return[vn(e.parameters[0]),vn(e.parameters[1]),vn(e.parameters[2]),e.parameters[3]?vn(e.parameters[3]):1];if(Nye.test(e.name))return d6(Lye(e.parameters[0]),vn(e.parameters[1]),vn(e.parameters[2]),e.parameters[3]?vn(e.parameters[3]):1);throw new j("effect:syntax-error",`Invalid color function '${e.name}'`,{colorFunction:e})}const cg=-1;let dn=class extends le{constructor(t){super(t),this._from=null,this._to=null,this._final=null,this._current=[],this._time=0,this.duration=N("mapview-transitions-duration"),this.effects=[]}set effect(t){if(this._get("effect")!==(t=t||"")){this._set("effect",t);try{this._transitionTo(cO(t))}catch(i){this._transitionTo([]),H.getLogger(this).warn("Invalid Effect",{effect:t,error:i})}}}get final(){return this._final}get hasEffects(){return this.transitioning||!!this.effects.length}set scale(t){this._updateForScale(t)}get transitioning(){return this._to!==null}canTransitionTo(t){try{return this.scale>0&&hO(this._current,cO(t),this.scale)}catch{return!1}}transitionStep(t,i){this._applyTimeTransition(t),this._updateForScale(i)}endTransition(){this._applyTimeTransition(this.duration)}_transitionTo(t){this.scale>0&&hO(this._current,t,this.scale)?(this._final=t,this._to=V(t),Fye(this._current,this._to,this.scale),this._from=V(this._current),this._time=0):(this._from=this._to=this._final=null,this._current=t),this._set("effects",this._current[0]?V(this._current[0].effects):[])}_applyTimeTransition(t){if(!(this._to&&this._from&&this._current&&this._final))return;this._time+=t;const i=Math.min(1,this._time/this.duration);for(let r=0;r<this._current.length;r++){const s=this._current[r],n=this._from[r],o=this._to[r];s.scale=zye(n.scale,o.scale,i);for(let a=0;a<s.effects.length;a++){const l=s.effects[a],u=n.effects[a],c=o.effects[a];l.interpolate(u,c,i)}}i===1&&(this._current=this._final,this._set("effects",this._current[0]?V(this._current[0].effects):[]),this._from=this._to=this._final=null)}_updateForScale(t){if(this._set("scale",t),this._current.length===0)return;const i=this._current,r=this._current.length-1;let s,n,o=1;if(i.length===1||t>=i[0].scale)n=s=i[0].effects;else if(t<=i[r].scale)n=s=i[r].effects;else for(let a=0;a<r;a++){const l=i[a],u=i[a+1];if(l.scale>=t&&u.scale<=t){o=(t-l.scale)/(u.scale-l.scale),s=l.effects,n=u.effects;break}}for(let a=0;a<this.effects.length;a++)this.effects[a].interpolate(s[a],n[a],o)}};function cO(e){const t=SP(e)||[];return Vye(t)?[{scale:cg,effects:t}]:t}function hO(e,t,i){return!e[0]?.effects||!t[0]?.effects?!0:!((e[0]?.scale===cg||t[0]?.scale===cg)&&(e.length>1||t.length>1)&&i<=0)&&Oz(e[0].effects,t[0].effects)}function Fye(e,t,i){const r=e.length>t.length?e:t,s=e.length>t.length?t:e,n=s[s.length-1],o=n?.scale??i,a=n?.effects??[];for(let l=s.length;l<r.length;l++)s.push({scale:o,effects:[...a]});for(let l=0;l<r.length;l++)s[l].scale=s[l].scale===cg?i:s[l].scale,r[l].scale=r[l].scale===cg?i:r[l].scale,Nz(s[l].effects,r[l].effects)}function zye(e,t,i){return e+(t-e)*i}function Vye(e){const t=e[0];return!!t&&"type"in t}h([f()],dn.prototype,"_to",void 0),h([f()],dn.prototype,"duration",void 0),h([f({value:""})],dn.prototype,"effect",null),h([f({readOnly:!0})],dn.prototype,"effects",void 0),h([f({readOnly:!0})],dn.prototype,"final",null),h([f({readOnly:!0})],dn.prototype,"hasEffects",null),h([f({value:0})],dn.prototype,"scale",null),h([f({readOnly:!0})],dn.prototype,"transitioning",null),dn=h([I("esri.layers.effects.EffectView")],dn);function Uye(e,t,i){try{return Bye(e)}catch(r){i?.messages?.push(r)}return null}function jye(e,t,i,r){try{const s=Gye(e);wu(i,s,t)}catch(s){r.messages&&r.messages.push(s)}}function Gye(e){const t=SP(e);return t?oie(t)?t.map((i=>i.toJSON())):t.map((({scale:i,effects:r})=>({scale:i,value:r.map((s=>s.toJSON()))}))):null}function Bye(e){if(!e||e.length===0)return null;if(qye(e)){const t=[];for(const i of e)t.push({scale:i.scale,value:rb(i.value)});return t}return rb(e)}function qye(e){const t=e[0];return!!t&&"scale"in t}function rb(e){if(!e?.length)return"";const t=[];for(const i of e){let r=[];switch(i.type){case"grayscale":case"sepia":case"saturate":case"invert":case"brightness":case"contrast":case"opacity":r=[ea(i,"amount")];break;case"blur":r=[ea(i,"radius","pt")];break;case"hue-rotate":r=[ea(i,"angle","deg")];break;case"drop-shadow":r=[ea(i,"xoffset","pt"),ea(i,"yoffset","pt"),ea(i,"blurRadius","pt"),Hye(i,"color")];break;case"bloom":r=[ea(i,"strength"),ea(i,"radius","pt"),ea(i,"threshold")]}const s=`${i.type}(${r.filter(Boolean).join(" ")})`;SP(s),t.push(s)}return t.join(" ")}function ea(e,t,i){if(e[t]==null)throw new j("effect:missing-parameter",`Missing parameter '${t}' in ${e.type} effect`,{effect:e});return i?e[t]+i:""+e[t]}function Hye(e,t){if(e[t]==null)throw new j("effect:missing-parameter",`Missing parameter '${t}' in ${e.type} effect`,{effect:e});const i=e[t];return`rgba(${i[0]||0}, ${i[1]||0}, ${i[2]||0}, ${i[3]/255||0})`}function ake(e,t){return{...t,filterMode:e.mode}}function Wye(e,t){return r7(e,t).next().value??null}function lke(e,t,i){const r=Zye(e);if(r&&(v6(t,r[0])||Cx(i,r[1])))return"";const s=Array.from(r7(e,t,i)),n=Yye(s,t,i)?"1=1":s.map((o=>o.where||"1=1")).reduce(((o,a)=>Rse(o,a)),"");return n&&n!=="1=1"?n:""}function Zye(e){if(s7(e)==="manual")return null;const t=[Number.NEGATIVE_INFINITY,Number.POSITIVE_INFINITY];for(const{minScale:i,maxScale:r}of e.filters)t[0]=Math.max(t[0],hg(i)),t[1]=Math.min(t[1],sb(r));return t}function*r7(e,t,i){if(s7(e)==="manual"){const r=e.filters.find((s=>s.id===e.activeFilterId));r&&(yield r)}else{typeof t=="object"&&(t=t.scale);for(const r of e.filters)Jye(r.minScale,r.maxScale,t,i)&&(yield r)}}function Yye(e,t,i){if(e.length===0)return!0;const r=hg(e.at(0)?.minScale),s=sb(e.at(-1)?.maxScale);if(Cx(r,t)||v6(s,i))return!0;for(let n=0;n<e.length-1;n++){const o=e[n],a=e[n+1];if(Cx(hg(a.minScale),sb(o.maxScale)))return!0}return!1}function Jye(e,t,i,r){return e=hg(e),i=hg(i),t=sb(t),!(!An(i,e)&&(r??i)>e)&&!sQ(t,i)&&(r===void 0||!An(r,e))}function s7(e){return"mode"in e?e.mode:e.filterMode}function hg(e){return e||Number.POSITIVE_INFINITY}function sb(e){return e||0}const n7=96;function uke(e,t){const i=e.extent,r=e.width,s=Hs(i?.spatialReference);return i&&r?i.width/r*s*k4*n7:0}function cke(e,t){return e/(Hs(t)*k4*n7)}function Xye(e,t,i){return Kye(e,t)&&Qye(e,i)}function Kye(e,t){return t===0||An(e,t)||e<t}function Qye(e,t){return t===0||An(e,t)||e>t}function hke(e,t){return An(e,t)?0:(e||Number.POSITIVE_INFINITY)>(t||Number.POSITIVE_INFINITY)?1:-1}function dke(e){const t=e.layer;return"floorInfo"in t&&t.floorInfo?.floorField&&"floors"in e.view?o7(e.view.floors,t.floorInfo.floorField):null}function dO(e,t){return"floorInfo"in t&&t.floorInfo?.floorField?o7(e,t.floorInfo.floorField):null}function o7(e,t){if(!e?.length)return null;const i=e.filter((r=>r!=="")).map((r=>`'${r}'`));return i.push("''"),`${t} IN (${i.join(",")}) OR ${t} IS NULL`}function pke(e,t,i){return t.flatten((({sublayers:s})=>s)).length!==e.length?!0:!!e.some((s=>s.originIdOf("minScale")>i||s.originIdOf("maxScale")>i||s.originIdOf("renderer")>i||s.originIdOf("labelingInfo")>i||s.originIdOf("opacity")>i||s.originIdOf("labelsVisible")>i||s.originIdOf("source")>i))||!a7(e,t)}function ege(e,t,i){return!!e.some((r=>{const s=r.source,n=!s||s.type==="map-layer"&&s.mapLayerId===r.id&&(s.gdbVersion==null||s.gdbVersion===i);r.commitProperty("renderer"),r.commitProperty("labelingInfo"),r.commitProperty("opacity"),r.commitProperty("labelsVisible"),r.commitProperty("orderBy");const o=r.layer?.capabilities?.exportMap?.supportsSublayerOrderBy??!1;return!n||r.originIdOf("renderer")>Ie.SERVICE||r.originIdOf("labelingInfo")>Ie.SERVICE||r.originIdOf("opacity")>Ie.SERVICE||r.originIdOf("labelsVisible")>Ie.SERVICE||o&&r.originIdOf("orderBy")>Ie.SERVICE}))||!a7(e,t)}function a7(e,t){if(!e?.length||t==null)return!0;const i=t.slice().reverse().flatten((({sublayers:n})=>n&&n.toArray().reverse())).map((n=>n.id)).toArray();if(e.length>i.length)return!1;let r=0;const s=i.length;for(const{id:n}of e){for(;r<s&&i[r]!==n;)r++;if(r>=s)return!1}return!0}function fke(e){return!!e&&e.some((t=>t.minScale!=null||t.layerDefinition?.minScale!=null))}const tge={visible:"visibleSublayers",definitionExpression:"layerDefs",labelingInfo:"hasDynamicLayers",labelsVisible:"hasDynamicLayers",opacity:"hasDynamicLayers",minScale:"visibleSublayers",maxScale:"visibleSublayers",renderer:"hasDynamicLayers",source:"hasDynamicLayers"};let Ms=class extends le{constructor(t){super(t),this.floors=null,this.scale=0}destroy(){this.layer=null}get dynamicLayers(){if(!this.hasDynamicLayers)return null;const t=this.visibleSublayers.map((i=>{const r=dO(this.floors,i);return i.toExportImageJSON(r)}));return t.length?JSON.stringify(t):null}get hasDynamicLayers(){return this.layer&&ege(this.visibleSublayers,this.layer.serviceSublayers,this.layer.gdbVersion)}set layer(t){this._get("layer")!==t&&(this._set("layer",t),this.removeHandles("layer"),t&&this.addHandles([t.allSublayers.on("change",(()=>this.notifyChange("visibleSublayers"))),t.on("sublayer-update",(i=>this.notifyChange(tge[i.propertyName])))],"layer"))}get layers(){const t=this.visibleSublayers;return t?t.length?"show:"+t.map((i=>i.id)).join(","):"show:-1":null}get layerDefs(){const t=!!this.floors?.length,i=this.visibleSublayers.filter((r=>r.definitionExpression!=null||t&&r.floorInfo!=null));return i.length?JSON.stringify(i.reduce(((r,s)=>{const n=dO(this.floors,s),o=kse(n,s.definitionExpression);return o!=null&&(r[s.id]=o),r}),{})):null}get version(){this.commitProperty("layers"),this.commitProperty("layerDefs"),this.commitProperty("dynamicLayers");const t=this.layer;return t&&(t.commitProperty("dpi"),t.commitProperty("imageFormat"),t.commitProperty("imageTransparency"),t.commitProperty("gdbVersion")),(this._get("version")||0)+1}get visibleSublayers(){const t=[];if(!this.layer)return t;const i=this.layer.sublayers,r=this.scale,s=o=>{o.visible&&(r===0||Xye(r,o.minScale,o.maxScale))&&(o.sublayers?o.sublayers.forEach(s):t.unshift(o))};i&&i.forEach(s);const n=this._get("visibleSublayers");return!n||n.length!==t.length||n.some(((o,a)=>t[a]!==o))?t:n}toJSON(){const t=this.layer;let i={dpi:t.dpi,format:t.imageFormat,transparent:t.imageTransparency,gdbVersion:t.gdbVersion||null};return this.hasDynamicLayers&&this.dynamicLayers?i.dynamicLayers=this.dynamicLayers:i={...i,layers:this.layers,layerDefs:this.layerDefs},i}};h([f({readOnly:!0})],Ms.prototype,"dynamicLayers",null),h([f()],Ms.prototype,"floors",void 0),h([f({readOnly:!0})],Ms.prototype,"hasDynamicLayers",null),h([f()],Ms.prototype,"layer",null),h([f({readOnly:!0})],Ms.prototype,"layers",null),h([f({readOnly:!0})],Ms.prototype,"layerDefs",null),h([f({type:Number})],Ms.prototype,"scale",void 0),h([f({readOnly:!0})],Ms.prototype,"version",null),h([f({readOnly:!0})],Ms.prototype,"visibleSublayers",null),Ms=h([I("esri.layers.support.ExportImageParameters")],Ms);const ige=9999999e31,rge=2e-7,sge={u1:[0,1],u2:[0,3],u4:[0,15],u8:[0,255],s8:[-128,127],u16:[0,65535],s16:[-32768,32767],u32:[0,4294967295],s32:[-2147483648,2147483647],f32:[-34028234663852886e22,34028234663852886e22],f64:[-Number.MAX_VALUE,Number.MAX_VALUE],unknown:void 0,c64:void 0,c128:void 0};function nb(e){return sge[e]??[-34028234663852886e22,34028234663852886e22]}const nge={u1:1,u2:1,u4:1,u8:1,s8:1,u16:2,s16:2,u32:4,s32:4,f32:4,f64:8,unknown:4,c64:16,c128:32};function oge(e){return nge[e]}function yke(e){return oge(e.pixelType)*e.bandCount}function gke(e,t){return e==null||t==null?"s32":e<0?e>=-128&&t<128?"s8":e>=-32768&&t<32768?"s16":"s32":t<256?"u8":t<65536?"u16":"u32"}function age(e){return(e?.startsWith("s")||e?.startsWith("u"))??!1}function _ke(e,t,i,r){let[s,n]=nb(i);const o=age(i);return o&&(s-=1e-5,n+=1e-5),o?i.startsWith("u")?lge(e,t,r,[s,n]):uge(e,t,r,[s,n]):cge(e,t,r,[s,n])}function vke(e,t){for(let i=0;i<t.length;i++)t[i]&&isNaN(e[i])&&(t[i]=0,e[i]=0)}function lge(e,t,i,r){const[s,n]=r;for(let o=0;o<t.length;o++)if(t[o]){const a=e[o];a<s||a>n?t[o]=0:i[o]=a+.5|0}}function uge(e,t,i,r){const[s,n]=r;for(let o=0;o<t.length;o++)if(t[o]){const a=e[o];a<s||a>n?t[o]=0:i[o]=a+(a>0?.5:-.5)|0}}function cge(e,t,i,r){const[s,n]=r;for(let o=0;o<t.length;o++)if(t[o]){const a=e[o];a<s||a>n?t[o]=0:i[o]=a}}function bke(e,t,i){if(e.depthCount&&e.depthCount>1)return;const{pixels:r,statistics:s,pixelType:n}=e,o=r[0].length,a=e.bandMasks??[],l=e.mask??new Uint8Array(o).fill(255),u=n==="f32"||n==="f64",c=nb(n);let d=!1;for(let y=0;y<r.length;y++){const g=typeof t=="number"?t:t[y];if(g==null)continue;const _=s?.[y]?.minValue??c[0],v=s?.[y]?.maxValue??c[1];if(_>g+Number.EPSILON||v<g-Number.EPSILON)continue;const b=a[y]||l.slice(),S=r[y],$=i?.customFloatTolerance;if(u&&$!==0){let E=$;E||(E=Math.abs(g)>=ige?rge*Math.abs(g):n==="f32"?2**-23:Number.EPSILON);for(let C=0;C<S.length;C++)b[C]&&Math.abs(S[C]-g)<E&&(S[C]=0,b[C]=0,l[C]=0,d=!0)}else for(let E=0;E<S.length;E++)b[E]&&S[E]===g&&(S[E]=0,b[E]=0,l[E]=0,d=!0);a[y]=b}if(d){const y=e.bandMasks||e.pixels.length>1?a:null;i?.matchAllNoData?e.mask=y&&y.length>1?m(y):l:(e.bandMasks=y,e.mask=l)}function m(y){if(y.length<2)return y[0];const g=y[0].length,_=new Uint8Array(g).fill(0);for(let v=0;v<y.length;v++){const b=y[v];for(let S=0;S<g;S++)b[S]&&(_[S]=255)}return _}d&&"updateStatistics"in e&&e.updateStatistics()}var eT;let Jm=eT=class extends ee{constructor(e){super(e),this.minValue=0,this.maxValue=0}clone(){return new eT({minValue:this.minValue,maxValue:this.maxValue})}};h([f({type:Number,json:{write:!0}})],Jm.prototype,"minValue",void 0),h([f({type:Number,json:{write:!0}})],Jm.prototype,"maxValue",void 0),Jm=eT=h([I("esri.renderers.support.AuthoringInfoClassBreakInfo")],Jm);var tT;let Ul=tT=class extends ee{constructor(e){super(e),this.field="",this.normalizationField="",this.label="",this.classBreakInfos=new Array}clone(){return new tT({field:this.field,normalizationField:this.normalizationField,label:this.label,classBreakInfos:V(this.classBreakInfos)})}};h([f({type:String,json:{write:!0}})],Ul.prototype,"field",void 0),h([f({type:String,json:{write:!0}})],Ul.prototype,"normalizationField",void 0),h([f({type:String,json:{write:!0}})],Ul.prototype,"label",void 0),h([f({type:[Jm],json:{write:!0}})],Ul.prototype,"classBreakInfos",void 0),Ul=tT=h([I("esri.renderers.support.AuthoringInfoFieldInfo")],Ul);var iT;let bd=iT=class extends ee{constructor(e){super(e),this.label=null,this.size=null,this.value=null}clone(){return new iT({label:this.label,value:this.value,size:this.size})}};h([f({type:String,json:{write:!0}})],bd.prototype,"label",void 0),h([f({type:Number,json:{write:!0}})],bd.prototype,"size",void 0),h([f({type:Number,json:{write:!0}})],bd.prototype,"value",void 0),bd=iT=h([I("esri.renderers.support.AuthoringInfoSizeStop")],bd);const hge=bd;var rT;const Z0=new Ye({percentTotal:"percent-of-total",ratio:"ratio",percent:"percent"}),Y0=new Ye({sizeInfo:"size",colorInfo:"color",transparencyInfo:"opacity",rotationInfo:"rotation"}),pO={key:e=>typeof e=="number"?"number":"string",typeMap:{number:Number,string:String},base:null},fO=["high-to-low","above-and-below","centered-on","extremes"],mO=[...new Set(["high-to-low","above-and-below","centered-on","extremes","above","below","high-to-low","above-and-below","above","below","reference-size","spike"])],yO=["seconds","minutes","hours","days","months","years"],dge=["circle","diamond","hexagon-flat","hexagon-pointy","square"],pge=["triangle-closed-outline","triangle-gradient-fill-closed","triangle-gradient-fill-closed-outline","triangle-gradient-fill-open","triangle-gradient-fill-open-outline","triangle-open-outline","triangle-solid-fill-closed","triangle-solid-fill-closed-outline","triangle-solid-fill-open","triangle-solid-fill-open-outline"];let di=rT=class extends ee{constructor(e){super(e),this.endTime=null,this.field=null,this.maxSliderValue=null,this.minSliderValue=null,this.startTime=null,this.type=null,this.units=null}castEndTime(e){return typeof e=="string"||typeof e=="number"?e:null}get normalizationField(){return this.theme==="reference-size"||this.theme==="spike"?this._get("normalizationField"):null}set normalizationField(e){this._set("normalizationField",e)}get referenceSizeScale(){return this.theme==="reference-size"?this._get("referenceSizeScale"):null}set referenceSizeScale(e){this._set("referenceSizeScale",e)}get referenceSizeSymbolStyle(){return this.theme==="reference-size"?this._get("referenceSizeSymbolStyle"):null}set referenceSizeSymbolStyle(e){this._set("referenceSizeSymbolStyle",e)}get spikeSymbolStyle(){return this.theme==="spike"?this._get("spikeSymbolStyle"):null}set spikeSymbolStyle(e){this._set("spikeSymbolStyle",e)}castStartTime(e){return typeof e=="string"||typeof e=="number"?e:null}get sizeStops(){return this.theme==="reference-size"||this.theme==="spike"?this._get("sizeStops"):null}set sizeStops(e){this._set("sizeStops",e)}get style(){return this.type==="color"?this._get("style"):null}set style(e){this._set("style",e)}get theme(){return this.type==="color"||this.type==="size"?this._get("theme")||"high-to-low":null}set theme(e){this._set("theme",e)}clone(){return new rT({endTime:this.endTime,field:this.field,maxSliderValue:this.maxSliderValue,minSliderValue:this.minSliderValue,normalizationField:this.normalizationField,referenceSizeScale:this.referenceSizeScale,referenceSizeSymbolStyle:this.referenceSizeSymbolStyle,spikeSymbolStyle:this.spikeSymbolStyle,sizeStops:V(this.sizeStops),startTime:this.startTime,style:this.style,theme:this.theme,type:this.type,units:this.units})}};h([f({types:pO,json:{write:!0}})],di.prototype,"endTime",void 0),h([Ke("endTime")],di.prototype,"castEndTime",null),h([f({type:String,json:{write:!0}})],di.prototype,"field",void 0),h([f({type:Number,json:{write:!0}})],di.prototype,"maxSliderValue",void 0),h([f({type:Number,json:{write:!0}})],di.prototype,"minSliderValue",void 0),h([f({type:String,json:{origins:{"web-scene":{write:!1}},write:!0}})],di.prototype,"normalizationField",null),h([f({type:Number,value:null,json:{origins:{"web-scene":{write:!1}},write:!0}})],di.prototype,"referenceSizeScale",null),h([f({type:dge,value:null,json:{origins:{"web-scene":{write:!1}},write:!0}})],di.prototype,"referenceSizeSymbolStyle",null),h([f({type:pge,value:null,json:{origins:{"web-scene":{write:!1}},write:!0}})],di.prototype,"spikeSymbolStyle",null),h([f({types:pO,json:{write:!0}})],di.prototype,"startTime",void 0),h([Ke("startTime")],di.prototype,"castStartTime",null),h([f({type:[hge],json:{origins:{"web-scene":{write:!1}},write:!0}})],di.prototype,"sizeStops",null),h([f({type:Z0.apiValues,value:null,json:{type:Z0.jsonValues,read:Z0.read,write:Z0.write}})],di.prototype,"style",null),h([f({type:mO,value:null,json:{type:mO,origins:{"web-scene":{type:fO,write:{writer:(e,t)=>{fO.includes(e)&&(t.theme=e)}}}},write:!0}})],di.prototype,"theme",null),h([f({type:Y0.apiValues,json:{type:Y0.jsonValues,read:Y0.read,write:Y0.write}})],di.prototype,"type",void 0),h([f({type:yO,json:{type:yO,write:!0}})],di.prototype,"units",void 0),di=rT=h([I("esri.renderers.support.AuthoringInfoVisualVariable")],di);const fge=di;let lp=class extends ee{constructor(t){super(t),this.type=null}};h([f({readOnly:!0,json:{read:!1,write:!0}})],lp.prototype,"type",void 0),lp=h([I("esri.rest.support.ColorRamp")],lp);var sT;let Ia=sT=class extends lp{constructor(e){super(e),this.algorithm=null,this.fromColor=null,this.toColor=null,this.type="algorithmic"}clone(){return new sT({fromColor:V(this.fromColor),toColor:V(this.toColor),algorithm:this.algorithm})}};h([me({esriCIELabAlgorithm:"cie-lab",esriHSVAlgorithm:"hsv",esriLabLChAlgorithm:"lab-lch"})],Ia.prototype,"algorithm",void 0),h([f({type:X,json:{type:[Ue],write:!0}})],Ia.prototype,"fromColor",void 0),h([f({type:X,json:{type:[Ue],write:!0}})],Ia.prototype,"toColor",void 0),h([f({type:["algorithmic"]})],Ia.prototype,"type",void 0),Ia=sT=h([I("esri.rest.support.AlgorithmicColorRamp")],Ia);var nT;let Vd=nT=class extends lp{constructor(e){super(e),this.colorRamps=null,this.type="multipart"}clone(){return new nT({colorRamps:V(this.colorRamps)})}};h([f({type:[Ia],json:{write:!0}})],Vd.prototype,"colorRamps",void 0),h([f({type:["multipart"]})],Vd.prototype,"type",void 0),Vd=nT=h([I("esri.rest.support.MultipartColorRamp")],Vd);const mge={key:"type",base:lp,typeMap:{algorithmic:Ia,multipart:Vd}};function yge(e){return e?.type?e.type==="algorithmic"?Ia.fromJSON(e):e.type==="multipart"?Vd.fromJSON(e):null:null}var oT;const Nu=new Ye({esriClassifyDefinedInterval:"defined-interval",esriClassifyEqualInterval:"equal-interval",esriClassifyManual:"manual",esriClassifyNaturalBreaks:"natural-breaks",esriClassifyQuantile:"quantile",esriClassifyStandardDeviation:"standard-deviation"}),J0=new Ye({classedSize:"class-breaks-size",classedColor:"class-breaks-color",univariateColorSize:"univariate-color-size",relationship:"relationship",predominance:"predominance",dotDensity:"dot-density",flow:"flow"}),gO=new Ye({classedSize:"class-breaks-size",classedColor:"class-breaks-color",univariateColorSize:"univariate-color-size",relationship:"relationship",predominance:"predominance",dotDensity:"dot-density"}),_O=["inches","feet","yards","miles","nautical-miles","millimeters","centimeters","decimeters","meters","kilometers"],gge=["high-to-low","above-and-below","above","below"],_ge=["flow-line","wave-front"],vge=["caret","circle-caret","arrow","circle-arrow","plus-minus","circle-plus-minus","square","circle","triangle","happy-sad","thumb","custom"];let Mt=oT=class extends ee{constructor(e){super(e),this.colorRamp=null,this.fadeRatio=null,this.isAutoGenerated=!1,this.lengthUnit=null,this.maxSliderValue=null,this.minSliderValue=null,this.visualVariables=null}get classificationMethod(){const e=this._get("classificationMethod"),t=this.type;return t&&t!=="relationship"?t==="class-breaks-size"||t==="class-breaks-color"?e||"manual":null:e}set classificationMethod(e){this._set("classificationMethod",e)}readColorRamp(e){return e?yge(e):void 0}get fields(){return this.type&&this.type!=="predominance"?null:this._get("fields")}set fields(e){this._set("fields",e)}get field1(){return this.type&&this.type!=="relationship"?null:this._get("field1")}set field1(e){this._set("field1",e)}get field2(){return this.type&&this.type!=="relationship"?null:this._get("field2")}set field2(e){this._set("field2",e)}get flowTheme(){return this.type==="flow"?this._get("flowTheme"):null}set flowTheme(e){this._set("flowTheme",e)}get focus(){return this.type&&this.type!=="relationship"?null:this._get("focus")}set focus(e){this._set("focus",e)}get numClasses(){return this.type&&this.type!=="relationship"?null:this._get("numClasses")}set numClasses(e){this._set("numClasses",e)}get statistics(){return this.type==="univariate-color-size"&&this.univariateTheme==="above-and-below"?this._get("statistics"):null}set statistics(e){this._set("statistics",e)}get standardDeviationInterval(){const e=this.type;return e&&e!=="relationship"&&e!=="class-breaks-size"&&e!=="class-breaks-color"||this.classificationMethod&&this.classificationMethod!=="standard-deviation"?null:this._get("standardDeviationInterval")}set standardDeviationInterval(e){this._set("standardDeviationInterval",e)}get type(){return this._get("type")}set type(e){let t=e;e==="classed-size"?t="class-breaks-size":e==="classed-color"&&(t="class-breaks-color"),this._set("type",t)}get univariateSymbolStyle(){return this.type==="univariate-color-size"&&this.univariateTheme==="above-and-below"?this._get("univariateSymbolStyle"):null}set univariateSymbolStyle(e){this._set("univariateSymbolStyle",e)}get univariateTheme(){return this.type==="univariate-color-size"?this._get("univariateTheme"):null}set univariateTheme(e){this._set("univariateTheme",e)}clone(){return new oT({classificationMethod:this.classificationMethod,colorRamp:V(this.colorRamp),fadeRatio:V(this.fadeRatio),fields:this.fields?.slice(),field1:V(this.field1),field2:V(this.field2),isAutoGenerated:this.isAutoGenerated,focus:this.focus,numClasses:this.numClasses,maxSliderValue:this.maxSliderValue,minSliderValue:this.minSliderValue,lengthUnit:this.lengthUnit,statistics:this.statistics,standardDeviationInterval:this.standardDeviationInterval,type:this.type,visualVariables:this.visualVariables&&this.visualVariables.map((e=>e.clone())),univariateSymbolStyle:this.univariateSymbolStyle,univariateTheme:this.univariateTheme,flowTheme:this.flowTheme})}};h([f({type:Nu.apiValues,value:null,json:{type:Nu.jsonValues,read:Nu.read,write:Nu.write,origins:{"web-document":{default:"manual",type:Nu.jsonValues,read:Nu.read,write:Nu.write}}}})],Mt.prototype,"classificationMethod",null),h([f({types:mge,json:{write:!0}})],Mt.prototype,"colorRamp",void 0),h([Ae("colorRamp")],Mt.prototype,"readColorRamp",null),h([f({json:{write:!0,origins:{"web-scene":{write:!1,read:!1}}}})],Mt.prototype,"fadeRatio",void 0),h([f({type:[String],value:null,json:{write:!0}})],Mt.prototype,"fields",null),h([f({type:Ul,value:null,json:{write:!0}})],Mt.prototype,"field1",null),h([f({type:Ul,value:null,json:{write:!0}})],Mt.prototype,"field2",null),h([f({type:_ge,value:null,json:{write:!0,origins:{"web-scene":{write:!1}}}})],Mt.prototype,"flowTheme",null),h([f({type:["HH","HL","LH","LL"],value:null,json:{write:!0}})],Mt.prototype,"focus",null),h([f({type:Boolean,json:{write:!0,default:!1,origins:{"web-scene":{write:!1}}}})],Mt.prototype,"isAutoGenerated",void 0),h([f({type:Number,value:null,json:{type:Ue,write:!0}})],Mt.prototype,"numClasses",null),h([f({type:_O,json:{type:_O,read:!1,write:!1,origins:{"web-scene":{read:!0,write:!0}}}})],Mt.prototype,"lengthUnit",void 0),h([f({type:Number,json:{write:!0,origins:{"web-scene":{write:!1,read:!1}}}})],Mt.prototype,"maxSliderValue",void 0),h([f({type:Number,json:{write:!0,origins:{"web-scene":{write:!1,read:!1}}}})],Mt.prototype,"minSliderValue",void 0),h([f({type:Object,value:null,json:{write:!0,origins:{"web-scene":{write:!1,read:!1}}}})],Mt.prototype,"statistics",null),h([f({type:[.25,.33,.5,1],value:null,json:{type:[.25,.33,.5,1],write:!0}})],Mt.prototype,"standardDeviationInterval",null),h([f({type:J0.apiValues,value:null,json:{type:J0.jsonValues,read:J0.read,write:J0.write,origins:{"web-scene":{type:gO.jsonValues,write:{writer:gO.write,overridePolicy:e=>({enabled:e!=="flow"})}}}}})],Mt.prototype,"type",null),h([f({type:[fge],json:{write:!0}})],Mt.prototype,"visualVariables",void 0),h([f({type:vge,value:null,json:{write:!0,origins:{"web-scene":{write:!1}}}})],Mt.prototype,"univariateSymbolStyle",null),h([f({type:gge,value:null,json:{write:!0,origins:{"web-scene":{write:!1}}}})],Mt.prototype,"univariateTheme",null),Mt=oT=h([I("esri.renderers.support.AuthoringInfo")],Mt);const sS=new Ye({simple:"simple",uniqueValue:"unique-value",classBreaks:"class-breaks",heatmap:"heatmap",dotDensity:"dot-density",dictionary:"dictionary",pieChart:"pie-chart"},{ignoreUnknown:!0});let hs=class extends ee{constructor(t){super(t),this.authoringInfo=null,this.type=null}async getRequiredFields(t){if(!this.collectRequiredFields)return[];const i=new Set;return await this.collectRequiredFields(i,t),Array.from(i).sort()}getSymbol(t,i){}async getSymbolAsync(t,i){}get symbols(){return[]}get arcadeRequired(){return!1}getAttributeHash(){return JSON.stringify(this)}getMeshHash(){return JSON.stringify(this)}};h([f({type:Mt,json:{write:!0}})],hs.prototype,"authoringInfo",void 0),h([f({type:sS.apiValues,readOnly:!0,json:{type:sS.jsonValues,read:!1,write:{writer:sS.write,ignoreOrigin:!0,isRequired:!0}}})],hs.prototype,"type",void 0),hs=h([I("esri.renderers.Renderer")],hs);let Xm=class extends xt.ClonableMixin(ee){constructor(){super(...arguments),this.showLegend=null,this.title=null}};h([f({type:Boolean,json:{write:!0}})],Xm.prototype,"showLegend",void 0),h([f({type:String,json:{write:!0}})],Xm.prototype,"title",void 0),Xm=h([I("esri.renderers.visualVariables.support.VisualVariableLegendOptions")],Xm);const l7=Xm,nS=new Ye({colorInfo:"color",transparencyInfo:"opacity",rotationInfo:"rotation",sizeInfo:"size"});let Xi=class extends ee{constructor(t){super(t),this.index=null,this.type=null,this.field=null,this.valueExpression=null,this.valueExpressionTitle=null,this.legendOptions=null}castField(t){return t==null?t:typeof t=="function"?(H.getLogger(this).error(".field: field must be a string value"),null):kg(t)}get arcadeRequired(){return!!this.valueExpression}clone(){}getAttributeHash(){return`${this.type}-${this.field}-${this.valueExpression}`}};h([f()],Xi.prototype,"index",void 0),h([f({type:nS.apiValues,readOnly:!0,json:{read:nS.read,write:{writer:nS.write,isRequired:!0}}})],Xi.prototype,"type",void 0),h([f({type:String,json:{write:!0}})],Xi.prototype,"field",void 0),h([Ke("field")],Xi.prototype,"castField",null),h([f({type:String,json:{write:!0}})],Xi.prototype,"valueExpression",void 0),h([f({type:String,json:{write:!0}})],Xi.prototype,"valueExpressionTitle",void 0),h([f({readOnly:!0})],Xi.prototype,"arcadeRequired",null),h([f({type:l7,json:{write:!0}})],Xi.prototype,"legendOptions",void 0),Xi=h([I("esri.renderers.visualVariables.VisualVariable")],Xi);var aT;let oc=aT=class extends ee{constructor(e){super(e),this.color=null,this.label=null,this.value=null}writeValue(e,t,i){t[i]=e??0}clone(){return new aT({color:this.color&&this.color.clone(),label:this.label,value:this.value})}};h([f({type:X,json:{type:[Ue],write:{isRequired:!0}}})],oc.prototype,"color",void 0),h([f({type:String,json:{write:!0}})],oc.prototype,"label",void 0),h([f({type:Number,json:{write:{writerEnsuresNonNull:!0}}})],oc.prototype,"value",void 0),h([$e("value")],oc.prototype,"writeValue",null),oc=aT=h([I("esri.renderers.visualVariables.support.ColorStop")],oc);const bge=oc;var lT;let jl=lT=class extends Xi{constructor(e){super(e),this.type="color",this.normalizationField=null}get cache(){return{ipData:this._interpolateData(),hasExpression:!!this.valueExpression,compiledFunc:null}}set stops(e){e&&Array.isArray(e)&&(e=e.filter((t=>!!t))).sort(((t,i)=>t.value-i.value)),this._set("stops",e)}clone(){return new lT({field:this.field,normalizationField:this.normalizationField,valueExpression:this.valueExpression,valueExpressionTitle:this.valueExpressionTitle,stops:this.stops&&this.stops.map((e=>e.clone())),legendOptions:this.legendOptions?.clone()})}getAttributeHash(){return`${super.getAttributeHash()}-${this.normalizationField}`}_interpolateData(){return this.stops&&this.stops.map((e=>e.value||0))}};h([f({readOnly:!0})],jl.prototype,"cache",null),h([f({type:["color"],json:{type:["colorInfo"]}})],jl.prototype,"type",void 0),h([f({type:String,json:{write:!0}})],jl.prototype,"normalizationField",void 0),h([f({type:[bge],json:{write:!0}})],jl.prototype,"stops",null),jl=lT=h([I("esri.renderers.visualVariables.ColorVariable")],jl);var uT;let Pl=uT=class extends ee{constructor(e){super(e),this.label=null,this.opacity=null,this.value=null}readOpacity(e,t){return xC(t.transparency)}writeOpacity(e,t,i){t[i]=SC(e)}clone(){return new uT({label:this.label,opacity:this.opacity,value:this.value})}};h([f({type:String,json:{write:!0}})],Pl.prototype,"label",void 0),h([f({type:Number,json:{type:Ue,write:{target:"transparency",isRequired:!0}}})],Pl.prototype,"opacity",void 0),h([Ae("opacity",["transparency"])],Pl.prototype,"readOpacity",null),h([$e("opacity")],Pl.prototype,"writeOpacity",null),h([f({type:Number,json:{write:{isRequired:!0}}})],Pl.prototype,"value",void 0),Pl=uT=h([I("esri.renderers.visualVariables.support.OpacityStop")],Pl);const wge=Pl;var cT;let Aa=cT=class extends Xi{constructor(e){super(e),this.type="opacity",this.normalizationField=null}get cache(){return{ipData:this._interpolateData(),hasExpression:!!this.valueExpression,compiledFunc:null}}set stops(e){e&&Array.isArray(e)&&(e=e.filter((t=>!!t))).sort(((t,i)=>t.value-i.value)),this._set("stops",e)}clone(){return new cT({field:this.field,normalizationField:this.normalizationField,valueExpression:this.valueExpression,valueExpressionTitle:this.valueExpressionTitle,stops:this.stops&&this.stops.map((e=>e.clone())),legendOptions:this.legendOptions?.clone()})}getAttributeHash(){return`${super.getAttributeHash()}-${this.normalizationField}`}_interpolateData(){return this.stops&&this.stops.map((e=>e.value||0))}};h([f({readOnly:!0})],Aa.prototype,"cache",null),h([f({type:["opacity"],json:{type:["transparencyInfo"]}})],Aa.prototype,"type",void 0),h([f({type:String,json:{write:!0}})],Aa.prototype,"normalizationField",void 0),h([f({type:[wge],json:{write:!0}})],Aa.prototype,"stops",null),Aa=cT=h([I("esri.renderers.visualVariables.OpacityVariable")],Aa);var hT;let Gl=hT=class extends Xi{constructor(e){super(e),this.axis=null,this.type="rotation",this.rotationType="geographic"}get cache(){return{hasExpression:!!this.valueExpression,compiledFunc:null}}clone(){return new hT({axis:this.axis,rotationType:this.rotationType,field:this.field,valueExpression:this.valueExpression,valueExpressionTitle:this.valueExpressionTitle,legendOptions:this.legendOptions?.clone()})}};h([f({readOnly:!0})],Gl.prototype,"cache",null),h([f({type:["heading","tilt","roll"],json:{origins:{"web-scene":{default:"heading",write:!0}}}})],Gl.prototype,"axis",void 0),h([f({type:["rotation"],json:{type:["rotationInfo"]}})],Gl.prototype,"type",void 0),h([f({type:["geographic","arithmetic"],json:{write:!0,origins:{"web-document":{write:!0,default:"geographic"}}}})],Gl.prototype,"rotationType",void 0),Gl=hT=h([I("esri.renderers.visualVariables.RotationVariable")],Gl);function Sge(e){return ct(e)}var dT;let Il=dT=class extends ee{constructor(e){super(e),this.label=null,this.size=null,this.value=null,this.useMinValue=null,this.useMaxValue=null}clone(){return new dT({label:this.label,size:this.size,value:this.value,useMaxValue:this.useMaxValue,useMinValue:this.useMinValue})}};h([f({type:String,json:{write:!0}})],Il.prototype,"label",void 0),h([f({type:Number,cast:ct,json:{write:{isRequired:!0}}})],Il.prototype,"size",void 0),h([f({type:Number,json:{write:{isRequired:!0}}})],Il.prototype,"value",void 0),h([f({type:Boolean,json:{write:!1}})],Il.prototype,"useMinValue",void 0),h([f({type:Boolean,json:{write:!1}})],Il.prototype,"useMaxValue",void 0),Il=dT=h([I("esri.renderers.visualVariables.support.SizeStop")],Il);let S1=class extends l7{constructor(){super(...arguments),this.customValues=null}};h([f({type:[Number],json:{write:!0}})],S1.prototype,"customValues",void 0),S1=h([I("esri.renderers.visualVariables.support.SizeVariableLegendOptions")],S1);const u7=S1;var ja,yi;function Ud(e){return e&&e.declaredClass==="esri.renderers.visualVariables.SizeVariable"}function fh(e){return e!=null&&!isNaN(e)&&isFinite(e)}function c7(e){return e.valueExpression?ja.Expression:e.field&&typeof e.field=="string"?ja.Field:ja.Unknown}function xge(e,t){const i=t||c7(e),r=e.valueUnit||"unknown";return i===ja.Unknown?yi.Constant:e.stops?yi.Stops:e.minSize!=null&&e.maxSize!=null&&e.minDataValue!=null&&e.maxDataValue!=null?yi.ClampedLinear:r==="unknown"?e.minSize!=null&&e.minDataValue!=null?e.minSize&&e.minDataValue?yi.Proportional:yi.Additive:yi.Identity:yi.RealWorldSize}(function(e){e.Unknown="unknown",e.Expression="expression",e.Field="field"})(ja||(ja={})),(function(e){e.Unknown="unknown",e.Stops="stops",e.ClampedLinear="clamped-linear",e.Proportional="proportional",e.Additive="additive",e.Constant="constant",e.Identity="identity",e.RealWorldSize="real-world-size"})(yi||(yi={}));const Mw={unknown:1,inches:it(1,"meters","inches"),feet:it(1,"meters","feet"),"us-feet":it(1,"meters","us-feet"),yards:it(1,"meters","yards"),miles:it(1,"meters","miles"),"nautical-miles":it(1,"meters","nautical-miles"),millimeters:it(1,"meters","millimeters"),centimeters:it(1,"meters","centimeters"),decimeters:it(1,"meters","decimeters"),meters:it(1,"meters","meters"),kilometers:it(1,"meters","kilometers"),"decimal-degrees":1/bY(1,"meters",Ft.radius)},h7=()=>H.getLogger("esri.renderers.visualVariables.support.visualVariableUtils"),Tw=e=>h7().warn(`The visualVariable should be an instance of esri.renderers.visualVariables.${e}`),Ew=()=>h7().error("Use of arcade expressions requires an arcade context"),vO=new Ni,x1=Math.PI,d7=/^\s*(return\s+)?\$view\.scale\s*(;)?\s*$/i;function p7(e,t,i){const r="visualVariables"in e&&e.visualVariables?e.visualVariables.find((g=>g.type==="color")):e;if(!r)return;if(r.declaredClass!=="esri.renderers.visualVariables.ColorVariable")return void Tw("ColorVariable");const s=typeof t=="number",n=s?null:t,o=n?.attributes;let a=s?t:null;const l=r.field,{ipData:u,hasExpression:c}=r.cache;let d=r.cache.compiledFunc;if(!l&&!c){const g=r.stops;return g&&g[0]&&g[0].color}if(typeof a!="number")if(c){if(i?.arcade==null)return void Ew();const g={viewingMode:i.viewingMode,scale:i.scale,spatialReference:i.spatialReference},_=i.arcade.arcadeUtils,v=_.getViewInfo(g),b=_.createExecContext(n,v,i.timeZone);if(!d){const S=_.createSyntaxTree(r.valueExpression);d=_.createFunction(S),r.cache.compiledFunc=d}a=_.executeFunction(d,b)}else o&&(a=o[l]);const m=r.normalizationField,y=o!=null&&m!=null?parseFloat(o[m]):void 0;if(a!=null&&(!m||s||!isNaN(y)&&y!==0)){fh(y)&&!s&&(a/=y);const g=TP(a,u);if(g){const _=g[0],v=g[1],b=_===v?r.stops[_].color:X.blendColors(r.stops[_].color,r.stops[v].color,g[2],i?.color);return new X(b)}}}function f7(e,t,i){const r="visualVariables"in e&&e.visualVariables?e.visualVariables.find((g=>g.type==="opacity")):e;if(!r)return;if(r.declaredClass!=="esri.renderers.visualVariables.OpacityVariable")return void Tw("OpacityVariable");const s=typeof t=="number",n=s?null:t,o=n?.attributes;let a=s?t:null;const l=r.field,{ipData:u,hasExpression:c}=r.cache;let d=r.cache.compiledFunc;if(!l&&!c){const g=r.stops;return g&&g[0]&&g[0].opacity}if(typeof a!="number")if(c){if(i?.arcade==null)return void Ew();const g={viewingMode:i.viewingMode,scale:i.scale,spatialReference:i.spatialReference},_=i.arcade.arcadeUtils,v=_.getViewInfo(g),b=_.createExecContext(n,v,i.timeZone);if(!d){const S=_.createSyntaxTree(r.valueExpression);d=_.createFunction(S),r.cache.compiledFunc=d}a=_.executeFunction(d,b)}else o&&(a=o[l]);const m=r.normalizationField,y=o!=null&&m!=null?parseFloat(o[m]):void 0;if(a!=null&&(!m||s||!isNaN(y)&&y!==0)){fh(y)&&!s&&(a/=y);const g=TP(a,u);if(g){const _=g[0],v=g[1];if(_===v)return r.stops[_].opacity;{const b=r.stops[_].opacity;return b+(r.stops[v].opacity-b)*g[2]}}}}function m7(e,t,i){const r="visualVariables"in e&&e.visualVariables?e.visualVariables.find((y=>y.type==="rotation")):e;if(!r)return;if(r.declaredClass!=="esri.renderers.visualVariables.RotationVariable")return void Tw("RotationVariable");const s=r.axis||"heading",n=s==="heading"&&r.rotationType==="arithmetic"?90:0,o=s==="heading"&&r.rotationType==="arithmetic"?-1:1,a=typeof t=="number"?null:t,l=a?.attributes,u=r.field,{hasExpression:c}=r.cache;let d=r.cache.compiledFunc,m=null;if(!u&&!c)return m;if(c){if(i?.arcade==null)return void Ew();const y={viewingMode:i.viewingMode,scale:i.scale,spatialReference:i.spatialReference},g=i.arcade.arcadeUtils,_=g.getViewInfo(y),v=g.createExecContext(a,_,i.timeZone);if(!d){const b=g.createSyntaxTree(r.valueExpression);d=g.createFunction(b),r.cache.compiledFunc=d}m=g.executeFunction(d,v)}else l&&(m=l[u]);return m=typeof m!="number"||isNaN(m)?null:n+o*m,m}function $ge(e,t,i){const r=typeof t=="number",s=r?null:t,n=s?.attributes;let o=r?t:null;const{isScaleDriven:a}=e.cache;let l=e.cache.compiledFunc;if(a){const c=i?.scale,d=i?.view;o=c==null||d==="3d"?Mge(e):c}else if(!r)switch(e.inputValueType){case ja.Expression:{if(i?.arcade==null)return void Ew();const c={viewingMode:i.viewingMode,scale:i.scale,spatialReference:i.spatialReference},d=i.arcade.arcadeUtils,m=d.getViewInfo(c),y=d.createExecContext(s,m,i.timeZone);if(!l){const g=d.createSyntaxTree(e.valueExpression);l=d.createFunction(g),e.cache.compiledFunc=l}o=d.executeFunction(l,y);break}case ja.Field:n&&(o=n[e.field]);break;case ja.Unknown:o=null}if(!fh(o))return null;if(r||!e.normalizationField)return o;const u=n?parseFloat(n[e.normalizationField]):null;return fh(u)&&u!==0?o/u:null}function Mge(e){let t=null,i=null;const r=e.stops;return r?(t=r[0].value,i=r[r.length-1].value):(t=e.minDataValue||0,i=e.maxDataValue||0),(t+i)/2}function Cw(e,t,i){const r="visualVariables"in e&&e.visualVariables?e.visualVariables.find((n=>n.type==="size")):e;if(!r)return;if(r.declaredClass!=="esri.renderers.visualVariables.SizeVariable")return void Tw("SizeVariable");const s=g7($ge(r,t,i),r,t,i,r.cache.ipData);return s==null||isNaN(s)?void 0:s}function Wr(e,t,i){return e==null?null:Ud(e)?Cw(e,t,i):fh(e)?e:null}function y7(e,t,i){return fh(i)&&e>i?i:fh(t)&&e<t?t:e}function Tge(e,t,i,r){const s=Wr(t.minSize,i,r)||t.minDataValue;return e==null&&s==null?null:(e??0)+(s??0)}function Ege(e,t,i){const r=e.stops;let s=r?.length&&r[0].size;return s==null&&(s=e.minSize),Wr(s,t,i)}function Cge(e,t,i,r){const s=Wr(t.minSize,i,r);if(e==null)return s;const{minDataValue:n,maxDataValue:o}=t;if(n==null||o==null)return null;const a=(e-n)/(o-n),l=Wr(t.maxSize,i,r),u=r?.shape;if(e<=n)return s;if(e>=o)return l;if(s==null||l==null)return null;if(t.scaleBy==="area"&&u){const c=u==="circle",d=c?x1*(s/2)**2:s*s,m=d+a*((c?x1*(l/2)**2:l*l)-d);return c?2*Math.sqrt(m/x1):Math.sqrt(m)}return s+a*(l-s)}function Pge(e,t,i,r){const s=Wr(t.minSize,i,r);if(e==null||s==null)return s;const n=r?.shape,{minDataValue:o}=t;if(o==null)return null;const a=e/o,l=Wr(t.maxSize,i,r);let u=null;return u=n==="circle"?2*Math.sqrt(a*(s/2)**2):n==="square"||n==="diamond"||n==="image"?Math.sqrt(a*s**2):a*s,y7(u,s,l)}function Ige(e,t,i,r,s){if(e==null)return null;const[n,o,a]=TP(e,s);if(n===o)return Wr(t.stops?.[n].size,i,r);{const l=Wr(t.stops?.[n].size,i,r),u=Wr(t.stops?.[o].size,i,r);return l==null||u==null?null:l+(u-l)*a}}function Age(e,t,i,r){const s=(r?.resolution??1)*Mw[t.valueUnit],n=Wr(t.minSize,i,r),o=Wr(t.maxSize,i,r),{valueRepresentation:a}=t;if(e==null)return n;let l=null;return l=a==="area"?2*Math.sqrt(e/x1)/s:a==="radius"||a==="distance"?2*e/s:e/s,y7(l,n,o)}function g7(e,t,i,r,s){switch(t.transformationType){case yi.Additive:return Tge(e,t,i,r);case yi.Constant:return Ege(t,i,r);case yi.ClampedLinear:return Cge(e,t,i,r);case yi.Proportional:return Pge(e,t,i,r);case yi.Stops:return Ige(e,t,i,r,s);case yi.RealWorldSize:return Age(e,t,i,r);case yi.Identity:return e;case yi.Unknown:return null}}function Lge(e,t,i){const{isScaleDriven:r}=e.cache;if(!(r&&i==="3d"||t))return null;const s={scale:t,view:i};let n=Wr(e.minSize,vO,s),o=Wr(e.maxSize,vO,s);if(n!=null||o!=null){if(n>o){const a=o;o=n,n=a}return{minSize:n,maxSize:o}}}function kge(e,t,i){if(!e.visualVariables)return;const r=[],s=[],n=[],o=[],a=[];for(const l of e.visualVariables)switch(l.type){case"color":s.push(l);break;case"opacity":n.push(l);break;case"rotation":a.push(l);break;case"size":o.push(l)}return s.forEach((l=>{const u=p7(l,t,i);r.push({variable:l,value:u})})),n.forEach((l=>{const u=f7(l,t,i);r.push({variable:l,value:u})})),a.forEach((l=>{const u=m7(l,t,i);r.push({variable:l,value:u})})),o.forEach((l=>{const u=Cw(l,t,i);r.push({variable:l,value:u})})),r}function TP(e,t){if(!t)return;let i=0,r=t.length-1;return t.some(((s,n)=>e<s?(r=n,!0):(i=n,!1))),[i,r,(e-t[i])/(t[r]-t[i])]}function Rge(e,t,i){const r=["proportional","proportional","proportional"];for(const s of e){const n=s.useSymbolValue?"symbol-value":Cw(s,t,i)??"proportional";switch(s.axis){case"width":r[0]=n;break;case"depth":r[1]=n;break;case"height":r[2]=n;break;case"width-and-depth":r[0]=n,r[1]=n;break;case"all":case void 0:case null:r[0]=n,r[1]=n,r[2]=n;break;default:s.axis}}return r}const Mh=Object.freeze(Object.defineProperty({__proto__:null,getAllSizes:Rge,getColor:p7,getOpacity:f7,getRotationAngle:m7,getSize:Cw,getSizeForValue:g7,getSizeFromNumberOrVariable:Wr,getSizeRangeAtScale:Lge,getVisualVariableValues:kge,viewScaleRE:d7},Symbol.toStringTag,{value:"Module"}));var pT;const X0=new Ye({width:"width",depth:"depth",height:"height",widthAndDepth:"width-and-depth",all:"all"}),fT=new Ye({unknown:"unknown",inch:"inches",foot:"feet",yard:"yards",mile:"miles","nautical-mile":"nautical-miles",millimeter:"millimeters",centimeter:"centimeters",decimeter:"decimeters",meter:"meters",kilometer:"kilometers"});function bO(e){if(e!=null)return typeof e=="string"||typeof e=="number"?Sge(e):e.type==="size"?Ud(e)?e:(delete(e={...e}).type,new De(e)):void 0}function wO(e,t,i){if(typeof e!="object")return e;const r=new De;return r.read(e,i),r}let De=pT=class extends Xi{constructor(e){super(e),this.axis=null,this.legendOptions=null,this.normalizationField=null,this.scaleBy=null,this.target=null,this.type="size",this.useSymbolValue=null,this.valueExpression=null,this.valueRepresentation=null,this.valueUnit=null}get cache(){return{ipData:this._interpolateData(),hasExpression:!!this.valueExpression,compiledFunc:null,isScaleDriven:this.valueExpression!=null&&d7.test(this.valueExpression)}}set index(e){Ud(this.maxSize)&&(this.maxSize.index=`visualVariables[${e}].maxSize`),Ud(this.minSize)&&(this.minSize.index=`visualVariables[${e}].minSize`),this._set("index",e)}get inputValueType(){return c7(this)}set maxDataValue(e){e&&this.stops&&(H.getLogger(this).warn("cannot set maxDataValue when stops is not null."),e=null),this._set("maxDataValue",e)}set maxSize(e){e&&this.stops&&(H.getLogger(this).warn("cannot set maxSize when stops is not null."),e=null),this._set("maxSize",e)}castMaxSize(e){return bO(e)}readMaxSize(e,t,i){return wO(e,t,i)}set minDataValue(e){e&&this.stops&&(H.getLogger(this).warn("cannot set minDataValue when stops is not null."),e=null),this._set("minDataValue",e)}set minSize(e){e&&this.stops&&(H.getLogger(this).warn("cannot set minSize when stops is not null."),e=null),this._set("minSize",e)}castMinSize(e){return bO(e)}readMinSize(e,t,i){return wO(e,t,i)}get arcadeRequired(){return!!this.valueExpression||this.minSize!=null&&typeof this.minSize=="object"&&this.minSize.arcadeRequired||this.maxSize!=null&&typeof this.maxSize=="object"&&this.maxSize.arcadeRequired}set stops(e){this.minDataValue==null&&this.maxDataValue==null&&this.minSize==null&&this.maxSize==null?e&&Array.isArray(e)&&(e=e.filter((t=>!!t))).sort(((t,i)=>t.value-i.value)):e&&(H.getLogger(this).warn("cannot set stops when one of minDataValue, maxDataValue, minSize or maxSize is not null."),e=null),this._set("stops",e)}get transformationType(){return xge(this,this.inputValueType)}readValueExpression(e,t){return e||t.expression&&"$view.scale"}writeValueExpressionWebScene(e,t,i,r){if(e==="$view.scale"){if(r?.messages){const s=this.index,n=typeof s=="string"?s:`visualVariables[${s}]`;r.messages.push(new j("property:unsupported",this.type+"VisualVariable.valueExpression = '$view.scale' is not supported in Web Scene. Please remove this property to save the Web Scene.",{instance:this,propertyName:n+".valueExpression",context:r}))}}else t[i]=e}readValueUnit(e){return e?fT.read(e):null}clone(){return new pT({axis:this.axis,field:this.field,valueExpression:this.valueExpression,valueExpressionTitle:this.valueExpressionTitle,maxDataValue:this.maxDataValue,maxSize:Ud(this.maxSize)?this.maxSize.clone():this.maxSize,minDataValue:this.minDataValue,minSize:Ud(this.minSize)?this.minSize.clone():this.minSize,normalizationField:this.normalizationField,stops:this.stops?.map((e=>e.clone())),target:this.target,useSymbolValue:this.useSymbolValue,valueRepresentation:this.valueRepresentation,valueUnit:this.valueUnit,legendOptions:this.legendOptions?.clone()})}flipSizes(){if(this.transformationType===yi.ClampedLinear){const{minSize:e,maxSize:t}=this;return this.minSize=t,this.maxSize=e,this}if(this.transformationType===yi.Stops){const e=this.stops;if(!e)return this;const t=e.map((r=>r.size)).reverse(),i=e.length;for(let r=0;r<i;r++)e[r].size=t[r];return this}return this}getAttributeHash(){return`${super.getAttributeHash()}-${this.target}-${this.normalizationField}`}_interpolateData(){return this.stops?.map((e=>e.value||0))}};h([f({readOnly:!0})],De.prototype,"cache",null),h([f({type:X0.apiValues,json:{type:X0.jsonValues,origins:{"web-map":{read:!1}},read:X0.read,write:X0.write}})],De.prototype,"axis",void 0),h([f()],De.prototype,"index",null),h([f({type:String,readOnly:!0})],De.prototype,"inputValueType",null),h([f({type:u7,json:{write:!0}})],De.prototype,"legendOptions",void 0),h([f({type:Number,value:null,json:{write:!0}})],De.prototype,"maxDataValue",null),h([f({type:Number,value:null,json:{write:!0}})],De.prototype,"maxSize",null),h([Ke("maxSize")],De.prototype,"castMaxSize",null),h([Ae("maxSize")],De.prototype,"readMaxSize",null),h([f({type:Number,value:null,json:{write:!0}})],De.prototype,"minDataValue",null),h([f({type:Number,value:null,json:{write:!0}})],De.prototype,"minSize",null),h([Ke("minSize")],De.prototype,"castMinSize",null),h([Ae("minSize")],De.prototype,"readMinSize",null),h([f({type:String,json:{write:!0}})],De.prototype,"normalizationField",void 0),h([f({readOnly:!0})],De.prototype,"arcadeRequired",null),h([f({type:String})],De.prototype,"scaleBy",void 0),h([f({type:[Il],value:null,json:{write:!0}})],De.prototype,"stops",null),h([f({type:["outline"],json:{write:!0}})],De.prototype,"target",void 0),h([f({type:String,readOnly:!0})],De.prototype,"transformationType",null),h([f({type:["size"],json:{type:["sizeInfo"]}})],De.prototype,"type",void 0),h([f({type:Boolean,json:{write:!0,origins:{"web-map":{read:!1}}}})],De.prototype,"useSymbolValue",void 0),h([f({type:String,json:{write:!0}})],De.prototype,"valueExpression",void 0),h([Ae("valueExpression",["valueExpression","expression"])],De.prototype,"readValueExpression",null),h([$e("web-scene","valueExpression")],De.prototype,"writeValueExpressionWebScene",null),h([f({type:["radius","diameter","area","width","distance"],json:{write:!0}})],De.prototype,"valueRepresentation",void 0),h([f({type:fT.apiValues,json:{write:fT.write,origins:{"web-map":{read:!1},"web-scene":{write:!0},"portal-item":{write:!0}}}})],De.prototype,"valueUnit",void 0),h([Ae("valueUnit")],De.prototype,"readValueUnit",null),De=pT=h([I("esri.renderers.visualVariables.SizeVariable")],De);const Oge={color:jl,size:De,opacity:Aa,rotation:Gl},Nge=new Ye({colorInfo:"color",transparencyInfo:"opacity",rotationInfo:"rotation",sizeInfo:"size"}),Dge=/^\[([^\]]+)\]$/i;let $1=class extends le{constructor(){super(...arguments),this.colorVariables=null,this.opacityVariables=null,this.rotationVariables=null,this.sizeVariables=null}set visualVariables(t){if(this._resetVariables(),t=t?.filter((i=>!!i)),t?.length){for(const i of t)switch(i.type){case"color":this.colorVariables.push(i);break;case"opacity":this.opacityVariables.push(i);break;case"rotation":this.rotationVariables.push(i);break;case"size":this.sizeVariables.push(i)}this.sizeVariables.length&&this.sizeVariables.some((i=>!!i.target))&&t.sort(((i,r)=>{let s=null;return s=i.target===r.target?0:i.target?1:-1,s}));for(let i=0;i<t.length;i++)t[i].index=i;this._set("visualVariables",t)}else this._set("visualVariables",t)}readVariables(t,i,r){const{rotationExpression:s,rotationType:n}=i,o=s?.match(Dge),a=o?.[1];if(a&&(t||(t=[]),t.push({type:"rotationInfo",rotationType:n,field:a})),t)return t.map((l=>{const u=Nge.read(l.type),c=Oge[u];c||(H.getLogger(this).warn(`Unknown variable type: ${u}`),r?.messages&&r.messages.push(new Bs("visual-variable:unsupported",`visualVariable of type '${u}' is not supported`,{definition:l,context:r})));const d=new c;return d.read(l,r),d}))}writeVariables(t,i){const r=[];for(const s of t){const n=s.toJSON(i);n&&r.push(n)}return r}_resetVariables(){this.colorVariables=[],this.opacityVariables=[],this.rotationVariables=[],this.sizeVariables=[]}};h([f()],$1.prototype,"visualVariables",null),$1=h([I("esri.renderers.visualVariables.VisualVariableFactory")],$1);const Fge={base:Xi,key:"type",typeMap:{opacity:Aa,color:jl,rotation:Gl,size:De}},bf=e=>{let t=class extends e{constructor(){super(...arguments),this._vvFactory=new $1}set visualVariables(i){this._vvFactory.visualVariables=i,this._set("visualVariables",this._vvFactory.visualVariables)}readVisualVariables(i,r,s){return this._vvFactory.readVariables(i,r,s)}writeVisualVariables(i,r,s,n){r[s]=this._vvFactory.writeVariables(i,n)}get arcadeRequiredForVisualVariables(){return this.visualVariables?.some((({arcadeRequired:i})=>i))??!1}hasVisualVariables(i,r){return i?this.getVisualVariablesForType(i,r).length>0:this.getVisualVariablesForType("size",r).length>0||this.getVisualVariablesForType("color",r).length>0||this.getVisualVariablesForType("opacity",r).length>0||this.getVisualVariablesForType("rotation",r).length>0}getVisualVariablesForType(i,r){return this.visualVariables?.filter((s=>s.type===i&&(typeof r=="string"?s.target===r:r!==!1||!s.target)))??[]}async collectVVRequiredFields(i,r){let s=[];this.visualVariables&&(s=s.concat(this.visualVariables));for(const n of s)n&&(n.field&&fs(i,r,n.field),n.normalizationField&&fs(i,r,n.normalizationField),n.valueExpression&&(zge(n.valueExpression,i,r)||await ur(i,r,n.valueExpression)))}};return h([f({types:[Fge],value:null,json:{write:!0}})],t.prototype,"visualVariables",null),h([Ae("visualVariables",["visualVariables","rotationType","rotationExpression"])],t.prototype,"readVisualVariables",null),h([$e("visualVariables")],t.prototype,"writeVisualVariables",null),t=h([I("esri.renderers.mixins.VisualVariablesMixin")],t),t};function zge(e,t,i){const r=Zse(e);return r!=null&&(fs(t,i,r),!0)}const EP=[252,146,31,255],Vge=[153,153,153,255],Uge={type:"esriSMS",style:"esriSMSCircle",size:6,color:EP,outline:{type:"esriSLS",style:"esriSLSSolid",width:.75,color:[153,153,153,255]}},jge={type:"esriSLS",style:"esriSLSSolid",width:.75,color:EP},Gge={type:"esriSFS",style:"esriSFSSolid",color:[252,146,31,196],outline:{type:"esriSLS",style:"esriSLSSolid",width:.75,color:[255,255,255,191]}},Bge={type:"esriTS",color:[255,255,255,255],font:{family:"arial-unicode-ms",size:10,weight:"bold"},horizontalAlignment:"center",kerning:!0,haloColor:[0,0,0,255],haloSize:1,rotated:!1,text:"",xoffset:0,yoffset:0,angle:0},qge={type:"esriSMS",style:"esriSMSCircle",color:[0,0,0,255],outline:null,size:10.5},Hge={type:"esriSLS",style:"esriSLSSolid",color:[0,0,0,255],width:1.5},Wge={type:"esriSFS",style:"esriSFSSolid",color:[0,0,0,255],outline:null},_7=Ct.fromJSON(Uge),CP=Nt.fromJSON(jge),v7=$r.fromJSON(Gge),Eke=tt.fromJSON(Bge);function Cke(e){if(e==null)return null;switch(e.type){case"mesh":return null;case"point":case"multipoint":return _7;case"polyline":return CP;case"polygon":case"extent":return v7}return null}const Pke=Ct.fromJSON(qge),Ike=Nt.fromJSON(Hge),Ake=$r.fromJSON(Wge),Zge=xr.fromSimpleMarkerSymbol(_7),Yge=Cn.fromSimpleLineSymbol(CP),Jge=zs.fromSimpleFillSymbol(v7),Xge=new Ra({symbolLayers:new ne([new vr({material:{color:EP},edges:new G8({size:We(1),color:new X(Vge)})})])}),Kge=new Cn({symbolLayers:new ne([new _r({material:{color:new X([0,0,0])},size:We(1)})])}),Qge=new zs({symbolLayers:new ne([new vr({outline:{color:new X([0,0,0]),size:We(1)}})])});function Lke(e){if(e==null)return null;switch(e.type){case"mesh":return Xge;case"point":case"multipoint":return Zge;case"polyline":return Yge;case"polygon":case"extent":return Jge}return null}const SO="#useCIMFallbackSymbology()",La={retainId:!1,ignoreDrivers:!1,hasLabelingContext:!0};function Kp(e,t=La){if(!e)return{symbol:null};const{retainId:i=La.retainId,ignoreDrivers:r=La.ignoreDrivers,hasLabelingContext:s=La.hasLabelingContext,retainCIM:n=La.retainCIM,cimFallbackEnabled:o=La.cimFallbackEnabled}=t;let a=null;if(qo(e)||e instanceof Ei)a=e.clone();else if(e.type==="cim"){const l=e.data?.symbol?.type;switch(l){case"CIMPointSymbol":a=n?e.clone():xr.fromCIMSymbol(e);break;case"CIMLineSymbol":o&&(a=Kge.clone(),t?.logWarning?.(SO,"Unsupported CIM line symbology converted to fallback 3D line symbology"));break;case"CIMPolygonSymbol":o&&(a=Qge.clone(),t?.logWarning?.(SO,"Unsupported CIM polygon symbology converted to fallback 3D polygon symbology"))}if(!a)return{error:new j("symbol-conversion:unsupported-cim-symbol",`CIM symbol of type '${l||"unknown"}' is unsupported in 3D`,{symbol:e})}}else if(e instanceof Nt)a=Cn.fromSimpleLineSymbol(e);else if(e instanceof Ct)a=xr.fromSimpleMarkerSymbol(e);else if(e instanceof gr)a=xr.fromPictureMarkerSymbol(e);else if(e instanceof $r)a=t.geometryType&&t.geometryType==="mesh"?Ra.fromSimpleFillSymbol(e):zs.fromSimpleFillSymbol(e);else{if(!(e instanceof tt))return{error:new j("symbol-conversion:unsupported-2d-symbol",`2D symbol of type '${e.type||e.declaredClass}' is unsupported in 3D`,{symbol:e})};a=s?_n.fromTextSymbol(e):xr.fromTextSymbol(e)}return i&&a&&a.type!=="cim"&&(a.id=e.id),!r||a.type==="cim"||a instanceof Ei||a.symbolLayers.forEach((l=>l.ignoreDrivers=!0)),{symbol:a}}function ob(e,t,i,r){const s=b7(e,{},{context:r,isLabelSymbol:!1});s!=null&&wu(i,s,t)}function kke(e,t,i,r){const s=b7(e,{},{context:r,isLabelSymbol:!0});s!=null&&(t[i]=s)}function xO(e){return qo(e)||e instanceof Ei}function e0e(e){return e?.type==="polygon-3d"||e?.type==="line-3d"}function b7(e,t,i){if(e==null)return null;const{context:r,isLabelSymbol:s}=i,n=r?.origin,o=r?.messages;if(n==="web-scene"&&!xO(e)){const a=Kp(e,{retainCIM:!0,hasLabelingContext:s});return a.symbol!=null?a.symbol.write(t,r):(o?.push(new j("symbol:unsupported",`Symbols of type '${e.declaredClass}' are not supported in scenes. Use 3D symbology instead when working with WebScene and SceneView`,{symbol:e,context:r,error:a.error})),null)}return cA(r?.layer)&&e0e(e)?(o?.push(new j("symbol:unsupported",`Symbols of type '${e.declaredClass}' are not supported on layers of type '${r?.layer?.declaredClass}'.`,{symbol:e,context:r})),null):(n==="web-map"||n==="portal-item"&&!cA(r?.layer))&&xO(e)?(o?.push(new j("symbol:unsupported",`Symbols of type '${e.declaredClass}' are not supported in web maps and portal items. Use 2D symbology and CIMSymbol instead when working with MapView`,{symbol:e,context:r})),null):e.write(t,r)}function w7(e,t){return Noe(e,null,t)}const Pw={types:Doe,json:{write:{writer:ob},origins:{"web-scene":{types:SL,write:{writer:ob},read:{reader:Rg({types:SL})}}}}},PP=bE({json:{origins:{"web-scene":{write:{isRequired:!0}}}}},Pw),IP={types:{base:Kt,key:"type",typeMap:{"simple-fill":kc.typeMap["simple-fill"],"picture-fill":kc.typeMap["picture-fill"],"polygon-3d":kc.typeMap["polygon-3d"],cim:kc.typeMap.cim}},json:{write:{writer:ob},origins:{"web-scene":{type:zs,write:{writer:ob}}}}},M1={cast:e=>e==null||typeof e=="string"||typeof e=="number"?e:`${e}`,json:{type:String,write:{writer:(e,t)=>{t.value=e?.toString()}}}};var mT;let bn=mT=class extends ee{constructor(e){super(e),this.description=null,this.label=null,this.minValue=null,this.maxValue=0,this.symbol=null}clone(){return new mT({description:this.description,label:this.label,minValue:this.minValue,maxValue:this.maxValue,symbol:this.symbol?.clone()??null})}getMeshHash(){const e=JSON.stringify(this.symbol);return`${this.minValue}.${this.maxValue}.${e}`}};h([f({type:String,json:{write:!0}})],bn.prototype,"description",void 0),h([f({type:String,json:{write:!0}})],bn.prototype,"label",void 0),h([f({type:Number,json:{read:{source:"classMinValue"},write:{target:"classMinValue"}}})],bn.prototype,"minValue",void 0),h([f({type:Number,json:{read:{source:"classMaxValue"},write:{target:"classMaxValue"}}})],bn.prototype,"maxValue",void 0),h([f(PP)],bn.prototype,"symbol",void 0),bn=mT=h([I("esri.renderers.support.ClassBreakInfo")],bn);var yT;const t0e=cr()({ascendingValues:"ascending-values",descendingValues:"descending-values"});let Km=yT=class extends xt.ClonableMixin(ee){static from(e){return cf(yT,e)}constructor(e){super(e),this.title=null,this.order=null}};h([f({type:String,json:{write:!0}})],Km.prototype,"title",void 0),h([me(t0e)],Km.prototype,"order",void 0),Km=yT=h([I("esri.renderers.support.RendererLegendOptions")],Km);const AP=Km;var gT;const S7="log",T1="percent-of-total",E1="field",K0=new Ye({esriNormalizeByLog:S7,esriNormalizeByPercentOfTotal:T1,esriNormalizeByField:E1}),i0e=Ui(bn);let ri=gT=class extends bf(hs){constructor(e){super(e),this._compiledValueExpression={valueExpression:null,compiledFunction:null},this.backgroundFillSymbol=null,this.classBreakInfos=null,this.defaultLabel=null,this.defaultSymbol=null,this.field=null,this.isMaxInclusive=!0,this.legendOptions=null,this.normalizationField=null,this.normalizationTotal=null,this.type="class-breaks",this.valueExpression=null,this.valueExpressionTitle=null,this._set("classBreakInfos",[])}readClassBreakInfos(e,t,i){if(!Array.isArray(e))return;let r=t.minValue;return e.map((s=>{const n=new bn;return n.read(s,i),n.minValue==null&&(n.minValue=r),n.maxValue==null&&(n.maxValue=n.minValue),r=n.maxValue,n}))}writeClassBreakInfos(e,t,i,r){const s=e.map((n=>n.write({},r)));this._areClassBreaksConsecutive()&&s.forEach((n=>delete n.classMinValue)),t[i]=s}castField(e){return e==null?e:typeof e=="function"?(H.getLogger(this).error(".field: field must be a string value"),null):kg(e)}get minValue(){return this.classBreakInfos&&this.classBreakInfos[0]&&this.classBreakInfos[0].minValue||0}get normalizationType(){let e=this._get("normalizationType");const t=!!this.normalizationField,i=this.normalizationTotal!=null;return t||i?(e=t&&E1||i&&T1||null,t&&i&&H.getLogger(this).warn("warning: both normalizationField and normalizationTotal are set!")):e!==E1&&e!==T1||(e=null),e}set normalizationType(e){this._set("normalizationType",e)}addClassBreakInfo(e,t,i){let r=null;r=typeof e=="number"?new bn({minValue:e,maxValue:t,symbol:uV(i)}):i0e(V(e)),this.classBreakInfos.push(r),this.classBreakInfos.length===1&&this.notifyChange("minValue")}removeClassBreakInfo(e,t){const i=this.classBreakInfos.length;for(let r=0;r<i;r++){const s=[this.classBreakInfos[r].minValue,this.classBreakInfos[r].maxValue];if(s[0]===e&&s[1]===t){this.classBreakInfos.splice(r,1);break}}}getBreakIndex(e,t){return this.valueExpression&&t?.arcade==null&&H.getLogger(this).warn(""),this.valueExpression?this._getBreakIndexForExpression(e,t):this._getBreakIndexForField(e)}async getClassBreakInfo(e,t){let i=t;this.valueExpression&&t?.arcade==null&&(i={...i,arcade:await _u()});const r=this.getBreakIndex(e,i);return r!==-1?this.classBreakInfos[r]:null}getSymbol(e,t){if(this.valueExpression&&t?.arcade==null)return void H.getLogger(this).error("#getSymbol()","Please use getSymbolAsync if valueExpression is used");const i=this.getBreakIndex(e,t);return i>-1?this.classBreakInfos[i].symbol:this.defaultSymbol}async getSymbolAsync(e,t){let i=t;if(this.valueExpression&&t?.arcade==null){const s=await _u(),{arcadeUtils:n}=s;n.hasGeometryOperations(this.valueExpression)&&await n.enableGeometryOperations(),i={...i,arcade:s}}const r=this.getBreakIndex(e,i);return r>-1?this.classBreakInfos[r].symbol:this.defaultSymbol}get symbols(){const e=[];return this.classBreakInfos.forEach((t=>{t.symbol&&e.push(t.symbol)})),this.defaultSymbol&&e.push(this.defaultSymbol),e}getAttributeHash(){return this.visualVariables?.reduce(((e,t)=>e+t.getAttributeHash()),"")??""}getMeshHash(){const e=JSON.stringify(this.backgroundFillSymbol),t=JSON.stringify(this.defaultSymbol),i=`${this.normalizationField}.${this.normalizationType}.${this.normalizationTotal}`;return`${e}.${t}.${this.classBreakInfos.reduce(((r,s)=>r+s.getMeshHash()),"")}.${i}.${this.field}.${this.valueExpression}`}get arcadeRequired(){return this.arcadeRequiredForVisualVariables||!!this.valueExpression}clone(){return new gT({field:this.field,backgroundFillSymbol:this.backgroundFillSymbol?.clone(),defaultLabel:this.defaultLabel,defaultSymbol:this.defaultSymbol?.clone(),valueExpression:this.valueExpression,valueExpressionTitle:this.valueExpressionTitle,classBreakInfos:V(this.classBreakInfos),isMaxInclusive:this.isMaxInclusive,normalizationField:this.normalizationField,normalizationTotal:this.normalizationTotal,normalizationType:this.normalizationType,visualVariables:V(this.visualVariables),legendOptions:V(this.legendOptions),authoringInfo:V(this.authoringInfo)})}async collectRequiredFields(e,t){const i=[this.collectVVRequiredFields(e,t),this.collectSymbolFields(e,t)];await Promise.all(i)}async collectSymbolFields(e,t){const i=[...this.symbols.map((r=>r.collectRequiredFields(e,t))),ur(e,t,this.valueExpression)];fs(e,t,this.field),fs(e,t,this.normalizationField),await Promise.all(i)}_getBreakIndexForExpression(e,t){const{viewingMode:i,scale:r,spatialReference:s,arcade:n,timeZone:o}=t??{},{valueExpression:a}=this;let l=this._compiledValueExpression.valueExpression===a?this._compiledValueExpression.compiledFunction:null;const u=n.arcadeUtils;if(!l){const d=u.createSyntaxTree(a);l=u.createFunction(d),this._compiledValueExpression.compiledFunction=l}this._compiledValueExpression.valueExpression=a;const c=u.executeFunction(l,u.createExecContext(e,u.getViewInfo({viewingMode:i,scale:r,spatialReference:s}),o));return this._getBreakIndexfromInfos(c)}_getBreakIndexForField(e){const t=this.field,i=e.attributes,r=this.normalizationType;let s=parseFloat(i[t]);if(r){const n=this.normalizationTotal,o=parseFloat(this.normalizationField?i[this.normalizationField]:void 0);if(r===S7)s=Math.log(s)*Math.LOG10E;else if(r!==T1||n==null||isNaN(n)){if(r===E1&&!isNaN(o)){if(isNaN(s)||isNaN(o))return-1;s/=o}}else s=s/n*100}return this._getBreakIndexfromInfos(s)}_getBreakIndexfromInfos(e){const t=this.isMaxInclusive;if(e!=null&&typeof e=="number"&&!isNaN(e))for(let i=0;i<this.classBreakInfos.length;i++){const r=[this.classBreakInfos[i].minValue,this.classBreakInfos[i].maxValue];if(r[0]<=e&&(t?e<=r[1]:e<r[1]))return i}return-1}_areClassBreaksConsecutive(){const e=this.classBreakInfos,t=e.length;for(let i=1;i<t;i++)if(e[i-1].maxValue!==e[i].minValue)return!1;return!0}};h([f(IP)],ri.prototype,"backgroundFillSymbol",void 0),h([f({type:[bn],json:{write:{isRequired:!0}}})],ri.prototype,"classBreakInfos",void 0),h([Ae("classBreakInfos")],ri.prototype,"readClassBreakInfos",null),h([$e("classBreakInfos")],ri.prototype,"writeClassBreakInfos",null),h([f({type:String,json:{write:!0}})],ri.prototype,"defaultLabel",void 0),h([f(Pw)],ri.prototype,"defaultSymbol",void 0),h([f({type:String,json:{write:!0}})],ri.prototype,"field",void 0),h([Ke("field")],ri.prototype,"castField",null),h([f({type:Boolean})],ri.prototype,"isMaxInclusive",void 0),h([f({type:AP,json:{write:!0}})],ri.prototype,"legendOptions",void 0),h([f({type:Number,readOnly:!0,value:null,json:{read:!1,write:{overridePolicy(){return this.classBreakInfos.length!==0&&this._areClassBreaksConsecutive()?{enabled:!0}:{enabled:!1}}}}})],ri.prototype,"minValue",null),h([f({type:String,json:{write:!0}})],ri.prototype,"normalizationField",void 0),h([f({type:Number,json:{write:!0}})],ri.prototype,"normalizationTotal",void 0),h([f({type:K0.apiValues,value:null,json:{type:K0.jsonValues,read:K0.read,write:K0.write}})],ri.prototype,"normalizationType",null),h([me({classBreaks:"class-breaks"})],ri.prototype,"type",void 0),h([f({type:String,json:{write:!0}})],ri.prototype,"valueExpression",void 0),h([f({type:String,json:{write:!0}})],ri.prototype,"valueExpressionTitle",void 0),ri=gT=h([I("esri.renderers.ClassBreaksRenderer")],ri);const _T=-3,r0e=_T-1;var $a;(function(e){e[e.ALL=0]="ALL",e[e.SOME=1]="SOME"})($a||($a={}));let s0e=class{get size(){return this._size}constructor(t=10485760){this._maxSize=t,this._db=new Map,this._size=0,this._hit=0,this._miss=0,this._users=new Map,this._sizeLimits=new Map}destroy(){this.clearAll(),this._sizeLimits.clear(),this._users.clear()}register(t){this._users.set(t.id.slice(0,-1),t)}deregister(t){this.clear(t),this._sizeLimits.delete(t),this._users.delete(t.id.slice(0,-1))}get maxSize(){return this._maxSize}set maxSize(t){this._maxSize=Math.max(t,-1),this._checkSize()}getSize(t,i){return this._db.get(t.id+i)?.size??0}put(t,i,r,s,n){i=t.id+i;const o=this._db.get(i);if(o&&(this._size-=o.size,t.size-=o.size,this._db.delete(i),o.entry!==r&&this._notifyRemove(i,o.entry,o.size,$a.ALL)),s>this._maxSize)return void this._notifyRemove(i,r,s,$a.ALL);if(r===void 0)return void console.warn("Refusing to cache undefined entry ");if(!s||s<0)return console.warn(`Refusing to cache entry with size ${s} for key ${i}`),void this._notifyRemove(i,r,0,$a.ALL);const a=1+Math.max(n,r0e)-_T;this._db.set(i,new n0e(r,s,a)),this._size+=s,t.size+=s,this._checkSize()}updateSize(t,i,r,s){i=t.id+i;const n=this._db.get(i);if(n&&n.entry===r){for(this._size-=n.size,t.size-=n.size;s>this._maxSize;){const o=this._notifyRemove(i,r,s,$a.SOME);if(!(o!=null&&o>0))return void this._db.delete(i);s=o}n.size=s,this._size+=s,t.size+=s,this._checkSize()}}pop(t,i){i=t.id+i;const r=this._db.get(i);if(r)return this._size-=r.size,t.size-=r.size,this._db.delete(i),++this._hit,r.entry;++this._miss}get(t,i){i=t.id+i;const r=this._db.get(i);if(r!==void 0)return this._db.delete(i),r.lives=r.lifetime,this._db.set(i,r),++this._hit,r.entry;++this._miss}peek(t,i){const r=this._db.get(t.id+i);return r?++this._hit:++this._miss,r?.entry}get performanceInfo(){const t={Size:Math.round(this._size/1048576)+"/"+Math.round(this._maxSize/1048576)+"MB","Hit rate":Math.round(100*this._getHitRate())+"%",Entries:this._db.size.toString()},i={},r=new Array;this._db.forEach(((o,a)=>{const l=o.lifetime;r[l]=(r[l]||0)+o.size,this._users.forEach((u=>{const{id:c,name:d}=u;if(a.startsWith(c)){const m=i[d]||0;i[d]=m+o.size}}))}));const s={};this._users.forEach((o=>{const a=o.name;if("hitRate"in o&&typeof o.hitRate=="number"&&!isNaN(o.hitRate)&&o.hitRate>0){const l=i[a]||0;i[a]=l,s[a]=Math.round(100*o.hitRate)+"%"}else s[a]="0%"}));const n=Object.keys(i);n.sort(((o,a)=>i[a]-i[o])),n.forEach((o=>t[o]=Math.round(i[o]/2**20)+"MB / "+s[o]));for(let o=r.length-1;o>=0;--o){const a=r[o];a&&(t["Priority "+(o+_T-1)]=Math.round(a/this._size*100)+"%")}return t}resetStats(){this._hit=this._miss=0,this._users.forEach((t=>t.resetHitRate()))}clear(t){const i=t.id;this._db.forEach(((r,s)=>{s.startsWith(i)&&(this._size-=r.size,this._db.delete(s),this._notifyRemove(s,r.entry,r.size,$a.ALL))})),t.size=0}clearAll(){this._db.forEach(((t,i)=>this._notifyRemove(i,t.entry,t.size,$a.ALL))),this._users.forEach((t=>t.size=0)),this._size=0,this._db.clear()}*values(t){for(const[i,r]of this._db)i.startsWith(t.id)&&(yield r.entry)}_getHitRate(){return this._hit/(this._hit+this._miss)}_notifyRemove(t,i,r,s){const n=this._users.get(t.split(oS)[0])?.removeFunc,o=n?.(i,s,r);return typeof o=="number"?o:null}_checkSize(){this._sizeLimits.forEach(((t,i)=>this._checkSizeLimits(t,i))),this._checkSizeLimits(this.maxSize)}setMaxSize(t,i){i==null||i<=0?this._sizeLimits.delete(t):this._sizeLimits.set(t,i)}_checkSizeLimits(t,i){const r=i??this;if(r.size<=t)return;const s=i?.id;let n=!0;for(;n;){n=!1;for(const[o,a]of this._db)if(a.lifetime===0&&(!s||o.startsWith(s))){const l=i??this._users.get(o.split(oS)[0]);if(this._purgeItem(o,a,l),r.size<=.9*t)return;n||=this._db.has(o)}}for(const[o,a]of this._db)if(!s||o.startsWith(s)){const l=i??this._users.get(o.split(oS)[0]);if(this._purgeItem(o,a,l),r.size<=.9*t)return}}_purgeItem(t,i,r){if(this._db.delete(t),i.lives<=1){this._size-=i.size,r&&(r.size-=i.size);const s=this._notifyRemove(t,i.entry,i.size,$a.SOME);s!=null&&s>0&&(this._size+=s,r&&(r.size+=s),i.lives=i.lifetime,i.size=s,this._db.set(t,i))}else--i.lives,this._db.set(t,i)}},n0e=class{constructor(t,i,r){this.entry=t,this.size=i,this.lifetime=r,this.lives=r}};const oS=":";let x7=class{constructor(t,i){this.removeFunc=i,this._storage=new s0e,this.id="",this.name="",this.size=0,this._storage.maxSize=t,this._storage.register(this)}destroy(){this._storage.deregister(this),this._storage.destroy()}put(t,i,r=1){this._storage.put(this,t,i,r,1)}pop(t){return this._storage.pop(this,t)}get(t){return this._storage.get(this,t)}clear(){this._storage.clearAll()}get maxSize(){return this._storage.maxSize}set maxSize(t){this._storage.maxSize=t}resetHitRate(){}},$O=class $7{static parse(t,i,r){const s=[],n=[],o=t.split(";");for(let a=0;a<o.length;a++){const l=o[a];if(l){if(l.includes("po:")){const u=l.slice(3).split("|");if(u.length===3){const[c,d,m]=u,y=a0e(c,d,m);y&&n.push(y)}}else if(l.includes("|")){for(const u of l.split("|"))if(i.has(u)){s.push(u);break}}else if(i.has(l))s.push(l);else if(a===0){s.length=0,s.push(l0e(r));break}}}return new $7(s,n)}constructor(t,i){this.partNames=t,this.overrides=i}};function o0e(e,t){if(e==="DashTemplate")return t.split(" ").map((i=>Number(i)));if(e==="Color"){const i=new X(t).toRgba();return[i[0],i[1],i[2],255*i[3]]}return Number(t)}function a0e(e,t,i){return{primitiveName:e,propertyName:t,value:o0e(t,i),defaultValue:null}}function l0e(e){switch(e){case"esriGeometryPolyline":return"Invalid_L";case"esriGeometryPolygon":return"Invalid_A";default:return"Invalid_P"}}var Pp;let io=(Pp=class{},Pp.instance=new Zr("Etc/UTC"),Pp);function u0e(e){return e instanceof Sh?e===io.instance:e?.toString().toLowerCase()==="unknown"}function Dke(e){return u0e(e)?io.instance:e}function c0e(e){return"timeZone"in e}function h0e(e){return"timeZone"in e}function d0e(e){return"dateFieldsTimeZone"in e}const p0e=new Map;let ab=class C1{static fromJSON(t){return new C1(t.fields,t.timeZoneByFieldName)}static fromLayer(t){return new C1(t.fields??[],TO(t))}static fromLayerJSON(t){return new C1(t.fields??[],TO(t))}constructor(t=[],i){this._fieldsMap=new Map,this._normalizedFieldsMap=new Map,this._dateFieldsSet=new Set,this._numericFieldsSet=new Set,this._requiredFields=null,this.dateFields=[],this.numericFields=[],this.fields=t||[],this._timeZoneByFieldName=i?new Map(i):null;const r=[];for(const s of this.fields){const n=s?.name,o=MO(n);if(n&&o){const a=xc(n);this._fieldsMap.set(n,s),this._fieldsMap.set(a,s),this._normalizedFieldsMap.set(o,s),r.push(`${a}:${s.type}:${this._timeZoneByFieldName?.get(n)}`),BC(s)?(this.dateFields.push(s),this._dateFieldsSet.add(s)):L8(s)&&(this._numericFieldsSet.add(s),this.numericFields.push(s)),fL(s)||mL(s)||(s.editable=s.editable==null||!!s.editable,s.nullable=s.nullable==null||!!s.nullable)}}r.sort(),this.uid=r.join()}get requiredFields(){if(!this._requiredFields){this._requiredFields=[];for(const t of this.fields)fL(t)||mL(t)||t.nullable||une(t)!==void 0||this._requiredFields.push(t)}return this._requiredFields}equals(t){return this.uid===t?.uid}has(t){return this.get(t)!=null}get(t){if(!t)return;let i=this._fieldsMap.get(t);return i||(i=this._fieldsMap.get(xc(t))??this._normalizedFieldsMap.get(MO(t)),i&&this._fieldsMap.set(t,i),i)}getTimeZone(t){const i=this.get(t&&typeof t!="string"?t.name:t);return i?this._timeZoneByFieldName?this._timeZoneByFieldName.get(i.name):i.type==="date"||i.type==="esriFieldTypeDate"?(H.getLogger("esri.layers.support.FieldsIndex").errorOnce(new j("getTimeZone:no-timezone-information",`no time zone information for field '${i.name}'`)),Uo):M7.has(i.type)?fu:null:null}getLuxonTimeZone(t){const i=this.getTimeZone(t);return i?i===fu?io.instance:i===Uo?ui.utcInstance:of(p0e,i,(()=>Zr.create(i))):null}isDateField(t){return this._dateFieldsSet.has(this.get(t))}isTimeOnlyField(t){return k8(this.get(t))}isNumericField(t){return this._numericFieldsSet.has(this.get(t))}normalizeFieldName(t){return this.get(t)?.name??void 0}toJSON(){return{fields:this.fields.map((t=>zy(t)?t.toJSON():t)),timeZoneByFieldName:this._timeZoneByFieldName?Array.from(this._timeZoneByFieldName.entries()):null}}};function xc(e){return e.trim().toLowerCase()}function MO(e){return Kse(e)?.toLowerCase()??""}const M7=new Set(["time-only","date-only","timestamp-offset","esriFieldTypeDateOnly","esriFieldTypeTimeOnly","esriFieldTypeTimestampOffset"]);function TO(e){const t=new Map;if(!e.fields)return t;const i=e.datesInUnknownTimezone===!0,{timeInfo:r,editFieldsInfo:s}=e,n=(r?"startField"in r?r.startField:r.startTimeField:"")??"",o=(r?"endField"in r?r.endField:r.endTimeField:"")??"",a=d0e(e)?e.dateFieldsTimeZone??null:e.dateFieldsTimeReference?k_(e.dateFieldsTimeReference):null,l=s?c0e(s)?s.timeZone??a:s.dateFieldsTimeReference?k_(s.dateFieldsTimeReference):a??Uo:null,u=r?h0e(r)?r.timeZone??a:r.timeReference?k_(r.timeReference):a:null,c=new Map([[xc(s?.creationDateField??""),l],[xc(s?.editDateField??""),l],[xc(n),u],[xc(o),u]]);for(const{name:d,type:m}of e.fields)if(M7.has(m))t.set(d,fu);else if(m!=="date"&&m!=="esriFieldTypeDate")t.set(d,null);else if(i)t.set(d,fu);else{const y=c.get(xc(d??""))??a;t.set(d,y)}return t}var Me;(function(e){e.AsyncNotEnabled="AsyncNotEnabled",e.ModulesNotSupported="ModulesNotSupported",e.CircularModules="CircularModules",e.CannotCompareDateAndTime="CannotCompareDateAndTime",e.NeverReach="NeverReach",e.UnsupportedHashType="UnsupportedHashType",e.InvalidParameter="InvalidParameter",e.FeatureSetDoesNotHaveSubtypes="FeatureSetDoesNotHaveSubtypes",e.UnexpectedToken="UnexpectedToken",e.Unrecognized="Unrecognized",e.UnrecognizedType="UnrecognizedType",e.MaximumCallDepth="MaximumCallDepth",e.BooleanConditionRequired="BooleanConditionRequired",e.TypeNotAllowedInFeature="TypeNotAllowedInFeature",e.KeyMustBeString="KeyMustBeString",e.WrongNumberOfParameters="WrongNumberOfParameters",e.CallNonFunction="CallNonFunction",e.NoFunctionInTemplateLiteral="NoFunctionInTemplateLiteral",e.NoFunctionInDictionary="NoFunctionInDictionary",e.NoFunctionInArray="NoFunctionInArray",e.AssignModuleFunction="AssignModuleFunction",e.LogicExpressionOrAnd="LogicExpressionOrAnd",e.LogicalExpressionOnlyBoolean="LogicalExpressionOnlyBoolean",e.FunctionNotFound="FunctionNotFound",e.InvalidMemberAccessKey="InvalidMemberAccessKey",e.UnsupportedUnaryOperator="UnsupportUnaryOperator",e.InvalidIdentifier="InvalidIdentifier",e.MemberOfNull="MemberOfNull",e.UnsupportedOperator="UnsupportedOperator",e.Cancelled="Cancelled",e.ModuleAccessorMustBeString="ModuleAccessorMustBeString",e.ModuleExportNotFound="ModuleExportNotFound",e.Immutable="Immutable",e.OutOfBounds="OutOfBounds",e.IllegalResult="IllegalResult",e.FieldNotFound="FieldNotFound",e.PortalRequired="PortalRequired",e.LogicError="LogicError",e.ArrayAccessorMustBeNumber="ArrayAccessMustBeNumber",e.KeyAccessorMustBeString="KeyAccessorMustBeString",e.WrongSpatialReference="WrongSpatialReference",e.CannotChangeTimeZoneTime="CannotChangeTimeZoneTime",e.CannotChangeTimeZoneDateOnly="CannotChangeTimeZoneDateOnly"})(Me||(Me={}));const T7={[Me.TypeNotAllowedInFeature]:"Feature attributes only support dates, numbers, strings, guids.",[Me.LogicError]:"Logic error - {reason}",[Me.CannotCompareDateAndTime]:"Cannot compare date or dateonly with timeonly types",[Me.NeverReach]:"Encountered unreachable logic",[Me.AsyncNotEnabled]:"Async Arcade must be enabled for this script",[Me.ModuleAccessorMustBeString]:"Module accessor must be a string",[Me.ModuleExportNotFound]:"Module has no export with provided identifier",[Me.ModulesNotSupported]:"Current profile does not support modules",[Me.ArrayAccessorMustBeNumber]:"Array accessor must be a number",[Me.FunctionNotFound]:"Function not found",[Me.FieldNotFound]:"Key not found - {key}",[Me.CircularModules]:"Circular module dependencies are not allowed",[Me.Cancelled]:"Execution cancelled",[Me.UnsupportedHashType]:"Type not supported in hash function",[Me.IllegalResult]:"Value is not a supported return type",[Me.PortalRequired]:"Portal is required",[Me.InvalidParameter]:"Invalid parameter",[Me.WrongNumberOfParameters]:"Call with wrong number of parameters",[Me.Unrecognized]:"Unrecognized code structure",[Me.UnrecognizedType]:"Unrecognized type",[Me.WrongSpatialReference]:"Cannot work with geometry in this spatial reference. It is different to the execution spatial reference",[Me.BooleanConditionRequired]:"Conditions must use booleans",[Me.NoFunctionInDictionary]:"Dictionaries cannot contain functions.",[Me.NoFunctionInArray]:"Arrays cannot contain functions.",[Me.NoFunctionInTemplateLiteral]:"Template Literals do not expect functions by value.",[Me.KeyAccessorMustBeString]:"Accessor must be a string",[Me.KeyMustBeString]:"Object keys must be a string",[Me.Immutable]:"Object is immutable",[Me.UnexpectedToken]:"Unexpected token",[Me.MemberOfNull]:"Cannot access property of null object",[Me.MaximumCallDepth]:"Exceeded maximum function depth",[Me.OutOfBounds]:"Out of bounds",[Me.InvalidIdentifier]:"Identifier not recognized",[Me.CallNonFunction]:"Expression is not a function",[Me.InvalidMemberAccessKey]:"Cannot access value using a key of this type",[Me.AssignModuleFunction]:"Cannot assign function to module variable",[Me.UnsupportedUnaryOperator]:"Unsupported unary operator",[Me.UnsupportedOperator]:"Unsupported operator",[Me.LogicalExpressionOnlyBoolean]:"Logical expressions must be boolean",[Me.LogicExpressionOrAnd]:"Logical expression can only be combined with || or &&",[Me.CannotChangeTimeZoneTime]:"Cannot change the timezone of a Time",[Me.CannotChangeTimeZoneDateOnly]:"Cannot change the timezone of a DateOnly",[Me.FeatureSetDoesNotHaveSubtypes]:"FeatureSet does not have subtypes"};let f0e=class extends Error{constructor(...t){super(...t)}},EO=class E7 extends f0e{constructor(t,i){super(LP(i)+t.message,{cause:t}),this.loc=null,Error.captureStackTrace&&Error.captureStackTrace(this,E7),i?.loc&&(this.loc=i.loc)}},m0e=class C7 extends Error{constructor(t,i,r,s){super("Execution error - "+LP(r)+mh(T7[i],s)),this.loc=null,this.declaredRootClass="esri.arcade.arcadeexecutionerror",Error.captureStackTrace&&Error.captureStackTrace(this,C7),r?.loc&&(this.loc=r.loc)}};function LP(e){return e&&e.loc?`Line : ${e.loc.start?.line}, ${e.loc.start?.column}: `:""}let zke=class P7 extends Error{constructor(t,i,r,s){super("Compilation error - "+LP(r)+mh(T7[i],s)),this.loc=null,this.declaredRootClass="esri.arcade.arcadecompilationerror",Error.captureStackTrace&&Error.captureStackTrace(this,P7),r?.loc&&(this.loc=r.loc)}},Vke=class I7 extends Error{constructor(){super("Uncompilable code structures"),this.declaredRootClass="esri.arcade.arcadeuncompilableerror",Error.captureStackTrace&&Error.captureStackTrace(this,I7)}};function Uke(e,t,i){return i.declaredRootClass==="esri.arcade.arcadeexecutionerror"||i.declaredRootClass==="esri.arcade.arcadecompilationerror"?i.loc===null&&t?.loc?new EO(i,{cause:i}):i:(i.declaredRootClass==="esri.arcade.featureset.support.featureseterror"||i.declaredRootClass==="esri.arcade.featureset.support.sqlerror"||i.declaredRootClass,t?.loc?new EO(i,{cause:i}):i)}var lb;(function(e){e.UnrecognizedUri="UnrecognizedUri",e.UnsupportedUriProtocol="UnsupportedUriProtocol"})(lb||(lb={}));const y0e={[lb.UnrecognizedUri]:"Unrecognized uri - {uri}",[lb.UnsupportedUriProtocol]:"Unrecognized uri protocol"};let jke=class A7 extends Error{constructor(t,i){super(mh(y0e[t],i)),this.declaredRootClass="esri.arcade.arcademoduleerror",Error.captureStackTrace&&Error.captureStackTrace(this,A7)}};function P1(e){return e.toLowerCase().replaceAll(/[\s-]+/g,"")}let Gke=class{constructor(t,i){const r=new Map;for(const s of t){const n=P1(s);if(r.has(n))throw new Error(`${s} already added as ${r.get(n)}`);r.set(n,s)}if(i!=null)for(const[s,n]of i){const o=P1(s);if(r.has(o))throw new Error(`${s} already associated with ${r.get(o)}`);r.set(o,n)}this._enumMap=r}lookup(t){return this._enumMap.get(P1(t))}get(t){const i=this.lookup(t);if(i==null)throw new m0e(null,Me.InvalidParameter,null);return i}};var ub;(function(e){e.TimeZoneNotRecognized="TimeZoneNotRecognized"})(ub||(ub={}));const g0e={[ub.TimeZoneNotRecognized]:"Timezone identifier has not been recognized."};let _0e=class L7 extends Error{constructor(t,i){super(mh(g0e[t],i)),this.declaredRootClass="esri.arcade.arcadedate.dateerror",Error.captureStackTrace&&Error.captureStackTrace(this,L7)}};function Hh(e,t,i){return e<t?e-t:e>i?e-i:0}function Wh(e,t,i){return e<t?t:e>i?i:e}let Oa=class ii{constructor(t){this._date=t,this.declaredRootClass="esri.arcade.arcadedate"}static fromParts(t=0,i=1,r=1,s=0,n=0,o=0,a=0,l){if(isNaN(t)||isNaN(i)||isNaN(r)||isNaN(s)||isNaN(n)||isNaN(o)||isNaN(a))return null;const u=se.local(t,i).daysInMonth;let c=se.fromObject({day:Wh(r,1,u),year:t,month:Wh(i,1,12),hour:Wh(s,0,23),minute:Wh(n,0,59),second:Wh(o,0,59),millisecond:Wh(a,0,999)},{zone:Qn(l)});return c=c.plus({months:Hh(i,1,12),days:Hh(r,1,u),hours:Hh(s,0,23),minutes:Hh(n,0,59),seconds:Hh(o,0,59),milliseconds:Hh(a,0,999)}),new ii(c)}static get systemTimeZoneCanonicalName(){return Intl.DateTimeFormat().resolvedOptions().timeZone??"system"}static arcadeDateAndZoneToArcadeDate(t,i){const r=Qn(i);return t.isUnknownTimeZone||r===io.instance?ii.fromParts(t.year,t.monthJS+1,t.day,t.hour,t.minute,t.second,t.millisecond,r):new ii(t._date.setZone(r))}static dateJSToArcadeDate(t){return new ii(se.fromJSDate(t,{zone:"system"}))}static dateJSAndZoneToArcadeDate(t,i="system"){const r=Qn(i);return new ii(se.fromJSDate(t,{zone:r}))}static unknownEpochToArcadeDate(t){return new ii(se.fromMillis(t,{zone:io.instance}))}static unknownDateJSToArcadeDate(t){return new ii(se.fromMillis(t.getTime(),{zone:io.instance}))}static epochToArcadeDate(t,i="system"){const r=Qn(i);return new ii(se.fromMillis(t,{zone:r}))}static dateTimeToArcadeDate(t){return new ii(t)}clone(){return new ii(this._date)}changeTimeZone(t){const i=Qn(t);return ii.dateTimeToArcadeDate(this._date.setZone(i))}static dateTimeAndZoneToArcadeDate(t,i){const r=Qn(i);return t.zone===io.instance||r===io.instance?ii.fromParts(t.year,t.month,t.day,t.hour,t.minute,t.second,t.millisecond,r):new ii(t.setZone(r))}static nowToArcadeDate(t){const i=Qn(t);return new ii(se.fromJSDate(new Date,{zone:i}))}static nowUTCToArcadeDate(){return new ii(se.utc())}get isSystem(){return this.timeZone==="system"||this.timeZone===ii.systemTimeZoneCanonicalName}equals(t){return this.isSystem&&t.isSystem?this.toNumber()===t.toNumber():this.isUnknownTimeZone===t.isUnknownTimeZone&&this._date.equals(t._date)}get isUnknownTimeZone(){return this._date.zone===io.instance}get isValid(){return this._date.isValid}get hour(){return this._date.hour}get second(){return this._date.second}get day(){return this._date.day}get dayOfWeekISO(){return this._date.weekday}get dayOfWeekJS(){let t=this._date.weekday;return t>6&&(t=0),t}get millisecond(){return this._date.millisecond}get monthISO(){return this._date.month}get weekISO(){return this._date.weekNumber}get yearISO(){return this._date.weekYear}get monthJS(){return this._date.month-1}get year(){return this._date.year}get minute(){return this._date.minute}get zone(){return this._date.zone}get timeZoneOffset(){return this.isUnknownTimeZone?0:this._date.offset}get timeZone(){if(this.isUnknownTimeZone)return"unknown";if(this._date.zone.type==="system")return"system";const t=this.zone;return t.type==="fixed"?t.fixed===0?"UTC":t.formatOffset(0,"short"):t.name}stringify(){return JSON.stringify(this.toJSDate())}plus(t){return new ii(this._date.plus(t))}diff(t,i){return this._date.diff(t._date,i)[i]}toISODate(){return this._date.toISODate()}toISOString(t){return t?this._date.toISO({suppressMilliseconds:!0,includeOffset:!this.isUnknownTimeZone}):this._date.toISO({includeOffset:!this.isUnknownTimeZone})}toISOTime(t,i){return this._date.toISOTime({suppressMilliseconds:t,includeOffset:i&&!this.isUnknownTimeZone})}toFormat(t,i){return this.isUnknownTimeZone&&(t=t.replaceAll("Z","")),this._date.toFormat(t,i)}toJSDate(){return this._date.toJSDate()}toSQLValue(){return this._date.toFormat("yyyy-LL-dd HH:mm:ss")}toSQLWithKeyword(){return`timestamp '${this.toSQLValue()}'`}toDateTime(){return this._date}toNumber(){return this._date.toMillis()}getTime(){return this._date.toMillis()}toUTC(){return new ii(this._date.toUTC())}toLocal(){return new ii(this._date.toLocal())}toString(){return this.toISOString(!0)}static fromReaderAsTimeStampOffset(t){if(!t)return null;const i=se.fromISO(t,{setZone:!0});return new ii(i)}};function Qn(e,t=!0){if(e instanceof Sh)return e;switch(P1(e)){case"system":return"system";case"utc":return"UTC";case"unknown":return io.instance}if(/^[+-]?[0-9]{1,2}([:][0-9]{2})?$/.test(e)){const r=ui.parseSpecifier("UTC"+(e.startsWith("+")||e.startsWith("-")?"":"+")+e);if(r)return r}const i=Zr.create(e);if(!i.isValid){if(t)throw new _0e(ub.TimeZoneNotRecognized);return null}return i}function CO(e){e=e.replaceAll(/LTS|LT|L{1,4}|l{1,4}/g,"[$&]");let t="";const i=/(\[[^[]*\])|(\\)?([Hh]mm(ss)?|Mo|M{1,4}|Do|DDDo|D{1,4}|d{2,4}|do?|w[o|w]?|W[o|W]?|Qo?|N{1,5}|YYYYYY|YYYYY|YYYY|YY|y{2,4}|yo?|gg(ggg?)?|GG(GGG?)?|e|E|a|A|hh?|HH?|kk?|mm?|ss?|S{1,9}|x|X|zz?|ZZ?|.)/g;for(const r of e.match(i)||[])switch(r){case"D":t+="d";break;case"DD":t+="dd";break;case"DDD":t+="o";break;case"d":t+="c";break;case"ddd":t+="ccc";break;case"dddd":t+="cccc";break;case"M":t+="L";break;case"MM":t+="LL";break;case"MMM":t+="LLL";break;case"MMMM":t+="LLLL";break;case"YY":t+="yy";break;case"Y":case"YYYY":t+="yyyy";break;case"Q":t+="q";break;case"X":case"x":t+=r;break;default:r.length>=2&&r.slice(0,1)==="["&&r.slice(-1)==="]"?t+=`'${r.slice(1,-1)}'`:t+=`'${r}'`}return t}const PO="esri.core.sql.dateonly";let v0e=class rs{constructor(t,i,r){this._year=t,this._month=i,this._day=r,this.declaredRootClass=PO}static isDateOnly(t){return typeof t=="object"&&t!=null&&"declaredRootClass"in t&&t.declaredRootClass===PO}get month(){return this._month}get monthJS(){return this._month-1}get year(){return this._year}get day(){return this._day}get isValid(){return this.toDateTime("unknown").isValid}equals(t){return rs.isDateOnly(t)&&t.day===this.day&&t.month===this.month&&t.year===this.year}clone(){return new rs(this._year,this._month,this._day)}toDateTime(t){return se.fromObject({day:this.day,month:this.month,year:this.year},{zone:Qn(t)})}toDateTimeLuxon(t){return se.fromObject({day:this.day,month:this.month,year:this.year},{zone:Qn(t)})}toString(){return`${this.year.toString().padStart(4,"0")}-${this.month.toString().padStart(2,"0")}-${this.day.toString().padStart(2,"0")}`}toFormat(t=null,i=!0){if(t===null||t==="")return this.toString();if(i&&(t=CO(t)),!t)return"";const r=this.toDateTime("unknown");return Oa.dateTimeToArcadeDate(r).toFormat(t,{locale:Hr(),numberingSystem:"latn"})}toArcadeDate(){const t=this.toDateTime("unknown");return Oa.dateTimeToArcadeDate(t)}toNumber(){return this.toDateTime("unknown").toMillis()}toJSDate(){return this.toDateTime("unknown").toJSDate()}toStorageFormat(){return this.toFormat("yyyy-LL-dd",!1)}toSQLValue(){return this.toFormat("yyyy-LL-dd",!1)}toSQLWithKeyword(){return"date '"+this.toFormat("yyyy-LL-dd",!1)+"'"}plus(t,i){return rs.fromDateTime(this.toUTCDateTime().plus({[t]:i}))}toUTCDateTime(){return se.utc(this.year,this.month,this.day,0,0,0,0)}difference(t,i){switch(i.toLowerCase()){case"days":case"day":case"d":return this.toUTCDateTime().diff(t.toUTCDateTime(),"days").days;case"months":case"month":return this.toUTCDateTime().diff(t.toUTCDateTime(),"months").months;case"minutes":case"minute":case"m":return i==="M"?this.toUTCDateTime().diff(t.toUTCDateTime(),"months").months:this.toUTCDateTime().diff(t.toUTCDateTime(),"minutes").minutes;case"seconds":case"second":case"s":return this.toUTCDateTime().diff(t.toUTCDateTime(),"seconds").seconds;case"milliseconds":case"millisecond":case"ms":default:return this.toUTCDateTime().diff(t.toUTCDateTime(),"milliseconds").milliseconds;case"hours":case"hour":case"h":return this.toUTCDateTime().diff(t.toUTCDateTime(),"hours").hours;case"years":case"year":case"y":return this.toUTCDateTime().diff(t.toUTCDateTime(),"years").years}}static fromMilliseconds(t){const i=se.fromMillis(t,{zone:ui.utcInstance});return i.isValid?rs.fromParts(i.year,i.month,i.day):null}static fromSeconds(t){const i=se.fromSeconds(t,{zone:ui.utcInstance});return i.isValid?rs.fromParts(i.year,i.month,i.day):null}static fromReader(t){if(!t)return null;const i=t.split("-");return i.length!==3?null:new rs(parseInt(i[0],10),parseInt(i[1],10),parseInt(i[2],10))}static fromParts(t,i,r){const s=new rs(t,i,r);return s.isValid===!1?null:s}static fromDateJS(t){return rs.fromParts(t.getFullYear(),t.getMonth()+1,t.getDay())}static fromDateTime(t){return rs.fromParts(t.year,t.month,t.day)}static fromSqlTimeStampOffset(t){return this.fromDateTime(t.toDateTime())}static fromString(t,i=null){if(t===""||t===null)return null;const r=[];if(i)(i=CO(i))&&r.push(i);else if(i===null||i===""){const s=se.fromISO(t,{setZone:!0});return s.isValid?rs.fromParts(s.year,s.month,s.day):null}for(const s of r){const n=se.fromFormat(t,i??s);if(n.isValid)return new rs(n.year,n.month,n.day)}return null}static fromNow(t="system"){const i=se.fromJSDate(new Date).setZone(Qn(t));return new rs(i.year,i.month,i.day)}};function qke(e){if(e==null)return null;switch(e.type){case"polygon":case"multipoint":case"polyline":return e.extent;case"point":return new ke({xmin:e.x,ymin:e.y,xmax:e.x,ymax:e.y,spatialReference:e.spatialReference});case"extent":return e}return null}function Hke(e){if(e==null)return null;const t=e.clone();return e.cache._geVersion!==void 0&&(t.cache._geVersion=e.cache._geVersion),t}function Q0(e){return typeof e=="number"&&isFinite(e)&&Math.floor(e)===e}function IO(e){if(!e)return"";const t=/(a|A|hh?|HH?|mm?|ss?|SSS|S|.)/g;let i="";for(const r of e.match(t)||[])switch(r){case"SSS":case"m":case"mm":case"h":case"hh":case"H":case"HH":case"s":case"ss":i+=r;break;case"A":case"a":i+="a";break;default:i+=`'${r}'`}return i}const AO="esri.core.sql.timeonly";let b0e=class Jn{constructor(t,i,r,s){this._hour=t,this._minute=i,this._second=r,this._millisecond=s,this.declaredRootClass=AO}static isTimeOnly(t){return typeof t=="object"&&t!=null&&"declaredRootClass"in t&&t.declaredRootClass===AO}get hour(){return this._hour}get minute(){return this._minute}get second(){return this._second}get millisecond(){return this._millisecond}equals(t){return Jn.isTimeOnly(t)&&t.hour===this.hour&&t.minute===this.minute&&t.second===this.second&&t.millisecond===this.millisecond}clone(){return new Jn(this.hour,this.minute,this.second,this.millisecond)}isValid(){return Q0(this.hour)&&Q0(this.minute)&&Q0(this.second)&&Q0(this.millisecond)&&this.hour>=0&&this.hour<24&&this.minute>=0&&this.minute<60&&this.second>=0&&this.second<60&&this.millisecond>=0&&this.millisecond<1e3}toString(){return`${this.hour.toString().padStart(2,"0")}:${this.minute.toString().padStart(2,"0")}:${this.second.toString().padStart(2,"0")}`+(this.millisecond>0?"."+this.millisecond.toString().padStart(3,"0"):"")}toSQLValue(){return this.toString()}toSQLWithKeyword(){return`time '${this.hour.toString().padStart(2,"0")}:${this.minute.toString().padStart(2,"0")}:${this.second.toString().padStart(2,"0")}${this.millisecond>0?"."+this.millisecond.toString().padStart(3,"0"):""}'`}toStorageString(){return`${this.hour.toString().padStart(2,"0")}:${this.minute.toString().padStart(2,"0")}:${this.second.toString().padStart(2,"0")}`}toFormat(t=null){return t===null||t===""?this.toString():(t=IO(t))?se.local(1970,1,1,this._hour,this._minute,this._second,this._millisecond).toFormat(t,{locale:Hr(),numberingSystem:"latn"}):""}toNumber(){return this.millisecond+1e3*this.second+1e3*this.minute*60+60*this.hour*60*1e3}static fromParts(t,i,r,s){const n=new Jn(t,i,r,s);return n.isValid()?n:null}static fromReader(t){if(!t)return null;const i=t.split(":");return i.length!==3?null:new Jn(parseInt(i[0],10),parseInt(i[1],10),parseInt(i[2],10),0)}static fromMilliseconds(t){if(t>864e5||t<0)return null;const i=Math.floor(t/1e3%60),r=Math.floor(t/6e4%60),s=Math.floor(t/36e5%24),n=Math.floor(t%1e3);return new Jn(s,r,i,n)}static fromDateJS(t){return new Jn(t.getHours(),t.getMinutes(),t.getSeconds(),t.getMilliseconds())}static fromDateTime(t){return new Jn(t.hour,t.minute,t.second,t.millisecond)}static fromSqlTimeStampOffset(t){return this.fromDateTime(t.toDateTime())}static fromString(t,i=null){if(t===""||t===null)return null;const r=[];i?(i=IO(i))&&r.push(i):i!==null&&i!==""||(r.push("HH:mm:ss"),r.push("HH:mm:ss.SSS"),r.push("hh:mm:ss a"),r.push("hh:mm:ss.SSS a"),r.push("HH:mm"),r.push("hh:mm a"),r.push("H:mm"),r.push("h:mm a"),r.push("H:mm:ss"),r.push("h:mm:ss a"),r.push("H:mm:ss.SSS"),r.push("h:mm:ss.SSS a"));for(const s of r){const n=se.fromFormat(t,s);if(n.isValid)return new Jn(n.hour,n.minute,n.second,n.millisecond)}return null}plus(t,i){switch(t){case"days":case"years":case"months":return this.clone();case"hours":case"minutes":case"seconds":case"milliseconds":return Jn.fromDateTime(this.toUTCDateTime().plus({[t]:i}))}return null}toUTCDateTime(){return se.utc(1970,1,1,this.hour,this.minute,this.second,this.millisecond)}difference(t,i){switch(i.toLowerCase()){case"days":case"day":case"d":return this.toUTCDateTime().diff(t.toUTCDateTime(),"days").days;case"months":case"month":return this.toUTCDateTime().diff(t.toUTCDateTime(),"months").months;case"minutes":case"minute":case"m":return i==="M"?this.toUTCDateTime().diff(t.toUTCDateTime(),"months").months:this.toUTCDateTime().diff(t.toUTCDateTime(),"minutes").minutes;case"seconds":case"second":case"s":return this.toUTCDateTime().diff(t.toUTCDateTime(),"seconds").seconds;case"milliseconds":case"millisecond":case"ms":default:return this.toUTCDateTime().diff(t.toUTCDateTime(),"milliseconds").milliseconds;case"hours":case"hour":case"h":return this.toUTCDateTime().diff(t.toUTCDateTime(),"hours").hours;case"years":case"year":case"y":return this.toUTCDateTime().diff(t.toUTCDateTime(),"years").years}}};const w0e=["geometry","scale","timeProperties"];function Wke(e,t){if(t!=null)for(const i of w0e)t.hasArcadeDependency(i)&&e.add(i);return e}function S0e(e,t){return k7.create(e,t,null,["$feature","$view"])}function x0e(e,t,i){return k7.create(e,t,i,["$feature","$view","$config"])}let k7=class R7{static async create(t,i,r,s){const{arcade:n,Dictionary:o}=await _u();let a;try{a=n.parseScript(t)}catch(y){throw new j("arcade-bad-expression","Failed to parse arcade script",{script:t,error:y})}const l=n.scriptUsesGeometryEngine(a);l&&await n.enableGeometrySupport(),await n.loadDependentModules(new Set,a,null,!1,l);const u={vars:s.reduce(((y,g)=>({...y,[g]:null})),{}),spatialReference:i,useAsync:!1},c=n.compileScript(a,u);let d=null;r!=null&&(d=new o(r),d.immutable=!0);const m=new o;return m.immutable=!1,m.setField("scale",0),new R7(t,n,a,c,i,m,d,o)}constructor(t,i,r,s,n,o,a,l){this.script=t,this._arcade=i,this._syntaxTree=r,this._compiled=s,this._spatialReference=n,this._viewDict=o,this._configDict=a,this._dictionaryCtor=l,this._dependencies=new Map,this._featureReader=new O7,this._dependencies.set("geometry",i.scriptTouchesGeometry(this._syntaxTree)),this._dependencies.set("scale",this._arcade.referencesMember(this._syntaxTree,"scale")),this._dependencies.set("timeProperties",this._arcade.scriptUsesViewProperties(this._syntaxTree,["timeProperties"]))}evaluate(t,i){const r=i.$view?.timeZone;if(i.$view){let s;if(this._viewDict.setField("scale",i.$view.scale),i.$view.timeProperties!=null){const{currentStart:n,currentEnd:o}=i.$view.timeProperties;s=new this._dictionaryCtor({currentStart:n!=null?r!=null?Oa.epochToArcadeDate(n,r):Oa.unknownEpochToArcadeDate(n):void 0,currentEnd:o!=null?r!=null?Oa.epochToArcadeDate(o,r):Oa.unknownEpochToArcadeDate(o):void 0,startIncluded:!0,endIncluded:!0})}this._viewDict.setField("timeProperties",s)}return this._compiled({vars:{$view:this._viewDict,$config:this._configDict,$feature:t},spatialReference:this._spatialReference,timeZone:r})}repurposeFeature(t,i){return this._featureReader.bind(t,i,this._spatialReference),this._featureReader}references(t){return this._dependencies.get(t)??!1}},O7=class{constructor(){this._boundTarget=null,this._boundSchema={fields:null,fieldsIndex:null,spatialReference:null,get geometryType(){return null},get objectIdField(){return null}},this.arcadeDeclaredClass="esri.arcade.Feature",this._contextTimeZone=null}bind(t,i,r){const s=i??new ab(N7(t.attributes));this._boundTarget=t,this._boundSchema.fields=s.fields,this._boundSchema.fieldsIndex=s,this._boundSchema.spatialReference=r}_getField(t){return this._boundSchema.fieldsIndex.get(t)}get contextTimeZone(){return this._contextTimeZone}set contextTimeZone(t){this._contextTimeZone=t}readArcadeFeature(){return this}hasField(t){return this._boundSchema.fieldsIndex.has(t)}geometry(){if("fromJSON"in this._boundTarget)return this._boundTarget.geometry;const t=hh(this._boundTarget.geometry);if(t){if(!this._boundSchema.spatialReference)throw new Error("InternalError: Expected spatial reference to be defined");t.spatialReference=this._boundSchema.spatialReference}return t}isUnknownDateTimeField(t){return this._boundSchema.fieldsIndex.getTimeZone(t)===fu}field(t,i=!0){const r=this._getField(t);if(r){const s=this._boundTarget.attributes[r.name];if(s==null)return null;switch(r.type){case"date-only":case"esriFieldTypeDateOnly":return v0e.fromReader(s);case"time-only":case"esriFieldTypeTimeOnly":return b0e.fromReader(s);case"esriFieldTypeTimestampOffset":case"timestamp-offset":return Oa.fromReaderAsTimeStampOffset(s);case"date":case"esriFieldTypeDate":return this.isUnknownDateTimeField(t)?Oa.unknownEpochToArcadeDate(s):Oa.epochToArcadeDate(s,this.contextTimeZone??On);default:return s}}if(i)throw new Error(`Field ${t} does not exist`);return null}setField(t,i){throw new Error("Unable to update feature attribute values, feature is readonly")}keys(){return this._boundSchema.fieldsIndex.fields.map((t=>t.name))}castToText(t=!1){return JSON.stringify(this._boundTarget)}gdbVersion(){return null}fullSchema(){return this._boundSchema}castAsJson(t=null){return{attributes:this._boundTarget.attributes,geometry:t?.keepGeometryType===!0?this.geometry():this.geometry()?.toJSON()??null}}castAsJsonAsync(t=null,i=null){return Promise.resolve(this.castAsJson(i))}};function N7(e){const t=[];for(const i in e)t.push({name:i,alias:i,type:typeof e[i]=="string"?"esriFieldTypeString":"esriFieldTypeDouble"});return t}let $0e=class D7{static async from(t,i,r){const s=t.dictionary_version?B9.parse(t.dictionary_version):null,n=new Set(t.itemsNames),o={};if(i)for(const d in i)o[d]=i[d];if(t.authoringInfo.configuration)for(const d of t.authoringInfo.configuration)o.hasOwnProperty(d.name)||(o[d.name]=d.value);const a=new Set(t.authoringInfo.symbol);for(const d of Object.keys(r))a.delete(d);a.size&&H.getLogger("esri.renderers.support.DictionaryScriptEvaluator").warnOnce("missing-fields: fieldMap entries for the following symbol fields are missing",{symbolFields:a});const l=await x0e(t.expression,null,o);if(!l)throw new j("dictionary-renderer:expression-error","Unable to create dictionary renderer expression");const u=!s||!s.greaterEqual(4,0);u&&H.getLogger("esri.renderers.support.DictionaryScriptEvaluator").warnOnce("Dictionary script does not support native field types. Applying fallback",{version:s});const c=new M0e(r,u);return new D7(u,n,l,c)}constructor(t,i,r,s){this._requiresFieldCoercionToString=t,this._itemNames=i,this._compiled=r,this._reader=s}get itemNames(){return this._itemNames}evaluate(t,i,r,s){try{return this._reader.bind(t,r,s),this._compiled.evaluate(this._reader,{$view:{scale:i}})}catch(n){H.getLogger("esri.renderers.support.DictionaryScriptEvaluator").warnOnce("arcade: dictionary script evaluation failed",{error:n})}return null}createDictionaryFieldsIndex(t){if(!this._requiresFieldCoercionToString)return new ab(t);const i=t.map((r=>({...r,type:"esriFieldTypeString"})));return new ab(i)}},M0e=class extends O7{constructor(t,i){super(),this._fieldMap=t,this._requiresFieldCoercionToString=i}_getField(t){const i=this._fieldMap[t]??t;return this._boundSchema.fieldsIndex.get(i)}field(t){if(!this._requiresFieldCoercionToString)return super.field(t,!1);const i=this._getField(t);return i==null||this._boundTarget.attributes[i.name]==null?"":""+this._boundTarget.attributes[i.name]}};var LO,kO,RO,OO,Ro,NO,vT,bT,wT,DO,ST,xT,FO,zO,VO,UO,$T,MT,jO,GO,up,Se,$c,cb,BO,Na,qO,HO,jd,TT,WO,ZO,YO,JO,XO,KO,QO,Br,Di,e5,t5,Vs,i5,r5,s5,n5,mn,ky,Mc,Gd,o5,a5,l5,ET,u5,hb,c5,db,Bd,h5,CT,d5,p5;(function(e){e[e.BUTT=0]="BUTT",e[e.ROUND=1]="ROUND",e[e.SQUARE=2]="SQUARE",e[e.UNKNOWN=4]="UNKNOWN"})(LO||(LO={})),(function(e){e[e.BEVEL=0]="BEVEL",e[e.ROUND=1]="ROUND",e[e.MITER=2]="MITER",e[e.UNKNOWN=4]="UNKNOWN"})(kO||(kO={})),(function(e){e[e.SCREEN=0]="SCREEN",e[e.MAP=1]="MAP"})(RO||(RO={})),(function(e){e[e.Tint=0]="Tint",e[e.Ignore=1]="Ignore",e[e.Multiply=99]="Multiply"})(OO||(OO={})),(function(e){e.Both="Both",e.JustBegin="JustBegin",e.JustEnd="JustEnd",e.None="None"})(Ro||(Ro={})),(function(e){e[e.Mosaic=0]="Mosaic",e[e.Centered=1]="Centered"})(NO||(NO={})),(function(e){e[e.Normal=0]="Normal",e[e.Superscript=1]="Superscript",e[e.Subscript=2]="Subscript"})(vT||(vT={})),(function(e){e[e.MSSymbol=0]="MSSymbol",e[e.Unicode=1]="Unicode"})(bT||(bT={})),(function(e){e[e.Unspecified=0]="Unspecified",e[e.TrueType=1]="TrueType",e[e.PSOpenType=2]="PSOpenType",e[e.TTOpenType=3]="TTOpenType",e[e.Type1=4]="Type1"})(wT||(wT={})),(function(e){e[e.Display=0]="Display",e[e.Map=1]="Map"})(DO||(DO={})),(function(e){e.None="None",e.Loop="Loop",e.Oscillate="Oscillate"})(ST||(ST={})),(function(e){e.Linear="Linear",e.EaseIn="EaseIn",e.EaseOut="EaseOut",e.EaseInOut="EaseInOut"})(xT||(xT={})),(function(e){e[e.Z=0]="Z",e[e.X=1]="X",e[e.Y=2]="Y"})(FO||(FO={})),(function(e){e[e.XYZ=0]="XYZ",e[e.ZXY=1]="ZXY",e[e.YXZ=2]="YXZ"})(zO||(zO={})),(function(e){e[e.Rectangle=0]="Rectangle",e[e.RoundedRectangle=1]="RoundedRectangle",e[e.Oval=2]="Oval"})(VO||(VO={})),(function(e){e[e.None=0]="None",e[e.Alpha=1]="Alpha",e[e.Screen=2]="Screen",e[e.Multiply=3]="Multiply",e[e.Add=4]="Add"})(UO||(UO={})),(function(e){e[e.TTB=0]="TTB",e[e.RTL=1]="RTL",e[e.BTT=2]="BTT"})($T||($T={})),(function(e){e[e.None=0]="None",e[e.SignPost=1]="SignPost",e[e.FaceNearPlane=2]="FaceNearPlane"})(MT||(MT={})),(function(e){e[e.Float=0]="Float",e[e.String=1]="String",e[e.Boolean=2]="Boolean"})(jO||(jO={})),(function(e){e[e.Intersect=0]="Intersect",e[e.Subtract=1]="Subtract"})(GO||(GO={})),(function(e){e.OpenEnded="OpenEnded",e.Block="Block",e.Crossed="Crossed"})(up||(up={})),(function(e){e.FullGeometry="FullGeometry",e.PerpendicularFromFirstSegment="PerpendicularFromFirstSegment",e.ReversedFirstSegment="ReversedFirstSegment",e.PerpendicularToSecondSegment="PerpendicularToSecondSegment",e.SecondSegmentWithTicks="SecondSegmentWithTicks",e.DoublePerpendicular="DoublePerpendicular",e.OppositeToFirstSegment="OppositeToFirstSegment",e.TriplePerpendicular="TriplePerpendicular",e.HalfCircleFirstSegment="HalfCircleFirstSegment",e.HalfCircleSecondSegment="HalfCircleSecondSegment",e.HalfCircleExtended="HalfCircleExtended",e.OpenCircle="OpenCircle",e.CoverageEdgesWithTicks="CoverageEdgesWithTicks",e.GapExtentWithDoubleTicks="GapExtentWithDoubleTicks",e.GapExtentMidline="GapExtentMidline",e.Chevron="Chevron",e.PerpendicularWithArc="PerpendicularWithArc",e.ClosedHalfCircle="ClosedHalfCircle",e.TripleParallelExtended="TripleParallelExtended",e.ParallelWithTicks="ParallelWithTicks",e.Parallel="Parallel",e.PerpendicularToFirstSegment="PerpendicularToFirstSegment",e.ParallelOffset="ParallelOffset",e.OffsetOpposite="OffsetOpposite",e.OffsetSame="OffsetSame",e.CircleWithArc="CircleWithArc",e.DoubleJog="DoubleJog",e.PerpendicularOffset="PerpendicularOffset",e.LineExcludingLastSegment="LineExcludingLastSegment",e.MultivertexArrow="MultivertexArrow",e.CrossedArrow="CrossedArrow",e.ChevronArrow="ChevronArrow",e.ChevronArrowOffset="ChevronArrowOffset",e.PartialFirstSegment="PartialFirstSegment",e.Arch="Arch",e.CurvedParallelTicks="CurvedParallelTicks",e.Arc90Degrees="Arc90Degrees",e.TipWithPerpendicularAndTicks="TipWithPerpendicularAndTicks",e.ConcentricCircles="ConcentricCircles",e.DoubleJogArrow="DoubleJogArrow",e.LinkedChevrons="LinkedChevrons",e.SegmentThenHalfCircle="SegmentThenHalfCircle",e.LineWithStraightTicks="LineWithStraightTicks",e.DoubleCurve="DoubleCurve",e.ParallelWithTicksByWidth="ParallelWithTicksByWidth",e.EnclosingRoundedRectangle="EnclosingRoundedRectangle"})(Se||(Se={})),(function(e){e.Mitered="Mitered",e.Bevelled="Bevelled",e.Rounded="Rounded",e.Square="Square",e.TrueBuffer="TrueBuffer"})($c||($c={})),(function(e){e.ClosePath="ClosePath",e.ConvexHull="ConvexHull",e.RectangularBox="RectangularBox"})(cb||(cb={})),(function(e){e.BeginningOfLine="BeginningOfLine",e.EndOfLine="EndOfLine"})(BO||(BO={})),(function(e){e.Mitered="Mitered",e.Bevelled="Bevelled",e.Rounded="Rounded",e.Square="Square"})(Na||(Na={})),(function(e){e.Fast="Fast",e.Accurate="Accurate"})(qO||(qO={})),(function(e){e.BeginningOfLine="BeginningOfLine",e.EndOfLine="EndOfLine"})(HO||(HO={})),(function(e){e.Sinus="Sinus",e.Square="Square",e.Triangle="Triangle",e.Random="Random"})(jd||(jd={})),(function(e){e[e.None=0]="None",e[e.Default=1]="Default",e[e.Force=2]="Force"})(TT||(TT={})),(function(e){e[e.Buffered=0]="Buffered",e[e.Left=1]="Left",e[e.Right=2]="Right",e[e.AlongLine=3]="AlongLine"})(WO||(WO={})),(function(e){e[e.Linear=0]="Linear",e[e.Rectangular=1]="Rectangular",e[e.Circular=2]="Circular",e[e.Buffered=3]="Buffered"})(ZO||(ZO={})),(function(e){e[e.Discrete=0]="Discrete",e[e.Continuous=1]="Continuous"})(YO||(YO={})),(function(e){e[e.AcrossLine=0]="AcrossLine",e[e.AlongLine=1]="AlongLine"})(JO||(JO={})),(function(e){e[e.Auto=0]="Auto",e[e.Clockwise=1]="Clockwise",e[e.Counterclockwise=2]="Counterclockwise"})(XO||(XO={})),(function(e){e[e.Left=0]="Left",e[e.Right=1]="Right",e[e.Center=2]="Center",e[e.Justify=3]="Justify"})(KO||(KO={})),(function(e){e[e.Base=0]="Base",e[e.MidPoint=1]="MidPoint",e[e.ThreePoint=2]="ThreePoint",e[e.FourPoint=3]="FourPoint",e[e.Underline=4]="Underline",e[e.CircularCW=5]="CircularCW",e[e.CircularCCW=6]="CircularCCW"})(QO||(QO={})),(function(e){e.Butt="Butt",e.Round="Round",e.Square="Square"})(Br||(Br={})),(function(e){e.NoConstraint="NoConstraint",e.HalfPattern="HalfPattern",e.HalfGap="HalfGap",e.FullPattern="FullPattern",e.FullGap="FullGap",e.Custom="Custom"})(Di||(Di={})),(function(e){e[e.None=-1]="None",e[e.Custom=0]="Custom",e[e.Circle=1]="Circle",e[e.OpenArrow=2]="OpenArrow",e[e.ClosedArrow=3]="ClosedArrow",e[e.Diamond=4]="Diamond"})(e5||(e5={})),(function(e){e[e.ExtraLeading=0]="ExtraLeading",e[e.Multiple=1]="Multiple",e[e.Exact=2]="Exact"})(t5||(t5={})),(function(e){e.Bevel="Bevel",e.Round="Round",e.Miter="Miter"})(Vs||(Vs={})),(function(e){e[e.Default=0]="Default",e[e.String=1]="String",e[e.Numeric=2]="Numeric"})(i5||(i5={})),(function(e){e[e.InsidePolygon=0]="InsidePolygon",e[e.PolygonCenter=1]="PolygonCenter",e[e.RandomlyInsidePolygon=2]="RandomlyInsidePolygon"})(r5||(r5={})),(function(e){e[e.Tint=0]="Tint",e[e.Replace=1]="Replace",e[e.Multiply=2]="Multiply"})(s5||(s5={})),(function(e){e[e.ClipAtBoundary=0]="ClipAtBoundary",e[e.RemoveIfCenterOutsideBoundary=1]="RemoveIfCenterOutsideBoundary",e[e.DoNotTouchBoundary=2]="DoNotTouchBoundary",e[e.DoNotClip=3]="DoNotClip"})(n5||(n5={})),(function(e){e.NoConstraint="NoConstraint",e.WithMarkers="WithMarkers",e.WithFullGap="WithFullGap",e.WithHalfGap="WithHalfGap",e.Custom="Custom"})(mn||(mn={})),(function(e){e.Fixed="Fixed",e.Random="Random",e.RandomFixedQuantity="RandomFixedQuantity"})(ky||(ky={})),(function(e){e.LineMiddle="LineMiddle",e.LineBeginning="LineBeginning",e.LineEnd="LineEnd",e.SegmentMidpoint="SegmentMidpoint"})(Mc||(Mc={})),(function(e){e.OnPolygon="OnPolygon",e.CenterOfMass="CenterOfMass",e.BoundingBoxCenter="BoundingBoxCenter"})(Gd||(Gd={})),(function(e){e[e.Low=0]="Low",e[e.Medium=1]="Medium",e[e.High=2]="High"})(o5||(o5={})),(function(e){e[e.MarkerCenter=0]="MarkerCenter",e[e.MarkerBounds=1]="MarkerBounds"})(a5||(a5={})),(function(e){e[e.None=0]="None",e[e.PropUniform=1]="PropUniform",e[e.PropNonuniform=2]="PropNonuniform",e[e.DifUniform=3]="DifUniform",e[e.DifNonuniform=4]="DifNonuniform"})(l5||(l5={})),(function(e){e.Tube="Tube",e.Strip="Strip",e.Wall="Wall"})(ET||(ET={})),(function(e){e[e.Random=0]="Random",e[e.Increasing=1]="Increasing",e[e.Decreasing=2]="Decreasing",e[e.IncreasingThenDecreasing=3]="IncreasingThenDecreasing"})(u5||(u5={})),(function(e){e[e.Relative=0]="Relative",e[e.Absolute=1]="Absolute"})(hb||(hb={})),(function(e){e[e.Normal=0]="Normal",e[e.LowerCase=1]="LowerCase",e[e.Allcaps=2]="Allcaps"})(c5||(c5={})),(function(e){e[e.LTR=0]="LTR",e[e.RTL=1]="RTL"})(db||(db={})),(function(e){e.Draft="Draft",e.Picture="Picture",e.Text="Text"})(Bd||(Bd={})),(function(e){e[e.Top=0]="Top",e[e.Center=1]="Center",e[e.Baseline=2]="Baseline",e[e.Bottom=3]="Bottom"})(h5||(h5={})),(function(e){e[e.Right=0]="Right",e[e.Upright=1]="Upright"})(CT||(CT={})),(function(e){e[e.Small=0]="Small",e[e.Medium=1]="Medium",e[e.Large=2]="Large"})(d5||(d5={})),(function(e){e[e.Calm=0]="Calm",e[e.Rippled=1]="Rippled",e[e.Slight=2]="Slight",e[e.Moderate=3]="Moderate"})(p5||(p5={}));const T0e={color:[128,128,128,1],outlinecolor:[0,0,0,1],backgroundcolor:[128,128,128,1],borderlinecolor:[0,0,0,1],tintcolor:[255,255,255,1]},ti={CIMVectorMarker:{scalesymbolsproportionally:!1,respectframe:!0,anchorpointunits:"Relative",offsetx:0,offsety:0,rotateclockwise:!1,rotation:0,size:10,enable:!0,colorlocked:!1},CIMPictureMarker:{scalex:1,texturefilter:"Draft",anchorpointunits:"Relative",offsetx:0,offsety:0,rotateclockwise:!1,rotation:0,size:10,enable:!0,colorlocked:!1},CIMTextSymbol:{angle:0,anglex:0,angley:0,halosize:1,height:10,horizontalalignment:"Left",kerning:!0,letterspacing:0,letterwidth:100,ligatures:!0,linegap:0,offsetx:0,offsety:0,strikethrough:!1,textcase:"Normal",textstring:"",underline:!1,verticalalignment:"Bottom",enable:!0,colorlocked:!1},CIMSolidStroke:{capstyle:"Round",joinstyle:"Round",miterlimit:4,width:4,enable:!0,colorlocked:!1},CIMPictureStroke:{texturefilter:"Draft",capstyle:"Round",joinstyle:"Round",miterlimit:4,width:4,enable:!0,colorlocked:!1},CIMGradientStroke:{capstyle:"Round",joinstyle:"Round",miterlimit:4,width:4,enable:!0,colorlocked:!1,gradientMethod:"AcrossLine",gradientSize:75,gradientSizeUnits:hb.Relative,gradientType:"Discrete",interval:5},CIMSolidFill:{enable:!0,colorlocked:!1},CIMPictureFill:{offsetx:0,offsety:0,rotation:0,scalex:1,height:10,texturefilter:"Draft",enable:!0,colorlocked:!1},CIMHatchFill:{offsetx:0,offsety:0,rotation:0,separation:4,enable:!0,colorlocked:!1},CIMGradientFill:{enable:!0,angle:90,gradientMethod:"Linear",gradientSize:75,gradientSizeUnits:hb.Relative,gradientType:"Discrete",interval:5},CIMGeometricEffectAddControlPoints:{angletolerance:120},CIMGeometricEffectArrow:{arrowtype:"OpenEnded",width:5},CIMGeometricEffectBuffer:{size:1},CIMGeometricEffectCut:{begincut:1,endcut:1,middlecut:0,invert:!1},CIMGeometricEffectDashes:{customendingoffset:0,linedashending:"NoConstraint",offsetalongline:0},CIMGeometricEffectDonut:{method:"Mitered",option:"Accurate",width:2},CIMGeometricEffectJog:{angle:225,length:20,position:50},CIMGeometricEffectControlMeasureLine:{rule:"FullGeometry"},CIMGeometricEffectMove:{offsetx:1,offsety:-1},CIMGeometricEffectOffset:{method:"Square",offset:1,option:"Fast"},CIMGeometricEffectRadial:{angle:0,length:5},CIMGeometricEffectRotate:{angle:15},CIMGeometricEffectScale:{xscalefactor:1.15,yscalefactor:1.15},CIMGeometricEffectWave:{amplitude:2,period:3,seed:1,waveform:"Sinus"},CIMMarkerPlacementAlongLine:{customendingoffset:0,endings:"WithHalfGap",offsetalongline:0,placeperpart:!0,angletoline:!0,offset:0},CIMMarkerPlacementAtExtremities:{extremityplacement:"Both",offsetalongline:0,angletoline:!0,offset:0},CIMMarkerPlacementAtRatioPositions:{beginposition:0,endposition:0,flipfirst:!0,angletoline:!0,offset:0},CIMMarkerPlacementInsidePolygon:{gridangle:0,gridtype:"Fixed",offsetx:0,offsety:0,randomness:100,seed:0,shiftoddrows:!1,stepx:16,stepy:16,clipping:"ClipAtBoundary"},CIMMarkerPlacementOnLine:{relativeto:"LineMiddle",startpointoffset:0,angletoline:!0,offset:0},CIMMarkerPlacementOnVertices:{placeperpart:!0,placeoncontrolpoints:!0,placeonendpoints:!0,placeonregularvertices:!0,angletoline:!0,offset:0},CIMMarkerPlacementPolygonCenter:{method:"OnPolygon",offsetx:0,offsety:0,clipatboundary:!1},CIMAnimatedSymbolProperties:{playanimation:!1,reverseanimation:!1,randomizestarttime:!1,randomizestartseed:0,starttimeoffset:0,duration:3,endingduration:3,useendingduration:!1,repeattype:ST.Loop,repeatdelay:0,easing:xT.Linear},CIMSymbolAnimationSize:{tosize:10},CIMSymbolAnimationScale:{scalefactor:1},CIMSymbolAnimationColor:{tocolor:[255,255,255,1]},CIMSymbolAnimationTransparency:{totransparency:0},CIMSymbolAnimationRotation:{torotation:0,rotateclockwise:!1},CIMSymbolAnimationOffset:{offsetx:0,offsety:0},CIMSymbolAnimationMoveAlongLine:{speed:30,distanceAlong:100}};function E0e(e){return typeof e=="function"}function Jke(e,t,i,r){return E0e(e)?e(t,i,r):e}function Xke(e){return[e.r,e.g,e.b,e.a]}const C0e=` /-,
`;function f5(e){let t=e.length;for(;t--;)if(!C0e.includes(e.charAt(t)))return!1;return!0}function P0e(e,t){const i=[];let r=0,s=-1;do if(s=e.indexOf("[",r),s>=r){if(s>r){const n=e.slice(r,s);i.push([n,null,f5(n)])}if(r=s+1,s=e.indexOf("]",r),s>=r){if(s>r){const n=t[e.slice(r,s)];n&&i.push([null,n,!1])}r=s+1}}while(s!==-1);if(r<e.length){const n=e.slice(r);i.push([n,null,f5(n)])}return i}function Kke(e,t,i){let r="",s=null;for(const n of t){const[o,a,l]=n;if(o!=null&&o!=="")l?s=o:(s!=null&&(r+=s,s=null),r+=o);else{const u=e.readAttribute(a);u!=null&&u!==""&&(s!==null&&(r+=s,s=null),r+=u)}}return F7(r,i)}function I0e(e,t,i,r){let s="",n=null;for(const o of t){const[a,l,u]=o;if(a!=null&&a!=="")u?n=a:(n!=null&&(s+=n,n=null),s+=a);else{let c=l;i!=null&&(c=B0e(l,i));const d=e.attributes[c];d!=null&&d!==""&&(n!=null&&(s+=n,n=null),s+=d)}}return F7(s,r)}function F7(e,t){switch(typeof e!="string"&&(e=String(e)),t){case"LowerCase":return e.toLowerCase();case"Allcaps":return e.toUpperCase();default:return e}}function Qke(e,t,i,r,s,n,o=!0){const a=t/s,l=i/n,u=Math.ceil(a/2),c=Math.ceil(l/2);for(let d=0;d<n;d++)for(let m=0;m<s;m++){const y=4*(m+(o?n-d-1:d)*s);let g=0,_=0,v=0,b=0,S=0,$=0,E=0;const C=(d+.5)*l;for(let P=Math.floor(d*l);P<(d+1)*l;P++){const k=Math.abs(C-(P+.5))/c,F=(m+.5)*a,D=k*k;for(let U=Math.floor(m*a);U<(m+1)*a;U++){let W=Math.abs(F-(U+.5))/u;const Y=Math.sqrt(D+W*W);Y>=-1&&Y<=1&&(g=2*Y*Y*Y-3*Y*Y+1,g>0&&(W=4*(U+P*t),E+=g*e[W+3],v+=g,e[W+3]<255&&(g=g*e[W+3]/250),b+=g*e[W],S+=g*e[W+1],$+=g*e[W+2],_+=g))}}r[y]=b/_,r[y+1]=S/_,r[y+2]=$/_,r[y+3]=E/v}}function z7(e){return e?[e[0],e[1],e[2],e[3]/255]:[0,0,0,0]}function kP(e){return e.data?.symbol??null}function RP(e){return e.type==="CIMVectorMarker"||e.type==="CIMPictureMarker"||e.type==="CIMBarChartMarker"||e.type==="CIMCharacterMarker"||e.type==="CIMPieChartMarker"||e.type==="CIMStackedBarChartMarker"}function V7(e){return e.type==="CIMGradientStroke"||e.type==="CIMPictureStroke"||e.type==="CIMSolidStroke"}function A0e(e){return e!=null&&(e.type==="CIMGradientFill"||e.type==="CIMHatchFill"||e.type==="CIMPictureFill"||e.type==="CIMSolidFill"||e.type==="CIMWaterFill")}function Iw(e){return e!=null&&(e.type==="CIMMarkerPlacementAlongLineRandomSize"||e.type==="CIMMarkerPlacementAlongLineSameSize"||e.type==="CIMMarkerPlacementAlongLineVariableSize"||e.type==="CIMMarkerPlacementAtExtremities"||e.type==="CIMMarkerPlacementAtMeasuredUnits"||e.type==="CIMMarkerPlacementAtRatioPositions"||e.type==="CIMMarkerPlacementOnLine"||e.type==="CIMMarkerPlacementOnVertices")}const be=(e,t=0)=>e==null||isNaN(e)?t:e,eRe=(e,t)=>e??t,tRe=(e,t)=>e??t,iRe=e=>e.tintColor?z7(e.tintColor):[255,255,255,1],L0e=e=>{if(!e)return!1;for(const t of e)switch(t.type){case"CIMGeometricEffectBuffer":case"CIMGeometricEffectDonut":case"CIMGeometricEffectOffset":case"CIMGeometricEffectTaperedPolygon":case"CIMGeometricEffectEnclosingPolygon":return!0}return!1};function k0e(){return J(()=>import("./geometryEngineJSON-CO8CMyeT.js").then(e=>e.g),__vite__mapDeps([26,18,19,27]))}function R0e(e){if(!e)return"normal";switch(e.toLowerCase()){case"italic":return"italic";case"oblique":return"oblique";default:return"normal"}}function O0e(e){if(!e)return"normal";switch(e.toLowerCase()){case"bold":return"bold";case"bolder":return"bolder";case"lighter":return"lighter";default:return"normal"}}function U7(e){let t="normal",i="normal";if(e){const r=e.toLowerCase();r.includes("italic")?t="italic":r.includes("oblique")&&(t="oblique"),r.includes("bold")?i="bold":r.includes("light")&&(i="lighter")}return{style:t,weight:i}}function j7(e){return e.underline?"underline":e.strikethrough?"line-through":"none"}function Ry(e){if(!e)return null;switch(e.type){case"CIMPolygonSymbol":if(e.symbolLayers)for(const t of e.symbolLayers){const i=Ry(t);if(i!=null)return i}break;case"CIMTextSymbol":return Ry(e.symbol);case"CIMSolidFill":return e.color}return null}function pb(e){if(e)switch(e.type){case"CIMPolygonSymbol":case"CIMLineSymbol":{const t=e.symbolLayers;if(t)for(const i of t){const r=pb(i);if(r!=null)return r}break}case"CIMTextSymbol":return pb(e.symbol);case"CIMSolidStroke":return e.color}}function rRe(e){for(const t of e)if(t.enable)switch(t.type){case"CIMSolidStroke":case"CIMGradientStroke":case"CIMPictureStroke":return!0}return!1}function fb(e){if(e)switch(e.type){case"CIMPolygonSymbol":case"CIMLineSymbol":if(e.symbolLayers)for(const t of e.symbolLayers){const i=fb(t);if(i!==void 0)return i}break;case"CIMTextSymbol":return fb(e.symbol);case"CIMSolidStroke":case"CIMGradientStroke":case"CIMPictureStroke":return e.width}}function N0e(e){switch(e){case"Left":default:return"left";case"Right":return"right";case"Center":case"Justify":return"center"}}function D0e(e){switch(e){case"Top":default:return"top";case"Center":return"middle";case"Baseline":return"baseline";case"Bottom":return"bottom"}}function F0e(e){return(e?Object.keys(e):[]).map((t=>({name:t,alias:t,type:typeof e[t]=="string"?"esriFieldTypeString":"esriFieldTypeDouble"})))}const Zh=e=>e.includes("data:image/svg+xml");function mb(e){if(!e)return null;switch(e.type){case"CIMPointSymbol":case"CIMTextSymbol":return"esriGeometryPoint";case"CIMLineSymbol":return"esriGeometryPolyline";case"CIMPolygonSymbol":return"esriGeometryPolygon";default:return null}}function s0(e){return e&&e.charAt(0).toLowerCase()+e.slice(1)}function sRe(e,t,i,r,s,n,o=!0){const{infos:a}=n;let l=1,u=0,c=0,d=0,m=1;for(const{absoluteAnchorPoint:_,offsetX:v,offsetY:b,rotation:S,size:$,frameHeight:E,rotateClockWise:C,scaleSymbolsProportionally:P}of a)m=_?1:l,c=g5(v,b,u,m,c),d=y5(v,b,u,m,d),E&&(P||o)&&(l*=$/E),u=_5(S,C,u);const y=g5(r,s,u,m,c),g=y5(r,s,u,m,d);return{size:e*l,rotation:_5(t,i,u),offsetX:y,offsetY:g}}function z0e(e){if(e==null)return!1;if(Array.isArray(e))return e.every((t=>z0e(t)));switch(typeof e){case"string":return!!e;case"number":return!isNaN(e)}}function V0e(e,t){if(t==="color"||t==="outlinecolor"||t==="backgroundcolor"||t==="borderlinecolor"||t==="tintcolor")return[...T0e[t]];const i=ti[e];if(!i)throw new Error(`InternalError: default value for type ${e}.`);return i[t]}function U0e(e){return e.split(" ").map((t=>Number(t)))}function j0e(e){return typeof e=="string"?U0e(e):e}function G7(e){return e?.dashTemplate&&(e.dashTemplate=j0e(e.dashTemplate)),e}function PT(e){if(e==null)return"Normal";switch(e.type){case"CIMTextSymbol":return e.textCase??"Normal";case"CIMPointSymbol":case"CIMLineSymbol":case"CIMPolygonSymbol":{const t=e.symbolLayers;if(!t)return"Normal";for(const i of t)if(i.type==="CIMVectorMarker")return PT(i)}break;case"CIMVectorMarker":{const t=e.markerGraphics;if(!t)return"Normal";for(const i of t)if(i.symbol)return PT(i.symbol)}}return"Normal"}function G0e(e){if(e)switch(e.type){case"CIMTextSymbol":return e.height;case"CIMPointSymbol":{let t=0;if(e.symbolLayers){for(const i of e.symbolLayers)if(i)switch(i.type){case"CIMCharacterMarker":case"CIMPictureMarker":case"CIMVectorMarker":case"CIMObjectMarker3D":case"CIMglTFMarker3D":{const r=i.size??ti.CIMVectorMarker.size;r>t&&(t=r);break}}}return t}case"CIMLineSymbol":case"CIMPolygonSymbol":{let t=0;if(e.symbolLayers){for(const i of e.symbolLayers)if(i)switch(i.type){case"CIMSolidStroke":case"CIMPictureStroke":case"CIMGradientStroke":{const r=i.width;r!=null&&r>t&&(t=r);break}case"CIMCharacterMarker":case"CIMPictureMarker":case"CIMVectorMarker":case"CIMObjectMarker3D":case"CIMglTFMarker3D":if(i.markerPlacement&&Iw(i.markerPlacement)){const r=i.size??ti.CIMVectorMarker.size;r>t&&(t=r)}break;case"CIMPictureFill":{const r=i.height;r!=null&&r>t&&(t=r)}}}return t}}}function B0e(e,t){if(t!==null){const i=t.get(e);return i?i.name:e}return e}function q0e(e){return e.map((t=>({...t,propertyName:s0(t.propertyName)})))}function m5(e){const t={};for(const i in e){const r=e[i];t[s0(i)]=r}return t}function y5(e,t,i,r,s){const n=i*Math.PI/180;if(n){const o=Math.cos(n);return(Math.sin(n)*e+o*t)*r+s}return t*r+s}function g5(e,t,i,r,s){const n=i*Math.PI/180;return n?(Math.cos(n)*e-Math.sin(n)*t)*r+s:e*r+s}function _5(e,t,i){return t?i-e:i+e}function nRe(e,t,i){const r=i==="Color"||i==="TintColor"||i==="ToColor",s=i==="Rotation"||i==="Angle"||i==="ToRotation";let n=t[s0(i)];if(n!=null&&(r?n=[n[0]/255,n[1]/255,n[2]/255,n[3]/255]:s&&(n*=Math.PI/180)),n==null&&(n=V0e(t.type,i.toLowerCase()),n!=null&&(r?n=[n[0]/255,n[1]/255,n[2]/255,n[3]]:s&&(n*=Math.PI/180))),t.primitiveName!=null){const o=e[t.primitiveName];if(o!=null){const a=o[i];a==null||(typeof a=="string"||typeof a=="number"||Array.isArray(a)?(n=a,n!=null&&(r?n=[n[0]/255,n[1]/255,n[2]/255,n[3]/255]:s&&(n*=Math.PI/180))):(n={valueExpressionInfo:a,defaultValue:n},n!=null&&(r?n={type:"Process",op:"ArcadeColor",value:n}:s&&(n={type:"Process",op:"Divide",left:n,right:180/Math.PI}))))}}if(n==null)throw new Error(`Failed to derive a value or an expression for "${i}".`);return n}function oRe(e,t,i){if(t[s0(i)]!=null)return!0;if(t.primitiveName!=null){const r=e[t.primitiveName];if(r!=null&&r[i]!=null)return!0}return!1}function em(e,t){return Math.max(Math.min((e??t)/100,1),0)}const H0e={type:"CIMSimpleLineCallout",lineSymbol:{type:"CIMLineSymbol",symbolLayers:[{type:"CIMSolidStroke",width:.5,color:[0,0,0,255]}]}};let B7=class{constructor(t,i,r,s){this.url=t,this.fieldMap=r,this.dictionaryInfo=s,this._symbolPartCache=new x7(100);const n=async()=>$0e.from(await s,i,r);this._evaluator=n()}async getSymbolAsync(t,i,r=!0){const s=await this._evaluator,n=i?.fields??N7(t.attributes),o=s.createDictionaryFieldsIndex(n),a=s.evaluate(t,i?.scale??0,o,i?.spatialReference);if(a==null)return null;const l=sw(t.geometry),u=$O.parse(a,s.itemNames,l),c=l==="esriGeometryPoint"&&!t.geometry?.hasZ;return await this._cimPartsToCIMSymbol(t,u.partNames,u.overrides,c,i,r,o)}async getSymbolForControlString(t,i,r){const s=await this._evaluator,n=$O.parse(t,s.itemNames,i),o=i==="esriGeometryPoint"&&!r,a=v5(await Promise.all(n.partNames.map((l=>this._getSymbolPart(l)))),n.overrides,o);return new er({data:a})}async _cimPartsToCIMSymbol(t,i,r,s,n,o,a){const l=i.map((d=>this._getSymbolPart(d,n)));let u=await Promise.all(l);if(o&&this.fieldMap&&u.length>0){const{OverrideHelper:d}=await J(()=>Promise.resolve().then(()=>axe),void 0);u=V(u);for(const m of u)d.applyDictionaryTextOverrides(m,t,this.fieldMap,a,PT(m))}const c=v5(u,r,s);return new er({data:c})}async _fetchSymbolPart(t,i){const r=await this.dictionaryInfo,s=(this.url+"/"+r.cimRefTemplateUrl).replaceAll(/\{itemName\}/gi,t),{data:n}=await at(s,{responseType:"json",query:{f:"json"},...i});return n}async _getSymbolPart(t,i){let r=this._symbolPartCache.get(t);return r||(r=this._fetchSymbolPart(t,i),this._symbolPartCache.put(t,r)),r}};function v5(e,t,i){if(!e||e.length===0)return null;const r={...e[0]};if(e.length>1){r.effects=null,r.symbolLayers=[];for(const s of e){const n=s;if(n.effects!=null)for(const o of n.symbolLayers)o.effects==null?o.effects=n.effects:o.effects.unshift(...n.effects);r.symbolLayers.unshift(...n.symbolLayers)}}return i&&(r.callout=H0e),{type:"CIMSymbolReference",symbol:r,primitiveOverrides:t}}var IT;let pn=IT=class extends bf(hs){constructor(e){super(e),this.config=null,this.fieldMap=null,this.scaleExpression=null,this.scaleExpressionTitle=null,this.url=null,this.type="dictionary"}get _loader(){const e=this.getDictionaryInfo();return new B7(this.url,this.config,this.fieldMap??{},e)}writeData(e,t){e&&(t.scalingExpressionInfo={expression:e,returnType:"number"})}writeVisualVariables(e,t,i,r){r?.origin||super.writeVisualVariables(e,t,i,r)}clone(){return new IT({config:V(this.config),scaleExpression:this.scaleExpression,scaleExpressionTitle:this.scaleExpressionTitle,fieldMap:V(this.fieldMap),url:V(this.url),visualVariables:V(this.visualVariables)})}async getSymbolAsync(e,t,i=!0){return this._loader.getSymbolAsync(e,t,i)}async getSymbolForControlString(e,t,i){return this._loader.getSymbolForControlString(e,t,i)}getDictionaryInfo(){return this._dictionaryInfoPromise||(this._dictionaryInfoPromise=this._fetchDictionaryInfo()),this._dictionaryInfoPromise}async collectRequiredFields(e,t){await this.collectVVRequiredFields(e,t),this.scaleExpression&&await ur(e,t,this.scaleExpression);for(const i in this.fieldMap){const r=this.fieldMap[i];t.has(r)&&e.add(r)}}get arcadeRequired(){return!0}getSymbol(){return null}get symbols(){return[]}getAttributeHash(){return this.visualVariables?.reduce(((e,t)=>e+t.getAttributeHash()),"")??""}getMeshHash(){return`${this.url}-${JSON.stringify(this.fieldMap)}`}async _fetchDictionaryInfo(){const{data:e}=await at(this.url+"/resources/styles/dictionary-info.json",{responseType:"json",query:{f:"json"}});return e}};h([f({type:B7})],pn.prototype,"_loader",null),h([f({type:Object,json:{read:{source:"configuration"},write:{target:"configuration"}}})],pn.prototype,"config",void 0),h([f({type:Object,json:{write:!0}})],pn.prototype,"fieldMap",void 0),h([f({type:String,json:{read:{source:"scalingExpressionInfo.expression"},write:!0}})],pn.prototype,"scaleExpression",void 0),h([$e("scaleExpression")],pn.prototype,"writeData",null),h([f({type:String,json:{read:{source:"scalingExpressionInfo.title"},write:{target:"scalingExpressionInfo.title",overridePolicy(e){return{enabled:!!e&&!!this.scaleExpression}}}}})],pn.prototype,"scaleExpressionTitle",void 0),h([f({type:String,json:{write:!0}})],pn.prototype,"url",void 0),h([$e("visualVariables")],pn.prototype,"writeVisualVariables",null),pn=IT=h([I("esri.renderers.DictionaryRenderer")],pn);var AT;let _a=AT=class extends ee{constructor(e){super(e),this.color=null,this.field=null,this.label=null,this.valueExpression=null,this.valueExpressionTitle=null}castField(e){return e==null?e:typeof e=="function"?(H.getLogger(this).error(".field: field must be a string value"),null):kg(e)}getAttributeHash(){return`${this.field}-${this.valueExpression}`}clone(){return new AT({color:this.color?.clone(),field:this.field,label:this.label,valueExpression:this.valueExpression,valueExpressionTitle:this.valueExpressionTitle})}};h([f({type:X,json:{type:[Number],write:!0}})],_a.prototype,"color",void 0),h([f({type:String,json:{write:!0}})],_a.prototype,"field",void 0),h([Ke("field")],_a.prototype,"castField",null),h([f({type:String,json:{write:!0}})],_a.prototype,"label",void 0),h([f({type:String,json:{write:!0}})],_a.prototype,"valueExpression",void 0),h([f({type:String,json:{write:!0}})],_a.prototype,"valueExpressionTitle",void 0),_a=AT=h([I("esri.renderers.support.AttributeColorInfo")],_a);const q7=_a;var LT;let I1=LT=class extends ee{constructor(){super(...arguments),this.unit=null}clone(){return new LT({unit:this.unit})}};h([f({type:String,json:{write:!0}})],I1.prototype,"unit",void 0),I1=LT=h([I("esri.renderers.support.DotDensityLegendOptions")],I1);const W0e=I1;var kT;let Lr=kT=class extends bf(hs){constructor(e){super(e),this.attributes=null,this.backgroundColor=new X([0,0,0,0]),this.dotBlendingEnabled=!0,this.dotShape="square",this.dotSize=1,this.legendOptions=null,this.outline=new Nt,this.dotValue=null,this.referenceScale=null,this.seed=1,this.type="dot-density"}calculateDotValue(e){if(this.referenceScale==null)return this.dotValue;const t=e/this.referenceScale*this.dotValue;return t<1?1:t}getSymbol(){return new $r({outline:this.outline})}async getSymbolAsync(){return this.getSymbol()}get symbols(){return[this.getSymbol()]}getAttributeHash(){return this.attributes?.reduce(((e,t)=>e+t.getAttributeHash()),"")??""}getMeshHash(){return JSON.stringify(this.outline)}clone(){return new kT({attributes:V(this.attributes),backgroundColor:V(this.backgroundColor),dotBlendingEnabled:V(this.dotBlendingEnabled),dotShape:V(this.dotShape),dotSize:V(this.dotSize),dotValue:V(this.dotValue),legendOptions:V(this.legendOptions),outline:V(this.outline),referenceScale:V(this.referenceScale),seed:V(this.seed),visualVariables:V(this.visualVariables),authoringInfo:V(this.authoringInfo)})}getControllerHash(){return`${this.attributes?.map((t=>t.field||t.valueExpression||""))}-${this.outline&&JSON.stringify(this.outline.toJSON())||""}`}async collectRequiredFields(e,t){await this.collectVVRequiredFields(e,t);for(const i of this.attributes??[])i.valueExpression&&await ur(e,t,i.valueExpression),i.field&&e.add(i.field)}};h([f({type:[q7],json:{write:!0}})],Lr.prototype,"attributes",void 0),h([f({type:X,json:{write:!0}})],Lr.prototype,"backgroundColor",void 0),h([f({type:Boolean,json:{write:!0}})],Lr.prototype,"dotBlendingEnabled",void 0),h([f({type:String,json:{write:!1}})],Lr.prototype,"dotShape",void 0),h([f({type:Number,json:{write:!0}})],Lr.prototype,"dotSize",void 0),h([f({type:W0e,json:{write:!0}})],Lr.prototype,"legendOptions",void 0),h([f({type:Nt,json:{default:null,write:!0}})],Lr.prototype,"outline",void 0),h([f({type:Number,json:{write:!0}})],Lr.prototype,"dotValue",void 0),h([f({type:Number,json:{write:!0}})],Lr.prototype,"referenceScale",void 0),h([f({type:Number,json:{write:!0}})],Lr.prototype,"seed",void 0),h([me({dotDensity:"dot-density"})],Lr.prototype,"type",void 0),Lr=kT=h([I("esri.renderers.DotDensityRenderer")],Lr);var RT;let Da=RT=class extends ee{constructor(e){super(e),this.color=null,this.ratio=null}clone(){return new RT({color:this.color&&this.color.clone(),ratio:this.ratio})}};h([f({type:X,json:{type:[Ue],default:null,write:{isRequired:!0}}})],Da.prototype,"color",void 0),h([f({type:Number,json:{write:{isRequired:!0}}})],Da.prototype,"ratio",void 0),Da=RT=h([I("esri.renderers.support.HeatmapColorStop")],Da);let wd=class extends xt.ClonableMixin(ee){constructor(){super(...arguments),this.minLabel=null,this.maxLabel=null,this.title=null}};h([f({type:String,json:{write:!0}})],wd.prototype,"minLabel",void 0),h([f({type:String,json:{write:!0}})],wd.prototype,"maxLabel",void 0),h([f({type:String,json:{write:!0}})],wd.prototype,"title",void 0),wd=h([I("esri.renderers.support.HeatmapLegendOptions")],wd);function Z0e(e,t){return e[0]=t[0],e[1]=t[1],e[2]=t[2],e[3]=t[3],e}function Y0e(e,t){return e[0]=t[0],e[1]=t[1],e[2]=t[2],e}function J0e(e,t,i,r,s){return e[0]=t,e[1]=i,e[2]=r,e[3]=s,e}function X0e(e,t,i){return e[0]=t[0]+i[0],e[1]=t[1]+i[1],e[2]=t[2]+i[2],e[3]=t[3]+i[3],e}function H7(e,t,i){return e[0]=t[0]-i[0],e[1]=t[1]-i[1],e[2]=t[2]-i[2],e[3]=t[3]-i[3],e}function W7(e,t,i){return e[0]=t[0]*i[0],e[1]=t[1]*i[1],e[2]=t[2]*i[2],e[3]=t[3]*i[3],e}function Z7(e,t,i){return e[0]=t[0]/i[0],e[1]=t[1]/i[1],e[2]=t[2]/i[2],e[3]=t[3]/i[3],e}function K0e(e,t){return e[0]=Math.ceil(t[0]),e[1]=Math.ceil(t[1]),e[2]=Math.ceil(t[2]),e[3]=Math.ceil(t[3]),e}function Q0e(e,t){return e[0]=Math.floor(t[0]),e[1]=Math.floor(t[1]),e[2]=Math.floor(t[2]),e[3]=Math.floor(t[3]),e}function e_e(e,t,i){return e[0]=Math.min(t[0],i[0]),e[1]=Math.min(t[1],i[1]),e[2]=Math.min(t[2],i[2]),e[3]=Math.min(t[3],i[3]),e}function t_e(e,t,i){return e[0]=Math.max(t[0],i[0]),e[1]=Math.max(t[1],i[1]),e[2]=Math.max(t[2],i[2]),e[3]=Math.max(t[3],i[3]),e}function i_e(e,t){return e[0]=Math.round(t[0]),e[1]=Math.round(t[1]),e[2]=Math.round(t[2]),e[3]=Math.round(t[3]),e}function r_e(e,t,i){return e[0]=t[0]*i,e[1]=t[1]*i,e[2]=t[2]*i,e[3]=t[3]*i,e}function s_e(e,t,i,r){return e[0]=t[0]+i[0]*r,e[1]=t[1]+i[1]*r,e[2]=t[2]+i[2]*r,e[3]=t[3]+i[3]*r,e}function Y7(e,t){const i=t[0]-e[0],r=t[1]-e[1],s=t[2]-e[2],n=t[3]-e[3];return Math.sqrt(i*i+r*r+s*s+n*n)}function J7(e,t){const i=t[0]-e[0],r=t[1]-e[1],s=t[2]-e[2],n=t[3]-e[3];return i*i+r*r+s*s+n*n}function X7(e){const t=e[0],i=e[1],r=e[2],s=e[3];return Math.sqrt(t*t+i*i+r*r+s*s)}function K7(e){const t=e[0],i=e[1],r=e[2],s=e[3];return t*t+i*i+r*r+s*s}function n_e(e,t){return e[0]=-t[0],e[1]=-t[1],e[2]=-t[2],e[3]=-t[3],e}function o_e(e,t){return e[0]=1/t[0],e[1]=1/t[1],e[2]=1/t[2],e[3]=1/t[3],e}function a_e(e,t){const i=t[0],r=t[1],s=t[2],n=t[3];let o=i*i+r*r+s*s+n*n;return o>0&&(o=1/Math.sqrt(o),e[0]=i*o,e[1]=r*o,e[2]=s*o,e[3]=n*o),e}function l_e(e,t){return e[0]*t[0]+e[1]*t[1]+e[2]*t[2]+e[3]*t[3]}function Q7(e,t,i,r){const s=t[0],n=t[1],o=t[2],a=t[3];return e[0]=s+r*(i[0]-s),e[1]=n+r*(i[1]-n),e[2]=o+r*(i[2]-o),e[3]=a+r*(i[3]-a),e}function u_e(e,t=1){const i=iw;let r,s,n,o,a,l;do r=2*i()-1,s=2*i()-1,a=r*r+s*s;while(a>=1);do n=2*i()-1,o=2*i()-1,l=n*n+o*o;while(l>=1);const u=Math.sqrt((1-a)/l);return e[0]=t*r,e[1]=t*s,e[2]=t*n*u,e[3]=t*o*u,e}function c_e(e,t,i){const r=t[0],s=t[1],n=t[2],o=t[3];return e[0]=i[0]*r+i[4]*s+i[8]*n+i[12]*o,e[1]=i[1]*r+i[5]*s+i[9]*n+i[13]*o,e[2]=i[2]*r+i[6]*s+i[10]*n+i[14]*o,e[3]=i[3]*r+i[7]*s+i[11]*n+i[15]*o,e}function h_e(e,t,i){const r=t[0],s=t[1],n=t[2],o=i[0],a=i[1],l=i[2],u=i[3],c=u*r+a*n-l*s,d=u*s+l*r-o*n,m=u*n+o*s-a*r,y=-o*r-a*s-l*n;return e[0]=c*u+y*-o+d*-l-m*-a,e[1]=d*u+y*-a+m*-o-c*-l,e[2]=m*u+y*-l+c*-a-d*-o,e[3]=t[3],e}function d_e(e){return"vec4("+e[0]+", "+e[1]+", "+e[2]+", "+e[3]+")"}function p_e(e,t){return e[0]===t[0]&&e[1]===t[1]&&e[2]===t[2]&&e[3]===t[3]}function f_e(e,t){const i=e[0],r=e[1],s=e[2],n=e[3],o=t[0],a=t[1],l=t[2],u=t[3],c=Tr();return Math.abs(i-o)<=c*Math.max(1,Math.abs(i),Math.abs(o))&&Math.abs(r-a)<=c*Math.max(1,Math.abs(r),Math.abs(a))&&Math.abs(s-l)<=c*Math.max(1,Math.abs(s),Math.abs(l))&&Math.abs(n-u)<=c*Math.max(1,Math.abs(n),Math.abs(u))}const m_e=H7,y_e=W7,g_e=Z7,__e=Y7,v_e=J7,b_e=X7,w_e=K7;Object.freeze(Object.defineProperty({__proto__:null,add:X0e,ceil:K0e,copy:Z0e,copyVec3:Y0e,dist:__e,distance:Y7,div:g_e,divide:Z7,dot:l_e,equals:f_e,exactEquals:p_e,floor:Q0e,inverse:o_e,len:b_e,length:X7,lerp:Q7,max:t_e,min:e_e,mul:y_e,multiply:W7,negate:n_e,normalize:a_e,random:u_e,round:i_e,scale:r_e,scaleAndAdd:s_e,set:J0e,sqrDist:v_e,sqrLen:w_e,squaredDistance:J7,squaredLength:K7,str:d_e,sub:m_e,subtract:H7,transformMat4:c_e,transformQuat:h_e},Symbol.toStringTag,{value:"Module"}));function Aw(){return[0,0,0,0]}function S_e(e){return[e[0],e[1],e[2],e[3]]}function Th(e,t,i,r){return[e,t,i,r]}function x_e(e,t,i,r){return[e,t,i,r]}function $_e(e,t=Aw()){const i=Math.min(4,e.length);for(let r=0;r<i;++r)t[r]=e[r];return t}function ej(){return Aw()}function tj(){return Th(1,1,1,1)}function ij(){return Th(1,0,0,0)}function rj(){return Th(0,1,0,0)}function sj(){return Th(0,0,1,0)}function nj(){return Th(0,0,0,1)}const M_e=ej(),T_e=tj(),E_e=ij(),C_e=rj(),P_e=sj(),I_e=nj();Object.freeze(Object.defineProperty({__proto__:null,ONES:T_e,UNIT_W:I_e,UNIT_X:E_e,UNIT_Y:C_e,UNIT_Z:P_e,ZEROS:M_e,clone:S_e,create:Aw,freeze:x_e,fromArray:$_e,fromValues:Th,ones:tj,unitW:nj,unitX:ij,unitY:rj,unitZ:sj,zeros:ej},Symbol.toStringTag,{value:"Module"}));const OP=2.4;function A_e(e){return We(e*OP)}function L_e(e){return Re(e)/OP}function k_e(e,t,i,r){let{color:s,ratio:n}=t,{color:o,ratio:a}=i;a===n&&(a===1?n-=1e-6:a+=1e-6);const l=lr((r-n)/(a-n),0,1);Q7(e,s.toArray(),o.toArray(),l)}function uRe(e){const i=new Uint8ClampedArray(2048);if(e=e.filter((({ratio:a})=>a>=0&&a<=1)).sort(((a,l)=>a.ratio-l.ratio)).map((({color:a,ratio:l})=>({color:a,ratio:Math.max(l,.001)}))),e.length<1)return i;let r=e[0],s=e[0],n=1;const o=Aw();for(let a=0;a<512;a++){const l=(a+.5)/512;for(;l>s.ratio&&n<e.length;)r=s,s=e[n++];k_e(o,r,s,l),i.set(o,4*a)}return i}function cRe(e,t,i){const r=Math.sqrt(e**2+t**2)/i;return r>1?0:3/(Math.PI*i**2)*(1-r**2)**2}function hRe(e){return typeof e=="function"?e:e?t=>+t[e]:()=>1}var OT;function b5(e){if(e!=null){const{maxDensity:t,minDensity:i,radius:r}=e;if(t!=null||i!=null||r!=null){const{blurRadius:s,maxPixelIntensity:n,minPixelIntensity:o,...a}=e;return a}}return e}let fi=OT=class extends hs{constructor(e){super(e),this.authoringInfo=null,this.colorStops=[new Da({ratio:0,color:new X("rgba(255, 140, 0, 0)")}),new Da({ratio:.75,color:new X("rgba(255, 140, 0, 1)")}),new Da({ratio:.9,color:new X("rgba(255, 0,   0, 1)")})],this.field=null,this.legendOptions=null,this.maxDensity=.04,this.minDensity=0,this.radius=18,this.referenceScale=0,this.type="heatmap",this.valueExpression=null,this.valueExpressionTitle=null}normalizeCtorArgs(e){return b5(e)}get blurRadius(){return L_e(this.radius)}set blurRadius(e){const t=this.maxPixelIntensity,i=this.minPixelIntensity;this._set("radius",A_e(e)),this._set("maxDensity",t*this._pixelIntensityToDensity),this._set("minDensity",i*this._pixelIntensityToDensity)}get maxPixelIntensity(){return this.maxDensity/this._pixelIntensityToDensity}set maxPixelIntensity(e){this._set("maxDensity",e*this._pixelIntensityToDensity)}get minPixelIntensity(){return this.minDensity/this._pixelIntensityToDensity}set minPixelIntensity(e){this._set("minDensity",e*this._pixelIntensityToDensity)}get _pixelIntensityToDensity(){return 24/(OP**2*this.blurRadius**4)}read(e,t){e=b5(e),super.read(e,t)}getSymbol(){return new Ct}async getSymbolAsync(){return this.getSymbol()}get symbols(){return[this.getSymbol()]}async collectRequiredFields(e,t){const i=this.field,r=this.valueExpression;i&&typeof i=="string"&&fs(e,t,i),r&&typeof r=="string"&&await ur(e,t,r)}getAttributeHash(){return""}getMeshHash(){return`${JSON.stringify(this.colorStops)}.${this.blurRadius}.${this.field}`}clone(){return new OT({authoringInfo:this.authoringInfo&&this.authoringInfo.clone(),colorStops:V(this.colorStops),field:this.field,legendOptions:V(this.legendOptions),maxDensity:this.maxDensity,minDensity:this.minDensity,radius:this.radius,referenceScale:this.referenceScale,valueExpression:this.valueExpression,valueExpressionTitle:this.valueExpressionTitle})}};h([f({type:Mt,json:{write:!0,origins:{"web-scene":{write:!1,read:!1}}}})],fi.prototype,"authoringInfo",void 0),h([f({type:Number,json:{origins:{"portal-item":{write:!0},"web-map":{write:!0}}}})],fi.prototype,"blurRadius",null),h([f({type:[Da],json:{write:{isRequired:!0}}})],fi.prototype,"colorStops",void 0),h([f({type:String,json:{write:!0}})],fi.prototype,"field",void 0),h([f({type:wd,json:{write:!0}})],fi.prototype,"legendOptions",void 0),h([f({type:Number,json:{write:!0}})],fi.prototype,"maxDensity",void 0),h([f({type:Number,json:{origins:{"portal-item":{write:!0},"web-map":{write:!0}}}})],fi.prototype,"maxPixelIntensity",null),h([f({type:Number,json:{write:!0}})],fi.prototype,"minDensity",void 0),h([f({type:Number,json:{origins:{"portal-item":{write:!0},"web-map":{write:!0}}}})],fi.prototype,"minPixelIntensity",null),h([f({type:Number,cast:ct,json:{write:!0}})],fi.prototype,"radius",void 0),h([f({type:Number,range:{min:0},json:{default:0,write:!0}})],fi.prototype,"referenceScale",void 0),h([me({heatmap:"heatmap"})],fi.prototype,"type",void 0),h([f({type:String,json:{write:!0,origins:{"web-document":{write:!1},"portal-item":{write:!1}}}})],fi.prototype,"valueExpression",void 0),h([f({type:String})],fi.prototype,"valueExpressionTitle",void 0),h([f({readOnly:!0})],fi.prototype,"_pixelIntensityToDensity",null),fi=OT=h([I("esri.renderers.HeatmapRenderer")],fi);let Tc=class extends xt.ClonableMixin(ee){constructor(){super(...arguments),this.color=new X([0,0,0,0]),this.label=null,this.threshold=0}};h([f({type:X,json:{write:!0}})],Tc.prototype,"color",void 0),h([f({type:String,json:{write:!0}})],Tc.prototype,"label",void 0),h([f({type:Number,range:{min:0,max:1},json:{write:!0}})],Tc.prototype,"threshold",void 0),Tc=h([I("esri.renderers.support.OthersCategory")],Tc);const R_e={base:Xi,key:"type",typeMap:{size:De,opacity:Aa}};let kr=class extends bf(xt.ClonableMixin(hs)){constructor(t){super(t),this.attributes=null,this.backgroundFillSymbol=null,this.defaultColor=new X([0,0,0,0]),this.defaultLabel=null,this.holePercentage=0,this.othersCategory=new Tc,this.legendOptions=null,this.outline=null,this.size=12,this.type="pie-chart",this.visualVariables=null}getSymbol(){return new Ct({size:this.size?this.size/2+(this.outline?.width||0):0})}async getSymbolAsync(){return this.getSymbol()}get symbols(){return[this.getSymbol(),this.backgroundFillSymbol].filter(rr)}getAttributeHash(){return this.visualVariables?.reduce(((t,i)=>t+i.getAttributeHash()),"")??""}getMeshHash(){return this.symbols.reduce(((t,i)=>t+JSON.stringify(i)),"")}async collectRequiredFields(t,i){await this.collectVVRequiredFields(t,i);for(const r of this.attributes)r.valueExpression&&await ur(t,i,r.valueExpression),r.field&&t.add(r.field)}};h([f({type:[q7],json:{write:!0}})],kr.prototype,"attributes",void 0),h([f(IP)],kr.prototype,"backgroundFillSymbol",void 0),h([f({type:X,json:{write:!0}})],kr.prototype,"defaultColor",void 0),h([f({type:String,json:{write:!0}})],kr.prototype,"defaultLabel",void 0),h([f({type:Number,range:{min:0,max:1},json:{write:!0}})],kr.prototype,"holePercentage",void 0),h([f({type:Tc,json:{write:!0}})],kr.prototype,"othersCategory",void 0),h([f({type:AP,json:{write:!0}})],kr.prototype,"legendOptions",void 0),h([f({type:Nt,json:{default:null,write:!0}})],kr.prototype,"outline",void 0),h([f({type:Number,cast:ct,json:{write:!0}})],kr.prototype,"size",void 0),h([me({pieChart:"pie-chart"})],kr.prototype,"type",void 0),h([f({types:[R_e]})],kr.prototype,"visualVariables",void 0),kr=h([I("esri.renderers.PieChartRenderer")],kr);var NT;let Bl=NT=class extends bf(hs){constructor(e){super(e),this.description=null,this.label=null,this.symbol=null,this.type="simple"}async collectRequiredFields(e,t){await Promise.all([this.collectSymbolFields(e,t),this.collectVVRequiredFields(e,t)])}async collectSymbolFields(e,t){await Promise.all(this.symbols.map((i=>i.collectRequiredFields(e,t))))}getSymbol(e,t){return this.symbol}async getSymbolAsync(e,t){return this.symbol}get symbols(){return this.symbol?[this.symbol]:[]}getAttributeHash(){return this.visualVariables?.reduce(((e,t)=>e+t.getAttributeHash()),"")??""}getMeshHash(){return this.symbols.reduce(((e,t)=>e+JSON.stringify(t)),"")}get arcadeRequired(){return this.arcadeRequiredForVisualVariables}clone(){return new NT({description:this.description,label:this.label,symbol:V(this.symbol),visualVariables:V(this.visualVariables),authoringInfo:V(this.authoringInfo)})}};h([f({type:String,json:{write:!0}})],Bl.prototype,"description",void 0),h([f({type:String,json:{write:!0}})],Bl.prototype,"label",void 0),h([f(PP)],Bl.prototype,"symbol",void 0),h([me({simple:"simple"})],Bl.prototype,"type",void 0),Bl=NT=h([I("esri.renderers.SimpleRenderer")],Bl);const O_e=new Set(["esri.Color","esri.portal.Portal","esri.symbols.support.Symbol3DAnchorPosition2D","esri.symbols.support.Symbol3DAnchorPosition3D"]);function DT(e){return e instanceof le}function w5(e){return e instanceof ne?Object.keys(e.items):DT(e)?Ba(e).keys():e?Object.keys(e):[]}function e_(e,t){return e instanceof ne?e.items[t]:e[t]}function N_e(e,t){return!(!Array.isArray(e)||!Array.isArray(t))&&e.length!==t.length}function Oy(e){return e?e.declaredClass:null}function oj(e,t){const i=e.diff;if(i&&typeof i=="function")return i(e,t);const r=w5(e),s=w5(t);if(r.length===0&&s.length===0)return;if(!r.length||!s.length||N_e(e,t))return{type:"complete",oldValue:e,newValue:t};const n=s.filter((d=>!r.includes(d))),o=r.filter((d=>!s.includes(d))),a=r.filter((d=>s.includes(d)&&e_(e,d)!==e_(t,d))).concat(n,o).sort(),l=Oy(e);if(l&&O_e.has(l)&&a.length)return{type:"complete",oldValue:e,newValue:t};let u;const c=DT(e)&&DT(t);for(const d of a){const m=e_(e,d),y=e_(t,d);let g;if((c||typeof m!="function"&&typeof y!="function")&&m!==y&&(m!=null||y!=null)){if(i&&i[d]&&typeof i[d]=="function")g=i[d]?.(m,y);else if(m instanceof Date&&y instanceof Date){if(m.getTime()===y.getTime())continue;g={type:"complete",oldValue:m,newValue:y}}else g=typeof m=="object"&&typeof y=="object"&&Oy(m)===Oy(y)?oj(m,y):{type:"complete",oldValue:m,newValue:y};g!=null&&(u!=null?u.diff[d]=g:u={type:"partial",diff:{[d]:g}})}}return u}function fRe(e,t){return D_e(e,t)}function D_e(e,t){if(e==null)return!1;const i=t.split(".");let r=e;for(const s of i){if(r.type==="complete")return!0;if(r.type!=="partial")return!1;{const n=r.diff[s];if(!n)return!1;r=n}}return!0}function mRe(e,t){if(!e)return!1;if(e.type==="partial"){const i=Object.keys(e.diff);return i.length===1&&i[0]===t}return!1}function F_e(e,t){if(typeof e!="function"&&typeof t!="function"&&(e!=null||t!=null))return e==null||t==null||typeof e=="object"&&typeof t=="object"&&Oy(e)!==Oy(t)?{type:"complete",oldValue:e,newValue:t}:oj(e,t)}function t_(e){if(e==null)return!0;switch(e.type){case"complete":return!1;case"collection":{const t=e;for(const i of t.added)if(!t_(i))return!1;for(const i of t.removed)if(!t_(i))return!1;for(const i of t.changed)if(!t_(i))return!1;return!0}case"partial":for(const t in e.diff)if(!t_(e.diff[t]))return!1;return!0}}let $n=class extends xt.ClonableMixin(ee){constructor(t){super(t),this.value=null,this.value2=null,this.value3=null}};h([f(M1)],$n.prototype,"value",void 0),h([f(M1)],$n.prototype,"value2",void 0),h([f(M1)],$n.prototype,"value3",void 0),$n=h([I("esri.renderers.support.UniqueValue")],$n);let Ma=class extends xt.ClonableMixin(ee){constructor(t){super(t),this.description=null,this.label=null,this.symbol=null,this.values=null}castValues(t){if(t==null)return null;const i=typeof(t=Array.isArray(t)?t:[t])[0];return i==="string"||i==="number"?t.map((r=>new $n({value:r}))):i==="object"?t[0]instanceof $n?t:t.map((r=>new $n(r))):null}};h([f({type:String,json:{write:!0}})],Ma.prototype,"description",void 0),h([f({type:String,json:{write:!0}})],Ma.prototype,"label",void 0),h([f(Pw)],Ma.prototype,"symbol",void 0),h([f({type:[$n],json:{type:[[String]],read:{reader:e=>e?e.map((t=>new $n({value:t[0],value2:t[1],value3:t[2]}))):null},write:{writer:(e,t)=>{const i=[];for(const r of e){const s=[r.value,r.value2,r.value3].filter(rr).map((n=>n.toString()));i.push(s)}t.values=i}}}})],Ma.prototype,"values",void 0),h([Ke("values")],Ma.prototype,"castValues",null),Ma=h([I("esri.renderers.support.UniqueValueClass")],Ma);let Nc=class extends xt.ClonableMixin(ee){constructor(t){super(t),this.heading=null,this.classes=null}};h([f({type:String,json:{write:!0}})],Nc.prototype,"heading",void 0),h([f({type:[Ma],json:{write:{isRequired:!0}}})],Nc.prototype,"classes",void 0),Nc=h([I("esri.renderers.support.UniqueValueGroup")],Nc);var FT;let xn=FT=class extends ee{constructor(e){super(e),this.description=null,this.label=null,this.symbol=null,this.value=null}clone(){return new FT({value:this.value,description:this.description,label:this.label,symbol:this.symbol?this.symbol.clone():null})}getMeshHash(){const e=JSON.stringify(this.symbol?.toJSON());return`${this.value}.${e}`}};h([f({type:String,json:{write:!0}})],xn.prototype,"description",void 0),h([f({type:String,json:{write:!0}})],xn.prototype,"label",void 0),h([f(PP)],xn.prototype,"symbol",void 0),h([f(M1)],xn.prototype,"value",void 0),xn=FT=h([I("esri.renderers.support.UniqueValueInfo")],xn);const S5=new Map;async function z_e(e,t){try{return{data:(await NP(e,t)).data,baseUrl:PE(e),styleUrl:e}}catch(i){return AE(i),null}}function V_e(e,t,i){const r=t.portal!=null?t.portal:Z.getDefault();let s;const n=`${r.url} - ${r.user?.username} - ${e}`,o=S5.get(n);if(o)return o;const a=U_e(e,r,i).then((l=>(s=l,l.fetchData()))).then((l=>({data:l,baseUrl:s.itemUrl??"",styleName:e})));return S5.set(n,a),a}function U_e(e,t,i){return t.load(i).then((()=>{const r=new Wt({disableExtraQuery:!0,query:`owner:${x5} AND type:${$5} AND typekeywords:"${e}"`});return t.queryItems(r,i)})).then((({results:r})=>{let s=null;const n=e.toLowerCase();if(r&&Array.isArray(r)){for(const o of r)if(o.typeKeywords?.some((l=>l.toLowerCase()===n))&&o.type===$5&&o.owner===x5){s=o;break}}if(!s)throw new j("symbolstyleutils:style-not-found",`The style '${e}' could not be found`,{styleName:e});return s.load(i)}))}function aj(e,t,i){return e?.styleUrl!=null?z_e(e.styleUrl,i):e?.styleName!=null?V_e(e.styleName,t,i):Promise.reject(new j("symbolstyleutils:style-url-and-name-missing","Either styleUrl or styleName is required to resolve a style"))}function lj(e){return e===null||e.type==="CIMSymbolReference"?e:{type:"CIMSymbolReference",symbol:e}}function j_e(e,t){for(const i of t)switch(i){case"cim":if(e.cimRef)return{format:i,url:encodeURI(e.cimRef)};break;case"web-gltf-basisu":{const r=aS(e,"gltf_basisu");if(r)return{format:i,url:r};break}case"web-gltf":{const r=aS(e,"gltf");if(r)return{format:i,url:r};break}case"web":{const r=aS(e,"gltf");if(r)return{format:"web-gltf",url:r};if(e.webRef)return{format:i,url:encodeURI(e.webRef)};break}}}function aS(e,t){if(!N("enable-feature:force-wosr"))return e.formatInfos?.find((i=>i.type===t))?.href}function NP(e,t){const i={responseType:"json",query:{f:"json"},...t};return at(No(e),i)}const x5="esri_en",$5="Style",G_e="https://cdn.arcgis.com/sharing/rest/content/items/220936cc6ed342c9937abd8f180e7d1e/resources/styles/cim/{SymbolName}.json?f=json";var Qm;const M5="uvInfos-watcher",T5="uvGroups-watcher",B_e=",",q_e=Ui(xn);function H_e(e){const{field1:t,field2:i,field3:r,fieldDelimiter:s,uniqueValueInfos:n,valueExpression:o}=e,a=!(!t||!i);return[{classes:(n??[]).map((l=>{const{symbol:u,label:c,value:d,description:m}=l,[y,g,_]=a?d?.toString()?.split(s||"")||[]:[d],v=[];return(t||o)&&v.push(y),i&&v.push(g),r&&v.push(_),{symbol:u,label:c,values:[v],description:m}}))}]}function Yh(e){return e!=null&&e!==""&&(typeof e!="string"||e.trim()!==""&&e.toLowerCase()!=="<null>")||(e=null),e+""}let ft=Qm=class extends bf(hs){constructor(e){super(e),this._valueInfoMap={},this._isDefaultSymbolDerived=!1,this._isInfosSource=null,this.type="unique-value",this.backgroundFillSymbol=null,this.orderByClassesEnabled=!1,this.valueExpressionTitle=null,this.legendOptions=null,this.defaultLabel=null,this.portal=null,this.styleOrigin=null,this.diff={uniqueValueInfos(t,i){if(!t&&!i)return;if(!t||!i)return{type:"complete",oldValue:t,newValue:i};let r=!1;const s={type:"collection",added:[],removed:[],changed:[],unchanged:[]};for(let n=0;n<i.length;n++){const o=t.find((a=>a.value===i[n].value));o?F_e(o,i[n])?(s.changed.push({type:"complete",oldValue:o,newValue:i[n]}),r=!0):s.unchanged.push({oldValue:o,newValue:i[n]}):(s.added.push(i[n]),r=!0)}for(let n=0;n<t.length;n++)i.find((o=>o.value===t[n].value))||(s.removed.push(t[n]),r=!0);return r?s:void 0}},this._set("uniqueValueInfos",[]),this._set("uniqueValueGroups",[])}get _cache(){return{compiledFunc:null}}set field(e){this._set("field",e),this._updateFieldDelimiter(),this._updateUniqueValues()}castField(e){return e==null||typeof e=="function"?e:kg(e)}writeField(e,t,i,r){typeof e=="string"?t[i]=e:r?.messages?r.messages.push(new j("property:unsupported","UniqueValueRenderer.field set to a function cannot be written to JSON")):H.getLogger(this).error(".field: cannot write field to JSON since it's not a string value")}set field2(e){this._set("field2",e),this._updateFieldDelimiter(),this._updateUniqueValues()}set field3(e){this._set("field3",e),this._updateUniqueValues()}set valueExpression(e){this._set("valueExpression",e),this._updateUniqueValues()}set defaultSymbol(e){this._isDefaultSymbolDerived=!1,this._set("defaultSymbol",e)}set fieldDelimiter(e){this._set("fieldDelimiter",e),this._updateUniqueValues()}readPortal(e,t,i){return i.portal||Z.getDefault()}readStyleOrigin(e,t,i){if(t.styleName)return Object.freeze({styleName:t.styleName});if(t.styleUrl){const r=Ga(t.styleUrl,i);return Object.freeze({styleUrl:r})}}writeStyleOrigin(e,t,i,r){e.styleName?t.styleName=e.styleName:e.styleUrl&&(t.styleUrl=rh(e.styleUrl,r))}set uniqueValueGroups(e){this.styleOrigin?H.getLogger(this).error("#uniqueValueGroups=","Cannot modify unique value groups of a UniqueValueRenderer created from a web style"):(this._set("uniqueValueGroups",e),this._updateInfosFromGroups(),this._isInfosSource=!1,this._watchUniqueValueGroups())}set uniqueValueInfos(e){this.styleOrigin?H.getLogger(this).error("#uniqueValueInfos=","Cannot modify unique value infos of a UniqueValueRenderer created from a web style"):(this._set("uniqueValueInfos",e),this._updateValueInfoMap(),this._updateGroupsFromInfos(),this._isInfosSource=!0,this._watchUniqueValueInfos())}addUniqueValueInfo(e,t){if(this.styleOrigin)return void H.getLogger(this).error("#addUniqueValueInfo()","Cannot modify unique value infos of a UniqueValueRenderer created from a web style");let i;i=typeof e=="object"?q_e(e):new xn({value:e,symbol:uV(t)}),this.uniqueValueInfos?.push(i),this._valueInfoMap[Yh(i.value)]=i,this._updateGroupsFromInfos(),this._isInfosSource=!0,this._watchUniqueValueInfos()}removeUniqueValueInfo(e){if(this.styleOrigin)return void H.getLogger(this).error("#removeUniqueValueInfo()","Cannot modify unique value infos of a UniqueValueRenderer created from a web style");const t=this.uniqueValueInfos;if(t)for(let i=0;i<t.length;i++){const r=t[i];if(String(r.value)===String(e)){delete this._valueInfoMap[Yh(e)],t.splice(i,1);break}}this._updateGroupsFromInfos(),this._isInfosSource=!0,this._watchUniqueValueInfos()}async getUniqueValueInfo(e,t){let i=t;return this.valueExpression&&t?.arcade==null&&(i={...i,arcade:await _u()}),this._getUniqueValueInfo(e,i)}getSymbol(e,t){return this.valueExpression&&t?.arcade==null?void H.getLogger(this).error("#getSymbol()","Please use getSymbolAsync if valueExpression is used"):this._getUniqueValueInfo(e,t)?.symbol||this.defaultSymbol}async getSymbolAsync(e,t){let i=t;if(this.valueExpression&&i?.arcade==null){const s=await _u(),{arcadeUtils:n}=s;n.hasGeometryOperations(this.valueExpression)&&await n.enableGeometryOperations(),i={...i,arcade:s}}return this._getUniqueValueInfo(e,i)?.symbol||this.defaultSymbol}get symbols(){const e=[];for(const t of this.uniqueValueInfos??[])t.symbol&&e.push(t.symbol);return this.defaultSymbol&&e.push(this.defaultSymbol),e}getAttributeHash(){return this.visualVariables?.reduce(((e,t)=>e+t.getAttributeHash()),"")??""}getMeshHash(){const e=JSON.stringify(this.backgroundFillSymbol),t=JSON.stringify(this.defaultSymbol),i=this.uniqueValueInfos?.reduce(((r,s)=>r+s.getMeshHash()),"");return`${e}.${t}.${i}.${`${this.field}.${this.field2}.${this.field3}.${this.fieldDelimiter}`}.${this.valueExpression}`}clone(){const e=new Qm({field:this.field,field2:this.field2,field3:this.field3,defaultLabel:this.defaultLabel,defaultSymbol:V(this.defaultSymbol),orderByClassesEnabled:this.orderByClassesEnabled,valueExpression:this.valueExpression,valueExpressionTitle:this.valueExpressionTitle,fieldDelimiter:this.fieldDelimiter,visualVariables:V(this.visualVariables),legendOptions:V(this.legendOptions),authoringInfo:V(this.authoringInfo),backgroundFillSymbol:V(this.backgroundFillSymbol)});this._isDefaultSymbolDerived&&(e._isDefaultSymbolDerived=!0),e._set("portal",this.portal);const t=V(this.uniqueValueInfos),i=V(this.uniqueValueGroups);return this.styleOrigin&&(e._set("styleOrigin",Object.freeze(V(this.styleOrigin))),Object.freeze(t),Object.freeze(i)),e._set("uniqueValueInfos",t),e._updateValueInfoMap(),e._set("uniqueValueGroups",i),e._isInfosSource=this._isInfosSource,e._watchUniqueValueInfosAndGroups(),e}get arcadeRequired(){return this.arcadeRequiredForVisualVariables||!!this.valueExpression}async collectRequiredFields(e,t){const i=[this.collectVVRequiredFields(e,t),this.collectSymbolFields(e,t)];await Promise.all(i)}async collectSymbolFields(e,t){const i=[...this.symbols.map((r=>r.collectRequiredFields(e,t))),ur(e,t,this.valueExpression)];fs(e,t,this.field),fs(e,t,this.field2),fs(e,t,this.field3),await Promise.all(i)}populateFromStyle(){return aj(this.styleOrigin,{portal:this.portal}).then((e=>{const t=[];return this._valueInfoMap={},e?.data&&Array.isArray(e.data.items)&&e.data.items.forEach((i=>{const r=new Ei({styleUrl:e.styleUrl,styleName:e.styleName,portal:this.portal,name:i.name});this.defaultSymbol||i.name!==e.data.defaultItem||(this.defaultSymbol=r,this._isDefaultSymbolDerived=!0);const s=new xn({value:i.name,symbol:r});t.push(s),this._valueInfoMap[Yh(i.name)]=s})),this._set("uniqueValueInfos",Object.freeze(t)),this._updateGroupsFromInfos(!0),this._isInfosSource=null,this._watchUniqueValueInfos(),!this.defaultSymbol&&this.uniqueValueInfos?.length&&(this.defaultSymbol=this.uniqueValueInfos[0].symbol,this._isDefaultSymbolDerived=!0),this}))}_updateFieldDelimiter(){this.field&&this.field2&&!this.fieldDelimiter&&this._set("fieldDelimiter",B_e)}_updateUniqueValues(){this._isInfosSource!=null&&(this._isInfosSource?this._updateGroupsFromInfos():this._updateInfosFromGroups())}_updateValueInfoMap(){this._valueInfoMap={};const{uniqueValueInfos:e}=this;if(e)for(const t of e)this._valueInfoMap[Yh(t.value)]=t}_watchUniqueValueInfosAndGroups(){this._watchUniqueValueInfos(),this._watchUniqueValueGroups()}_watchUniqueValueInfos(){this.removeHandles(M5);const{uniqueValueInfos:e}=this;if(e){const t=[];for(const i of e)t.push(te((()=>({symbol:i.symbol,value:i.value,label:i.label,description:i.description})),((r,s)=>{r!==s&&(this._updateGroupsFromInfos(),this._isInfosSource=!0)}),{sync:!0}));this.addHandles(t,M5)}}_watchUniqueValueGroups(){this.removeHandles(T5);const{uniqueValueGroups:e}=this;if(e){const t=[];for(const i of e){t.push(te((()=>({classes:i.classes})),((r,s)=>{r!==s&&(this._updateInfosFromGroups(),this._isInfosSource=!1)}),{sync:!0}));for(const r of i.classes??[])t.push(te((()=>({symbol:r.symbol,values:r.values,label:r.label,description:r.description})),((s,n)=>{s!==n&&(this._updateInfosFromGroups(),this._isInfosSource=!1)}),{sync:!0}))}this.addHandles(t,T5)}}_updateInfosFromGroups(){if(!this.uniqueValueGroups)return this._set("uniqueValueInfos",null),this._updateValueInfoMap(),void this._watchUniqueValueInfos();const e=[],{field:t,field2:i,field3:r,fieldDelimiter:s,uniqueValueGroups:n,valueExpression:o}=this;if(!t&&!o)return this._set("uniqueValueInfos",e),this._updateValueInfoMap(),void this._watchUniqueValueInfos();const a=!(!t||!i);for(const l of n)for(const u of l.classes??[]){const{symbol:c,label:d,values:m,description:y}=u;for(const g of m??[]){const{value:_,value2:v,value3:b}=g,S=[_];i&&S.push(v),r&&S.push(b);const $=a?S.join(s||""):S[0]??void 0;e.push(new xn({symbol:c,label:d,value:$,description:y}))}}this._set("uniqueValueInfos",e),this._updateValueInfoMap(),this._watchUniqueValueInfos()}_updateGroupsFromInfos(e=!1){if(!this.uniqueValueInfos)return this._set("uniqueValueGroups",null),void this._watchUniqueValueGroups();const{field:t,field2:i,valueExpression:r,fieldDelimiter:s,uniqueValueInfos:n}=this;if(!t&&!r||!n.length)return this._set("uniqueValueGroups",[]),void this._watchUniqueValueGroups();const o=!(!t||!i),a=n.map((u=>{const{symbol:c,label:d,value:m,description:y}=u,[g,_,v]=o?m?.toString()?.split(s||"")||[]:[m];return new Ma({symbol:c,label:d,description:y,values:[new $n({value:g,value2:_,value3:v})]})})),l=[new Nc({classes:a})];e&&Object.freeze(l),this._set("uniqueValueGroups",l),this._watchUniqueValueGroups()}_getUniqueValueInfo(e,t){return this.valueExpression?this._getUnqiueValueInfoForExpression(e,t):this._getUnqiueValueInfoForFields(e)}_getUnqiueValueInfoForExpression(e,t){const{viewingMode:i,scale:r,spatialReference:s,arcade:n,timeZone:o}=t??{};let a=this._cache.compiledFunc;const l=n.arcadeUtils;if(!a){const c=l.createSyntaxTree(this.valueExpression);a=l.createFunction(c),this._cache.compiledFunc=a}const u=l.executeFunction(a,l.createExecContext(e,l.getViewInfo({viewingMode:i,scale:r,spatialReference:s}),o));return this._valueInfoMap[Yh(u)]}_getUnqiueValueInfoForFields(e){const t=this.field,i=e.attributes;let r;if(this.field2){const s=this.field2,n=this.field3,o=[];t&&o.push(i[t]),s&&o.push(i[s]),n&&o.push(i[n]),r=o.join(this.fieldDelimiter||"")}else t&&(r=i[t]);return this._valueInfoMap[Yh(r)]}static fromPortalStyle(e,t){const i=new Qm(t?.properties);i._set("styleOrigin",Object.freeze({styleName:e})),i._set("portal",t?.portal||Z.getDefault());const r=i.populateFromStyle();return r.catch((s=>{H.getLogger(this.prototype).error(`#fromPortalStyle('${e}'[, ...])`,"Failed to create unique value renderer from style name",s)})),r}static fromStyleUrl(e,t){const i=new Qm(t?.properties);i._set("styleOrigin",Object.freeze({styleUrl:e}));const r=i.populateFromStyle();return r.catch((s=>{H.getLogger(this.prototype).error(`#fromStyleUrl('${e}'[, ...])`,"Failed to create unique value renderer from style URL",s)})),r}};h([f({readOnly:!0})],ft.prototype,"_cache",null),h([me({uniqueValue:"unique-value"})],ft.prototype,"type",void 0),h([f(IP)],ft.prototype,"backgroundFillSymbol",void 0),h([f({value:null,json:{type:String,read:{source:"field1"},write:{target:"field1"}}})],ft.prototype,"field",null),h([Ke("field")],ft.prototype,"castField",null),h([$e("field")],ft.prototype,"writeField",null),h([f({type:String,value:null,json:{write:!0}})],ft.prototype,"field2",null),h([f({type:String,value:null,json:{write:!0}})],ft.prototype,"field3",null),h([f({type:Boolean,json:{name:"drawInClassOrder",default:!1,write:!0,origins:{"web-scene":{write:!1}}}})],ft.prototype,"orderByClassesEnabled",void 0),h([f({type:String,value:null,json:{write:!0}})],ft.prototype,"valueExpression",null),h([f({type:String,json:{write:!0}})],ft.prototype,"valueExpressionTitle",void 0),h([f({type:AP,json:{write:!0}})],ft.prototype,"legendOptions",void 0),h([f({type:String,json:{write:!0}})],ft.prototype,"defaultLabel",void 0),h([f(bE({...Pw},{json:{write:{overridePolicy(){return{enabled:!this._isDefaultSymbolDerived}}},origins:{"web-scene":{write:{overridePolicy(){return{enabled:!this._isDefaultSymbolDerived}}}}}}}))],ft.prototype,"defaultSymbol",null),h([f({type:String,value:null,json:{write:!0}})],ft.prototype,"fieldDelimiter",null),h([f({type:Z,readOnly:!0})],ft.prototype,"portal",void 0),h([Ae("portal",["styleName"])],ft.prototype,"readPortal",null),h([f({readOnly:!0,json:{write:{enabled:!1,overridePolicy:()=>({enabled:!0})}}})],ft.prototype,"styleOrigin",void 0),h([Ae("styleOrigin",["styleName","styleUrl"])],ft.prototype,"readStyleOrigin",null),h([$e("styleOrigin",{styleName:{type:String},styleUrl:{type:String}})],ft.prototype,"writeStyleOrigin",null),h([f({type:[Nc],json:{read:{source:["uniqueValueGroups","uniqueValueInfos"],reader:(e,t,i)=>(t.uniqueValueGroups||H_e(t)).map((r=>Nc.fromJSON(r,i)))},write:{overridePolicy(){return this.styleOrigin?{enabled:!1}:{enabled:!0}}}}})],ft.prototype,"uniqueValueGroups",null),h([f({type:[xn],json:{read:!1,write:{isRequired:!0,overridePolicy(){return this.styleOrigin?{enabled:!1}:{enabled:!0,isRequired:!0}}}}})],ft.prototype,"uniqueValueInfos",null),ft=Qm=h([I("esri.renderers.UniqueValueRenderer")],ft);const W_e={key:"type",base:hs,typeMap:{heatmap:fi,simple:Bl,"unique-value":ft,"class-breaks":ri,"dot-density":Lr,dictionary:pn,"pie-chart":kr},errorContext:"renderer"},vRe={key:"type",base:hs,typeMap:{simple:Bl,"unique-value":ft,"class-breaks":ri,heatmap:fi},errorContext:"renderer",validate:Z_e};function Z_e(e){switch(e.type){case"simple":return Y_e(e);case"unique-value":return J_e(e);case"class-breaks":return X_e(e);case"heatmap":return e}}function Y_e(e){if(e.symbol)return e;H.getLogger("esri.renderers.support.types").error("Removed invalid 'simple' renderer without a symbol from web scene.")}function J_e(e){const t=e.uniqueValueInfos,i=t?.filter((({symbol:r,label:s},n)=>(r||H.getLogger("esri.renderers.support.types").error(`Removed invalid unique value info ([${n}] ${s}) without a symbol from web scene.`),!!r)));return i?.length!==t?.length&&(e.uniqueValueInfos=i),e}function X_e(e){const t=e.classBreakInfos,i=t?.filter((({symbol:r,label:s},n)=>(r||H.getLogger("esri.renderers.support.types").error(`Removed invalid class break info ([${n}] ${s}) without a symbol from web scene.`),!!r)));return i?.length!==t?.length&&(e.classBreakInfos=i),e}function K_e(e,t){return e1e(e,null,t)}const Q_e=Rg({types:W_e});function e1e(e,t,i){return e?e&&(e.styleName||e.styleUrl)&&e.type!=="uniqueValue"?(i?.messages&&i.messages.push(new Bs("renderer:unsupported","Only UniqueValueRenderer can be referenced from a web style, but found '"+e.type+"'",{definition:e,context:i})),null):Q_e(e,t,i):null}function uj(e){return e==null||e.type==="simple"||e.type==="unique-value"||e.type==="class-breaks"||e.type==="dictionary"||e.type==="heatmap"}function bRe(e,t){if(e==null)return null;if(!uj(e))return new j("renderer-conversion-3d:unsupported-renderer",`Unsupported renderer of type '${e.type||e.declaredClass}'`,{renderer:e});switch(e.type){case"simple":return t1e(e,t);case"unique-value":return i1e(e,t);case"class-breaks":return r1e(e,t);case"dictionary":case"heatmap":return null}return null}function DP(e,t){if(!t)return null;if(Array.isArray(t)||(t=[t]),t.length>0){const i=t.map((s=>s.details.symbol.type||s.details.symbol.declaredClass)).filter((s=>!!s));i.sort();const r=new Array;return i.forEach(((s,n)=>{n!==0&&s===i[n-1]||r.push(s)})),new j("renderer-conversion-3d:unsupported-symbols",`Renderer contains symbols (${r.join(", ")}) which are not supported in 3D`,{renderer:e,symbolErrors:t})}return null}function t1e(e,t){const i={...La,...t,cimFallbackEnabled:!0};return DP(e,Kp(e.symbol,i).error)}function i1e(e,t){const i={...La,...t,cimFallbackEnabled:!0},r=e.uniqueValueInfos?.map((n=>Kp(n.symbol,i).error)).filter(rr),s=Kp(e.defaultSymbol,i);return s.error&&r?.unshift(s.error),DP(e,r)}function r1e(e,t){const i={...La,...t,cimFallbackEnabled:!0},r=e.classBreakInfos.map((n=>Kp(n.symbol,i).error)).filter(rr),s=Kp(e.defaultSymbol,i);return s.error&&r.unshift(s.error),DP(e,r)}var zT;function s1e(e){switch(e){case"circle":return{rings:[[[8.5,.2],[7.06,.33],[5.66,.7],[4.35,1.31],[3.16,2.14],[2.14,3.16],[1.31,4.35],[.7,5.66],[.33,7.06],[.2,8.5],[.33,9.94],[.7,11.34],[1.31,12.65],[2.14,13.84],[3.16,14.86],[4.35,15.69],[5.66,16.3],[7.06,16.67],[8.5,16.8],[9.94,16.67],[11.34,16.3],[12.65,15.69],[13.84,14.86],[14.86,13.84],[15.69,12.65],[16.3,11.34],[16.67,9.94],[16.8,8.5],[16.67,7.06],[16.3,5.66],[15.69,4.35],[14.86,3.16],[13.84,2.14],[12.65,1.31],[11.34,.7],[9.94,.33],[8.5,.2]]]};case"square":return{rings:[[[.5,.5],[.5,16.5],[16.5,16.5],[16.5,.5],[.5,.5]]]};case"diamond":return{rings:[[[8.5,.5],[.2,8.5],[8.5,16.5],[16.5,8.5],[8.5,.5]]]};case"hexagon-pointy":return{rings:[[[15.86,12.75],[15.86,4.25],[8.5,0],[1.14,4.25],[1.14,12.75],[8.5,17],[15.86,12.75]]]};case"hexagon-flat":return{rings:[[[12.75,15.86],[17,8.5],[12.75,1.14],[4.25,1.14],[0,8.5],[4.25,15.86],[12.75,15.86]]]}}}function FP(e){return e?.type==="CIMVectorMarker"?e.markerGraphics?.[0]:void 0}function cj(e){return e?.symbol?.type==="CIMPolygonSymbol"?e.symbol.symbolLayers?.[0]:void 0}function n1e(e,t){e?.type==="CIMVectorMarker"&&t!=null&&(e.size=t)}function o1e(e,t){const i=FP(e);i&&t!=null&&(i.geometry=s1e(t))}function a1e(e,t){const i=cj(FP(e));i&&t!=null&&(i.color=t.toArray())}function l1e(e,t,i){const r=cj(FP(e));r&&t!=null&&i&&(r.colorLocked=t)}function zP(e,t){const{outerRingSize:i,innerDotSize:r,type:s,color:n,colorLocked:o,primitiveOverrides:a}=t,l=e.data.symbol?.type==="CIMPolygonSymbol"?e.data.symbol.symbolLayers:null;if(l?.length===2)for(const u of l){const c=u.primitiveName===zT.OuterRing;n1e(u,c?i:r),o1e(u,s),a1e(u,n),l1e(u,o,c)}return i!=null&&r!=null&&(e.data.primitiveOverrides=null),a!==void 0&&(e.data.primitiveOverrides=V(a)),e}(function(e){e.OuterRing="reference-size-outer-ring",e.InnerDot="reference-size-inner-dot"})(zT||(zT={}));function hj(e,t,i,r){if(e)if(e.type!=="CIMTextSymbol"){if(e.effects)for(const s of e.effects)E5(s,t);if(e.symbolLayers)for(const s of e.symbolLayers){switch(s.type){case"CIMPictureMarker":case"CIMVectorMarker":u1e(s,t,r);break;case"CIMPictureStroke":case"CIMSolidStroke":case"CIMGradientStroke":!r?.preserveOutlineWidth&&s.width&&(s.width*=t);break;case"CIMPictureFill":s.height&&(s.height*=t),s.offsetX&&(s.offsetX*=t),s.offsetY&&(s.offsetY*=t);break;case"CIMHatchFill":hj(s.lineSymbol,t,!0,{...r,preserveOutlineWidth:!1}),s.offsetX&&(s.offsetX*=t),s.offsetY&&(s.offsetY*=t),s.separation&&(s.separation*=t)}if(s.effects)for(const n of s.effects)E5(n,t)}}else e.height!=null&&(e.height*=t)}function u1e(e,t,i){if(e&&(e.markerPlacement&&c1e(e.markerPlacement,t),e.offsetX&&(e.offsetX*=t),e.offsetY&&(e.offsetY*=t),e.anchorPoint&&e.anchorPointUnits==="Absolute"&&(e.anchorPoint={x:e.anchorPoint.x*t,y:e.anchorPoint.y*t}),e.size=e.size!=null?e.size*t:0,e.type==="CIMVectorMarker"&&e.markerGraphics))for(const r of e.markerGraphics)e.scaleSymbolsProportionally||hj(r.symbol,t,!0,i)}function c1e(e,t){switch(Iw(e)&&e.offset&&(e.offset*=t),e.type){case"CIMMarkerPlacementAlongLineRandomSize":case"CIMMarkerPlacementAlongLineSameSize":if(e.customEndingOffset&&(e.customEndingOffset*=t),e.offsetAlongLine&&(e.offsetAlongLine*=t),e.placementTemplate&&e.placementTemplate.length){const i=e.placementTemplate.map((r=>r*t));e.placementTemplate=i}break;case"CIMMarkerPlacementAlongLineVariableSize":if(e.maxRandomOffset&&(e.maxRandomOffset*=t),e.placementTemplate&&e.placementTemplate.length){const i=e.placementTemplate.map((r=>r*t));e.placementTemplate=i}break;case"CIMMarkerPlacementOnLine":e.startPointOffset&&(e.startPointOffset*=t);break;case"CIMMarkerPlacementAtExtremities":e.offsetAlongLine&&(e.offsetAlongLine*=t);break;case"CIMMarkerPlacementAtMeasuredUnits":case"CIMMarkerPlacementOnVertices":break;case"CIMMarkerPlacementAtRatioPositions":e.beginPosition&&(e.beginPosition*=t),e.endPosition&&(e.endPosition*=t);break;case"CIMMarkerPlacementPolygonCenter":e.offsetX&&(e.offsetX*=t),e.offsetY&&(e.offsetY*=t);break;case"CIMMarkerPlacementInsidePolygon":e.offsetX&&(e.offsetX*=t),e.offsetY&&(e.offsetY*=t),e.stepX&&(e.stepX*=t),e.stepY&&(e.stepY*=t)}}function E5(e,t){switch(e.type){case"CIMGeometricEffectArrow":case"CIMGeometricEffectDonut":e.width&&(e.width*=t);break;case"CIMGeometricEffectBuffer":e.size&&(e.size*=t);break;case"CIMGeometricEffectCut":e.beginCut&&(e.beginCut*=t),e.endCut&&(e.endCut*=t),e.middleCut&&(e.middleCut*=t);break;case"CIMGeometricEffectDashes":if(e.customEndingOffset&&(e.customEndingOffset*=t),e.offsetAlongLine&&(e.offsetAlongLine*=t),e.dashTemplate&&e.dashTemplate.length){const i=e.dashTemplate.map((r=>r*t));e.dashTemplate=i}break;case"CIMGeometricEffectExtension":case"CIMGeometricEffectJog":case"CIMGeometricEffectRadial":e.length&&(e.length*=t);break;case"CIMGeometricEffectMove":e.offsetX&&(e.offsetX*=t),e.offsetY&&(e.offsetY*=t);break;case"CIMGeometricEffectOffset":case"CIMGeometricEffectOffsetTangent":e.offset&&(e.offset*=t);break;case"CIMGeometricEffectRegularPolygon":e.radius&&(e.radius*=t);break;case"CIMGeometricEffectTaperedPolygon":e.fromWidth&&(e.fromWidth*=t),e.length&&(e.length*=t),e.toWidth&&(e.toWidth*=t);break;case"CIMGeometricEffectWave":e.amplitude&&(e.amplitude*=t),e.period&&(e.period*=t)}}function dj(e){const t=[];return VT(kP(e),t),t.length?new X(z7(t[0])):null}function VT(e,t){if(!e)return;let i;i=e.type==="CIMTextSymbol"?e.symbol:e;const r=e.type==="CIMPolygonSymbol";if(i?.symbolLayers){for(const s of i.symbolLayers)if(!(s.colorLocked||r&&(V7(s)||RP(s)&&s.markerPlacement&&Iw(s.markerPlacement))))switch(s.type){case"CIMPictureMarker":case"CIMPictureStroke":case"CIMPictureFill":s.tintColor&&yb(t,s.tintColor);break;case"CIMVectorMarker":s.markerGraphics?.forEach((n=>{VT(n.symbol,t)}));break;case"CIMSolidStroke":case"CIMSolidFill":yb(t,s.color);break;case"CIMGradientFill":h1e(t,s);break;case"CIMHatchFill":VT(s.lineSymbol,t)}}}function yb(e,t){for(const i of e)if(i.join(".")===t.join("."))return;e.push(t)}function h1e(e,t){switch(t.colorRamp?.type){case"CIMMultipartColorRamp":t.colorRamp.colorRamps?.forEach((r=>{r.type==="CIMLinearContinuousColorRamp"&&C5(e,r)}));break;case"CIMLinearContinuousColorRamp":case"CIMPolarContinuousColorRamp":C5(e,t.colorRamp)}}function C5(e,t){t&&(t.fromColor&&yb(e,t.fromColor),t.toColor&&yb(e,t.toColor))}function pj(e,t,i){t instanceof X||(t=new X(t));const r=kP(e);r&&UT(r,t)}function UT(e,t,i){if(!e)return;let r;r=e.type==="CIMTextSymbol"?e.symbol:e;const s=r?.type==="CIMPolygonSymbol";if(r?.symbolLayers)for(const n of r.symbolLayers){if(n.colorLocked||s&&(V7(n)||RP(n)&&n.markerPlacement&&Iw(n.markerPlacement)))continue;const o=t.toArray();switch(n.type){case"CIMPictureMarker":case"CIMPictureStroke":case"CIMPictureFill":n.tintColor=o;break;case"CIMVectorMarker":n.markerGraphics?.forEach((a=>{UT(a.symbol,t)}));break;case"CIMSolidStroke":case"CIMSolidFill":n.color=o;break;case"CIMGradientFill":d1e(n,t);break;case"CIMHatchFill":UT(n.lineSymbol,t)}}}function d1e(e,t){switch(e.colorRamp?.type){case"CIMMultipartColorRamp":e.colorRamp.colorRamps?.forEach((r=>{r.type==="CIMLinearContinuousColorRamp"&&P5(r,t)}));break;case"CIMLinearContinuousColorRamp":case"CIMPolarContinuousColorRamp":P5(e.colorRamp,t)}}function P5(e,t){if(e&&(e.fromColor&&(e.fromColor=t.toArray()),e.toColor)){const i=t.clone();i.a=0,e.toColor=i.toArray()}}function wRe(e,t,i=!1){const r=kP(e);if(i&&(t=360-t),r?.type!=="CIMTextSymbol"){if(r?.type==="CIMPointSymbol"&&r.symbolLayers){const s=t-(r.angle||0);for(const n of r.symbolLayers)if(RP(n)){let o=n.rotation||0;n.rotateClockwise?o-=s:o+=s,n.rotation=o}r.angle=t}}else r.angle=t}var zt;(function(e){e[e.size=22]="size",e[e.lineWidth=50]="lineWidth",e[e.maxSize=120]="maxSize",e[e.maxOutlineSize=80]="maxOutlineSize",e[e.tallSymbolWidth=20]="tallSymbolWidth"})(zt||(zt={}));const Ny={fill:[{type:"path",path:"M -10,-10 L 10,0 L 10,10 L -10,10 L -10,-10 Z"}],meshSymbol3DFill:[{type:"path",path:"M -10,-8 L 6,0 L 6,6 L -10,6 L -10,-8 Z"},{type:"path",path:"M -10,-8 L -7,-10 L 9,-2 L 6,0 L -10,-8 Z"},{type:"path",path:"M 6,0 L 9,-2 L 9,4 L 6,6 L 6,0 Z"}],pathSymbol3DLayer:[{type:"path",path:"M 3,12 L 12,0 L 11,-2 L -4,5 L -1,5 L 1,7 L 3,10 L 3,12 Z"},{type:"circle",cx:-2,cy:10,r:5}]};function p1e(e,t,i){const r=zt.size;let s=r,n=r;e<1?s*=.75:e>1&&(n*=1.25);const o=0,a=0;let l=r,u=r;return t&&i&&(s=n=l=u=0),[{type:"path",path:[{command:"M",values:[l,o]},{command:"L",values:[i?l:.875*l,o]},{command:"L",values:[i?s-.5*l:a,n-.5*u]},{command:"L",values:[s-.5*l,n-.5*u]},{command:"Z",values:[]}]},{type:"path",path:[{command:"M",values:[l,o]},{command:"L",values:[l,t?o:.125*u]},{command:"L",values:[s-.5*l,t?n-.5*u:u]},{command:"L",values:[s-.5*l,n-.5*u]},{command:"Z",values:[]}]},{type:"path",path:[{command:"M",values:[s-.5*l,n-.5*u]},{command:"L",values:[i?s-.5*l:a,n-.5*u]},{command:"L",values:[i?s-.5*l:a,t?n-.5*u:u]},{command:"L",values:[s-.5*l,t?n-.5*u:u]},{command:"Z",values:[]}]}]}function f1e(e){const t=zt.size,i=.5*e,r=0,s=0;return[{type:"path",path:[{command:"M",values:[s,.7*t*.5]},{command:"L",values:[.3*t,.7*t]},{command:"L",values:[.3*t,.7*t+i]},{command:"L",values:[s,.7*t+i-.7*t*.5]},{command:"Z",values:[]}]},{type:"path",path:[{command:"M",values:[.3*t,.7*t]},{command:"L",values:[.3*t,.7*t+i]},{command:"L",values:[t,i]},{command:"L",values:[t,r]},{command:"Z",values:[]}]},{type:"path",path:[{command:"M",values:[.3*t,r]},{command:"L",values:[t,r]},{command:"L",values:[.3*t,.7*t]},{command:"L",values:[s,.7*t*.5]},{command:"Z",values:[]}]}]}function m1e(){return[{type:"path",path:"M80,80.2v-27c-1.5,0.7-2.8,1.6-3.9,2.8c-1.8,2.1-4.4,3.3-7.1,3.5c-2.7-0.1-5.3-1.4-7.1-3.4c-2.2-2.3-4.7-3.6-7.4-3.6s-5.1,1.3-7.3,3.6c-1.8,2.1-4.4,3.3-7.2,3.4c-2.7-0.1-5.3-1.4-7.1-3.4c-2.2-2.3-4.7-3.6-7.4-3.6s-5.1,1.3-7.4,3.6c-1.8,2.1-4.4,3.3-7.2,3.4C8.3,59.3,5.7,58,3.9,56c-1.1-1.2-2.4-2.1-3.9-2.8v27"},{type:"path",path:"M11,59.4c2.7-0.1,5.3-1.4,7.1-3.4c2.2-2.3,4.7-3.6,7.4-3.6s5.1,1.3,7.4,3.6c1.8,2,4.4,3.3,7.2,3.4c2.7-0.1,5.3-1.4,7.1-3.4c2.2-2.3,4.7-3.6,7.3-3.6s5.1,1.3,7.4,3.6c1.8,2.1,4.4,3.3,7.2,3.4c2.7-0.1,5.3-1.4,7.1-3.4c1.1-1.2,2.4-2.1,3.9-2.8v-24c-1.5,0.7-2.8,1.6-3.9,2.8c-1.8,2.1-4.4,3.3-7.1,3.5c-2.7-0.1-5.3-1.4-7.1-3.4c-2.2-2.3-4.7-3.6-7.4-3.6s-5.1,1.3-7.3,3.6c-1.8,2.1-4.4,3.3-7.2,3.4c-2.7-0.1-5.3-1.4-7.1-3.4c-2.2-2.3-4.7-3.6-7.4-3.6s-5.1,1.3-7.4,3.6c-1.8,2.1-4.4,3.3-7.2,3.4c-2.7-0.1-5.3-1.4-7.1-3.4c-1.1-1.2-2.4-2.1-3.9-2.8v24c1.5,0.7,2.8,1.6,3.9,2.8C5.7,58,8.3,59.3,11,59.4z"},{type:"path",path:"M11,35.4c2.7-0.1,5.3-1.4,7.1-3.4c2.2-2.3,4.7-3.6,7.4-3.6s5.1,1.3,7.4,3.6c1.8,2,4.4,3.3,7.2,3.4c2.7-0.1,5.3-1.4,7.1-3.4c2.2-2.3,4.7-3.6,7.3-3.6s5.1,1.3,7.4,3.6c1.8,2.1,4.4,3.3,7.2,3.4c2.7-0.1,5.3-1.4,7.1-3.4c1.1-1.2,2.4-2.1,3.9-2.8V3.6c-1.5,0.7-2.8,1.6-3.9,2.8c-2.2,2.1-4.6,3.4-7.1,3.4s-5-1.3-7.1-3.4s-4.7-3.6-7.4-3.6s-5.1,1.3-7.3,3.6S42.5,9.9,40,9.9s-5-1.3-7.1-3.4s-4.7-3.6-7.4-3.6s-5.1,1.3-7.3,3.6c-1.8,2.1-4.4,3.3-7.2,3.4c-2.5,0-5-1.3-7.1-3.4C2.8,5.3,1.4,4.3,0,3.6v25.6c1.5,0.7,2.8,1.6,3.9,2.8C5.7,34.1,8.3,35.3,11,35.4z"}]}function y1e(e,t){let i=t?zt.tallSymbolWidth:e;const r=e,s=t?4:6;i<=zt.size?i-=.5*s:i-=s;const n=0,o=0,a=t?.35*i:.5*i;return[{type:"path",path:[{command:"M",values:[.5*i,n]},{command:"L",values:[i,.5*a]},{command:"L",values:[.5*i,a]},{command:"L",values:[o,.5*a]},{command:"Z",values:[]}]},{type:"path",path:[{command:"M",values:[n,.5*a]},{command:"L",values:[.5*i,a]},{command:"L",values:[.5*i,r]},{command:"L",values:[o,r-.5*a]},{command:"Z",values:[]}]},{type:"path",path:[{command:"M",values:[.5*i,a]},{command:"L",values:[.5*i,r]},{command:"L",values:[i,r-.5*a]},{command:"L",values:[i,.5*a]},{command:"Z",values:[]}]}]}function g1e(e,t){let i=t?zt.tallSymbolWidth:e;const r=e,s=t?4:6;i<=zt.size?i-=.5*s:i-=s;const n=.5*i,o=.15*i,a=0,l=r-o;return[{type:"ellipse",cx:.5*i,cy:l,rx:n,ry:o},{type:"path",path:[{command:"M",values:[a,o]},{command:"L",values:[a,l]},{command:"L",values:[i,l]},{command:"L",values:[i,o]},{command:"Z",values:[]}]},{type:"ellipse",cx:.5*i,cy:o,rx:n,ry:o}]}function _1e(e,t){let i=t?zt.tallSymbolWidth:e;const r=e,s=t?4:6;i<=zt.size?i-=.5*s:i-=s;const n=.15*i,o=r-n;return[{type:"ellipse",cx:.5*i,cy:o,rx:.5*i,ry:n},{type:"path",path:[{command:"M",values:[.5*i,0]},{command:"L",values:[i,o]},{command:"L",values:[0,o]},{command:"Z",values:[]}]}]}function v1e(e){let t=e;const i=e,r=6;t<zt.size?t-=.5*r:t-=r;const s=.15*t,n=0;return[{type:"path",path:[{command:"M",values:[0,n]},{command:"L",values:[t,n]},{command:"L",values:[.5*t,i-s]},{command:"Z",values:[]}]},{type:"ellipse",cx:.5*t,cy:n,rx:.5*t,ry:s}]}function b1e(e){let t=e;const i=e,r=4;t<zt.size?t-=.5*r:t-=r;const s=0,n=0,o=t,a=i,l=Math.floor(e/10)-1||1;return[{type:"path",path:[{command:"M",values:[.45*o,s]},{command:"L",values:[o,.5*a-l]},{command:"L",values:[.45*o-l,.5*a+l]},{command:"Z",values:[]}]},{type:"path",path:[{command:"M",values:[.45*o,s]},{command:"L",values:[.45*o-l,.5*a+l]},{command:"L",values:[n,.5*a-l]},{command:"Z",values:[]}]},{type:"path",path:[{command:"M",values:[n,.5*a-l]},{command:"L",values:[.45*o-l,.5*a+l]},{command:"L",values:[.45*o,i]},{command:"Z",values:[]}]},{type:"path",path:[{command:"M",values:[.45*o,i]},{command:"L",values:[o,.5*a-l]},{command:"L",values:[.45*o-l,.5*a+l]},{command:"Z",values:[]}]}]}function w1e(e){const t=e,i=2;let r=e;r<zt.size?r-=.5*i:r-=i;const s=0,n=0;return[{type:"path",path:[{command:"M",values:[.45*t,s]},{command:"L",values:[t,r]},{command:"L",values:[.45*t,.6*r]},{command:"Z",values:[]}]},{type:"path",path:[{command:"M",values:[.45*t,s]},{command:"L",values:[.45*t,.6*r]},{command:"L",values:[n,r]},{command:"Z",values:[]}]},{type:"path",path:[{command:"M",values:[n,r]},{command:"L",values:[.45*t,.6*r]},{command:"L",values:[t,r]},{command:"Z",values:[]}]}]}function au(e,t){return Math.round(Math.min(Math.max(e+255*t*.75,0),255))}function SRe(e,t){if(e==null)return new X;if("type"in e&&(e.type==="linear"||e.type==="pattern"))return e;const i=new X(e);return new X([au(i.r,t),au(i.g,t),au(i.b,t),i.a])}function fj(e){return"r"in e&&"g"in e&&"b"in e}function mj(e){return"h"in e&&"s"in e&&"v"in e}function yj(e){return"l"in e&&"a"in e&&"b"in e}function gj(e){return"l"in e&&"c"in e&&"h"in e}function S1e(e){return"x"in e&&"y"in e&&"z"in e}const x1e=[[.4124,.3576,.1805],[.2126,.7152,.0722],[.0193,.1192,.9505]],$1e=[[3.2406,-1.5372,-.4986],[-.9689,1.8758,.0415],[.0557,-.204,1.057]];function _j(e,t){const i=[];let r,s;if(e[0].length!==t.length)throw new Error("dimensions do not match");const n=e.length,o=e[0].length;let a=0;for(r=0;r<n;r++){for(a=0,s=0;s<o;s++)a+=e[r][s]*t[s];i.push(a)}return i}function vj(e){const t=[e.r/255,e.g/255,e.b/255].map((r=>r<=.04045?r/12.92:((r+.055)/1.055)**2.4)),i=_j(x1e,t);return{x:100*i[0],y:100*i[1],z:100*i[2]}}function VP(e){const t=_j($1e,[e.x/100,e.y/100,e.z/100]).map((i=>{const r=i<=.0031308?12.92*i:1.055*i**.4166666666666667-.055;return Math.min(1,Math.max(r,0))}));return{r:Math.round(255*t[0]),g:Math.round(255*t[1]),b:Math.round(255*t[2])}}function bj(e){const t=[e.x/95.047,e.y/100,e.z/108.883].map((i=>i>.008856451679035631?i**.3333333333333333:7.787037037037035*i+.13793103448275862));return{l:116*t[1]-16,a:500*(t[0]-t[1]),b:200*(t[1]-t[2])}}function wj(e){const t=e.l,i=[(t+16)/116+e.a/500,(t+16)/116,(t+16)/116-e.b/200].map((r=>r>6/29?r**3:3*(6/29)**2*(r-4/29)));return{x:95.047*i[0],y:100*i[1],z:108.883*i[2]}}function M1e(e){const t=e.l,i=e.a,r=e.b,s=Math.sqrt(i*i+r*r);let n=Math.atan2(r,i);return n=n>0?n:n+2*Math.PI,{l:t,c:s,h:n}}function T1e(e){const t=e.l,i=e.c,r=e.h;return{l:t,a:i*Math.cos(r),b:i*Math.sin(r)}}function E1e(e){return bj(vj(e))}function C1e(e){return VP(wj(e))}function P1e(e){return M1e(bj(vj(e)))}function I1e(e){return VP(wj(T1e(e)))}function A1e(e){const t=e.r,i=e.g,r=e.b,s=Math.max(t,i,r),n=s-Math.min(t,i,r);let o=s,a=n===0?0:s===t?(i-r)/n%6:s===i?(r-t)/n+2:(t-i)/n+4,l=n===0?0:n/o;return a<0&&(a+=6),a*=60,l*=100,o*=100/255,{h:a,s:l,v:o}}function L1e(e){const t=(e.h+360)%360/60,i=e.s/100,r=e.v/100*255,s=r*i,n=s*(1-Math.abs(t%2-1));let o;switch(Math.floor(t)){case 0:o={r:s,g:n,b:0};break;case 1:o={r:n,g:s,b:0};break;case 2:o={r:0,g:s,b:n};break;case 3:o={r:0,g:n,b:s};break;case 4:o={r:n,g:0,b:s};break;case 5:case 6:o={r:s,g:0,b:n};break;default:o={r:0,g:0,b:0}}return o.r=Math.round(o.r+r-s),o.g=Math.round(o.g+r-s),o.b=Math.round(o.b+r-s),o}function Eh(e){return fj(e)?e:gj(e)?I1e(e):yj(e)?C1e(e):S1e(e)?VP(e):mj(e)?L1e(e):e}function Lw(e){return mj(e)?e:A1e(Eh(e))}function k1e(e){return yj(e)?e:E1e(Eh(e))}function xRe(e){return gj(e)?e:P1e(Eh(e))}function R1e(e){let{r:t,g:i,b:r,a:s}=e;return s<1&&(t=Math.round(s*t+255*(1-s)),i=Math.round(s*i+255*(1-s)),r=Math.round(s*r+255*(1-s))),new X({r:t,g:i,b:r})}function Sj(e,t){const{r:i,g:r,b:s}=t?.ignoreAlpha?e:R1e(e);return .2126*i+.7152*r+.0722*s}var jT;function $Re(e,t=jT.High){return Sj(e,{ignoreAlpha:!0})>t?new X([0,0,0,e.a]):new X([255,255,255,e.a])}function MRe(e,t){const i=k1e(e);i.l*=1-t;const r=Eh(i),s=e.clone();return s.setColor(r),s.a=e.a,s}function TRe(e,t){const i=e.clone();return i.a*=t,i}function ERe(e,t){const i=Lw(e);i.s*=t;const r=Eh(i),s=e.clone();return s.setColor(r),s.a=e.a,s}function CRe(e){return X.toUnitRGBA(e)}function PRe(e){return Th(e[0],e[1],e[2],e.length>3?e[3]:1)}function IRe(e,t){const i=X.toUnitRGBA(e);return i[3]*=t,i}function ARe(e,t,i={}){if(e.length===0||t<=0)return[];if((e=e.map((r=>typeof r=="string"?new X(r):r))).length===1||t===1){const r=[],s=e[0];for(let n=0;n<t;n++)r.push(s.clone());return r}if(i.shuffle&&(e=RN(V(e),i.seed)),e.length>=t){const r=[],s=(e.length-1)/(t-1);for(let n=0;n<t;n++){const o=Math.round(n*s);r.push(e[o].clone())}return r}return O1e(e,t,i)}function O1e(e,t,i={}){const r=[],s=e.length-1,n=Math.ceil((t-e.length)/s);e:for(let o=0;o<s;o++){const a=e[o],l=e[o+1];for(let u=1;u<=n;u++){const c=u/(n+1);if(r.push(N1e(a,l,c,i)),r.length+e.length===t)break e}}return[...e.map((o=>o.clone())),...RN(r,i.seed??1)]}(function(e){e[e.Low=160]="Low",e[e.High=225]="High"})(jT||(jT={}));const lS=(e,t)=>{const i=Math.floor(10*t())-5;return Math.min(255,Math.max(0,e+i))};function N1e(e,t,i,r={}){const s=e.r,n=e.g,o=e.b,a=t.r,l=t.g,u=t.b,c=Math.round(s+(a-s)*i),d=Math.round(n+(l-n)*i),m=Math.round(o+(u-o)*i);if(!r.offset)return new X([c,d,m]);const y=fE(r.seed);return new X([lS(c,y),lS(d,y),lS(m,y)])}const xj="picture-fill",$j="simple-fill",D1e="simple-line",Mj="simple-marker",F1e="text",z1e="cim",I5=new Map([["dash",[4,3]],["dashdot",[4,3,1,3]],["dot",[1,3]],["longdash",[8,3]],["longdashdot",[8,3,1,3]],["longdashdotdot",[8,3,1,3,1,3]],["shortdash",[4,1]],["shortdashdot",[4,1,1,1]],["shortdashdotdot",[4,1,1,1,1,1]],["shortdot",[1,1]],["solid",[]]]),uS=new x7(1e3);function V1e(e){const t=e.style;let i=null;if(e)switch(e.type){case Mj:t!=="cross"&&t!=="x"&&(i=e.color);break;case $j:t&&t!=="solid"?t!=="none"&&(i={type:"pattern",x:0,y:0,src:vt(`esri/symbols/patterns/${t}.png`),width:5,height:5}):i=e.color;break;case xj:i={type:"pattern",src:e.url,width:Re(e.width)*e.xscale,height:Re(e.height)*e.yscale,x:Re(e.xoffset),y:Re(e.yoffset)};break;case F1e:i=e.color;break;case z1e:i=dj(e)}return i}function U1e(e,t){const i=e+"-"+t;return uS.get(i)!==void 0?Promise.resolve(uS.get(i)):at(e,{responseType:"image"}).then((r=>{const s=r.data,n=s.naturalWidth,o=s.naturalHeight,a=document.createElement("canvas");a.width=n,a.height=o;const l=a.getContext("2d");l.fillStyle=t,l.fillRect(0,0,n,o),l.globalCompositeOperation="destination-in",l.drawImage(s,0,0);const u=a.toDataURL();return uS.put(i,u),u}))}function dg(e){if(!e)return null;let t=null;switch(e.type){case $j:case xj:case Mj:t=dg(e.outline);break;case D1e:{const i=Re(e.width);e.style!=null&&e.style!=="none"&&i!==0&&(t={color:e.color,style:UP(e.style),width:i,cap:e.cap,join:e.join==="miter"?Re(e.miterLimit):e.join},t.dashArray=Tj(t).join(",")||"none");break}default:t=null}return t}function Tj(e){if(!e?.style)return[];const{dashArray:t,style:i,width:r}=e;if(typeof t=="string"&&t!=="none")return t.split(",").map((o=>Number(o)));const s=r??0,n=I5.has(i)?I5.get(i).map((o=>o*s)):[];if(e.cap!=="butt")for(const[o,a]of n.entries())n[o]=o%2==1?a+s:Math.max(a-s,1);return n}const UP=(()=>{const e={};return t=>{if(e[t])return e[t];const i=t.replaceAll("-","");return e[t]=i,i}})(),j1e=new X([128,128,128]);let G1e=0;function B1e(){return G1e++}let q1e=0;function H1e(){return q1e++}let W1e=0;function Z1e(){return W1e++}const Y1e="http://www.w3.org/2000/svg",A5=N("android"),J1e=N("chrome")||A5&&A5>=4?"auto":"optimizeLegibility",X1e={m:2,l:2,h:1,v:1,c:6,s:4,q:4,t:2,a:7,z:0},K1e=/([A-DF-Za-df-z])|([-+]?\d*[.]?\d+(?:[eE][-+]?\d+)?)/g;let Et={},qe={};const Q1e=Math.PI;function ru(e,t){const i=e*(Q1e/180);return Math.abs(t*Math.sin(i))+Math.abs(t*Math.cos(i))}function Ej(e){return e.map((t=>`${t.command} ${t.values.join(" ")}`)).join(" ").trim()}function jP(e,t,i,r,s){if(e){if(e.type==="circle")return L("circle",{cx:e.cx,cy:e.cy,fill:t,"fill-rule":"evenodd",r:e.r,stroke:i.color,"stroke-dasharray":i.dashArray,"stroke-dashoffset":i.dashOffset,"stroke-linecap":i.cap,"stroke-linejoin":i.join,"stroke-miterlimit":"4","stroke-width":i.width});if(e.type==="ellipse")return L("ellipse",{cx:e.cx,cy:e.cy,fill:t,"fill-rule":"evenodd",rx:e.rx,ry:e.ry,stroke:i.color,"stroke-dasharray":i.dashArray,"stroke-linecap":i.cap,"stroke-linejoin":i.join,"stroke-miterlimit":"4","stroke-width":i.width});if(e.type==="rect")return L("rect",{fill:t,"fill-rule":"evenodd",height:e.height,stroke:i.color,"stroke-dasharray":i.dashArray,"stroke-linecap":i.cap,"stroke-linejoin":i.join,"stroke-miterlimit":"4","stroke-width":i.width,width:e.width,x:e.x,y:e.y});if(e.type==="image")return L("image",{alt:s||"image",height:e.height,href:e.src,preserveAspectRatio:"none",width:e.width,x:e.x,y:e.y});if(e.type==="path"){const n=typeof e.path!="string"?Ej(e.path):e.path;return L("path",{d:n,fill:t,"fill-rule":"evenodd",stroke:i.color,"stroke-dasharray":i.dashArray,"stroke-linecap":i.cap,"stroke-linejoin":i.join,"stroke-miterlimit":"4","stroke-width":i.width})}if(e.type==="text")return Tg(r),L("text",{"dominant-baseline":r.dominantBaseline,fill:t,"fill-rule":"evenodd","font-family":r.font.family,"font-size":r.font.size,"font-style":r.font.style,"font-variant":r.font.variant,"font-weight":r.font.weight,kerning:r.kerning,rotate:r.rotate,stroke:i.color,"stroke-dasharray":i.dashArray,"stroke-linecap":i.cap,"stroke-linejoin":i.join,"stroke-miterlimit":"4","stroke-width":i.width,"text-anchor":r.align,"text-decoration":r.decoration,"text-rendering":J1e,x:e.x,y:e.y},e.text)}return null}function GP(e){if(!e)return{fill:"none",pattern:null,linearGradient:null};if(!("type"in e))return{fill:new X(e).toString(),pattern:null,linearGradient:null};if(e.type==="pattern"){const i=`patternId-${B1e()}`;return{fill:`url(#${i})`,pattern:{id:i,x:e.x,y:e.y,width:e.width,height:e.height,image:{x:0,y:0,width:e.width,height:e.height,href:e.src}},linearGradient:null}}const t=`linearGradientId-${H1e()}`;return{fill:`url(#${t})`,pattern:null,linearGradient:{id:t,x1:e.x1,y1:e.y1,x2:e.x2,y2:e.y2,stops:e.colors.map((i=>({offset:i.offset,color:i.color&&new X(i.color).toString()})))}}}function BP(e){const t={color:"none",width:1,cap:"butt",join:"4",dashArray:"none",dashOffset:"0"};return e&&(e.width!=null&&(t.width=e.width),e.cap&&(t.cap=e.cap),e.join&&(t.join=e.join.toString()),e.color&&(t.color=new X(e.color).toString()),e.dashArray&&(t.dashArray=e.dashArray),e.dashoffset&&(t.dashOffset=e.dashoffset),e.style&&!e.dashArray&&(t.dashArray=Tj(e).join(",")||"none")),t}function Cj(e,t){const i={align:null,decoration:null,kerning:null,rotate:null,font:{style:null,variant:null,weight:null,size:null,family:null}};if(e){const r=e.alignBaseline,s=r==="baseline"?"auto":r==="top"?"text-top":r==="bottom"?"hanging":r;i.align=e.align,i.dominantBaseline=s,i.decoration=e.decoration,i.kerning=e.kerning?"auto":"0",i.rotate=e.rotated?"90":"0",Tg(t),i.font.style=t.style||"normal",i.font.variant=t.variant||"normal",i.font.weight=t.weight||"normal",i.font.size=t.size&&t.size.toString()||"10pt",i.font.family=t.family||"serif"}return i}function Pj(e){const{pattern:t,linearGradient:i}=e;if(t)return L("pattern",{height:t.height,id:t.id,patternUnits:"userSpaceOnUse",width:t.width,x:t.x,y:t.y},L("image",{height:t.image.height,href:t.image.href,width:t.image.width,x:t.image.x,y:t.image.y}));if(i){const r=i.stops.map(((s,n)=>L("stop",{key:`${n}-stop`,offset:s.offset,"stop-color":s.color})));return L("linearGradient",{gradientUnits:"userSpaceOnUse",id:i.id,x1:i.x1,x2:i.x2,y1:i.y1,y2:i.y2},r)}return null}function eve(e,t){if(!e||e.length===0)return null;const i=[];for(const r of e){const{shape:s,fill:n,stroke:o,font:a}=r,l=GP(n),u=BP(o),c=s.type==="text"?Cj(s,a):null,d=jP(s,l.fill,u,c);d&&i.push(d)}return L("mask",{id:t,maskUnits:"userSpaceOnUse"},L("g",null,i))}function L5(e,t,i){return Fo(e,Qg(e),[t,i])}function k5(e,t,i,r,s){return e0(e,Qg(e),[t,i]),e[4]=e[4]*t-r*t+r,e[5]=e[5]*i-s*i+s,e}function tve(e,t,i,r){const s=t%360*Math.PI/180;vu(e,Qg(e),s);const n=Math.cos(s),o=Math.sin(s),a=e[4],l=e[5];return e[4]=a*n-l*o+r*o-i*n+i,e[5]=l*n+a*o-i*o-r*n+r,e}function dr(e,t){Et&&"left"in Et?(Et.left!=null&&Et.left>e&&(Et.left=e),(Et.right==null||Et.right<e)&&(Et.right=e),(Et.top==null||Et.top>t)&&(Et.top=t),(Et.bottom==null||Et.bottom<t)&&(Et.bottom=t)):Et={left:e,bottom:t,right:e,top:t}}function R5(e){const t=e.args,i=t.length;let r;switch(e.action){case"M":case"L":case"C":case"S":case"Q":case"T":for(r=0;r<i;r+=2)dr(t[r],t[r+1]);qe.x=t[i-2],qe.y=t[i-1];break;case"H":for(r=0;r<i;++r)dr(t[r],qe.y);qe.x=t[i-1];break;case"V":for(r=0;r<i;++r)dr(qe.x,t[r]);qe.y=t[i-1];break;case"m":{let s=0;for(("x"in qe)||(dr(qe.x=t[0],qe.y=t[1]),s=2),r=s;r<i;r+=2)dr(qe.x+=t[r],qe.y+=t[r+1]);break}case"l":case"t":for(r=0;r<i;r+=2)dr(qe.x+=t[r],qe.y+=t[r+1]);break;case"h":for(r=0;r<i;++r)dr(qe.x+=t[r],qe.y);break;case"v":for(r=0;r<i;++r)dr(qe.x,qe.y+=t[r]);break;case"c":for(r=0;r<i;r+=6)dr(qe.x+t[r],qe.y+t[r+1]),dr(qe.x+t[r+2],qe.y+t[r+3]),dr(qe.x+=t[r+4],qe.y+=t[r+5]);break;case"s":case"q":for(r=0;r<i;r+=4)dr(qe.x+t[r],qe.y+t[r+1]),dr(qe.x+=t[r+2],qe.y+=t[r+3]);break;case"A":for(r=0;r<i;r+=7)dr(t[r+5],t[r+6]);qe.x=t[i-2],qe.y=t[i-1];break;case"a":for(r=0;r<i;r+=7)dr(qe.x+=t[r+5],qe.y+=t[r+6])}}function O5(e,t,i){const r=X1e[e.toLowerCase()];let s;typeof r=="number"&&(r?t.length>=r&&(s={action:e,args:t.slice(0,t.length-t.length%r)},i.push(s),R5(s)):(s={action:e,args:[]},i.push(s),R5(s)))}function ive(e){const t=(typeof e.path!="string"?Ej(e.path):e.path).match(K1e),i=[];if(Et={},qe={},!t)return null;let r="",s=[];const n=t.length;for(let a=0;a<n;++a){const l=t[a],u=parseFloat(l);isNaN(u)?(r&&O5(r,s,i),s=[],r=l):s.push(u)}O5(r,s,i);const o={x:0,y:0,width:0,height:0};return Et&&"left"in Et&&(o.x=Et.left,o.y=Et.top,o.width=Et.right-Et.left,o.height=Et.bottom-Et.top),o}function Ij(e){const t={x:0,y:0,width:0,height:0};if(e.type==="circle")t.x=e.cx-e.r,t.y=e.cy-e.r,t.width=2*e.r,t.height=2*e.r;else if(e.type==="ellipse")t.x=e.cx-e.rx,t.y=e.cy-e.ry,t.width=2*e.rx,t.height=2*e.ry;else if(e.type==="image"||e.type==="rect")t.x=e.x,t.y=e.y,t.width=e.width,t.height=e.height;else if(e.type==="path"){const i=ive(e);t.x=i.x,t.y=i.y,t.width=i.width,t.height=i.height}return t}function Aj(e){const t={x:0,y:0,width:0,height:0};let i=null,r=Number.NEGATIVE_INFINITY,s=Number.NEGATIVE_INFINITY;for(const n of e)i?(i.x=Math.min(i.x,n.x),i.y=Math.min(i.y,n.y),r=Math.max(r,n.x+n.width),s=Math.max(s,n.y+n.height)):(i=t,i.x=n.x,i.y=n.y,r=n.x+n.width,s=n.y+n.height);return i&&(i.width=r-i.x,i.height=s-i.y),i}function GT(e,t,i,r,s,n,o,a,l){let u=(o&&n?ru(n,t):t)/2,c=(o&&n?ru(n,i):i)/2;if(l){const S=l[0],$=l[1];u=(o&&n?ru(n,S):S)/2,c=(o&&n?ru(n,$):$)/2}const d=e.width+r,m=e.height+r,y=Ua(),g=Ua();let _=!1;if(s&&d!==0&&m!==0){const S=t!==i?t/i:d/m,$=t>i?t:i;let E=1,C=1;isNaN($)||(S>1?(E=$/d,C=$/S/m):(C=$/m,E=$*S/d)),so(g,g,k5(y,E,C,u,c)),_=!0}const v=e.x+(d-r)/2,b=e.y+(m-r)/2;if(so(g,g,L5(y,u-v,c-b)),!_&&(d>t||m>i)){const S=d/t>m/i,$=(S?t:i)/(S?d:m);so(g,g,k5(y,$,$,v,b))}return a&&so(g,g,L5(y,a[0],a[1])),n&&so(g,g,tve(y,n,v,b)),`matrix(${g[0]},${g[1]},${g[2]},${g[3]},${g[4]},${g[5]})`}function rve(e,t,i){const r=e?.effects.find((u=>u.type==="bloom"));if(!r)return null;const{strength:s,radius:n}=r,o=s>0?n:0,a=(s+o)*t,l=4*s+1;return L("filter",{filterUnits:"userSpaceOnUse",height:"300%",id:`bloom${i}`,width:"300%",x:"-100%",y:"-100%"},L("feMorphology",{in:"SourceGraphic",operator:"dilate",radius:(s+.5*o)*(5**(t/100)*(.4+t/100)),result:"dilate"}),L("feGaussianBlur",{in:"dilate",result:"blur",stdDeviation:a/25}),L("feGaussianBlur",{in:"blur",result:"intensityBlur",stdDeviation:a/50}),L("feComponentTransfer",{in:"SourceGraphic",result:"intensityBrightness"},L("feFuncR",{slope:l,type:"linear"}),L("feFuncG",{slope:l,type:"linear"}),L("feFuncB",{slope:l,type:"linear"})),L("feMerge",null,L("feMergeNode",{in:"intensityBlur"}),L("feMergeNode",{in:"intensityBrightness"}),L("feGaussianBlur",{stdDeviation:s/10})))}function Lj(e,t,i,r={}){const s=[],n=[],o=Z1e(),a=rve(r.effectView,t,o);let l=null;if(a){const m=r.effectView?.effects.find((v=>v.type==="bloom")),y=r.clipBloomEffect||!m.strength?0:(m.strength+m.radius/2)/3,g=t+t*y,_=i+i*y;l=[Math.max(g,10),Math.max(_,10)]}let u=t,c=i;if(r.useRotationSize)for(let m=0;m<e.length;m++){const y=r.rotations?.[m]??0;u=Math.max(ru(y,t),u),c=Math.max(ru(y,i),c)}for(let m=0;m<e.length;m++){const y=e[m],g=[],_=[];let v=0,b=0,S=0;for(const P of y){const{shape:k,fill:F,stroke:D,font:U,offset:W}=P;r.ignoreStrokeWidth||k.type==="text"||(v+=D?.width||0);const Y=GP(F),re=BP(D),K=k.type==="text"?Cj(k,U):null;s.push(Pj(Y)),g.push(jP(k,Y.fill,re,K,r.ariaLabel)),_.push(Ij(k)),W&&(b+=W[0],S+=W[1])}const $=r.rotations?.[m]??0;r.useRotationSize&&(b+=(u-ru($,t))/2,S+=(c-ru($,i))/2);const E=GT(Aj(_),t,i,v,r.scale??!1,$,r.useRotationSize??!1,[b,S],l);let C=null;if(r.masking){const P=`mask-${m}`,k=r.masking[m];s.push(eve(k,P)),C=`url(#${P})`}n.push(C?L("g",{mask:C},L("g",{transform:E},g)):L("g",{transform:E},g))}return a&&(Tg(l),u=l[0],c=l[1]),L("svg",{"aria-label":r.ariaLabel,focusable:!1,height:c,role:"img",style:"display: block;",width:u,xmlns:Y1e},a,L("defs",null,s),a?L("g",{filter:`url(#bloom${o})`},n):n)}const sve=new X("white");function nve(e){const t=e.symbolLayers?.at(-1);if(t&&"outline"in t)return t?.outline?.size}function ove(e){if(!e)return 0;if(qo(e)){const t=nve(e);return t??0}return We(dg(e)?.width)}function kw(e){if(e==null||!("symbolLayers"in e)||e.symbolLayers==null)return!1;switch(e.type){case"point-3d":return e.symbolLayers.some((t=>t.type==="object"));case"line-3d":return e.symbolLayers.some((t=>t.type==="path"));case"polygon-3d":return e.symbolLayers.some((t=>t.type==="object"||t.type==="extrude"));default:return!1}}function ave(e){return e.resource?.href??""}function LRe(e,t){if(!e)return null;let i=null;return qo(e)?i=lve(e):cw(e)&&(i=e.type==="cim"?dj(e):e.color?new X(e.color):null),i?pg(i,t):null}function lve(e){const t=e.symbolLayers;if(!t)return null;let i=null;return t.forEach((r=>{r.type==="object"&&r.resource?.href||(i=r.type==="water"?r.color:r.material?r.material.color:null)})),i?new X(i):null}function pg(e,t){if(t==null||e==null)return e;const i=e.toRgba();return i[3]=i[3]*t,new X(i)}function uve(e,t,i){const r=e.symbolLayers;if(!r)return;const s=n=>pg(t??n??(i!=null?sve:null),i);r.forEach((n=>{if(n.type!=="object"||!n.resource?.href||t)if(n.type==="water")n.color=s(n.color);else{const o=n.material!=null?n.material.color:null,a=s(o);if(n.material==null?n.material=new Gr({color:a}):n.material.color=a,i!=null&&"outline"in n&&n.outline?.color!=null&&(n.outline.color=pg(n.outline.color,i)),"marker"in n&&n.marker!=null){const l=s(n.marker.color);n.marker.color=l}}}))}function cve(e,t,i){(t=t??e.color)&&(e.color=pg(t,i)),i!=null&&"outline"in e&&e.outline?.color&&(e.outline.color=pg(e.outline.color,i))}function cS(e,t,i){e&&(t||i!=null)&&(t&&(t=new X(t)),qo(e)?uve(e,t,i):cw(e)&&cve(e,t,i))}async function hve(e,t){const i=e.symbolLayers;i&&await BZ(i,(async r=>dve(r,t)))}async function dve(e,t){switch(e.type){case"extrude":fve(e,t);break;case"icon":case"line":case"text":pve(e,t);break;case"path":yve(e,t);break;case"object":await mve(e,t)}}function pve(e,t){const i=kj(t);i!=null&&(e.size=i)}function kj(e){for(const t of e)if(typeof t=="number")return t;return null}function fve(e,t){const i=t[2];typeof i=="number"&&(e.size=i)}async function mve(e,t){const{resourceSize:i,symbolSize:r}=await gve(e),s=Rj(t,i,r);s!=null&&(e.width=Dy(t[0],r[0],i[0],s),e.depth=Dy(t[1],r[1],i[1],s),e.height=Dy(t[2],r[2],i[2],s))}function yve(e,t){const i=Rj(t,tz,[e.width,void 0,e.height]);i!=null&&(e.width=Dy(t[0],e.width,1,i),e.height=Dy(t[2],e.height,1,i))}function Rj(e,t,i){for(let r=0;r<3;r++){const s=e[r];switch(s){case"symbol-value":{const n=i[r];return n!=null?n/t[r]:1}case"proportional":break;default:if(s&&t[r])return s/t[r]}}return null}async function gve(e){const{computeObjectLayerResourceSize:t}=await J(()=>import("./symbolLayerUtils-HwnMlAII.js"),[]),i=await t(e,10),{width:r,height:s,depth:n}=e,o=[r,n,s];let a=1;for(let l=0;l<3;l++){const u=o[l];if(u!=null){a=u/i[l];break}}for(let l=0;l<3;l++)o[l]==null&&(o[l]=i[l]*a);return{resourceSize:i,symbolSize:o}}function Dy(e,t,i,r){switch(e){case"proportional":return i*r;case"symbol-value":return t??i;default:return e}}function _ve(e,t){const i=kj(t);if(i!=null)switch(e.type){case"simple-marker":e.size=i;break;case"picture-marker":{const r=e.width/e.height;r>1?(e.width=i,e.height=i*r):(e.width=i*r,e.height=i);break}case"simple-line":e.width=i;break;case"text":e.font.size=i}}async function vve(e,t){if(e&&t)return qo(e)?hve(e,t):void(cw(e)&&_ve(e,t))}function bve(e,t,i){if(e&&t!=null)if(qo(e)){const r=e.symbolLayers;r&&r.forEach((s=>{if(s.type==="object")switch(i){case"tilt":s.tilt=(s.tilt??0)+t;break;case"roll":s.roll=(s.roll??0)+t;break;default:s.heading=(s.heading??0)+t}s.type==="icon"&&(s.angle+=t)}))}else cw(e)&&(e.type!=="simple-marker"&&e.type!=="picture-marker"&&e.type!=="text"||(e.angle+=t))}function n0(e){if(!e)return null;const t=e.effects.filter((i=>i.type!=="bloom")).map((i=>i.toJSON()));return rb(t)}function kRe(e){return e!=null&&e.type==="polygon-3d"&&e.symbolLayers.some((t=>t.type==="extrude"))}const N5=$v();function wve(e,t){N5.append(e,t),N5.detach(t)}function wf(e,t,i){const r=Math.ceil(t[0]),s=Math.ceil(t[1]);if(!e.some((o=>!!o.length)))return null;const n=i?.node||document.createElement("div");return i.opacity!=null&&(n.style.opacity=i.opacity.toString()),i.effectView!=null&&(n.style.filter=n0(i.effectView)),wve(n,(()=>Lj(e,r,s,i))),n}function Sve(e,t){e=Math.ceil(e),t=Math.ceil(t);const i=document.createElement("canvas");i.width=e,i.height=t,i.style.width=e+"px",i.style.height=t+"px";const r=i.getContext("2d");return r.clearRect(0,0,e,t),r}function xve(e,t,i){return e?at(e,{responseType:"image"}).then((r=>{const s=r.data,n=s.width,o=s.height,a=n/o;let l=t;if(i){const u=Math.max(n,o);l=Math.min(l,u)}return{image:s,width:a<=1?Math.ceil(l*a):l,height:a<=1?l:Math.ceil(l/a)}})):Promise.reject(new j("renderUtils: imageDataSize","href not provided."))}function $ve(e,t){return!(!e||t==="ignore")&&(t!=="multiply"||e.r!==255||e.g!==255||e.b!==255||e.a!==1)}function Mve(e,t,i,r,s){switch(s){case"multiply":e[t]*=i[0],e[t+1]*=i[1],e[t+2]*=i[2],e[t+3]*=i[3];break;default:{const n=Lw({r:e[t],g:e[t+1],b:e[t+2]});n.h=r.h,n.s=r.s,n.v=n.v/100*r.v;const o=Eh(n);e[t]=o.r,e[t+1]=o.g,e[t+2]=o.b,e[t+3]*=i[3];break}}}function Tve(e,t,i,r,s){return xve(e,t,s).then((n=>{const o=n.width??t,a=n.height??t;if(n.image&&$ve(i,r)){let l=n.image.width,u=n.image.height;N("edge")&&/\.svg$/i.test(e)&&(l-=1,u-=1);const c=Sve(o,a);c.drawImage(n.image,0,0,l,u,0,0,o,a);const d=c.getImageData(0,0,o,a),m=[i.r/255,i.g/255,i.b/255,i.a],y=Lw(i);for(let g=0;g<d.data.length;g+=4)Mve(d.data,g,m,y,r);c.putImageData(d,0,0),e=c.canvas.toDataURL("image/png")}else{const l=ot?.findCredential(e);if(l?.token){const u=e.includes("?")?"&":"?";e=`${e}${u}token=${l.token}`}}return{url:e,width:o,height:a}})).catch((()=>({url:e,width:t,height:t})))}const Oj="esri-relationship-ramp",Jh=`${Oj}--diamond`,pl=`${Oj}--square`,Eve="http://www.w3.org/2000/svg",ut={diamondContainer:`${Jh}__container`,diamondLeftCol:`${Jh}__left-column`,diamondRightCol:`${Jh}__right-column`,diamondMidCol:`${Jh}__middle-column`,diamondMidColLabel:`${Jh}__middle-column--label`,diamondMidColRamp:`${Jh}__middle-column--ramp`,squareTable:`${pl}__table`,squareTableRow:`${pl}__table-row`,squareTableCell:`${pl}__table-cell`,squareTableLabel:`${pl}__table-label`,squareTableLabelLeftBottom:`${pl}__table-label--left-bottom`,squareTableLabelRightBottom:`${pl}__table-label--right-bottom`,squareTableLabelLeftTop:`${pl}__table-label--left-top`,squareTableLabelRightTop:`${pl}__table-label--right-top`};function Nj(e,t,i={}){const{focus:r,labels:s}=e,n=!!r,o=Cve(e,t,i),a={justifyContent:"center"},l=_w(),u=i.key??t;return n?L("div",{class:ut.diamondContainer,key:`${u}-container`,styles:a},L("div",{class:ut.diamondLeftCol},l?s.right:s.left),L("div",{class:ut.diamondMidCol},L("div",{class:ut.diamondMidColLabel},s.top),o,L("div",{class:ut.diamondMidColLabel},s.bottom)),L("div",{class:ut.diamondRightCol},l?s.left:s.right)):L("div",{class:ut.squareTable,key:`${u}-container`},L("div",{class:ut.squareTableRow},L("div",{class:Dd(ut.squareTableCell,ut.squareTableLabel,ut.squareTableLabelRightBottom)},l?s.top:s.left),L("div",{class:ut.squareTableCell}),L("div",{class:Dd(ut.squareTableCell,ut.squareTableLabel,ut.squareTableLabelLeftBottom)},l?s.left:s.top)),L("div",{class:ut.squareTableRow},L("div",{class:ut.squareTableCell}),o,L("div",{class:ut.squareTableCell})),L("div",{class:ut.squareTableRow},L("div",{class:Dd(ut.squareTableCell,ut.squareTableLabel,ut.squareTableLabelRightTop)},l?s.right:s.bottom),L("div",{class:ut.squareTableCell}),L("div",{class:Dd(ut.squareTableCell,ut.squareTableLabel,ut.squareTableLabelLeftTop)},l?s.bottom:s.right)))}function D5(e,t,i){const r=`${i}_arrowStart`,s=`${i}_arrowEnd`,n=e==="left",o={markerStart:null,markerEnd:null};switch(t){case"HL":n?o.markerStart=`url(#${s})`:o.markerEnd=`url(#${r})`;break;case"LL":o.markerStart=`url(#${s})`;break;case"LH":n?o.markerEnd=`url(#${r})`:o.markerStart=`url(#${s})`;break;default:o.markerEnd=`url(#${r})`}return o}function Cve(e,t,i={}){const{focus:r,numClasses:s,colors:n,rotation:o}=e,{opacity:a,effectList:l,ariaLabel:u}=i,c=i.size??60,d=!!r,m=Math.sqrt(c**2+c**2)+(d?0:5),y=[],g=[],_=[],v=(c||75)/s;for(let W=0;W<s;W++){const Y=W*v;for(let re=0;re<s;re++){const K=re*v,Ce=GP(n[W][re]),Ve=BP(null),Je={type:"rect",x:K,y:Y,width:v,height:v},Oe=Pj(Ce);Oe&&y.push(Oe);const Lt=jP(Je,Ce.fill,Ve,null);Lt&&g.push(Lt),_.push(Ij(Je))}}const b=15,S=15,$=10;let E=null;d||(E="margin: -15px -15px -18px -15px");const C=D5("left",r,t),P=D5("right",r,t),k=Aj(_),F=GT(k,m,m,0,!1,o,!1),D=GT(k,m,m,0,!1,d?-45:null,!1),U={filter:n0(l)??void 0,opacity:a==null?"":`${a}`};return L("div",{class:d?ut.diamondMidColRamp:ut.squareTableCell,styles:U},L("svg",{"aria-label":u,focusable:!1,height:m,role:"image",style:E,width:m,xmlns:Eve},L("defs",null,L("marker",{id:`${t}_arrowStart`,markerHeight:"10",markerUnits:"strokeWidth",markerWidth:"10",orient:"auto",refX:"5",refY:"5"},L("polyline",{fill:"none",points:"0,0 5,5 0,10",stroke:"#555555","stroke-width":"1"})),L("marker",{id:`${t}_arrowEnd`,markerHeight:"10",markerUnits:"strokeWidth",markerWidth:"10",orient:"auto",refX:"0",refY:"5"},L("polyline",{fill:"none",points:"5,0 0,5 5,10",stroke:"#555555","stroke-width":"1"})),y),L("g",{transform:F},g),L("g",{transform:D},L("line",{fill:"none","marker-end":C.markerEnd,"marker-start":C.markerStart,stroke:"#555555","stroke-width":"1",x1:-10,x2:-10,y1:c-b,y2:b}),L("line",{fill:"none","marker-end":P.markerEnd,"marker-start":P.markerStart,stroke:"#555555","stroke-width":"1",x1:S,x2:c-S,y1:c+$,y2:c+$}))))}function Pve(e){return e=e||globalThis.location.hostname,Ive.some((t=>e?.match(t)!=null))}function F5(e,t){return e?(t=t||globalThis.location.hostname)?t.match(Dj)!=null||t.match(zj)!=null?e.replace("static.arcgis.com","staticdev.arcgis.com"):t.match(Fj)!=null||t.match(Vj)!=null?e.replace("static.arcgis.com","staticqa.arcgis.com"):e:e:null}const Dj=/^devext\.arcgis\.com$/,Fj=/^qaext\.arcgis\.com$/,zj=/^[\w-]*\.mapsdevext\.arcgis\.com$/,Vj=/^[\w-]*\.mapsqa\.arcgis\.com$/,Ive=[/^([\w-]*\.)?[\w-]*\.zrh-dev-local\.esri\.com$/,Dj,Fj,/^jsapps\.esri\.com$/,zj,Vj],Ave=["web-gltf","web","cim"];function Uj(e,t,i){const r=e.name;return r==null?Promise.reject(new j("symbolstyleutils:style-symbol-reference-name-missing","Missing name in style symbol reference")):e.styleName==="Esri2DPointSymbolsStyle"?Lve(r,t,i):aj(e,t,i).then((s=>Gj(s,r,t,j_e,i)))}function jj(e,t){return t.items.find((i=>i.name===e))}async function Gj(e,t,i,r,s){const n=i?.portal!=null?i.portal:Z.getDefault(),o={portal:n,url:Li(e.baseUrl)},a=jj(t,e.data);if(!a)throw new j("symbolstyleutils:symbol-name-not-found",`The symbol name '${t}' could not be found`,{symbolName:t});const l=s?.acceptedFormats??Ave,u=r(a,l);if(!u)throw new j("symbolstyleutils:symbol-reference-no-accepted-format",`The symbol name '${t}' does not have an accepted format (one of ${l})`,{symbolName:t});const{url:c,format:d}=u;let m=Ga(c,o),y=a.thumbnail?.href??null;const g=a.thumbnail?.imageData;Pve()&&(m=F5(m)??"",y=F5(y));const _={portal:n,url:Li(PE(m)),origin:"portal-item"};return NP(m,s).then((v=>{const b=d==="cim"?lj(v.data):v.data,S=w7(b,_);if(S&&qo(S)){if(y){const $=Ga(y,o);S.thumbnail=new qc({url:$})}else g&&(S.thumbnail=new qc({url:`data:image/png;base64,${g}`}));e.styleUrl?S.styleOrigin=new Sn({portal:i.portal,styleUrl:e.styleUrl,name:t}):e.styleName&&(S.styleOrigin=new Sn({portal:i.portal,styleName:e.styleName,name:t}))}return S}))}function Lve(e,t,i){const r=G_e.replaceAll(/\{SymbolName\}/gi,e),s=t.portal!=null?t.portal:Z.getDefault();return NP(r,i).then((n=>{const o=lj(n.data);return w7(o,{portal:s,url:Li(PE(r)),origin:"portal-item"})}))}const kve=Object.freeze(Object.defineProperty({__proto__:null,fetchSymbolFromStyle:Gj,getStyleItemFromStyle:jj,resolveWebStyleSymbol:Uj},Symbol.toStringTag,{value:"Module"})),Ec=zt.size,A1=zt.maxSize,qP=zt.maxOutlineSize,z5=zt.lineWidth,BT=zt.tallSymbolWidth;function qd(e){const t=e.outline,i=e.material!=null?e.material.color:null,r=i!=null?i.toHex():null;if(t==null||"pattern"in t&&t.pattern!=null&&t.pattern.type==="style"&&t.pattern.style==="none")return e.type==="fill"&&r==="#ffffff"?{color:"#bdc3c7",width:.75}:null;const s=Re(t.size)||0;return{color:"rgba("+(t.color!=null?t.color.toRgba():"255,255,255,1")+")",width:Math.min(s,qP),style:"pattern"in t&&t.pattern!=null&&t.pattern.type==="style"?UP(t.pattern.style):null,join:"butt",cap:"patternCap"in t?t.patternCap:"butt"}}async function Rve(e,t){if(e.thumbnail?.url)return e.thumbnail.url;if(t.type==="icon"&&t?.resource?.href)return ave(t);const i=vt("esri/images/Legend/legend3dsymboldefault.png");if(e.styleOrigin&&(e.styleOrigin.styleName||e.styleOrigin.styleUrl)){const r=await Uj(e.styleOrigin,{portal:e.styleOrigin.portal}).catch((()=>null));if(r&&"thumbnail"in r&&r.thumbnail?.url)return r.thumbnail.url}return i}function hS(e,t=1){const i=e.a,r=Lw(e),s=r.h,n=r.s/t,o=100-(100-r.v)/t,{r:a,g:l,b:u}=Eh({h:s,s:n,v:o});return[a,l,u,i]}function gb(e){return e.type==="water"?e.color==null?null:e.color:e.material?.color==null?null:e.material.color}function je(e,t=0){const i=gb(e);if(!i){if(e.type==="fill")return null;const s=j1e.r,n=au(s,t);return[n,n,n,100]}const r=i.toRgba();for(let s=0;s<3;s++)r[s]=au(r[s],t);return r}async function Bj(e,t){const i=e.style;return i==="none"?null:{type:"pattern",x:0,y:0,src:await U1e(vt(`esri/symbols/patterns/${i}.png`),t.toCss(!0)),width:5,height:5}}function V5(e){return e.outline?qd(e):{color:"rgba(0, 0, 0, 1)",width:1.5}}function HP(e,t){const i=gb(e);if(!i)return null;let r="rgba(";return r+=au(i.r,t)+",",r+=au(i.g,t)+",",r+=au(i.b,t)+",",r+i.a+");"}function qT(e,t){const i=HP(e,t);return i?"pattern"in e&&e.pattern!=null&&e.pattern.type==="style"&&e.pattern.style==="none"?null:{color:i,width:Math.min(e.size?Re(e.size):.75,qP),style:"pattern"in e&&e.pattern!=null&&e.pattern.type==="style"?UP(e.pattern.style):null,cap:"cap"in e?e.cap:null,join:"join"in e?e.join==="miter"?Re(2):e.join:null}:{}}function i_(e,t,i){const r=i!=null?.75*i:0;return{type:"linear",x1:r?.25*r:0,y1:r?.5*r:0,x2:r||4,y2:r?.5*r:4,colors:[{color:e,offset:0},{color:t,offset:1}]}}function Ove(e){const t=e.depth,i=e.height,r=e.width;return r!==0&&t!==0&&i!==0&&r===t&&r!=null&&i!=null&&r<i}function Nve(e,t,i){const r=[];if(!e)return r;switch(e.type){case"icon":{const o=t,a=t;switch(e.resource?.primitive??yoe){case"circle":r.push({shape:{type:"circle",cx:0,cy:0,r:.5*t},fill:je(e,0),stroke:qd(e)});break;case"square":r.push({shape:{type:"path",path:[{command:"M",values:[0,a]},{command:"L",values:[0,0]},{command:"L",values:[o,0]},{command:"L",values:[o,a]},{command:"Z",values:[]}]},fill:je(e,0),stroke:qd(e)});break;case"triangle":r.push({shape:{type:"path",path:[{command:"M",values:[0,a]},{command:"L",values:[.5*o,0]},{command:"L",values:[o,a]},{command:"Z",values:[]}]},fill:je(e,0),stroke:qd(e)});break;case"cross":r.push({shape:{type:"path",path:[{command:"M",values:[.5*o,0]},{command:"L",values:[.5*o,a]},{command:"M",values:[0,.5*a]},{command:"L",values:[o,.5*a]}]},stroke:V5(e)});break;case"x":r.push({shape:{type:"path",path:[{command:"M",values:[0,0]},{command:"L",values:[o,a]},{command:"M",values:[o,0]},{command:"L",values:[0,a]}]},stroke:V5(e)});break;case"kite":r.push({shape:{type:"path",path:[{command:"M",values:[0,.5*a]},{command:"L",values:[.5*o,0]},{command:"L",values:[o,.5*a]},{command:"L",values:[.5*o,a]},{command:"Z",values:[]}]},fill:je(e,0),stroke:qd(e)})}break}case"object":switch(e.resource?.primitive??woe){case"cone":{const s=i_(je(e,0),je(e,-.6),i?BT:t),n=_1e(t,i);r.push({shape:n[0],fill:s},{shape:n[1],fill:s});break}case"inverted-cone":{const s=je(e,0),n=i_(s,je(e,-.6),t),o=v1e(t);r.push({shape:o[0],fill:n},{shape:o[1],fill:s});break}case"cube":{const s=y1e(t,i);r.push({shape:s[0],fill:je(e,0)},{shape:s[1],fill:je(e,-.3)},{shape:s[2],fill:je(e,-.5)});break}case"cylinder":{const s=i_(je(e,0),je(e,-.6),i?BT:t),n=g1e(t,i);r.push({shape:n[0],fill:s},{shape:n[1],fill:s},{shape:n[2],fill:je(e,0)});break}case"diamond":{const s=b1e(t);r.push({shape:s[0],fill:je(e,-.3)},{shape:s[1],fill:je(e,0)},{shape:s[2],fill:je(e,-.3)},{shape:s[3],fill:je(e,-.7)});break}case"sphere":{const s=i_(je(e,0),je(e,-.6));s.x1=0,s.y1=0,s.x2=.25*t,s.y2=.25*t,r.push({shape:{type:"circle",cx:0,cy:0,r:.5*t},fill:s});break}case"tetrahedron":{const s=w1e(t);r.push({shape:s[0],fill:je(e,-.3)},{shape:s[1],fill:je(e,0)},{shape:s[2],fill:je(e,-.6)});break}}break}return r}function Rw(e){const t=typeof e?.size=="number"?e?.size:null;return t?Re(t):null}function Dve(e){return e.type==="icon"?"multiply":"tint"}async function Fve(e,t){const i=Rw(t),r=t?.maxSize?Re(t.maxSize):null,s=t?.disableUpsampling??!1,n=e.symbolLayers,o=[],a=[];let l=!1,u=0,c=0,d=0;n.forEach((g=>{if(g.type!=="icon"&&g.type!=="object")return;g&&g.type==="icon"&&(d=Math.max(g.size&&Re(g.size),d));const _=g.type==="icon"?g.size&&Re(g.size):0,v=i||_?Math.ceil(Math.min(i||_,r||A1)):Ec;let b=g.type==="icon"?g.angle:null;if(t?.rotation!=null&&(b=(b??0)+t.rotation),a.push(b),g?.resource?.href){const S=Rve(e,g).then(($=>{const E=g?.material?.color,C=Dve(g);return Tve($,v,E,C,s)})).then(($=>{const E=$.width,C=$.height;return u=Math.max(u,E),c=Math.max(c,C),b&&(l=!0),[{shape:{type:"image",x:0,y:0,width:E,height:C,src:$.url},fill:null,stroke:null}]}));o.push(S)}else{let S=v;g.type==="icon"&&i&&(S=v*(_/d));const $=t?.symbolConfig==="tall"||t?.symbolConfig?.isTall||g.type==="object"&&Ove(g);u=Math.max(u,$?BT:S),c=Math.max(c,S),b&&g.resource?.primitive&&["square","triangle","x"].includes(g.resource?.primitive)&&(l=!0),o.push(Promise.resolve(Nve(g,S,$)))}}));const m=await Promise.allSettled(o),y=[];return m.forEach((g=>{g.status==="fulfilled"?y.push(g.value):g.reason&&H.getLogger("esri.symbols.support.previewSymbol3D").warn("error while building swatchInfo!",g.reason)})),wf(y,[u,c],{node:t?.node,scale:!1,opacity:t?.opacity,ariaLabel:t?.ariaLabel,rotations:a,useRotationSize:l})}function zve(e,t){const i=e.symbolLayers,r=[],s=kw(e),n=Rw(t),o=(t?.maxSize?Re(t.maxSize):null)||qP;let a,l=0,u=0;return i.forEach(((c,d)=>{if(!c||c.type!=="line"&&c.type!=="path")return;const m=[];switch(c.type){case"line":{const y=qT(c,0);if(y==null)break;const g=y?.width||0;d===0&&(a=g);const _=Math.min(n||g,o),v=d===0?_:n?_*(g/a):_,b=v>z5/2?2*v:z5;u=Math.max(u,v),l=Math.max(l,b),y.width=v,m.push({shape:{type:"path",path:[{command:"M",values:[0,.5*u]},{command:"L",values:[l,.5*u]}]},stroke:y});break}case"path":{const y=Math.min(n||Ec,o),g=je(c,0),_=je(c,-.2),v=HP(c,-.4),b=v?{color:v,width:1}:{};if(c.profile==="quad"){const S=c.width,$=c.height,E=p1e(S&&$?S/$:1,$===0,S===0),C={...b,join:"bevel"};m.push({shape:E[0],fill:_,stroke:C},{shape:E[1],fill:_,stroke:C},{shape:E[2],fill:g,stroke:C})}else m.push({shape:Ny.pathSymbol3DLayer[0],fill:_,stroke:b},{shape:Ny.pathSymbol3DLayer[1],fill:g,stroke:b});u=Math.max(u,y),l=u}}r.push(m)})),Promise.resolve(wf(r,[l,u],{node:t?.node,scale:s,opacity:t?.opacity,ariaLabel:t?.ariaLabel}))}async function Vve(e,t){const i=e.type==="mesh-3d",r=e.symbolLayers,s=Rw(t),n=t?.maxSize?Re(t.maxSize):null,o=s||Ec,a=[];let l=0,u=0,c=!1;for(let d=0;d<r.length;d++){const m=r.at(d),y=[];if(!i||m.type==="fill"){switch(m.type){case"fill":{const g=Math.min(o,n||A1);if(l=Math.max(l,g),u=Math.max(u,g),c=!0,i){const _=Ny.meshSymbol3DFill,v=HP(m,-.4),b=v?{color:v,width:1,join:"round"}:{};y.push({shape:_[0],fill:je(m,0),stroke:b},{shape:_[1],fill:je(m,-.2),stroke:b},{shape:_[2],fill:je(m,-.6),stroke:b})}else{let _=je(m,0);const v="pattern"in m?m.pattern:null,b=qd(m),S=gb(m);v!=null&&v.type==="style"&&v.style!=="solid"&&S&&(_=await Bj(v,S)),y.push({shape:Ny.fill[0],fill:_,stroke:b})}break}case"line":{const g=qT(m,0);if(g==null)break;const _={stroke:g,shape:Ny.fill[0]};l=Math.max(l,Ec),u=Math.max(u,Ec),y.push(_);break}case"extrude":{const g={join:"round",width:1,...qT(m,-.4)},_=je(m,0),v=je(m,-.2),b=Math.min(o,n||A1),S=f1e(b);g.width=1,y.push({shape:S[0],fill:v,stroke:g},{shape:S[1],fill:v,stroke:g},{shape:S[2],fill:_,stroke:g});const $=Ec,E=.7*Ec+.5*b;l=Math.max(l,$),u=Math.max(u,E);break}case"water":{const g=gb(m),_=hS(g),v=hS(g,2),b=hS(g,3),S=m1e();c=!0,y.push({shape:S[0],fill:_},{shape:S[1],fill:v},{shape:S[2],fill:b});const $=Math.min(o,n||A1);l=Math.max(l,$),u=Math.max(u,$);break}}a.push(y)}}return wf(a,[l,u],{node:t?.node,scale:c,opacity:t?.opacity,ariaLabel:t?.ariaLabel})}function Uve(e,t){if(e.symbolLayers.length===0)return Promise.reject(new j("symbolPreview: renderPreviewHTML3D","No symbolLayers in the symbol."));switch(e.type){case"point-3d":return Fve(e,t);case"line-3d":return zve(e,t);case"polygon-3d":case"mesh-3d":return Vve(e,t)}return Promise.reject(new j("symbolPreview: swatchInfo3D","symbol not supported."))}const jve=Object.freeze(Object.defineProperty({__proto__:null,getPatternDescriptor:Bj,getSizeFromOptions:Rw,getSymbolLayerFill:je,previewSymbol3D:Uve},Symbol.toStringTag,{value:"Module"})),U5={HH:315,HL:45,LL:135,LH:225},Gve={2:[["HL","HH"],["LL","LH"]],3:[["HL","HM","HH"],["ML","MM","MH"],["LL","LM","LH"]],4:[["HL","HM1","HM2","HH"],["M2L","M2M1","M2M2","M2H"],["M1L","M1M1","M1M2","M1H"],["LL","LM1","LM2","LH"]]};function Bve(e){if(!e)return;const{type:t}=e;if(t.includes("3d"))return je(e.symbolLayers.at(0));if(t==="simple-line"){const i=dg(e);return i&&i.color}if(e.type==="simple-marker"&&(e.style==="x"||e.style==="cross")){const i=dg(e);return i&&i.color}return V1e(e)}function qve(e,t){const i=t.HH.label,r=t.LL.label,s=t.HL.label,n=t.LH.label;switch(e){case"HH":default:return{top:i,bottom:r,left:s,right:n};case"HL":return{top:s,bottom:n,left:r,right:i};case"LL":return{top:r,bottom:i,left:n,right:s};case"LH":return{top:n,bottom:s,left:i,right:r}}}function Hve(e){const{focus:t,infos:i,numClasses:r}=e,s=Gve[r],n={};i.forEach((a=>{n[a.value]={label:a.label,fill:Bve(a.symbol)}}));const o=[];for(let a=0;a<r;a++){const l=[];for(let u=0;u<r;u++){const c=n[s[a][u]];l.push(c.fill)}o.push(l)}return{type:"relationship-ramp",numClasses:r,focus:t,colors:o,labels:qve(t,n),rotation:qj(t)}}function qj(e){let t=U5[e];return e&&t==null&&(t=U5.HH),t||0}let Xh=null;const j5=[255,255,255];function G5(e,t){return Math.floor(Math.random()*(t-e+1)+e)}function Wve(e,t,i){const{backgroundColor:r,outline:s,dotSize:n}=e,o=i?.swatchSize||zt.size,a=.8,l=Math.round(o*o/Math.max(n,.5)**2*a),u=window.devicePixelRatio,c=document.createElement("canvas"),d=o*u;c.width=d,c.height=d,c.style.width=c.width/u+"px",c.style.height=c.height/u+"px";const m=c.getContext("2d");if(r&&(m.fillStyle=r.toCss(!0),m.fillRect(0,0,d,d),m.fill()),m.fillStyle=t?.toCss(!0)??"",Xh&&Xh.length/2===l)for(let g=0;g<2*l;g+=2){const _=Xh[g],v=Xh[g+1];m.fillRect(_,v,n*u,n*u),m.fill()}else{Xh=[];for(let g=0;g<2*l;g+=2){const _=G5(0,d),v=G5(0,d);Xh.push(_,v),m.fillRect(_,v,n*u,n*u),m.fill()}}s&&(s.color&&(m.strokeStyle=s.color.toCss(!0)),m.lineWidth=s.width,m.strokeRect(0,0,d,d));const y=new Image(o,o);return y.src=c.toDataURL(),y.ariaLabel=i?.ariaLabel??null,y.alt=i?.ariaLabel??"",y}function Zve(e,t={}){const i=t.radius||40,r=2*Math.PI*i,s=e.length,n=r/s,o=[],a=dg(t.outline);a?.width!=null&&(a.width*=2),(a||t.backgroundColor)&&o.push({shape:{type:"circle",cx:i,cy:i,r:i},fill:t.backgroundColor,stroke:a,offset:[0,0]});const l=t.values,u=l&&l.length===s&&l.reduce(((g,_)=>g+_),0)===100,c=[0];for(let g=0;g<s;g++){let _=null;u&&(_=l[g]*r/100,c.push(_+c[g])),o.push({shape:{type:"circle",cx:i,cy:i,r:i/2},fill:[0,0,0,0],stroke:{width:i,dashArray:`${(_??n)/2} ${r}`,dashoffset:"-"+(u?c[g]/2:g*(n/2)),color:e[g]},offset:[0,0]})}let d=null;const m=2*i+(a?.width||0),y=t.holePercentage;if(y){a&&o.push({shape:{type:"circle",cx:i,cy:i,r:i*y},fill:null,stroke:a,offset:[0,0]});const g=m/2;d=[[{shape:{type:"circle",cx:g,cy:g,r:g},fill:j5,stroke:a?{...a,color:j5}:null,offset:[0,0]},{shape:{type:"circle",cx:g,cy:g,r:i*y},fill:[0,0,0],stroke:null,offset:[0,0]}]]}return wf([o],[m,m],{effectView:t.effectList,ignoreStrokeWidth:!0,masking:d,rotations:[-90],ariaLabel:t.ariaLabel})}function ac(e,t={}){const s=t.align==="horizontal",n=s?75:24,o=s?24:75,a=t.width??n,l=t.height??o,u=t.gradient??!0,c=window.devicePixelRatio,d=a*c,m=l*c,y=document.createElement("canvas");y.width=d,y.height=m,y.ariaLabel=t.ariaLabel??null,y.style.width=`${a}px`,y.style.height=`${l}px`;const g=y.getContext("2d"),_=s?d:0,v=s?0:m;if(u){const S=g.createLinearGradient(0,0,_,v),$=e.length,E=$===1?0:1/($-1);e.forEach(((C,P)=>S.addColorStop(P*E,C.toString()))),g.fillStyle=S,g.fillRect(0,0,d,m)}else{const S=s?d/e.length:d,$=s?m:m/e.length;let E=0,C=0;for(const P of e)g.fillStyle=P.toString(),g.fillRect(E,C,S,$),E=s?E+S:0,C=s?0:C+$}const b=document.createElement("div");return b.style.width=`${a}px`,b.style.height=`${l}px`,Yve(b,t?.effectList),b.appendChild(y),b}function Yve(e,t){if(!t)return;e.style.filter=n0(t);const i=t.effects;if(i){for(const r of i)if(r?.type==="drop-shadow"){r.offsetX<0?e.style.marginLeft=`${Math.abs(r.offsetX)}px`:e.style.marginRight=`${r.offsetX}px`;break}}}async function Hj(e,t){switch(e.type){case"web-style":{const{previewWebStyleSymbol:i}=await J(()=>import("./previewWebStyleSymbol-BqViAp3U.js"),[]);return i(e,Hj,t)}case"label-3d":case"line-3d":case"mesh-3d":case"point-3d":case"polygon-3d":{const{previewSymbol3D:i}=await J(()=>Promise.resolve().then(()=>jve),void 0);return i(e,t)}case"simple-marker":case"simple-line":case"simple-fill":case"picture-marker":case"picture-fill":case"text":{const{previewSymbol2D:i}=await J(()=>import("./previewSymbol2D-BK8C7ME4.js"),[]);return i(e,t)}case"cim":{const{previewCIMSymbol:i}=await J(()=>Promise.resolve().then(()=>pxe),void 0);return i(e,t)}default:return}}function Wj(e){return e&&"opacity"in e?e.opacity*Wj(e.parent):1}async function RRe(e,t){if(!e)return;const i=e.sourceLayer,r=(t!=null&&t.useSourceLayer?i:e.layer)??i,s=t?.ignoreOpacity?1:Wj(r);if(e.symbol!=null&&(t==null||t.ignoreGraphicSymbol!==!0)){const $=e.symbol.type==="web-style"?await e.symbol.fetchSymbol({...t,acceptedFormats:t?.webStyleAcceptedFormats,cache:t?.webStyleCache}):e.symbol.clone();return cS($,null,s),$}const n=t?.renderer??Jve(r);let o=n&&"getSymbolAsync"in n?await n.getSymbolAsync(e,t):null;if(!o)return;if(o=o.type==="web-style"?await o.fetchSymbol({...t,acceptedFormats:t?.webStyleAcceptedFormats,cache:t?.webStyleCache}):o.clone(),!n||!("visualVariables"in n)||!n.visualVariables?.length)return cS(o,null,s),o;if("arcadeRequiredForVisualVariables"in n&&n.arcadeRequiredForVisualVariables&&t?.arcade==null){const $={...t};$.arcade=await _u(),t=$}const{getColor:a,getOpacity:l,getAllSizes:u,getRotationAngle:c}=await J(()=>Promise.resolve().then(()=>Mh),void 0),d=[],m=[],y=[],g=[];for(const $ of n.visualVariables)switch($.type){case"color":d.push($);break;case"opacity":m.push($);break;case"rotation":g.push($);break;case"size":$.target||y.push($)}const _=!!d.length&&d[d.length-1],v=_?a(_,e,t):null,b=!!m.length&&m[m.length-1];let S=b?l(b,e,t):null;if(s!=null&&(S=S!=null?S*s:s),t?.ignoreOpacity&&(S=1),v!=null&&b&&S!=null&&(v.a=1),cS(o,v,S),y.length&&t?.ignoreSizeVariables!==!0){const $=u(y,e,t);await vve(o,$)}if(t?.ignoreRotationVariables!==!0)for(const $ of g)bve(o,c($,e,t),$.axis);return o}function Jve(e){if(e)return"renderer"in e?e.renderer:void 0}function Xve(e,t,i){const r=e.effectiveClusterRenderer;if(!r||!("visualVariables"in r)||!r.visualVariables)return null;const s=r.visualVariables.find((c=>c.type==="size"));if(!("stops"in s)||!s.stops)return null;const n=s.stops.find((c=>c.useMinValue)),o=s.stops.find((c=>c.useMaxValue));if(n==null||o==null)return null;const a=i.featuresTilingScheme.getClosestInfoForScale(i.scale).level,l=s.field,u=t.getDisplayStatistics(a,l);return u?new De({field:s.field,minSize:e.clusterMinSize,minDataValue:u.minValue,maxSize:e.clusterMaxSize,maxDataValue:u.maxValue}):null}const Kve=/^-?(\d+)(\.(\d+))?$/i;function Qve(e,t){return e-t}function ebe(e,t){let i,r;return i=Number(e.toFixed(t)),i<e?r=i+1/10**t:(r=i,i-=1/10**t),i=Number(i.toFixed(t)),r=Number(r.toFixed(t)),[i,r]}function tbe(e,t,i,r,s){const n=L1(e,t,i,r),o=n.previous==null||n.previous<=s,a=n.next==null||n.next<=s;return o&&a||n.previous+n.next<=2*s}function _b(e){const t=String(e),i=t.match(Kve);if(i?.[1])return{integer:i[1].split("").length,fractional:i[3]?i[3].split("").length:0};if(t.toLowerCase().includes("e")){const r=t.split("e"),s=r[0],n=r[1];if(s&&n){const o=Number(s);let a=Number(n);const l=a>0;l||(a=Math.abs(a));const u=_b(o);return l?(u.integer+=a,a>u.fractional?u.fractional=0:u.fractional-=a):(u.fractional+=a,a>u.integer?u.integer=1:u.integer-=a),u}}return{integer:0,fractional:0}}function L1(e,t,i,r){const s={previous:null,next:null};if(i!=null){const n=e-i,o=t-i-n;s.previous=Math.floor(Math.abs(100*o/n))}if(r!=null){const n=r-e,o=r-t-n;s.next=Math.floor(Math.abs(100*o/n))}return s}function vb(e,t={}){const i=e.slice(),{tolerance:r=2,strictBounds:s=!1,indexes:n=i.map(((o,a)=>a))}=t;n.sort(Qve);for(let o=0;o<n.length;o++){const a=n[o],l=i[a],u=a===0?null:i[a-1],c=a===i.length-1?null:i[a+1],d=_b(l).fractional;if(d){let m,y=0,g=!1;for(;y<=d&&!g;){const _=ebe(l,y);m=s&&o===0?_[1]:_[0],g=tbe(l,m,u,c,r),y++}g&&(i[a]=m)}}return i}const ibe={maximumFractionDigits:20};function rbe(e){return mu(e,ibe)}const ORe=",",sbe={years:365,months:30,days:1,hours:1/24,minutes:1/1440,seconds:1/86400,milliseconds:1/864e5},nbe=new Set(["integer","small-integer"]);let dS=null;function obe(e){return BC(e)||bne(e)||wne(e)}async function NRe(e){const{field:t,field2:i,field3:r,normalizationField:s,valueExpression:n}=e;let o=[];if(n){if(!dS){const{arcadeUtils:a}=await _u();dS=a}o=dS.extractFieldNames(n)}return t&&o.push(t),i&&o.push(i),r&&o.push(r),s&&o.push(s),o}function tm(e){return String(e).padStart(2,"0")}function B5(e,t,i){let r;return t==="date"||t==="number"?(t==="number"&&(e=new Date(e)),r=`TIMESTAMP'${i?e.getFullYear():e.getUTCFullYear()}-${tm((i?e.getMonth():e.getUTCMonth())+1)}-${tm(i?e.getDate():e.getUTCDate())} ${tm(i?e.getHours():e.getUTCHours())}:${tm(i?e.getMinutes():e.getUTCMinutes())}:${tm(i?e.getSeconds():e.getUTCSeconds())}'`):r=e,r}function DRe(e,t,i,r){const{hasQueryEngine:s}=e,n=`(${B5(i,q5(e,i),s)} - ${B5(t,q5(e,t),s)})`;let o=sbe[r],a="/";return o<1&&(o=1/o,a="*"),{sqlExpression:o===1?n:`(${n} ${a} ${o})`,sqlWhere:null}}function q5(e,t){if(t instanceof Date)return"date";if(typeof t=="number")return"number";if(typeof t=="string"){const i=e.getField(t);if(t.toLowerCase()==="<now>")return;if(BC(i))return"field"}}function FRe(e,t){const i=t&&e.getField(t);return!!i&&nbe.has(i.type)}function zRe(e){return`cast(${e} as float)`}function abe(e,t){const{format:i,timeZoneOptions:r,fieldType:s}=t??{};let n,o;if(r&&({timeZone:n,timeZoneName:o}=mK(r.layerTimeZone,r.datesInUnknownTimezone,r.viewTimeZone,Nf(i||"short-date-short-time"),s)),typeof e=="string"&&isNaN(Date.parse(s==="time-only"?`1970-01-01T${e}Z`:e)))return e;switch(s){case"date-only":{const a=Nf(i||"short-date");return typeof e=="string"?xK(e,{...a}):En(e,{...a,timeZone:Uo})}case"time-only":{const a=Nf(i||"short-time");return typeof e=="string"?$K(e,a):En(e,{...a,timeZone:Uo})}case"timestamp-offset":{if(!n&&typeof e=="string"&&new Date(e).toISOString()!==e)return e;const a=i||r?Nf(i||"short-date-short-time"):void 0,l=a?{...a,timeZone:n,timeZoneName:o}:void 0;return typeof e=="string"?MK(e,l):En(e,l)}default:{const a=i||r?Nf(i||"short-date-short-time"):void 0;return En(typeof e=="string"?new Date(e):e,a?{...a,timeZone:n,timeZoneName:o}:void 0)}}}const Zj="<",Yj=">";function Jj(e,t,i,r){let s="";return t===0?s=`${Zj} `:t===i&&(s=`${Yj} `),s+(r?abe(e,r):rbe(e))}const lbe=["data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAUCAYAAACNiR0NAAAACXBIWXMAAAAAAAAAAAHqZRakAAAANUlEQVQ4jWPMy8v7z0BFwMLAwMAwcdIkqhiWn5fHwEQVk5DAqIGjBo4aOGrgqIEQwEjtKgAATl0Hu6JrzFUAAAAASUVORK5CYII=","data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAUCAYAAACNiR0NAAAACXBIWXMAAAAAAAAAAAHqZRakAAAANUlEQVQ4jWPMy8v7z0BFwMLAwMAwaeIkqhiWl5/HwEQVk5DAqIGjBo4aOGrgqIEQwEjtKgAATl0Hu6sKxboAAAAASUVORK5CYII=","data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAUCAYAAACNiR0NAAAACXBIWXMAAAAAAAAAAAHqZRakAAAANUlEQVQ4jWPMy8v7z0BFwMLAwMAwadJEqhiWl5fPwEQVk5DAqIGjBo4aOGrgqIEQwEjtKgAATl0Hu75+IUcAAAAASUVORK5CYII="];async function HT(e){if(!("visualVariables"in e)||!e.visualVariables)return null;const t=e.visualVariables.find((o=>o.type==="color"));if(!t)return null;let i=null,r=null;if(t.stops){if(t.stops.length===1)return t.stops[0].color;i=t.stops[0].value,r=t.stops[t.stops.length-1].value}const s=i!=null&&r!=null?i+(r-i)/2:0,{getColor:n}=await J(async()=>{const{getColor:o}=await Promise.resolve().then(()=>Mh);return{getColor:o}},void 0);return n(t,s)??null}async function Xj(e,t){const i=e.trailCap,r=e.trailWidth||1,s=t||await HT(e)||e.color;return new Nt({cap:i,color:s,width:r})}function ube(e,t){if(!t.field)return null;if("featureReduction"in e)switch(e.featureReduction?.type){case"cluster":case"binning":{const i=e.featureReduction.fields.find((({name:r})=>r.toLowerCase()===t.field.toLowerCase()));return i&&"getField"in e?e.getField(i.onStatisticField):null}}return"getField"in e?e.getField?.(t.field):null}function cbe(e,t){const i="popupTemplate"in e?e.popupTemplate?.fieldInfos:null;if(i?.length&&t)return i.find((r=>r.fieldName?.toLowerCase()===t.toLowerCase()))?.format?.dateFormat}function hbe(e,t,i){const r=ube(e,t);if(!r||!obe(r)&&!k8(r))return null;let s=cbe(e,r.name);if(!s&&r.type==="date"){let n=0,o=0;t.stops?(n=t.stops?.at(0)?.value??n,o=t.stops?.at(-1)?.value??o):"minDataValue"in t&&"maxDataValue"in t&&(n=t.minDataValue??n,o=t.maxDataValue??o),s=o-n>2*jx.days?"short-date":"short-date-short-time"}return{fieldType:r.type,format:s,timeZoneOptions:{layerTimeZone:"preferredTimeZone"in e?e.preferredTimeZone:null,viewTimeZone:i,datesInUnknownTimezone:"datesInUnknownTimezone"in e&&e.datesInUnknownTimezone}}}function Oo(e,t){if("authoringInfo"in e)return e.authoringInfo?.visualVariables?.find((({theme:i})=>i===t))}const dbe=new X([64,64,64]);function Kj(e,t){const i=[],r=e.length-1;return e.length===5?i.push(0,2,4):i.push(0,r),e.map(((s,n)=>i.includes(n)?Jj(s,n,r,t):null))}async function H5(e,t,i){let r=!1,s=[],n=[];if(e.stops){const u=e.stops;s=u.map((c=>c.value)),r=u.some((c=>!!c.label)),r&&(n=u.map((c=>c.label)))}const o=s[0],a=s[s.length-1];if(o==null&&a==null)return null;const l=r?null:Kj(s,i);return(await Promise.all(s.map((async(u,c)=>{const d=e.type==="opacity"?await pbe(u,e,t):(await J(async()=>{const{getColor:y}=await Promise.resolve().then(()=>Mh);return{getColor:y}},void 0)).getColor(e,u),m=r?n[c]:l?.[c]??"";return d==null?null:{value:u,color:d,label:m}})))).filter(rr).reverse()}async function pbe(e,t,i){const r=new X(i??dbe),s=(await J(async()=>{const{getOpacity:n}=await Promise.resolve().then(()=>Mh);return{getOpacity:n}},void 0)).getOpacity(t,e);return s!=null&&(r.a=s),r}function fbe(e){let t=!1,i=[],r=[];i=e.map((a=>a.value)),t=e.some((a=>!!a.label)),t&&(r=e.map((a=>a.label??"")));const s=i[0],n=i[i.length-1];if(s==null&&n==null)return null;const o=t?null:Kj(i);return i.map(((a,l)=>({value:a,color:Qj(a,e),label:t?r[l]:o?.[l]??""}))).reverse()}function Qj(e,t){const{startIndex:i,endIndex:r,weight:s}=mbe(e,t);if(i===r)return t[i].color;const n=X.blendColors(t[i].color,t[r].color,s);return new X(n)}function mbe(e,t){let i=0,r=t.length-1;return t.some(((s,n)=>e<s.value?(r=n,!0):(i=n,!1))),{startIndex:i,endIndex:r,weight:(e-t[i].value)/(t[r].value-t[i].value)}}function ybe(e,t){let i=[];if(e&&e.type==="multipart")e.colorRamps.reverse().forEach(((r,s)=>{s===0?i.push({value:t.max,color:new X(r.toColor),label:"high"}):i.push({value:null,color:new X(r.toColor),label:""}),s===e.colorRamps.length-1?i.push({value:t.min,color:new X(r.fromColor),label:"low"}):i.push({value:null,color:new X(r.fromColor),label:""})}));else{let r,s;e&&e.type==="algorithmic"?(r=e.fromColor,s=e.toColor):(r=[0,0,0,1],s=[255,255,255,1]),i=[{value:t.max,color:new X(s),label:"high"},{value:t.min,color:new X(r),label:"low"}]}return i}function gbe(e){if(!e.colorStops)return[];const t=[...e.colorStops].filter((r=>r.color?.a>0));let i=t.length-1;if(t&&t[0]){const r=t[i];r&&r.ratio!==1&&(t.push(new Da({ratio:1,color:r.color})),i++)}return t.map(((r,s)=>{let n="";return s===0?n=e.legendOptions?.minLabel||"low":s===i&&(n=e.legendOptions?.maxLabel||"high"),{color:r.color,label:n,ratio:r.ratio}})).reverse()}const _be="spike-height-override";function vbe(e){const{strokeColor:t,strokeWidth:i,symbolStyle:r}=e,s=r?.includes("solid-fill")||r?.includes("gradient-fill");let n=t?.toArray(),o=!1;return r?.includes("outline")&&s?o=!0:n=e.color?.toArray(),{type:"CIMSolidStroke",effects:bbe(r),enable:!0,colorLocked:o,capStyle:Br.Round,joinStyle:Vs.Round,lineStyle3D:ET.Strip,miterLimit:4,width:i??We(1),color:n}}function bbe(e){if(!e?.includes("closed"))return[{type:"CIMGeometricEffectAddControlPoints",angleTolerance:90,primitiveName:"spike-control-points"},{type:"CIMGeometricEffectSuppress",suppress:!0,invert:!0,primitiveName:"spike-stroke-suppress"}]}function W5(e){const{color:t,symbolStyle:i}=e,r=i?.includes("solid-fill"),s=i?.includes("gradient-fill");if(!r&&!s||!t)return;if(r)return{type:"CIMSolidFill",enable:!0,colorLocked:!1,color:t?.toArray()};const n=t.clone();return n.a=0,{type:"CIMGradientFill",enable:!0,angle:90,colorRamp:{type:"CIMMultipartColorRamp",colorRamps:[{type:"CIMLinearContinuousColorRamp",fromColor:t.toArray(),toColor:n.toArray()}],weights:[1]},gradientMethod:"Linear",gradientSize:70,gradientSizeUnits:"Relative",gradientType:"Continuous"}}function eG(e,t){const{defaultHeight:i,baseWidth:r,color:s,strokeColor:n,primitiveOverrides:o,symbolStyle:a,strokeWidth:l}=t,u=e.data.symbol?.type==="CIMPointSymbol"?e.data.symbol:null,c=u?.symbolLayers;if(!c)return e;const d=u.effects,m=d?.find((S=>S.type==="CIMGeometricEffectTaperedPolygon")),y=d?.find((S=>S.type==="CIMGeometricEffectRadial"&&S.primitiveName===_be));r!=null&&m&&(m.fromWidth=r),i!=null&&y&&(y.length=i);const g=c?.find((S=>S.type==="CIMSolidStroke")),_=c?.find((S=>S.type==="CIMSolidFill")),v=c?.find((S=>S.type==="CIMGradientFill")),b=v?.colorRamp?.type==="CIMMultipartColorRamp"&&v.colorRamp.colorRamps[0]?.type==="CIMLinearContinuousColorRamp"?v.colorRamp.colorRamps[0]:null;if(a){const S=_?.color??b?.fromColor??g?.color,$=s??(S?new X(S):void 0),E=g?.color??S,C=n??(E?new X(E):void 0),P=a.includes("solid-fill"),k=a.includes("gradient-fill");if(P||k||pS(c,_??v),$){if(P)pS(c,v),_?_.color=$?.toArray():c.push(W5({...t,color:$}));else if(k)if(pS(c,_),v){if(b&&s){const F=$.clone();F.a=0,b.fromColor=$.toArray(),b.toColor=F.toArray()}}else c.push(W5({...t,color:$}))}if(g){const F=vbe({...t,strokeColor:C,color:$});g.effects=F.effects,g.color=F.color,g.width=F.width,g.colorLocked=F.colorLocked}}else if(g&&(n&&(g.color=n.toArray()),l!=null&&(g.width=l)),_&&s&&(_.color=s.toArray()),b&&s){const S=s.clone();S.a=0,b.fromColor=s.toArray(),b.toColor=S.toArray()}return o!==void 0&&(e.data.primitiveOverrides=V(o)),e}function pS(e,t){if(!t)return;const i=e.indexOf(t);i!==-1&&e.splice(i,1)}const r_=[["(",")"],[")","("],["<",">"],[">","<"],["[","]"],["]","["],["{","}"],["}","{"],["",""],["",""],["",""],["",""],["",""],["",""],["",""],["",""],["",""],["",""],["",""],["",""],["",""],["",""],["",""],["",""],["",""],["",""],["",""],["",""]],Qp=["","","",""],wbe=["","","",""],Sbe=["","","",""],bb=["","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","",""],xbe=["","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","",""],$be=["","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","",""],Mbe=["","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","",""],Tbe=["","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","",""],Z5=["","","","","","","","","","","","",""],Ebe=["","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","",""],Y5=["",""],Cbe=["",""],Pbe=[[0,3,0,1,0,0,0],[0,3,0,1,2,2,0],[0,3,0,17,2,0,1],[0,3,5,5,4,1,0],[0,3,21,21,4,0,1],[0,3,5,5,4,2,0]],Ibe=[[2,0,1,1,0,1,0],[2,0,1,1,0,2,0],[2,0,2,1,3,2,0],[2,0,2,33,3,1,1]],M=0,q=1,pe=2,Ht=3,w=4,eo=5,k1=6,x=7,Yi=8,pr=9,on=10,ve=11,R=12,Abe=13,Lbe=14,kbe=15,Rbe=16,Obe=17,oe=18,Nbe=["UBAT_L","UBAT_R","UBAT_EN","UBAT_AN","UBAT_ON","UBAT_B","UBAT_S","UBAT_AL","UBAT_WS","UBAT_CS","UBAT_ES","UBAT_ET","UBAT_NSM","UBAT_LRE","UBAT_RLE","UBAT_PDF","UBAT_LRO","UBAT_RLO","UBAT_BN"],Kn=100,Dbe=[Kn+0,M,M,M,M,Kn+1,Kn+2,Kn+3,q,M,M,M,M,M,M,M,M,M,M,M,M,M,M,M,M,M,M,M,M,M,M,M,Kn+4,w,w,w,M,w,M,w,M,w,w,w,M,M,w,w,M,M,M,M,M,w,w,w,w,w,w,w,w,w,w,w,w,w,w,w,w,w,w,w,w,w,w,w,w,M,M,w,w,w,w,w,w,w,w,w,w,w,w,w,w,w,w,w,w,w,w,w,w,w,w,w,w,w,w,w,w,w,w,w,w,w,w,w,w,w,w,w,w,w,w,w,w,w,w,w,w,w,w,w,w,w,w,w,w,w,w,w,w,w,w,w,w,w,w,w,w,w,w,w,w,w,w,w,w,w,w,M,M,M,M,M,M,M,M,M,M,M,M,M,M,w,w,w,w,w,w,w,w,w,w,w,w,w,w,w,w,w,w,w,w,w,w,w,w,w,w,w,w,w,w,w,w,w,w,w,w,w,w,w,w,w,w,M,M,w,w,M,M,w,w,M,M,w,w,w,w,w,w,w,w,w,w,w,w,w,w,w,w,w,w,w,w,w,w,w,M,M,M,Kn+5,x,x,Kn+6,Kn+7],Fbe=[[oe,oe,oe,oe,oe,oe,oe,oe,oe,k1,eo,k1,Yi,eo,oe,oe,oe,oe,oe,oe,oe,oe,oe,oe,oe,oe,oe,oe,eo,eo,eo,k1,Yi,w,w,ve,ve,ve,w,w,w,w,w,on,pr,on,pr,pr,pe,pe,pe,pe,pe,pe,pe,pe,pe,pe,pr,w,w,w,w,w,w,M,M,M,M,M,M,M,M,M,M,M,M,M,M,M,M,M,M,M,M,M,M,M,M,M,M,w,w,w,w,w,w,M,M,M,M,M,M,M,M,M,M,M,M,M,M,M,M,M,M,M,M,M,M,M,M,M,M,w,w,w,w,oe,oe,oe,oe,oe,oe,eo,oe,oe,oe,oe,oe,oe,oe,oe,oe,oe,oe,oe,oe,oe,oe,oe,oe,oe,oe,oe,oe,oe,oe,oe,oe,oe,pr,w,ve,ve,ve,ve,w,w,w,w,M,w,w,oe,w,w,ve,ve,pe,pe,w,M,w,w,w,pe,M,w,w,w,w,w,M,M,M,M,M,M,M,M,M,M,M,M,M,M,M,M,M,M,M,M,M,M,M,w,M,M,M,M,M,M,M,M,M,M,M,M,M,M,M,M,M,M,M,M,M,M,M,M,M,M,M,M,M,M,M,w,M,M,M,M,M,M,M,M],[M,M,M,M,M,M,M,M,M,M,M,M,M,M,M,M,M,M,M,M,M,M,M,M,M,M,M,M,M,M,M,M,M,M,M,M,M,M,M,M,w,w,w,w,w,w,w,w,w,M,M,M,M,M,M,M,M,M,M,M,M,M,M,M,M,M,M,M,M,M,M,M,M,M,M,M,M,M,M,M,M,M,M,M,M,M,M,w,w,M,M,M,M,M,M,M,w,M,M,M,M,M,M,M,M,M,M,M,M,M,M,M,M,M,M,M,M,M,M,M,M,M,M,M,M,M,M,M,M,M,M,M,M,M,M,M,w,M,w,w,w,w,w,w,w,R,R,R,R,R,R,R,R,R,R,R,R,R,R,R,R,R,R,R,R,R,R,R,R,R,R,R,R,R,R,R,R,R,R,R,R,R,R,R,R,R,R,R,R,R,q,R,q,R,R,q,R,R,q,R,w,w,w,w,w,w,w,w,q,q,q,q,q,q,q,q,q,q,q,q,q,q,q,q,q,q,q,q,q,q,q,q,q,q,q,w,w,w,w,w,q,q,q,q,q,w,w,w,w,w,w,w,w,w,w,w],[Ht,Ht,Ht,Ht,w,w,w,w,x,ve,ve,x,pr,x,w,w,R,R,R,R,R,R,R,R,R,R,R,x,w,w,x,x,x,x,x,x,x,x,x,x,x,x,x,x,x,x,x,x,x,x,x,x,x,x,x,x,x,x,x,x,x,x,x,x,x,x,x,x,x,x,x,x,x,x,x,R,R,R,R,R,R,R,R,R,R,R,R,R,R,R,R,R,R,R,R,R,Ht,Ht,Ht,Ht,Ht,Ht,Ht,Ht,Ht,Ht,ve,Ht,Ht,x,x,x,R,x,x,x,x,x,x,x,x,x,x,x,x,x,x,x,x,x,x,x,x,x,x,x,x,x,x,x,x,x,x,x,x,x,x,x,x,x,x,x,x,x,x,x,x,x,x,x,x,x,x,x,x,x,x,x,x,x,x,x,x,x,x,x,x,x,x,x,x,x,x,x,x,x,x,x,x,x,x,x,x,x,x,x,x,x,x,x,x,x,x,x,x,x,x,x,x,x,x,x,x,x,R,R,R,R,R,R,R,Ht,w,R,R,R,R,R,R,x,x,R,R,w,R,R,R,R,x,x,pe,pe,pe,pe,pe,pe,pe,pe,pe,pe,x,x,x,x,x,x],[x,x,x,x,x,x,x,x,x,x,x,x,x,x,w,x,x,R,x,x,x,x,x,x,x,x,x,x,x,x,x,x,x,x,x,x,x,x,x,x,x,x,x,x,x,x,x,x,R,R,R,R,R,R,R,R,R,R,R,R,R,R,R,R,R,R,R,R,R,R,R,R,R,R,R,w,w,x,x,x,x,x,x,x,x,x,x,x,x,x,x,x,x,x,x,x,x,x,x,x,x,x,x,x,x,x,x,x,x,x,x,x,x,x,x,x,x,x,x,x,x,x,x,x,x,x,x,x,x,x,x,x,x,x,x,x,x,x,x,x,x,x,x,x,x,x,x,x,x,x,x,x,x,x,x,x,x,x,x,x,x,x,x,x,x,x,R,R,R,R,R,R,R,R,R,R,R,x,w,w,w,w,w,w,w,w,w,w,w,w,w,w,q,q,q,q,q,q,q,q,q,q,q,q,q,q,q,q,q,q,q,q,q,q,q,q,q,q,q,q,q,q,q,q,q,q,q,q,q,q,q,q,q,q,q,R,R,R,R,R,R,R,R,R,q,q,w,w,w,w,q,w,w,w,w,w],[Yi,Yi,Yi,Yi,Yi,Yi,Yi,Yi,Yi,Yi,Yi,oe,oe,oe,M,q,w,w,w,w,w,w,w,w,w,w,w,w,w,w,w,w,w,w,w,w,w,w,w,w,Yi,eo,Abe,Lbe,kbe,Rbe,Obe,pr,ve,ve,ve,ve,ve,w,w,w,w,w,w,w,w,w,w,w,w,w,w,w,pr,w,w,w,w,w,w,w,w,w,w,w,w,w,w,w,w,w,w,w,w,w,w,w,w,w,w,Yi,oe,oe,oe,oe,oe,w,w,w,w,w,oe,oe,oe,oe,oe,oe,pe,M,w,w,pe,pe,pe,pe,pe,pe,on,on,w,w,w,M,pe,pe,pe,pe,pe,pe,pe,pe,pe,pe,on,on,w,w,w,w,M,M,M,M,M,M,M,M,M,M,M,M,M,w,w,w,ve,ve,ve,ve,ve,ve,ve,ve,ve,ve,ve,ve,ve,ve,ve,ve,ve,ve,ve,ve,ve,ve,ve,ve,ve,ve,w,w,w,w,w,w,w,w,w,w,w,w,w,w,w,w,w,w,w,w,w,w,R,R,R,R,R,R,R,R,R,R,R,R,R,R,R,R,R,R,R,R,R,R,R,R,R,R,R,R,R,R,R,R,R,w,w,w,w,w,w,w,w,w,w,w,w,w,w,w],[M,M,M,M,M,M,M,w,w,w,w,w,w,w,w,w,w,w,w,M,M,M,M,M,w,w,w,w,w,q,R,q,q,q,q,q,q,q,q,q,q,on,q,q,q,q,q,q,q,q,q,q,q,q,q,w,q,q,q,q,q,w,q,w,q,q,w,q,q,w,q,q,q,q,q,q,q,q,q,q,x,x,x,x,x,x,x,x,x,x,x,x,x,x,x,x,x,x,x,x,x,x,x,x,x,x,x,x,x,x,x,x,x,x,x,x,x,x,x,x,x,x,x,x,x,x,x,x,x,x,x,x,x,x,x,x,x,x,x,x,x,x,x,x,x,x,x,x,x,x,x,x,x,x,x,x,x,x,x,x,x,x,x,x,x,x,x,x,x,x,x,x,x,x,x,x,x,x,x,x,x,x,x,x,x,x,x,x,x,x,x,x,x,x,w,w,w,w,w,w,w,w,w,w,w,w,w,w,w,w,w,x,x,x,x,x,x,x,x,x,x,x,x,x,x,x,x,x,x,x,x,x,x,x,x,x,x,x,x,x,x,x,x,x,x,x,x,x,x,x,x,x,x,x,x,x],[R,R,R,R,R,R,R,R,R,R,R,R,R,R,R,R,w,w,w,w,w,w,w,w,w,w,w,w,w,w,w,w,R,R,R,R,R,R,R,w,w,w,w,w,w,w,w,w,w,w,w,w,w,w,w,w,w,w,w,w,w,w,w,w,w,w,w,w,w,w,w,w,w,w,w,w,w,w,w,w,pr,w,pr,w,w,pr,w,w,w,w,w,w,w,w,w,ve,w,w,on,on,w,w,w,w,w,ve,ve,w,w,w,w,w,x,x,x,x,x,w,x,x,x,x,x,x,x,x,x,x,x,x,x,x,x,x,x,x,x,x,x,x,x,x,x,x,x,x,x,x,x,x,x,x,x,x,x,x,x,x,x,x,x,x,x,x,x,x,x,x,x,x,x,x,x,x,x,x,x,x,x,x,x,x,x,x,x,x,x,x,x,x,x,x,x,x,x,x,x,x,x,x,x,x,x,x,x,x,x,x,x,x,x,x,x,x,x,x,x,x,x,x,x,x,x,x,x,x,x,x,x,x,x,x,x,x,x,x,x,x,x,x,x,x,x,x,x,x,x,x,x,x,x,x,x,w,w,oe],[w,w,w,ve,ve,ve,w,w,w,w,w,on,pr,on,pr,pr,pe,pe,pe,pe,pe,pe,pe,pe,pe,pe,pr,w,w,w,w,w,w,M,M,M,M,M,M,M,M,M,M,M,M,M,M,M,M,M,M,M,M,M,M,M,M,M,M,w,w,w,w,w,w,M,M,M,M,M,M,M,M,M,M,M,M,M,M,M,M,M,M,M,M,M,M,M,M,M,M,w,w,w,w,w,w,w,w,w,w,w,M,M,M,M,M,M,M,M,M,M,M,M,M,M,M,M,M,M,M,M,M,M,M,M,M,M,M,M,M,M,M,M,M,M,M,M,M,M,M,M,M,M,M,M,M,M,M,M,M,M,M,M,M,M,M,M,M,M,M,M,M,M,M,M,M,M,M,M,M,M,M,M,M,M,M,M,M,M,M,M,M,M,M,M,M,M,M,M,M,w,w,w,M,M,M,M,M,M,w,w,M,M,M,M,M,M,w,w,M,M,M,M,M,M,w,w,M,M,M,w,w,w,ve,ve,w,w,w,ve,ve,w,w,w,w,w,w,w,w,w,w,w,w,w,w,w,w,w,w,w,w,w,w,w,w,w]];let zbe=class{constructor(){this.inputFormat="ILYNN",this.outputFormat="VLNNN",this.sourceToTarget=[],this.targetToSource=[],this.levels=[]}bidiTransform(t,i,r){if(this.sourceToTarget=[],this.targetToSource=[],!t)return"";if(iwe(this.sourceToTarget,this.targetToSource,t.length),!this.checkParameters(i,r))return t;i=this.inputFormat,r=this.outputFormat;let s=t;const n=swe,o=K5(i.charAt(1)),a=K5(r.charAt(1)),l=(i.charAt(0)==="I"?"L":i.charAt(0))+o,u=(r.charAt(0)==="I"?"L":r.charAt(0))+a,c=i.charAt(2)+r.charAt(2);n.defInFormat=l,n.defOutFormat=u,n.defSwap=c;const d=ey(t,l,u,c,n);let m=!1;return r.charAt(1)==="R"?m=!0:r.charAt(1)!=="C"&&r.charAt(1)!=="D"||(m=this.checkContextual(d)==="rtl"),this.sourceToTarget=cs,this.targetToSource=rwe(this.sourceToTarget),Sb=this.targetToSource,s=i.charAt(3)===r.charAt(3)?d:r.charAt(3)==="S"?Ube(m,d):Bbe(d,m,!0),this.sourceToTarget=cs,this.targetToSource=Sb,this.levels=Ow,s}_inputFormatSetter(t){if(!Q5.test(t))throw new Error("dojox/string/BidiEngine: the bidi layout string is wrong!");this.inputFormat=t}_outputFormatSetter(t){if(!Q5.test(t))throw new Error("dojox/string/BidiEngine: the bidi layout string is wrong!");this.outputFormat=t}checkParameters(t,i){return t?this._inputFormatSetter(t):t=this.inputFormat,i?this._outputFormatSetter(i):i=this.outputFormat,t!==i}checkContextual(t){let i=wb(t);if(i!=="ltr"&&i!=="rtl"){try{i=document.dir.toLowerCase()}catch{}i!=="ltr"&&i!=="rtl"&&(i="ltr")}return i}hasBidiChar(t){return awe.test(t)}};function ey(e,t,i,r,s){const n=Vbe(e,{inFormat:t,outFormat:i,swap:r},s);if(n.inFormat===n.outFormat)return e;t=n.inFormat,i=n.outFormat,r=n.swap;const o=t.slice(0,1),a=t.slice(1,4),l=i.slice(0,1),u=i.slice(1,4);if(s.inFormat=t,s.outFormat=i,s.swap=r,o==="L"&&i==="VLTR"){if(a==="LTR")return s.dir=Kh,fl(e,s);if(a==="RTL")return s.dir=ty,fl(e,s)}if(o==="V"&&l==="V")return s.dir=a==="RTL"?ty:Kh,fS(e,s);if(o==="L"&&i==="VRTL")return a==="LTR"?(s.dir=Kh,e=fl(e,s)):(s.dir=ty,e=fl(e,s)),fS(e);if(t==="VLTR"&&i==="LLTR")return s.dir=Kh,fl(e,s);if(o==="V"&&l==="L"&&a!==u)return e=fS(e),a==="RTL"?ey(e,"LLTR","VLTR",r,s):ey(e,"LRTL","VRTL",r,s);if(t==="VRTL"&&i==="LRTL")return ey(e,"LRTL","VRTL",r,s);if(o==="L"&&l==="L"){const c=s.swap;return s.swap=c.slice(0,1)+"N",a==="RTL"?(s.dir=ty,e=fl(e,s),s.swap="N"+c.slice(1,3),s.dir=Kh,e=fl(e,s)):(s.dir=Kh,e=fl(e,s),s.swap="N"+c.slice(1,3),e=ey(e,"VLTR","LRTL",s.swap,s)),e}return e}function Vbe(e,t,i){if(t.inFormat===void 0&&(t.inFormat=i.defInFormat),t.outFormat===void 0&&(t.outFormat=i.defOutFormat),t.swap===void 0&&(t.swap=i.defSwap),t.inFormat===t.outFormat)return t;const r=t.inFormat.slice(0,1),s=t.outFormat.slice(0,1);let n,o=t.inFormat.slice(1,4),a=t.outFormat.slice(1,4);return o.charAt(0)==="C"&&(n=wb(e),o=n==="ltr"||n==="rtl"?n.toUpperCase():t.inFormat.charAt(2)==="L"?"LTR":"RTL",t.inFormat=r+o),a.charAt(0)==="C"&&(n=wb(e),n==="rtl"?a="RTL":n==="ltr"?(n=Gbe(e),a=n.toUpperCase()):a=t.outFormat.charAt(2)==="L"?"LTR":"RTL",t.outFormat=s+a),t}function Ube(e,t,i){if(t.length===0)return"";e===void 0&&(e=!0);const r=(t=String(t)).split("");let s=0,n=1,o=r.length;e||(s=r.length-1,n=-1,o=1);const a=jbe(r,s,n,o);let l="";for(let u=0;u<r.length;u++)Zbe(a,a.length,u)>-1?(rG(Sb,u,!e,-1),cs.splice(u,1)):l+=r[u];return l}function jbe(e,t,i,r,s){let n=0;const o=[];let a=0;for(let l=t;l*i<r;l+=i)if(iG(e[l])||fg(e[l])){if(e[l]===""&&Ybe(e,l+i,i,r)){e[l]=twe(e[l+i],n===0?wbe:Sbe),l+=i,ewe(e,l,i,r),o[a]=l,a++,n=0;continue}const u=e[l];n===1?e[l]=J5(e,l+i,i,r)?Qbe(e[l]):mS(e[l],$be):J5(e,l+i,i,r)===!0?e[l]=mS(e[l],Tbe):e[l]=mS(e[l],xbe),fg(u)||(n=1),Kbe(u)===!0&&(n=0)}else n=0;return o}function wb(e){const t=/[A-Za-z\u05d0-\u065f\u066a-\u06ef\u06fa-\u07ff\ufb1d-\ufdff\ufe70-\ufefc]/.exec(e);return t?t[0]<="z"?"ltr":"rtl":""}function Gbe(e){const t=e.split("");return t.reverse(),wb(t.join(""))}function Bbe(e,t,i){if(e.length===0)return"";t===void 0&&(t=!0);let r="";const s=(e=String(e)).split("");for(let n=0;n<e.length;n++){let o=!1;if(s[n]>=""&&s[n]<"\uFEFF"){const a=e.charCodeAt(n);s[n]>=""&&s[n]<=""?(t?(n>0&&i&&s[n-1]===" "?r=r.slice(0,-1)+"":(r+="",o=!0),r+=Qp[(a-65269)/2]):(r+=Qp[(a-65269)/2],r+="",n+1<e.length&&i&&s[n+1]===" "?n++:o=!0),o&&(rG(Sb,n,!0,1),cs.splice(n,0,cs[n]))):r+=Ebe[a-65136]}else r+=s[n]}return r}function fl(e,t){const i=e.split(""),r=[];return tG(i,r,t),Hbe(i,r,t),X5(2,i,r,t),X5(1,i,r,t),Ow=r,i.join("")}function tG(e,t,i){const r=e.length,s=i.dir?Ibe:Pbe;let n=0,o=-1;const a=[],l=[];i.hiLevel=i.dir,i.lastArabic=!1,i.hasUbatAl=!1,i.hasUbatB=!1,i.hasUbatS=!1;for(let u=0;u<r;u++)a[u]=Wbe(e[u]);for(let u=0;u<r;u++){const c=n,d=Jbe(e,a,l,u,i);l[u]=d,n=s[c][d];const m=240&n;n&=15;const y=s[n][nwe];if(t[u]=y,m>0)if(m===16){for(let g=o;g<u;g++)t[g]=1;o=-1}else o=-1;if(s[n][owe])o===-1&&(o=u);else if(o>-1){for(let g=o;g<u;g++)t[g]=y;o=-1}a[u]===eo&&(t[u]=0),i.hiLevel|=y}i.hasUbatS&&qbe(a,t,r,i)}function qbe(e,t,i,r){for(let s=0;s<i;s++)if(e[s]===k1){t[s]=r.dir;for(let n=s-1;n>=0&&e[n]===Yi;n--)t[n]=r.dir}}function Hbe(e,t,i){if(i.hiLevel!==0&&i.swap[0]!==i.swap[1])for(let r=0;r<e.length;r++)t[r]===1&&(e[r]=Xbe(e[r]))}function Wbe(e){const t=e.charCodeAt(0),i=Dbe[t>>8];return i<Kn?i:Fbe[i-Kn][255&t]}function fS(e,t){const i=e.split("");if(t){const r=[];tG(i,r,t),Ow=r}return i.reverse(),cs.reverse(),i.join("")}function Zbe(e,t,i){for(let r=0;r<t;r++)if(e[r]===i)return r;return-1}function iG(e){for(let t=0;t<Y5.length;t++)if(e>=Y5[t]&&e<=Cbe[t])return!0;return!1}function J5(e,t,i,r){for(;t*i<r&&fg(e[t]);)t+=i;return!!(t*i<r&&iG(e[t]))}function Ybe(e,t,i,r){for(;t*i<r&&fg(e[t]);)t+=i;let s=" ";if(!(t*i<r))return!1;s=e[t];for(let n=0;n<Qp.length;n++)if(Qp[n]===s)return!0;return!1}function X5(e,t,i,r){if(r.hiLevel<e)return;if(e===1&&r.dir===ty&&!r.hasUbatB)return t.reverse(),void cs.reverse();const s=t.length;let n,o,a,l,u,c=0;for(;c<s;){if(i[c]>=e){for(n=c+1;n<s&&i[n]>=e;)n++;for(o=c,a=n-1;o<a;o++,a--)l=t[o],t[o]=t[a],t[a]=l,u=cs[o],cs[o]=cs[a],cs[a]=u;c=n}c++}}function Jbe(e,t,i,r,s){const n=t[r];return{UBAT_L:()=>(s.lastArabic=!1,M),UBAT_R:()=>(s.lastArabic=!1,q),UBAT_ON:()=>w,UBAT_AN:()=>Ht,UBAT_EN:()=>s.lastArabic?Ht:pe,UBAT_AL:()=>(s.lastArabic=!0,s.hasUbatAl=!0,q),UBAT_WS:()=>w,UBAT_CS:()=>{let o,a;return r<1||r+1>=t.length||(o=i[r-1])!==pe&&o!==Ht||(a=t[r+1])!==pe&&a!==Ht?w:(s.lastArabic&&(a=Ht),a===o?a:w)},UBAT_ES:()=>(r>0?i[r-1]:eo)===pe&&r+1<t.length&&t[r+1]===pe?pe:w,UBAT_ET:()=>{if(r>0&&i[r-1]===pe)return pe;if(s.lastArabic)return w;let o=r+1;const a=t.length;for(;o<a&&t[o]===ve;)o++;return o<a&&t[o]===pe?pe:w},UBAT_NSM:()=>{if(s.inFormat==="VLTR"){const o=t.length;let a=r+1;for(;a<o&&t[a]===R;)a++;if(a<o){const l=e[r].charCodeAt(0),u=l>=1425&&l<=2303||l===64286,c=t[a];if(u&&(c===q||c===x))return q}}return r<1||t[r-1]===eo?w:i[r-1]},UBAT_B:()=>(s.lastArabic=!0,s.hasUbatB=!0,s.dir),UBAT_S:()=>(s.hasUbatS=!0,w),UBAT_LRE:()=>(s.lastArabic=!1,w),UBAT_RLE:()=>(s.lastArabic=!1,w),UBAT_LRO:()=>(s.lastArabic=!1,w),UBAT_RLO:()=>(s.lastArabic=!1,w),UBAT_PDF:()=>(s.lastArabic=!1,w),UBAT_BN:()=>w}[Nbe[n]]()}function Xbe(e){let t,i=0,r=r_.length-1;for(;i<=r;)if(t=Math.floor((i+r)/2),e<r_[t][0])r=t-1;else{if(!(e>r_[t][0]))return r_[t][1];i=t+1}return e}function Kbe(e){for(let t=0;t<Z5.length;t++)if(Z5[t]===e)return!0;return!1}function Qbe(e){for(let t=0;t<bb.length;t++)if(e===bb[t])return Mbe[t];return e}function mS(e,t){for(let i=0;i<bb.length;i++)if(e===bb[i])return t[i];return e}function fg(e){return e>=""&&e<=""}function K5(e){return e==="L"?"LTR":e==="R"?"RTL":e==="C"?"CLR":e==="D"?"CRL":""}function ewe(e,t,i,r){for(;t*i<r&&fg(e[t]);)t+=i;return t*i<r&&(e[t]=" ",!0)}function twe(e,t){for(let i=0;i<Qp.length;i++)if(e===Qp[i])return t[i];return e}function iwe(e,t,i){cs=[],Ow=[];for(let r=0;r<i;r++)e[r]=r,t[r]=r,cs[r]=r}function rwe(e){const t=new Array(e.length);for(let i=0;i<e.length;i++)t[e[i]]=i;return t}function rG(e,t,i,r){for(let s=0;s<e.length;s++)(e[s]>t||!i&&e[s]===t)&&(e[s]+=r)}let cs=[],Sb=[],Ow=[];const swe={dir:0,defInFormat:"LLTR",defSwap:"YN",inFormat:"LLTR",outFormat:"VLTR",swap:"YN",hiLevel:0,lastArabic:!1,hasUbatAl:!1,defOutFormat:""},nwe=5,owe=6,Kh=0,ty=1,Q5=/^[(I|V)][(L|R|C|D)][(Y|N)][(S|N)][N]$/,awe=/[\u0591-\u06ff\ufb1d-\ufefc]/,yS=new zbe;function lwe(e){if(e==null)return["",!1];if(!yS.hasBidiChar(e))return[e,!1];let t;return t=yS.checkContextual(e)==="rtl"?"IDNNN":"ICNNN",[yS.bidiTransform(e,t,"VLYSN"),!0]}let Sf=class{constructor(){this.setIdentity()}getAngle(){return(this.rz==null||this.rz===0&&this.rzCos!==1&&this.rzSin!==0)&&(this.rz=Math.atan2(this.rzSin,this.rzCos)),this.rz}setIdentity(){this.tx=0,this.ty=0,this.tz=0,this.s=1,this.rx=0,this.ry=0,this.rz=0,this.rzCos=1,this.rzSin=0}setTranslate(t,i){this.tx=t,this.ty=i}setTranslateZ(t){this.tz=t}setRotateCS(t,i){this.rz=void 0,this.rzCos=t,this.rzSin=i}setRotate(t){this.rz=t,this.rzCos=void 0,this.rzSin=void 0}setRotateY(t){this.ry=t}setScale(t){this.s=t}setMeasure(t){this.m=t}};const WP="arial-unicode-ms",eN="woff2",tN=new Map,sG=new Set;let uwe=class{constructor(t,i){this.fontFace=t,this.promise=i}};async function cwe(e){const t=pwe(e),i=dwe(e),r=tN.get(t);if(r)return r.promise;const s=new FontFace(e.family,`url('${Fe.fontsUrl}/woff2/${i}.${eN}') format('${eN}')`,{style:e.style,weight:e.weight}),n=document.fonts;if(n.has(s)&&s.status==="loading")return s.loaded;const o=s.load().then((()=>(n.add(s),s)));return tN.set(t,new uwe(s,o)),sG.add(s),o}function GRe(e){return sG.has(e)}function hwe(e){if(!e)return WP;const t=e.toLowerCase().split(" ").join("-");switch(t){case"serif":return"noto-serif";case"sans-serif":return"arial-unicode-ms";case"monospace":return"ubuntu-mono";case"fantasy":return"cabin-sketch";case"cursive":return"redressed";default:return t}}function dwe(e){const t=nG(e)+oG(e);return hwe(e.family)+(t.length>0?t:"-regular")}function pwe(e){const t=nG(e)+oG(e);return(e.family||WP)+(t.length>0?t:"-regular")}function nG(e){if(!e.weight)return"";switch(e.weight.toLowerCase()){case"bold":case"bolder":return"-bold"}return""}function oG(e){if(!e.style)return"";switch(e.style.toLowerCase()){case"italic":case"oblique":return"-italic"}return""}function fwe(e){return 32+e.length}const aG=16;function BRe(e){if(!e)return 0;let t=YP;for(const i in e)e.hasOwnProperty(i)&&(t+=ZP(e[i],!1));return t}function mwe(e){if(!e)return 0;if(typeof e[0]=="number")return lG(e);if(Array.isArray(e))return ywe(e);let t=YP;for(const i in e)e.hasOwnProperty(i)&&(t+=ZP(e[i]));return t}function ywe(e){const t=e.length;if(t===0||typeof e[0]=="number")return uG(e,8);let i=cG;for(let r=0;r<t;r++)i+=ZP(e[r]);return i}function ZP(e,t=!0){switch(typeof e){case"object":return t?mwe(e):YP;case"string":return fwe(e);case"number":return aG;case"boolean":return 4;default:return 8}}function lG(...e){return e.reduce(((t,i)=>t+(i?zN(i)?i.byteLength+gwe:Array.isArray(i)?uG(i,aG):0:0)),0)}function uG(e,t){return cG+e.length*t}const YP=32,cG=16,gwe=145,Du=2;let xb=class Sd{constructor(t=[],i=[]){this.lengths=t??[],this.coords=i??[]}static fromJSON(t){return new Sd(t.lengths,t.coords)}static fromRect(t){const[i,r,s,n]=t,o=s-i,a=n-r;return new Sd([5],[i,r,o,0,0,a,-o,0,0,-a])}get isPoint(){return this.lengths.length===0&&this.coords.length>=2}get maxLength(){return Math.max(...this.lengths)}get size(){return this.lengths.reduce(((t,i)=>t+i))}get usedMemory(){return 64+lG(this.lengths,this.coords)}area(){let t=0,i=0;if(!this.lengths.length)return 0;for(let r=0;r<this.lengths.length;r++){const s=this.lengths[r];if(s<3)continue;let n=this.coords[Du*i],o=this.coords[Du*i+1];for(let a=1;a<s;a+=1){const l=this.coords[Du*(a+i)],u=this.coords[Du*(a+i)+1];t+=-.5*(l-n)*(u+o),n=l,o=u}i+=s}return t}forEachVertex(t){let i=0;this.lengths.length||t(this.coords[0],this.coords[1]);for(let r=0;r<this.lengths.length;r++){const s=this.lengths[r];for(let n=0;n<s;n++)t(this.coords[Du*(n+i)],this.coords[Du*(n+i)+1]);i+=s}}deltaDecode(){const t=this.clone(),{coords:i,lengths:r}=t;let s=0;for(const n of r){for(let o=1;o<n;o++)i[2*(s+o)]+=i[2*(s+o)-2],i[2*(s+o)+1]+=i[2*(s+o)-1];s+=n}return t}clone(t){if(this.lengths.length===0)return new Sd([],[this.coords[0],this.coords[1]]);const i=(this.lengths.length===0?1:this.lengths.reduce(((s,n)=>s+n)))*Du,r=this.coords.slice(0,i);return t?(t.set(r),new Sd(this.lengths,t)):new Sd(Array.from(this.lengths),Array.from(r))}},Ze=class{static fromOptimized(t,i,r=!1,s=!1,n=1){return new WT().initialize(t,i,r,s,n)}static fromJSON(t,i=!1,r=!1){const[s,n]=iN(t);return new YT().initialize(s,n,i,r,1)}static fromOptimizedCIM(t,i,r=!1,s=!1,n=1){return new rN().initialize(t,i,r,s,n)}static fromJSONCIM(t,i=!1,r=!1,s=1){const[n,o]=iN(t);return new sN().initialize(n,o,i,r,s)}static fromFeatureSetReader(t){const i=t.readGeometryForDisplay(),r=t.geometryType;return i&&r?this.fromOptimized(i,r):null}static fromFeatureSetReaderCIM(t){const i=t.readGeometryForDisplay(),r=t.geometryType;return i&&r?this.fromOptimizedCIM(i,r):null}static createEmptyOptimized(t,i=!1,r=!1,s=1){return new WT().initialize(new xb,t,i,r,s)}static createEmptyJSON(t,i=!1,r=!1){return new YT().initialize([],t,i,r,1)}static createEmptyOptimizedCIM(t,i=!1,r=!1,s=1){return new rN().initialize(new xb,t,i,r,s)}static createEmptyJSONCIM(t,i=!1,r=!1,s=1){return new sN().initialize([],t,i,r,s)}asJSON(){const t=Jb(this);return this.geometryType==="esriGeometryEnvelope"?{xmin:t[0][0][0],ymin:t[0][0][1],xmax:t[0][2][0],ymax:t[0][2][1]}:this.geometryType==="esriGeometryMultipoint"?{points:t.flat()}:this.geometryType==="esriGeometryPoint"?{x:t[0][0][0],y:t[0][0][1]}:this.geometryType==="esriGeometryPolygon"?{rings:t}:{paths:t}}getCurrentRingArea(){if(this.pathSize<3)return 0;let t,i,r=0;if(this.seekPathStart(),!this.nextPoint())return 0;t=this.x,i=this.y;const s=t,n=i;for(;this.nextPoint();)r+=(t-this.x)*(i+this.y),t=this.x,i=this.y;return r+=(t-s)*(i+n),-.5*r}invertY(){this.yFactor*=-1}},WT=class ZT extends Ze{constructor(){super(...arguments),this._end=-1}initialize(t,i,r,s,n){return this.hasZ=r,this.hasM=s,this.geometryType=i,this._stride=2+Number(r)+Number(s),this._geometry=t,this._pathIndex=-1,this._pathOffset=0,this._pointOffset=-this._stride,this._end=-1,this.yFactor=n,this}reset(){this.initialize(this._geometry,this.geometryType,this.hasZ,this.hasM,this.yFactor)}seekPath(t){if(t>=0&&t<this.totalSize){if(this._pathIndex<t)for(;this._pathIndex<t&&this.nextPath(););else if(this._pathIndex>t)for(;this._pathIndex>t&&this.prevPath(););return!0}return!1}seekPathStart(){this._pointOffset=this._pathOffset-this._stride}seekPathEnd(){this._pointOffset=this._end}seekInPath(t){const i=this._pathOffset+t*this._stride;return i>=0&&i<this._end&&(this._pointOffset=i,!0)}nextPoint(){return(this._pointOffset+=this._stride)<this._end}prevPoint(){return(this._pointOffset-=this._stride)>=this._pathOffset}nextPath(){return!(this.pathIndex>=this.totalSize-1)&&(this._pathIndex>=0&&(this._pathOffset+=this._stride*this.pathSize),this._pathIndex++,this._pointOffset=this._pathOffset-this._stride,this._end=this._pointOffset+this._stride+this._stride*this.pathSize,!0)}prevPath(){return!(this.pathIndex<=0)&&(this._pathIndex--,this._end=this._pathOffset,this._pathOffset-=this._stride*this.pathSize,this._pointOffset=this._pathOffset-this._stride,!0)}getCurrentPath(){const t=this._end,i=this._geometry.coords,r=this._pathOffset;return new ZT().initialize(new xb([this.pathSize],i.slice(r,t)),this.geometryType,this.hasZ,this.hasM,this.yFactor)}pathLength(){const t=this._end,i=this._stride,r=this._geometry.coords;let s=0;for(let n=this._pathOffset+i;n<t;n+=i){const o=r[n-i],a=r[n-i+1],l=r[n]-o,u=r[n+1]-a;s+=Math.sqrt(l*l+u*u)}return s}startPath(){this._geometry.lengths.push(0)}pushPath(t){this.startPath(),this.pushPoints(t)}pushPoint(t){for(let i=0;i<this._stride;++i)this._geometry.coords.push(t[i]);this._geometry.lengths[this.totalSize-1]++}pushXY(t,i){this._geometry.coords.push(t,i),this._geometry.lengths[this.totalSize-1]++}pushPoints(t){for(const i of t)for(let r=0;r<this._stride;++r)this._geometry.coords.push(i[r]);this._geometry.lengths[this.totalSize-1]+=t.length}pushCursor(t){const i=t.asOptimized();this._geometry.coords.push(...i.coords),this._geometry.lengths.push(...i.lengths)}asOptimized(){const t=this._geometry.clone();if(this.yFactor!==1)for(let i=1;i<t.coords.length;i+=this._stride)t.coords[i]*=this.yFactor;return this.geometryType==="esriGeometryPoint"&&(t.lengths.length=0),t}isClosed(){const t=this._geometry.coords,i=this._pathOffset,r=this._end-this._stride;for(let s=0;s<this._stride;s++)if(t[i+s]!==t[r+s])return!1;return!0}clone(){return new ZT().initialize(this._geometry.clone(),this.geometryType,this.hasZ,this.hasM,this.yFactor)}get totalPoints(){return this._geometry.isPoint?1:this._geometry.lengths.reduce(((t,i)=>t+i))}get pathSize(){const{lengths:t}=this._geometry;return this._geometry.isPoint?1:this._pathIndex<0||this._pathIndex>t.length-1?0:t[this._pathIndex]}get totalSize(){return this._geometry.isPoint?1:this._geometry.lengths.length}get x(){return this._geometry.coords[this._pointOffset]}set x(t){this._geometry.coords[this._pointOffset]=t}get y(){return this.yFactor*this._geometry.coords[this._pointOffset+1]}set y(t){this._geometry.coords[this._pointOffset+1]=this.yFactor*t}get z(){return this._geometry.coords[this._pointOffset+2]}set z(t){this._geometry.coords[this._pointOffset+2]=t}get m(){const t=this.hasZ?3:2;return this._geometry.coords[this._pointOffset+t]}set m(t){this._geometry.coords[this._pointOffset+3]=t}get pathIndex(){return this._pathIndex}get _coordIndex(){return this._pointOffset/this._stride}};function _we(e){const t=[e.x,e.y];return e.z&&t.push(e.z),e.m&&t.push(e.m),t}function iN(e){return gi(e)?[e.rings,"esriGeometryPolygon"]:Vi(e)?[e.paths,"esriGeometryPolyline"]:op(e)?[[e.points],"esriGeometryMultipoint"]:wr(e)?[[[[e.xmin,e.ymin],[e.xmin,e.ymax],[e.xmax,e.ymax],[e.xmax,e.ymin],[e.xmin,e.ymin]]],"esriGeometryEnvelope"]:Wy(e)?[[[_we(e)]],"esriGeometryPoint"]:[[],"esriGeometryPolyline"]}let YT=class JT extends Ze{initialize(t,i,r,s,n){return this._paths=t,this.geometryType=i,this.hasZ=r,this.hasM=s,this._pathIndex=this._pointIndex=-1,this.yFactor=n,this._mIndex=this.hasZ?3:2,this}reset(){this._pathIndex=this._pointIndex=-1}seekPath(t){return this._pathIndex=t,this._pointIndex=-1,t>=0&&t<this.totalSize&&(this._currentPath=this._paths[t],!0)}seekPathStart(){this._pointIndex=-1}seekPathEnd(){this._pointIndex=this._currentPath.length}seekInPath(t){return t>=0&&t<this._currentPath.length&&(this._pointIndex=t,this._currentPoint=this._currentPath[this._pointIndex],!0)}nextPoint(){return this._currentPoint=this._currentPath[++this._pointIndex],this._pointIndex<this._currentPath.length}prevPoint(){return this._currentPoint=this._currentPath[--this._pointIndex],this._pointIndex>=0}nextPath(){return this._pointIndex=-1,this._currentPath=this._paths[++this._pathIndex],this._pathIndex<this.totalSize}prevPath(){return this.pathIndex>0&&(this._pointIndex=-1,this._pathIndex--,this._currentPath=this._paths[this._pathIndex],!0)}pathLength(){const t=this._currentPath.length,i=this._currentPath;let r=0;for(let s=1;s<t;s++){const n=i[s-1],o=i[s],a=n[0],l=n[1],u=o[0]-a,c=o[1]-l;r+=Math.sqrt(u*u+c*c)}return r}startPath(){this._paths.push([])}getCurrentPath(){return new JT().initialize([this._currentPath],this.geometryType,this.hasZ,this.hasM,this.yFactor)}pushPath(t){this._paths.push(t)}pushPoint(t){this._paths[this.totalSize-1].push(t)}pushXY(t,i){this._paths[this.totalSize-1].push([t,i])}pushPoints(t){this._paths[this.totalSize-1].push(...t)}pushCursor(t){const i=Jb(t);for(const r of i)this.pushPath(r)}asOptimized(){const t=new xb;if(this.geometryType==="esriGeometryPoint")t.coords.push(...this._paths[0][0]),t.lengths.length=0;else for(const i of this._paths){for(const r of i)t.coords.push(r[0]),t.coords.push(r[1]*this.yFactor),this.hasZ&&t.coords.push(r[2]),this.hasM&&t.coords.push(r[this._mIndex]);t.lengths.push(i.length)}return t}isClosed(){const t=this._currentPath[0],i=this._currentPath[this._currentPath.length-1];for(let r=0;r<t.length;r++)if(t[r]!==i[r])return!1;return!0}clone(){return new JT().initialize(V(this._paths),this.geometryType,this.hasZ,this.hasM,this.yFactor)}get totalPoints(){return this._paths.map((t=>t.length)).reduce(((t,i)=>t+i))}get pathSize(){return this._pathIndex<0||this._pathIndex>this.totalSize-1?-1:this._paths[this._pathIndex].length}get totalSize(){return this._paths.length}get x(){return this._currentPoint[0]}set x(t){this._currentPoint[0]=t}get y(){return this.yFactor*this._currentPoint[1]}set y(t){this._currentPoint[1]=this.yFactor*t}get z(){return this._currentPoint[2]}set z(t){this._currentPoint[2]=t}get m(){return this._currentPoint[this._mIndex]}set m(t){this._currentPoint[this._mIndex]=t}get pathIndex(){return this._pathIndex}};const s_=4,n_=1;let rN=class hG extends WT{initialize(t,i,r,s,n){return super.initialize(t,i,r,s,n),this._controlPoints||(this._controlPoints=this._controlPoints=new Array(this.totalSize).fill(void 0).map((o=>new Set))),this}startPath(){super.startPath(),this._controlPoints.push(new Set)}clone(){const t=new hG().initialize(this._geometry.clone(),this.geometryType,this.hasZ,this.hasM,this.yFactor);return t._controlPoints=this._controlPoints,t}setControlPoint(){this._controlPoints[this.pathIndex].add(this._coordIndex)}getControlPoint(){return this._controlPoints[this.pathIndex].has(this._coordIndex)}setControlPointAt(t){this._controlPoints[this.pathIndex].add(t)}getControlPointAt(t){return this._controlPoints[this.pathIndex].has(t)}},sN=class dG extends YT{initialize(t,i,r,s,n){return super.initialize(t,i,r,s,n)}clone(){return new dG().initialize(V(this._paths),this.geometryType,this.hasZ,this.hasM,this.yFactor)}setControlPoint(){this._paths[this.pathIndex][this._pointIndex][s_]=n_}getControlPoint(){return this._paths[this.pathIndex][this._pointIndex][s_]===n_}setControlPointAt(t){this._paths[this.pathIndex][t][s_]=n_}getControlPointAt(t){return this._paths[this.pathIndex][t][s_]===n_}};const vwe=512;var wn,$i;(function(e){e[e.Unknown=0]="Unknown",e[e.Point=1]="Point",e[e.LineString=2]="LineString",e[e.Polygon=3]="Polygon"})(wn||(wn={}));let Le=class iy{constructor(t,i){this.x=t,this.y=i}static fromArray(t){return new iy(t[0],t[1])}clone(){return new iy(this.x,this.y)}equals(t,i){return t===this.x&&i===this.y}isEqual(t){return t.x===this.x&&t.y===this.y}setCoords(t,i){return this.x=t,this.y=i,this}normalize(){const t=this.x,i=this.y,r=Math.sqrt(t*t+i*i);return this.x/=r,this.y/=r,this}rightPerpendicular(){const t=this.x;return this.x=this.y,this.y=-t,this}leftPerpendicular(){const t=this.x;return this.x=-this.y,this.y=t,this}move(t,i){return this.x+=t,this.y+=i,this}assign(t){return this.x=t.x,this.y=t.y,this}assignAdd(t,i){return this.x=t.x+i.x,this.y=t.y+i.y,this}assignSub(t,i){return this.x=t.x-i.x,this.y=t.y-i.y,this}rotate(t,i){const r=this.x,s=this.y;return this.x=r*t-s*i,this.y=r*i+s*t,this}rotateReverse(t,i){const r=this.x,s=this.y;return this.x=r*t+s*i,this.y=-r*i+s*t,this}scale(t){return this.x*=t,this.y*=t,this}length(){const t=this.x,i=this.y;return Math.sqrt(t*t+i*i)}sub(t){return this.x-=t.x,this.y-=t.y,this}add(t){return this.x+=t.x,this.y+=t.y,this}static distance(t,i){const r=i.x-t.x,s=i.y-t.y;return Math.sqrt(r*r+s*s)}static add(t,i){return new iy(t.x+i.x,t.y+i.y)}static sub(t,i){return new iy(t.x-i.x,t.y-i.y)}},o_=class{constructor(t,i,r){this.ratio=t,this.x=i,this.y=r}},bwe=class{constructor(t,i,r,s=8,n=8){this._lines=[],this._starts=[],this.validateTessellation=!0,this._pixelRatio=s,this._pixelMargin=n,this._tileSize=vwe*s,this._dz=t,this._yPos=i,this._xPos=r}setPixelMargin(t){t!==this._pixelMargin&&(this._pixelMargin=t,this.setExtent(this._extent))}setExtent(t){this._extent=t,this._finalRatio=this._tileSize/t*(1<<this._dz);let i=this._pixelRatio*this._pixelMargin;i/=this._finalRatio;const r=t>>this._dz;i>r&&(i=r),this._margin=i,this._xmin=r*this._xPos-i,this._ymin=r*this._yPos-i,this._xmax=this._xmin+r+2*i,this._ymax=this._ymin+r+2*i}reset(t){this._type=t,this._lines=[],this._starts=[],this._line=null,this._start=0}moveTo(t,i){this._pushLine(),this._prevIsIn=this._isIn(t,i),this._moveTo(t,i,this._prevIsIn),this._prevPt=new Le(t,i),this._firstPt=new Le(t,i),this._dist=0}lineTo(t,i){const r=this._isIn(t,i),s=new Le(t,i),n=Le.distance(this._prevPt,s);let o,a,l,u,c,d,m,y;if(r)this._prevIsIn?this._lineTo(t,i,!0):(o=this._prevPt,a=s,l=this._intersect(a,o),this._start=this._dist+n*(1-this._r),this._lineTo(l.x,l.y,!0),this._lineTo(a.x,a.y,!0));else if(this._prevIsIn)a=this._prevPt,o=s,l=this._intersect(a,o),this._lineTo(l.x,l.y,!0),this._lineTo(o.x,o.y,!1);else{const g=this._prevPt,_=s;if(g.x<=this._xmin&&_.x<=this._xmin||g.x>=this._xmax&&_.x>=this._xmax||g.y<=this._ymin&&_.y<=this._ymin||g.y>=this._ymax&&_.y>=this._ymax)this._lineTo(_.x,_.y,!1);else{const v=[];if((g.x<this._xmin&&_.x>this._xmin||g.x>this._xmin&&_.x<this._xmin)&&(u=(this._xmin-g.x)/(_.x-g.x),y=g.y+u*(_.y-g.y),y<=this._ymin?d=!1:y>=this._ymax?d=!0:v.push(new o_(u,this._xmin,y))),(g.x<this._xmax&&_.x>this._xmax||g.x>this._xmax&&_.x<this._xmax)&&(u=(this._xmax-g.x)/(_.x-g.x),y=g.y+u*(_.y-g.y),y<=this._ymin?d=!1:y>=this._ymax?d=!0:v.push(new o_(u,this._xmax,y))),(g.y<this._ymin&&_.y>this._ymin||g.y>this._ymin&&_.y<this._ymin)&&(u=(this._ymin-g.y)/(_.y-g.y),m=g.x+u*(_.x-g.x),m<=this._xmin?c=!1:m>=this._xmax?c=!0:v.push(new o_(u,m,this._ymin))),(g.y<this._ymax&&_.y>this._ymax||g.y>this._ymax&&_.y<this._ymax)&&(u=(this._ymax-g.y)/(_.y-g.y),m=g.x+u*(_.x-g.x),m<=this._xmin?c=!1:m>=this._xmax?c=!0:v.push(new o_(u,m,this._ymax))),v.length===0)c?d?this._lineTo(this._xmax,this._ymax,!0):this._lineTo(this._xmax,this._ymin,!0):d?this._lineTo(this._xmin,this._ymax,!0):this._lineTo(this._xmin,this._ymin,!0);else if(v.length>1&&v[0].ratio>v[1].ratio)this._start=this._dist+n*v[1].ratio,this._lineTo(v[1].x,v[1].y,!0),this._lineTo(v[0].x,v[0].y,!0);else{this._start=this._dist+n*v[0].ratio;for(let b=0;b<v.length;b++)this._lineTo(v[b].x,v[b].y,!0)}this._lineTo(_.x,_.y,!1)}}this._dist+=n,this._prevIsIn=r,this._prevPt=s}close(){if(this._line.length>2){const t=this._firstPt,i=this._prevPt;t.x===i.x&&t.y===i.y||this.lineTo(t.x,t.y);const r=this._line;let s=r.length;for(;s>=4&&(r[0].x===r[1].x&&r[0].x===r[s-2].x||r[0].y===r[1].y&&r[0].y===r[s-2].y);)r.pop(),r[0].x=r[s-2].x,r[0].y=r[s-2].y,--s}}result(t=!0){return this._pushLine(),this._lines.length===0?null:(this._type===wn.Polygon&&t&&wwe.simplify(this._tileSize,this._margin*this._finalRatio,this._lines),this._lines)}resultWithStarts(){if(this._type!==wn.LineString)throw new Error("Only valid for lines");this._pushLine();const t=this._lines,i=t.length;if(i===0)return null;const r=[];for(let s=0;s<i;s++)r.push({line:t[s],start:this._starts[s]||0});return r}_isIn(t,i){return t>=this._xmin&&t<=this._xmax&&i>=this._ymin&&i<=this._ymax}_intersect(t,i){let r,s,n;if(i.x>=this._xmin&&i.x<=this._xmax)s=i.y<=this._ymin?this._ymin:this._ymax,n=(s-t.y)/(i.y-t.y),r=t.x+n*(i.x-t.x);else if(i.y>=this._ymin&&i.y<=this._ymax)r=i.x<=this._xmin?this._xmin:this._xmax,n=(r-t.x)/(i.x-t.x),s=t.y+n*(i.y-t.y);else{s=i.y<=this._ymin?this._ymin:this._ymax,r=i.x<=this._xmin?this._xmin:this._xmax;const o=(r-t.x)/(i.x-t.x),a=(s-t.y)/(i.y-t.y);o<a?(n=o,s=t.y+o*(i.y-t.y)):(n=a,r=t.x+a*(i.x-t.x))}return this._r=n,new Le(r,s)}_pushLine(){this._line&&(this._type===wn.Point?this._line.length>0&&(this._lines.push(this._line),this._starts.push(this._start)):this._type===wn.LineString?this._line.length>1&&(this._lines.push(this._line),this._starts.push(this._start)):this._type===wn.Polygon&&this._line.length>3&&(this._lines.push(this._line),this._starts.push(this._start))),this._line=[],this._start=0}_moveTo(t,i,r){this._type!==wn.Polygon?r&&(t=Math.round((t-(this._xmin+this._margin))*this._finalRatio),i=Math.round((i-(this._ymin+this._margin))*this._finalRatio),this._line.push(new Le(t,i))):(r||(t<this._xmin&&(t=this._xmin),t>this._xmax&&(t=this._xmax),i<this._ymin&&(i=this._ymin),i>this._ymax&&(i=this._ymax)),t=Math.round((t-(this._xmin+this._margin))*this._finalRatio),i=Math.round((i-(this._ymin+this._margin))*this._finalRatio),this._line.push(new Le(t,i)),this._isH=!1,this._isV=!1)}_lineTo(t,i,r){let s,n;if(this._type!==wn.Polygon)if(r){if(t=Math.round((t-(this._xmin+this._margin))*this._finalRatio),i=Math.round((i-(this._ymin+this._margin))*this._finalRatio),this._line.length>0&&(s=this._line[this._line.length-1],s.equals(t,i)))return;this._line.push(new Le(t,i))}else this._line&&this._line.length>0&&this._pushLine();else if(r||(t<this._xmin&&(t=this._xmin),t>this._xmax&&(t=this._xmax),i<this._ymin&&(i=this._ymin),i>this._ymax&&(i=this._ymax)),t=Math.round((t-(this._xmin+this._margin))*this._finalRatio),i=Math.round((i-(this._ymin+this._margin))*this._finalRatio),this._line&&this._line.length>0){s=this._line[this._line.length-1];const o=s.x===t,a=s.y===i;if(o&&a)return;this._isH&&o||this._isV&&a?(s.x=t,s.y=i,n=this._line[this._line.length-2],n.x===t&&n.y===i?(this._line.pop(),this._line.length<=1?(this._isH=!1,this._isV=!1):(n=this._line[this._line.length-2],this._isH=n.x===t,this._isV=n.y===i)):(this._isH=n.x===t,this._isV=n.y===i)):(this._line.push(new Le(t,i)),this._isH=o,this._isV=a)}else this._line.push(new Le(t,i))}},ZRe=class{setExtent(t){this._ratio=t===4096?1:4096/t}get validateTessellation(){return this._ratio<1}reset(t){this._lines=[],this._line=null}moveTo(t,i){this._line&&this._lines.push(this._line),this._line=[];const r=this._ratio;this._line.push(new Le(t*r,i*r))}lineTo(t,i){const r=this._ratio;this._line.push(new Le(t*r,i*r))}close(){const t=this._line;t&&!t[0].isEqual(t[t.length-1])&&t.push(t[0])}result(){return this._line&&this._lines.push(this._line),this._lines.length===0?null:this._lines}};(function(e){e[e.sideLeft=0]="sideLeft",e[e.sideRight=1]="sideRight",e[e.sideTop=2]="sideTop",e[e.sideBottom=3]="sideBottom"})($i||($i={}));let wwe=class Al{static simplify(t,i,r){if(!r)return;const s=-i,n=t+i,o=-i,a=t+i,l=[],u=[],c=r.length;for(let m=0;m<c;++m){const y=r[m];if(!y||y.length<2)continue;let g,_=y[0];const v=y.length;for(let b=1;b<v;++b)g=y[b],_.x===g.x&&(_.x<=s&&(_.y>g.y?(l.push(m),l.push(b),l.push($i.sideLeft),l.push(-1)):(u.push(m),u.push(b),u.push($i.sideLeft),u.push(-1))),_.x>=n&&(_.y<g.y?(l.push(m),l.push(b),l.push($i.sideRight),l.push(-1)):(u.push(m),u.push(b),u.push($i.sideRight),u.push(-1)))),_.y===g.y&&(_.y<=o&&(_.x<g.x?(l.push(m),l.push(b),l.push($i.sideTop),l.push(-1)):(u.push(m),u.push(b),u.push($i.sideTop),u.push(-1))),_.y>=a&&(_.x>g.x?(l.push(m),l.push(b),l.push($i.sideBottom),l.push(-1)):(u.push(m),u.push(b),u.push($i.sideBottom),u.push(-1)))),_=g}if(l.length===0||u.length===0)return;Al.fillParent(r,u,l),Al.fillParent(r,l,u);const d=[];Al.calcDeltas(d,u,l),Al.calcDeltas(d,l,u),Al.addDeltas(d,r)}static fillParent(t,i,r){const s=r.length,n=i.length;for(let o=0;o<n;o+=4){const a=i[o],l=i[o+1],u=i[o+2],c=t[a][l-1],d=t[a][l];let m=8092,y=-1;for(let g=0;g<s;g+=4){if(r[g+2]!==u)continue;const _=r[g],v=r[g+1],b=t[_][v-1],S=t[_][v];switch(u){case $i.sideLeft:case $i.sideRight:if(a_(c.y,b.y,S.y)&&a_(d.y,b.y,S.y)){const $=Math.abs(S.y-b.y);$<m&&(m=$,y=g)}break;case $i.sideTop:case $i.sideBottom:if(a_(c.x,b.x,S.x)&&a_(d.x,b.x,S.x)){const $=Math.abs(S.x-b.x);$<m&&(m=$,y=g)}}}i[o+3]=y}}static calcDeltas(t,i,r){const s=i.length;for(let n=0;n<s;n+=4){const o=[],a=Al.calcDelta(n,i,r,o);t.push(i[n]),t.push(i[n+1]),t.push(i[n+2]),t.push(a)}}static calcDelta(t,i,r,s){const n=i[t+3];if(n===-1)return 0;const o=s.length;return o>1&&s[o-2]===n?0:(s.push(n),Al.calcDelta(n,r,i,s)+1)}static addDeltas(t,i){const r=t.length;let s=0;for(let n=0;n<r;n+=4){const o=t[n+3];o>s&&(s=o)}for(let n=0;n<r;n+=4){const o=i[t[n]],a=t[n+1],l=s-t[n+3];switch(t[n+2]){case $i.sideLeft:o[a-1].x-=l,o[a].x-=l,a===1&&(o[o.length-1].x-=l),a===o.length-1&&(o[0].x-=l);break;case $i.sideRight:o[a-1].x+=l,o[a].x+=l,a===1&&(o[o.length-1].x+=l),a===o.length-1&&(o[0].x+=l);break;case $i.sideTop:o[a-1].y-=l,o[a].y-=l,a===1&&(o[o.length-1].y-=l),a===o.length-1&&(o[0].y-=l);break;case $i.sideBottom:o[a-1].y+=l,o[a].y+=l,a===1&&(o[o.length-1].y+=l),a===o.length-1&&(o[0].y+=l)}}}};const a_=(e,t,i)=>e>=t&&e<=i||e>=i&&e<=t,Swe=512;let ta,xwe=class{constructor(t){this._geometry=t}next(){const t=this._geometry;return this._geometry=null,t}};function JP(e,t,i){if(!e)return null;ta||(ta=new bwe(0,0,0,1));const r=i?-1:1,s=e.geometryType==="esriGeometryPolygon",n=s?wn.Polygon:wn.LineString,o=s?3:2;let a,l;for(ta.reset(n),ta.setPixelMargin(t+1),ta.setExtent(Swe);e.nextPath();)if(!(e.pathSize<o)){for(e.nextPoint(),a=e.x,l=r*e.y,ta.moveTo(a,l);e.nextPoint();)a=e.x,l=r*e.y,ta.lineTo(a,l);s&&ta.close()}const u=ta.result(!1);if(u){const c=Ze.createEmptyOptimizedCIM(e.geometryType);for(const d of u){c.startPath();for(const m of d)c.pushXY(m.x,r*m.y)}return c.reset(),c}return null}let $we=class{applyColorSubstitution(t,i){if(!i)return t;this._rasterizationCanvas||(this._rasterizationCanvas=document.createElement("canvas"));const{width:r,height:s}=t,n=this._rasterizationCanvas,o=n.getContext("2d",{willReadFrequently:!0});t!==n&&(n.width=r,n.height=s,o.drawImage(t,0,0,r,s));const a=o.getImageData(0,0,r,s).data;if(i){for(const u of i)if(u&&u.oldColor&&u.oldColor.length===4&&u.newColor&&u.newColor.length===4){const[c,d,m,y]=u.oldColor,[g,_,v,b]=u.newColor;if(c===g&&d===_&&m===v&&y===b)continue;for(let S=0;S<a.length;S+=4)c===a[S]&&d===a[S+1]&&m===a[S+2]&&y===a[S+3]&&(a[S]=g,a[S+1]=_,a[S+2]=v,a[S+3]=b)}}const l=new ImageData(a,r,s);return o.putImageData(l,0,0),n}tintImageData(t,i){if(!i||i.length<4)return t;this._rasterizationCanvas||(this._rasterizationCanvas=document.createElement("canvas"));const{width:r,height:s}=t,n=this._rasterizationCanvas,o=n.getContext("2d",{willReadFrequently:!0});t!==n&&(n.width=r,n.height=s,o.drawImage(t,0,0,r,s));const a=o.getImageData(0,0,r,s),l=new Uint8Array(a.data),u=[i[0]/255,i[1]/255,i[2]/255,i[3]/255];for(let d=0;d<l.length;d+=4)l[d]*=u[0],l[d+1]*=u[1],l[d+2]*=u[2],l[d+3]*=u[3];const c=new ImageData(new Uint8ClampedArray(l.buffer),r,s);return o.putImageData(c,0,0),n}};var lo;let Mwe=(lo=class{static local(){return lo.instance===null&&(lo.instance=new lo),lo.instance}execute(t,i,r,s){return new Twe(t,i)}},lo.instance=null,lo),Twe=class{constructor(t,i){this._inputGeometries=t,this._angleTolerance=i.angleTolerance!==void 0?i.angleTolerance:120,this._maxCosAngle=Math.cos((1-Math.abs(this._angleTolerance)/180)*Math.PI)}next(){let t=this._inputGeometries.next();if(!t)return null;for(;t;){if(t.geometryType==="esriGeometryPolygon")this._isClosed=!0;else if(t.geometryType==="esriGeometryPolyline")this._isClosed=!1;else{if(t.geometryType!=="esriGeometryEnvelope"){t=this._inputGeometries.next();continue}if(this._maxCosAngle)return t;this._isClosed=!0}for(;t.nextPath();)this._processPath(t);return t.reset(),t}return null}_processPath(t){if(t.nextPoint()){const i=t.x,r=t.y;let s=i,n=r,o=t.pathSize,a=0,l=0,u=0,c=0,d=0,m=0;this._isClosed&&++o;for(let y=1;t.nextPoint()||y<o;++y){let g,_;this._isClosed&&y===o-1?(g=i,_=r):(g=t.x,_=t.y);const v=g-s,b=_-n,S=Math.sqrt(v*v+b*b);y>1&&S>0&&u>0&&(a*v+l*b)/S/u<=this._maxCosAngle&&t.setControlPointAt(y-1),y===1&&(c=v,d=b,m=S),S>0&&(s=g,n=_,a=v,l=b,u=S)}this._isClosed&&u>0&&m>0&&(a*c+l*d)/m/u<=this._maxCosAngle&&t.setControlPointAt(0)}}};function im(e,t){e[4]=t}let o0=class{constructor(t,i=!0,r=!0,s=0){this.isClosed=!1,this.geometryCursor=null,this.geometryCursor=!i&&t.geometryType==="esriGeometryPolygon"||!r&&t.geometryType==="esriGeometryPolyline"?null:t,this.geomUnitsPerPoint=s,this.iterateMultiPath=!1,this.iteratePath=!1,this.internalPlacement=new Sf}next(){if(!this.geometryCursor)return null;const t=this.processMultiPath(this.geometryCursor);return this.iterateMultiPath&&t||(this.geometryCursor=null),t}processMultiPath(t){for(;this.iteratePath||t.pathIndex<t.totalSize-1;){this.iteratePath||t.nextPath(),this.iterateMultiPath=!0;const i=this.processPath(t);if(i)return i}return this.iterateMultiPath=!1,null}},xf=class{constructor(t,i,r,s=0){this.isClosed=!1,this.inputGeometries=t,this.acceptPolygon=i,this.acceptPolyline=r,this.geomUnitsPerPoint=s,this.iteratePath=!1,this.multiPathCursor=null}next(){for(;;){if(!this.multiPathCursor){let t=this.inputGeometries.next();for(;t&&(this.isClosed=this.acceptPolygon&&t.geometryType==="esriGeometryPolygon"||t.geometryType==="esriGeometryEnvelope",this.multiPathCursor=t,!this.multiPathCursor);)t=this.inputGeometries.next();if(!this.multiPathCursor)return null}for(;this.iteratePath||this.multiPathCursor.nextPath();){this.multiPathCursor.seekPathStart();const t=this.processPath(this.multiPathCursor);if(t)return t}this.multiPathCursor=null}}};const mg=.03;let Qa=class{constructor(t=0,i=!1){}isEmpty(t){if(!t.nextPoint())return!0;let i,r,s,n;for(i=t.x,r=t.y;t.nextPoint();i=r,r=n)if(s=t.x,n=t.y,s!==i||n!==r)return t.seekPathStart(),!1;return t.seekPathStart(),!0}normalize(t){const i=Math.sqrt(t[0]*t[0]+t[1]*t[1]);i!==0&&(t[0]/=i,t[1]/=i)}getLength(t,i,r,s){const n=r-t,o=s-i;return Math.sqrt(n*n+o*o)}getSegLength(t){const[[i,r],[s,n]]=t;return this.getLength(i,r,s,n)}getCoord2D(t,i,r,s,n){return[t+(r-t)*n,i+(s-i)*n]}getSegCoord2D(t,i){const[[r,s],[n,o]]=t;return this.getCoord2D(r,s,n,o,i)}getAngle(t,i,r,s,n){const o=r-t,a=s-i;return Math.atan2(a,o)}getAngleCS(t,i,r,s,n,o){t==null&&(t=[0,0]);const a=s-i,l=n-r,u=Math.sqrt(a*a+l*l);return u!==0?(t[0]=a/u,t[1]=l/u,t):(t[0]=1,t[1]=0,t)}getSegAngleCS(t,i,r){const[[s,n],[o,a]]=i;return this.getAngleCS(t,s,n,o,a,r)}cut(t,i,r,s,n,o){return[n<=0?[t,i]:this.getCoord2D(t,i,r,s,n),o>=1?[r,s]:this.getCoord2D(t,i,r,s,o)]}getSubCurve(t,i,r){const s=Ze.createEmptyOptimizedCIM("esriGeometryPolyline");return this.appendSubCurve(s,t,i,r)?s:null}appendSubCurve(t,i,r,s){t.startPath(),i.seekPathStart();let n=0,o=!0;if(!i.nextPoint())return!1;let a=i.x,l=i.y;for(;i.nextPoint();){const u=this.getLength(a,l,i.x,i.y);if(u!==0){if(o){if(n+u>r){const c=(r-n)/u;let d=1,m=!1;n+u>=s&&(d=(s-n)/u,m=!0);const y=this.cut(a,l,i.x,i.y,c,d);if(y&&t.pushPoints(y),m)break;o=!1}}else{if(n+u>s){const c=this.cut(a,l,i.x,i.y,0,(s-n)/u);c&&t.pushPoint(c[1]);break}t.pushXY(i.x,i.y)}n+=u,a=i.x,l=i.y}else a=i.x,l=i.y}return!0}getCIMPointAlong(t,i){if(!t.nextPoint())return null;let r,s,n,o,a=0;for(r=t.x,s=t.y;t.nextPoint();r=n,s=o){n=t.x,o=t.y;const l=this.getLength(r,s,n,o);if(l!==0){if(a+l>i){const u=(i-a)/l;return this.getCoord2D(r,s,n,o,u)}a+=l}}return null}offset(t,i,r,s,n){if(!t||t.length<2)return null;let o=0,a=t[o++],l=o;for(;o<t.length;){const m=t[o];m[0]===a[0]&&m[1]===a[1]||(o!==l&&(t[l]=t[o]),a=t[l++]),o++}const u=t[0][0]===t[l-1][0]&&t[0][1]===t[l-1][1];if(u&&--l,l<(u?3:2))return null;const c=[];a=u?t[l-1]:null;let d=t[0];for(let m=0;m<l;m++){const y=m===l-1?u?t[0]:null:t[m+1];if(a)if(y){const g=[y[0]-d[0],y[1]-d[1]];this.normalize(g);const _=[d[0]-a[0],d[1]-a[1]];this.normalize(_);const v=_[0]*g[1]-_[1]*g[0],b=_[0]*g[0]+_[1]*g[1];if(v===0&&b===1){d=y;continue}if(v>=0==i<=0){if(b<1){const S=[g[0]-_[0],g[1]-_[1]];this.normalize(S);const $=Math.sqrt((1+b)/2);if($>1/s){const E=-Math.abs(i)/$;c.push([d[0]-S[0]*E,d[1]-S[1]*E])}}}else switch(r){case Na.Mitered:{const S=Math.sqrt((1+b)/2);if(S>0&&1/S<s){const $=[g[0]-_[0],g[1]-_[1]];this.normalize($);const E=Math.abs(i)/S;c.push([d[0]-$[0]*E,d[1]-$[1]*E]);break}}case Na.Bevelled:c.push([d[0]+_[1]*i,d[1]-_[0]*i]),c.push([d[0]+g[1]*i,d[1]-g[0]*i]);break;case Na.Rounded:if(b<1){c.push([d[0]+_[1]*i,d[1]-_[0]*i]);const S=Math.floor(2.5*(1-b));if(S>0){const $=1/S;let E=$;for(let C=1;C<S;C++,E+=$){const P=[_[1]*(1-E)+g[1]*E,-_[0]*(1-E)-g[0]*E];this.normalize(P),c.push([d[0]+P[0]*i,d[1]+P[1]*i])}}c.push([d[0]+g[1]*i,d[1]-g[0]*i])}break;case Na.Square:default:if(v<0)c.push([d[0]+(_[1]+_[0])*i,d[1]+(_[1]-_[0])*i]),c.push([d[0]+(g[1]-g[0])*i,d[1]-(g[0]+g[1])*i]);else{const S=Math.sqrt((1+Math.abs(b))/2),$=[g[0]-_[0],g[1]-_[1]];this.normalize($);const E=i/S;c.push([d[0]-$[0]*E,d[1]-$[1]*E])}}}else{const g=[d[0]-a[0],d[1]-a[1]];this.normalize(g),c.push([d[0]+g[1]*i,d[1]-g[0]*i])}else{const g=[y[0]-d[0],y[1]-d[1]];this.normalize(g),c.push([d[0]+g[1]*i,d[1]-g[0]*i])}a=d,d=y}return c.length<(u?3:2)?null:(u&&c.push([c[0][0],c[0][1]]),c)}};const gS=1.7320508075688772,Ewe=5,Cwe=up.OpenEnded;var uo;let Pwe=(uo=class{static local(){return uo.instance===null&&(uo.instance=new uo),uo.instance}execute(t,i,r,s,n){return new Iwe(t,i,r)}},uo.instance=null,uo),Iwe=class extends xf{constructor(t,i,r){super(t,!1,!0),this._curveHelper=new Qa,this._width=(i.width!==void 0?i.width:Ewe)*r,this._arrowType=i.geometricEffectArrowType!==void 0?i.geometricEffectArrowType:i.arrowType!==void 0?i.arrowType:Cwe,this._offsetFlattenError=mg*r}processPath(t){const i=Ze.createEmptyOptimizedCIM(t.geometryType);switch(this._arrowType){case up.OpenEnded:default:this._constructSimpleArrow(i,t,!0);break;case up.Block:this._constructSimpleArrow(i,t,!1);break;case up.Crossed:this._constructCrossedArrow(i,t)}return i}_constructSimpleArrow(t,i,r){const s=i.pathLength();let n=this._width;s<2*n&&(n=s/2);const o=this._curveHelper.getSubCurve(i,0,s-n);if(!o||!o.nextPath())return;o.seekPathStart();const a=n/2;if(this._curveHelper.isEmpty(o))return;const l=nu(o),u=this._constructOffset(l,-a);if(!u)return;const c=this._constructOffset(l,a);if(!c)return;const d=this._constructArrowBasePoint(u,-a/2);if(!d)return;const m=this._constructArrowBasePoint(c,a/2);if(!m)return;i.seekInPath(i.pathSize-1);const y=[i.x,i.y];t.pushPath(c),t.nextPath(),t.nextPoint(),t.setControlPoint(),t.pushPoint(m),t.nextPoint(),t.setControlPoint(),t.pushPoint(y),t.nextPoint(),t.setControlPoint(),t.pushPoint(d),t.nextPoint(),t.setControlPoint(),t.pushPoints(u.reverse()),t.setControlPoint(),r||(t.setControlPointAt(0),t.setControlPointAt(t.pathSize-1),t.pushPoint(c[0])),t.reset()}_constructCrossedArrow(t,i){const r=i.pathLength();let s=this._width;r<s*(1+gS+1)&&(s=r/(1+gS+1)),i.seekPathStart();const n=this._curveHelper.getSubCurve(i,0,r-s*(1+gS));if(!n)return;n.nextPath();const o=s/2;if(this._curveHelper.isEmpty(n))return;const a=nu(n),l=this._constructOffset(a,o);if(!l)return;const u=this._constructOffset(a,-o);if(!u)return;const c=this._curveHelper.getSubCurve(i,0,r-s);if(!c||(c.nextPath(),this._curveHelper.isEmpty(c)))return;const d=nu(c),m=this._constructOffset(d,o);if(!m)return;const y=this._constructOffset(d,-o);if(!y)return;const g=m[m.length-1],_=this._constructArrowBasePoint(m,o/2);if(!_)return;const v=y[y.length-1],b=this._constructArrowBasePoint(y,-o/2);if(!b)return;i.seekInPath(i.pathSize-1);const S=[i.x,i.y];t.pushPath(l),t.nextPath(),t.nextPoint(),t.setControlPoint(),t.pushPoint(v),t.nextPoint(),t.setControlPoint(),t.pushPoint(b),t.nextPoint(),t.setControlPoint(),t.pushPoint(S),t.nextPoint(),t.setControlPoint(),t.pushPoint(_),t.nextPoint(),t.setControlPoint(),t.pushPoint(g),t.nextPoint(),t.setControlPoint(),t.pushPoints(u.reverse()),t.nextPoint(),t.setControlPoint(),t.reset()}_constructOffset(t,i){return this._curveHelper.offset(t,i,Na.Rounded,4,this._offsetFlattenError)}_constructArrowBasePoint(t,i){if(!t||t.length<2)return null;const r=t[t.length-2],s=t[t.length-1],n=[s[0]-r[0],s[1]-r[1]];return this._curveHelper.normalize(n),[s[0]+n[1]*i,s[1]-n[0]*i]}};var co;let Awe=(co=class{static local(){return co.instance===null&&(co.instance=new co),co.instance}execute(t,i,r,s,n,o,a){return new Lwe(t,i,r,s,n,o,a)}},co.instance=null,co),Lwe=class{constructor(t,i,r,s,n,o,a){this._preventClipping=a,this._inputGeometries=t,this._tileKey=s,this._geometryEngine=n,this._curveHelper=new Qa,this._size=(i.size!==void 0?i.size:1)*r,this._maxInflateSize=o*r,this._offsetFlattenError=mg*r}next(){let t;for(;t=this._inputGeometries.next();){if(this._size===0)return t;if(t.geometryType==="esriGeometryEnvelope"){if(this._size>0){const n=Ze.createEmptyOptimizedCIM(t.geometryType),o=Jb(t)[0],a=this._curveHelper.offset(o,this._size,Na.Rounded,4,this._offsetFlattenError);if(a)return n.pushPath(a),n}else if(this._size<0){const n=t.asJSON();if(Math.min(n.xmax-n.xmin,n.ymax-n.ymin)+2*this._size>0)return Ze.fromJSONCIM({xmin:n.xmin-this._size,xmax:n.xmax+this._size,ymin:n.ymin-this._size,ymax:n.ymax+this._size})}}const i=this._geometryEngine;if(i==null)return null;const r=!this._preventClipping&&this._tileKey?JP(t,this._maxInflateSize,!0):t;if(!r)continue;const s=i.buffer(ae.WebMercator,r.asJSON(),this._size,1);return s?Ze.fromJSONCIM(s):null}return null}};var ho;let kwe=(ho=class{static local(){return ho.instance===null&&(ho.instance=new ho),ho.instance}execute(t,i,r,s,n){return new Rwe(t,i,r)}},ho.instance=null,ho),Rwe=class{constructor(t,i,r){this._defaultPointSize=20,this._inputGeometries=t,this._geomUnitsPerPoint=r,this._rule=i.rule??Se.FullGeometry,this._defaultSize=this._defaultPointSize*r}next(){let t;for(;t=this._inputGeometries.next();){const i=this._processGeom(Jb(t));if(i?.length)return Ze.fromJSONCIM({paths:i})}return null}_clone(t){return[t[0],t[1]]}_mid(t,i){return[(t[0]+i[0])/2,(t[1]+i[1])/2]}_mix(t,i,r,s){return[t[0]*i+r[0]*s,t[1]*i+r[1]*s]}_add(t,i){return[t[0]+i[0],t[1]+i[1]]}_add2(t,i,r){return[t[0]+i,t[1]+r]}_sub(t,i){return[t[0]-i[0],t[1]-i[1]]}_dist(t,i){return Math.sqrt((t[0]-i[0])*(t[0]-i[0])+(t[1]-i[1])*(t[1]-i[1]))}_norm(t){return Math.sqrt(t[0]*t[0]+t[1]*t[1])}_normalize(t,i=1){const r=i/this._norm(t);t[0]*=r,t[1]*=r}_leftPerpendicular(t){const i=-t[1],r=t[0];t[0]=i,t[1]=r}_leftPerp(t){return[-t[1],t[0]]}_rightPerpendicular(t){const i=t[1],r=-t[0];t[0]=i,t[1]=r}_rightPerp(t){return[t[1],-t[0]]}_dotProduct(t,i){return t[0]*i[0]+t[1]*i[1]}_crossProduct(t,i){return t[0]*i[1]-t[1]*i[0]}_rotateDirect(t,i,r){const s=t[0]*i-t[1]*r,n=t[0]*r+t[1]*i;t[0]=s,t[1]=n}_makeCtrlPt(t){const i=[t[0],t[1]];return im(i,1),i}_addAngledTicks(t,i,r,s){const n=this._sub(r,i);this._normalize(n);const o=this._crossProduct(n,this._sub(s,i));let a;a=o>0?this._rightPerp(n):this._leftPerp(n);const l=Math.abs(o)/2,u=[];u.push([i[0]+(a[0]-n[0])*l,i[1]+(a[1]-n[1])*l]),u.push(i),u.push(r),u.push([r[0]+(a[0]+n[0])*l,r[1]+(a[1]+n[1])*l]),t.push(u)}_addBezier2(t,i,r,s,n){if(n--===0)return void t.push(s);const o=this._mid(i,r),a=this._mid(r,s),l=this._mid(o,a);this._addBezier2(t,i,o,l,n),this._addBezier2(t,l,a,s,n)}_addBezier3(t,i,r,s,n,o){if(o--===0)return void t.push(n);const a=this._mid(i,r),l=this._mid(r,s),u=this._mid(s,n),c=this._mid(a,l),d=this._mid(l,u),m=this._mid(c,d);this._addBezier3(t,i,a,c,m,o),this._addBezier3(t,m,d,u,n,o)}_add90DegArc(t,i,r,s,n){const o=n??this._crossProduct(this._sub(r,i),this._sub(s,i))>0,a=this._mid(i,r),l=this._sub(a,i);o?this._leftPerpendicular(l):this._rightPerpendicular(l),a[0]+=l[0],a[1]+=l[1],this._addBezier3(t,i,this._mix(i,.33333,a,.66667),this._mix(r,.33333,a,.66667),r,4)}_addArrow(t,i,r){const s=i[0],n=i[1],o=i[i.length-1],a=this._sub(s,n),l=this._norm(a);this._normalize(a);const u=Math.abs(this._crossProduct(a,this._sub(o,n)));let c=this._dotProduct(a,this._sub(o,n));c<.05*l?c=.05*l:c>.95*l&&(c=.95*l);const d=.5*u,m=this._leftPerp(a),y=[n[0]+a[0]*c,n[1]+a[1]*c],g=i.length-1,_=[];_.push(r?[-m[0],-m[1]]:m);let v=[-a[0],-a[1]];for(let b=1;b<g-1;b++){const S=this._sub(i[b+1],i[b]);this._normalize(S);const $=this._dotProduct(S,v),E=this._crossProduct(S,v),C=Math.sqrt((1+$)/2),P=this._sub(S,v);this._normalize(P),P[0]/=C,P[1]/=C,_.push(E<0?[-P[0],-P[1]]:P),v=S}_.push(this._rightPerp(v));for(let b=_.length-1;b>0;b--)t.push([i[b][0]+_[b][0]*d,i[b][1]+_[b][1]*d]);t.push([y[0]+_[0][0]*d,y[1]+_[0][1]*d]),t.push([y[0]+_[0][0]*u,y[1]+_[0][1]*u]),t.push(s),t.push([y[0]-_[0][0]*u,y[1]-_[0][1]*u]),t.push([y[0]-_[0][0]*d,y[1]-_[0][1]*d]);for(let b=1;b<_.length;b++)t.push([i[b][0]-_[b][0]*d,i[b][1]-_[b][1]*d])}_addDash(t,i,r){const s=this._norm(r)/7;this._normalize(r);let n=[];for(let o=0;o<=7;o++)n.push([i[0]+r[0]*o*s,i[1]+r[1]*o*s]),1&o&&(t.push(n),n=[])}_cp2(t,i,r){return t.length>=2?t[1]:this._add2(t[0],i*this._defaultSize,r*this._defaultSize)}_cp3(t,i,r,s){if(t.length>=3)return t[2];const n=this._mix(t[0],1-r,i,r),o=this._sub(i,t[0]);return this._normalize(o),this._rightPerpendicular(o),[n[0]+o[0]*s*this._defaultSize,n[1]+o[1]*s*this._defaultSize]}_arrowPath(t){if(t.length>2)return t;const i=t[0],r=this._cp2(t,-4,0),s=this._sub(i,r);this._normalize(s);const n=this._rightPerp(s);return[i,r,[i[0]+(n[0]-s[0])*this._defaultSize,i[1]+(n[1]-s[1])*this._defaultSize]]}_arrowLastSeg(t){const i=t[0],r=this._cp2(t,-4,0);let s;if(t.length>=3)s=t[t.length-1];else{const n=this._sub(i,r);this._normalize(n);const o=this._rightPerp(n);s=[i[0]+(o[0]-n[0])*this._defaultSize,i[1]+(o[1]-n[1])*this._defaultSize]}return[r,s]}_processGeom(t){if(!t)return null;const i=[];for(const r of t){const s=r.length>1&&AQ(r)<this._defaultSize;if(!r||r.length===0||s)continue;const n=r.length;let o=r[0];switch(this._rule){case Se.PerpendicularFromFirstSegment:{const a=this._cp2(r,0,-1),l=this._cp3(r,a,.5,4),u=[];u.push(l),u.push(this._mid(o,a)),i.push(u);break}case Se.ReversedFirstSegment:{const a=this._cp2(r,0,-1);i.push([a,o]);break}case Se.PerpendicularToSecondSegment:{if(r.length<3)return[];const a=this._cp2(r,-4,1),l=this._cp3(r,a,.882353,-1.94),u=[];u.push(this._mid(a,l)),u.push(o),i.push(u);break}case Se.SecondSegmentWithTicks:{if(r.length<3)return[];const a=this._cp2(r,-4,1),l=this._cp3(r,a,.882353,-1.94),u=this._sub(l,a);let c;c=this._crossProduct(u,this._sub(o,a))>0?this._rightPerp(u):this._leftPerp(u);const d=[];d.push([a[0]+(c[0]-u[0])/3,a[1]+(c[1]-u[1])/3]),d.push(a),d.push(l),d.push([l[0]+(c[0]+u[0])/3,l[1]+(c[1]+u[1])/3]),i.push(d);break}case Se.DoublePerpendicular:{const a=this._cp2(r,0,-1),l=this._cp3(r,a,.5,3),u=this._mid(o,a),c=this._sub(u,l);this._normalize(c);const d=this._crossProduct(c,this._sub(o,l));this._leftPerpendicular(c);const m=[];m.push(o),m.push([l[0]+c[0]*d,l[1]+c[1]*d]),i.push(m);const y=[];y.push([l[0]-c[0]*d,l[1]-c[1]*d]),y.push(a),i.push(y);break}case Se.OppositeToFirstSegment:{const a=this._cp2(r,0,-1),l=this._cp3(r,a,.5,3),u=this._mid(o,a),c=this._sub(u,l);this._normalize(c);const d=this._crossProduct(c,this._sub(o,l));this._leftPerpendicular(c);const m=[];m.push([l[0]+c[0]*d,l[1]+c[1]*d]),m.push([l[0]-c[0]*d,l[1]-c[1]*d]),i.push(m);break}case Se.TriplePerpendicular:{const a=this._cp2(r,0,-1),l=this._cp3(r,a,.5,4),u=this._mid(o,a),c=this._sub(u,l);this._normalize(c);const d=this._crossProduct(c,this._sub(o,l));this._leftPerpendicular(c);const m=[];m.push([l[0]+c[0]*d*.8,l[1]+c[1]*d*.8]),m.push([u[0]+.8*(o[0]-u[0]),u[1]+.8*(o[1]-u[1])]),i.push(m),i.push([l,u]);const y=[];y.push([l[0]-c[0]*d*.8,l[1]-c[1]*d*.8]),y.push([u[0]+.8*(a[0]-u[0]),u[1]+.8*(a[1]-u[1])]),i.push(y);break}case Se.HalfCircleFirstSegment:{const a=this._cp2(r,0,-1),l=this._cp3(r,a,.5,4),u=this._mid(o,a);let c=this._sub(a,o);const d=Math.cos(Math.PI/18),m=Math.sin(Math.PI/18),y=Math.sqrt((1+d)/2),g=Math.sqrt((1-d)/2),_=[];let v;this._crossProduct(c,this._sub(l,o))>0?(_.push(o),c=this._sub(o,u),v=a):(_.push(a),c=this._sub(a,u),v=o),this._rotateDirect(c,y,g),c[0]/=y,c[1]/=y;for(let b=1;b<=18;b++)_.push(this._add(u,c)),this._rotateDirect(c,d,m);_.push(v),i.push(_);break}case Se.HalfCircleSecondSegment:{const a=this._cp2(r,0,-1),l=this._cp3(r,a,1,-1);let u=this._sub(o,a);this._normalize(u);const c=this._crossProduct(u,this._sub(l,a))/2;this._leftPerpendicular(u);const d=[a[0]+u[0]*c,a[1]+u[1]*c];u=this._sub(a,d);const m=Math.cos(Math.PI/18);let y=Math.sin(Math.PI/18);c>0&&(y=-y);const g=[a];for(let _=1;_<=18;_++)this._rotateDirect(u,m,y),g.push(this._add(d,u));i.push(g);break}case Se.HalfCircleExtended:{const a=this._cp2(r,0,-2),l=this._cp3(r,a,1,-1);let u;if(n>=4)u=r[3];else{const _=this._sub(o,a);u=this._add(l,_)}const c=this._dist(a,l)/2/.75,d=this._sub(a,o);this._normalize(d,c);const m=this._sub(l,u);this._normalize(m,c);const y=[u,l];i.push(y);const g=[this._clone(l)];this._addBezier3(g,l,this._add(l,m),this._add(a,d),a,4),g.push(o),i.push(g);break}case Se.OpenCircle:{const a=this._cp2(r,-2,0),l=this._sub(a,o),u=Math.cos(Math.PI/18),c=-Math.sin(Math.PI/18),d=[a];for(let m=1;m<=33;m++)this._rotateDirect(l,u,c),d.push(this._add(o,l));i.push(d);break}case Se.CoverageEdgesWithTicks:{const a=this._cp2(r,0,-1);let l,u;if(n>=3)l=r[2];else{const y=this._sub(a,o),g=this._leftPerp(y);l=[o[0]+g[0]-.25*y[0],o[1]+g[1]-.25*y[1]]}if(n>=4)u=r[3];else{const y=this._mid(o,a),g=this._sub(o,a);this._normalize(g),this._leftPerpendicular(g);const _=this._crossProduct(g,this._sub(l,y));this._rightPerpendicular(g),u=[l[0]+g[0]*_*2,l[1]+g[1]*_*2]}const c=this._sub(a,o);let d,m;d=this._crossProduct(c,this._sub(l,o))>0?this._rightPerp(c):this._leftPerp(c),m=[],m.push(l),m.push(o),m.push([o[0]+(d[0]-c[0])/3,o[1]+(d[1]-c[1])/3]),i.push(m),d=this._crossProduct(c,this._sub(u,a))>0?this._rightPerp(c):this._leftPerp(c),m=[],m.push([a[0]+(d[0]+c[0])/3,a[1]+(d[1]+c[1])/3]),m.push(a),m.push(u),i.push(m);break}case Se.GapExtentWithDoubleTicks:{const a=this._cp2(r,0,2),l=this._cp3(r,a,0,1);let u;if(n>=4)u=r[3];else{const c=this._sub(a,o);u=this._add(l,c)}this._addAngledTicks(i,o,a,this._mid(l,u)),this._addAngledTicks(i,l,u,this._mid(o,a));break}case Se.GapExtentMidline:{const a=this._cp2(r,2,0),l=this._cp3(r,a,0,1);let u;if(n>=4)u=r[3];else{const d=this._sub(a,o);u=this._add(l,d)}const c=[];c.push(this._mid(o,l)),c.push(this._mid(a,u)),i.push(c);break}case Se.Chevron:{const a=this._cp2(r,-1,-1);let l;if(n>=3)l=r[2];else{const u=this._sub(a,o);this._leftPerpendicular(u),l=this._add(o,u)}i.push([a,this._makeCtrlPt(o),l]);break}case Se.PerpendicularWithArc:{const a=this._cp2(r,0,-2),l=this._cp3(r,a,.5,-1),u=this._sub(a,o),c=this._norm(u);u[0]/=c,u[1]/=c;const d=this._crossProduct(u,this._sub(l,o));let m=this._dotProduct(u,this._sub(l,o));m<.05*c?m=.05*c:m>.95*c&&(m=.95*c);const y=[o[0]+u[0]*m,o[1]+u[1]*m];let g=this._leftPerp(u),_=[];if(_.push([y[0]-g[0]*d,y[1]-g[1]*d]),_.push([y[0]+g[0]*d,y[1]+g[1]*d]),i.push(_),n>=4){const $=r[3];let E=this._dotProduct(u,this._sub($,o));E<.1*c?E=.1*c:E>.9*c&&(E=.9*c);const C=[o[0]+u[0]*E,o[1]+u[1]*E],P=this._crossProduct(u,this._sub($,o)),k=[];k.push([C[0]-g[0]*P,C[1]-g[1]*P]),k.push([C[0]+g[0]*P,C[1]+g[1]*P]),i.push(k)}const v=[a[0]+g[0]*d,a[1]+g[1]*d];g=this._sub(a,v);const b=Math.cos(Math.PI/18);let S=Math.sin(Math.PI/18);d<0&&(S=-S),_=[o,a];for(let $=1;$<=9;$++)this._rotateDirect(g,b,S),_.push(this._add(v,g));i.push(_);break}case Se.ClosedHalfCircle:{const a=this._cp2(r,2,0),l=this._mid(o,a),u=this._sub(a,l),c=Math.cos(Math.PI/18),d=Math.sin(Math.PI/18),m=[o,a];for(let y=1;y<=18;y++)this._rotateDirect(u,c,d),m.push(this._add(l,u));i.push(m);break}case Se.TripleParallelExtended:{const a=this._cp2(r,0,-2),l=this._cp3(r,a,1,-2),u=this._mid(o,a),c=this._sub(l,a);this._normalize(c);const d=Math.abs(this._crossProduct(c,this._sub(u,a)))/2,m=this._dist(a,l),y=[a,o];y.push([o[0]+c[0]*m*.5,o[1]+c[1]*m*.5]),i.push(y);const g=[];g.push([u[0]-c[0]*d,u[1]-c[1]*d]),g.push([u[0]+c[0]*m*.375,u[1]+c[1]*m*.375]),im(g[g.length-1],1),g.push([u[0]+c[0]*m*.75,u[1]+c[1]*m*.75]),i.push(g);const _=[a,l];i.push(_);break}case Se.ParallelWithTicks:{const a=this._cp2(r,3,0),l=this._cp3(r,a,.5,-1),u=this._sub(l,a);this._normalize(u);const c=this._crossProduct(u,this._sub(l,o));this._leftPerpendicular(u),this._addAngledTicks(i,o,a,l),this._addAngledTicks(i,this._mix(o,1,u,c),this._mix(a,1,u,c),this._mid(o,a));break}case Se.Parallel:{const a=this._cp2(r,3,0),l=this._cp3(r,a,.5,-1),u=this._sub(a,o);this._normalize(u);const c=this._leftPerp(u),d=this._crossProduct(u,this._sub(l,o));let m=[o,a];i.push(m),m=[],m.push([o[0]+c[0]*d,o[1]+c[1]*d]),m.push([a[0]+c[0]*d,a[1]+c[1]*d]),i.push(m);break}case Se.PerpendicularToFirstSegment:{const a=this._cp2(r,3,0),l=this._cp3(r,a,.5,-1),u=this._mid(o,a),c=this._sub(a,o);this._normalize(c);const d=this._crossProduct(c,this._sub(l,o));this._leftPerpendicular(c);const m=[];m.push([u[0]-c[0]*d*.25,u[1]-c[1]*d*.25]),m.push([u[0]+c[0]*d*1.25,u[1]+c[1]*d*1.25]),i.push(m);break}case Se.ParallelOffset:{const a=this._cp2(r,3,0),l=this._cp3(r,a,.5,-1),u=this._sub(a,o);this._normalize(u);const c=this._crossProduct(u,this._sub(l,o));this._leftPerpendicular(u);const d=[];d.push([o[0]-u[0]*c,o[1]-u[1]*c]),d.push([a[0]-u[0]*c,a[1]-u[1]*c]),i.push(d);const m=[];m.push([o[0]+u[0]*c,o[1]+u[1]*c]),m.push([a[0]+u[0]*c,a[1]+u[1]*c]),i.push(m);break}case Se.OffsetOpposite:{const a=this._cp2(r,3,0),l=this._cp3(r,a,.5,-1),u=this._sub(a,o);this._normalize(u);const c=this._crossProduct(u,this._sub(l,o));this._leftPerpendicular(u);const d=[];d.push([o[0]-u[0]*c,o[1]-u[1]*c]),d.push([a[0]-u[0]*c,a[1]-u[1]*c]),i.push(d);break}case Se.OffsetSame:{const a=this._cp2(r,3,0),l=this._cp3(r,a,.5,-1),u=this._sub(a,o);this._normalize(u);const c=this._crossProduct(u,this._sub(l,o));this._leftPerpendicular(u);const d=[];d.push([o[0]+u[0]*c,o[1]+u[1]*c]),d.push([a[0]+u[0]*c,a[1]+u[1]*c]),i.push(d);break}case Se.CircleWithArc:{let a=this._cp2(r,3,0);const l=this._cp3(r,a,.5,-1);let u,c;if(n>=4)u=r[3],c=this._crossProduct(this._sub(u,a),this._sub(l,a))>0;else{u=a,c=this._crossProduct(this._sub(u,o),this._sub(l,o))>0;const _=24*this._geomUnitsPerPoint,v=this._sub(u,o);this._normalize(v,_);const b=Math.sqrt(2)/2;this._rotateDirect(v,b,c?b:-b),a=this._add(o,v)}const d=this._sub(a,o),m=Math.cos(Math.PI/18),y=Math.sin(Math.PI/18),g=[a];for(let _=1;_<=36;_++)this._rotateDirect(d,m,y),g.push(this._add(o,d));this._add90DegArc(g,a,u,l,c),im(g[g.length-8],1),i.push(g);break}case Se.DoubleJog:{let a,l=this._cp2(r,-3,1),u=this._cp3(r,l,-1,-.5);if(n>=4)a=r[3];else{const S=o;o=l,a=u;const $=this._dist(o,S),E=this._dist(a,S);let C=30*this._geomUnitsPerPoint;.5*$<C&&(C=.5*$),.5*E<C&&(C=.5*E),l=this._mix(o,C/$,S,($-C)/$),u=this._mix(a,C/E,S,(E-C)/E)}const c=this._mid(o,l),d=this._mid(a,u),m=this._dist(o,l),y=this._dist(u,a);let g=Math.min(m,y)/8;g=Math.min(g,24*this._geomUnitsPerPoint);const _=Math.cos(Math.PI/4);let v=this._sub(o,l);this._normalize(v,g),this._crossProduct(v,this._sub(a,l))>0?this._rotateDirect(v,_,-_):this._rotateDirect(v,_,_);let b=[];b.push(l),b.push(this._add(c,v)),b.push(this._sub(c,v)),b.push(o),i.push(b),v=this._sub(a,u),this._normalize(v,g),this._crossProduct(v,this._sub(o,u))<0?this._rotateDirect(v,_,_):this._rotateDirect(v,_,-_),b=[],b.push(u),b.push(this._add(d,v)),b.push(this._sub(d,v)),b.push(a),i.push(b);break}case Se.PerpendicularOffset:{const a=this._cp2(r,-4,1),l=this._cp3(r,a,.882353,-1.94),u=this._sub(l,a);this._crossProduct(u,this._sub(o,a))>0?this._rightPerpendicular(u):this._leftPerpendicular(u);const c=[u[0]/8,u[1]/8],d=this._sub(this._mid(a,l),c);i.push([d,o]);break}case Se.LineExcludingLastSegment:{const a=this._arrowPath(r),l=[];let u=a.length-2;for(;u--;)l.push(a[u]);i.push(l);break}case Se.MultivertexArrow:{const a=this._arrowPath(r),l=[];this._addArrow(l,a,!1),i.push(l);break}case Se.CrossedArrow:{const a=this._arrowPath(r),l=[];this._addArrow(l,a,!0),i.push(l);break}case Se.ChevronArrow:{const[a,l]=this._arrowLastSeg(r),u=10*this._geomUnitsPerPoint,c=this._sub(o,a),d=this._norm(c);this._normalize(c);const m=this._crossProduct(c,this._sub(l,a));let y=this._dotProduct(c,this._sub(l,a));y<.05*d?y=.05*d:y>.95*d-u&&(y=.95*d-u);const g=[a[0]+c[0]*y,a[1]+c[1]*y],_=this._leftPerp(c),v=[];v.push([g[0]+_[0]*m+c[0]*u,g[1]+_[1]*m+c[1]*u]),v.push(o),v.push([g[0]-_[0]*m+c[0]*u,g[1]-_[1]*m+c[1]*u]),i.push(v);break}case Se.ChevronArrowOffset:{const[a,l]=this._arrowLastSeg(r),u=this._sub(o,a),c=this._norm(u);this._normalize(u);const d=this._crossProduct(u,this._sub(l,a));let m=this._dotProduct(u,this._sub(l,a));m<.05*c?m=.05*c:m>.95*c&&(m=.95*c);const y=[a[0]+u[0]*m,a[1]+u[1]*m];this._leftPerpendicular(u);const g=[];g.push([y[0]+u[0]*d*.5,y[1]+u[1]*d*.5]),g.push(this._mid(y,o)),g.push([y[0]-u[0]*d*.5,y[1]-u[1]*d*.5]),i.push(g);break}case Se.PartialFirstSegment:{const[a,l]=this._arrowLastSeg(r),u=this._sub(o,a),c=this._norm(u);this._normalize(u);let d=this._dotProduct(u,this._sub(l,a));d<.05*c?d=.05*c:d>.95*c&&(d=.95*c);const m=[a[0]+u[0]*d,a[1]+u[1]*d];i.push([a,m]);break}case Se.Arch:{const a=this._cp2(r,0,-1),l=this._cp3(r,a,.5,1),u=this._sub(o,a),c=this._mix(l,1,u,.55),d=this._mix(l,1,u,-.55),m=[o];this._addBezier2(m,o,c,l,4),this._addBezier2(m,l,d,a,4),i.push(m);break}case Se.CurvedParallelTicks:{const a=this._cp2(r,-4,1),l=this._cp3(r,a,.882353,-1.94),u=this._sub(l,a);this._crossProduct(u,this._sub(o,a))>0?this._rightPerpendicular(u):this._leftPerpendicular(u);const c=[u[0]/8,u[1]/8],d=this._sub(this._mid(a,l),c),m=this._sub(this._mix(a,.75,l,.25),c),y=this._sub(this._mix(a,.25,l,.75),c),g=[a];this._addBezier2(g,a,m,d,3),this._addBezier2(g,d,y,l,3),i.push(g);for(let _=0;_<8;_++){const v=g[2*_+1],b=[this._clone(v)];b.push(this._add(v,[u[0]/4,u[1]/4])),i.push(b)}break}case Se.Arc90Degrees:{const a=this._cp2(r,0,-1),l=this._cp3(r,a,.5,1),u=[a];this._add90DegArc(u,a,o,l),i.push(u);break}case Se.TipWithPerpendicularAndTicks:{const[a,l]=this._arrowLastSeg(r),u=10*this._geomUnitsPerPoint,c=this._sub(o,a),d=this._norm(c);this._normalize(c);let m=this._crossProduct(c,this._sub(l,a)),y=this._dotProduct(c,this._sub(l,a));y<.05*d?y=.05*d:y>.95*d-u&&(y=.95*d-u);const g=this._leftPerp(c),_=[o[0]-c[0]*u,o[1]-c[1]*u],v=.5*Math.max(d-y-u,u);m=Math.abs(m);const b=[];b.push([_[0]+g[0]*(m+v)-c[0]*v,_[1]+g[1]*(m+v)-c[1]*v]),b.push([_[0]+g[0]*m,_[1]+g[1]*m]),b.push([_[0]-g[0]*m,_[1]-g[1]*m]),b.push([_[0]-g[0]*(m+v)-c[0]*v,_[1]-g[1]*(m+v)-c[1]*v]),i.push(b),i.push([_,o]);break}case Se.ConcentricCircles:{const a=this._cp2(r,1,0),l=this._cp3(r,a,2,0),u=Math.cos(Math.PI/18),c=Math.sin(Math.PI/18);let d=this._dist(a,o),m=[d,0],y=[];for(let g=0;g<=36;g++)y.push(this._add(o,m)),this._rotateDirect(m,u,c);if(i.push(y),n>=4){y=[];const g=r[3];d=this._dist(g,o),m=[d,0];for(let _=0;_<=36;_++)y.push(this._add(o,m)),_===0&&(y.push(this._add(o,m)),im(y[1],1)),this._rotateDirect(m,u,c);i.push(y)}y=[],d=this._dist(l,o),m=[d,0];for(let g=0;g<=36;g++)y.push(this._add(o,m)),this._rotateDirect(m,u,c);i.push(y);break}case Se.DoubleJogArrow:{o=this._arrowPath(r)[0];const[a,l]=this._arrowLastSeg(r),u=this._sub(o,a),c=this._norm(u);this._normalize(u);const d=Math.abs(this._crossProduct(u,this._sub(l,o)));let m=Math.abs(this._dotProduct(u,this._sub(l,o)));m<.05*c?m=.05*c:m>.95*c&&(m=.95*c);const y=Math.max(d,m),g=this._leftPerp(u);let _=[];const v=[o[0]-u[0]*m*.5+g[0]*d*.5,o[1]-u[1]*m*.5+g[1]*d*.5];_.push([v[0],v[1]]),v[0]+=u[0]*y*.5+g[0]*y*.4,v[1]+=u[1]*y*.5+g[1]*y*.4,_.push([v[0],v[1]]),v[0]-=g[0]*y*.25,v[1]-=g[1]*y*.25,_.push([v[0],v[1]]),v[0]+=u[0]*y*.5+g[0]*y*.4,v[1]+=u[1]*y*.5+g[1]*y*.4,_.push([v[0],v[1]]),i.push(_),_=[],v[0]=o[0]-u[0]*m*.5-g[0]*d*.5,v[1]=o[1]-u[1]*m*.5-g[1]*d*.5,_.push([v[0],v[1]]),v[0]+=u[0]*y*.5-g[0]*y*.4,v[1]+=u[1]*y*.5-g[1]*y*.4,_.push([v[0],v[1]]),v[0]+=g[0]*y*.25,v[1]+=g[1]*y*.25,_.push([v[0],v[1]]),v[0]+=u[0]*y*.5-g[0]*y*.4,v[1]+=u[1]*y*.5-g[1]*y*.4,_.push([v[0],v[1]]),i.push(_);break}case Se.LinkedChevrons:{const a=this._cp2(r,-5,0),l=this._cp3(r,a,-.2,1),u=this._sub(o,a);this._normalize(u);const c=this._leftPerp(u),d=Math.abs(this._crossProduct(u,this._sub(l,a)));i.push([a,o]);const m=[];m.push([o[0]-u[0]*d+c[0]*d,o[1]-u[1]*d+c[1]*d]),m.push(o),m.push([o[0]-u[0]*d-c[0]*d,o[1]-u[1]*d-c[1]*d]),i.push(m),this._addDash(i,a,[-u[0]*d+c[0]*d,-u[1]*d+c[1]*d]),this._addDash(i,a,[-u[0]*d-c[0]*d,-u[1]*d-c[1]*d]);break}case Se.SegmentThenHalfCircle:{const a=this._cp2(r,2,0),l=this._cp3(r,a,1.5,0);let u;u=n>=4?r[3]:this._cp3(r,a,1.25,-.5);const c=this._sub(a,o);this._normalize(c);const d=.5*this._dist(a,l),m=this._crossProduct(c,this._sub(u,o))>0,y=Math.cos(Math.PI/18);let g=Math.sin(Math.PI/18);m&&(g=-g);const _=[o,a];c[0]*=d,c[1]*=d;const v=this._add(a,c);c[0]=-c[0],c[1]=-c[1];for(let b=1;b<=18;b++)this._rotateDirect(c,y,g),_.push(this._add(v,c));i.push(_);break}case Se.LineWithStraightTicks:{const a=this._cp2(r,-2,1),l=this._cp3(r,a,-1,-.5),u=this._sub(l,a);this._normalize(u);const c=this._dotProduct(u,this._sub(a,o)),d=this._dotProduct(u,this._sub(l,o));let m=[o];m.push([o[0]+u[0]*c,o[1]+u[1]*c]),m.push(a),i.push(m),m=[o],m.push([o[0]+u[0]*d,o[1]+u[1]*d]),m.push(l),i.push(m);break}case Se.DoubleCurve:{const a=this._cp2(r,-5,-1),l=this._cp3(r,a,2,0),u=Math.atan2(1,5),c=Math.cos(u),d=Math.sin(u),m=this._sub(a,o),y=this._dist(o,a);this._normalize(m),this._rotateDirect(m,c,-d);const g=[o];g.push([o[0]+m[0]*y*.5,o[1]+m[1]*y*.5]),im(g[1],1),g.push([o[0]+m[0]*y*.8,o[1]+m[1]*y*.8]),this._addBezier2(g,g[2],[o[0]+m[0]*y,o[1]+m[1]*y],a,3);const _=this._sub(l,a),v=this._dist(a,l);this._normalize(_),this._rotateDirect(_,c,-d),this._addBezier2(g,a,[l[0]-_[0]*v,l[1]-_[1]*v],[l[0]-_[0]*v*.8,l[1]-_[1]*v*.8],3),g.push(l),i.push(g);break}case Se.ParallelWithTicksByWidth:{const a=this._cp2(r,0,-1),l=this._cp3(r,a,.5,3),u=this._sub(a,o);this._normalize(u);const c=this._crossProduct(u,this._sub(l,o));this._leftPerpendicular(u),c>0?(this._addAngledTicks(i,o,[o[0]+u[0]*c,o[1]+u[1]*c],a),this._addAngledTicks(i,a,[a[0]+u[0]*c,a[1]+u[1]*c],o)):(this._addAngledTicks(i,[o[0]+u[0]*c,o[1]+u[1]*c],o,a),this._addAngledTicks(i,[a[0]+u[0]*c,a[1]+u[1]*c],o,a));break}case Se.EnclosingRoundedRectangle:{const a=this._cp2(r,3,-2),l=[Math.min(o[0],a[0]),Math.max(o[1],a[1])],u=[Math.max(o[0],a[0]),Math.min(o[1],a[1])],c=u[0]-l[0],d=l[1]-u[1],m=Math.min(c,d)/10,y=[];y.push([l[0]+m+.75*(c-2*m),l[1]]),y.push([u[0]-m,l[1]]),this._add90DegArc(y,[u[0]-m,l[1]],[u[0],l[1]-m],[u[0],l[1]]),y.push([u[0],u[1]+m]),this._add90DegArc(y,[u[0],u[1]+m],[u[0]-m,u[1]],u),y.push([l[0]+m,u[1]]),this._add90DegArc(y,[l[0]+m,u[1]],[l[0],u[1]+m],[l[0],u[1]]),y.push([l[0],l[1]-m]),this._add90DegArc(y,[l[0],l[1]-m],[l[0]+m,l[1]],l),y.push([l[0]+m+.75*(c-2*m),l[1]]);break}case Se.FullGeometry:default:i.push(r)}}return i}};var po;let Owe=(po=class{static local(){return po.instance===null&&(po.instance=new po),po.instance}execute(t,i,r,s,n){return new Nwe(t,i,r)}},po.instance=null,po),Nwe=class extends xf{constructor(t,i,r){super(t,!0,!0),this._curveHelper=new Qa,this._beginCut=(i.beginCut!==void 0?i.beginCut:1)*r,this._endCut=(i.endCut!==void 0?i.endCut:1)*r,this._middleCut=(i.middleCut!==void 0?i.middleCut:0)*r,this._invert=i.invert!==void 0&&i.invert,this._beginCut<0&&(this._beginCut=0),this._endCut<0&&(this._endCut=0),this._middleCut<0&&(this._middleCut=0)}processPath(t){const{_beginCut:i,_endCut:r,_middleCut:s}=this,n=t.pathLength(),o=Ze.createEmptyOptimizedCIM("esriGeometryPolyline");if(this._invert){if(i!==0||r!==0||s!==0)if(i+r+s>=n)for(o.startPath();t.nextPoint();)o.pushXY(t.x,t.y);else this._curveHelper.appendSubCurve(o,t,0,i),this._curveHelper.appendSubCurve(o,t,.5*(n-s),.5*(n+s)),this._curveHelper.appendSubCurve(o,t,n-r,r)}else if(i===0&&r===0&&s===0)for(o.startPath();t.nextPoint();)o.pushXY(t.x,t.y);else i+r+s<n&&(s===0?this._curveHelper.appendSubCurve(o,t,i,n-r):(this._curveHelper.appendSubCurve(o,t,i,.5*(n-s)),this._curveHelper.appendSubCurve(o,t,.5*(n+s),n-r)));return o.totalSize===0?null:o}};const nN=1e-7;let Nw=class{constructor(){this._values=[],this.extPtGap=0,this.ctrlPtGap=0,this._length=0,this._currentValue=0}isEmpty(){return this._values.length===0}size(){return this._values.length}init(t,i,r=!0){if(this._setEmpty(),!t||t.length===0)return!1;for(let s=0;s<t.length;s++){let n=Math.abs(t[s]);r&&n<nN&&(n=nN),this._values.push(n),this._length+=n}return i&&1&t.length&&(this._length*=2),this._length!==0&&(this.ctrlPtGap=this.extPtGap=0,this._currentValue=-1,!0)}scale(t){const i=this._values?this._values.length:0;for(let r=0;r<i;++r)this._values[r]*=t;this._length*=t,this.extPtGap*=t,this.ctrlPtGap*=t}addValue(t){this._length+=t,this._values.push(t)}firstValue(){return this._values[0]}lastValue(){return this._values[this._values.length-1]}nextValue(){return this._currentValue++,this._currentValue===this._values.length&&(this._currentValue=0),this._values[this._currentValue]}reset(){this._currentValue=-1}length(){return this._length}_setEmpty(){this.extPtGap=this.ctrlPtGap=this._length=0,this._currentValue=-1,this._values.length=0}},Ta=class{constructor(){this.pt=null,this.ca=0,this.sa=0}};var Yl;(function(e){e[e.FAIL=0]="FAIL",e[e.END=1]="END",e[e.CONTINUE=2]="CONTINUE"})(Yl||(Yl={}));let l_=class{constructor(){this.reset()}reset(){this.segment=null,this.segmentLength=0,this.abscissa=0,this.isPathEnd=!1,this.isPartEnd=!1}isValid(){return this.segment!==null}copyTo(t){t.segment=this.segment,t.segmentLength=this.segmentLength,t.abscissa=this.abscissa,t.isPathEnd=this.isPathEnd,t.isPartEnd=this.isPartEnd}},Dw=class extends Qa{constructor(t=0,i=!1){super(t,i),this._tempPos=new l_,this._tempPt=[0,0],this._tolerance=mg,this._currentPosition=new l_}updateTolerance(t){this._tolerance=mg*t}init(t,i,r=!0){return r?(this._patternLength=i.length(),this._partExtPtGap=i.extPtGap,this._partCtrlPtGap=i.ctrlPtGap):(this._patternLength=0,this._partExtPtGap=0,this._partCtrlPtGap=0),this._currentPosition.reset(),this._partSegCount=0,this._pathCursor=t,this._seg=-1,this._setPosAtNextPart()}curPositionIsValid(){return this._currentPosition.isValid()}nextPosition(t,i=Yl.FAIL){const r=new l_;return!!this._nextPosition(t,r,null,i)&&(r.copyTo(this._currentPosition),!0)}curPointAndAngle(t){t.pt=this._getPoint(this._currentPosition);const[i,r]=this._getAngleCS(this._tempPt,this._currentPosition);t.ca=i,t.sa=r}nextPointAndAngle(t,i,r=Yl.FAIL){const s=this._tempPos;if(!this._nextPosition(t,s,null,r))return!1;s.copyTo(this._currentPosition),i.pt=this._getPoint(s);const[n,o]=this._getAngleCS(this._tempPt,s);return i.ca=n,i.sa=o,!0}nextCurve(t){if(t===0)return null;const i=Ze.createEmptyOptimizedCIM("esriGeometryPolyline");i.startPath(),i.nextPath();const r=new l_;return this._nextPosition(t,r,i,Yl.END)?(r.copyTo(this._currentPosition),i):null}isPathEnd(){return this._currentPosition.isPathEnd}getPathEnd(){return this._currentPosition.segment[1]}getPt(t){return this._pathCursor.seekInPath(t),[this._pathCursor.x,this._pathCursor.y]}getSeg(t){return[this.getPt(t),this.getPt(t+1)]}_nextPosition(t,i,r,s){if(this._currentPosition.isPathEnd)return!1;let n=this._currentPosition.abscissa;for(this._currentPosition.segmentLength>0&&(n/=this._currentPosition.segmentLength),this._currentPosition.copyTo(i);i.abscissa+t*this._partLengthRatio>i.segmentLength+this._tolerance;){if(r){if(r.pathSize===0)if(n===0){const a=i.segment[0];r.pushXY(a[0],a[1])}else r.pushPoint(this.getSegCoord2D(i.segment,n));const o=i.segment[1];r.pushXY(o[0],o[1])}if(n=0,t-=(i.segmentLength-i.abscissa)/this._partLengthRatio,this._partSegCount)i.segment=this._nextSegment(),i.segmentLength=this.getSegLength(i.segment),i.abscissa=0,this._partSegCount--;else{if(!this._setPosAtNextPart())return s!==Yl.FAIL&&(i.segmentLength=this.getSegLength(i.segment),i.isPartEnd=!0,s===Yl.END?(i.abscissa=i.segmentLength,i.isPathEnd=!0):i.abscissa=i.segmentLength+t,!0);this._currentPosition.copyTo(i)}}if(i.abscissa+=t*this._partLengthRatio,r){r.pathSize===0&&(n===0?r.pushPoint(i.segment[0]):r.pushPoint(this.getSegCoord2D(i.segment,n)));const o=i.abscissa/i.segmentLength;o===1?r.pushPoint(i.segment[1]):r.pushPoint(this.getSegCoord2D(i.segment,o))}return this._partSegCount||Math.abs(i.abscissa-i.segmentLength)<this._tolerance&&(i.isPathEnd=this._partIsLast,i.isPartEnd=!0),!0}_getPoint(t){const i=t.segmentLength<=0?0:t.abscissa/t.segmentLength;return this.getSegCoord2D(this._currentPosition.segment,i)}_getAngleCS(t,i){const r=i.segmentLength<=0?0:i.abscissa/i.segmentLength;return this.getSegAngleCS(t,this._currentPosition.segment,r)}_setPosAtNextPart(){for(;this._partSegCount;)this._hasNextSegment()&&this._nextSegment(),this._partSegCount--;if(!this._hasNextSegment())return!1;for(this._partLength=0,this._partIsLast=!0,this._partSegCount=0;this._hasNextSegment();)if(this._partLength+=this.getSegLength(this._nextSegment()),this._partSegCount++,this._pathCursor.getControlPointAt(this._getEndPointIndex())){this._partIsLast=!this._hasNextSegment();break}let t=this._partSegCount;for(;t;)this._previousSegment(),--t;this._currentPosition.segment=this._nextSegment(),this._currentPosition.segmentLength=this.getSegLength(this._currentPosition.segment),this._currentPosition.abscissa=0,this._currentPosition.isPathEnd=this._currentPosition.isPartEnd=!1,--this._partSegCount;const i=this._getStartPointIndex();this._ctrlPtBegin=this._pathCursor.getControlPointAt(i);let r=i+this._partSegCount+1;if(r>=this._pathCursor.pathSize&&(r=0),this._ctrlPtEnd=this._pathCursor.getControlPointAt(r),this._patternLength>0){const s=this._ctrlPtBegin?this._partCtrlPtGap:this._partExtPtGap,n=this._ctrlPtEnd?this._partCtrlPtGap:this._partExtPtGap;let o=Math.round((this._partLength-(s+n))/this._patternLength);o<=0&&(o=s+n>0?0:1),this._partLengthRatio=this._partLength/(s+n+o*this._patternLength),this._partLengthRatio<.01&&(this._partLengthRatio=1)}else this._partLengthRatio=1;return!0}_hasNextSegment(){return this._seg<this._pathCursor.pathSize-2}_previousSegment(){return this.getSeg(--this._seg)}_nextSegment(){return this.getSeg(++this._seg)}_getStartPointIndex(){return this._seg}_getEndPointIndex(){return this._seg+1}};var fo;let Dwe=(fo=class{static local(){return fo.instance===null&&(fo.instance=new fo),fo.instance}execute(t,i,r,s,n){return new Fwe(t,i,r)}},fo.instance=null,fo),Fwe=class extends xf{constructor(t,i,r){super(t,!0,!0),this._firstCurve=null,this._walker=new Dw,this._walker.updateTolerance(r),this._endings=i.lineDashEnding,this._customDashPos=-(i.offsetAlongLine??0)*r,this._offsetAtEnd=(i.customEndingOffset??0)*r;let s=G7(i).dashTemplate;s==null&&(s=[]),s.length%2&&(s=[...s,...s]),this._pattern=new Nw,this._pattern.init(s,!0),this._pattern.scale(r)}processPath(t){if(this._pattern.length()===0){this.iteratePath=!1;const s=nu(t);return Ze.fromJSONCIM({paths:[s]})}if(!this.iteratePath){let s=!0;switch(this._endings){case Di.HalfPattern:case Di.HalfGap:default:this._pattern.extPtGap=0;break;case Di.FullPattern:this.isClosed||(this._pattern.extPtGap=.5*this._pattern.firstValue());break;case Di.FullGap:this.isClosed||(this._pattern.extPtGap=.5*this._pattern.lastValue());break;case Di.NoConstraint:this.isClosed||(s=!1);break;case Di.Custom:this.isClosed||(this._pattern.extPtGap=.5*this._offsetAtEnd)}const n=t.pathLength();if(this._pattern.isEmpty()||n<.1*this._pattern.length()){const o=nu(t);return Ze.fromJSONCIM({paths:[o]})}if(!this._walker.init(t,this._pattern,s)){const o=nu(t);return Ze.fromJSONCIM({paths:[o]})}}let i;if(this.iteratePath)i=this._pattern.nextValue();else{let s;switch(this._endings){case Di.HalfPattern:default:s=.5*this._pattern.firstValue();break;case Di.HalfGap:s=.5*-this._pattern.lastValue();break;case Di.FullGap:s=-this._pattern.lastValue();break;case Di.FullPattern:s=0;break;case Di.NoConstraint:case Di.Custom:s=-this._customDashPos}let n=s/this._pattern.length();n-=Math.floor(n),s=n*this._pattern.length(),this._pattern.reset(),i=this._pattern.nextValue();let o=!1;for(;s>=i;)s-=i,i=this._pattern.nextValue(),o=!o;i-=s,o?(this._walker.nextPosition(i),i=this._pattern.nextValue()):this.isClosed&&(this._firstCurve=this._walker.nextCurve(i),i=this._pattern.nextValue(),this._walker.nextPosition(i),i=this._pattern.nextValue())}let r=this._walker.nextCurve(i);if(r)if(this._walker.isPathEnd()){if(this.iteratePath=!1,this._firstCurve){for(this._firstCurve.nextPath();this._firstCurve.nextPoint();)r.pushXY(this._firstCurve.x,this._firstCurve.y);this._firstCurve=null}}else i=this._pattern.nextValue(),!this._walker.nextPosition(i)||this._walker.isPathEnd()?(this.iteratePath=!1,this._firstCurve&&(r.pushCursor(this._firstCurve),this._firstCurve=null)):this.iteratePath=!0;else this.iteratePath=!1,r=this._firstCurve,this._firstCurve=null;return r?.reset(),r}};var mo;let zwe=(mo=class{static local(){return mo.instance===null&&(mo.instance=new mo),mo.instance}execute(t,i,r,s,n,o,a){return new Vwe(t,i,r,s,n,o,a)}},mo.instance=null,mo),Vwe=class{constructor(t,i,r,s,n,o,a){switch(this._preventClipping=a,this._inputGeometries=t,this._tileKey=s,this._geometryEngine=n,this._maxInflateSize=o*r,this._width=(i.width!==void 0?i.width:2)*r,i.method){case $c.Mitered:case $c.Bevelled:case $c.Rounded:case $c.TrueBuffer:case $c.Square:}this._option=i.option}next(){let t;for(;t=this._inputGeometries.next();){if(t.geometryType==="esriGeometryEnvelope"&&this._width>0){const i=t.asJSON();return Math.min(i.xmax-i.xmin,i.ymax-i.ymin)-2*this._width<0?t:Ze.fromJSONCIM({paths:[[[i.xmin+this._width,i.ymin+this._width],[i.xmax-this._width,i.ymin+this._width],[i.xmax-this._width,i.ymax-this._width],[i.xmin+this._width,i.ymax-this._width],[i.xmin+this._width,i.ymin+this._width]],[[i.xmin,i.ymin],[i.xmin,i.ymax],[i.xmax,i.ymax],[i.xmax,i.ymin],[i.xmin,i.ymin]]]})}if(t.geometryType==="esriGeometryPolygon"){if(this._width===0)return t.clone();const i=this._geometryEngine;if(i==null)return null;const r=!this._preventClipping&&this._tileKey?JP(t,this._maxInflateSize,!0):t.clone();if(!r)continue;const s=i.buffer(ae.WebMercator,r.asJSON(),-this._width,1);if(s){for(const n of s.rings)if(n){r.startPath();for(const o of n.reverse())r.pushXY(o[0],r.yFactor*o[1])}}return r}}return null}};var yo;let Uwe=(yo=class{static local(){return yo.instance===null&&(yo.instance=new yo),yo.instance}execute(t,i,r,s,n){return new jwe(t,i,r,n)}},yo.instance=null,yo),jwe=class{constructor(t,i,r,s){this._inputGeometries=t,this._medhod=i.method,this._geometryEngine=s}next(){let t=this._inputGeometries.next();const i=this._medhod;for(;t!=null;){if(t.totalSize>0)switch(i){case cb.RectangularBox:return Gwe(t);case cb.ConvexHull:return this._constructConvexHull(t);default:return Bwe(t)}t=this._inputGeometries.next()}return null}_constructConvexHull(t){switch(t.geometryType){case"esriGeometryPolyline":case"esriGeometryPolygon":{const i=this._geometryEngine;if(i==null)return null;const r=i.convexHull(ae.WebMercator,t.asJSON());return r?Ze.fromJSONCIM(r):null}case"esriGeometryEnvelope":return t;default:return null}}};function Gwe(e){const t=jg(e),i={xmin:t[0],ymin:t[1],xmax:t[2],ymax:t[3]};return Ze.fromJSONCIM(i)}function Bwe(e){switch(e.geometryType){case"esriGeometryPolyline":{const t=[];for(;e.nextPath();)qwe(e,t);return Ze.fromJSONCIM({rings:t})}case"esriGeometryPolygon":case"esriGeometryEnvelope":return e;default:return null}}function qwe(e,t){if(e.seekPathStart(),!e.nextPoint())return;const i=e.x,r=e.y,s=[[i,r]];for(t.push(s);e.nextPoint();)s.push([e.x,e.y]);s.push([i,r])}var go;let Hwe=(go=class{static local(){return go.instance===null&&(go.instance=new go),go.instance}execute(t,i,r,s,n){return new Wwe(t,i,r)}},go.instance=null,go),Wwe=class extends xf{constructor(t,i,r){super(t,!1,!0),this._curveHelper=new Qa,this._length=(i.length!==void 0?i.length:20)*r,this._angle=i.angle!==void 0?i.angle:225,this._position=i.position!==void 0?i.position:50,this._length<0&&(this._length=-this._length),this._position<20&&(this._position=20),this._position>80&&(this._position=80),this._mirror=!1}processPath(t){const i=Ze.createEmptyOptimizedCIM("esriGeometryPolyline");if(this._curveHelper.isEmpty(t))return null;t.seekInPath(0);const r=t.x,s=t.y;t.seekInPath(t.pathSize-1);const n=t.x,o=t.y,a=[n-r,o-s];this._curveHelper.normalize(a);const l=r+(n-r)*this._position/100,u=s+(o-s)*this._position/100,c=Math.cos((90-this._angle)/180*Math.PI);let d=Math.sin((90-this._angle)/180*Math.PI);this._mirror&&(d=-d),this._mirror=!this._mirror;const m=[l-this._length/2*c,u-this._length/2*d],y=[l+this._length/2*c,u+this._length/2*d];return i.pushPath([[r,s],m,y,[n,o]]),i}};var _o;let Zwe=(_o=class{static local(){return _o.instance===null&&(_o.instance=new _o),_o.instance}execute(t,i,r,s,n){return new Ywe(t,i,r)}},_o.instance=null,_o),Ywe=class{constructor(t,i,r){this._inputGeometries=t,this._offsetX=i.offsetX!==void 0?i.offsetX*r:0,this._offsetY=i.offsetY!==void 0?i.offsetY*r:0}next(){let t=this._inputGeometries.next();for(;t;){if(t.totalSize>0)return this._move(t.clone(),this._offsetX,this._offsetY);t=this._inputGeometries.next()}return null}_move(t,i,r){for(;t.nextPath();)for(;t.nextPoint();)t.x=t.x+i,t.y=t.y+r;return t.reset(),t}};const Jwe=10;var vo;let Xwe=(vo=class{static local(){return vo.instance===null&&(vo.instance=new vo),vo.instance}execute(t,i,r,s,n,o,a){return new Kwe(t,i,r,s,n,o,a)}},vo.instance=null,vo),Kwe=class{constructor(t,i,r,s,n,o,a){this._preventClipping=a,this._inputGeometries=t,this._tileKey=s,this._geometryEngine=n,this._curveHelper=new Qa,this._offset=(i.offset??1)*r,this._method=i.method,this._maxInflateSize=Math.max(Math.abs(o*r),Jwe),this._option=i.option,this._offsetFlattenError=mg*r}next(){let t;for(;t=this._inputGeometries.next();){if(this._offset===0)return t.clone();if(t.geometryType==="esriGeometryEnvelope"){if(this._method===Na.Rounded&&this._offset>0){const o=nu(t),a=this._curveHelper.offset(o,-this._offset,this._method,4,this._offsetFlattenError);if(a){const l=Ze.createEmptyOptimizedCIM(t.geometryType);return l.pushPath(a),l}return null}const n=t.asJSON();if(wr(n)&&Math.min(n.xmax-n.xmin,n.ymax-n.ymin)+2*this._offset>0)return Ze.fromJSONCIM({xmin:n.xmin-this._offset,xmax:n.xmax+this._offset,ymin:n.ymin-this._offset,ymax:n.ymax+this._offset})}const i=this._geometryEngine;if(i==null)continue;const r=!this._preventClipping&&this._tileKey?JP(t,this._maxInflateSize,!0):t.clone();if(!r)continue;const s=i.offset(ae.WebMercator,r.asJSON(),-this._offset,1,this._method,4,this._offsetFlattenError);return s?Ze.fromJSONCIM(s):null}return null}};var bo;let Qwe=(bo=class{static local(){return bo.instance===null&&(bo.instance=new bo),bo.instance}execute(t,i,r,s,n){return new e2e(t,i,r)}},bo.instance=null,bo),e2e=class{constructor(t,i,r){this._inputGeometries=t,this._length=(i.length!==void 0?i.length:ti.CIMGeometricEffectRadial.length)*r,this._angle=i.angle!==void 0?i.angle*Math.PI/180:ti.CIMGeometricEffectRadial.angle,this._lx=Math.cos(this._angle)*this._length,this._ly=Math.sin(this._angle)*this._length}next(){let t=this._inputGeometries.next();for(;t;){if(t.geometryType==="esriGeometryPoint"||t.geometryType==="esriGeometryMultipoint"){const i=Ze.createEmptyOptimizedCIM("esriGeometryPolyline");return t.nextPath()&&t.nextPoint()&&i.pushPath([[t.x,t.y],[t.x+this._lx,t.y+this._ly]]),i}if(t.geometryType==="esriGeometryPolygon"){const i=R6(t);if(!i)return null;const r=Ze.createEmptyOptimizedCIM("esriGeometryPolyline");return r.pushPath([[i[0],i[1]],[i[0]+this._lx,i[1]+this._ly]]),r}t=this._inputGeometries.next()}return null}};var wo;let t2e=(wo=class{static local(){return wo.instance===null&&(wo.instance=new wo),wo.instance}execute(t,i,r,s,n){return new i2e(t,i,r)}},wo.instance=null,wo),i2e=class{constructor(t,i,r){this._inputGeometries=t,this._reverse=i.reverse===void 0||i.reverse}next(){let t=this._inputGeometries.next();for(;t;){if(!this._reverse)return t;if(t.geometryType==="esriGeometryPolyline")return r2e(t.clone());t=this._inputGeometries.next()}return null}};function r2e(e){for(;e.nextPath();)for(let t=0;t<e.pathSize/2;t++){e.seekInPath(t);const i=e.x,r=e.y;e.seekInPath(e.pathSize-t-1);const s=e.x,n=e.y;e.x=i,e.y=r,e.seekInPath(t),e.x=s,e.y=n}return e.reset(),e}var So;let s2e=(So=class{static local(){return So.instance===null&&(So.instance=new So),So.instance}execute(t,i,r,s,n){return new n2e(t,i,r)}},So.instance=null,So),n2e=class{constructor(t,i,r){this._inputGeometries=t,this._rotateAngle=i.angle!==void 0?i.angle*Math.PI/180:0}next(){let t=this._inputGeometries.next();for(;t;){if(this._rotateAngle===0||t.geometryType==="esriGeometryPoint")return t;if(t.totalSize>0){const i=jg(t),r=(i[2]+i[0])/2,s=(i[3]+i[1])/2;return t.reset(),this._rotate(t.clone(),r,s)}t=this._inputGeometries.next()}return null}_rotate(t,i,r){const s=Math.cos(this._rotateAngle),n=Math.sin(this._rotateAngle);for(;t.nextPath();)for(;t.nextPoint();){const o=t.x-i,a=t.y-r;t.x=i+o*s-a*n,t.y=r+o*n+a*s}return t.reset(),t}};var xo;let o2e=(xo=class{static local(){return xo.instance===null&&(xo.instance=new xo),xo.instance}execute(t,i,r,s,n){return new a2e(t,i,r)}},xo.instance=null,xo),a2e=class{constructor(t,i,r){this._inputGeometries=t,this._xFactor=i.xScaleFactor!==void 0?i.xScaleFactor:1.15,this._yFactor=i.yScaleFactor!==void 0?i.yScaleFactor:1.15}next(){const t=this._inputGeometries.next();if(t){if(this._xFactor===1&&this._yFactor===1||t.geometryType==="esriGeometryPoint")return t;if(t.totalSize>0){const i=jg(t),r=(i[2]+i[0])/2,s=(i[3]+i[1])/2;return t.reset(),this._scaleCursor(t.clone(),r,s)}}return null}_scaleCursor(t,i,r){for(;t.nextPath();)for(;t.nextPoint();)t.x=i+(t.x-i)*this._xFactor,t.y=r+(t.y-r)*this._yFactor;return t.reset(),t}},XT=class{constructor(){this._polyline=[]}beginPath(t){this._polyline.push([t])}lineTo(t){if(this._polyline.length===0)throw new Error("No path started. Call beginPath first.");this._polyline[this._polyline.length-1].push(t)}getPointCount(){return this._polyline.reduce(((t,i)=>t+i.length),0)}addSegment(t,i,r){r&&this.beginPath(t),this.lineTo(i)}getXY(t){let i=0;for(const r of this._polyline){if(t<i+r.length)return r[t-i];i+=r.length}return null}getGeometry(){return this._polyline}};var $o;let l2e=($o=class{static local(){return $o.instance===null&&($o.instance=new $o),$o.instance}execute(t,i,r,s,n){return new u2e(t,i,r)}},$o.instance=null,$o),u2e=class extends xf{constructor(t,i,r){super(t,!1,!0),this._suppress=i.suppress!==void 0&&i.suppress,this._invert=i.invert!==void 0&&i.invert}processPath(t){if(t.totalSize<=0)return null;if(!this._suppress){const y=Ze.createEmptyOptimizedCIM("esriGeometryPolygon",!1,!1,t.yFactor);for(t.seekPathEnd();t.nextPoint();)y.pushXY(t.x,t.y);return y}const i=[],r=new Array(t.pathSize);let s=0;for(t.seekPathStart();t.nextPoint();)r[s++]=t.getControlPoint(),i.push([t.x,t.y]);let n=!0,o=!0,a=!1,l=!this._invert;s=0;const u=new XT;let c=i[0];for(;s<i.length;){const y=i[s+1],g=r[s],_=r[s+1];s++,o&&(l=g||_?this._invert:!this._invert,o=!1),l?(u.addSegment(c,y,n),n=!1):a=!0,c=y,_&&(l?(l=!1,n=!0):l=!0)}const d=u.getGeometry();if(d.length===0)return null;if(!a&&i[0][0]===i[i.length-1][0]&&i[0][1]===i[i.length-1][1]){const y=d[d.length-1];return y[0][0]===y[y.length-1][0]&&y[0][1]===y[y.length-1][1]||y.push([y[0][0],y[0][1]]),Ze.fromJSONCIM({paths:d})}const m=d[d.length-1];return u.getPointCount()>1&&t.geometryType==="esriGeometryPolygon"&&m[0][0]===m[m.length-1][0]&&m[0][1]===m[m.length-1][1]&&d.length>1&&(d[d.length-1].push(...d[0]),d.splice(0,1)),Ze.fromJSONCIM({paths:d})}};function oN(e,t,i){return e[0]=t[0]-i[0],e[1]=t[1]-i[1],e}function pG(e,t){return Math.sqrt(e*e+t*t)}function aN(e){const t=pG(e[0],e[1]);e[0]/=t,e[1]/=t}function c2e(e,t){return pG(e[0]-t[0],e[1]-t[1])}function h2e(e,t){return e[t+1]}function fG(e){return e.length-1}function d2e(e){let t=0;for(let i=0;i<fG(e);i++)t+=p2e(e,i);return t}function p2e(e,t,i=1){let[r,s]=h2e(e,t);return[r,s]=[Math.round(r),Math.round(s)],Math.sqrt(r*r+s*s)*i}let KT=class QT{constructor(t,i,r,s,n){this._segments=t,this._index=i,this._distance=r,this._xStart=s,this._yStart=n,this._done=!1}static create(t){return new QT(t,0,0,t[0][0],t[0][1])}clone(){return new QT(this._segments,this._index,this._distance,this.xStart,this.yStart)}equals(t){return this._index===t._index||t._index===this._index-1&&(this._distance===0||t._distance===1)||t._index===this._index+1&&(this._distance===1||t._distance===0)}leq(t){return this._index<t._index||this._index===t._index&&this._distance<=t._distance}geq(t){return this._index>t._index||this._index===t._index&&this._distance>=t._distance}get _segment(){return this._segments[this._index+1]}get angle(){const t=this.dy,i=(0*t+-1*-this.dx)/(1*this.length);let r=Math.acos(i);return t>0&&(r=2*Math.PI-r),r}get xStart(){return this._xStart}get yStart(){return this._yStart}get x(){return this.xStart+this.distance*this.dx}get y(){return this.yStart+this.distance*this.dy}get dx(){return this._segment[0]}get dy(){return this._segment[1]}get xMidpoint(){return this.xStart+.5*this.dx}get yMidpoint(){return this.yStart+.5*this.dy}get xEnd(){return this.xStart+this.dx}get yEnd(){return this.yStart+this.dy}get length(){const{dx:t,dy:i}=this;return Math.sqrt(t*t+i*i)}get remainingLength(){return this.length*(1-this._distance)}get backwardLength(){return this.length*this._distance}get distance(){return this._distance}get done(){return this._done}hasPrev(){return this._index-1>=0}hasNext(){return this._index+1<fG(this._segments)}next(){return this.hasNext()?(this._xStart+=this.dx,this._yStart+=this.dy,this._distance=0,this._index+=1,this):null}prev(){return this.hasPrev()?(this._index-=1,this._xStart-=this.dx,this._yStart-=this.dy,this._distance=1,this):(this._done=!0,null)}_seekBackwards(t,i){const r=this.backwardLength;if(t<=r)return this._distance=(r-t)/this.length,this;let s=this.backwardLength;for(;this.prev();){if(s+this.length>t)return this._seekBackwards(t-s);s+=this.length}return this._distance=0,i?this:null}seek(t,i=!1){if(t<0)return this._seekBackwards(Math.abs(t),i);if(t<=this.remainingLength)return this._distance=(this.backwardLength+t)/this.length,this;let r=this.remainingLength;for(;this.next();){if(r+this.length>t)return this.seek(t-r,i);r+=this.length}return this._distance=1,i?this:null}};function SOe(e,t,i,r=!0){const s=d2e(e),n=KT.create(e),o=s/2;if(!r)return n.seek(o),void(n.x<Nd&&n.y<Nd&&n.x>=0&&n.y>=0&&i(n.clone(),0,o+0*t,s));const a=Math.max((s-t)/2,0),l=Math.floor(a/t),u=o-l*t;n.seek(u);for(let c=-l;c<=l;c++)n.x<Nd&&n.y<Nd&&n.x>=0&&n.y>=0&&i(n.clone(),c,o+c*t,s),n.seek(t)}function xOe(e,t){const i=t;for(let r=0;r<e.length;r++){let s=e[r];f2e(s,i);const n=[];n.push(s[0]);for(let o=1;o<s.length;o++){const[a,l]=s[o-1],[u,c]=s[o],d=u-a,m=c-l;n.push([d,m])}e[r]=n,s=n}return e}function f2e(e,t){if(t<=0)return;const r=e.length;if(r<3)return;const s=[];let n=0;s.push(0);for(let d=1;d<r;d++)n+=c2e(e[d],e[d-1]),s.push(n);t=Math.min(t,.2*n);const o=[];o.push(e[0][0]),o.push(e[0][1]);const a=e[r-1][0],l=e[r-1][1],u=oN([0,0],e[0],e[1]);aN(u),e[0][0]+=t*u[0],e[0][1]+=t*u[1],oN(u,e[r-1],e[r-2]),aN(u),e[r-1][0]+=t*u[0],e[r-1][1]+=t*u[1];for(let d=1;d<r;d++)s[d]+=t;s[r-1]+=t;const c=.5*t;for(let d=1;d<r-1;d++){let m=0,y=0,g=0;for(let _=d-1;_>=0&&!(s[_+1]<s[d]-c);_--){const v=c+s[_+1]-s[d],b=s[_+1]-s[_],S=s[d]-s[_]<c?1:v/b;if(Math.abs(S)<1e-6)break;const $=S*S,E=S*v-.5*$*b,C=S*b/t,P=e[_+1],k=e[_][0]-P[0],F=e[_][1]-P[1];m+=C/E*(P[0]*S*v+.5*$*(v*k-b*P[0])-$*S*b*k/3),y+=C/E*(P[1]*S*v+.5*$*(v*F-b*P[1])-$*S*b*F/3),g+=C}for(let _=d+1;_<r&&!(s[_-1]>s[d]+c);_++){const v=c-s[_-1]+s[d],b=s[_]-s[_-1],S=s[_]-s[d]<c?1:v/b;if(Math.abs(S)<1e-6)break;const $=S*S,E=S*v-.5*$*b,C=S*b/t,P=e[_-1],k=e[_][0]-P[0],F=e[_][1]-P[1];m+=C/E*(P[0]*S*v+.5*$*(v*k-b*P[0])-$*S*b*k/3),y+=C/E*(P[1]*S*v+.5*$*(v*F-b*P[1])-$*S*b*F/3),g+=C}o.push(m/g),o.push(y/g)}o.push(a),o.push(l);for(let d=0,m=0;d<r;d++)e[d][0]=o[m++],e[d][1]=o[m++]}const rm=()=>H.getLogger("esri.symbols.cim.effects.EffectTaperedPolygon");var Mo;let m2e=(Mo=class{static local(){return Mo.instance===null&&(Mo.instance=new Mo),Mo.instance}execute(t,i,r,s,n){return new y2e(t,i,r,s,n)}},Mo.instance=null,Mo),y2e=class extends xf{constructor(t,i,r,s,n){super(t,!1,!0),this._slopeS=0,this._slopeC=1,this._lastTangent1=new Le(NaN,NaN),this._lastWidth=0,this._tileKey=null,this._halfFromWidth=Math.abs(i.fromWidth!==void 0?i.fromWidth:0)*r*.5,this._halfToWidth=Math.abs(i.toWidth!==void 0?i.toWidth:1)*r*.5,this._originalLength=(i.length!==void 0?i.length:0)*r,this._length=0,this._tileKey=s,this._geometryEngine=n}processPath(t){if(t.totalSize<=0)return null;if(this._halfFromWidth<=0&&this._halfToWidth<=0){const g=Ze.createEmptyOptimizedCIM("esriGeometryPolygon",!1,!1,t.yFactor);for(t.seekPathEnd();t.prevPoint();)g.pushXY(t.x,t.y);for(t.seekPathStart();t.nextPoint();)g.pushXY(t.x,t.y);return g}const i=[];t.seekPathStart();let r=0,s=0;for(;t.nextPoint();)i.push([t.x-r,t.y-s]),r=t.x,s=t.y;let n=this._geometryEngine?.simplify(ae.WebMercator,{paths:[i]});n||this._tileKey!=null||(n={paths:[i]});const o=gi(n)?n.rings:Vi(n)?n.paths:null;if(!o)return rm().error(new j("mapview-bad-resource","Unable to process geometry")),null;const a=new XT,l=new XT;let u=0;for(const g of o){r=g[0][0],s=g[0][1];for(let _=1;_<g.length;_++){const v=r+g[_][0],b=s+g[_][1];u+=Math.sqrt((v-r)*(v-r)+(b-s)*(b-s)),r=v,s=b}}if(this._originalLength===0||this._originalLength>u){this._length=u;const g=(this._halfToWidth-this._halfFromWidth)/this._length;if(Math.abs(g)<1){const _=g*g;this._slopeC=Math.sqrt(1/(1+_)),this._slopeS=Math.sqrt(_/(1+_)),g<0&&(this._slopeS=-this._slopeS)}else this._slopeC=this._slopeS=.7071}else this._length=this._originalLength,this._slopeC=1,this._slopeS=0;let c=0;const d=[];for(const g of o){const _=KT.create(g),v=KT.create(g);this._setFromOffset(v,a,l);let b=v.next(),S=_;for(;b&&S;)c=this._setOffset(S,b,c,a,l),S=_.next(),b=v.next();S=_,S&&this._setToOffset(S,c,a,l);const $=a.getGeometry(),E=l.getGeometry(),C=[];for(const P of $)C.push(...P);for(let P=E.length-1;P>=0;P--){const k=E[P];for(let F=k.length-1;F>=0;F--)C.push(k[F])}d.push(C)}const m={rings:d};LQ(m);let y=this._geometryEngine?.simplify(ae.WebMercator,m);if(!y){if(this._tileKey!=null)return null;y=m}return Ze.fromJSONCIM(y)}_setFromOffset(t,i,r){const s=this._halfFromWidth,n=new Le(t.xEnd-t.xStart,t.yEnd-t.yStart);n.normalize(),n.scale(s),i.beginPath([t.xStart-n.y,t.yStart+n.x]),r.beginPath([t.xStart+n.y,t.yStart-n.x])}_setToOffset(t,i,r,s){let n;n=(i+=Math.sqrt((t.xEnd-t.xStart)*(t.xEnd-t.xStart)+(t.yEnd-t.yStart)*(t.yEnd-t.yStart)))>=this._length?this._halfToWidth:this._halfFromWidth+(this._halfToWidth-this._halfFromWidth)*i/this._length;const o=new Le(t.xEnd-t.xStart,t.yEnd-t.yStart);o.normalize(),o.scale(n),r.lineTo([t.xEnd-o.y,t.yEnd+o.x]),s.lineTo([t.xEnd+o.y,t.yEnd-o.x])}_setOffset(t,i,r,s,n){const o=Math.sqrt((t.xEnd-t.xStart)*(t.xEnd-t.xStart)+(t.yEnd-t.yStart)*(t.yEnd-t.yStart));let a;a=r+o>=this._length?this._halfToWidth:this._halfFromWidth+(this._halfToWidth-this._halfFromWidth)*(r+o)/this._length,r+=o;const l=new Le(t.xEnd,t.yEnd),u=new Le(t.xEnd-t.xStart,t.yEnd-t.yStart);u.normalize();const c=new Le(i.xEnd-i.xStart,i.yEnd-i.yStart);c.normalize();const d=u.x*c.y-u.y*c.x;let m;m=Math.abs(d)===0?new Le(c.x,c.y):new Le((c.x-u.x)/d,(c.y-u.y)/d);const y=s.getPointCount(),g=n.getPointCount();u.leftPerpendicular(),c.leftPerpendicular();const _=u.x*c.x+u.y*c.y;if(_>.99){const v=new Le((u.x+c.x)*a/2,(u.y+c.y)*a/2),b=v.clone();b.rotate(this._slopeC,this._slopeS),s.lineTo([l.x+b.x,l.y+b.y]);const S=v.clone();S.rotateReverse(this._slopeC,this._slopeS),n.lineTo([l.x-S.x,l.y-S.y])}else{if(d<0){const C=m.clone().scale(-a);C.rotateReverse(this._slopeC,this._slopeS);const P=n.getXY(g-1);P||rm().error(new j("mapview-bad-resource","Unable to process geometry, index out of scope"));const k=Le.add(l,C),F=Le.sub(k,Le.fromArray(P));if(u.x*F.y-u.y*F.x>0){const D=new Le(-u.x*a,-u.y*a);D.rotateReverse(this._slopeC,this._slopeS);const U=new Le(-c.x*a,-c.y*a);U.rotateReverse(this._slopeC,this._slopeS),n.lineTo([l.x+D.x,l.y+D.y]),n.lineTo([l.x,l.y]),n.lineTo([l.x+U.x,l.y+U.y])}else n.lineTo([l.x+C.x,l.y+C.y])}else{const C=m.clone().scale(a);C.rotate(this._slopeC,this._slopeS);const P=s.getXY(y-1);P||rm().error(new j("mapview-bad-resource","Unable to process geometry, index out of scope"));const k=Le.add(l,C),F=Le.sub(k,Le.fromArray(P));if(u.x*F.y-u.y*F.x>0){const D=u.clone().scale(a);D.rotate(this._slopeC,this._slopeS);const U=c.clone().scale(a);U.rotate(this._slopeC,this._slopeS),s.lineTo([l.x+D.x,l.y+D.y]),s.lineTo([l.x,l.y]),s.lineTo([l.x+U.x,l.y+U.y])}else s.lineTo([l.x+C.x,l.y+C.y])}const v=Math.acos(_);let b=1;if(a>.25){const C=2*Math.acos(1-.25/a);C<v&&(b=Math.round(v/C))}const S=Math.cos(v/b),$=Math.sin(v/b),E=u.clone();if(d<0){E.rotate(this._slopeC,this._slopeS);const C=s.getXY(y-1);C||rm().error(new j("mapview-bad-resource","Unable to process geometry, index out of scope"));const P=Le.add(l,E.clone().scale(this._lastWidth)),k=Le.sub(P,Le.fromArray(C)),F=u.x*k.y-u.y*k.x;if(!isNaN(this._lastTangent1.x)&&!isNaN(this._lastTangent1.y)&&F>0){const D=new Le(t.xStart,t.yStart),U=this._lastTangent1.clone().scale(this._lastWidth);U.rotate(this._slopeC,this._slopeS);const W=u.clone().scale(this._lastWidth);W.rotate(this._slopeC,this._slopeS),s.lineTo([D.x+U.x,D.y+U.y]),s.lineTo([D.x,D.y]),s.lineTo([D.x+W.x,D.y+W.y])}}else{E.scale(-1).rotateReverse(this._slopeC,this._slopeS);const C=n.getXY(g-1);C||rm().error(new j("mapview-bad-resource","Unable to process geometry, index out of scope"));const P=Le.add(l,E.clone().scale(this._lastWidth)),k=Le.sub(P,Le.fromArray(C)),F=u.x*k.y-u.y*k.x;if(!isNaN(this._lastTangent1.x)&&!isNaN(this._lastTangent1.y)&&F>0){const D=new Le(t.xStart,t.yStart),U=this._lastTangent1.clone().scale(-this._lastWidth);U.rotateReverse(this._slopeC,this._slopeS);const W=u.clone().scale(-this._lastWidth);W.rotateReverse(this._slopeC,this._slopeS),n.lineTo([D.x+U.x,D.y+U.y]),n.lineTo([D.x,D.y]),n.lineTo([D.x+W.x,D.y+W.y])}}E.scale(a);for(let C=0;C<=b;C++)d<0?(s.lineTo([l.x+E.x,l.y+E.y]),E.rotateReverse(S,$)):(n.lineTo([l.x+E.x,l.y+E.y]),E.rotate(S,$))}return this._lastTangent1.setCoords(u.x,u.y),this._lastWidth=a,r}};var To;let g2e=(To=class{static local(){return To.instance===null&&(To.instance=new To),To.instance}execute(t,i,r,s,n){return new _2e(t,i,r)}},To.instance=null,To),_2e=class{constructor(t,i,r){this._inputGeometries=t,this._height=(i.amplitude!==void 0?i.amplitude:2)*r,this._period=(i.period!==void 0?i.period:3)*r,this._style=i.waveform,this._height<=0&&(this._height=Math.abs(this._height)),this._period<=0&&(this._period=Math.abs(this._period)),this._pattern=new Nw,this._pattern.addValue(this._period),this._pattern.addValue(this._period),this._walker=new Dw,this._walker.updateTolerance(r)}next(){let t=this._inputGeometries.next();for(;t;){if(this._height===0||this._period===0)return t;const i=this._processGeom(t);if(i)return i;t=this._inputGeometries.next()}return null}_processGeom(t){const i=Ze.createEmptyOptimizedCIM(t.geometryType);for(;t.nextPath();){i.startPath();const r=t.pathLength();if(this._walker.init(t,this._pattern))switch(this._style){case jd.Sinus:default:this._constructCurve(i,r,!1);break;case jd.Square:this._constructSquare(i,r);break;case jd.Triangle:this._constructTriangle(i,r);break;case jd.Random:this._constructCurve(i,r,!0)}else for(;t.nextPoint();)i.pushXY(t.x,t.y)}return i}_constructCurve(t,i,r){let s=Math.round(i/this._period);s===0&&(s=1);const n=s*16+1,o=i/s,a=this._period/16,l=1/n,u=2*Math.PI*i/o,c=2*Math.PI*Math.random(),d=2*Math.PI*Math.random(),m=2*Math.PI*Math.random(),y=.75-Math.random()/2,g=.75-Math.random()/2,_=new Ta;this._walker.curPointAndAngle(_),t.pushPoint(_.pt);let v=0;for(;;){if(!this._walker.nextPointAndAngle(a,_)){t.pushPoint(this._walker.getPathEnd());break}{const b=v;let S;if(v+=l,r){const $=this._height/2*(1+.3*Math.sin(y*u*b+c));S=$*Math.sin(u*b+d),S+=$*Math.sin(g*u*b+m),S/=2}else S=.5*this._height*Math.sin(.5*u*b);t.pushXY(_.pt[0]-S*_.sa,_.pt[1]+S*_.ca)}}}_constructSquare(t,i){Math.round(i/this._period);let r=!0;for(;;){let s=!1;if(this._walker.curPositionIsValid()){const n=new Ta;this._walker.curPointAndAngle(n);const o=new Ta;if(this._walker.nextPointAndAngle(this._period,o)){const a=new Ta;this._walker.nextPointAndAngle(this._period,a)&&(r?(t.pushPoint(n.pt),r=!1):t.pushPoint(n.pt),t.pushXY(n.pt[0]-this._height/2*n.sa,n.pt[1]+this._height/2*n.ca),t.pushXY(o.pt[0]-this._height/2*o.sa,o.pt[1]+this._height/2*o.ca),t.pushXY(o.pt[0]+this._height/2*o.sa,o.pt[1]-this._height/2*o.ca),t.pushXY(a.pt[0]+this._height/2*a.sa,a.pt[1]-this._height/2*a.ca),s=!0)}}if(!s){t.pushPoint(this._walker.getPathEnd());break}}}_constructTriangle(t,i){Math.round(i/this._period);let r=!0;for(;;){let s=!1;if(this._walker.curPositionIsValid()){const n=new Ta;this._walker.curPointAndAngle(n);const o=new Ta;if(this._walker.nextPointAndAngle(this._period/2,o)){const a=new Ta;this._walker.nextPointAndAngle(this._period,a)&&(this._walker.nextPosition(this._period/2)&&(r?(t.pushPoint(n.pt),r=!1):t.pushPoint(n.pt),t.pushXY(o.pt[0]-this._height/2*o.sa,o.pt[1]+this._height/2*o.ca),t.pushXY(a.pt[0]+this._height/2*a.sa,a.pt[1]-this._height/2*a.ca)),s=!0)}}if(!s){t.pushPoint(this._walker.getPathEnd());break}}}};var Eo;let v2e=(Eo=class{static local(){return Eo.instance===null&&(Eo.instance=new Eo),Eo.instance}execute(t,i,r,s,n){return new b2e(t,i,r)}},Eo.instance=null,Eo),b2e=class extends o0{constructor(t,i,r){super(t),this._geometryWalker=new Dw,this._geometryWalker.updateTolerance(r),this._angleToLine=i.angleToLine??!0,this._offset=(i.offset?i.offset:0)*r,this._originalEndings=i.endings,this._offsetAtEnd=(i.customEndingOffset?i.customEndingOffset:0)*r,this._position=-(i.offsetAlongLine?i.offsetAlongLine:0)*r,this._pattern=new Nw,this._pattern.init(i.placementTemplate,!1),this._pattern.scale(r),this._endings=this._originalEndings}processPath(t){if(this._pattern.isEmpty())return null;let i;if(this.iteratePath)i=this._pattern.nextValue();else{this._originalEndings===mn.WithFullGap&&this.isClosed?this._endings=mn.WithMarkers:this._endings=this._originalEndings,this._pattern.extPtGap=0;let s,n=!0;switch(this._endings){case mn.NoConstraint:s=-this._position,s=this._adjustPosition(s),n=!1;break;case mn.WithHalfGap:default:s=-this._pattern.lastValue()/2;break;case mn.WithFullGap:s=-this._pattern.lastValue(),this._pattern.extPtGap=this._pattern.lastValue();break;case mn.WithMarkers:s=0;break;case mn.Custom:s=-this._position,s=this._adjustPosition(s),this._pattern.extPtGap=.5*this._offsetAtEnd}if(!this._geometryWalker.init(t,this._pattern,n))return null;this._pattern.reset();let o=0;for(;s>o;)s-=o,o=this._pattern.nextValue();o-=s,i=o,this.iteratePath=!0}const r=new Ta;return this._geometryWalker.nextPointAndAngle(i,r)?this._endings===mn.WithFullGap&&this._geometryWalker.isPathEnd()?(this.iteratePath=!1,null):this._endings===mn.WithMarkers&&this._geometryWalker.isPathEnd()&&(this.iteratePath=!1,this.isClosed)?null:(this.internalPlacement.setTranslate(r.pt[0]-this._offset*r.sa,r.pt[1]+this._offset*r.ca),this._angleToLine&&this.internalPlacement.setRotateCS(r.ca,r.sa),this.internalPlacement):(this.iteratePath=!1,null)}_adjustPosition(t){let i=t/this._pattern.length();return i-=Math.floor(i),i*this._pattern.length()}};var Co;let w2e=(Co=class{static local(){return Co.instance===null&&(Co.instance=new Co),Co.instance}execute(t,i,r,s,n){return new S2e(t,i,r)}},Co.instance=null,Co),S2e=class extends o0{constructor(t,i,r){super(t,!1,!0),this._curveHelper=new Qa,this._placePerPart=i.placePerPart??!1,this._angleToLine=i.angleToLine===void 0||i.angleToLine,this._offset=i.offset!==void 0?i.offset*r:0,this._type=i.extremityPlacement,this._position=i.offsetAlongLine!==void 0?i.offsetAlongLine*r:0,this._beginProcessed=!1}processMultiPath(t){return this._placePerPart?super.processMultiPath(t):this.processPath(t)}processPath(t){let i;switch(this._type){case Ro.Both:default:this._beginProcessed?(i=this._atExtremities(t,this._position,!1),this._beginProcessed=!1,this.iterateMultiPath=!1,this.iteratePath=!1):(i=this._atExtremities(t,this._position,!0),this._beginProcessed=!0,this.iterateMultiPath=!0,this.iteratePath=!0);break;case Ro.JustBegin:i=this._atExtremities(t,this._position,!0);break;case Ro.JustEnd:i=this._atExtremities(t,this._position,!1);case Ro.None:}return i}_atExtremities(t,i,r){if(this._placePerPart||(r?t.seekPath(0):t.seekPath(t.totalSize-1)),r||t.seekPathEnd(),r?t.nextPoint():t.prevPoint()){let s=0,[n,o]=[0,0],[a,l]=[t.x,t.y];const u=[0,0];for(;r?t.nextPoint():t.prevPoint();){n=a,o=l,a=t.x,l=t.y;const c=this._curveHelper.getLength(n,o,a,l);if(s+c>i){const d=(i-s)/c,[m,y]=this._curveHelper.getAngleCS(u,n,o,a,l,d),g=this._curveHelper.getCoord2D(n,o,a,l,d);return this.internalPlacement.setTranslate(g[0]-this._offset*y,g[1]+this._offset*m),this._angleToLine&&this.internalPlacement.setRotateCS(-m,-y),this.internalPlacement}s+=c}}return null}};var Po;let x2e=(Po=class{static local(){return Po.instance===null&&(Po.instance=new Po),Po.instance}execute(t,i,r,s,n){return new $2e(t,i,r)}},Po.instance=null,Po),$2e=class extends o0{constructor(t,i,r){super(t),this._walker=new Dw,this._walker.updateTolerance(r),this._angleToLine=i.angleToLine===void 0||i.angleToLine,this._offset=i.offset!==void 0?i.offset*r:0,this._beginGap=i.beginPosition!==void 0?i.beginPosition*r:0,this._endGap=i.endPosition!==void 0?i.endPosition*r:0,this._flipFirst=i.flipFirst===void 0||i.flipFirst,this._pattern=new Nw,this._pattern.init(i.positionArray,!1,!1),this._subPathLen=0,this._posCount=this._pattern.size(),this._isFirst=!0,this._prevPos=0}processPath(t){if(this._pattern.isEmpty())return null;let i;if(this.iteratePath){const a=this._pattern.nextValue()*this._subPathLen,l=this._beginGap+a;i=l-this._prevPos,this._prevPos=l}else{if(this._posCount=this._pattern.size(),this._isFirst=!0,this._prevPos=0,this._subPathLen=t.pathLength()-this._beginGap-this._endGap,this._subPathLen<0)return this.iteratePath=!1,null;if(!this._walker.init(t,this._pattern,!1))return null;this._pattern.reset();const a=this._pattern.nextValue()*this._subPathLen,l=this._beginGap+a;i=l-this._prevPos,this._prevPos=l,this.iteratePath=!0}const r=new Ta;if(!this._walker.nextPointAndAngle(i,r,Yl.END))return this.iteratePath=!1,null;this.internalPlacement.setTranslate(r.pt[0]-this._offset*r.sa,r.pt[1]+this._offset*r.ca);const s=this._isFirst&&this._flipFirst;let n,o;return this._angleToLine?(n=r.ca,o=r.sa):(n=1,o=0),s&&(n=-n,o=-o),this.internalPlacement.setRotateCS(n,o),this._isFirst=!1,this._posCount--,this._posCount===0&&(this.iteratePath=!1),this.internalPlacement}};const sm=512,M2e=10,Un=24,$b=1e-6;var Io;let T2e=(Io=class{static local(){return Io.instance===null&&(Io.instance=new Io),Io.instance}execute(t,i,r,s,n){return new E2e(t,i,r,s,n)}},Io.instance=null,Io),E2e=class lc{constructor(t,i,r,s,n){if(this._xMin=0,this._xMax=0,this._yMin=0,this._yMax=0,this._currentX=0,this._currentY=0,this._accelerationMap=null,this._testInsidePolygon=!1,this._verticalSubdivision=!0,this._stepX=Math.abs(i.stepX??16)*r,this._stepY=Math.abs(i.stepY??16)*r,this._stepX=Math.round(128*this._stepX)/128,this._stepY=Math.round(128*this._stepY)/128,this._stepX!==0&&this._stepY!==0){if(this._gridType=i.gridType??ky.Fixed,this._gridType===ky.Random){const o=i.seed??13,a=1;this._randomLCG=new pE(o*a),this._randomness=(i.randomness??100)/100,this._gridAngle=0,this._shiftOddRows=!1,this._cosAngle=1,this._sinAngle=0,this._offsetX=0,this._offsetY=0,this._buildRandomValues()}else{if(this._randomness=0,this._gridAngle=i.gridAngle??0,this._shiftOddRows=i.shiftOddRows??!1,this._offsetX=(i.offsetX??0)*r,this._offsetY=(i.offsetY??0)*r,this._cosAngle=Math.cos(this._gridAngle/180*Math.PI),this._sinAngle=-Math.sin(this._gridAngle/180*Math.PI),this._stepX)if(this._offsetX<0)for(;this._offsetX<-.5*this._stepX;)this._offsetX+=this._stepX;else for(;this._offsetX>=.5*this._stepX;)this._offsetX-=this._stepX;if(this._stepY)if(this._offsetY<0)for(;this._offsetY<-.5*this._stepY;)this._offsetY+=this._stepY;else for(;this._offsetY>=.5*this._stepY;)this._offsetY-=this._stepY}if(this._graphicOriginX=0,this._graphicOriginY=0,s!=null){const[o,a,l,u]=s.split("/"),c=parseFloat(o),d=parseFloat(a),m=parseFloat(l),y=parseFloat(u);this._graphicOriginX=-(y*2**c+m)*sm,this._graphicOriginY=d*sm,this._testInsidePolygon=!0}this._internalPlacement=new Sf,this._calculateMinMax(t),this._geometryCursor=t}}next(){return this._geometryCursor?this._nextInside():null}_buildRandomValues(){if(!lc._randValues){lc._randValues=[];for(let t=0;t<Un;t++)for(let i=0;i<Un;i++)lc._randValues.push(this._randomLCG.getFloat()),lc._randValues.push(this._randomLCG.getFloat())}}_calculateMinMax(t){let i,r,s,n,o,a,l,u,c,d,m,y,g,_;this._xMin=0,this._xMax=0,this._yMin=0,this._yMax=0,l=u=g=m=Number.MAX_VALUE,c=d=_=y=-Number.MAX_VALUE;const v=this._cosAngle!==1;for(t.reset();t.nextPath();)for(;t.nextPoint();)a=t.x,o=t.y,i=a-this._graphicOriginX-this._offsetX,r=o-this._graphicOriginY-this._offsetY,v?(s=this._cosAngle*i-this._sinAngle*r,n=this._sinAngle*i+this._cosAngle*r):(s=i,n=r),l=Math.min(l,s),c=Math.max(c,s),u=Math.min(u,n),d=Math.max(d,n),m=Math.min(m,o),y=Math.max(y,o),g=Math.min(g,a),_=Math.max(_,a);m=m!==Number.MAX_VALUE?m:-512-this._stepY,y=y!==-Number.MAX_VALUE?y:this._stepY,g=g!==Number.MAX_VALUE?g:-this._stepX,_=_!==-Number.MAX_VALUE?_:sm+this._stepX;const b=y-m,S=_-g;if(this._verticalSubdivision=b>=S,this._polygonMin=this._verticalSubdivision?m:g,this._testInsidePolygon){let $=0-this._graphicOriginX-this._offsetX-this._stepX,E=sm-this._graphicOriginX-this._offsetX+this._stepX,C=-512-this._graphicOriginY-this._offsetY-this._stepY,P=0-this._graphicOriginY-this._offsetY+this._stepY;if(v){const k=[[$,C],[$,P],[E,C],[E,P]];$=C=Number.MAX_VALUE,E=P=-Number.MAX_VALUE;for(const F of k){const D=this._cosAngle*F[0]-this._sinAngle*F[1],U=this._sinAngle*F[0]+this._cosAngle*F[1];$=Math.min($,D),E=Math.max(E,D),C=Math.min(C,U),P=Math.max(P,U)}}l=l!==Number.MAX_VALUE?Math.max(l,$):$,u=u!==Number.MAX_VALUE?Math.max(u,C):C,c=c!==-Number.MAX_VALUE?Math.min(c,E):E,d=d!==-Number.MAX_VALUE?Math.min(d,P):P}this._xMin=Math.round(l/this._stepX),this._xMax=Math.round(c/this._stepX),this._yMin=Math.round(u/this._stepY),this._yMax=Math.round(d/this._stepY),this._currentX=this._xMax+1,this._currentY=this._yMin-1,this._buildAccelerationMap(t,g,_,m,y)}_buildAccelerationMap(t,i,r,s,n){t.reset();const o=new Map,a=this._verticalSubdivision,l=a?n-s:r-i;let u=Math.ceil(l/M2e);if(u<=1)return;const c=Math.floor(l/u);let d,m,y,g,_,v,b,S,$,E,C;for(u++,this._delta=c,a?($=-512-2*this._stepY,E=2*this._stepY,C=s):($=-2*this._stepX,E=sm+2*this._stepX,C=i);t.nextPath();)if(!(t.pathSize<2)&&t.nextPoint())for(d=t.x,m=t.y;t.nextPoint();d=y,m=g){if(y=t.x,g=t.y,a){if(m===g||m<$&&g<$||m>E&&g>E)continue;_=Math.min(m,g),v=Math.max(m,g)}else{if(d===y||d<$&&y<$||d>E&&y>E)continue;_=Math.min(d,y),v=Math.max(d,y)}for(;_<v;)b=Math.floor((_-C)/c),lN(b,d,m,y,g,o),_+=c;S=Math.floor((v-C)/c),S>b&&lN(S,d,m,y,g,o)}this._accelerationMap=o}_nextInside(){for(;;){if(this._currentX>this._xMax){if(this._currentY++,this._currentY>this._yMax)return null;this._currentX=this._xMin,this._shiftOddRows&&this._currentY%2&&this._currentX--}let t=this._currentX*this._stepX+this._offsetX;this._shiftOddRows&&this._currentY%2&&(t+=.5*this._stepX);const i=this._currentY*this._stepY+this._offsetY;let r,s;if(this._currentX++,this._gridType===ky.Random){const n=(this._currentX%Un+Un)%Un,o=(this._currentY%Un+Un)%Un;r=this._graphicOriginX+t+this._stepX*this._randomness*(.5-lc._randValues[o*Un+n])*2/3,s=this._graphicOriginY+i+this._stepY*this._randomness*(.5-lc._randValues[o*Un+n+1])*2/3}else r=this._graphicOriginX+this._cosAngle*t+this._sinAngle*i,s=this._graphicOriginY-this._sinAngle*t+this._cosAngle*i;if(!this._testInsidePolygon||this._isInsidePolygon(r,s,this._geometryCursor))return this._internalPlacement.setTranslate(r,s),this._internalPlacement}}_isInsidePolygon(t,i,r){if(this._accelerationMap==null)return C2e(t,i,r);t+=$b,i+=$b;const s=this._verticalSubdivision,n=s?i:t,o=Math.floor((n-this._polygonMin)/this._delta),a=this._accelerationMap.get(o);if(!a)return!1;let l,u,c,d=0;for(const m of a){if(l=m[0],u=m[1],s){if(l[1]>i==u[1]>i)continue;c=(u[0]-l[0])*(i-l[1])-(u[1]-l[1])*(t-l[0])}else{if(l[0]>t==u[0]>t)continue;c=(u[1]-l[1])*(t-l[0])-(u[0]-l[0])*(i-l[1])}c>0?d++:d--}return d!==0}};function C2e(e,t,i){let r,s,n,o,a=0;for(e+=$b,t+=$b,i.reset();i.nextPath();)if(i.nextPoint())for(r=i.x,s=i.y;i.nextPoint();r=n,s=o)n=i.x,o=i.y,s>t!=o>t&&((n-r)*(t-s)-(o-s)*(e-r)>0?a++:a--);return a!==0}function lN(e,t,i,r,s,n){let o=n.get(e);o||(o=[],n.set(e,o)),o.push([[t,i],[r,s]])}const P2e=.001;var Ao;let I2e=(Ao=class{static local(){return Ao.instance===null&&(Ao.instance=new Ao),Ao.instance}execute(t,i,r,s,n){return new A2e(t,i,r)}},Ao.instance=null,Ao),A2e=class extends o0{constructor(t,i,r){super(t),this._curveHelper=new Qa,this._angleToLine=i.angleToLine===void 0||i.angleToLine,this._offset=i.offset!==void 0?i.offset*r:0,this._relativeTo=i.relativeTo,this._position=i.startPointOffset!==void 0?i.startPointOffset*r:0,this._epsilon=P2e*r}processPath(t){const i=this._position;if(this._relativeTo===Mc.SegmentMidpoint){if(this.iteratePath||(this.iteratePath=!0),t.nextPoint()){let[s,n]=[t.x,t.y],[o,a]=[0,0];const l=[0,0];for(;t.nextPoint();){o=t.x,a=t.y;const u=this._curveHelper.getLength(s,n,o,a);if(u<this._epsilon){s=o,n=a;continue}const c=.5+this._position/u,[d,m]=this._curveHelper.getAngleCS(l,s,n,o,a,c),y=this._curveHelper.getCoord2D(s,n,o,a,c);return this.internalPlacement.setTranslate(y[0]-this._offset*m,y[1]+this._offset*d),this._angleToLine&&this.internalPlacement.setRotateCS(d,m),this.internalPlacement}}return this.iteratePath=!1,null}const r=this._relativeTo===Mc.LineEnd;return this.onLine(t,i,r)}onLine(t,i,r){let s,n=!1;switch(this._relativeTo){case Mc.LineMiddle:default:t.seekPathStart(),s=t.pathLength()/2+i;break;case Mc.LineBeginning:s=i;break;case Mc.LineEnd:s=i,n=!0}r?t.seekPathEnd():t.seekPathStart();let o=0;if(r?t.prevPoint():t.nextPoint()){let[a,l]=[t.x,t.y],[u,c]=[0,0];const d=[0,0];for(;r?t.prevPoint():t.nextPoint();){u=t.x,c=t.y;const m=this._curveHelper.getLength(a,l,u,c);if(o+m>s){const y=(s-o)/m,[g,_]=this._curveHelper.getAngleCS(d,a,l,u,c,y),v=this._curveHelper.getCoord2D(a,l,u,c,y),b=n?-this._offset:this._offset;return this.internalPlacement.setTranslate(v[0]-b*_,v[1]+b*g),this._angleToLine&&(n?this.internalPlacement.setRotateCS(-g,-_):this.internalPlacement.setRotateCS(g,_)),this.internalPlacement}a=u,l=c,o+=m}}return null}};const L2e=1e-15;var Lo;let k2e=(Lo=class{static local(){return Lo.instance===null&&(Lo.instance=new Lo),Lo.instance}execute(t,i,r,s,n){return new R2e(t,i,r)}},Lo.instance=null,Lo),R2e=class extends o0{constructor(t,i,r){super(t),this._curveHelper=new Qa,this._angleToLine=i.angleToLine===void 0||i.angleToLine,this._offset=i.offset!==void 0?i.offset*r:0,this._endPoints=i.placeOnEndPoints===void 0||i.placeOnEndPoints,this._controlPoints=i.placeOnControlPoints===void 0||i.placeOnControlPoints,this._regularVertices=i.placeOnRegularVertices===void 0||i.placeOnRegularVertices,this._tags=[],this._tagIterator=0}processPath(t){if(this.iteratePath||(this._preparePath(t),this.iteratePath=!0),this._tagIterator>=this._tags.length)return this._tags.length=0,this._tagIterator=0,this.iteratePath=!1,null;const i=this._tags[this._tagIterator];this._angleToLine&&this.internalPlacement.setRotate(i[2]);let r=i[0],s=i[1];if(this._offset!==0){const n=Math.cos(i[2]),o=Math.sin(i[2]);r-=this._offset*o,s+=this._offset*n}return this.internalPlacement.setTranslate(r,s),this._tagIterator++,this.internalPlacement}_preparePath(t){this._tags.length=0,this._tagIterator=0,t.seekPathStart();const i=t.isClosed();let r=0,s=!1,n=0,o=0;if(t.seekPathStart(),t.nextPoint()){let a=t.x,l=t.y,u=t.getControlPoint(),c=!0,d=t.nextPoint();for(;d;){const m=t.x,y=t.y,g=t.getControlPoint();(this._angleToLine||this._offset!==0)&&(n=this._curveHelper.getAngle(a,l,m,y,0)),c?(c=!1,i?(r=n,s=u):(this._endPoints||this._controlPoints&&u)&&this._tags.push([a,l,n])):u?this._controlPoints&&this._tags.push([a,l,u_(o,n)]):this._regularVertices&&this._tags.push([a,l,u_(o,n)]),(this._angleToLine||this._offset!==0)&&(o=this._curveHelper.getAngle(a,l,m,y,1)),d=t.nextPoint(),d||(i?g||s?this._controlPoints&&this._tags.push([m,y,u_(o,r)]):this._regularVertices&&this._tags.push([m,y,u_(o,r)]):(this._endPoints||this._controlPoints&&g)&&this._tags.push([m,y,o])),a=m,l=y,u=g}}this._tagIterator=0}};function u_(e,t){const i=Math.PI;for(;Math.abs(t-e)>i+2*L2e;)t-e>i?t-=2*i:t+=2*i;return(e+t)/2}const O2e=100*222045e-21;function N2e(e){if(e.totalSize===0)return null;const t=jg(e);if(!t)return null;const i=4*(Math.abs(t[0])+Math.abs(t[2])+Math.abs(t[1])+Math.abs(t[3])+1)*O2e;let r=0,s=0;e.reset();for(let D=0;e.nextPath();D++){const U=e.getCurrentRingArea();U>s&&(s=U,r=D)}if(e.seekPath(r),e.pathSize===0)return null;e.seekPathStart();const n=j6(e);if(Math.abs(s)<=2*i*i)return[(n[0]+n[2])/2,(n[1]+n[3])/2];e.seekPathStart();const o=FQ(e,Qt());if(o===null)return null;if(e.totalPoints<4)return o;const a=[[NaN,NaN],[NaN,NaN],[NaN,NaN],[NaN,NaN]],l=[NaN,NaN,NaN,NaN],u=[NaN,NaN,NaN,NaN];let c=!1,d=nm(o,e,!0);d.distance===0&&(c=!0,a[0][0]=o[0],a[0][1]=o[1],d=nm(o,e,!1)),l[0]=d.distance,u[0]=0;const m=[NaN,NaN];let y=!1,g=.25,_=-1,v=NaN;do if(v=NaN,a[1]=_S(e,vS(n[0],n[2],g),i,t),isNaN(a[1][0])||isNaN(a[1][1])||(d=nm(a[1],e,!1),v=d.distance),!isNaN(v)&&v>i&&R1(a[1],e))y=!0,l[1]=v,u[1]=uc(a[1],o);else if(!isNaN(v)&&v>_&&(_=v,m[0]=a[1][0],m[1]=a[1][1]),g-=.01,g<.1){if(!(_>=0))break;y=!0,l[1]=_,a[1][0]=m[0],a[1][1]=m[1],u[1]=uc(a[1],o)}while(!y);y=!1,g=.5,_=-1;let b=.01,S=1;do if(v=NaN,a[2]=_S(e,vS(n[0],n[2],g),i,t),isNaN(a[2][0])||isNaN(a[2][1])||(d=nm(a[2],e,!1),v=d.distance),!isNaN(v)&&v>i&&R1(a[2],e))y=!0,l[2]=v,u[2]=uc(a[2],o);else if(!isNaN(v)&&v>_)_=v,m[0]=a[2][0],m[1]=a[2][1];else if(v>_&&(_=v,m[0]=a[2][0],m[1]=a[2][1]),g=.5+b*S,b+=.01,S*=-1,g<.3||g>.7){if(!(_>=0))break;y=!0,l[2]=_,a[2][0]=m[0],a[2][1]=m[1],u[2]=uc(a[2],o)}while(!y);y=!1,g=.75,_=-1;do if(v=NaN,a[3]=_S(e,vS(n[0],n[2],g),i,t),isNaN(a[3][0])||isNaN(a[3][1])||(d=nm(a[3],e,!1),v=d.distance),!isNaN(v)&&v>i&&R1(a[3],e))y=!0,l[3]=v,u[3]=uc(a[3],o);else if(v>_&&(_=v,m[0]=a[3][0],m[1]=a[3][1]),g+=.01,g>.9){if(!(_>=0))break;y=!0,l[3]=_,a[3][0]=m[0],a[3][1]=m[1],u[3]=uc(a[3],o)}while(!y);const $=[0,1,2,3],E=c?0:1;let C;for(let D=E;D<4;D++)for(let U=E;U<3;U++){const W=u[U],Y=u[U+1];z2e(W,Y)>0&&(C=$[U],$[U]=$[U+1],$[U+1]=C,u[U]=Y,u[U+1]=W)}let P=E,k=0,F=0;for(let D=E;D<4;D++){switch(D){case 0:F=2*l[$[D]];break;case 1:F=1.66666666*l[$[D]];break;case 2:F=1.33333333*l[$[D]];break;case 3:F=l[$[D]]}F>k&&(k=F,P=$[D])}return a[P]}function R1(e,t){let i,r,s,n,o=0;for(t.reset();t.nextPath()&&t.nextPoint();)for(i=t.x,r=t.y;t.nextPoint();i=s,r=n)s=t.x,n=t.y,r>e[1]!=n>e[1]&&((s-i)*(e[1]-r)-(n-r)*(e[0]-i)>0?o++:o--);return o!==0}function nm(e,t,i){if(i&&R1(e,t))return{coord:e,distance:0};let r=1/0,s=0,n=0,o=[0,0],a=[0,0];const l=[0,0];for(t.reset();t.nextPath()&&t.nextPoint();)if(!(t.pathSize<2))for(o[0]=t.x,o[1]=t.y;t.nextPoint();o=a){a=[t.x,t.y],C6(l,e,o,a);const u=uc(e,l);u<r&&(r=u,s=l[0],n=l[1])}return{coord:[s,n],distance:Math.sqrt(r)}}function _S(e,t,i,r){const s=[t,0];let n=1/0,o=1/0,a=!1,l=!1;const u=[[t,r[1]-1],[t,r[3]+1]],c=[0,0],d=[0,0],m=[0,0],y=[[0,0],[0,0]],g=Qt();for(e.reset();e.nextPath()&&e.nextPoint();)if(!(e.pathSize<2))for(y[0][0]=e.x,y[0][1]=e.y;e.nextPoint();y[0][0]=y[1][0],y[0][1]=y[1][1]){if(y[1][0]=e.x,y[1][1]=e.y,D2e(g,y)===null||(d[0]=u[0][0],d[1]=u[0][1],m[0]=u[1][0],m[1]=u[1][1],F2e(g,d,m)===0)||!cv(u[0],u[1],y[0],y[1],c))continue;const _=c[1];n>o?_<n&&(n=_,a=!0):_<o&&(o=_,l=!0)}return a&&l?s[1]=(n+o)/2:s[0]=s[1]=NaN,s}function D2e(e,t){if(t.length<2)return null;e||(e=Qt());const[i,r]=t[0],[s,n]=t[1];return e[0]=Math.min(i,s),e[1]=Math.min(r,n),e[2]=Math.max(i,s),e[3]=Math.max(r,n),e}const c_=1,h_=4,uN=3,cN=12;function F2e(e,t,i){let r=jn(t,e),s=jn(i,e);const n=e[0],o=e[1],a=e[2],l=e[3];if(r&s)return 0;if(!(r|s))return 4;const u=(r?1:0)|(s?2:0);do{const c=i[0]-t[0],d=i[1]-t[1];if(c>d)r&uN?(r&c_?(t[1]+=d*(n-t[0])/c,t[0]=n):(t[1]+=d*(a-t[0])/c,t[0]=a),r=jn(t,e)):s&uN?(s&c_?(i[1]+=d*(n-i[0])/c,i[0]=n):(i[1]+=d*(a-i[0])/c,i[0]=a),s=jn(i,e)):r?(r&h_?(t[0]+=c*(o-t[1])/d,t[1]=o):(t[0]+=c*(l-t[1])/d,t[1]=l),r=jn(t,e)):(s&h_?(i[0]+=c*(o-i[1])/d,i[1]=o):(i[0]+=c*(l-i[1])/d,i[1]=l),s=jn(i,e));else if(r&cN?(r&h_?(t[0]+=c*(o-t[1])/d,t[1]=o):(t[0]+=c*(l-t[1])/d,t[1]=l),r=jn(t,e)):s&cN?(s&h_?(i[0]+=c*(o-i[1])/d,i[1]=o):(i[0]+=c*(l-i[1])/d,i[1]=l),s=jn(i,e)):r?(r&c_?(t[1]+=d*(n-t[0])/c,t[0]=n):(t[1]+=d*(a-t[0])/c,t[0]=a),r=jn(t,e)):(s&c_?(i[1]+=d*(n-i[0])/c,i[0]=n):(i[1]+=d*(a-i[0])/c,i[0]=a),s=jn(i,e)),r&s)return 0}while(r|s);return u}function jn(e,t){return(e[0]<t[0]?1:0)|(e[0]>t[2]?1:0)<<1|(e[1]<t[1]?1:0)<<2|(e[1]>t[3]?1:0)<<3}function vS(e,t,i){return e+(t-e)*i}function uc(e,t){return(e[0]-t[0])*(e[0]-t[0])+(e[1]-t[1])*(e[1]-t[1])}function z2e(e,t){if(e<t)return-1;if(e>t)return 1;if(e===t)return 0;const i=isNaN(e),r=isNaN(t);return i<r?-1:i>r?1:0}var ko;let V2e=(ko=class{static local(){return ko.instance===null&&(ko.instance=new ko),ko.instance}execute(t,i,r,s,n){return new U2e(t,i,r)}},ko.instance=null,ko),U2e=class{constructor(t,i,r){this._geometryCursor=t,this._offsetX=i.offsetX!==void 0?i.offsetX*r:0,this._offsetY=i.offsetY!==void 0?i.offsetY*r:0,this._method=i.method!==void 0?i.method:Gd.OnPolygon,this._placementPerPart=i.placePerPart!==void 0&&i.placePerPart,this._internalPlacement=new Sf}next(){const t=this._geometryCursor;if(!t)return null;if(!this._placementPerPart)return this._geometryCursor=null,this._polygonCenter(t);for(;t.nextPath();)if(!(t.getCurrentRingArea()<0))return this._polygonCenter(t.getCurrentPath());return this._geometryCursor=null,null}_polygonCenter(t){let i=!1;switch(this._method){case Gd.CenterOfMass:{const r=jQ(t);r&&(this._internalPlacement.setTranslate(r[0]+this._offsetX,r[1]+this._offsetY),i=!0)}break;case Gd.BoundingBoxCenter:{const r=jg(t);r&&(this._internalPlacement.setTranslate((r[2]+r[0])/2+this._offsetX,(r[3]+r[1])/2+this._offsetY),i=!0)}break;case Gd.OnPolygon:default:{const r=N2e(t);r!==null&&(this._internalPlacement.setTranslate(r[0]+this._offsetX,r[1]+this._offsetY),i=!0)}}return i?this._internalPlacement:null}};function j2e(e){if(!e)return null;switch(e.type){case"CIMGeometricEffectAddControlPoints":return Mwe.local();case"CIMGeometricEffectArrow":return Pwe.local();case"CIMGeometricEffectBuffer":return Awe.local();case"CIMGeometricEffectControlMeasureLine":return kwe.local();case"CIMGeometricEffectCut":return Owe.local();case"CIMGeometricEffectDashes":return Dwe.local();case"CIMGeometricEffectDonut":return zwe.local();case"CIMGeometricEffectJog":return Hwe.local();case"CIMGeometricEffectMove":return Zwe.local();case"CIMGeometricEffectOffset":return Xwe.local();case"CIMGeometricEffectRadial":return Qwe.local();case"CIMGeometricEffectReverse":return t2e.local();case"CIMGeometricEffectRotate":return s2e.local();case"CIMGeometricEffectScale":return o2e.local();case"CIMGeometricEffectSuppress":return l2e.local();case"CIMGeometricEffectTaperedPolygon":return m2e.local();case"CIMGeometricEffectWave":return g2e.local();case"CIMGeometricEffectEnclosingPolygon":return Uwe.local()}return null}function G2e(e){if(!e)return null;switch(e.type){case"CIMMarkerPlacementAlongLineSameSize":return v2e.local();case"CIMMarkerPlacementAtExtremities":return w2e.local();case"CIMMarkerPlacementAtRatioPositions":return x2e.local();case"CIMMarkerPlacementInsidePolygon":return T2e.local();case"CIMMarkerPlacementOnLine":return I2e.local();case"CIMMarkerPlacementOnVertices":return k2e.local();case"CIMMarkerPlacementPolygonCenter":return V2e.local()}return null}function bS(e){const t=e.getFrame(0);if(t instanceof HTMLImageElement||t instanceof HTMLCanvasElement)return t;const i=document.createElement("canvas");i.width=e.width,i.height=e.height;const r=i.getContext("2d");return t instanceof ImageData?r.putImageData(t,0,0):r.drawImage(t,0,0),i}function ia(e,t=0){if(t===0)return e;const i=Math.cos(t),r=Math.sin(t),[s,n]=e;return[s*i+n*-r,s*r+n*i]}function mG(e,t,i=0){const r=lr(e,0,W2e);for(let s=0;s<4;s++)t[i+s]=Math.floor(256*Z2e(r*q2e[s]))}function B2e(e,t=0){let i=0;for(let r=0;r<4;r++)i+=e[t+r]*H2e[r];return i}const q2e=[1,256,65536,16777216],H2e=[1/256,1/65536,1/16777216,1/4294967296],W2e=B2e(new Uint8ClampedArray([255,255,255,255]));function Z2e(e){return e-Math.floor(e)}const Y2e=15.5,wS=4,J2e=64,LOe=1024,kOe={outlineWidth:.75,referenceWidth:.75,cap:ti.CIMSolidStroke.capstyle,join:ti.CIMSolidStroke.joinstyle,miterLimit:ti.CIMSolidStroke.miterlimit},hN=()=>H.getLogger("esri.symbols.cim.rasterizingUtils"),X2e=32,K2e=e=>e==="vertical"||e==="horizontal"||e==="cross"||e==="esriSFSCross"||e==="esriSFSVertical"||e==="esriSFSHorizontal";function ROe(e,t,i){const r=t.style,s=iQ(Math.ceil(i)),n=K2e(r)?8*s:16*s,o=2*s;e.width=n,e.height=n;const a=e.getContext("2d");a.strokeStyle="#ffffff",a.lineWidth=s,a.beginPath(),r!=="vertical"&&r!=="cross"&&r!=="esriSFSCross"&&r!=="esriSFSVertical"||(a.moveTo(n/2,-o),a.lineTo(n/2,n+o)),r!=="horizontal"&&r!=="cross"&&r!=="esriSFSCross"&&r!=="esriSFSHorizontal"||(a.moveTo(-o,n/2),a.lineTo(n+o,n/2)),r!=="backward-diagonal"&&r!=="diagonal-cross"&&r!=="esriSFSDiagonalCross"&&r!=="esriSFSBackwardDiagonal"||(a.moveTo(-o,-o),a.lineTo(n+o,n+o),a.moveTo(n-o,-o),a.lineTo(n+o,o),a.moveTo(-o,n-o),a.lineTo(o,n+o)),r!=="forward-diagonal"&&r!=="diagonal-cross"&&r!=="esriSFSForwardDiagonal"&&r!=="esriSFSDiagonalCross"||(a.moveTo(n+o,-o),a.lineTo(-o,n+o),a.moveTo(o,-o),a.lineTo(-o,o),a.moveTo(n+o,n-o),a.lineTo(n-o,n+o)),a.stroke();const l=a.getImageData(0,0,e.width,e.height),u=new Uint8Array(l.data);let c;for(let d=0;d<u.length;d+=4)c=u[d+3]/255,u[d]=u[d]*c,u[d+1]=u[d+1]*c,u[d+2]=u[d+2]*c;return[u,e.width,e.height,s]}function OOe(e){e.length%2==1&&(e=[...e,...e]);const t=e.reduce(((d,m)=>d+m),0),i=Math.round(t*wS),r=1,s=new Float32Array(i*r);let n=0,o=0,a=.5,l=!0;for(const d of e){for(n=o,o+=d*wS;a<=o;){const m=a-.5,y=Math.min(Math.abs(a-n),Math.abs(a-o));s[m]=l?-y:y,a++}l=!l}const u=s.length,c=new Uint8Array(4*u);for(let d=0;d<u;++d){const m=s[d]/wS;mG(m/J2e*.5+.5,c,4*d)}return[c,i,r]}function NOe(e,t){e==null&&(e=[]);const i=t==="Butt",r=t==="Square",s=!i&&!r;e.length%2==1&&(e=[...e,...e]);const n=Y2e,o=2*n;let a=0;for(const b of e)a+=b;const l=Math.round(a*n),u=new Float32Array(l*o),c=.5*n;let d=0,m=0,y=.5,g=!0;for(const b of e){for(d=m,m+=b*n;y<=m;){let S=.5;for(;S<o;){const $=(S-.5)*l+y-.5,E=s?(S-n)*(S-n):Math.abs(S-n);u[$]=g?i?Math.max(Math.max(d+c-y,E),Math.max(y-m+c,E)):E:s?Math.min((y-d)*(y-d)+E,(y-m)*(y-m)+E):r?Math.min(Math.max(y-d,E),Math.max(m-y,E)):Math.min(Math.max(y-d+c,E),Math.max(m+c-y,E)),S++}y++}g=!g}const _=u.length,v=new Uint8Array(4*_);for(let b=0;b<_;++b){const S=(s?Math.sqrt(u[b]):u[b])/n;mG(S,v,4*b)}return[v,l,o]}function DOe(e,t){const{colorRamp:i,gradientType:r}=t,s=i.type==="CIMFixedColorRamp",n=t.interval||ti.CIMGradientFill.interval;let o=XP(i);return s&&(o=yG(o,n)),r==="Discrete"||s?eSe(e,o,n):Q2e(e,o)}let SS;function d_(e,t){const{colorRamp:i,gradientType:r}=t,s=XP(i),n=i.type==="CIMFixedColorRamp";if(r==="Continuous"&&!n)return O1(e,s);const o=t.interval??ti.CIMGradientFill.interval;if(n)return O1(e,yG(s,o));const a=[];SS??=document.createElement("canvas"),KP(SS,s,o,1,0);const l=SS.getContext("2d").getImageData(0,0,o,1).data;for(let u=0,c=0;u<o;u++,c=4*u){const d=[l[c+0],l[c+1],l[c+2],l[c+3]];a.push({offset:u/o,color:d}),a.push({offset:(u+1)/o,color:d})}return O1(e,a)}function XP(e){const t=[];switch(e.type){case"CIMPolarContinuousColorRamp":case"CIMLinearContinuousColorRamp":{e.type==="CIMPolarContinuousColorRamp"&&hN().warnOnce("CIMPolarContinuousColorRamp is currently unsupported. Falling back to CIMLinearContinuousColorRamp.");const i=e;t.push({offset:0,color:[i.fromColor[0],i.fromColor[1],i.fromColor[2],i.fromColor[3]/255]}),t.push({offset:1,color:[i.toColor[0],i.toColor[1],i.toColor[2],i.toColor[3]/255]});break}case"CIMFixedColorRamp":{const i=e,r=1/(i.colors.length-1);let s=0;for(const n of i.colors)t.push({offset:s,color:[n[0],n[1],n[2],n[3]/255]}),s+=r;break}case"CIMMultipartColorRamp":{const i=e,r=i.weights.reduce(((n,o)=>n+o),0);let s=0;for(let n=0;n<i.colorRamps.length;n++){const o=i.colorRamps[n],a=i.weights[n],l=XP(o);for(const u of l)t.push({offset:(s+u.offset*a)/r,color:u.color});s+=a}break}default:hN().error(`Color ramp "${e.type}" currently unsupported.`)}return t}function yG(e,t){const i=[],r=(e.length-1)/(t-1);for(let s=0;s<t;s++){const n=e[Math.round(s*r)].color;i.push({offset:s/t,color:n}),i.push({offset:(s+1)/t,color:n})}return i}function Q2e(e,t){return KP(e,t,X2e,1,NU),gG(e)}function eSe(e,t,i){return KP(e,t,i,1,NU),gG(e)}function O1(e,t,i=0){for(const{offset:r,color:s}of t)e.addColorStop(Math.min(Math.max(r,i),1-i),`rgba(${s[0]}, ${s[1]}, ${s[2]}, ${s[3]})`)}function KP(e,t,i,r,s){const n=i+2*s;e.width=n,e.height=r;const o=(s+1)/n,a=e.getContext("2d",{willReadFrequently:!0});if(t.length>0){const l=a.createLinearGradient(0,0,n,r);O1(l,t,o),a.fillStyle=l}else a.fillStyle="rgba(128, 128, 128, 1)";a.fillRect(0,0,n,r)}function gG(e){const{width:t,height:i}=e,r=e.getContext("2d").getImageData(0,0,t,i),s=new Uint8Array(r.data);for(let n=0;n<s.length;n+=4){const o=s[n+3]/255;s[n]*=o,s[n+1]*=o,s[n+2]*=o}return[s,t,i]}function tSe(e){const t=e[0]?.[0]?.[0]??0,i=e[0]?.[0]?.[1]??0,r={ymin:i,xmin:t,ymax:i,xmax:t,width:0,height:0};for(let s=0;s<e.length;s++){const n=e[s];for(let o=0;o<n.length;o++){const a=n[o][0],l=n[o][1];a<r.xmin&&(r.xmin=a),a>r.xmax&&(r.xmax=a),l<r.ymin&&(r.ymin=l),l>r.ymax&&(r.ymax=l)}}return r.width=Math.abs(r.xmax-r.xmin),r.height=Math.abs(r.ymax-r.ymin),r}function Mb(e,t){const i=tSe(e),r=i.width===0?1:i.width,s=i.height===0?1:i.height,n=[];for(let o=0;o<e.length;o++){const a=e[o],l=[];for(let u=0;u<a.length;u++){let c=Math.round(a[u][0]-i.xmin),d=Math.round(a[u][1]-i.ymin);if(c=t.xmin+c*t.width/r,d=t.ymin+d*t.height/s,isNaN(c)||isNaN(d))throw new Error("Scaled shape has NaN values");l.push([c,d])}n.push(l)}return n}function dN(e,t,i){const r=[];for(let s=0;s<e.length;s++){const n=e[s],o=[];for(let a=0;a<n.length;a++){const l=n[a][0]+t,u=n[a][1]+i;if(isNaN(l)||isNaN(u))throw new Error("Scaled shape has NaN values");o.push([l,u])}r.push(o)}return r}let iSe=class _G{constructor(t=0,i=0,r=0,s=0){this.x=t,this.y=i,this.width=r,this.height=s}static fromExtent(t){return new _G(t.xmin,-t.ymax,t.xmax-t.xmin,t.ymax-t.ymin)}get isEmpty(){return this.width<=0||this.height<=0}union(t){this.x=Math.min(this.x,t.x),this.y=Math.min(this.y,t.y),this.width=Math.max(this.width,t.width),this.height=Math.max(this.height,t.height)}};function rSe(e){return`rgb(${e.slice(0,3).toString()})`}function p_(e){return`rgba(${e.slice(0,3).toString()},${e[3]})`}let vG=class{constructor(t){t&&(this._textRasterizationCanvas=t)}rasterizeText(t,i){this._textRasterizationCanvas||(this._textRasterizationCanvas=document.createElement("canvas"));const r=this._textRasterizationCanvas,s=r.getContext("2d",{willReadFrequently:!0});om(s,i),this._parameters=i,this._textLines=t.split(/\r?\n/),this._lineHeight=this._computeLineHeight();const{decoration:n,weight:o}=i.font;this._lineThroughWidthOffset=n&&n==="line-through"?.1*this._lineHeight:0;const a=i.backgroundColor!=null||i.borderLine!=null,l=a?Eoe:0,u=this._computeTextWidth(s,i)+2*l,c=this._lineHeight*this._textLines.length+2*l;if(r.width=u+2*this._lineThroughWidthOffset,r.height=c,r.width===0||r.height===0)return r.width=r.height=1,{size:[0,0],image:new Uint32Array(0),sdf:!1,simplePattern:!1,anchorX:0,anchorY:0,canvas:r};this._renderedLineHeight=Math.round(this._lineHeight),this._renderedOutlineSize=(i.outline.size||0)*i.pixelRatio,this._renderedHaloSize=(i.halo.size||0)*i.pixelRatio,this._renderedWidth=u,this._renderedHeight=c,this._lineThroughWidthOffset*=i.pixelRatio;const d=(i.outline&&i.outline.color)??[0,0,0,0],m=i.color??[0,0,0,0],y=i.halo&&i.halo.color?i.halo.color:[0,0,0,0];this._fillStyle=p_(m),this._outlineStyle=p_(d),this._haloStyle=rSe(y);const g=this._renderedLineHeight,_=this._renderedOutlineSize,v=this._renderedHaloSize;s.save(),s.clearRect(0,0,r.width,r.height),om(s,i);const b=l*i.pixelRatio,S=sSe(s.textAlign,this._renderedWidth-2*b,this._renderedHaloSize+this._renderedOutlineSize)+b,$=v+_+b,E=v>0;let C=this._lineThroughWidthOffset,P=0;if(a){s.save();const re=i.backgroundColor??[0,0,0,0],K=i.borderLine?.color??[0,0,0,0],Ce=2*(i.borderLine?.size??0);s.fillStyle=p_(re),s.strokeStyle=p_(K),s.lineWidth=Ce,s.fillRect(0,0,r.width,r.height),s.strokeRect(0,0,r.width,r.height),s.restore()}E&&this._renderHalo(s,S,$,C,P,i),_>0&&this._renderOutline(s,S,$,C,P,i),P+=$,C+=S;for(const re of this._textLines)E?(s.globalCompositeOperation="destination-out",s.fillStyle="rgb(0, 0, 0)",s.fillText(re,C,P),s.globalCompositeOperation="source-over",s.fillStyle=this._fillStyle,s.fillText(re,C,P)):(s.fillStyle=this._fillStyle,s.fillText(re,C,P)),n&&n!=="none"&&this._renderDecoration(s,C,P,n,o),P+=g;s.restore();const k=this._renderedWidth+2*this._lineThroughWidthOffset,F=this._renderedHeight,D=s.getImageData(0,0,k,F),U=new Uint8Array(D.data);if(i.premultiplyColors){let re;for(let K=0;K<U.length;K+=4)re=U[K+3]/255,U[K]=U[K]*re,U[K+1]=U[K+1]*re,U[K+2]=U[K+2]*re}let W,Y;switch(i.horizontalAlignment){case"left":W=-.5;break;case"right":W=.5;break;default:W=0}switch(i.verticalAlignment){case"bottom":Y=-.5;break;case"top":Y=.5;break;case"baseline":Y=-1/6;break;default:Y=0}return{size:[k,F],image:new Uint32Array(U.buffer),sdf:!1,simplePattern:!1,anchorX:W,anchorY:Y,canvas:r}}_renderHalo(t,i,r,s,n,o){const a=this._renderedWidth,l=this._renderedHeight;this._outlineRasterizationCanvas||(this._outlineRasterizationCanvas=document.createElement("canvas")),this._outlineRasterizationCanvas.width=a,this._outlineRasterizationCanvas.height=l;const u=this._outlineRasterizationCanvas,c=u.getContext("2d");c.clearRect(0,0,a,l),om(c,o);const{decoration:d,weight:m}=o.font;c.fillStyle=this._haloStyle,c.strokeStyle=this._haloStyle,c.lineJoin="round",this._renderOutlineNative(c,i,r,d,m,this._renderedHaloSize+this._renderedOutlineSize),t.globalAlpha=this._parameters.halo.color[3],t.drawImage(u,0,0,a,l,s,n,a,l),t.globalAlpha=1}_renderOutline(t,i,r,s,n,o){const a=this._renderedWidth,l=this._renderedHeight;this._outlineRasterizationCanvas||(this._outlineRasterizationCanvas=document.createElement("canvas")),this._outlineRasterizationCanvas.width=a,this._outlineRasterizationCanvas.height=l;const u=this._outlineRasterizationCanvas,c=u.getContext("2d");c.clearRect(0,0,a,l),om(c,o);const{decoration:d,weight:m}=o.font;c.fillStyle=this._outlineStyle,c.strokeStyle=this._outlineStyle,c.lineJoin="round",this._renderOutlineNative(c,i,r,d,m,this._renderedOutlineSize),t.globalAlpha=this._parameters.outline.color[3],t.drawImage(u,0,0,a,l,s,n,a,l),t.globalAlpha=1}_renderOutlineNative(t,i,r,s,n,o){const a=this._renderedLineHeight;for(const l of this._textLines){const u=2*o,c=5,d=.1;for(let m=0;m<c;m++){const y=(1-(c-1)*d+m*d)*u;t.lineWidth=y,t.strokeText(l,i,r),s&&s!=="none"&&this._renderDecoration(t,i,r,s,n,y)}r+=a}}computeTextSize(t,i){this._textRasterizationCanvas||(this._textRasterizationCanvas=document.createElement("canvas"));const r=this._textRasterizationCanvas,s=r.getContext("2d");om(s,i),this._parameters=i,this._textLines=t.split(/\r?\n/),this._lineHeight=this._computeLineHeight();const n=this._computeTextWidth(s,i),o=this._lineHeight*this._textLines.length;return r.width=n,r.height=o,[n*i.pixelRatio,o*i.pixelRatio]}_computeTextWidth(t,i){let r=0;for(const n of this._textLines)r=Math.max(r,t.measureText(n).width);const s=i.font;return(s.style==="italic"||s.style==="oblique"||typeof s.weight=="string"&&(s.weight==="bold"||s.weight==="bolder")||typeof s.weight=="number"&&s.weight>600)&&(r+=.3*t.measureText("w").width),r+=2*Re(this._parameters.halo.size),Math.round(r)}_computeLineHeightBase(){return 1.275*this._parameters.size}_computeLineHeight(){let t=this._computeLineHeightBase();const i=this._parameters.font.decoration;return i&&i==="underline"&&(t*=1.3),Math.round(t+2*Re(this._parameters.halo.size))}_renderDecoration(t,i,r,s,n,o){let a=.9*this._lineHeight;const l=n==="bold"?.06:n==="bolder"?.09:.04;switch(t.textAlign){case"center":i-=this._renderedWidth/2;break;case"right":i-=this._renderedWidth}const u=t.textBaseline;if(s==="underline")switch(a=.9*this._computeLineHeightBase(),u){case"top":r+=a;break;case"middle":r+=a/2}else if(s==="line-through")switch(u){case"top":r+=a/1.5;break;case"middle":r+=a/3}const c=o?1.5*o:Math.ceil(a*l);t.save(),t.beginPath(),t.strokeStyle=t.fillStyle,t.lineWidth=c,t.moveTo(i-this._lineThroughWidthOffset,r),t.lineTo(i+this._renderedWidth+2*this._lineThroughWidthOffset,r),t.stroke(),t.restore()}};function om(e,t){const i=Math.max(t.size,.5),r=t.font,s=`${r.style} ${r.weight} ${Re(i).toFixed(1)}px ${r.family}, sans-serif`;let n;switch(e.font=s,e.textBaseline="top",t.horizontalAlignment){case"left":default:n="left";break;case"right":n="right";break;case"center":n="center"}e.textAlign=n}function sSe(e,t,i){return e==="center"?.5*t:e==="right"?t-i:i}function bG(e){return document.createElementNS("http://www.w3.org/2000/svg",e)}function nSe(){const e=bG("svg");return e.setAttribute("style","position: absolute;"),e.setAttribute("width","0"),e.setAttribute("height","0"),e.setAttribute("aria-hidden","true"),e.setAttribute("role","presentation"),document.body.appendChild(e),e}function oSe(e){return e!=null&&document.body.removeChild(e),null}const aSe=()=>H.getLogger("esri.views.2d.engine.webgl.alignmentUtils");var no,Os;function lSe(e){if(!e)return no.Center;switch(e){case"Left":case"left":return no.Left;case"Right":case"right":return no.Right;case"Justify":return aSe().warnOnce("Horizontal alignment 'justify' is not implemented. Falling back to 'center'."),no.Center;case"Center":case"center":return no.Center}}function uSe(e){if(!e)return Os.Center;switch(e){case"Top":case"top":return Os.Top;case"Center":case"middle":return Os.Center;case"Baseline":case"baseline":return Os.Baseline;case"Bottom":case"bottom":return Os.Bottom}}function zOe(e){switch(e){case"above-left":case"esriServerPointLabelPlacementAboveLeft":return["right","bottom"];case"above-center":case"above-along":case"esriServerPointLabelPlacementAboveCenter":case"esriServerLinePlacementAboveAlong":return["center","bottom"];case"above-right":case"esriServerPointLabelPlacementAboveRight":return["left","bottom"];case"center-left":case"esriServerPointLabelPlacementCenterLeft":return["right","middle"];case"center-center":case"center-along":case"esriServerPointLabelPlacementCenterCenter":case"esriServerLinePlacementCenterAlong":case"always-horizontal":case"esriServerPolygonPlacementAlwaysHorizontal":return["center","middle"];case"center-right":case"esriServerPointLabelPlacementCenterRight":return["left","middle"];case"below-left":case"esriServerPointLabelPlacementBelowLeft":return["right","top"];case"below-center":case"below-along":case"esriServerPointLabelPlacementBelowCenter":case"esriServerLinePlacementBelowAlong":return["center","top"];case"below-right":case"esriServerPointLabelPlacementBelowRight":return["left","top"];default:return console.debug(`Found invalid placement type ${e}`),["center","middle"]}}function VOe(e){switch(e){case no.Right:case"right":return-1;case no.Center:case"center":return 0;case no.Left:case"left":return 1;default:return console.debug(`Found invalid horizontal alignment ${e}`),0}}function UOe(e){switch(e){case Os.Top:case"top":return 1;case Os.Center:case"middle":return 0;case Os.Bottom:case Os.Baseline:case"baseline":case"bottom":return-1;default:return console.debug(`Found invalid vertical alignment ${e}`),0}}(function(e){e[e.Left=-1]="Left",e[e.Center=0]="Center",e[e.Right=1]="Right"})(no||(no={})),(function(e){e[e.Top=1]="Top",e[e.Center=0]="Center",e[e.Bottom=-1]="Bottom",e[e.Baseline=2]="Baseline"})(Os||(Os={}));let cSe=class{constructor(t=0,i=0,r=0,s=0){this.x=t,this.y=i,this.width=r,this.height=s}get isEmpty(){return this.width<=0||this.height<=0}union(t){this.x=Math.min(this.x,t.x),this.y=Math.min(this.y,t.y),this.width=Math.max(this.width,t.width),this.height=Math.max(this.height,t.height)}},ry=class eE{constructor(t,i,r,s){this.transformedX=0,this.transformedY=0,this.center=dh(t,i),this.centerT=sg(),this.halfWidth=r/2,this.halfHeight=s/2,this.width=r,this.height=s}get x(){return this.center[0]}get y(){return this.center[1]}get blX(){return this.center[0]+this.halfWidth}get blY(){return this.center[1]+this.halfHeight}get trX(){return this.center[0]-this.halfWidth}get trY(){return this.center[1]-this.halfHeight}get xmin(){return this.x-this.halfWidth}get xmax(){return this.x+this.halfWidth}get ymin(){return this.y-this.halfHeight}get ymax(){return this.y+this.halfHeight}set x(t){this.center[0]=t}set y(t){this.center[1]=t}clone(){return new eE(this.x,this.y,this.width,this.height)}serialize(t){return t.writeF32(this.center[0]),t.writeF32(this.center[1]),t.push(this.width),t.push(this.height),t}findCollisionDelta(t,i=4){const r=Math.abs(t.centerT[0]-this.centerT[0]),s=Math.abs(t.centerT[1]-this.centerT[1]),n=(t.halfWidth+this.halfWidth+i)/r,o=(t.halfHeight+this.halfHeight+i)/s,a=Math.min(n,o);return Math.log2(a)}extend(t){const i=Math.min(this.xmin,t.xmin),r=Math.min(this.ymin,t.ymin),s=Math.max(this.xmax,t.xmax)-i,n=Math.max(this.ymax,t.ymax)-r,o=i+s/2,a=r+n/2;this.width=s,this.height=n,this.halfWidth=s/2,this.halfHeight=n/2,this.x=o,this.y=a}static deserialize(t){const i=t.readF32(),r=t.readF32(),s=t.readInt32(),n=t.readInt32();return new eE(i,r,s,n)}};const wG=22,SG=4,hSe=wG+SG,dSe=wG-6,pN=3,pSe=Math.PI/180,ml=8,fSe=1.5;let xG=class{constructor(t,i,r,s){this._rotationT=Ua(),this._xBounds=0,this._yBounds=0,this.minZoom=0,this.maxZoom=255,this._bounds=null;const n=r.rect,o=new Float32Array(8);t*=s,i*=s;const a=r.code?n.width*s:r.metrics.width,l=r.code?n.height*s:r.metrics.height;this.width=a,this.height=l,o[0]=t,o[1]=i,o[2]=t+a,o[3]=i,o[4]=t,o[5]=i+l,o[6]=t+a,o[7]=i+l,this._data=o,this._setTextureCoords(n),this._scale=s,this._mosaic=r,this.x=t,this.y=i,this.maxOffset=Math.max(t+a,i+l)}get mosaic(){return this._mosaic}set angle(t){this._angle=t,pw(this._rotationT,-t),this._setOffsets()}get angle(){return this._angle}get xTopLeft(){return this._data[0]}get yTopLeft(){return this._data[1]}get xBottomRight(){return this._data[6]}get yBottomRight(){return this._data[7]}get texcoords(){return this._texcoords}get textureBinding(){return this._mosaic.textureBinding}get offsets(){return this._offsets||this._setOffsets(),this._offsets}get char(){return String.fromCharCode(this._mosaic.code)}get code(){return this._mosaic.code}get bounds(){if(!this._bounds){const{height:t,width:i}=this._mosaic.metrics,r=i*this._scale,s=Math.abs(t)*this._scale,n=new Float32Array(8);n[0]=this.x,n[1]=this.y,n[2]=this.x+r,n[3]=this.y,n[4]=this.x,n[5]=this.y+s,n[6]=this.x+r,n[7]=this.y+s;const o=so(Ua(),this._rotationT,this._transform);tU(n,n,o);let a=1/0,l=1/0,u=-1/0,c=-1/0;for(let _=0;_<4;_++){const v=n[2*_],b=n[2*_+1];a=Math.min(a,v),l=Math.min(l,b),u=Math.max(u,v),c=Math.max(c,b)}const d=u-a,m=c-l,y=a+d/2,g=l+m/2;this._bounds=new ry(y,g,d,m)}return this._bounds}setTransform(t){this._transform=t,this._offsets=null}_setOffsets(){this._offsets||(this._offsets={topLeft:[0,0],topRight:[0,0],bottomLeft:[0,0],bottomRight:[0,0]});const t=so(Ua(),this._rotationT,this._transform);this._offsets.topLeft[0]=this._data[0],this._offsets.topLeft[1]=this._data[1],this._offsets.topRight[0]=this._data[2],this._offsets.topRight[1]=this._data[3],this._offsets.bottomLeft[0]=this._data[4],this._offsets.bottomLeft[1]=this._data[5],this._offsets.bottomRight[0]=this._data[6],this._offsets.bottomRight[1]=this._data[7],tr(this._offsets.topLeft,this._offsets.topLeft,t),tr(this._offsets.topRight,this._offsets.topRight,t),tr(this._offsets.bottomLeft,this._offsets.bottomLeft,t),tr(this._offsets.bottomRight,this._offsets.bottomRight,t)}_setTextureCoords({x:t,y:i,width:r,height:s}){this._texcoords={topLeft:[t,i],topRight:[t+r,i],bottomLeft:[t,i+s],bottomRight:[t+r,i+s]}}};const mSe=(e,t)=>({code:0,page:0,sdf:!0,rect:new cSe(0,0,11,8),textureBinding:t,metrics:{advance:0,height:4,width:e,left:0,top:0}});function am(e,t){return e.forEach((i=>tr(i,i,t))),{topLeft:e[0],topRight:e[1],bottomLeft:e[2],bottomRight:e[3]}}let ySe=class{constructor(t,i,r){this._rotation=0,this._decorate(t,i,r),this.glyphs=t,this.bounds=this._createBounds(t),this.isMultiline=i.length>1,this._hasRotation=r.angle!==0,this._transform=this._createGlyphTransform(this.bounds,r),this._borderLineSizePx=r.borderLineSizePx,(r.borderLineSizePx||r.hasBackground)&&([this.bounds,this.textBox]=this.shapeBackground(this._transform));for(const s of t)s.setTransform(this._transform)}setRotation(t){if(t===0&&this._rotation===0)return;this._rotation=t;const i=this._transform,r=pw(Ua(),t);so(i,r,i);for(const s of this.glyphs)s.setTransform(this._transform)}_decorate(t,i,r){if(!r.decoration||r.decoration==="none"||!t.length)return;const s=r.scale,n=r.decoration==="underline"?hSe:dSe,o=t[0].textureBinding;for(const a of i){const l=a.startX*s,u=a.startY*s,c=(a.width+a.glyphWidthEnd)*s;t.push(new xG(l,u+n*s,mSe(c,o),1))}}shapeBackground(t){const i=this._borderLineSizePx||0,r=(fSe+i)/2,s=this._borderLineSizePx?r:0,{xmin:n,ymin:o,xmax:a,ymax:l,x:u,y:c,width:d,height:m}=this.bounds,y=[n-ml,o-ml],g=[a+ml,o-ml],_=[n-ml,l+ml],v=[a+ml,l+ml],b=am([[y[0]-r,y[1]-r],[g[0]+r,g[1]-r],[y[0]+s,y[1]+s],[g[0]-s,g[1]+s]],t),S=am([[_[0]+s,_[1]-s],[v[0]-s,v[1]-s],[_[0]-r,_[1]+r],[v[0]+r,v[1]+r]],t),$=am([[y[0]-r,y[1]-r],[y[0]+s,y[1]+s],[_[0]-r,_[1]+r],[_[0]+s,_[1]-s]],t),E=am([[g[0]-s,g[1]+s],[g[0]+r,g[1]-r],[v[0]-s,v[1]-s],[v[0]+r,v[1]+r]],t),C={main:am([y,g,_,v],t),top:b,bot:S,left:$,right:E};return[new ry(u,c,d+2*r,m+2*r),C]}get boundsT(){const t=this.bounds,i=Jt(sg(),t.x,t.y);if(tr(i,i,this._transform),this._hasRotation){const r=Math.max(t.width,t.height);return new ry(i[0],i[1],r,r)}return new ry(i[0],i[1],t.width,t.height)}_createBounds(t){let i=1/0,r=1/0,s=0,n=0;for(const l of t)i=Math.min(i,l.xTopLeft),r=Math.min(r,l.yTopLeft),s=Math.max(s,l.xBottomRight),n=Math.max(n,l.yBottomRight);const o=s-i,a=n-r;return new ry(i+o/2,r+a/2,o,a)}_createGlyphTransform(t,i){const r=pSe*i.angle,s=Ua(),n=sg();return Fo(s,s,Jt(n,i.xOffset,-i.yOffset)),i.useCIMAngleBehavior?vu(s,s,r):(Fo(s,s,Jt(n,t.x,t.y)),vu(s,s,r),Fo(s,s,Jt(n,-t.x,-t.y))),s}},f_=class{constructor(t,i,r,s,n,o){this.glyphWidthEnd=0,this.startX=0,this.startY=0,this.start=Math.max(0,Math.min(i,r)),this.end=Math.max(0,Math.max(i,r)),this.end<t.length&&(this.glyphWidthEnd=t[this.end].metrics.width),this.width=s,this.yMin=n,this.yMax=o}};const tE=e=>e===10,fN=e=>e===32;function gSe(e,t,i){const r=new Array,s=1/i.scale,n=i.maxLineWidth*s,o=t?e.length-1:0,a=t?-1:e.length,l=t?-1:1;let u=o,c=0,d=0,m=u,y=m,g=0,_=1/0,v=0;for(;u!==a;){const{code:S,metrics:$}=e[u],E=Math.abs($.top);if(tE(S)||fN(S)||(_=Math.min(_,E),v=Math.max(v,E+$.height)),tE(S))u!==o&&(r.push(new f_(e,m,u-l,c,_===1/0?0:_,v)),_=1/0,v=0),c=0,m=u+l,y=u+l,d=0;else if(fN(S))y=u+l,d=0,g=$.advance,c+=$.advance;else if(c>n){if(y!==m){const C=y-2*l;c-=g,r.push(new f_(e,m,C,c-d,_,v)),_=1/0,v=0,m=y,c=d}else r.push(new f_(e,m,u-l,c,_,v)),_=1/0,v=0,m=u,y=u,c=0;c+=$.advance,d+=$.advance}else c+=$.advance,d+=$.advance;u+=l}const b=new f_(e,m,u-l,c,_,v);return b.start>=0&&b.end<e.length&&r.push(b),r}function _Se(e,t){let i=0;for(let n=0;n<e.length;n++){const{width:o}=e[n];i=Math.max(o,i)}const r=t.decoration==="underline"?SG:0,s=e[0].yMin;return{x:0,y:s,height:e[e.length-1].yMax+t.lineHeight*(e.length-1)+r-s,width:i}}function $G(e,t){const i=t.scale,r=new Array,{glyphs:s,isRightToLeft:n}=e,o=gSe(s,n,t),a=o.length?_Se(o,t):{y:0,height:0},l=lSe(t.horizontalAlignment),u=uSe(t.verticalAlignment),c=u===Os.Baseline?1:0,d=c?0:u-1,m=(1-c)*-a.y+d*(a.height/2)+-22*(c?1:0);for(let y=0;y<o.length;y++){const{start:g,end:_,width:v}=o[y];let b=-1*(l+1)*(v/2)-pN;const S=(e.isRightToLeft?o.length-1-y:y)*t.lineHeight+m-pN;o[y].startX=b,o[y].startY=S;for(let $=g;$<=_;$++){const E=s[$];if(tE(E.code))continue;const C=new xG(b+E.metrics.left,S-E.metrics.top,E,i);b+=E.metrics.advance,r.push(C)}}return new ySe(r,o,t)}const HOe=50;function WOe(e){if(!e)return null;const{xmin:t,ymin:i,xmax:r,ymax:s,spatialReference:n}=e;return new mt({rings:[[[t,i],[t,s],[r,s],[r,i],[t,i]]],spatialReference:n})}function MG(e){return We(Math.round(Re(e)))}function TG(e){const t=We(Ude),i=We(jde);return Math.max(t,Math.min(e||i,i))}const Cc=Math.PI/180,EG=.5,sy=()=>H.getLogger("esri.symbols.cim.CIMSymbolDrawHelper");class Pi{constructor(t){this._t=t}static createIdentity(){return new Pi([1,0,0,0,1,0])}clone(){const t=this._t;return new Pi(t.slice())}transform(t){const i=this._t;return[i[0]*t[0]+i[1]*t[1]+i[2],i[3]*t[0]+i[4]*t[1]+i[5]]}static createScale(t,i){return new Pi([t,0,0,0,i,0])}scale(t,i){const r=this._t;return r[0]*=t,r[1]*=t,r[2]*=t,r[3]*=i,r[4]*=i,r[5]*=i,this}scaleRatio(){return Math.sqrt(this._t[0]*this._t[0]+this._t[1]*this._t[1])}static createTranslate(t,i){return new Pi([0,0,t,0,0,i])}translate(t,i){const r=this._t;return r[2]+=t,r[5]+=i,this}static createRotate(t){const i=Math.cos(t),r=Math.sin(t);return new Pi([i,-r,0,r,i,0])}rotate(t){return Pi.multiply(this,Pi.createRotate(t),this)}angle(){const t=this._t[0],i=this._t[3],r=Math.sqrt(t*t+i*i);return[t/r,i/r]}static multiply(t,i,r){const s=t._t,n=i._t,o=s[0]*n[0]+s[3]*n[1],a=s[1]*n[0]+s[4]*n[1],l=s[2]*n[0]+s[5]*n[1]+n[2],u=s[0]*n[3]+s[3]*n[4],c=s[1]*n[3]+s[4]*n[4],d=s[2]*n[3]+s[5]*n[4]+n[5],m=r._t;return m[0]=o,m[1]=a,m[2]=l,m[3]=u,m[4]=c,m[5]=d,r}invert(){const t=this._t;let i=t[0]*t[4]-t[1]*t[3];if(i===0)return new Pi([0,0,0,0,0,0]);i=1/i;const r=(t[1]*t[5]-t[2]*t[4])*i,s=(t[2]*t[3]-t[0]*t[5])*i,n=t[4]*i,o=-t[1]*i,a=-t[3]*i,l=t[0]*i;return new Pi([n,o,r,a,l,s])}}class QP{constructor(t,i){this._resourceManager=t,this._transfos=[],this._sizeTransfos=[],this._geomUnitsPerPoint=1,this._placementPool=new _h(Sf,void 0,void 0,100),this._earlyReturn=!1,this._mapRotation=0,this._transfos.push(i||Pi.createIdentity()),this._sizeTransfos.push(i?i.scaleRatio():1)}setTransform(t,i){this._transfos=[t||Pi.createIdentity()],this._sizeTransfos=[i||(t?t.scaleRatio():1)]}setGeomUnitsPerPoint(t){this._geomUnitsPerPoint=t}transformPt(t){return this._transfos[this._transfos.length-1].transform(t)}transformSize(t){return t*this._sizeTransfos[this._sizeTransfos.length-1]}reverseTransformPt(t){return this._transfos[this._transfos.length-1].invert().transform(t)}reverseTransformSize(t){return t/this._sizeTransfos[this._sizeTransfos.length-1]}reverseTransformScalar(t){return t/this._transfos[this._transfos.length-1].scaleRatio()}getTransformAngle(){return this._transfos[this._transfos.length-1].angle()}geomUnitsPerPoint(){return this.isEmbedded()?1:this._geomUnitsPerPoint}prevGeomUnitsPerPoint(){return this._transfos.length>2?1:this._geomUnitsPerPoint}isEmbedded(){return this._transfos.length>1}back(){return this._transfos[this._transfos.length-1]}push(t,i){const r=i?t.scaleRatio():1;Pi.multiply(t,this.back(),t),this._transfos.push(t),this._sizeTransfos.push(this._sizeTransfos[this._sizeTransfos.length-1]*r)}pop(){this._transfos.splice(-1,1),this._sizeTransfos.splice(-1,1)}drawSymbol(t,i,r){if(t)switch(t.type){case"CIMPointSymbol":case"CIMLineSymbol":case"CIMPolygonSymbol":this.drawMultiLayerSymbol(t,i);break;case"CIMTextSymbol":this.drawTextSymbol(t,i,r)}}drawMultiLayerSymbol(t,i){if(!t||!i)return;const r=t.symbolLayers;if(!r)return;const s=t.effects;if(s&&s.length>0){const n=this.executeEffects(s,i);if(n){let o=n.next();for(;o;)this.drawSymbolLayers(r,o.asJSON()),o=n.next()}}else this.drawSymbolLayers(r,i)}executeEffects(t,i){const r=this._resourceManager.geometryEngine;let s=new xwe(Ze.fromJSONCIM(i));for(const n of t){const o=j2e(n);o&&(s=o.execute(s,n,this.geomUnitsPerPoint(),null,r))}return s}drawSymbolLayers(t,i){let r=t.length;for(;r--;){const s=t[r];if(!s||s.enable===!1)continue;const n=s.effects;if(n&&n.length>0){const o=this.executeEffects(n,i);if(o){let a=null;for(;(a=o.next())&&(this.drawSymbolLayer(s,a.asJSON()),!this._earlyReturn););}}else this.drawSymbolLayer(s,i);if(this._earlyReturn)return}}drawSymbolLayer(t,i){switch(t.type){case"CIMSolidFill":this.drawSolidFill(i,t.color,t.path);break;case"CIMHatchFill":this.drawHatchFill(i,t);break;case"CIMPictureFill":this.drawPictureFill(i,t);break;case"CIMGradientFill":this.drawGradientFill(i,t);break;case"CIMSolidStroke":this.drawSolidStroke(i,t.color,t.width,t.capStyle,t.joinStyle,t.miterLimit,t.path);break;case"CIMPictureStroke":this.drawPictureStroke(i,t);break;case"CIMGradientStroke":this.drawGradientStroke(i,t);break;case"CIMCharacterMarker":case"CIMPictureMarker":case"CIMVectorMarker":this.drawMarkerLayer(t,i)}}drawHatchFill(t,i){const r=bSe(i,t,this.geomUnitsPerPoint());r&&(this.pushClipPath(t),this.drawMultiLayerSymbol(i.lineSymbol,r),this.popClipPath())}drawPictureFill(t,i){}drawGradientFill(t,i){}drawPictureStroke(t,i){}drawGradientStroke(t,i){}drawMarkerLayer(t,i){const r=t.markerPlacement;if(r){const s=G2e(r);if(s){const n=r.type==="CIMMarkerPlacementInsidePolygon"||r.type==="CIMMarkerPlacementPolygonCenter"&&r.clipAtBoundary;n&&this.pushClipPath(i);const o=s.execute(Ze.fromJSONCIM(i),r,this.geomUnitsPerPoint(),null,this._resourceManager.geometryEngine);if(o){let a=null;for(;(a=o.next())&&(this.drawMarker(t,a),!this._earlyReturn););}n&&this.popClipPath()}}else{const s=this._placementPool.acquire();if(Wy(i))s.tx=i.x,s.ty=i.y,this.drawMarker(t,s);else if(gi(i)){const n=L6(i);n&&([s.tx,s.ty]=n,this.drawMarker(t,s))}else if(Vi(i)){for(const n of i.paths)for(const o of n)if(s.tx=o[0],s.ty=o[1],this.drawMarker(t,s),this._earlyReturn)break}else for(const n of i.points)if(s.tx=n[0],s.ty=n[1],this.drawMarker(t,s),this._earlyReturn)break;this._placementPool.release(s)}}drawMarker(t,i){switch(t.type){case"CIMCharacterMarker":case"CIMPictureMarker":this.drawPictureMarker(t,i);break;case"CIMVectorMarker":this.drawVectorMarker(t,i)}}drawPictureMarker(t,i){if(!t)return;const r=this._resourceManager.getResource(t.url),s=be(t.size,ti.CIMPictureMarker.size);if(r==null||s<=0)return;const n=r.width,o=r.height;if(!n||!o)return;const a=n/o,l=be(t.scaleX,1),u=Pi.createIdentity(),c=t.anchorPoint;if(c){let v=c.x,b=c.y;t.anchorPointUnits!=="Absolute"&&(v*=s*a*l,b*=s),u.translate(-v,-b)}let d=be(t.rotation);t.rotateClockwise&&(d=-d),this._mapRotation&&(d+=this._mapRotation),d&&u.rotate(d*Cc);let m=be(t.offsetX),y=be(t.offsetY);if(m||y){if(this._mapRotation){const v=Cc*this._mapRotation,b=Math.cos(v),S=Math.sin(v),$=m*S+y*b;m=m*b-y*S,y=$}u.translate(m,y)}const g=this.geomUnitsPerPoint();g!==1&&u.scale(g,g);const _=i.getAngle();_&&u.rotate(_),u.translate(i.tx,i.ty),this.push(u,!1),this.drawImage(t,s),this.pop()}drawVectorMarker(t,i){if(!t)return;const r=t.markerGraphics;if(!r)return;const s=be(t.size,ti.CIMVectorMarker.size),n=t.frame,o=n?n.ymax-n.ymin:0,a=s&&o?s/o:1,l=Pi.createIdentity();n&&l.translate(.5*-(n.xmax+n.xmin),.5*-(n.ymax+n.ymin));const u=t.anchorPoint;if(u){let _=u.x,v=u.y;t.anchorPointUnits!=="Absolute"?n&&(_*=n.xmax-n.xmin,v*=n.ymax-n.ymin):(_/=a,v/=a),l.translate(-_,-v)}a!==1&&l.scale(a,a);let c=be(t.rotation);t.rotateClockwise&&(c=-c),this._mapRotation&&(c+=this._mapRotation),c&&l.rotate(c*Cc);let d=be(t.offsetX),m=be(t.offsetY);if(d||m){if(this._mapRotation){const _=Cc*this._mapRotation,v=Math.cos(_),b=Math.sin(_),S=d*b+m*v;d=d*v-m*b,m=S}l.translate(d,m)}const y=this.geomUnitsPerPoint();y!==1&&l.scale(y,y);const g=i.getAngle();g&&l.rotate(g),l.translate(i.tx,i.ty),this.push(l,t.scaleSymbolsProportionally);for(const _ of r){_?.symbol&&_.geometry||sy().error("Invalid marker graphic",_);let v=_.textString;if(typeof v=="number"&&(v=v.toString()),this.drawSymbol(_.symbol,_.geometry,v),this._earlyReturn)break}this.pop()}drawTextSymbol(t,i,r){if(!t||!Wy(i)||be(t.height,ti.CIMTextSymbol.height)<=0)return;const s=Pi.createIdentity();let n=be(t.angle);n=-n,n&&s.rotate(n*Cc);const o=be(t.offsetX),a=be(t.offsetY);(o||a)&&s.translate(o,a);const l=this.geomUnitsPerPoint();l!==1&&s.scale(l,l),s.translate(i.x,i.y),this.push(s,!1),this.drawText(t,r),this.pop()}}class vSe extends QP{constructor(t,i){super(t,i),this.reset()}reset(){this._xmin=this._ymin=1/0,this._xmax=this._ymax=-1/0,this._clipCount=0}envelope(){return new iSe(this._xmin,this._ymin,this._xmax-this._xmin,this._ymax-this._ymin)}bounds(){return qQ(this._xmin,this._ymin,this._xmax,this._ymax)}drawSolidFill(t){if(t&&!(this._clipCount>0))if(gi(t))this._processPath(t.rings,0);else if(Vi(t))this._processPath(t.paths,0);else if(wr(t)){const i=Ea(t);i&&this._processPath(i.rings,0)}else console.error("drawSolidFill Unexpected geometry type!")}drawSolidStroke(t,i,r){if(!t||this._clipCount>0||r==null||r<=0)return;const s=Math.max(.5*this.transformSize(be(r,ti.CIMSolidStroke.width)),.5*EG);if(gi(t))this._processPath(t.rings,s);else if(Vi(t))this._processPath(t.paths,s);else if(wr(t)){const n=Ea(t);n&&this._processPath(n.rings,s)}else console.error("drawSolidStroke unexpected geometry type!")}drawMarkerLayer(t,i){gi(i)&&t.markerPlacement&&(t.markerPlacement.type==="CIMMarkerPlacementInsidePolygon"||t.markerPlacement.type==="CIMMarkerPlacementPolygonCenter"&&t.markerPlacement.clipAtBoundary)?this._processPath(i.rings,0):super.drawMarkerLayer(t,i)}drawHatchFill(t,i){this.drawSolidFill(t)}drawPictureFill(t,i){this.drawSolidFill(t)}drawGradientFill(t,i){this.drawSolidFill(t)}drawPictureStroke(t,i){this.drawSolidStroke(t,null,i.width)}drawGradientStroke(t,i){this.drawSolidStroke(t,null,i.width)}pushClipPath(t){this.drawSolidFill(t),this._clipCount++}popClipPath(){this._clipCount--}drawImage(t,i){const{url:r}=t,s=be(t.scaleX,1);let n=s*i,o=i;const a=this._resourceManager.getResource(r);if(a!=null){const l=a.height/a.width;n=s*(i?l>1?i:i/l:a.width),o=i?l>1?i*l:i:a.height}this._merge(this.transformPt([-n/2,-o/2]),0),this._merge(this.transformPt([-n/2,o/2]),0),this._merge(this.transformPt([n/2,-o/2]),0),this._merge(this.transformPt([n/2,o/2]),0)}drawText(t,i){if(!i||i.length===0)return;this._textRasterizer||(this._textRasterizer=new vG);const r=IG(t);let[s,n]=this._textRasterizer.computeTextSize(i,r);s=We(s),n=We(n);const o=this.transformSize(1)*this.reverseTransformScalar(1);s*=o,n*=o;let a=0;switch(t.horizontalAlignment){case"Left":a=s/2;break;case"Right":a=-s/2}let l=0;switch(t.verticalAlignment){case"Bottom":l=n/2;break;case"Top":l=-n/2;break;case"Baseline":l=n/6}this._merge(this.transformPt([-s/2+a,-n/2+l]),0),this._merge(this.transformPt([-s/2+a,n/2+l]),0),this._merge(this.transformPt([s/2+a,-n/2+l]),0),this._merge(this.transformPt([s/2+a,n/2+l]),0)}_processPath(t,i){if(t)for(const r of t){const s=r?r.length:0;if(s>1){this._merge(this.transformPt(r[0]),i);for(let n=1;n<s;n++)this._merge(this.transformPt(r[n]),i)}}}_merge(t,i){t[0]-i<this._xmin&&(this._xmin=t[0]-i),t[0]+i>this._xmax&&(this._xmax=t[0]+i),t[1]-i<this._ymin&&(this._ymin=t[1]-i),t[1]+i>this._ymax&&(this._ymax=t[1]+i)}}class ZOe extends QP{constructor(){super(...arguments),this._searchPoint=[0,0],this._searchDistPoint=0,this._textInfo=null,this._svg=null,this._path=null,this._canvas=null}destroy(){this._svg=oSe(this._svg),this._path=null,this._canvas=null}hitTest(t,i,r,s,n,o){const a=o*Re(1);this.setTransform(),this.setGeomUnitsPerPoint(a),this._searchPoint=[(t[0]+t[2])/2,(t[1]+t[3])/2],this._searchDistPoint=(t[2]-t[0])/2/a,this._textInfo=s;const l=i&&(i.type==="CIMPointSymbol"&&i.angleAlignment!=="Map"||i.type==="CIMTextSymbol");if(this._mapRotation=l?n:0,!N("esri-mobile")){const u=We(Nde*window.devicePixelRatio),c=We(Dde);!((i?.type==="CIMLineSymbol"||i?.type==="CIMPolygonSymbol")&&i.symbolLayers?.some(A0e))&&i?.type!=="CIMMeshSymbol"&&(G0e(i)??0)<c&&(this._searchDistPoint=u)}return this._earlyReturn=!1,this.drawSymbol(i,r),this._earlyReturn}executeEffects(t,i){return t.at(-1)?.type==="CIMGeometricEffectDashes"&&(t=t.slice(0,-1)),super.executeEffects(t,i)}drawSolidFill(t,i,r){r!=null?this._hittestSvgPath(t,r,!0):this._hitTestFill(t)}drawHatchFill(t,i){this._hitTestFill(t)}drawPictureFill(t,i){this._hitTestFill(t)}drawGradientFill(t,i){this._hitTestFill(t)}drawSolidStroke(t,i,r,s,n,o,a){a!=null?this._hittestSvgPath(t,a,!1,r):this._hitTestStroke(t,r)}drawPictureStroke(t,i){this._hitTestStroke(t,i.width)}drawGradientStroke(t,i){this._hitTestStroke(t,i.width)}drawMarkerLayer(t,i){t.markerPlacement&&(t.markerPlacement.type==="CIMMarkerPlacementInsidePolygon"||t.markerPlacement.type==="CIMMarkerPlacementPolygonCenter"&&t.markerPlacement.clipAtBoundary)?this._hitTestFill(i):super.drawMarkerLayer(t,i)}pushClipPath(t){}popClipPath(){}drawImage(t,i){const{url:r}=t,s=be(t.scaleX,1),n=this._resourceManager.getResource(r);if(n==null||n.height===0||i===0)return;const o=i*this.geomUnitsPerPoint(),a=o*s*(n.width/n.height),l=this.reverseTransformPt(this._searchPoint),u=this._searchDistPoint;Math.abs(l[0])<a/2+u&&Math.abs(l[1])<o/2+u&&(this._earlyReturn=!0)}drawText(t,i){const r=this._textInfo;if(!r)return;const s=r.get(t);if(!s||!s.glyphMosaicItems.glyphs.length)return;const n=MG(be(t.height,ti.CIMTextSymbol.height)),{lineGapType:o,lineGap:a}=t,l=o?PG(o,be(a),n):0,u=t.callout?.type==="CIMBackgroundCallout",c=$G(s.glyphMosaicItems,{scale:n/RU,angle:0,xOffset:0,yOffset:0,horizontalAlignment:t.horizontalAlignment,verticalAlignment:t.verticalAlignment,maxLineWidth:TG(t.lineWidth),lineHeight:kU*Math.max(.25,Math.min(l||1,4)),decoration:t.font.decoration||"none",useCIMAngleBehavior:!0,hasBackground:u}),d=this.reverseTransformPt(this._searchPoint),m=d[0],y=d[1];for(const g of c.glyphs)if(m>g.xTopLeft&&m<g.xBottomRight&&y>-g.yBottomRight&&y<-g.yTopLeft){this._earlyReturn=!0;break}}_hitTestFill(t){let i=null;if(wr(t)){const s=t;i=[[[s.xmin,s.ymin],[s.xmin,s.ymax],[s.xmax,s.ymax],[s.xmax,s.ymin],[s.xmin,s.ymin]]]}else if(gi(t))i=t.rings;else{if(!Vi(t))return;i=t.paths}const r=this.reverseTransformPt(this._searchPoint);wSe(r,i)&&(this._earlyReturn=!0),!this._earlyReturn&&mN(r,i,this.reverseTransformScalar(this._searchDistPoint)*this.prevGeomUnitsPerPoint())&&(this._earlyReturn=!0)}_getSvgPath(){return this._svg!=null&&this._path!=null||(this._svg??=nSe(),this._path??=bG("path"),this._svg.appendChild(this._path)),this._path}_getCanvasContext(t,i){return this._canvas??=document.createElement("canvas"),this._canvas.width=t,this._canvas.height=i,this._canvas.getContext("2d",{willReadFrequently:!0})}_hittestSvgPath(t,i,r,s=0){const n=this.reverseTransformScalar(this._searchDistPoint)*this.prevGeomUnitsPerPoint(),o=this.reverseTransformPt(this._searchPoint),a=Qt();MC(a,t);const l={x:a[0],y:a[1],width:a[2]-a[0],height:a[3]-a[1]},u=this._getSvgPath();u.setAttribute("d",i);const c=u.getBBox();let d=Math.max(c.width/l.width,c.height/l.height),m=1;const y=2*n*d;y<1&&(m=2/y,d*=m,c.x*=m,c.y*=m,c.width*=m,c.height*=m);const g=1+s*d/2,_=this._getCanvasContext(c.width+2*g,c.height+2*g);_.setTransform(m,0,0,m,-c.x+g,-c.y+g);const v=new Path2D(i);r?_.fill(v):(_.lineWidth=s*(d/m),_.stroke(v));const b=(l.width*d-c.width)/2,S=(l.height*d-c.height)/2,$=Math.floor((o[0]-l.x-n)*d-b+g),E=Math.floor((l.height-(o[1]-l.y)-n)*d+S+g),C=Math.ceil(2*n*d),P=Math.ceil(2*n*d),k=_.getImageData($,E,C,P).data;for(let F=3;F<k.length;F+=4)if(k[F]>127.5)return void(this._earlyReturn=!0)}_hitTestStroke(t,i){let r=null;if(wr(t)){const s=t;r=[[[s.xmin,s.ymin],[s.xmin,s.ymax],[s.xmax,s.ymax],[s.xmax,s.ymin],[s.xmin,s.ymin]]]}else if(gi(t))r=t.rings;else{if(!Vi(t))return;r=t.paths}mN(this.reverseTransformPt(this._searchPoint),r,be(i,ti.CIMSolidStroke.width)*this.geomUnitsPerPoint()/2+this.reverseTransformScalar(this._searchDistPoint)*this.prevGeomUnitsPerPoint())&&(this._earlyReturn=!0)}}class CG extends QP{constructor(t,i,r,s){super(i,r),this._applyAdditionalRenderProps=s,this._colorSubstitutionHelper=new $we,this._ctx=t}drawSolidFill(t,i){if(!t)return;if(gi(t))this._buildPath(t.rings,!0);else if(Vi(t))this._buildPath(t.paths,!0);else if(wr(t))this._buildPath(Ea(t).rings,!0);else{if(!op(t))return;console.log("CanvasDrawHelper.drawSolidFill - No implementation!")}const r=this._ctx;r.fillStyle=typeof i=="string"?i:"rgba("+Math.round(i[0])+","+Math.round(i[1])+","+Math.round(i[2])+","+(i[3]??255)/255+")",r.fill("evenodd")}drawSolidStroke(t,i,r,s,n,o){if(!t||!i||r===0)return;if(gi(t))this._buildPath(t.rings,!0);else if(Vi(t))this._buildPath(t.paths,!1);else{if(!wr(t))return void console.log("CanvasDrawHelper.drawSolidStroke isn't implemented!");this._buildPath(Ea(t).rings,!0)}const a=this._ctx;a.strokeStyle=typeof i=="string"?i:"rgba("+Math.round(i[0])+","+Math.round(i[1])+","+Math.round(i[2])+","+(i[3]??255)/255+")",a.lineWidth=Math.max(this.transformSize(r),EG),this._setCapStyle(s),this._setJoinStyle(n),a.miterLimit=o,a.stroke()}pushClipPath(t){if(this._ctx.save(),gi(t))this._buildPath(t.rings,!0);else if(Vi(t))this._buildPath(t.paths,!0);else{if(!wr(t))return;this._buildPath(Ea(t).rings,!0)}this._ctx.clip("evenodd")}popClipPath(){this._ctx.restore()}drawImage(t,i){const{colorSubstitutions:r,url:s,tintColor:n}=t,o=be(t.scaleX,1),a=this._resourceManager.getResource(s);if(a==null)return;let l=i*(a.width/a.height),u=i;i||(l=a.width,u=a.height);const c=Zh(s)||"src"in a&&Zh(a.src);let d="getFrame"in a?bS(a):a;r&&(d=this._colorSubstitutionHelper.applyColorSubstitution(d,r)),this._applyAdditionalRenderProps&&!c&&n&&(d=this._colorSubstitutionHelper.tintImageData(d,n));const m=this.transformPt([0,0]),[y,g]=this.getTransformAngle(),_=this.transformSize(1),v=this._ctx;v.save(),v.setTransform({m11:o*_*y,m12:o*_*g,m21:-_*g,m22:_*y,m41:m[0],m42:m[1]}),v.drawImage(d,-l/2,-u/2,l,u),v.restore()}drawText(t,i){if(!i||i.length===0)return;this._textRasterizer||(this._textRasterizer=new vG);const r=IG(t,this.transformSize(We(1))),s=this._textRasterizer.rasterizeText(i,r);if(!s)return;const{size:n,anchorX:o,anchorY:a,canvas:l}=s,u=n[0]*(o+.5),c=n[1]*(a-.5),d=this._ctx,m=this.transformPt([0,0]),[y,g]=this.getTransformAngle(),_=1;d.save(),d.setTransform({m11:_*y,m12:_*g,m21:-1*g,m22:_*y,m41:m[0]-_*u,m42:m[1]+_*c}),d.drawImage(l,0,0),d.restore()}drawPictureFill(t,i){if(!t)return;let{colorSubstitutions:r,height:s,offsetX:n,offsetY:o,rotation:a,scaleX:l,tintColor:u,url:c}=i;const d=this._resourceManager.getResource(c);if(d==null)return;if(gi(t))this._buildPath(t.rings,!0);else if(Vi(t))this._buildPath(t.paths,!0);else if(wr(t))this._buildPath(Ea(t).rings,!0);else{if(!op(t))return;console.log("CanvasDrawHelper.drawPictureFill - No implementation!")}const m=this._ctx,y=Zh(c)||"src"in d&&Zh(d.src);let g,_="getFrame"in d?bS(d):d;if(r&&(_=this._colorSubstitutionHelper.applyColorSubstitution(_,r)),this._applyAdditionalRenderProps){y||u&&(_=this._colorSubstitutionHelper.tintImageData(_,u)),g=m.createPattern(_,"repeat");const v=this.transformSize(1);a||(a=0),n?n*=v:n=0,o?o*=v:o=0,s&&(s*=v);const b=s?s/d.height:1,S=l&&s?l*s/d.width:1;if(a!==0||b!==1||S!==1||n!==0||o!==0){const $=new DOMMatrix;$.rotateSelf(0,0,-a).translateSelf(n,o).scaleSelf(S,b,1),g.setTransform($)}}else g=m.createPattern(_,"repeat");m.save(),m.fillStyle=g,m.fill("evenodd"),m.restore()}drawPictureStroke(t,i){if(!t)return;let{colorSubstitutions:r,capStyle:s,joinStyle:n,miterLimit:o,tintColor:a,url:l,width:u}=i;const c=this._resourceManager.getResource(l);if(c==null)return;let d;if(gi(t))d=t.rings;else if(Vi(t))d=t.paths;else{if(!wr(t))return op(t)?void console.log("CanvasDrawHelper.drawPictureStroke - No implementation!"):void 0;d=Ea(t).rings}u||(u=c.width);const m=Zh(l)||"src"in c&&Zh(c.src);let y="getFrame"in c?bS(c):c;r&&(y=this._colorSubstitutionHelper.applyColorSubstitution(y,r)),this._applyAdditionalRenderProps&&(m||a&&(y=this._colorSubstitutionHelper.tintImageData(y,a)));const g=Math.max(this.transformSize(Re(u)),.5),_=g/y.width,v=this._ctx,b=v.createPattern(y,"repeat-y");let S,$;v.save(),this._setCapStyle(s),this._setJoinStyle(n),o!==void 0&&(v.miterLimit=o),v.lineWidth=g;for(let E of d)if(E=V(E),yN(E),E&&!(E.length<=1)){S=this.transformPt(E[0]);for(let C=1;C<E.length;C++){$=this.transformPt(E[C]);const P=SSe(S,$),k=new DOMMatrix;k.translateSelf(0,S[1]-g/2).scaleSelf(_,_,1).rotateSelf(0,0,90-P),b.setTransform(k),v.strokeStyle=b,v.beginPath(),v.moveTo(S[0],S[1]),v.lineTo($[0],$[1]),v.stroke(),S=$}}v.restore()}drawGradientFill(t,i){if(!t)return;let r;if(gi(t))r=t.rings;else if(Vi(t))r=t.paths;else{if(!wr(t))return void sy().error("Unable to draw gradient fill");r=Ea(t).rings}this._buildPath(r,!0);const{angle:s,gradientMethod:n,gradientSize:o,gradientSizeUnits:a}=i,l=ti.CIMGradientFill,u=i.gradientType??l.gradientType,c=-mf(s??0),d=JQ();for(const b of r){const S=b?b.length:0;if(S>1)for(let $=0;$<S;$++){let E=this.transformPt(b[$]);n!=="Linear"&&n!=="Rectangular"||(E=ia(E,-c)),vm(d,E)}}const[m,y,g,_]=d,v=this._ctx;switch(v.save(),n){case"Buffered":sy().error(`Gradient method "${n}" currently unsupported.`);break;case"Linear":{const b=(y+_)/2,S=a==="Absolute"?this.transformSize(Re(o)):em(o,l.gradientSize)*(g-m),[$,E]=u==="Discrete"?[g,g-S]:[m+S,m],C=ia([$,b],c),P=ia([E,b],c),k=v.createLinearGradient(C[0],C[1],P[0],P[1]);d_(k,i),v.fillStyle=k,v.fill("evenodd");break}case"Circular":{const b=_A(d),S=WQ(d)/2,$=a==="Absolute"?this.transformSize(Re(o)):em(o,l.gradientSize)*S,[E,C]=u==="Discrete"?[S,S-$]:[$,0],P=v.createRadialGradient(b[0],b[1],E,b[0],b[1],C);d_(P,i),v.fillStyle=P,v.fill("evenodd");break}case"Rectangular":{const b=_A(d),S=b[0],$=b[1],E=ia(b,c),C=(W,Y,re,K,Ce,Ve,Je,Oe)=>{v.save(),this.pushClipPath(t);const Lt=ia([Ce,Ve],c),Dn=ia([Je,Oe],c);v.beginPath(),v.moveTo(E[0],E[1]),v.lineTo(Lt[0],Lt[1]),v.lineTo(Dn[0],Dn[1]),v.lineTo(E[0],E[1]),v.clip();const Cr=ia([W,Y],c),Fn=ia([re,K],c),Ho=v.createLinearGradient(Cr[0],Cr[1],Fn[0],Fn[1]);d_(Ho,i),v.fillStyle=Ho,v.fill("evenodd"),v.restore()};let P=a==="Absolute"?this.transformSize(Re(o)):em(o,l.gradientSize)*(Kb(d)/2),[k,F]=u==="Discrete"?[g,g-P]:[S+P,S];C(k,$,F,$,g,y,g,_),[k,F]=u==="Discrete"?[m,m+P]:[S-P,S],C(k,$,F,$,m,_,m,y),P=a==="Absolute"?this.transformSize(Re(o)):em(o,l.gradientSize)*(Qb(d)/2);let[D,U]=u==="Discrete"?[_,_-P]:[$+P,$];C(S,D,S,U,g,_,m,_),[D,U]=u==="Discrete"?[y,y+P]:[$-P,$],C(S,D,S,U,m,y,g,y);break}}v.restore()}drawGradientStroke(t,i){const{capStyle:r,gradientMethod:s,gradientSize:n,gradientSizeUnits:o,joinStyle:a,miterLimit:l,width:u}=i;if(!t||u===0)return;let c;if(gi(t))c=t.rings;else if(Vi(t))c=t.paths;else{if(!wr(t))return void sy().error("Unable to draw gradient stroke");c=Ea(t).rings}const d=i.gradientType??ti.CIMGradientStroke.gradientType,m=Math.max(this.transformSize(Re(u)),.5),y=this._ctx;let g,_;y.save(),this._setCapStyle(r),this._setJoinStyle(a),l!==void 0&&(y.miterLimit=l),y.lineWidth=m;for(let v of c){if(v=V(v),yN(v),!v||v.length<=1)continue;let b=0;g=this.transformPt(v[0]);for(let E=1;E<v.length;E++){_=this.transformPt(v[E]);const C=_[0]-g[0],P=_[1]-g[1];b+=Math.sqrt(C*C+P*P),g=_}const S=o==="Absolute"?this.transformSize(Re(n)):em(n,ti.CIMGradientStroke.gradientSize)*(s==="AcrossLine"?m:b);let $=0;g=this.transformPt(v[0]);for(let E=1;E<v.length;E++){_=this.transformPt(v[E]);const C=_[0]-g[0],P=_[1]-g[1],k=Math.sqrt(C*C+P*P);let F,D,U,W;switch(s){case"AcrossLine":{const[re,K]=ia([C/k,P/k],-Math.PI/2),Ce=m/2,Ve=d==="Discrete"?Ce:S-Ce;F=(g[0]+_[0])/2+re*Ve,D=(g[1]+_[1])/2+K*Ve,U=F-re*S,W=D-K*S;break}case"AlongLine":{const re=C/k,K=P/k;d==="Discrete"?(F=g[0]-re*$,D=g[1]-K*$,U=F+re*S,W=D+K*S):(U=g[0]+re*(b-$),W=g[1]+K*(b-$),F=U-re*S,D=W-K*S);break}default:return sy().error("Unrecognized gradient method:",s),void y.restore()}const Y=y.createLinearGradient(F,D,U,W);d_(Y,i),y.strokeStyle=Y,y.beginPath(),y.moveTo(g[0],g[1]),y.lineTo(_[0],_[1]),y.stroke(),$+=k,g=_}}y.restore()}_buildPath(t,i){const r=this._ctx;if(r.beginPath(),t)for(const s of t){const n=s?s.length:0;if(n>1){let o=this.transformPt(s[0]);r.moveTo(o[0],o[1]);for(let a=1;a<n;a++)o=this.transformPt(s[a]),r.lineTo(o[0],o[1]);i&&r.closePath()}}}_setCapStyle(t){switch(t){case Br.Butt:this._ctx.lineCap="butt";break;case Br.Round:this._ctx.lineCap="round";break;case Br.Square:this._ctx.lineCap="square"}}_setJoinStyle(t){switch(t){case Vs.Bevel:this._ctx.lineJoin="bevel";break;case Vs.Round:this._ctx.lineJoin="round";break;case Vs.Miter:this._ctx.lineJoin="miter"}}}function bSe(e,t,i){let r=be(e.separation,ti.CIMHatchFill.separation)*i,s=be(e.rotation);if(r===0)return null;r<0&&(r=-r);let n=0;const o=.5*r;for(;n>o;)n-=r;for(;n<-o;)n+=r;const a=Qt();MC(a,t),a[0]-=o,a[1]-=o,a[2]+=o,a[3]+=o;const l=[[a[0],a[1]],[a[0],a[3]],[a[2],a[3]],[a[2],a[1]]];for(;s>180;)s-=180;for(;s<0;)s+=180;const u=Math.cos(s*Cc),c=Math.sin(s*Cc),d=-r*c,m=r*u;let y,g,_,v;n=be(e.offsetX)*i*c-be(e.offsetY)*i*u,y=_=Number.MAX_VALUE,g=v=-Number.MAX_VALUE;for(const k of l){const F=k[0],D=k[1],U=u*F+c*D,W=-c*F+u*D;y=Math.min(y,U),_=Math.min(_,W),g=Math.max(g,U),v=Math.max(v,W)}_=Math.floor(_/r)*r;let b=u*y-c*_-d*n/r,S=c*y+u*_-m*n/r,$=u*g-c*_-d*n/r,E=c*g+u*_-m*n/r;const C=1+Math.round((v-_)/r),P=[];for(let k=0;k<C;k++)b+=d,S+=m,$+=d,E+=m,P.push([[b,S],[$,E]]);return{paths:P}}function wSe(e,t){let i=0;for(const r of t){const s=r.length;for(let n=1;n<s;n++){const o=r[n-1],a=r[n];o[1]>e[1]!=a[1]>e[1]&&((a[0]-o[0])*(e[1]-o[1])-(a[1]-o[1])*(e[0]-o[0])>0?i++:i--)}}return i!==0}function mN(e,t,i){for(const r of t){const s=r.length;for(let n=1;n<s;n++){const o=r[n-1],a=r[n];let l=(a[0]-o[0])*(a[0]-o[0])+(a[1]-o[1])*(a[1]-o[1]);if(l===0)continue;l=Math.sqrt(l);const u=((a[0]-o[0])*(e[1]-o[1])-(a[1]-o[1])*(e[0]-o[0]))/l;if(Math.abs(u)<i){const c=((a[0]-o[0])*(e[0]-o[0])+(a[1]-o[1])*(e[1]-o[1]))/l;if(c>-i&&c<l+i)return!0}}}return!1}function SSe(e,t){const i=t[0]-e[0],r=t[1]-e[1];return 180/Math.PI*Math.atan2(r,i)}const Ea=e=>e?{spatialReference:e.spatialReference,rings:[[[e.xmin,e.ymin],[e.xmin,e.ymax],[e.xmax,e.ymax],[e.xmax,e.ymin],[e.xmin,e.ymin]]]}:null,PG=(e,t,i)=>{switch(e){case"ExtraLeading":return 1+t/i;case"Multiple":return t;case"Exact":return t/i}};function IG(e,t=1){const i=j7(e),r=U7(e.fontStyleName),s=e.fontFamilyName??WP,{weight:n,style:o}=r,a=t*(e.height||5),l=N0e(e.horizontalAlignment),u=D0e(e.verticalAlignment),c=Ry(e),d=Ry(e.haloSymbol),m=d!=null?t*(e.haloSize??0):0,y=pb(e.symbol),g=t*(fb(e.symbol)||0),_=e.callout?.type==="CIMBackgroundCallout"?e.callout.backgroundSymbol:null,v=Ry(_),b=fb(_),S=pb(_);return{color:c,size:a,horizontalAlignment:l,verticalAlignment:u,font:{family:s,style:R0e(o),weight:O0e(n),decoration:i},outline:{size:g||0,color:y},halo:{size:m||0,color:d,style:o},backgroundColor:v,borderLine:b!=null&&S!=null?{size:b,color:S}:null,pixelRatio:1,premultiplyColors:!0}}const xSe=1e-4;function yN(e){let t,i,r,s,n,o=e[0],a=1;for(;a<e.length;)t=e[a][0]-o[0],i=e[a][1]-o[1],s=t!==0?i/t:Math.PI/2,r!==void 0&&Math.abs(s-r)<=xSe?(e.splice(a-1,1),o=n):(n=o,o=e[a],a++),r=s}const m_=Number.POSITIVE_INFINITY,eI=Math.PI,YOe=2*eI,$Se=128/eI,MSe=256/360,JOe=eI/180,TSe=1/Math.LN2;function AG(e,t){return(e%=t)>=0?e:e+t}function XOe(e){return AG(e*$Se,256)}function KOe(e){return AG(e*MSe,256)}function QOe(e){return Math.log(e)*TSe}function e5e(e,t,i){return e*(1-i)+t*i}const ESe=8,CSe=14,PSe=16;function t5e(e){return ESe+Math.max((e-CSe)*PSe,0)}function i5e(e,t,i){let r,s,n,o=0;for(const a of i){r=a.length;for(let l=1;l<r;++l)s=a[l-1],n=a[l],s.y>t!=n.y>t&&((n.x-s.x)*(t-s.y)-(n.y-s.y)*(e-s.x)>0?o++:o--)}return o!==0}function r5e(e,t,i,r){let s,n,o,a;const l=r*r;for(const u of i){const c=u.length;if(!(c<2)){s=u[0].x,n=u[0].y;for(let d=1;d<c;++d){if(o=u[d].x,a=u[d].y,IQ(e,t,s,n,o,a)<l)return!0;s=o,n=a}}}return!1}function s5e(e,t,i,r,s,n,o){const a=Math.max(r,Math.min(t,n))-t,l=Math.max(s,Math.min(i,o))-i;return a*a+l*l<=e*e}function n5e(e,t){if(t===0||Number.isNaN(t))return e;const i=[],r=new Le(0,0),s=new Le(0,0),n=new Le(0,0);for(let o=0;o<e.length;o++){const a=e[o],l=[];for(let u=0;u<a.length;u++){const c=a[u-1],d=a[u],m=a[u+1];u===0?r.setCoords(0,0):r.assignSub(d,c).normalize().rightPerpendicular(),u===a.length-1?s.setCoords(0,0):s.assignSub(m,d).normalize().rightPerpendicular(),n.assignAdd(r,s).normalize();const y=n.x*s.x+n.y*s.y;y!==0&&n.scale(1/y),l.push(Le.add(d,n.scale(t)))}i.push(l)}return i}function o5e(e,t,i,r){const s=new Le(e[0],e[1]);if(s.scale(r),t==="viewport"){const n=-i*(Math.PI/180),o=Math.cos(n),a=Math.sin(n);s.rotate(o,a)}return s}const LG=Math.PI,ISe=LG/2,gN=Math.PI/180,xS=96/72,ASe=1.4142135623730951,_N=2,vN=4,Tb=()=>H.getLogger("esri.symbols.cim.CIMSymbolHelper");function a5e(e){let t;switch(e.type){case"cim":return e.data;case"web-style":return e;case"simple-marker":{const i=ir.fromSimpleMarker(e);if(!i)throw new Error("InternalError: Cannot convert symbol to CIM");t=i;break}case"picture-marker":t=ir.fromPictureMarker(e);break;case"simple-line":t=ir.fromSimpleLineSymbol(e);break;case"simple-fill":t=ir.fromSimpleFillSymbol(e);break;case"picture-fill":t=ir.fromPictureFillSymbol(e);break;case"text":t=ir.fromTextSymbol(e)}return{type:"CIMSymbolReference",symbol:t}}function N1(e,t,i){switch(t.type){case"CIMSymbolReference":return N1(e,t.symbol,i);case"CIMPointSymbol":i==null&&(i={x:0,y:0}),e.drawSymbol(t,i);break;case"CIMLineSymbol":i==null&&(i={paths:[[[0,0],[10,0]]]}),e.drawSymbol(t,i);break;case"CIMPolygonSymbol":i==null&&(i={rings:[[[0,0],[0,10],[10,10],[10,0],[0,0]]]}),e.drawSymbol(t,i);break;case"CIMTextSymbol":{const r={x:0,y:0};e.drawSymbol(t,r);break}case"CIMVectorMarker":{const r=new Sf;e.drawMarker(t,r);break}}return e.envelope()}function LSe(e){if(!e)return 0;switch(e.type){case"CIMMarkerPlacementAlongLineSameSize":case"CIMMarkerPlacementAlongLineRandomSize":case"CIMMarkerPlacementAtExtremities":case"CIMMarkerPlacementAtMeasuredUnits":case"CIMMarkerPlacementAtRatioPositions":case"CIMMarkerPlacementOnLine":case"CIMMarkerPlacementOnVertices":return Math.abs(e.offset);default:return 0}}function kSe(e){if(!e)return 0;switch(e.type){case"CIMGeometricEffectArrow":return Math.abs(.5*e.width);case"CIMGeometricEffectBuffer":return Math.abs(e.size);case"CIMGeometricEffectControlMeasureLine":return 500;case"CIMGeometricEffectExtension":case"CIMGeometricEffectRadial":return Math.abs(e.length);case"CIMGeometricEffectJog":return Math.abs(.5*e.length);case"CIMGeometricEffectMove":return Math.max(Math.abs(be(e.offsetX)),Math.abs(be(e.offsetY)));case"CIMGeometricEffectOffset":case"CIMGeometricEffectOffsetTangent":return Math.abs(e.offset);case"CIMGeometricEffectRegularPolygon":return Math.abs(e.radius);case"CIMGeometricEffectRotate":case"CIMGeometricEffectScale":default:return 0;case"CIMGeometricEffectTaperedPolygon":return .5*Math.max(Math.abs(e.fromWidth),Math.abs(e.toWidth));case"CIMGeometricEffectWave":return Math.abs(e.amplitude);case"CIMGeometricEffectDonut":return Math.abs(e.width)}}function bN(e){if(!e)return 0;let t=0;for(const i of e)t+=kSe(i);return t}class l5e{static getSymbolInflateSize(t,i,r,s,n){return t||(t=[0,0,0,0]),i?this._getInflateSize(t,i,r,s,n):t}static safeSize(t){const i=Math.max(Math.abs(t[0]),Math.abs(t[2])),r=Math.max(Math.abs(t[1]),Math.abs(t[3]));return Math.sqrt(i*i+r*r)}static _vectorMarkerBounds(t,i,r,s){let n=!0;const o=Qt();if(i?.markerGraphics)for(const a of i.markerGraphics){const l=[0,0,0,0];a.geometry&&(MC(o,a.geometry),l[0]=0,l[1]=0,l[2]=0,l[3]=0,this.getSymbolInflateSize(l,a.symbol,r,0,s),o[0]+=l[0],o[1]+=l[1],o[2]+=l[2],o[3]+=l[3],n?(t[0]=o[0],t[1]=o[1],t[2]=o[2],t[3]=o[3],n=!1):(t[0]=Math.min(t[0],o[0]),t[1]=Math.min(t[1],o[1]),t[2]=Math.max(t[2],o[2]),t[3]=Math.max(t[3],o[3])))}return t}static _getInflateSize(t,i,r,s,n){if(zSe(i)){const o=this._getLayersInflateSize(t,i.symbolLayers,r,s,n),a=bN(i.effects);return a>0&&(o[0]-=a,o[1]-=a,o[2]+=a,o[3]+=a),o}return this._getTextInflatedSize(t,i,n)}static _getLayersInflateSize(t,i,r,s,n){let o=!0;if(!i)return t;for(const a of i){if(!a)continue;let l=[0,0,0,0];switch(a.type){case"CIMSolidFill":case"CIMPictureFill":case"CIMHatchFill":case"CIMGradientFill":break;case"CIMSolidStroke":case"CIMPictureStroke":case"CIMGradientStroke":{const c=a;let d=c.width;d!=null&&(c.capStyle===Br.Square||c.joinStyle===Vs.Miter?d/=ASe:d/=2,l[0]=-d,l[1]=-d,l[2]=d,l[3]=d);break}case"CIMCharacterMarker":case"CIMVectorMarker":case"CIMPictureMarker":{const c=a;if(a.type==="CIMVectorMarker"){const _=a;if(l=this._vectorMarkerBounds(l,_,r,n),_.frame){const v=(_.frame.xmin+_.frame.xmax)/2,b=(_.frame.ymin+_.frame.ymax)/2;if(l[0]-=v,l[1]-=b,l[2]-=v,l[3]-=b,_.size!=null){const S=_.size/(_.frame.ymax-_.frame.ymin);l[0]*=S,l[1]*=S,l[2]*=S,l[3]*=S}}}else if(a.type==="CIMPictureMarker"){const _=a,v=r.getResource(_.url);let b=1;if(v!=null&&v.height&&(b=v.width/v.height),c.size!=null){const S=c.size/2,$=c.size*b*_.scaleX/2;l=[-$,-S,$,S]}}else if(c.size!=null){const _=c.size/2;l=[-_,-_,_,_]}if(c.anchorPoint){let _,v;c.anchorPointUnits==="Absolute"?(_=c.anchorPoint.x,v=c.anchorPoint.y):(_=c.anchorPoint.x*(l[2]-l[0]),v=c.anchorPoint.y*(l[3]-l[1]));const b=1.25*Math.sqrt(_*_+v*v);l[0]-=b,l[1]-=b,l[2]+=b,l[3]+=b}let d=be(c.rotation);if(c.rotateClockwise&&(d=-d),s&&(d-=s),d){const _=gN*d,v=Math.cos(_),b=Math.sin(_),S=Qt([m_,m_,-m_,-m_]);vm(S,[l[0]*v-l[1]*b,l[0]*b+l[1]*v]),vm(S,[l[0]*v-l[3]*b,l[0]*b+l[3]*v]),vm(S,[l[2]*v-l[1]*b,l[2]*b+l[1]*v]),vm(S,[l[2]*v-l[3]*b,l[2]*b+l[3]*v]),l=S}let m=be(c.offsetX),y=be(c.offsetY);if(s){const _=gN*s,v=Math.cos(_),b=Math.sin(_),S=m*b+y*v;m=m*v-y*b,y=S}l[0]+=m,l[1]+=y,l[2]+=m,l[3]+=y;const g=LSe(c.markerPlacement);g>0&&(l[0]-=g,l[1]-=g,l[2]+=g,l[3]+=g);break}}const u=bN(a.effects);u>0&&(l[0]-=u,l[1]-=u,l[2]+=u,l[3]+=u),o?(t[0]=l[0],t[1]=l[1],t[2]=l[2],t[3]=l[3],o=!1):(t[0]=Math.min(t[0],l[0]),t[1]=Math.min(t[1],l[1]),t[2]=Math.max(t[2],l[2]),t[3]=Math.max(t[3],l[3]))}return t}static _getTextInflatedSize(t,i,r){const s=MG(i.height??ti.CIMTextSymbol.height);if(t[0]=-s/2,t[1]=-s/2,t[2]=s/2,t[3]=s/2,!r)return t;const n=r.get(i);if(!n||!n.glyphMosaicItems.glyphs.length)return t;const{lineGapType:o,lineGap:a}=i,l=o?PG(o,a??0,s):0,u=i.callout?.type==="CIMBackgroundCallout",c=$G(n.glyphMosaicItems,{scale:s/RU,angle:be(i.angle),xOffset:be(i.offsetX),yOffset:be(i.offsetY),horizontalAlignment:i.horizontalAlignment,verticalAlignment:i.verticalAlignment,maxLineWidth:TG(i.lineWidth),lineHeight:kU*Math.max(.25,Math.min(l||1,4)),decoration:i.font.decoration||"none",useCIMAngleBehavior:!0,hasBackground:u}).boundsT,d=Math.sqrt(c.width*c.width+c.height*c.height);return t[0]-=c.x+d,t[1]-=c.y-d,t[2]+=c.x+d,t[3]+=-c.y+d,t}}class ir{static getEnvelope(t,i,r){if(!t)return null;const s=new vSe(r);if(Array.isArray(t)){let n;for(const o of t)n?n.union(N1(s,o,i)):n=N1(s,o,i);return n}return N1(s,t,i)}static getTextureInfo(t,i,r,s,n){const o=s??this.getEnvelope(t,null,i);if(!o)return[0,0,0,0,1];const a=Math.max(o.width,o.height)*xS;let l=n!=null?Math.max(n/a,1):1;l*=xS,o.x*=l,o.y*=l,o.width*=l,o.height*=l,o.width=Math.max(Math.ceil(o.x+o.width)-Math.floor(o.x),1)-1,o.height=Math.max(Math.ceil(o.y+o.height)-Math.floor(o.y),1)-1;let u=o.x+.5*o.width,c=o.y+.5*o.height;return u+=o.x-Math.floor(o.x),c+=o.y-Math.floor(o.y),s||(o.width+=r,o.height+=r,u+=r/2,c+=r/2),[o.width,o.height,u,c,l]}static getTextureAnchor(t,i,r){const[s,n,o,a,l]=this.getTextureInfo(t,i,_N,null,r);return[-o/s,-a/n,n/l*xS]}static rasterize(t,i,r,s,n=!0,o){const[a,l,u,c,d]=this.getTextureInfo(i,s,_N,r,o);t.width=a,t.height=l;const m=t.getContext("2d",{willReadFrequently:!0}),y=Pi.createScale(d,-d);y.translate(.5*a-u,.5*l+c);const g=new CG(m,s,y);switch(i.type){case"CIMPointSymbol":{const b={type:"point",x:0,y:0};g.drawSymbol(i,b);break}case"CIMVectorMarker":{const b=new Sf;g.drawMarker(i,b);break}}const _=m.getImageData(0,0,t.width,t.height),v=new Uint8Array(_.data);if(n){let b;for(let S=0;S<v.length;S+=4)b=v[S+3]/255,v[S]=v[S]*b,v[S+1]=v[S+1]*b,v[S+2]=v[S+2]*b}return[v,t.width,t.height,-u/a,-c/l]}static fromTextSymbol(t){const{text:i}=t;return{type:"CIMPointSymbol",symbolLayers:[{type:"CIMVectorMarker",enable:!0,anchorPointUnits:"Relative",dominantSizeAxis3D:"Y",size:10,billboardMode3D:"FaceNearPlane",frame:{xmin:-5,ymin:-5,xmax:5,ymax:5},markerGraphics:[{type:"CIMMarkerGraphic",geometry:{x:0,y:0},symbol:ir.createCIMTextSymbolfromTextSymbol(t),textString:i}],scaleSymbolsProportionally:!0,respectFrame:!0}],scaleX:1,angleAlignment:"Display"}}static fromPictureFillSymbol(t){const{height:i,outline:r,width:s,xoffset:n,xscale:o,yoffset:a,yscale:l}=t,u=[],c={type:"CIMPolygonSymbol",symbolLayers:u};if(r){const _=wN(r);_&&u.push(_)}let d=t.url;t.type==="esriPFS"&&t.imageData&&(d=t.imageData);const m="angle"in t?t.angle??0:0,y=(s??0)*(o||1),g=(i??0)*(l||1);return u.push({type:"CIMPictureFill",invertBackfaceTexture:!1,scaleX:1,textureFilter:Bd.Picture,tintColor:null,url:d,height:g,width:y,offsetX:be(n),offsetY:be(a),rotation:be(-m),colorSubstitutions:null}),c}static fromSimpleFillSymbol(t){const{color:i,style:r,outline:s}=t,n=[],o={type:"CIMPolygonSymbol",symbolLayers:n};if(s){const a=wN(s);a&&n.push(a)}if(r&&r!=="solid"&&r!=="none"&&r!=="esriSFSSolid"&&r!=="esriSFSNull"){const a={type:"CIMLineSymbol",symbolLayers:[{type:"CIMSolidStroke",color:ss(i),capStyle:Br.Butt,joinStyle:Vs.Miter,width:.75}]};let l=0;const u=We(VSe(r)?8:10);switch(r){case"vertical":case"esriSFSVertical":l=90;break;case"forward-diagonal":case"esriSFSForwardDiagonal":case"diagonal-cross":case"esriSFSDiagonalCross":l=-45;break;case"backward-diagonal":case"esriSFSBackwardDiagonal":l=45;break;case"cross":case"esriSFSCross":l=0}n.push({type:"CIMHatchFill",lineSymbol:a,offsetX:0,offsetY:0,rotation:l,separation:u}),r==="cross"||r==="esriSFSCross"?n.push({type:"CIMHatchFill",lineSymbol:V(a),offsetX:0,offsetY:0,rotation:90,separation:u}):r!=="diagonal-cross"&&r!=="esriSFSDiagonalCross"||n.push({type:"CIMHatchFill",lineSymbol:V(a),offsetX:0,offsetY:0,rotation:45,separation:u})}else!r||r!=="solid"&&r!=="esriSFSSolid"||n.push({type:"CIMSolidFill",enable:!0,color:ss(i)});return o}static fromSimpleLineSymbol(t){const{cap:i,color:r,join:s,marker:n,miterLimit:o,style:a,width:l}=t;let u=null;a!=="solid"&&a!=="none"&&a!=="esriSLSSolid"&&a!=="esriSLSNull"&&(u=[{type:"CIMGeometricEffectDashes",dashTemplate:iE(a,i),lineDashEnding:"NoConstraint",scaleDash:!0,offsetAlongLine:null}]);const c=[];if(n){let d;switch(n.placement){case"begin-end":d=Ro.Both;break;case"begin":d=Ro.JustBegin;break;case"end":d=Ro.JustEnd;break;default:d=Ro.None}const m=ir.fromSimpleMarker(n,l,r).symbolLayers[0];m.markerPlacement={type:"CIMMarkerPlacementAtExtremities",placePerPart:!1,angleToLine:!0,offset:0,extremityPlacement:d,offsetAlongLine:0},c.push(m)}return c.push({type:"CIMSolidStroke",color:a!=="none"&&a!=="esriSLSNull"?ss(r):[0,0,0,0],capStyle:RG(i),joinStyle:OG(s),miterLimit:o,width:l,effects:u}),{type:"CIMLineSymbol",symbolLayers:c}}static fromPictureMarker(t){const{angle:i,height:r,width:s,xoffset:n,yoffset:o}=t;let a=t.url;return t.type==="esriPMS"&&t.imageData&&(a=t.imageData),{type:"CIMPointSymbol",symbolLayers:[{type:"CIMPictureMarker",invertBackfaceTexture:!1,scaleX:1,textureFilter:Bd.Picture,tintColor:null,url:a,size:r,width:s,offsetX:be(n),offsetY:be(o),rotation:be(-i)}]}}static createCIMTextSymbolfromTextSymbol(t){const{angle:i,color:r,font:s,haloColor:n,haloSize:o,horizontalAlignment:a,kerning:l,lineWidth:u,text:c,verticalAlignment:d,xoffset:m,yoffset:y,backgroundColor:g,borderLineColor:_,borderLineSize:v}=t;let b,S,$,E,C,P;s&&(b=s.family,S=s.style,$=s.weight,E=s.size,C=s.decoration);let k=!1;return c&&(k=lwe(c)[1]),(g||v)&&(P={type:"CIMBackgroundCallout",margin:null,backgroundSymbol:{type:"CIMPolygonSymbol",symbolLayers:[{type:"CIMSolidFill",color:ss(g)},{type:"CIMSolidStroke",color:ss(_),width:v}]},accentBarSymbol:null,gap:null,leaderLineSymbol:null,lineStyle:null}),{type:"CIMTextSymbol",angle:i,blockProgression:$T.BTT,depth3D:1,extrapolateBaselines:!0,fontEffects:vT.Normal,fontEncoding:bT.Unicode,fontFamilyName:b||"Arial",fontStyleName:NSe(S,$),fontType:wT.Unspecified,haloSize:o,height:E,hinting:TT.Default,horizontalAlignment:RSe(a??"center"),kerning:l,letterWidth:100,ligatures:!0,lineGapType:"Multiple",lineWidth:u,offsetX:be(m),offsetY:be(y),strikethrough:C==="line-through",underline:C==="underline",symbol:{type:"CIMPolygonSymbol",symbolLayers:[{type:"CIMSolidFill",enable:!0,color:ss(r)}]},haloSymbol:{type:"CIMPolygonSymbol",symbolLayers:[{type:"CIMSolidFill",enable:!0,color:ss(n)}]},shadowColor:[0,0,0,255],shadowOffsetX:1,shadowOffsetY:1,textCase:"Normal",textDirection:k?db.RTL:db.LTR,verticalAlignment:OSe(d??"baseline"),verticalGlyphOrientation:CT.Right,wordSpacing:100,billboardMode3D:MT.FaceNearPlane,callout:P}}static createPictureMarkerRasterizationParam(t){const{angle:i,height:r,width:s,xoffset:n,yoffset:o}=t,a=t.url??t.source?.url??t.source?.imageData;return a?{type:"sprite-rasterization-param",overrides:[],resource:{type:"CIMPictureMarker",invertBackfaceTexture:!1,scaleX:1,textureFilter:Bd.Picture,tintColor:null,url:a,size:r,width:s,offsetX:be(n),offsetY:be(o),rotation:be(-i)}}:null}static createPictureFillRasterizationParam(t){const{width:i,height:r,xoffset:s,yoffset:n,url:o}=t;return o?{type:"sprite-rasterization-param",overrides:[],resource:{type:"CIMPictureFill",scaleX:1,textureFilter:Bd.Picture,tintColor:null,url:o,width:i,height:r,offsetX:be(s),offsetY:be(n),rotation:0}}:null}static fromSimpleMarker(t,i,r){const{style:s}=t,n=t.color??r;if(s==="path"||s==="esriSMSPath"){const d=[];if("outline"in t&&t.outline){const g=t.outline;d.push({type:"CIMSolidStroke",enable:!0,width:g.width,color:ss(g.color),path:t.path})}d.push({type:"CIMSolidFill",enable:!0,color:ss(n),path:t.path});const[m,y]=lm("square");return{type:"CIMPointSymbol",symbolLayers:[{type:"CIMVectorMarker",enable:!0,rotation:-be(t.angle),size:be(t.size||6),offsetX:be(t.xoffset),offsetY:be(t.yoffset),scaleSymbolsProportionally:!1,frame:m,markerGraphics:[{type:"CIMMarkerGraphic",geometry:y,symbol:{type:"CIMPolygonSymbol",symbolLayers:d}}]}]}}const o=[];let a,l,u=t.size;if("outline"in t&&t.outline&&t.outline.style!=="none"&&t.outline.style!=="esriSLSNull"){const d=t.outline,m=d.style!=="solid"&&d.style!=="esriSLSSolid";[a,l]=m?lm(s,t.size):lm(s);const y=d.width??CP.width;if(m){const v=y/t.size,b=(a.xmax-a.xmin)*v/2,S=(a.ymax-a.ymin)*v/2;a.xmin-=b,a.xmax+=b,a.ymin-=S,a.ymax+=S,u&&(u+=y)}const g=t.style!=="cross"&&t.style!=="x"||t?.outline.style==="dot"||t?.outline.style==="short-dot"?Di.HalfGap:Di.FullPattern,_=m?[{type:"CIMGeometricEffectAddControlPoints"},{type:"CIMGeometricEffectDashes",dashTemplate:iE(d.style,null).map((v=>d.width&&d.width>0?v*d.width:v)),lineDashEnding:g,controlPointEnding:Di.FullPattern}]:void 0;o.push({type:"CIMSolidStroke",capStyle:m?Br.Round:Br.Butt,enable:!0,width:y,color:ss(d.color),effects:_})}else!i||t.type!=="line-marker"||t.style!=="cross"&&t.style!=="x"?[a,l]=lm(s):([a,l]=lm(s),o.push({type:"CIMSolidStroke",enable:!0,width:i,color:ss(n)}));o.push({type:"CIMSolidFill",enable:!0,color:ss(n)});const c={type:"CIMPolygonSymbol",symbolLayers:o};return{type:"CIMPointSymbol",symbolLayers:[{type:"CIMVectorMarker",enable:!0,rotation:be(-t.angle),size:be(u||6*i),offsetX:be(t.xoffset),offsetY:be(t.yoffset),scaleSymbolsProportionally:!1,frame:a,markerGraphics:[{type:"CIMMarkerGraphic",geometry:l,symbol:c}]}]}}static fromCIMHatchFill(t,i){const r=i*(t.separation??ti.CIMHatchFill.separation),s=r/2,n=V(t.lineSymbol);n.symbolLayers?.forEach((l=>{switch(l.type){case"CIMSolidStroke":l.width!=null&&(l.width*=i),l.effects?.forEach((u=>{if(u.type==="CIMGeometricEffectDashes"){const c=u.dashTemplate;u.dashTemplate=c?.map((d=>d*i))}}));break;case"CIMVectorMarker":{l.size!=null&&(l.size*=i);const u=l.markerPlacement;u!=null&&"placementTemplate"in u&&(u.placementTemplate=u.placementTemplate.map((c=>c*i)));break}}}));let o=this._getLineSymbolPeriod(n)||vN;for(;o<vN;)o*=2;const a=o/2;return{type:"CIMVectorMarker",frame:{xmin:-a,xmax:a,ymin:-s,ymax:s},markerGraphics:[{type:"CIMMarkerGraphic",geometry:{paths:[[[-a,0],[a,0]]]},symbol:n}],size:r}}static fetchResources(t,i,r,s=null){return t&&i&&kG(t,(n=>{USe(n,i,r),"url"in n&&n.url&&r.push(i.fetchResource(n.url,{signal:s}))})),r}static fetchFonts(t,i,r){if(t&&i){if("symbolLayers"in t&&t.symbolLayers){for(const s of t.symbolLayers)if(s.type==="CIMVectorMarker"&&s.markerGraphics)for(const n of s.markerGraphics)n?.symbol&&ir.fetchFonts(n.symbol,i,r)}else if(t.type==="CIMTextSymbol"){const{fontFamilyName:s,fontStyleName:n}=t;if(!s||s.toLowerCase()==="calcitewebcoreicons")return;const{style:o,weight:a}=U7(n),l=j7(t),u=new os({family:s,style:o,weight:a,decoration:l});r.push(i.loadFont(u).catch((()=>{Tb().error(`Unsupported font ${s} in CIM symbol`)})))}}}static _getLineSymbolPeriod(t){if(t){const i=this._getEffectsRepeat(t.effects);if(i)return i;if(t.symbolLayers){for(const r of t.symbolLayers)if(r){const s=this._getEffectsRepeat(r.effects);if(s)return s;switch(r.type){case"CIMCharacterMarker":case"CIMPictureMarker":case"CIMVectorMarker":case"CIMObjectMarker3D":case"CIMglTFMarker3D":{const n=this._getPlacementRepeat(r.markerPlacement);if(n)return n}}}}}return 0}static _getEffectsRepeat(t){if(t){for(const i of t)if(i)switch(i.type){case"CIMGeometricEffectDashes":{const r=i.dashTemplate;if(r&&r.length){let s=0;for(const n of r)s+=n;return 1&r.length&&(s*=2),s}break}case"CIMGeometricEffectWave":return i.period;default:Tb().error(`unsupported geometric effect type ${i.type}`)}}return 0}static _getPlacementRepeat(t){if(t)switch(t.type){case"CIMMarkerPlacementAlongLineSameSize":case"CIMMarkerPlacementAlongLineRandomSize":case"CIMMarkerPlacementAlongLineVariableSize":{const i=t.placementTemplate;if(i&&i.length){let r=0;for(const s of i)r+=+s;return 1&i.length&&(r*=2),r}break}}return 0}static fromCIMInsidePolygon(t){const i=t.markerPlacement,r={...t};r.markerPlacement=null,r.anchorPoint=null;const s=Math.abs(i.stepX),n=Math.abs(i.stepY),o=(i.randomness??100)/100;let a,l,u,c;if(i.gridType==="Random"){const d=We(Vde),m=Math.max(Math.floor(d/s),1),y=Math.max(Math.floor(d/n),1);a=m*s/2,l=y*n/2,u=2*l;const g=new pE(i.seed),_=o*s/1.5,v=o*n/1.5;c=[];for(let b=0;b<m;b++)for(let S=0;S<y;S++){const $=b*s-a+_*(.5-g.getFloat()),E=S*n-l+v*(.5-g.getFloat());c.push({x:$,y:E}),b===0&&c.push({x:$+2*a,y:E}),S===0&&c.push({x:$,y:E+2*l})}}else i.shiftOddRows===!0?(a=s/2,l=n,u=2*n,c=[{x:-a,y:0},{x:a,y:0},{x:0,y:l},{x:0,y:-l}]):(a=s/2,l=n/2,u=n,c=[{x:-s,y:0},{x:0,y:-n},{x:-s,y:-n},{x:0,y:0},{x:s,y:0},{x:0,y:n},{x:s,y:n},{x:-s,y:n},{x:s,y:-n}]);return{type:"CIMVectorMarker",frame:{xmin:-a,xmax:a,ymin:-l,ymax:l},markerGraphics:c.map((d=>({type:"CIMMarkerGraphic",geometry:d,symbol:{type:"CIMPointSymbol",symbolLayers:[r]}}))),size:u}}}function kG(e,t){if(e)switch(e.type){case"CIMPointSymbol":case"CIMLineSymbol":case"CIMPolygonSymbol":{const i=e.symbolLayers;if(!i)return;for(const r of i)if(t(r),r.type==="CIMVectorMarker"){const s=r.markerGraphics;if(!s)continue;for(const n of s)if(n){const o=n.symbol;o&&kG(o,t)}}break}}}const RG=e=>{if(!e)return Br.Butt;switch(e){case"butt":return Br.Butt;case"square":return Br.Square;case"round":return Br.Round}},OG=e=>{if(!e)return Vs.Miter;switch(e){case"miter":return Vs.Miter;case"round":return Vs.Round;case"bevel":return Vs.Bevel}},RSe=e=>{if(e==null)return"Center";switch(e){case"left":return"Left";case"right":return"Right";case"center":return"Center"}},OSe=e=>{if(e==null)return"Center";switch(e){case"baseline":return"Baseline";case"top":return"Top";case"middle":return"Center";case"bottom":return"Bottom"}},ss=e=>{if(!e)return[0,0,0,0];const{r:t,g:i,b:r,a:s}=e;return[t,i,r,255*s]},NSe=(e,t)=>{const i=DSe(t),r=FSe(e);return i&&r?`${i}-${r}`:`${i}${r}`},DSe=e=>{if(!e)return"";switch(e.toLowerCase()){case"bold":case"bolder":return"bold"}return""},FSe=e=>{if(!e)return"";switch(e.toLowerCase()){case"italic":case"oblique":return"italic"}return""},iE=(e,t)=>{const i=N("safari")?.001:0,r=t==="butt";switch(e){case"dash":case"esriSLSDash":return r?[4,3]:[3,4];case"dash-dot":case"esriSLSDashDot":return r?[4,3,1,3]:[3,4,i,4];case"dot":case"esriSLSDot":return r?[1,3]:[i,4];case"long-dash":case"esriSLSLongDash":return r?[8,3]:[7,4];case"long-dash-dot":case"esriSLSLongDashDot":return r?[8,3,1,3]:[7,4,i,4];case"long-dash-dot-dot":case"esriSLSDashDotDot":return r?[8,3,1,3,1,3]:[7,4,i,4,i,4];case"short-dash":case"esriSLSShortDash":return r?[4,1]:[3,2];case"short-dash-dot":case"esriSLSShortDashDot":return r?[4,1,1,1]:[3,2,i,2];case"short-dash-dot-dot":case"esriSLSShortDashDotDot":return r?[4,1,1,1,1,1]:[3,2,i,2,i,2];case"short-dot":case"esriSLSShortDot":return r?[1,1]:[i,2];case"solid":case"esriSLSSolid":case"none":return Tb().error("Unexpected: style does not require rasterization"),[0,0];default:return Tb().error(`Tried to rasterize SLS, but found an unexpected style: ${e}!`),[0,0]}};function zSe(e){return e.symbolLayers!==void 0}const lm=(e,t=100)=>{const i=t/2;let r,s;const n=e;if(n==="circle"||n==="esriSMSCircle"){let a=Math.acos(1-.25/i),l=Math.ceil(LG/a/4);l===0&&(l=1),a=ISe/l,l*=4;const u=[];u.push([i,0]);for(let c=1;c<l;c++)u.push([i*Math.cos(c*a),-i*Math.sin(c*a)]);u.push([i,0]),r={rings:[u]},s={xmin:-i,ymin:-i,xmax:i,ymax:i}}else if(n==="cross"||n==="esriSMSCross")r={paths:[[[0,i],[0,-i]],[[i,0],[-i,0]]]},s={xmin:-i,ymin:-i,xmax:i,ymax:i};else if(n==="diamond"||n==="esriSMSDiamond")r={rings:[[[-i,0],[0,i],[i,0],[0,-i],[-i,0]]]},s={xmin:-i,ymin:-i,xmax:i,ymax:i};else if(n==="square"||n==="esriSMSSquare")r={rings:[[[-i,-i],[-i,i],[i,i],[i,-i],[-i,-i]]]},s={xmin:-i,ymin:-i,xmax:i,ymax:i};else if(n==="x"||n==="esriSMSX")r={paths:[[[i,i],[-i,-i]],[[i,-i],[-i,i]]]},s={xmin:-i,ymin:-i,xmax:i,ymax:i};else if(n==="triangle"||n==="esriSMSTriangle"){const o=t*.5773502691896257,a=-o,l=2/3*t,u=l-t;r={rings:[[[a,u],[0,l],[o,u],[a,u]]]},s={xmin:a,ymin:u,xmax:o,ymax:l}}else n==="arrow"&&(r={rings:[[[-50,50],[50,0],[-50,-50],[-33,-20],[-33,20],[-50,50]]]},s={xmin:-i,ymin:-i,xmax:i,ymax:i});return[s,r]},VSe=e=>e==="vertical"||e==="horizontal"||e==="cross"||e==="esriSFSCross"||e==="esriSFSVertical"||e==="esriSFSHorizontal";function USe(e,t,i){if(!(!e.effects||t.geometryEngine!=null)){if(t.geometryEnginePromise)return void i.push(t.geometryEnginePromise);L0e(e.effects)&&(t.geometryEnginePromise=k0e(),i.push(t.geometryEnginePromise),t.geometryEnginePromise.then((r=>t.geometryEngine=r)))}}function wN(e){if(!e)return null;let t=null;const{cap:i,color:r,join:s,miterLimit:n,style:o,width:a}=e;return o!=="solid"&&o!=="none"&&o!=="esriSLSSolid"&&o!=="esriSLSNull"&&(t=[{type:"CIMGeometricEffectDashes",dashTemplate:iE(o,i),lineDashEnding:"NoConstraint",scaleDash:!0,offsetAlongLine:null}]),{type:"CIMSolidStroke",color:o!=="esriSLSNull"&&o!=="none"?ss(r):[0,0,0,0],capStyle:RG(i),joinStyle:OG(s),miterLimit:n,width:a,effects:t}}let jSe=class{constructor(){this._resourceMap=new Map,this._inFlightResourceMap=new Map,this.geometryEngine=null,this.geometryEnginePromise=null}destroy(){this._inFlightResourceMap.clear(),this._resourceMap.clear()}getResource(t){return this._resourceMap.get(t)??null}async fetchResource(t,i){const r=this._resourceMap.get(t);if(r)return{width:r.width,height:r.height};let s=this._inFlightResourceMap.get(t);return s?s.then((n=>({width:n.width,height:n.height}))):(s=wpe(t,i),this._inFlightResourceMap.set(t,s),s.then((n=>(this._inFlightResourceMap.delete(t),this._resourceMap.set(t,n),{width:n.width,height:n.height})),(()=>({width:0,height:0}))))}deleteResource(t){this._inFlightResourceMap.delete(t),this._resourceMap.delete(t)}loadFont(t){return cwe(t)}};function c5e(e){return e?{originPosition:e.originPosition==="upper-left"?"upperLeft":e.originPosition==="lower-left"?"lowerLeft":e.originPosition,scale:e.tolerance?[e.tolerance,e.tolerance,1,1]:[1,1,1,1],translate:e.extent!=null?[e.extent.xmin,e.extent.ymax,e.extent.zmin??0,e.extent.mmin??0]:[0,0,0,0]}:null}function GSe(e){return e.originPosition==="lowerLeft"&&e.scale.length===4&&e.translate.length===4}function Ch(e){if(GSe(e))return e;const{originPosition:t,scale:i,translate:r}=e,s=i[0]??1,n=i[1]??1;return{originPosition:"lowerLeft",scale:[s,t==="lowerLeft"?n:-n,i[2]??1,i[3]??1],translate:[r[0]??0,r[1]??0,r[2]??0,r[3]??0]}}function Za({scale:e,translate:t},i){return Math.round((i-t[0])/e[0])}function Ya({scale:e,translate:t},i){return Math.round((i-t[1])/e[1])}function yg({scale:e,translate:t},i){return Math.round(((i??0)-t[2])/e[2])}function gg({scale:e,translate:t},i){return i?Math.round((i-t[3])/e[3]):0}function NG(e,t){return e&&t?WSe:e&&!t?qSe:!e&&t?HSe:BSe}const BSe=(e,t)=>{const i=[];if(!t.length)return null;const r=t[0];let s=Za(e,r[0]),n=Ya(e,r[1]);i.push([s,n]);for(let o=1;o<t.length;o++){const[a,l]=t[o],u=Za(e,a),c=Ya(e,l);u===s&&c===n||i.push([u-s,c-n]),s=u,n=c}return i},qSe=(e,t)=>{const i=[];if(!t.length)return null;const r=t[0];let s=Za(e,r[0]),n=Ya(e,r[1]),o=yg(e,r[2]);i.push([s,n,o]);for(let a=1;a<t.length;a++){const[l,u,c]=t[a],d=Za(e,l),m=Ya(e,u),y=yg(e,c);d===s&&m===n&&y===o||i.push([d-s,m-n,y]),s=d,n=m,o=y}return i},HSe=(e,t)=>{const i=[];if(!t.length)return null;const r=t[0];let s=Za(e,r[0]),n=Ya(e,r[1]),o=gg(e,r[2]);i.push([s,n,o]);for(let a=1;a<t.length;a++){const[l,u,c]=t[a],d=Za(e,l),m=Ya(e,u),y=gg(e,c);d===s&&m===n&&y===o||i.push([d-s,m-n,y]),s=d,n=m,o=y}return i},WSe=(e,t)=>{const i=[];if(!t.length)return null;const r=t[0];let s=Za(e,r[0]),n=Ya(e,r[1]),o=yg(e,r[2]),a=gg(e,r[3]);i.push([s,n,o,a]);for(let l=1;l<t.length;l++){const[u,c,d,m]=t[l],y=Za(e,u),g=Ya(e,c),_=yg(e,d),v=gg(e,m);y===s&&g===n&&_===o&&v===a||i.push([y-s,g-n,_,v]),s=y,n=g,o=_,a=v}return i};function ZSe(e,t,i,r){const s=[],n=NG(i,r);for(let o=0;o<t.length;o++){const a=n(e,t[o]);a&&a.length>=3&&s.push(a)}return s.length?s:null}function YSe(e,t,i,r){const s=[],n=NG(i,r);for(let o=0;o<t.length;o++){const a=n(e,t[o]);a&&a.length>=2&&s.push(a)}return s.length?s:null}function a0({scale:e,translate:t},i){return i*e[0]+t[0]}function l0({scale:e,translate:t},i){return i*e[1]+t[1]}function _g({scale:e,translate:t},i){return(i??0)*e[2]+t[2]}function vg({scale:e,translate:t},i){return i?i*e[3]+t[3]:0}function tI(e,t){return e&&t?QSe:e&&!t?XSe:!e&&t?KSe:JSe}const JSe=(e,t)=>{const i=new Array(t.length);if(!t.length)return i;const r=t[0];let s=a0(e,r[0]),n=l0(e,r[1]);i[0]=[s,n];const{scale:o,originPosition:a}=e,l=o[0],u=a==="lowerLeft"?o[1]:-o[1];for(let c=1;c<t.length;c++){const[d,m]=t[c];s+=l*d,n+=u*m,i[c]=[s,n]}return i},XSe=(e,t)=>{const i=new Array(t.length);if(!t.length)return i;const r=t[0];let s=a0(e,r[0]),n=l0(e,r[1]);i[0]=[s,n,_g(e,r[2])];const{scale:o,originPosition:a}=e,l=o[0],u=a==="lowerLeft"?o[1]:-o[1];for(let c=1;c<t.length;c++){const[d,m,y]=t[c];s+=l*d,n+=u*m,i[c]=[s,n,_g(e,y)]}return i},KSe=(e,t)=>{const i=new Array(t.length);if(!t.length)return i;const r=t[0];let s=a0(e,r[0]),n=l0(e,r[1]);i[0]=[s,n,vg(e,r[2])];const{scale:o,originPosition:a}=e,l=o[0],u=a==="lowerLeft"?o[1]:-o[1];for(let c=1;c<t.length;c++){const[d,m,y]=t[c];s+=l*d,n+=u*m,i[c]=[s,n,vg(e,y)]}return i},QSe=(e,t)=>{const i=new Array(t.length);if(!t.length)return i;const r=t[0];let s=a0(e,r[0]),n=l0(e,r[1]);i[0]=[s,n,_g(e,r[2]),vg(e,r[3])];const{scale:o,originPosition:a}=e,l=o[0],u=a==="lowerLeft"?o[1]:-o[1];for(let c=1;c<t.length;c++){const[d,m,y,g]=t[c];s+=l*d,n+=u*m,i[c]=[s,n,_g(e,y),vg(e,g)]}return i};function DG(e,t,i){const r=new Array(i.length);for(let s=0;s<i.length;s++)r[s]=t(e,i[s]);return r}function h5e(e,t,i){const r=Ch(e);return t.x=Za(r,i.x),t.y=Ya(r,i.y),i.z!=null&&(t.z=yg(r,i.z)),i.m!=null&&(t.m=gg(r,i.m)),t}function d5e(e,t,i){const r=ZSe(Ch(e),i.rings,i.hasZ,i.hasM);return r?(t.rings=r,t.hasZ=i.hasZ??!1,t.hasM=i.hasM??!1,t):null}function p5e(e,t,i){const r=YSe(Ch(e),i.paths,i.hasZ,i.hasM);return r?(t.paths=r,t.hasZ=i.hasZ??!1,t.hasM=i.hasM??!1,t):null}function exe(e,t,i,r=i?.hasZ??!1,s=i?.hasM??!1){if(i!=null){const n=Ch(e);t.points=tI(r,s)(n,i.points),t.hasZ=r,t.hasM=s}return t}function txe(e,t,i,r=i?.z!=null,s=i?.m!=null){if(i==null)return t;const n=Ch(e);return t.x=a0(n,i.x),t.y=l0(n,i.y),r&&(t.z=_g(n,i.z)),s&&(t.m=vg(n,i.m)),t}function ixe(e,t,i,r=i?.hasZ??!1,s=i?.hasM??!1){if(i!=null){const n=Ch(e);t.rings=DG(n,tI(r,s),i.rings),t.hasZ=r,t.hasM=s}return t}function rxe(e,t,i,r=i?.hasZ??!1,s=i?.hasM??!1){if(i!=null){const n=Ch(e);t.paths=DG(n,tI(r,s),i.paths),t.hasZ=r,t.hasM=s}return t}function FG(e,t,i,r,s,n){if(e==null)return null;const o=e.references("geometry")&&n?sxe(t,r,n):t,a=e.repurposeFeature(o,s);try{return e.evaluate(a,i)}catch(l){return H.getLogger("esri.views.2d.support.arcadeOnDemand").warn("Feature arcade evaluation failed:",l),null}}const $S=new Map;function sxe(e,t,i){const{transform:r,hasZ:s,hasM:n}=i;$S.has(t)||$S.set(t,nxe(t));const o=$S.get(t)(e.geometry,r,s,n);return{...e,geometry:o}}function nxe(e){const t={};switch(e){case"esriGeometryPoint":return(i,r,s,n)=>txe(r,t,i,s,n);case"esriGeometryPolygon":return(i,r,s,n)=>ixe(r,t,i,s,n);case"esriGeometryPolyline":return(i,r,s,n)=>rxe(r,t,i,s,n);case"esriGeometryMultipoint":return(i,r,s,n)=>exe(r,t,i,s,n);default:return H.getLogger("esri.views.2d.support.arcadeOnDemand").error(new j("mapview-arcade",`Unable to handle geometryType: ${e}`)),i=>i}}const f5e=Object.freeze(Object.defineProperty({__proto__:null,default:FG},Symbol.toStringTag,{value:"Module"})),oxe=e=>{if(!e)return[0,0,0,0];const{r:t,g:i,b:r,a:s}=e;return[t,i,r,255*s]};var nt;let iI=(nt=class{static findApplicableOverrides(t,i,r){if(t&&i){if(t.primitiveName){let s=!1;for(const n of r)if(n.primitiveName===t.primitiveName){s=!0;break}if(!s)for(const n of i)n.primitiveName===t.primitiveName&&r.push(n)}switch(t.type){case"CIMPointSymbol":case"CIMLineSymbol":case"CIMPolygonSymbol":if(t.effects)for(const s of t.effects)nt.findApplicableOverrides(s,i,r);if(t.symbolLayers)for(const s of t.symbolLayers)nt.findApplicableOverrides(s,i,r);break;case"CIMTextSymbol":break;case"CIMSolidStroke":case"CIMPictureStroke":case"CIMGradientStroke":case"CIMSolidFill":case"CIMPictureFill":case"CIMHatchFill":case"CIMGradientFill":case"CIMVectorMarker":case"CIMCharacterMarker":case"CIMPictureMarker":if(t.effects)for(const s of t.effects)nt.findApplicableOverrides(s,i,r);if(t.markerPlacement&&nt.findApplicableOverrides(t.markerPlacement,i,r),t.type==="CIMVectorMarker"){if(t.markerGraphics)for(const s of t.markerGraphics)nt.findApplicableOverrides(s,i,r),nt.findApplicableOverrides(s.symbol,i,r)}else t.type==="CIMCharacterMarker"?nt.findApplicableOverrides(t.symbol,i,r):t.type==="CIMHatchFill"?nt.findApplicableOverrides(t.lineSymbol,i,r):t.type==="CIMPictureMarker"&&nt.findApplicableOverrides(t.animatedSymbolProperties,i,r)}}}static findEffectOverrides(t,i){if(!t)return null;if(t.type==="CIMGeometricEffectDashes"&&G7(t),!i||!t.primitiveName)return{type:"cim-effect-param",effect:t,overrides:[]};const r=m5(t),s=t.primitiveName,n=[];for(const o of i)o.primitiveName===s&&n.push(m5(o));return{type:"cim-effect-param",effect:r,overrides:q0e(n)}}static async resolveSymbolOverrides(t,i,r,s,n,o,a){if(!t?.symbol)return null;let{symbol:l,primitiveOverrides:u}=t;const c=!!u;if(!c&&!s)return l;l=V(l),u=V(u);let d=!0;if(i||(i={attributes:{}},d=!1),c){if(d||(u=u.filter((m=>!m.valueExpressionInfo?.expression.includes("$feature")))),a||(u=u.filter((m=>!m.valueExpressionInfo?.expression.includes("$view")))),u.length>0){const m=F0e(i.attributes),y={spatialReference:r,fields:m,geometryType:n};await nt.createRenderExpressions(u,y),nt.evaluateOverrides(u,i,n??"esriGeometryPoint",o,a,new ab(m))}nt.applyOverrides(l,u)}return s&&nt.applyDictionaryTextOverrides(l,i,s,null),l}static async createRenderExpressions(t,i){const r=[];for(const s of t){const n=s.valueExpressionInfo;if(!n||nt._expressionToRenderExpression.has(n.expression))continue;const o=S0e(n.expression,i.spatialReference);r.push(o),o.then((a=>nt._expressionToRenderExpression.set(n.expression,a)))}r.length>0&&await Promise.all(r)}static evaluateOverrides(t,i,r,s,n,o){const a={$view:{scale:n?.scale}};for(const l of t){l.value&&typeof l.value=="object"&&fj(l.value)&&(l.propertyName==="Color"||l.propertyName==="StrokeColor")&&(l.value=oxe(l.value));const u=l.valueExpressionInfo;if(!u)continue;const c=nt._expressionToRenderExpression.get(u.expression);c&&(l.value=FG(c,i,a,r,o,s))}}static applyDictionaryTextOverrides(t,i,r,s,n="Normal"){if(t?.type)switch(t.type){case"CIMPointSymbol":case"CIMLineSymbol":case"CIMPolygonSymbol":case"CIMTextSymbol":{const o=t.symbolLayers;if(!o)return;for(const a of o)a&&a.type==="CIMVectorMarker"&&nt.applyDictionaryTextOverrides(a,i,r,s,t.type==="CIMTextSymbol"?t.textCase:n)}break;case"CIMVectorMarker":{const o=t.markerGraphics;if(!o)return;for(const a of o)a&&nt.applyDictionaryTextOverrides(a,i,r,s)}break;case"CIMMarkerGraphic":{const o=t.textString;if(o&&o.includes("[")){const a=P0e(o,r);t.textString=I0e(i,a,s,n)}}}}static applyOverrides(t,i,r,s){if(t.primitiveName){for(const n of i)if(n.primitiveName===t.primitiveName){const o=s0(n.propertyName);if(s&&s.push({cim:t,nocapPropertyName:o,value:t[o]}),r){let a=!1;for(const l of r)l.primitiveName===t.primitiveName&&(a=!0);a||r.push(n)}n.value!=null&&(t[o]=n.value)}}switch(t.type){case"CIMPointSymbol":case"CIMLineSymbol":case"CIMPolygonSymbol":if(t.effects)for(const n of t.effects)nt.applyOverrides(n,i,r,s);if(t.symbolLayers)for(const n of t.symbolLayers)nt.applyOverrides(n,i,r,s);break;case"CIMTextSymbol":break;case"CIMSolidStroke":case"CIMSolidFill":case"CIMVectorMarker":if(t.effects)for(const n of t.effects)nt.applyOverrides(n,i,r,s);if(t.type==="CIMVectorMarker"&&t.markerGraphics)for(const n of t.markerGraphics)nt.applyOverrides(n,i,r,s),nt.applyOverrides(n.symbol,i,r,s)}}static restoreOverrides(t){for(const i of t)i.cim[i.nocapPropertyName]=i.value}static buildOverrideKey(t){let i="";for(const r of t)r.value!==void 0&&(i+=`${r.primitiveName}${r.propertyName}${JSON.stringify(r.value)}`);return i}static toValue(t,i){if(t==="DashTemplate")return i.split(" ").map((r=>Number(r)));if(t==="Color"){const r=new X(i).toRgba();return r[3]*=255,r}return i}},nt._expressionToRenderExpression=new Map,nt);const axe=Object.freeze(Object.defineProperty({__proto__:null,OverrideHelper:iI},Symbol.toStringTag,{value:"Module"})),lxe=96/72;let zG=class{constructor(t){this._spatialReference=t,this._imageDataCanvas=null,this._cimResourceManager=new jSe}get _canvas(){return this._imageDataCanvas||(this._imageDataCanvas=document.createElement("canvas")),this._imageDataCanvas}get resourceManager(){return this._cimResourceManager}async rasterizeCIMSymbolAsync(t,i,r,s,n,o,a,l,u,c){if(!t)return null;const{data:d}=t;if(!d||d.type!=="CIMSymbolReference"||!d.symbol)return null;const{symbol:m}=d;o||(o=mb(m));const y=await iI.resolveSymbolOverrides(d,i,this._spatialReference,n,o,a,l),g=this._cimResourceManager,_=[];ir.fetchResources(y,g,_),ir.fetchFonts(y,g,_),_.length>0&&await Promise.all(_);const{width:v,height:b}=r;let S=SN(o,v,b,s,c);const $=ir.getEnvelope(y,S,g);if(!$)return null;$.x===1/0&&($.x=v+2),$.y===1/0&&($.y=-b/2),$.width===-1/0&&($.width=v),$.height===-1/0&&($.height=b);let E=1,C=0,P=0;switch(m.type){case"CIMPointSymbol":case"CIMTextSymbol":{let F=1;$.width>v&&(F=v/$.width);let D=1;$.height>b&&(D=b/$.height),s==="preview"&&($.width<v&&(F=v/$.width),$.height<b&&(D=b/$.height)),E=Math.min(F,D),C=$.x+$.width/2,P=$.y+$.height/2}break;case"CIMLineSymbol":if(c){P=$.y+$.height/2,C=$.x+$.width/2;const F=$.width-v,D=$.height-b;S={paths:Mb(S.paths,{xmin:-1*$.width/2+F,xmax:$.width/2-F,ymin:-1*$.height/2+D,ymax:$.height/2-D,width:$.width-2*F,height:$.height-2*D})}}else{(u||$.height>b)&&(E=b/$.height),P=$.y+$.height/2;const F=$.x*E+v/2,D=($.x+$.width)*E+v/2,U=Vi(S)?S.paths:gi(S)?S.rings:null;if(U===null)throw new Error("Bad geometry, can't rasterise symbol!");U[0][0][0]-=F/E,U[0][2][0]-=(D-v)/E}break;case"CIMPolygonSymbol":if(c){P=$.y+$.height/2,C=$.x+$.width/2;const F=$.width-v,D=$.height-b;S={paths:Mb(S.rings,{xmin:-1*$.width/2+F,xmax:$.width/2-F,ymin:-1*$.height/2+D,ymax:$.height/2-D,width:$.width-2*F,height:$.height-2*D})}}else{C=$.x+$.width/2,P=$.y+$.height/2;const F=$.x*E+v/2,D=($.x+$.width)*E+v/2,U=$.y*E+b/2,W=($.y+$.height)*E+b/2,{rings:Y}=S;F<0&&(Y[0][0][0]-=F,Y[0][3][0]-=F,Y[0][4][0]-=F),U<0&&(Y[0][0][1]+=U,Y[0][1][1]+=U,Y[0][4][1]+=U),D>v&&(Y[0][1][0]-=D-v,Y[0][2][0]-=D-v),W>b&&(Y[0][2][1]+=W-b,Y[0][3][1]+=W-b)}}const k={type:"cim",data:{type:"CIMSymbolReference",symbol:y}};return this.rasterize(k,v,b,C,P,E,o,1,S)}rasterize(t,i,r,s,n,o,a,l=0,u=null,c=window.devicePixelRatio||1){const{data:d}=t;if(!d||d.type!=="CIMSymbolReference"||!d.symbol)return null;const{symbol:m}=d,y=this._canvas,g=c*lxe;y.width=i*g,y.height=r*g,a||(a=mb(m)),u||(u=SN(a,i,r,"legend")),y.width+=2*l,y.height+=2*l;const _=y.getContext("2d",{willReadFrequently:!0}),v=Pi.createIdentity();return v.translate(-s,-n),v.scale(o*g,-o*g),v.translate(i*g/2+l,r*g/2+l),_.clearRect(0,0,y.width,y.height),new CG(_,this._cimResourceManager,v,!0).drawSymbol(m,u),_.getImageData(0,0,y.width,y.height)}};function uxe(e,t,i,r){return t==="esriGeometryPolygon"?{rings:dN(Mb(e.rings,{xmin:0,ymin:0,width:i,height:r}),-1*i/2,-1*r/2)}:t==="esriGeometryPolyline"?{paths:dN(Mb(e.paths,{xmin:0,ymin:0,width:i,height:r}),-1*i/2,-1*r/2)}:null}function SN(e,t,i,r,s){const o=-t/2+1,a=t/2-1,l=i/2-1,u=-i/2+1;if(s&&(e==="esriGeometryPolygon"||e==="esriGeometryPolyline")){const c=uxe(s,e,t,i);if(c)return c}switch(e){case"esriGeometryPoint":return{x:0,y:0};case"esriGeometryPolyline":return{paths:[[[o,0],[0,0],[a,0]]]};default:return r==="legend"?{rings:[[[o,l],[a,0],[a,u],[o,u],[o,l]]]}:{rings:[[[o,l],[a,l],[a,u],[o,u],[o,l]]]}}}const y5e=Object.freeze(Object.defineProperty({__proto__:null,CIMSymbolRasterizer:zG},Symbol.toStringTag,{value:"Module"})),D1=new zG(null),y_=We(zt.size),xN=We(zt.maxSize),MS=We(zt.lineWidth),cxe=1;async function hxe(e,t,i){const r=t?.size;let s=r!=null&&typeof r=="object"&&"width"in r?r.width:r,n=r!=null&&typeof r=="object"&&"height"in r?r.height:r;if(!s||!n)if(i==="esriGeometryPolygon")s=n=t.maxSize?Math.min(t.maxSize,y_):y_;else{const o=await rI(e,t,i);o&&(s=o.width,n=o.height),i==="esriGeometryPolyline"&&(s=t.maxSize?Math.min(t.maxSize,MS):MS),s=s!=null&&isFinite(s)?Math.min(s,xN):y_,n=n!=null&&isFinite(n)?Math.max(Math.min(n,xN),cxe):y_}return t.style==="legend"&&i==="esriGeometryPolyline"&&(s=MS),{width:s,height:n}}async function rI(e,t={},i){const r=t.cimOptions||t;i??=r.geometryType||mb(e?.data?.symbol);const{feature:s,fieldMap:n,viewParams:o}=r,a=await iI.resolveSymbolOverrides(e.data,s,null,n,i,null,o);if(!a)return null;(e=e.clone()).data={type:"CIMSymbolReference",symbol:a},e.data.primitiveOverrides=void 0;const l=[];return ir.fetchResources(a,D1.resourceManager,l),ir.fetchFonts(a,D1.resourceManager,l),l.length>0&&await Promise.all(l),ir.getEnvelope(a,null,D1.resourceManager)}async function dxe(e,t={}){const{node:i,opacity:r,symbolConfig:s}=t,n=s!=null&&typeof s=="object"&&"isSquareFill"in s&&s.isSquareFill,o=t.cimOptions||t,a=o.geometryType||mb(e?.data?.symbol),l=await hxe(e,t,a),{feature:u,fieldMap:c}=o,d=t?.geometry||n||a!=="esriGeometryPolygon"?"preview":"legend";let m=l;const y=l;if(t?.geometry&&(a==="esriGeometryPolygon"||a==="esriGeometryPolyline")&&(Re(l.width)<200||Re(l.height)<200)){const k=l.width>l.height?We(200)*l.height/l.width:We(200);m={width:l.width>l.height?We(200):We(200)*l.width/l.height,height:k}}const g=await D1.rasterizeCIMSymbolAsync(e,u,m,d,c,a,null,o.viewParams,o.allowScalingUp,t?.geometry?.toJSON());if(!g)return null;const{width:_,height:v}=g,b=document.createElement("canvas");b.width=_,b.height=v,b.getContext("2d").putImageData(g,0,0);const S=Re(y.width),$=Re(y.height),E=new Image(S,$);E.src=b.toDataURL(),E.ariaLabel=t.ariaLabel??null,E.alt=t.ariaLabel??"",r!=null&&(E.style.opacity=`${r}`);let C=E;if(t.effectView!=null){const P={shape:{type:"image",x:0,y:0,width:S,height:$,src:E.src},fill:null,stroke:null,offset:[0,0]};C=wf([[P]],[S,$],t)}return i&&C&&i.appendChild(C),C}const pxe=Object.freeze(Object.defineProperty({__proto__:null,getCIMSymbolPreviewSize:rI,previewCIMSymbol:dxe},Symbol.toStringTag,{value:"Module"})),rE=30,sE=12,nE=24,VG=[255,255,255],Eb=[200,200,200],Dc=[128,128,128],fxe=20,mxe=5;function yxe(e){return e.declaredClass==="esri.symbols.SimpleMarkerSymbol"}function gxe(e){return e.declaredClass==="esri.symbols.PictureMarkerSymbol"}function _xe(e){return e.declaredClass==="esri.symbols.SimpleLineSymbol"}function vxe(e){return e.declaredClass==="esri.symbols.TextSymbol"}function bxe(e,t){const i=e.length-1;return e.map(((r,s)=>Jj(r,s,i,t)))}async function wxe(e,t,i,r,s,n,o){const a=t.legendOptions,l=a?.customValues,u=o||await $xe(e,i),c=t.stops,d=!!u,m=!!l,y=t.minSize!=null&&t.maxSize!=null,g=c&&c.length>1,_=!!t.target;if(!d||!m&&!(y||g&&!_))return;const v=kw(u);let b=!1,S=null,$=null;S=v&&!g?vb([t.minDataValue,t.maxDataValue]):l??await Txe(t,u,r,s?.type);const E=e?.authoringInfo,C=E?.type==="univariate-color-size",P=C&&E?.univariateTheme==="above-and-below",k=!!Oo(e,"reference-size"),F=!!Oo(e,"spike");if(!S&&g&&(S=c.map((re=>re.value)),b=c.some((re=>!!re.label)),e.type==="flow"&&(S=vb(S)),b&&($=c.map((re=>re.label)))),v&&S!=null&&S?.length>2&&!P&&(S=[S[0],S[S.length-1]]),!S)return null;C&&S?.length!==5&&(S=GG({minSize:S[0],maxSize:S[S.length-1]}));const D=v?Sxe(e,S):null,U=ove(u),W=b?null:bxe(S,n);return(await Promise.all(S.map((async(re,K)=>{let Ce=v?D[K]:await xd(t,u,re,r,s?.type),Ve=Ce;k&&(Ce*=nE/t.maxSize||1,Ve=nE);const Je=Pxe(u,Ce,e,K);return F&&Je.type==="cim"&&(Ve=await rI(Je)),{value:re,symbol:Je,label:b?$[K]:W[K],size:Ve,outlineSize:U}})))).reverse()}function Sxe(e,t){const i=e?.authoringInfo,r=i?.type==="univariate-color-size";let s=[sE,rE];if(r){const n=t[0],o=t[t.length-1],a=sE,l=rE;s=t.map((u=>a+(u-n)/(o-n)*(l-a)))}return r&&i?.univariateTheme==="below"&&s.reverse(),s}function xxe(e,t){const i=e.classBreakInfos,r=i.length,s=r<2||!(t>=2)?i[0].symbol.clone():i[r-1].symbol.clone();return e.visualVariables?.some((o=>o.type==="color"))&&(s.type.includes("3d")?UG(s):jG(s)),s}async function $xe(e,t){if(e.type==="flow")return Xj(e,t);if(e.type==="pie-chart")return new Ct({color:null,outline:e.outline?.width?e.outline:new Nt});let i=null,r=null;if(e.type==="simple")i=e.symbol;else if(e.type==="class-breaks"){const s=e.classBreakInfos;i=s&&s[0]&&s[0].symbol,r=s.length>1}else if(e.type==="unique-value"){const s=e.uniqueValueInfos;i=s?.[0]?.symbol,r=s!=null&&s.length>1}if(!i||Mxe(i))return null;if(i=i.clone(),t||r)if(i.type.includes("3d"))UG(i);else if(Oo(e,"reference-size")&&i.type==="cim")zP(i,{color:t??(e.type!=="class-breaks"?new X(Eb):null)});else if(Oo(e,"spike")&&i.type==="cim"){const s=new X(Eb),n=new X(Dc),o=i.data.symbol?.type==="CIMPointSymbol"?i.data.symbol:null,a=!!o?.symbolLayers?.find((({type:c})=>c==="CIMSolidStroke"))?.colorLocked;let l,u=t??void 0;if(u){const c=Sj(u),d=l9();(!d&&c>225||d&&c<25)&&(u=s,l=a?n:s)}else u=s,l=a?n:s;eG(i,{color:u,strokeColor:l})}else jG(i);return i}function Mxe(e){return qo(e)?e.symbolLayers?.some((t=>t?.type==="fill"))??!1:e?.type.includes("fill")??!1}function UG(e){e.type==="line-3d"?e.symbolLayers.forEach((t=>{t.material={color:Dc}})):e.symbolLayers.forEach((t=>{t.type!=="icon"||t.resource?.href?t.material={color:Eb}:(t.material={color:VG},t.outline={color:Dc,size:1.5})}))}function jG(e){const t=l9();e.type==="cim"?pj(e,new X(Eb)):e.type.includes("line")?e.color=Dc:(e.color=t?Dc:VG,e.type==="simple-marker"&&(e.outline?e.outline?.color?.toHex()==="#ffffff"&&(e.outline.color=Dc):e.outline={color:Dc,width:1.5}))}async function Txe(e,t,i,r){const s=(await J(async()=>{const{getSizeRangeAtScale:a}=await Promise.resolve().then(()=>Mh);return{getSizeRangeAtScale:a}},void 0)).getSizeRangeAtScale(e,i,r),n=s&&GG(s);if(!s||!n)return;let o=n.map((a=>Exe(a,e,s)));o=vb(o);for(let a=1;a<o.length-1;a++){const l=await Cxe(e,t,o[a],o[a-1],i,r);l&&(o[a]=l[0],n[a]=l[1])}return o}function GG(e){const t=e.minSize,i=e.maxSize,r=mxe,s=(i-t)/(r-1),n=[];for(let o=0;o<r;o++)n.push(t+s*o);return n}function Exe(e,t,i){const r=i.minSize,s=i.maxSize,n=t.minDataValue,o=t.maxDataValue;let a;return e<=r?a=n:e>=s?a=o:a=(e-r)/(s-r)*(o-n)+n,a}async function Cxe(e,t,i,r,s,n){const o=await xd(e,t,i,s,n),a=await xd(e,t,r,s,n),l=_b(i),u=l.fractional,c=fxe;let d=l.integer,m=null,y=null;i>0&&i<1&&(m=10**u,d=_b(i*=m).integer);for(let g=d-1;g>=0;g--){const _=10**g;let v=Math.floor(i/_)*_,b=Math.ceil(i/_)*_;m!=null&&(v/=m,b/=m);let S=(v+b)/2;[,S]=vb([v,S,b],{indexes:[1]});const $=await xd(e,t,v,s,n),E=await xd(e,t,b,s,n),C=await xd(e,t,S,s,n),P=L1(o,$,a,null),k=L1(o,E,a,null),F=L1(o,C,a,null);let D=P.previous<=c,U=k.previous<=c;if(D&&U&&(P.previous<=k.previous?(D=!0,U=!1):(U=!0,D=!1)),D?y=[v,$]:U?y=[b,E]:F.previous<=c&&(y=[S,C]),y)break}return y}async function xd(e,t,i,r,s){const{getSize:n}=await J(()=>Promise.resolve().then(()=>Mh),void 0);return n(e,i,{scale:r,view:s,shape:t.type==="simple-marker"?t.style:null})}function Pxe(e,t,i,r){i?.authoringInfo?.type==="univariate-color-size"&&i?.authoringInfo?.univariateTheme==="above-and-below"&&i.type==="class-breaks"&&(e=xxe(i,r));const s=e.clone();if(qo(s))kw(s)||s.symbolLayers.forEach((n=>{n.type!=="fill"&&(n.size=t)}));else if(yxe(s))s.size=t;else if(gxe(s)){const n=s.width,o=s.height;s.height=t,s.width=t*(n/o)}else _xe(s)?s.width=t:vxe(s)?s.font&&(s.font.size=t):s.type==="cim"&&Oo(i,"reference-size")?zP(s,{innerDotSize:t,outerRingSize:nE}):s.type==="cim"&&Oo(i,"spike")&&eG(s,{defaultHeight:t,primitiveOverrides:null});return s}function Ixe(e){const i=Math.floor(Math.log10(Math.abs(e)))+1,r=i<4||i>6?4:i,s=1e6,n=Math.abs(e)>=s?"compact":"standard";return mu(e,{notation:n,minimumSignificantDigits:2,maximumSignificantDigits:r})}const $N=16,Axe="https://utility.arcgis.com/sharing/tools/legend",Lxe="esri.layers.ImageryLayer",kxe="esri.layers.ImageryTileLayer",Rxe="esri.layers.WCSLayer",g_=/^\s*(return\s+)?\$view\.scale\s*(;)?\s*$/i,Oxe=new Ye({esriGeometryPoint:"point",esriGeometryMultipoint:"multipoint",esriGeometryPolyline:"polyline",esriGeometryPolygon:"polygon",esriGeometryMultiPatch:"multipatch"}),__=new Ct({size:6,outline:{color:[128,128,128,.5],width:.5}}),Nxe=new $r({style:"solid"});function oE(e){return e.type==="flow"}function BG(e){return e.type==="vector-field"}function qG(e){return e.type==="raster-colormap"}function HG(e){return e.type==="raster-stretch"}function WG(e){return e.type==="raster-shaded-relief"}function $d(e){return e.declaredClass==="esri.renderers.SimpleRenderer"}function cc(e){return e.declaredClass==="esri.renderers.ClassBreaksRenderer"}function hc(e){return e.declaredClass==="esri.renderers.UniqueValueRenderer"}function ZG(e){return e.declaredClass==="esri.renderers.HeatmapRenderer"}function Dxe(e){return sI(e)||nI(e)||oI(e)||Fxe(e)}function Fxe(e){return e.declaredClass==="esri.renderers.PointCloudRGBRenderer"}function sI(e){return e.declaredClass==="esri.renderers.PointCloudClassBreaksRenderer"}function nI(e){return e.declaredClass==="esri.renderers.PointCloudStretchRenderer"}function oI(e){return e.declaredClass==="esri.renderers.PointCloudUniqueValueRenderer"}function YG(e){return e.declaredClass==="esri.renderers.DotDensityRenderer"}function JG(e){return e.declaredClass==="esri.renderers.PieChartRenderer"}function zxe(e,t){return $d(e)||cc(e)||hc(e)||ZG(e)||YG(e)||JG(e)?t.type==="2d"||uj(e):HG(e)||qG(e)||WG(e)||sI(e)||nI(e)||oI(e)||BG(e)||oE(e)}function Vxe(e){return e.declaredClass==="esri.layers.BuildingSceneLayer"}function TS(e){return e.declaredClass==="esri.layers.SubtypeGroupLayer"}function Uxe(e){return e.declaredClass==="esri.layers.VoxelLayer"}function jxe(e){return e.declaredClass==="esri.layers.WMSLayer"}function Gxe(e){return e.declaredClass==="esri.layers.WMTSLayer"}function ES(e){return e.declaredClass==="esri.layers.MapImageLayer"}function MN(e){return e.declaredClass==="esri.layers.TileLayer"}function Qh(e){return e.declaredClass===Lxe}function v_(e){return e.declaredClass===kxe}function Bxe(e){return e.declaredClass===Rxe}function qxe(e){return e.type==="stretch-ramp"}function Hxe(e){return("authoringInfo"in e?e?.authoringInfo:null)?.type==="univariate-color-size"}function Wxe(e){const t="authoringInfo"in e?e?.authoringInfo:null;return t?.type==="univariate-color-size"&&t?.univariateTheme==="above-and-below"}function TN(e){return"sublayers"in e}function EN(e){return e&&"symbol"in e}async function ra(e,t){const i=await uC("esri/widgets/Legend/t9n/Legend");return e!=="previewTemplateAriaLabel"||t||(e="previewAriaLabel"),mv(i[e],{label:t})}function Zxe(e,t){const{field:i,field2:r,field3:s,fieldDelimiter:n,valueExpression:o}=e;if(!i)return null;const a=!i&&!o||!r&&!s?[t]:t?.toString().split(n||""),l=i?{[i]:a?.[0]}:null;return l&&(r&&(l[r]=a?.[1]),s&&(l[s]=a?.[2])),l}const Yxe=new Ct({style:"path",path:"M10,5 L5,0 0,5 M5,0 L5,15",size:15,outline:{width:1,color:[85,85,85,1]}});let ed={},Gt=class extends le{constructor(e){super(e),this._hasColorRamp=!1,this._hasOpacityRamp=!1,this._hasSizeRamp=!1,this._webStyleSymbolCache=new Map,this._dotDensityUrlCache=new Map,this._scaleDrivenSizeVariable=null,this._hasClusterSizeVariable=!1,this._layerDefinitionExpression=null,this._layerDefinitionExpressionClause=null,this._layerDisplayFilterId=null,this._layerDisplayFilterClause=null,this.children=new ne,this.layerView=null,this.layer=null,this.legendElements=[],this.parent=null,this.hideLayersNotInCurrentView=!1,this.keepCacheOnDestroy=!1,this.respectLayerDefinitionExpression=!1,this.respectLayerVisibility=!0,this.sublayerIds=[],this.title=null,this.view=null}initialize(){const e=()=>this.notifyChange("ready");this.addHandles([In((()=>this.children),"change",(t=>{const{added:i,removed:r}=t;i.forEach((s=>{const n=`activeLayerInfo-ready-watcher-${s.layer.uid}`;this.addHandles(te((()=>s.ready),e,Pt),n)})),r.forEach((s=>this.removeHandles(s.layer.uid))),e()}))]),this.keepCacheOnDestroy||(ed={})}destroy(){this._webStyleSymbolCache=null,this._dotDensityUrlCache=null,this._scaleDrivenSizeVariable=null,this.keepCacheOnDestroy||(ed=null),this._layerDefinitionExpressionClause=null}get effectList(){const e=this.layer;let t=null;return"effect"in e&&e.effect&&(t=new dn,t.effect=e.effect,t.endTransition(),t.scale=this.scale),t}get opacity(){const e=this.layer.opacity,t=this.parent?.opacity,i=this.layer.parent,r=i&&"uid"in i?this._getParentLayerOpacity(i):null;return t!=null?t*e:r!=null?r*e:e}get ready(){return this.layer===null||(this.children.length>0?this._isGroupActive():this.legendElements.length>0)}get scale(){return this.view?.scale??0}get isScaleDriven(){const e=this.layer;if(e===null)return!1;if("effect"in e&&e.effect&&Array.isArray(e.effect))return!0;if("featureReduction"in e&&e.featureReduction){if(e.featureReduction.type==="cluster")return!0;if(e.featureReduction.type==="binning"&&"renderer"in e.featureReduction&&e.featureReduction.renderer)return this._isRendererScaleDriven(e.featureReduction.renderer)}return"renderer"in e&&e.renderer?!!("displayFilterInfo"in e&&e.displayFilterInfo&&hc(e.renderer))||this._isRendererScaleDriven(e.renderer):this._isLayerScaleDriven(this.layer)}get version(){return this._get("version")+1}async buildLegendElementsForFeatureCollections(e){if(!(!this.hideLayersNotInCurrentView||await this._isLayerInCurrentView()))return this.legendElements=[],void this.notifyChange("ready");const t=Array.from(e,(i=>{if(OK(i))return this._getRendererLegendElements(i.renderer,{title:i.title});if(i.featureSet?.features.length){const r=i.layerDefinition,s=r?.drawingInfo,n=s&&K_e(s.renderer),o=Oxe.read(r.geometryType);return n?this._getRendererLegendElements(n,{title:i.name,geometryType:o}):(H.getLogger(this).warn("drawingInfo not available!"),null)}return null}));try{const i=[],r=await Promise.allSettled(t);for(const s of r)if(s.status==="fulfilled")for(const n of s.value??[])i.push(n);this.legendElements=i,this.notifyChange("ready")}catch(i){H.getLogger(this).warn("error while building legend for layer!",i)}}async buildLegendElementsForRenderer(e){try{const t=!this.hideLayersNotInCurrentView||await this._isLayerInCurrentView();this.legendElements=t?await this._getRendererLegendElements(e):[],this.notifyChange("ready")}catch(t){H.getLogger(this).warn("error while building legend for layer!",t)}}async buildLegendElementsForFeatureReduction(e){try{const t=!this.hideLayersNotInCurrentView||await this._isLayerInCurrentView();this.legendElements=t?await this._getLegendElementsForFeatureReduction(e):[],this.notifyChange("ready")}catch(t){H.getLogger(this).warn("error while building legend for layer!",t)}}async buildLegendElementsForTools(){const e=this.layer;if(Uxe(e))this._constructLegendElementsForVoxelLayer();else if(Gxe(e))this._constructLegendElementsForWMTSlayer();else if(jxe(e))await this._constructLegendElementsForWMSSublayers();else if(Vxe(e))await this._constructLegendElementsForBuildingSceneLayer();else if(ES(e)||MN(e)||TS(e))await this._constructLegendElementsForSublayers();else{this.removeHandles("imageryLayers-watcher");let t="default";if(Qh(e)&&(t=(e?.rasterFunction?.functionName||"default")+"_"+(e.bandIds?.length?e.bandIds.join(""):"###")),v_(e)||e.type==="link-chart")return;await this._getLegendLayers(`${e.uid}-${t}`).then((async i=>{this.legendElements=[],this.notifyChange("ready");const r=i.map((async s=>{if(Qh(e)){const o=te((()=>[e.rasterFunction,e.bandIds]),(()=>yD((async()=>{ed.default=null,e.renderer?await this.buildLegendElementsForRenderer(e.renderer):await this.buildLegendElementsForTools()}))()));this.addHandles(o,"imageryLayers-watcher")}const n=this._generateSymbolTableElementForLegendLayer(s);n?.infos.length&&(Qh(e)&&(n.title=e.title),this.legendElements.push(n)),this.notifyChange("ready")}));await Promise.allSettled(r)})).catch((i=>{H.getLogger(this).warn("Request to server for legend has failed!",i)}))}}async _isLayerInCurrentView(){const e=this.layer,t=this.layerView,i=t&&"createQuery"in t&&"queryFeatureCount"in t;if(!i&&!(t&&"createQuery"in e&&"queryFeatureCount"in e))return!0;await Vg((()=>!t.updating));const r=i?"createQuery"in t&&t.createQuery():"createQuery"in e&&e.createQuery();return r?(r.geometry=this.view.extent,(i?"queryFeatureCount"in t&&await t.queryFeatureCount(r):"queryFeatureCount"in e&&await e.queryFeatureCount(r))!==0):!0}_getParentLayerOpacity(e){let t=1;const i=e.parent;return i&&"uid"in i&&(t=this._getParentLayerOpacity(i)),e.opacity*t}_isGroupActive(){return this.children.some((e=>e.ready))}_isRendererScaleDriven(e){if(e.type==="dot-density")return!0;const t="valueExpression"in e?e.valueExpression:null;return g_.test(t)?!0:!!("visualVariables"in e?e.visualVariables:null)?.some((r=>this._isScaleDrivenSizeVariable(r)))||this._hasScaleDrivenSymbols(e)}_hasScaleDrivenSymbols(e){switch(e.type){case"simple":return this._isScaleDrivenSymbol(e.symbol);case"class-breaks":return this._isScaleDrivenSymbol(e.defaultSymbol)||e.classBreakInfos.some((t=>this._isScaleDrivenSymbol(t.symbol)));case"unique-value":return this._isScaleDrivenSymbol(e.defaultSymbol)||!!e.uniqueValueInfos?.some((t=>this._isScaleDrivenSymbol(t.symbol)))}return!1}_isScaleDrivenSymbol(e){if(e?.type==="cim"){const{primitiveOverrides:t,minScale:i,maxScale:r}=e.data,s=t?.some((n=>/\$view\.scale/.test(n.valueExpressionInfo?.expression||"")))??!1;return i!=null||r!=null||s}return!1}_isScaleDrivenSizeVariable(e){if(e&&e.type!=="size")return!1;const t=e,i=t.minSize,r=t.maxSize;return!(typeof i!="object"||!i||!this._isScaleDrivenSizeVariable(i))||!(typeof r!="object"||!r||!this._isScaleDrivenSizeVariable(r))||g_.test(t.valueExpression)}_isLayerScaleDriven(e){if("minScale"in e&&e.minScale>0||"maxScale"in e&&e.maxScale>0)return!0;if("sublayers"in e&&e.sublayers)return e.sublayers.some((i=>this._isLayerScaleDriven(i)));const t=e.parent;if(e.loaded===!1&&t&&ES(t)&&"source"in e&&e.source&&e.source.type==="map-layer"){for(const i of t.sourceJSON.layers??[])if(i.id===e.source.mapLayerId&&(i.minScale>0||i.maxScale>0))return!0}return!1}async _constructLegendElementsForVoxelLayer(){this.legendElements=[],this.removeHandles("voxel-style-watcher"),this.removeHandles("voxel-current-variable");const e=this.layer;this.addHandles(te((()=>e.currentVariableId),(()=>this._constructLegendElementsForVoxelLayer())),"voxel-current-variable"),this.addHandles(te((()=>e.getVariableStyles()),(()=>this._constructLegendElementsForVoxelLayer())),"voxel-style-watcher");const t=e.getVariableStyle(null),i=[];if(t){if(t.uniqueValues?.length){const r=[];t.uniqueValues.forEach((s=>{s.enabled&&r.push({label:s.label||`${s.value}`,value:s.value,symbol:new $r({color:s.color,outline:null})})})),r.length&&i.push({type:"symbol-table",title:t.label,infos:r})}else if(t.transferFunction){const{colorStops:r,stretchRange:s}=t.transferFunction,n=r.toArray().reverse(),o=s.map(((l,u)=>`${u===0?Zj:Yj} ${Ixe(l)}`)).reverse(),a=n.map((l=>({color:l.color,value:null,label:null})));a[0].label=o[0],a[a.length-1].label=o[1],i.push({type:"color-ramp",title:t.label,infos:a,preview:ac(n.map((l=>l.color)),{ariaLabel:await ra("previewColorRampAriaLabel")})})}}await this._generatePreviewsForLegendElements(i,{opacity:e.opacity}),this.legendElements=i,this.notifyChange("ready")}_constructLegendElementsForWMTSlayer(){this.legendElements=[],this.removeHandles("wmts-activeLayer-watcher");const e=this.layer.activeLayer;this.addHandles(te((()=>{const{layer:i}=this;return i&&"activeLayer"in i&&i.activeLayer}),(()=>this._constructLegendElementsForWMTSlayer())),"wmts-activeLayer-watcher");const t=e.styleId?e.styles?.find((({id:i})=>i===e.styleId))?.legendUrl:void 0;t&&(this.legendElements=[{type:"symbol-table",title:e.title,infos:[{src:t,opacity:this.opacity}]}]),this.notifyChange("ready")}async _constructLegendElementsForWMSSublayers(){this.legendElements=[],this.removeHandles("wms-sublayers-watcher");const e=this.layer;let t=null;(e.customParameters||e.customLayerParameters)&&(t={...e.customParameters,...e.customLayerParameters}),this.addHandles(te((()=>{const{layer:i}=this;return i&&"sublayers"in i&&i.sublayers}),(()=>this._constructLegendElementsForWMSSublayers())),"wms-sublayers-watcher"),this.legendElements=await this._generateLegendElementsForWMSSublayers(e.sublayers,t),this.notifyChange("ready")}async _generateLegendElementsForWMSSublayers(e,t){const i=this.layer,r=[];this.addHandles(e.on("change",(()=>this._constructLegendElementsForWMSSublayers())),"wms-sublayers-watcher");const s=this.sublayerIds?.map((o=>i.findSublayerById(o)))?.filter(rr)??[],n=s.length?s:e.toArray();for(const o of n){const a=te((()=>[o.title,o.visible,o.legendEnabled]),(()=>this._constructLegendElementsForWMSSublayers()));if(this.addHandles(a,"wms-sublayers-watcher"),!this.respectLayerVisibility||o.visible&&o.legendEnabled){const l=await this._generateSymbolTableElementForWMSSublayer(o,t);l?.infos.length&&r.unshift(l)}}return r}async _generateSymbolTableElementForWMSSublayer(e,t){if(!e.legendUrl&&e.sublayers){const i=(await this._generateLegendElementsForWMSSublayers(e.sublayers,t)).filter((r=>r));return{type:"symbol-table",title:e.title,infos:i}}return this._generateSymbolTableElementForLegendUrl(e,t)}async _generateSymbolTableElementForLegendUrl(e,t){let i=e.legendUrl;if(!i)return;const r={type:"symbol-table",title:e.title||e.name||String(e.id??""),infos:[]};t&&(i=w_(i,t));let s=null;const n=e.layer?.opacity;try{s=(await at(i,{responseType:"image"})).data,s&&(s.style.opacity=n)}catch{}return r.infos.push({src:i,preview:s,opacity:n}),r}_getLegendLayers(e,t){const i=ed&&ed[e];return i?Promise.resolve(i):this._legendRequest(t).then((r=>{const s=r.layers;return ed[e]=s,s}))}_legendRequest(e){const t=this.layer;let i={f:"json",dynamicLayers:e};if(Qh(t)){const s=t.exportImageServiceParameters.rasterFunction;if(s&&(i.renderingRule=JSON.stringify(s.functionDefinition?.toJSON()||s.toJSON())),t.bandIds&&(i.bandIds=t.bandIds.join()),t.raster||t.viewId||t.customParameters){const{raster:n,viewId:o,customParameters:a}=t;i={raster:n,viewId:o,...i,...a}}}let r=t.url.replace(/(\/)+$/,"");if("version"in t&&+t.version>=10.01){const s=r.indexOf("?");s>-1?r=r.slice(0,s)+"/legend"+r.slice(s):r+="/legend"}else{const s=r.toLowerCase().indexOf("/rest/"),n=s===-1?r:r.slice(0,s)+r.slice(s+5);r=Axe+"?soapUrl="+encodeURI(n)+"&returnbytes=true"}return at(r,{query:i}).then((s=>s.data))}async _constructLegendElementsForBuildingSceneLayer(){this.legendElements=[],this.removeHandles("sublayers-watcher");const e=this.layer;this.addHandles(te((()=>e.sublayers),(()=>this._constructLegendElementsForBuildingSceneLayer())),"sublayers-watcher");try{this.legendElements=await this._generateLegendElementsForBuildingSublayers(e.sublayers,this.opacity),this.notifyChange("ready")}catch(t){H.getLogger(this).warn("Request to server for legend has failed!",t)}}async _generateLegendElementsForBuildingSublayers(e,t){let i=[];this.addHandles(e.on("change",(()=>this._constructLegendElementsForBuildingSceneLayer())),"sublayers-watcher");const r=e.toArray();for(const s of r){const n=te((()=>["renderer"in s&&s.renderer,s.opacity,s.title,s.visible]),(()=>this._constructLegendElementsForBuildingSceneLayer()));if(this.addHandles(n,"sublayers-watcher"),!this.respectLayerVisibility||s.visible){const o=s?.opacity!=null?s.opacity:null,a=o!=null?o*t:t;if(s.type==="building-group"){const l={type:"symbol-table",title:s.title,infos:[]},u=await this._generateLegendElementsForBuildingSublayers(s.sublayers,a);l.infos.push(...u),i=[l,...i]}else s.renderer&&(i=[...await this._getRendererLegendElements(s.renderer,{title:s.title,opacity:a,sublayer:s}),...i])}}return i.filter((s=>!!s&&(!("infos"in s)||!s.infos||s.infos.length>0)))}async _constructLegendElementsForSublayers(){this.legendElements=[],this.removeHandles("sublayers-watcher");const e=this.layer;if(ES(e)||MN(e)||TS(e)){this.addHandles(te((()=>e.sublayers),(()=>this._constructLegendElementsForSublayers)),"sublayers-watcher");try{this.legendElements=await this._generateLegendElementsForSublayers(e.sublayers,this.opacity),this.notifyChange("ready")}catch(t){H.getLogger(this).warn("Request to server for legend has failed!",t)}}}async _generateLegendElementsForSublayers(e,t,i){const r=this.layer;let s=[];this.addHandles(e.on("change",(()=>this._constructLegendElementsForSublayers())),"sublayers-watcher");let n=e.toArray();!i&&this.sublayerIds&&this.sublayerIds.length&&(n=TS(r)?this.sublayerIds.map((o=>r.findSublayerForSubtypeCode(o))).filter(rr):this.sublayerIds.map((o=>r.findSublayerById(o))).filter(rr));for(const o of n){const a=te((()=>[o.renderer,o.opacity,o.title,o.visible,o.legendEnabled]),(()=>this._constructLegendElementsForSublayers()));if(this.addHandles(a,"sublayers-watcher"),!this.respectLayerVisibility||o.visible&&o.legendEnabled&&this._isSublayerInScale(o)){const l=o?.opacity!=null?o.opacity:null,u=l!=null?l*t:t,c=!TN(o)||o.originIdOf("renderer")>Ie.SERVICE&&!o.sublayers;if(o.renderer&&c)await o.load(),s=[...await this._getRendererLegendElements(o.renderer,{title:o.title,opacity:u,sublayer:o}),...s];else if(TN(o)){const d=await this._generateSymbolTableElementForSublayer(o,u,i);d&&s.unshift(d)}}}return s.filter((o=>!!o&&(!("infos"in o)||!o.infos||o.infos.length>0)))}async _generateSymbolTableElementForSublayer(e,t,i){if(!i){i=new Map;const s=this.layer,n=e.source;let o=null;if(!(!n||n.type==="map-layer"&&n.mapLayerId===e.id&&(!n.gdbVersion||n.gdbVersion===("gdbVersion"in s&&s.gdbVersion)))||e.originIdOf("renderer")>Ie.SERVICE||e.originIdOf("labelingInfo")>Ie.SERVICE||e.originIdOf("labelsVisible")>Ie.SERVICE){const l=new Ms({layer:this.layer});o=l.hasDynamicLayers?l.dynamicLayers:null,l.destroy()}const a=o||`${s.uid}-default`;(await this._getLegendLayers(a,o)).forEach((l=>i.set(l.layerId,l)))}const r=i.get(e.id);if((!r||r?.subLayerIds&&r.defaultVisibility)&&e.sublayers){const s=await this._generateLegendElementsForSublayers(e.sublayers,t,i);return{type:"symbol-table",title:e.title,infos:s}}return this._generateSymbolTableElementForLegendLayer(r,e,t)}_generateSymbolTableElementForLegendLayer(e,t,i){if(!e?.legend||this.respectLayerVisibility&&!this._isLegendLayerInScale(e,t))return null;const r=t?.renderer;let s=t?.title||e.layerName;if(r&&(!t||t?.originIdOf("renderer")>Ie.SERVICE)){const a=t?.title||this._getRendererTitle(r,t);a&&(s&&typeof a!="string"&&"title"in a&&(a.title=s),s=a)}const n={type:"symbol-table",title:s,legendType:e.legendType||null,infos:[]},o=t?this._sanitizeLegendForSublayer(e.legend.slice(),t):e.legend;return e.legendGroups&&e.legendGroups.length>0?e.legendGroups.forEach((a=>{const l={type:"symbol-table",title:a.heading,legendType:e.legendType||null,infos:this._generateSymbolTableElementInfosForLegendLayer(o.filter((u=>u.groupId===a.id)),e.layerId,i)};l.infos?.length>0&&n.infos.push(l)})):n.infos=this._generateSymbolTableElementInfosForLegendLayer(o,e.layerId,i),n.infos.length>0?n:null}_generateSymbolTableElementInfosForLegendLayer(e,t,i){return e.map((r=>{let s=r.url;if(r.imageData&&r.imageData.length>0)s=`data:image/png;base64,${r.imageData}`;else{if(s.indexOf("http")===0)return null;s=oH(`${this.layer.url}/${t}/images/${s}`)}return{label:r.label,src:s,opacity:i??this.opacity,width:r.width,height:r.height}})).filter(rr)}_isSublayerInScale(e){const t=e.minScale||0,i=e.maxScale||0;return!(t>0&&t<this.scale||i>this.scale)}_isLegendLayerInScale(e,t){const i=t||this.layer;let r=null,s=null,n=!0;return!i.minScale&&i.minScale!==0||!i.maxScale&&i.maxScale!==0?(e.minScale===0&&i.tileInfo&&(r=i.tileInfo.lods[0].scale),e.maxScale===0&&i.tileInfo&&(s=i.tileInfo.lods[i.tileInfo.lods.length-1].scale)):(r=Math.min(i.minScale,e.minScale)||i.minScale||e.minScale,s=Math.max(i.maxScale,e.maxScale)),(r>0&&r<this.scale||s>this.scale)&&(n=!1),n}_sanitizeLegendForSublayer(e,t){if("version"in this.layer&&+this.layer.version<10.1||e.length===0)return e;const i=t.renderer,r=e.some((o=>o.values));let s=0,n=null;return r&&e.some(((o,a)=>(o.values||(s=a,n=o,n.label||(n.label="others")),n!=null))),i?i.type==="unique-value"?n&&(e.splice(s,1),e.push(n)):i.type==="class-breaks"&&(n&&e.splice(s,1),i.legendOptions?.order||e.reverse(),n&&e.push(n)):n&&(e.splice(s,1),e.push(n)),e}async _getRendererLegendElements(e,t={}){if(!zxe(e,this.view))return H.getLogger(this).warn(`Renderer of type '${e.type}' not supported!`),[];if(Dxe(e))return this._constructPointCloudRendererLegendElements(e,t);if(YG(e))return this._constructDotDensityRendererLegendElements(e);const i=await this._loadRenderer(e);return JG(i)?this._constructPieChartRendererLegendElements(i):this._constructRendererLegendElements(i,t)}async _getLegendElementsForFeatureReduction(e){let t=null;return e.type==="binning"?t=e.renderer:e.type==="cluster"&&(t=this._getClusterRenderer(e)),t?this._getRendererLegendElements(t):[]}_getPointCloudRendererTitle(e){return(e.legendOptions?.title||e.field)??""}async _constructPointCloudRendererLegendElements(e,t={}){const i=t.title,r=[];let s=null,n=null;if(sI(e))s={type:"symbol-table",title:i||this._getPointCloudRendererTitle(e),infos:[]},e.colorClassBreakInfos.forEach((o=>{s.infos.unshift({label:o.label||o.minValue+" - "+o.maxValue,value:[o.minValue,o.maxValue],symbol:this._getAppliedCloneSymbol(__,o.color)})}));else if(nI(e)){const o=e.stops;let a=null;if(o?.length&&(o.length===1&&(a=o[0].color),!a)){const u=o[0].value,c=o[o.length-1].value;u!=null&&c!=null&&(a=Qj(u+(c-u)/2,o))}s={type:"symbol-table",title:null,infos:[{label:null,value:null,symbol:this._getAppliedCloneSymbol(__,a||__.color)}]};const l=fbe(e.stops??[])??[];n={type:"color-ramp",title:i||this._getPointCloudRendererTitle(e),infos:l,preview:ac(l.map((u=>u.color)),{ariaLabel:await ra("previewColorRampAriaLabel")})}}else oI(e)&&(s={type:"symbol-table",title:i||this._getPointCloudRendererTitle(e),infos:[]},e.colorUniqueValueInfos?.forEach((o=>{s.infos.push({label:o.label||o.values.join(", "),value:o.values.join(", "),symbol:this._getAppliedCloneSymbol(__,o.color)})})));return s?.infos.length&&r.push(s),n?.infos.length&&r.push(n),await this._generatePreviewsForLegendElements(r,{opacity:this.opacity,symbolConfig:{applyColorModulation:!!e.colorModulation}}),r}async _getElementInfoForDotDensity(e,t){const{color:i,label:r,valueExpressionTitle:s}=t,{backgroundColor:n,outline:o,dotSize:a}=e,l=this.effectList,u=l?.effects.map((b=>b.toJSON())),c=rb(u),d=await ra("previewTemplateAriaLabel",r||s),m=a+"-"+i+"-"+n+"-"+(o&&JSON.stringify(o.toJSON()))+"-"+c,y=this._dotDensityUrlCache,g=y.has(m)?y.get(m):Wve(e,i,{ariaLabel:d});y.set(m,g);const _={shape:{type:"image",x:0,y:0,width:g.width,height:g.height,src:g.src},fill:null,stroke:null,offset:[0,0]},v=wf([[_]],[g.width,g.height],{effectView:this.effectList,ariaLabel:d});return{opacity:1,src:g.src,preview:v,width:g.width,height:g.height}}async _constructDotDensityRendererLegendElements(e){const t=e.calculateDotValue(this.view.scale),i=e.legendOptions?.unit,r={type:"symbol-table",title:{value:t&&Math.round(t),unit:i||""},infos:[]};for(const s of e.attributes){const n=await this._getElementInfoForDotDensity(e,s);n.label=s.label||s.valueExpressionTitle||s.field,r.infos.push(n)}return[r]}async _constructPieChartRendererLegendElements(e){const t=[];let i=null;const r=e.outline;e.attributes.forEach((o=>{const a=new Ct({color:o.color,outline:r}),l=o.label||o.valueExpressionTitle||o.field;t.push({label:l,symbol:a})}));const s=t.length?[...t]:[];if(e.othersCategory?.color&&e.othersCategory?.threshold!==0){const o=new Ct({color:e.othersCategory.color,outline:r});i=e.othersCategory.label||"Other",t.push({label:i,symbol:o})}if(e.defaultColor?.a){const o=new Ct({color:e.defaultColor,outline:r});t.push({label:e.defaultLabel,symbol:o})}const n=await this._getVisualVariableLegendElements(e,this.layer)||[];if(t.length){n.unshift({type:"symbol-table",title:null,infos:t});const o=s.filter((l=>l.label!==i)).map((l=>l.symbol.color)).filter(Boolean),a=Zve(o,{holePercentage:e.holePercentage,backgroundColor:e.backgroundFillSymbol?.color,effectList:this.effectList,outline:r,ariaLabel:await ra("previewPieChartAriaLabel")});n.unshift({type:"pie-chart-ramp",title:this._getRendererTitle(e,this.layer),infos:t,preview:a})}return await this._generatePreviewsForLegendElements(n,{opacity:this.layer.opacity,effectView:this.effectList}),n}async _getWhereClause(e,t,i){const r=await b8(e,i),s=new Set,{field:n,field2:o,field3:a}=t;Yp(s,i,[n,o,a]),ur(s,i,t.valueExpression);const l=new Set(Array.from(s,(c=>c.toLowerCase())));return r?.fieldNames.map((c=>c.toLowerCase()))?.some((c=>!l.has(c)))?null:r}async _processDefinitionExpression(e,t){if(!("definitionExpression"in e))return;const i=e.definitionExpression;i&&this.respectLayerDefinitionExpression?this._layerDefinitionExpression!==i&&(this._layerDefinitionExpressionClause=await this._getWhereClause(i,t,e.fieldsIndex)):this._layerDefinitionExpressionClause=null,this._layerDefinitionExpression=i}async _processDisplayFilter(e,t){if(!("displayFilterInfo"in e))return;const i=e.displayFilterInfo?Wye(e.displayFilterInfo,this.view):null;return i?.where?this._layerDisplayFilterId!==i?.id&&(this._layerDisplayFilterClause=await this._getWhereClause(i.where,t,e.fieldsIndex)):this._layerDisplayFilterClause=null,this._layerDisplayFilterId=i?.id,i}async _constructRendererLegendElements(e,t={}){const{title:i,sublayer:r}=t,s=r||this.layer,n=Oo(e,"reference-size"),o=Oo(e,"spike");let a=null;hc(e)&&(await this._processDefinitionExpression(s,e),a=await this._processDisplayFilter(s,e)),this._hasColorRamp=!1,this._hasOpacityRamp=!1,this._hasSizeRamp=!1,this._scaleDrivenSizeVariable=null;const l=await this._getVisualVariableLegendElements(e,s)||[],u={type:"symbol-table",title:i||this._getRendererTitle(e,s),infos:[]};let c=null,d=!1;const m=new Set;if(oE(e)&&!this._hasSizeRamp){const b=await Xj(e);u.infos.push({label:null,symbol:b})}else if(Hxe(e)){let b=i;const S=Wxe(e)?"univariate-above-and-below-ramp":"univariate-color-size-ramp",$=l.findIndex((F=>F.type==="color-ramp")),E=$!==-1?l.splice($,1)[0]:null,C=l.findIndex((F=>F.type==="size-ramp")),P=C!==-1?l.splice(C,1)[0]:null,k=[];E&&(b=E.title,k.push(E)),P&&(b=P.title,k.push(P)),k.length>0&&l.push({type:S,title:b,infos:k})}else if(ZG(e)){const b=gbe(e);l.push({type:"heatmap-ramp",title:i||this._getRendererTitle(e,s),infos:b,preview:ac(b.map((S=>S.color)),{effectList:this.effectList,ariaLabel:await ra("previewColorRampAriaLabel")})})}else if(hc(e)){const b=e.authoringInfo;if(b&&b.type==="relationship"){const{numClasses:S,field1:$,field2:E}=b,C=b.focus;if(S&&$&&E){const P=[$,E];let k=qj(C)||0;for(const D of P){const{field:U,normalizationField:W,label:Y}=D,re=Y||{field:this._getFieldAlias(U,s),normField:W&&this._getFieldAlias(W,s)},K=Yxe.clone();K.angle=k,u.infos.push({label:re,symbol:K}),m.add(K),k+=90}const F=Hve({focus:C,numClasses:S,infos:e.uniqueValueInfos??[]});l.unshift(F)}}else if(Qh(this.layer)||v_(this.layer))e.uniqueValueInfos?.forEach((S=>{S.symbol&&this._checkClausesForUVR(e,S.value)&&u.infos.push({label:S.label||S.value,value:S.value,symbol:S.symbol})}));else{const{field:S,field2:$,field3:E,fieldDelimiter:C,valueExpression:P,defaultSymbol:k}=e,F=!(!S&&!P||!$&&!E),D=this._layerDisplayFilterClause?a?.title:null,U=[];if(e.uniqueValueGroups?.forEach((W=>{const Y={type:"symbol-table",title:D||W.heading,infos:[]};W.classes?.forEach((re=>{const{symbol:K,values:Ce}=re;if(K){const Ve=[],Je=[];for(const Cr of Ce??[]){const{value:Fn,value2:Ho,value3:Ph}=Cr,Wo=[],Ih=[];(S||P)&&(Wo.push(Fn),Ih.push(this._getDomainName(S,Fn,s))),$&&(Wo.push(Ho),Ih.push(this._getDomainName($,Ho,s))),E&&(Wo.push(Ph),Ih.push(this._getDomainName(E,Ph,s))),Ve.push(F?Wo.join(C||""):Wo[0]),Je.push(Ih.join(" - "))}const Oe=Ve.join(", ");let Lt=re.label;if(!Lt){const Cr=Je.filter(Boolean);Lt=Cr.length?Cr.join(", "):Oe}const Dn=K.clone();Dn.type==="cim"&&n&&zP(Dn,{innerDotSize:.5*$N,outerRingSize:$N}),Ve.some((Cr=>this._checkClausesForUVR(e,Cr)))&&Y.infos.push({label:Lt,value:Oe,symbol:Dn})}})),Y.infos.length&&U.push(Y)})),U.length){const W=U[0];if(U.length===1&&"title"in W&&!W.title){const Y=W.infos?.filter(EN)??[];u.infos.push(...Y)}else k&&(U.push({type:"symbol-table",infos:[{label:e.defaultLabel||"others",symbol:k}]}),d=!0),u.infos.push(...U);i||e.legendOptions?.title||e.valueExpressionTitle||(u.title=null)}}e.defaultSymbol&&!d&&(u.infos.push({label:e.defaultLabel||"others",symbol:e.defaultSymbol}),d=!0)}else if(cc(e)){if(!n&&!o){if(c=this._isUnclassedRenderer(e),!c||!this._hasSizeRamp){const b=e.classBreakInfos.filter((({symbol:$})=>$)),S=e.legendOptions?.order==="ascending-values";for(const{label:$,minValue:E,maxValue:C,symbol:P}of b){const k={label:$||(c?null:`${E} - ${C}`),value:[E,C],symbol:P};S?u.infos.push(k):u.infos.unshift(k)}c&&(u.title=null),this._updateInfosForClassedSizeRenderer(e,u.infos)}e.defaultSymbol&&!c&&(u.infos.push({label:e.defaultLabel||"others",symbol:e.defaultSymbol}),d=!0)}}else if(HG(e))if(v_(this.layer)||Bxe(this.layer)){const b=await this._constructTileImageryStretchRendererElements(e);qxe(b)?l.push(b):u.infos=b}else{const b=this.layer;let S,$;e.customStatistics?.length&&({min:S,max:$}=e.customStatistics[0]);let E=[],C=b.serviceRasterInfo;if(b.rasterFunction)try{C=await b.generateRasterInfo(b.rasterFunction)}catch{}const P=nb(C.pixelType);if(C.bandCount===1){const k=b.bandIds?.[0]||0;S=S??(C.statistics?C.statistics[k].min:P[0]),$=$??(C.statistics?C.statistics[k].max:P[1]),S||$?l.push(await this._getStretchLegendElements(e,{min:S,max:$})):this._getServerSideLegend()}else if(b.bandIds&&b.bandIds.length===1)S=S??(C.statistics?C.statistics[b.bandIds[0]].min:P[0]),$=$??(C.statistics?C.statistics[b.bandIds[0]].max:P[1]),S||$?l.push(await this._getStretchLegendElements(e,{min:S,max:$})):this._getServerSideLegend();else if(C.bandCount>=3){const{bandInfos:k}=C,{bandIds:F}=b;k.length>=C.bandCount?F?.length===3?(E=F.map((D=>k[D].name)),u.infos=this._createSymbolTableElementMultiBand(E)):b.format==="lerc"?(E=[0,1,2].map((D=>k[D].name)),u.infos=this._createSymbolTableElementMultiBand(E)):this._getServerSideLegend():b.format==="lerc"?(E=["band1","band2","band3"],u.infos=this._createSymbolTableElementMultiBand(E)):this._getServerSideLegend()}else this._getServerSideLegend()}else if(qG(e))e.colormapInfos.forEach((b=>{u.infos.push({label:b.label,value:b.value,symbol:this._getAppliedCloneSymbol(Nxe,b.color)})}));else if($d(e)){let b=e.symbol;switch(t.geometryType){case"point":b="pointSymbol"in s?s.pointSymbol:null;break;case"polyline":b="lineSymbol"in s?s.lineSymbol:null;break;case"polygon":b="polygonSymbol"in s?s.polygonSymbol:null}const S=this._hasClusterSizeVariable&&this._getClusterSymbol()||!this._hasSizeRamp;e.symbol&&S&&u.infos.push({label:e.label,symbol:b})}else if(BG(e)){e.outputUnit&&(this.title="("+e.toJSON().outputUnit+")"),u.title=e.attributeField;const b=e.getClassBreakInfos();b?.length?b.forEach((S=>{u.infos.push({label:S.minValue+" - "+S.maxValue,symbol:S.symbol})})):u.infos.push({label:e.attributeField,symbol:e.getDefaultSymbol()})}else WG(e)&&l.push(await this._getStretchLegendElements(e,{min:0,max:255}));const y=e.defaultSymbol;!y||d||$d(e)||c&&!this._hasColorRamp&&!this._hasSizeRamp&&!this._hasOpacityRamp||l.push({type:"symbol-table",infos:[{label:e.defaultLabel||"others",symbol:y}]}),u.infos.length&&l.unshift(u);const g=t.opacity==null?this.opacity:t.opacity,_=this._isTallSymbol("visualVariables"in e?e.visualVariables:null),v=Qh(this.layer)||v_(this.layer);return await this._generatePreviewsForLegendElements(l,{opacity:g,symbolConfig:{isTall:_,isSquareFill:v},effectView:this.effectList},{defaultSymbol:y,arrowMarkerSymbols:m}),e=null,l}_checkClausesForUVR(e,t){const i=Zxe(e,t);return!i||(!this._layerDefinitionExpressionClause||this._layerDefinitionExpressionClause.testFeature(i))&&(!this._layerDisplayFilterClause||this._layerDisplayFilterClause.testFeature(i))}_getServerSideLegend(){setTimeout((()=>this.buildLegendElementsForTools()),0)}_getAllInfos(e){const t=e?.infos;return t?t.reduce(((i,r)=>i.concat(this._getAllInfos(r))),[]):[e]}async _constructTileImageryStretchRendererElements(e){const t=this.layer,i=t.symbolizer.rasterInfo??t.raster.rasterInfo;let r,s;const n=e?.customStatistics?.length?e.customStatistics:i?.statistics;if(n)({min:r,max:s}=n[0]);else{const a=nb(i.pixelType);r=a[0],s=a[1]}if(t.hasStandardTime()&&(r=t.getStandardTimeValue(r),s=t.getStandardTimeValue(s)),i.bandCount===1||t.bandIds?.length===1)return this._getStretchLegendElements(e,{min:r,max:s});const o=(t?.bandIds?.length?t.bandIds:Array.from(Array(Math.min(i.bandCount,3)).keys())).map((a=>i.bandInfos[a].name));return o.length<3?o.push(o[1]):o.length>3&&o.splice(3),this._createSymbolTableElementMultiBand(o)}async _getStretchLegendElements(e,t){const i=e.colorRamp,r=ybe(i,t);return{type:"stretch-ramp",title:"",infos:r,preview:ac(r.map((s=>s.color)),{ariaLabel:await ra("previewColorRampAriaLabel")})}}_getClusterSymbol(){const e=this.layer,t="featureReduction"in e&&e.featureReduction,i=t&&"symbol"in t&&t.renderer;return i&&i?.authoringInfo?.isAutoGenerated!==!0?null:t&&"symbol"in t?t.symbol:null}async _getSizeLegendElement(e,t,i,r){return{type:"size-ramp",title:this._hasClusterSizeVariable?this._getClusterTitle(t):e,infos:await wxe(i,t,await HT(i),this.scale,this.view,r,this._hasClusterSizeVariable?this._getClusterSymbol():null)}}_createSymbolTableElementMultiBand(e){const t=[],i=["red","green","blue"];return e.forEach(((r,s)=>{t.push({label:{colorName:i[s],bandName:r},src:lbe[s],opacity:this.opacity??1})})),t}_updateInfosForClassedSizeRenderer(e,t){const i=e.authoringInfo&&e.authoringInfo.type==="class-breaks-size",r=e.classBreakInfos.some((s=>kw(s.symbol)));if(i&&r){const s=rE,n=sE,o=e.classBreakInfos.length,a=(s-n)/(o>1?o-1:o);t.forEach(((l,u)=>{l.size=s-a*u}))}}_isTallSymbol(e){let t=!1,i=!1;if(e)for(let r=0;r<e.length&&(!t||!i);r++){const s=e[r];s.type==="size"&&(s.axis==="height"&&(t=!0),s.axis==="width-and-depth"&&(i=!0))}return t&&i}async _generatePreviewsForLegendElements(e,t,i){const r=[];for(const s of e)for(const n of s.infos??[])if("infos"in n&&n.infos&&r.push(this._generatePreviewsForLegendElements([n],t,i)),EN(n)&&n.symbol&&!n.preview){let o=!0;if(n.symbol.type==="cim"){const{minScale:a,maxScale:l}=n.symbol.data;(a&&a<this.scale||l&&l>this.scale)&&(o=!1)}o&&r.push(this._generateSymbolPreviewForInfo(n,{...t,clipBloomEffect:"theme"in s&&s.theme==="spike",effectView:i?.arrowMarkerSymbols?.has(n.symbol)?null:t.effectView},i?{isDefault:n.symbol===i.defaultSymbol,applyScaleDrivenSize:!i.arrowMarkerSymbols?.has(n.symbol)}:void 0))}await Promise.all(r)}async _generateSymbolPreviewForInfo(e,t,i){try{let r=!i?.isDefault&&e.size==null&&this._hasSizeRamp?We(zt.size):e.size;if(this._scaleDrivenSizeVariable&&i?.applyScaleDrivenSize){const{getSize:o}=await J(()=>Promise.resolve().then(()=>Mh),void 0);r=o(this._scaleDrivenSizeVariable,null,{view:this.view.type,scale:this.scale,shape:e.symbol.type==="simple-marker"?e.symbol.style:null})}const s=e.symbol.type==="cim"?{style:"legend",cimOptions:{allowScalingUp:!i?.isDefault&&this._hasSizeRamp||!(!this._scaleDrivenSizeVariable||!i?.applyScaleDrivenSize),viewParams:this.isScaleDriven?{viewingMode:this.view?.type==="2d"?"map":this.view?.viewingMode,scale:this.view?.scale}:null}}:{},n=e.label&&typeof e.label!="string"?null:await ra("previewTemplateAriaLabel",e.label);e.preview=await Hj(e.symbol,{size:r,scale:!1,ariaLabel:n,...t,...s})}catch{e.preview=null,H.getLogger(this).warn(`Generating symbol preview failed for symbol type: ${e.symbol?.type}`)}}_getClusterRenderer(e){this._hasClusterSizeVariable=!1;const t="renderer"in this.layer?this.layer.renderer:null,i=e.renderer?.clone()||t?.clone(),r=Xve(e,this.layerView,this.view);if(r&&i!=null&&"visualVariables"in i&&!i.visualVariables?.some((n=>n.type==="size"&&n.target!=="outline"&&!g_.test(n.valueExpression)))){if("clusterMinSize"in e&&"clusterMaxSize"in e){const{clusterMinSize:o,clusterMaxSize:a}=e;r.legendOptions=new u7({showLegend:o!==a})}const n=i.visualVariables||[];i.visualVariables=n.concat([r]),this._hasClusterSizeVariable=!0}return i}async _loadRenderer(e){const t=[],i=e.clone(),r=await HT(i);if(cc(i)||hc(i)){const s=(i.classBreakInfos||i.uniqueValueInfos).map((n=>this._fetchSymbol(n.symbol,r).then((o=>{n.symbol=o})).catch((()=>{n.symbol=null}))));Array.prototype.push.apply(t,s)}return t.push(this._fetchSymbol(i.symbol||i.defaultSymbol,i.defaultSymbol?null:r).then((s=>{this._applySymbolToRenderer(i,s,$d(i))})).catch((()=>{this._applySymbolToRenderer(i,null,$d(i))}))),await Promise.allSettled(t),i}_applySymbolToRenderer(e,t,i){i?e.symbol=t:e.defaultSymbol=t}async _fetchSymbol(e,t){if(!e)throw new Error;if(e.type==="web-style"){const i=this._webStyleSymbolCache;try{const r=await e.fetchSymbol({cache:i});return this._getAppliedCloneSymbol(r,t)}catch{throw H.getLogger(this).warn("Fetching web-style failed!"),new Error}}return this._getAppliedCloneSymbol(e,t)}_getAppliedCloneSymbol(e,t){if(!e||!t)return e;const i=e.clone(),r=t&&t.toRgba();return i.type.includes("3d")?this._applyColorTo3dSymbol(i,r):i.type==="cim"?pj(i,t):i.color&&(i.color=new X(r||i.color)),i}_applyColorTo3dSymbol(e,t){t&&e.symbolLayers.forEach((i=>{i&&(i.material||(i.material={}),i.material.color=new X(t))}))}async _getVisualVariableLegendElements(e,t){if(!("visualVariables"in e)||e.type==="vector-field")return null;const i=e.visualVariables??[],r=[],s=[],n=[],o=Oo(e,"reference-size")??Oo(e,"spike");let a;if(o?.sizeStops?.length===2&&(cc(e)||hc(e))){const[m,y]=o.sizeStops;a=new De({field:o.field??void 0,normalizationField:o.normalizationField,minSize:lr(m.size,10,100),maxSize:lr(y.size,50,150),minDataValue:m.value,maxDataValue:y.value}),s.push(a)}for(const m of i)m.type==="color"?r.push(m):m.type==="size"?s.push(m):m.type==="opacity"&&n.push(m);const l=[...r,...s,...n];let u,c;if(r.length===0&&cc(e)&&e.classBreakInfos&&e.classBreakInfos.length===1){const m=e.classBreakInfos[0];u=m&&m.symbol}if(r.length===0&&$d(e)&&(u=e.symbol),u)if(u.type.includes("3d")){const m=u.symbolLayers.at(0);m.type==="water"?m.color!=null&&(c=m.color):m.material?.color!=null&&(c=m.material.color)}else u.url||(c=u.color);const d=this.effectList;return(await Promise.all(l.map((async m=>{if(!m.legendOptions||m.legendOptions.showLegend!==!1){const y=oE(e)?m.field:this._getRampTitle(m,t);let g=null;const _=hbe(t,m,this.view.timeZone);if(m.type==="color"){const v=await H5(m,null,_)??[];g={type:"color-ramp",title:y,infos:v,preview:ac(v.map((b=>b.color)),{effectList:d,ariaLabel:await ra("previewColorRampAriaLabel")})},this._hasColorRamp||(this._hasColorRamp=v.length>0)}else if(m.type==="size"&&m.target!=="outline")g_.test(m.valueExpression)?this._hasClusterSizeVariable||(this._scaleDrivenSizeVariable=m):(g=await this._getSizeLegendElement(y,m,e,_),a===m&&o?.theme==="spike"&&(g.theme=o.theme),this._hasSizeRamp||(this._hasSizeRamp=!(g.infos==null||!g.infos.length)));else if(m.type==="opacity"){const v=await H5(m,c,_)??[];g={type:"opacity-ramp",title:y,infos:v,preview:ac(v.map((b=>b.color)),{effectList:d,ariaLabel:await ra("previewColorRampAriaLabel")})},this._hasOpacityRamp||(this._hasOpacityRamp=v.length>0)}return g?.infos?g:null}})))).filter(rr)}_getDomainName(e,t,i){if(e&&typeof e!="function"){const r="getField"in i&&i.getField?.(e),s=r&&"getFieldDomain"in i&&i.getFieldDomain?i.getFieldDomain(r.name,{excludeImpliedDomains:N("esri-widget-legacy-field-domain-calculation")}):null;return s?.type==="coded-value"?s.getName(t):null}return null}_getClusterTitle(e){const t=this.layer,i=e.field;if("featureReduction"in t&&t.featureReduction&&t.featureReduction.type==="cluster"){const r=t.featureReduction,s="popupTemplate"in r&&r.popupTemplate,n=s&&s.fieldInfos;if(n){for(const o of n)if(o.fieldName===i)return i==="cluster_count"?o.label||{showCount:!0}:o.label}}return{showCount:!0}}_getRampTitle(e,t){let i=e.field,r=e.normalizationField,s=!1,n=!1,o=!1,a=null;i=typeof i=="function"?null:i,r=typeof r=="function"?null:r;const l=e.legendOptions?.title;if(l!=null)a=l;else if(e.valueExpressionTitle)a=e.valueExpressionTitle;else{if("renderer"in t&&t.renderer&&"authoringInfo"in t.renderer&&t.renderer.authoringInfo?.visualVariables){const u=t.renderer.authoringInfo.visualVariables;for(let c=0;c<u.length;c++){const d=u[c];if(d.type==="color"){if(d.style==="ratio"){s=!0;break}if(d.style==="percent"){n=!0;break}if(d.style==="percent-of-total"){o=!0;break}}}}a={field:i&&this._getFieldAlias(i,t),normField:r&&this._getFieldAlias(r,t),ratio:s,ratioPercent:n,ratioPercentTotal:o}}return a}_getRendererTitle(e,t){const i=e;if(i.legendOptions?.title)return i.legendOptions.title;if(i.valueExpressionTitle)return i.valueExpressionTitle;let r=i.field,s=null,n=null;if(cc(i)&&(s=i.normalizationField,n=i.normalizationType==="percent-of-total"),r=typeof r=="function"?null:r,s=typeof s=="function"?null:s,hc(i)){const{field2:a,field3:l,fieldDelimiter:u}=i;let c=r&&this._getFieldAlias(r,t);return a&&(c=`<${c}>${u}<${this._getFieldAlias(a,t)}>`,l&&(c=`${c}${u}<${this._getFieldAlias(l,t)}>`)),c}let o=null;return(r||s)&&(o={field:r&&this._getFieldAlias(r,t),normField:s&&this._getFieldAlias(s,t),normByPct:n}),o}_getFieldAlias(e,t){let s=("popupTemplate"in t?t.popupTemplate:null)?.fieldInfos?.find((c=>e===c.fieldName)),n=null;"getField"in t&&t.getField?n=t.getField(e):"fieldsIndex"in t&&t.fieldsIndex&&(n=t.fieldsIndex.get(e));let o=null;const a="featureReduction"in t&&t.featureReduction;a&&(s??="popupTemplate"in a?a.popupTemplate?.fieldInfos?.find((c=>e?.toLowerCase()===c.fieldName?.toLowerCase())):void 0,"fields"in a&&a.fields&&(o=a.fields.find((c=>c.name?.toLowerCase()===e?.toLowerCase()))));const l=s||n||o;let u=null;return l&&(u=s?.label||n?.alias||o?.alias||"name"in l&&l.name||"fieldName"in l&&l.fieldName||null),u}_isUnclassedRenderer(e){const t=e.visualVariables;let i=!1;return cc(e)&&e.classBreakInfos&&e.classBreakInfos.length===1&&t&&(i=e.field?t.some((r=>!(!r||e.field!==r.field||(e.normalizationField||r.normalizationField)&&e.normalizationField!==r.normalizationField))):!!t.length),i}};h([f()],Gt.prototype,"children",void 0),h([f({readOnly:!0})],Gt.prototype,"effectList",null),h([f()],Gt.prototype,"layerView",void 0),h([f()],Gt.prototype,"layer",void 0),h([f()],Gt.prototype,"legendElements",void 0),h([f({readOnly:!0})],Gt.prototype,"opacity",null),h([f()],Gt.prototype,"parent",void 0),h([f({readOnly:!0,dependsOn:[]})],Gt.prototype,"ready",null),h([f()],Gt.prototype,"hideLayersNotInCurrentView",void 0),h([f()],Gt.prototype,"keepCacheOnDestroy",void 0),h([f()],Gt.prototype,"respectLayerDefinitionExpression",void 0),h([f()],Gt.prototype,"respectLayerVisibility",void 0),h([f({readOnly:!0})],Gt.prototype,"scale",null),h([f()],Gt.prototype,"sublayerIds",void 0),h([f({readOnly:!0})],Gt.prototype,"isScaleDriven",null),h([f()],Gt.prototype,"title",void 0),h([f({readOnly:!0,dependsOn:["ready"],value:0})],Gt.prototype,"version",null),h([f()],Gt.prototype,"view",void 0),Gt=h([I("esri.widgets.Legend.support.ActiveLayerInfo")],Gt);const Fu={state:"state",view:"view",allLayerViews:"all-layer-views",legendProperties:"legend-properties"},XG=ne.ofType(Gt),Jxe=new Set(["esri.layers.BuildingSceneLayer","esri.layers.CatalogLayer","esri.layers.CSVLayer","esri.layers.FeatureLayer","esri.layers.GeoJSONLayer","esri.layers.GeoRSSLayer","esri.layers.GroupLayer","esri.layers.HeatmapLayer","esri.layers.ImageryLayer","esri.layers.ImageryTileLayer","esri.layers.MapImageLayer","esri.layers.OGCFeatureLayer","esri.layers.OrientedImageryLayer","esri.layers.ParquetLayer","esri.layers.PointCloudLayer","esri.layers.StreamLayer","esri.layers.SceneLayer","esri.layers.SubtypeGroupLayer","esri.layers.TileLayer","esri.layers.VoxelLayer","esri.layers.WFSLayer","esri.layers.WMSLayer","esri.layers.WMTSLayer","esri.layers.WCSLayer","esri.layers.LinkChartLayer","esri.layers.catalog.CatalogFootprintLayer","esri.layers.catalog.CatalogDynamicGroupLayer","esri.layers.knowledgeGraph.KnowledgeGraphSublayer","esri.layers.KnowledgeGraphLayer"]),KG="view.basemapView.baseLayerViews",QG="view.groundView.layerViews",eB="view.basemapView.referenceLayerViews",Xxe=[KG,QG,"view.layerViews",eB];let ns=class extends le{constructor(t){super(t),this._layerViewByLayerId={},this._layerInfosByLayerViewId={},this._activeLayerInfosByLayerViewId={},this._activeLayerInfosWithNoParent=new ne,this.activeLayerInfos=new XG,this.basemapLegendVisible=!1,this.groundLegendVisible=!1,this.hideLayersNotInCurrentView=!1,this.keepCacheOnDestroy=!1,this.respectLayerDefinitionExpression=!1,this.respectLayerVisibility=!0,this.layerInfos=[],this.view=null}initialize(){this.addHandles(te((()=>this.view),(()=>this._viewHandles()),Pt),Fu.view),this.addHandles(aC((()=>this._refresh())))}destroy(){this._destroyViewActiveLayerInfos(),this.view=null}get state(){return this.view?.ready?"ready":"disabled"}_viewHandles(){this.removeHandles(Fu.state),this.view&&this.addHandles(te((()=>this.state),(()=>this._stateHandles()),Pt),Fu.state)}_stateHandles(){this._resetAll(),this.state==="ready"&&this._watchPropertiesAndAllLayerViews()}_resetAll(){this.removeHandles([Fu.allLayerViews,Fu.legendProperties]),this._destroyViewActiveLayerInfos(),this.activeLayerInfos.removeAll()}_destroyViewActiveLayerInfos(){Object.keys(this._activeLayerInfosByLayerViewId).forEach(this._destroyViewActiveLayerInfo,this)}_destroyViewActiveLayerInfo(t){this.removeHandles(t);const i=this._activeLayerInfosByLayerViewId[t];delete this._activeLayerInfosByLayerViewId[t],i?.parent&&i.parent.children.remove(i)}_watchPropertiesAndAllLayerViews(){const{view:t}=this;if(!t)return;const{allLayerViews:i}=t;i.length&&this._refresh(),this.addHandles(i.on("change",(r=>this._allLayerViewsChangeHandle(r))),Fu.allLayerViews),this.addHandles(te((()=>[this.layerInfos,this.basemapLegendVisible,this.groundLegendVisible]),(()=>this._propertiesChangeHandle())),Fu.legendProperties)}_allLayerViewsChangeHandle(t){t.moved.length?this._propertiesChangeHandle():(t.removed.forEach((i=>this._destroyViewActiveLayerInfo(i.uid))),this._refresh())}_propertiesChangeHandle(){this._destroyViewActiveLayerInfos(),this._refresh()}_refresh(){this._layerInfosByLayerViewId={},this.activeLayerInfos.removeAll(),this._generateLayerViews().filter(this._filterLayerViewsByLayerInfos,this).filter(this._isLayerViewSupported,this).forEach(this._generateActiveLayerInfo,this),this._sortActiveLayerInfos(this.activeLayerInfos)}_sortActiveLayerInfos(t){const i=this.view;if(t.length<2||!i)return;const r=[];t.forEach((n=>{if(!n.parent){const o=n.layer.parent,a=o&&"uid"in o&&this._layerViewByLayerId[o.uid],l=a&&this._activeLayerInfosByLayerViewId[a.uid];l&&t.includes(l)&&(r.push(n),n.parent=l,l.children.add(n),this._sortActiveLayerInfos(l.children))}})),t.removeMany(r);const s={};i.allLayerViews.forEach(((n,o)=>s[n.layer.uid]=o)),t.sort(((n,o)=>{const a=s[n.layer.uid]||0;return(s[o.layer.uid]||0)-a}))}_generateLayerViews(){const t=[];return Xxe.filter(this._filterLayerViews,this).map((i=>Mn(this,i))).filter((i=>i!=null)).forEach(this._collectLayerViews("layerViews",t)),t}_filterLayerViews(t){const i=!this.basemapLegendVisible&&(t===KG||t===eB),r=!this.groundLegendVisible&&t===QG;return!i&&!r}_collectLayerViews(t,i){const r=s=>(s&&s.forEach((n=>{i.push(n),r(n[t])})),i);return r}_filterLayerViewsByLayerInfos(t){const i=this.layerInfos;return!i||!i.length||i.some((r=>this._hasLayerInfo(r,t)))}_hasLayerInfo(t,i){const r=this._isLayerUIDMatching(t.layer,i.layer.uid);return r&&(this._layerInfosByLayerViewId[i.uid]=t),r}_isLayerUIDMatching(t,i){return t&&(t.uid===i||this._hasLayerUID(t.layers,i))}_hasLayerUID(t,i){return t&&t.some((r=>this._isLayerUIDMatching(r,i)))}_isLayerViewSupported(t){return!!Jxe.has(t.layer.declaredClass)&&(this._layerViewByLayerId[t.layer.uid]=t,!0)}_generateActiveLayerInfo(t){this._isLayerActive(t)?this._buildActiveLayerInfo(t):(this.removeHandles(t.uid),this.addHandles(te((()=>[t.legendEnabled,t.layer?.legendEnabled]),(()=>this._layerActiveHandle(t))),t.uid))}_layerActiveHandle(t){this._isLayerActive(t)&&(this.removeHandles(t.uid),this._buildActiveLayerInfo(t))}_isLayerActive(t){return!this.respectLayerVisibility||t.legendEnabled&&t.layer?.legendEnabled}_buildActiveLayerInfo(t){const i=t.layer,r=t.uid,s=this._layerInfosByLayerViewId[r];let n=this._activeLayerInfosByLayerViewId[r];if(!n){const a=s?.title!==void 0&&s.layer.uid===i.uid;n=new Gt({layer:i,layerView:t,title:a?s.title:i.title,view:this.view??void 0,respectLayerDefinitionExpression:this.respectLayerDefinitionExpression,respectLayerVisibility:this.respectLayerVisibility,hideLayersNotInCurrentView:this.hideLayersNotInCurrentView,keepCacheOnDestroy:this.keepCacheOnDestroy,sublayerIds:s?.sublayerIds||[]}),this._activeLayerInfosByLayerViewId[r]=n}const o=i.parent&&"uid"in i.parent?this._layerViewByLayerId[i.parent?.uid]:null;if(n.parent=this._activeLayerInfosByLayerViewId[o?.uid],!this.hasHandles(r)){const a=[te((()=>i.title),(l=>this._titleHandle(l,n))),te((()=>[i.opacity,"renderer"in i&&i.renderer,"pointSymbol"in i&&i.pointSymbol,"lineSymbol"in i&&i.lineSymbol,"polygonSymbol"in i&&i.polygonSymbol]),(()=>this._constructLegendElements(n))),Yr((()=>this.view?.stationary===!0),(()=>this._scaleHandle(n)),Pt),te((()=>t.layer?aO(t.layer,t.view):null),(()=>this._constructLegendElements(n))),te((()=>t.updating),(()=>{t.layer!=null&&aO(t.layer,t.view)!=null&&this._constructLegendElements(n)})),te((()=>"effect"in i&&i.effect),(()=>this._constructLegendElements(n))),Yr((()=>this.view?.timeZone),(()=>this._constructLegendElements(n)),Pt)];if(this.respectLayerVisibility){const l=te((()=>t.legendEnabled),(c=>this._legendEnabledHandle(c,n))),u=te((()=>i.legendEnabled),(c=>this._legendEnabledHandle(c,n)));a.push(l,u)}if(this.respectLayerDefinitionExpression&&"definitionExpression"in i){const l=te((()=>[i.definitionExpression,this.respectLayerDefinitionExpression]),(()=>{n.respectLayerDefinitionExpression=this.respectLayerDefinitionExpression,this._constructLegendElements(n)}));a.push(l)}this.addHandles(a,r)}n.isScaleDriven||this._constructLegendElements(n),this._addActiveLayerInfo(n)}_titleHandle(t,i){i.title=t,this._constructLegendElements(i)}_legendEnabledHandle(t,i){t?this._addActiveLayerInfo(i):this._removeActiveLayerInfo(i)}_scaleHandle(t){(t.isScaleDriven||t.hideLayersNotInCurrentView)&&this._constructLegendElements(t)}_addActiveLayerInfo(t){const{layerView:i,layer:r}=t;if(this._isLayerActive(i)&&!this.activeLayerInfos.includes(t)){const s=t.parent;if(s)s.children.includes(t)||s.children.push(t),this._sortActiveLayerInfos(s.children);else{const n=this.layerInfos?.some((a=>a.layer.uid===r.uid)),o=r.parent;o&&"uid"in o&&this._layerViewByLayerId[o.uid]&&!n?this._activeLayerInfosWithNoParent.add(t):(this.activeLayerInfos.add(t),this._sortActiveLayerInfos(this.activeLayerInfos))}if(this._activeLayerInfosWithNoParent.length){const n=[];this._activeLayerInfosWithNoParent.forEach((o=>{const a=o.layer.parent,l=a&&"uid"in a?this._layerViewByLayerId[a?.uid]:null,u=this._activeLayerInfosByLayerViewId[l?.uid];u&&(n.push(o),o.parent=u)})),n.length&&(this._activeLayerInfosWithNoParent.removeMany(n),n.forEach((o=>this._addActiveLayerInfo(o))))}}}_removeActiveLayerInfo(t){const i=t.parent;i?i.children.remove(t):this.activeLayerInfos.remove(t)}_constructLegendElements(t){const i=t.layer;"featureCollections"in i&&i.featureCollections?t.buildLegendElementsForFeatureCollections(i.featureCollections):"featureReduction"in i&&i.featureReduction&&"renderer"in i.featureReduction&&(i.featureReduction.type==="binning"||i.featureReduction.type==="cluster")&&(!this.view||i.featureReduction.maxScale<=this.view.scale)?t.buildLegendElementsForFeatureReduction(i.featureReduction):"renderer"in i&&i.renderer&&!("sublayers"in i)?t.buildLegendElementsForRenderer(i.renderer):"url"in i&&i.url&&i.type!=="catalog"&&i.type!=="knowledge-graph"?t.buildLegendElementsForTools():t.children.forEach((r=>this._constructLegendElements(r)))}};h([f({type:XG})],ns.prototype,"activeLayerInfos",void 0),h([f()],ns.prototype,"basemapLegendVisible",void 0),h([f()],ns.prototype,"groundLegendVisible",void 0),h([f()],ns.prototype,"hideLayersNotInCurrentView",void 0),h([f()],ns.prototype,"keepCacheOnDestroy",void 0),h([f()],ns.prototype,"respectLayerDefinitionExpression",void 0),h([f()],ns.prototype,"respectLayerVisibility",void 0),h([f()],ns.prototype,"layerInfos",void 0),h([f({readOnly:!0})],ns.prototype,"state",null),h([f()],ns.prototype,"view",void 0),ns=h([I("esri.widgets.Legend.LegendViewModel")],ns);const Be="esri-legend--card",um="esri-legend",fe={base:Be,stacked:`${um}--stacked`,carouselTitle:`${Be}__carousel-title`,intervalSeparator:`${Be}__interval-separator`,imageryLayerStretchedImage:`${Be}__imagery-layer-image--stretched`,imageLabel:`${Be}__image-label`,layerCaption:`${Be}__layer-caption`,labelElement:`${Be}__label-element`,layerRow:`${Be}__layer-row`,labelCell:`${Be}__label-cell`,message:`${Be}__message`,rampLabel:`${Be}__ramp-label`,section:`${Be}__section`,serviceCaptionText:`${Be}__service-caption-text`,serviceContent:`${Be}__service-content`,service:`${Be}__service`,groupLayer:`${Be}__group-layer`,groupLayerChild:`${Be}__group-layer-child`,symbol:`${Be}__symbol`,sizeRampRow:`${Be}__size-ramp-row`,symbolRow:`${Be}__symbol-row`,symbolCell:`${Be}__symbol-cell`,carousel:`${Be}__carousel`,carouselItem:`${Be}__carousel-item`,intervalSeparatorsContainer:`${Be}__interval-separators-container`,relationshipLabelContainer:`${Be}__relationship-label-container`,labelContainer:`${Be}__label-container`,serviceCaptionContainer:`${Be}__service-caption-container`,symbolContainer:`${Be}__symbol-container`,colorRampContainer:`${Be}__color-ramp-container`,sizeRampContainer:`${Be}__size-ramp-container`,sizeRampPreview:`${Be}__size-ramp-preview`,pieChartRampPreview:`${Be}__pie-chart-ramp-preview`,sizeRampHorizontal:`${um}__size-ramp--horizontal`,rampLabelsContainer:`${um}__ramp-labels`,layerInfo:`${um}__layer-cell ${um}__layer-cell--info`,univariateAboveAndBelowColorRamp:"esri-univariate-above-and-below-ramp__color--card"};function Kxe(e,t){return t}function At(e){const t=this;e.appendChild(t)}function ef(e,t,i){if(!t)return;if(typeof t=="number")return t;if(typeof t=="string")return Mq(t);if("value"in t||"unit"in t)return mv(e.dotValue,t);if("colorName"in t&&"bandName"in t)return e[t.colorName]+": "+(e[t.bandName]||t.bandName);if("showCount"in t)return t.showCount?e.clusterCountTitle:void 0;let r=null;return Kxe(t,i)?r=t.ratioPercentTotal?"showRatioPercentTotal":t.ratioPercent?"showRatioPercent":t.ratio?"showRatio":t.normField?"showNormField":t.field?"showField":null:tB(t,i)&&(r=t.normField?"showNormField":t.normByPct?"showNormPct":t.field?"showField":null),r?mv(r==="showField"?"{field}":e[r],{field:t.field,normField:t.normField}):void 0}function tB(e,t){return!t}function iB(e,t){return!!(t&&t==="Stretched"&&"version"in e&&typeof e.version=="number"&&e.version>=10.3&&e.declaredClass==="esri.layers.ImageryLayer")}function Qxe(e,t){return e.label?t[e.label]+": "+(typeof e.value=="string"?e.value:mu(e.value??0,{style:"decimal",notation:e.value?.toString().toLowerCase().includes("e")?"scientific":"standard"})):""}function rB(e,t,i){switch(t){case"heatmap-ramp":return i[e.label]||e.label;case"stretch-ramp":return Qxe(e,i);default:return e.label}}function sB(e,t){if(!e.title||typeof e.title=="string")return e.title;const i=e.type==="color-ramp"||e.type==="opacity-ramp",r=e.title,s=ef(t,r,i);return tB(r,i)&&r.title?`${r.title} (${s})`:s}function nB(e){return!(!e||typeof e!="object")}const e$e=25,t$e=25,i$e=100;let dc=class extends vi{constructor(t,i){super(t,i),this.effectList=null,this.legendElement=null,this.opacity=1}render(){const t=this.legendElement.infos.slice().reverse();return L("div",{class:this.classes(fe.layerRow,fe.colorRampContainer)},this._renderRampLabel(t[0]),L("div",{class:fe.symbolContainer},this._renderPreview(t),this._renderMiddleStopRampLabel(t)),this._renderRampLabel(t.at(-1)))}_renderPreview(t){const{opacity:i}=this,r=this.legendElement.type==="heatmap-ramp",s=t.length-1,n=t$e,o=s>2&&!r?e$e*s:i$e,a=o+20,l=10,u=[[{shape:{type:"path",path:`M0 ${n/2} L${l} 0 L${l} ${n} Z`},fill:t[0].color,stroke:{width:0}},{shape:{type:"rect",x:l,y:0,width:o,height:n},fill:{type:"linear",x1:l,y1:0,x2:o+l,y2:0,colors:t.map(((m,y)=>({color:m.color,offset:r&&"ratio"in m?m.ratio:y/s})))},stroke:{width:0}},{shape:{type:"path",path:`M${o+l} 0 L${a} ${n/2} L${o+l} ${n} Z`},fill:t[t.length-1].color,stroke:{width:0}}]],c=Lj(u,a,n),d={filter:n0(this.effectList)??void 0,opacity:i==null?void 0:`${i}`};return L("div",{styles:d},c)}_renderMiddleStopRampLabel(t){const i=t.length%2!=0?t[t.length/2|0]:null;return i?L("div",{class:fe.intervalSeparatorsContainer},L("div",{class:fe.intervalSeparator},"|"),this._renderRampLabel(i)):null}_renderRampLabel(t){return L("div",{class:fe.rampLabel},rB(t,this.legendElement.type,this.messages))}};h([f()],dc.prototype,"effectList",void 0),h([f()],dc.prototype,"legendElement",void 0),h([f()],dc.prototype,"messages",void 0),h([f()],dc.prototype,"opacity",void 0),dc=h([I("esri.widgets.Legend.styles.card.ColorRamp")],dc);const r$e="#ddd",ki=window.devicePixelRatio,zu="esri-spike-ramp",Fa={spikeRampContainer:`${zu}__container`,spikeRampPreviewContainer:`${zu}__preview-container`,spikeRampPreview:`${zu}__preview`,spikeRampSymbolPreview:`${zu}__symbol-preview`,spikeRampLines:`${zu}__lines`,spikeRampLabelsContainer:`${zu}__labels-container`,spikeRampLabel:`${zu}__label`};function oB(e){return e.infos.length!==5?null:L("div",{class:Fa.spikeRampContainer},L("div",{class:Fa.spikeRampPreviewContainer},s$e(e),n$e(e)),o$e(e))}function s$e(e){const[t,i,r]=aI(e).map((({preview:s})=>{if(!s)return null;const n=s.cloneNode(!0);return n.classList.add(Fa.spikeRampSymbolPreview),n}));return t&&i&&r?L("div",{class:Fa.spikeRampPreview},L("div",{afterCreate:At,bind:r}),L("div",{afterCreate:At,bind:i}),L("div",{afterCreate:At,bind:t})):null}function n$e(e){const[{width:t,height:i},{width:r},{width:s,height:n}]=aI(e).map((({size:F})=>nB(F)?{width:Re(F.width),height:Re(F.height)}:{width:0,height:0})),o=10,a=8,l=t+r+s+3*o,u=i,c=document.createElement("canvas");c.width=(l+o)*ki,c.height=u*ki,c.style.width=c.width/ki+"px",c.style.height=c.height/ki+"px";const d=c.getContext("2d");d.beginPath();const m=l-(t/2+o),y=0,g=l+a;d.moveTo(m*ki,y*ki),d.lineTo(g*ki,0*ki);const v=(l-a)/2,b=(i-n)/2,S=l+a,$=(i-n)/2;d.moveTo(v*ki,b*ki),d.lineTo(S*ki,$*ki);const E=s/2,C=u-n,P=l+a,k=u-n;return d.moveTo(E*ki,C*ki),d.lineTo(P*ki,k*ki),d.strokeStyle=r$e,d.lineWidth=.5*ki,d.stroke(),L("div",{afterCreate:At,bind:c,class:Fa.spikeRampLines})}function o$e(e){const[{label:t,height:i},{label:r},{label:s,height:n}]=aI(e).map((({label:c,size:d})=>({label:c,height:nB(d)?Re(d.height):0}))),o=i-n,a={position:"absolute",top:"0"},l={position:"absolute",top:o/2+"px"},u={position:"absolute",top:`${o}px`};return L("div",{class:Fa.spikeRampLabelsContainer},L("div",{class:Fa.spikeRampLabel,styles:a},t),L("div",{class:Fa.spikeRampLabel,styles:l},r),L("div",{class:Fa.spikeRampLabel,styles:u},s))}function aI(e){return e.infos.filter(((t,i)=>i%2==0))}const a$e="#ddd",td=window.devicePixelRatio;function l$e(e){if(!e)return;if(e.type.includes("3d")){if(!e.symbolLayers?.length)return;const i=e.symbolLayers.at(-1),r=i.resource?.primitive;return r==="circle"||r==="cross"||r==="kite"||r==="sphere"||r==="cube"||r==="diamond"}const t=e.style;return t==="circle"||t==="diamond"||t==="cross"}function u$e(e){if(e){if(e.type.includes("3d")){if(!e.symbolLayers?.length)return;const t=e.symbolLayers.at(-1),i=t?.resource?.primitive;return i==="triangle"||i==="cone"||i==="tetrahedron"}return e.style==="triangle"}}let pc=class extends vi{constructor(t,i){super(t,i),this.hasIndicators=!1,this.legendElement=null,this.opacity=1}render(){if(this.legendElement.theme==="spike")return L("div",{styles:{display:"flex",flex:"1",justifyContent:"center"}},oB(this.legendElement));const{legendElement:t,hasIndicators:i,opacity:r}=this,s=t.infos,n=s.at(0),o=s.at(-1);if(!n||!o)return null;const{label:a,...l}=n,{label:u,...c}=o;let d=l.preview,m=c.preview;const y={"flex-direction":i?"column":"row-reverse"};if(!d||!m)return null;d=d.cloneNode(!0),d.style.display="flex",m=m.cloneNode(!0),m.style.display="flex";const g={opacity:`${r??""}`};return L("div",{class:this.classes(fe.layerRow,{[fe.sizeRampRow]:i})},L("div",{class:fe.rampLabel},i?a:u),L("div",{class:fe.sizeRampContainer,styles:y},L("div",{afterCreate:At,bind:d,class:fe.sizeRampPreview,styles:g}),this._renderSizeRampLines(t),L("div",{afterCreate:At,bind:m,class:fe.sizeRampPreview,styles:g})),L("div",{class:fe.rampLabel},i?u:a))}_renderSizeRampLines(t){const i=t.infos,r=i.at(0),s=i.at(-1);if(!r||!s)return null;const n=r.symbol,o=this.hasIndicators,a=r.size&&typeof r.size=="number"?r.size:0,l=s.size&&typeof s.size=="number"?s.size:0,u=r.outlineSize||0,c=s.outlineSize||0,d=Re(a+u)*td,m=Re(l+c)*td,y=o?d:d+50*td,g=o?d/2+50*td:d,_=u$e(n),v=l$e(n),b=document.createElement("canvas");b.width=y,b.height=g,b.style.width=b.width/td+"px",b.style.height=b.height/td+"px";const S=b.getContext("2d");if(o){S.beginPath();const $=0,E=0,C=y/2-m/2,P=g;S.moveTo($,E),S.lineTo(C,P);const k=y,F=0,D=y/2+m/2,U=g;S.moveTo(k,F),S.lineTo(D,U)}else{S.beginPath();const $=0,E=g/2-m/2,C=y;S.moveTo($,E),S.lineTo(C,0);const k=0,F=g/2+m/2,D=y,U=g;S.moveTo(k,F),S.lineTo(D,U)}return S.strokeStyle=a$e,S.stroke(),L("div",{afterCreate:At,bind:b,styles:o?{display:"flex",marginTop:`-${_?0:v?d/2:0}px`,marginBottom:`-${_?m:v?m/2:0}px`}:{display:"flex",marginRight:`-${_?0:v?d/2:0}px`,marginLeft:`-${_?0:v?m/2:0}px`}})}};h([f()],pc.prototype,"hasIndicators",void 0),h([f()],pc.prototype,"legendElement",void 0),h([f()],pc.prototype,"messages",void 0),h([f()],pc.prototype,"opacity",void 0),pc=h([I("esri.widgets.Legend.styles.card.SizeRamp")],pc);const c$e=$v(),aB=10,lI=20,Fw=10,uI=20,cI={univariateAboveAndBelowSymbol:"esri-univariate-above-and-below-ramp__symbol",colorRamp:"esri-legend__color-ramp"};function h$e(e="vertical"){const t="stroke:rgb(200, 200, 200);stroke-width:1";return e==="vertical"?L("svg",{height:"4",width:"10"},L("line",{style:t,x1:"0",x2:"10",y1:"2",y2:"2"})):L("svg",{height:"10",width:"10"},L("line",{style:t,x1:"5",x2:"5",y1:"0",y2:"10"}))}function d$e(e,t="vertical"){const i=document.createElement("div");return i.style.height=`${lI}px`,i.className=cI.univariateAboveAndBelowSymbol,e!=null&&(i.style.opacity=e.toString()),c$e.append(i,h$e.bind(null,t)),i}function lB(e,t,i="vertical",r){e.infos.forEach(((s,n)=>{if(r&&n===2)s.preview=d$e(t,i);else{const o=(Zp(s.size)?Re(s.size):0)+(i==="horizontal"?uI:Fw),a=s.preview,l=a?.tagName.toLowerCase()==="div",u=l?a:document.createElement("div");u.className=cI.univariateAboveAndBelowSymbol,i==="horizontal"?u.style.width=`${o}px`:u.style.height=`${o}px`,!l&&a&&u.appendChild(a),s.preview=u}}))}function zw(e,t="classic"){const i=e.infos,r=i.at(0),s=i.at(-1),n=Zp(r.size)?Re(r.size):0,o=Zp(s.size)?Re(s.size):0;return t==="classic"?(n+Fw)/2:(n-o)/2}function tf(e,t){if(!e)return null;const i=e.infos.map((s=>s.color)),r=ac(t.type==="full"?i:t.type==="above"?i.slice(0,3):i.slice(2,5),{width:t.width,height:t.height,align:t.rampAlignment,effectList:t.effectList,ariaLabel:t.ariaLabel});return r.className=cI.colorRamp,t.opacity!=null&&(r.style.opacity=t.opacity.toString()),r}function hI(e,t,i,r="vertical"){let s=0;const n=e.infos,o=Math.floor(n.length/2),a=t==="full"||t==="above"?0:o,l=t==="full"||t==="below"?n.length-1:o;for(let u=a;u<=l;u++)if(i&&u===o)s+=r==="horizontal"?aB:lI;else{const c=n[u].size;s+=(Zp(c)?Re(c):0)+(r==="horizontal"?uI:Fw)}return Math.round(s)}function rf(e,t,i,r="vertical"){const s=hI(e,t,i,r),n=e.infos,o=Math.floor(n.length/2),a=t==="full"||t==="above"?0:o,l=t==="full"||t==="below"?n.length-1:o,u=Zp(n[a].size)?n[a].size:0,c=Zp(n[l].size)?n[l].size:0,d=t==="full"?u+c:t==="above"?u:c,m=i?r==="vertical"?lI:aB:0,y=r==="vertical"?Fw*(t==="full"?2:1):uI*(t==="full"?2:1);return Math.round(s-(Re(d)/2+m/2+y/2))}function uB(e,t,i="vertical"){const r=e.infos;let s=r.find((({type:o})=>o==="size-ramp")),n=r.find((({type:o})=>o==="color-ramp"));return s&&(s={...s},s.infos=[...s.infos],lB(s,t,i,!0)),n&&(n={...n},n.infos=[...n.infos]),i==="horizontal"&&(s?.infos.reverse(),n?.infos.reverse()),{sizeRampElement:s,colorRampElement:n}}function cB(e,t="vertical"){const i=e.infos;let r=i.find((({type:n})=>n==="size-ramp")),s=i.find((({type:n})=>n==="color-ramp"));return r&&(r={...r},r.infos=[...r.infos],lB(r,null,t,!1)),s&&(s={...s},s.infos=[...s.infos]),t==="horizontal"&&(r?.infos.reverse(),s?.infos.reverse()),{sizeRampElement:r,colorRampElement:s}}const aE={marginLeft:"3px"},Hd={display:"table-cell",verticalAlign:"middle"},hB={display:"flex",alignItems:"flex-start"};let fc=class extends vi{constructor(t,i){super(t,i),this.effectList=null,this.legendElement=null,this.opacity=1}render(){const{legendElement:t,opacity:i,effectList:r,key:s}=this,{sizeRampElement:n,colorRampElement:o}=uB(t,i,"horizontal");if(!n)return null;const a=hI(n,"full",!0,"horizontal"),l=rf(n,"above",!0,"horizontal"),u=rf(n,"below",!0,"horizontal"),c=12,d=this.messages?.previewColorRampAriaLabel,m=tf(o,{width:l,height:c,rampAlignment:"horizontal",opacity:i,type:"above",effectList:r,ariaLabel:d}),y=tf(o,{width:u,height:c,rampAlignment:"horizontal",opacity:i,type:"below",effectList:r,ariaLabel:d}),g=zw(n,"card"),_=n.infos.map((P=>P.label)),v=_.length-1,b=_.map(((P,k)=>k===0||k===v?L("div",{key:k},P):null)),S={display:"flex",flexDirection:"column"},$={display:"flex",flexDirection:"row"},E={marginTop:"3px",display:"flex"};_w(this.container)?E.marginRight=`${g}px`:E.marginLeft=`${g}px`;const C={width:`${a}px`,display:"flex",flexDirection:"row",justifyContent:"space-between"};return L("div",{class:fe.layerRow,key:`${s}-container`,styles:S},L("div",{class:this.classes(fe.symbolContainer,fe.sizeRampHorizontal),styles:$},n.infos.map(((P,k)=>L("div",{afterCreate:At,bind:P.preview,class:fe.symbol,key:k})))),m?L("div",{class:fe.univariateAboveAndBelowColorRamp,key:"color-ramp-preview",styles:E},L("div",{afterCreate:At,bind:m}),L("div",{afterCreate:At,bind:y})):null,L("div",{class:fe.layerInfo},L("div",{class:fe.rampLabelsContainer,styles:C},b)))}};h([f()],fc.prototype,"effectList",void 0),h([f()],fc.prototype,"legendElement",void 0),h([f()],fc.prototype,"messages",void 0),h([f()],fc.prototype,"opacity",void 0),fc=h([I("esri.widgets.Legend.styles.card.UnivariateAboveAndBelowRamp")],fc);let mc=class extends vi{constructor(t,i){super(t,i),this.effectList=null,this.legendElement=null,this.opacity=1}render(){const{legendElement:t,opacity:i,effectList:r,key:s}=this,{sizeRampElement:n,colorRampElement:o}=cB(t,"horizontal");if(!n)return null;const a=hI(n,"full",!1,"horizontal"),l=rf(n,"full",!1,"horizontal"),u=tf(o,{width:l,height:12,rampAlignment:"horizontal",opacity:i,type:"full",effectList:r,ariaLabel:this.messages?.previewColorRampAriaLabel}),c=zw(n,"card"),d=n.infos.length-1,m=n.infos.map(((b,S)=>S===0||S===d?L("div",{key:S},b.label):null)),y={display:"flex",flexDirection:"column"},g={display:"flex",flexDirection:"row"},_={marginTop:"3px",display:"flex"};_w(this.container)?_.marginRight=`${c}px`:_.marginLeft=`${c}px`;const v={width:`${a}px`,display:"flex",flexDirection:"row",justifyContent:"space-between"};return L("div",{class:fe.layerRow,key:`${s}-container`,styles:y},L("div",{class:this.classes(fe.symbolContainer,fe.sizeRampHorizontal),styles:g},n.infos.map(((b,S)=>L("div",{afterCreate:At,bind:b.preview,class:fe.symbol,key:S})))),L("div",{class:fe.univariateAboveAndBelowColorRamp,key:"color-ramp-preview",styles:_},L("div",{afterCreate:At,bind:u})),L("div",{class:fe.layerInfo},L("div",{class:fe.rampLabelsContainer,styles:v},m)))}};h([f()],mc.prototype,"effectList",void 0),h([f()],mc.prototype,"legendElement",void 0),h([f()],mc.prototype,"messages",void 0),h([f()],mc.prototype,"opacity",void 0),mc=h([I("esri.widgets.Legend.styles.card.UnivariateColorSizeRamp")],mc);function F1({level:e,class:t,...i},r){const s=dB(e);return L(`h${s}`,{...i,"aria-level":String(s),class:Dd(Ai.heading,t),role:"heading"},r)}function dB(e){return lr(Math.ceil(e),1,6)}function p$e(e,t=1){return dB(e+t)}var lE;let Ts=lE=class extends vi{constructor(e,t){super(e,t),this.effectList=null,this.hasIndicators=!1,this.headingLevel=3,this.isChild=!1,this.legendElement=null}render(){const e=this._renderLegendElement(),t=sB(this.legendElement,this.messages),i=this.hasIndicators&&!this.isChild?L("div",null,L(F1,{class:fe.carouselTitle,level:this.headingLevel},this.activeLayerInfo.title),L(F1,{class:fe.layerCaption,level:p$e(this.headingLevel)},t)):t?L(F1,{class:fe.layerCaption,level:this.headingLevel},t):null;return L("section",{"aria-labelledby":this.key,class:fe.section,id:`${this.key}-panel`,key:this.key,role:"tabpanel",tabIndex:0},i,e)}_renderLegendElement(){switch(this.legendElement.type){case"symbol-table":return this._renderSymbolTable(this.legendElement);case"size-ramp":return L(pc,{hasIndicators:this.hasIndicators,key:this.key,legendElement:this.legendElement,messages:this.messages,opacity:this.layer.opacity});case"color-ramp":case"opacity-ramp":case"heatmap-ramp":case"stretch-ramp":return L(dc,{effectList:this.effectList,key:this.key,legendElement:this.legendElement,messages:this.messages,opacity:this.layer.opacity});case"relationship-ramp":return Nj(this.legendElement,this.id,{opacity:this.layer.opacity,effectList:this.effectList,ariaLabel:this.messages.previewRelationshipRampAriaLabel,key:this.key});case"pie-chart-ramp":return L("div",{afterCreate:At,bind:this.legendElement.preview,class:fe.pieChartRampPreview,key:`${this.key}-preview`});case"univariate-above-and-below-ramp":return L(fc,{effectList:this.effectList,key:this.key,legendElement:this.legendElement,messages:this.messages,opacity:this.layer.opacity});case"univariate-color-size-ramp":return L(mc,{effectList:this.effectList,key:this.key,legendElement:this.legendElement,messages:this.messages,opacity:this.layer.opacity});default:return null}}_renderSymbolTable(e){const t=e.infos.map((n=>this._renderElementInfo(n,e.legendType))).filter(Boolean);if(!t.length)return null;const i=this.activeLayerInfo.legendElements.some((({type:n})=>n==="relationship-ramp")),r=t[0]?.properties?.classes?.[fe.symbolRow],s={[fe.labelContainer]:!r&&!i,[fe.relationshipLabelContainer]:i};return L("div",{class:this.classes(s)},t)}_renderElementInfo(e,t){const{layer:i}=this,r="label"in e?e.label:null,s=`${this.key}-${r}`;if("type"in e&&e.type)return L(lE,{activeLayerInfo:this.activeLayerInfo,effectList:this.effectList,hasIndicators:this.hasIndicators,headingLevel:this.headingLevel,isChild:!0,key:s,layer:i,legendElement:e,messages:this.messages});if(!("preview"in e&&e.preview||"src"in e&&e.src))return null;const n=iB(i,t),o=ef(this.messages,r,!1)||"";if("src"in e&&e.src)return L("div",{class:fe.layerRow,key:`${s}-row`},this._renderImage(e,i,n),L("div",{class:fe.imageLabel},o));if("symbol"in e&&e.preview){if(!e.symbol?.type.includes("simple-fill")){if(!e.label)return L("div",{afterCreate:At,bind:e.preview,key:`${s}-row`});const a={[fe.symbolCell]:this.hasIndicators};return L("div",{class:this.classes(fe.layerRow,{[fe.symbolRow]:this.hasIndicators}),key:`${s}-row`},L("div",{afterCreate:At,bind:e.preview,class:this.classes(a)}),L("div",{class:this.classes(fe.imageLabel,{[fe.labelCell]:this.hasIndicators})},o))}return L("div",{class:fe.layerRow,key:`${s}-row`},L("div",{class:fe.labelElement,styles:this._getBackgroundStyles(e)},o))}return null}_getBackgroundStyles(e){const t=e.symbol,i=t.color,r=!!i?.a,s="outline"in t?t.outline:null,n=!!s?.color?.a,o=new X(r&&i?[i.r,i.g,i.b,i.a*this.layer.opacity]:[255,255,255,0]),a=n&&s.color?new X([s.color.r,s.color.g,s.color.b,s.color.a*this.layer.opacity]):new X([255,255,255,0]),l=e.symbol.color?.isBright??!0,u=l?"black":"white",c=l?"rgba(255, 255, 255, .6)":"rgba(0, 0, 0, .6)";return{background:r?o.toCss(!0):"none",color:u,textShadow:`-1px -1px 0 ${c},
                  1px -1px 0 ${c},
                  -1px 1px 0 ${c},
                  1px 1px 0 ${c}`,border:n?`1px solid ${a.toCss(!0)}`:"none",filter:n0(this.effectList)??void 0}}_renderImage(e,t,i){const{label:r,src:s,opacity:n}=e,o={[fe.imageryLayerStretchedImage]:i,[fe.symbol]:!i},a={opacity:`${n??t.opacity}`},l=ef(this.messages,r,!1);return L("img",{alt:l,"aria-label":l,border:0,class:this.classes(o),height:e.height,src:s,styles:a,width:e.width})}};h([f()],Ts.prototype,"activeLayerInfo",void 0),h([f()],Ts.prototype,"effectList",void 0),h([f()],Ts.prototype,"hasIndicators",void 0),h([f()],Ts.prototype,"headingLevel",void 0),h([f()],Ts.prototype,"isChild",void 0),h([f()],Ts.prototype,"layer",void 0),h([f()],Ts.prototype,"legendElement",void 0),h([f()],Ts.prototype,"messages",void 0),Ts=lE=h([I("esri.widgets.Legend.styles.card.LegendElement")],Ts);const f$e=768;let Cs=class extends vi{constructor(t,i){super(t,i),this._hasIndicators=!1,this.activeLayerInfos=null,this.headingLevel=3,this.layout="stack",this.messages=null,this.messagesCommon=null,this.type="card",this.view=null}loadDependencies(){return t0({carousel:()=>J(()=>import("./index-YwxjFJi2.js"),__vite__mapDeps([302,292,293,294,303,295,290,298,300,304,291])),"carousel-item":()=>J(()=>import("./index-CDKqFdmP.js"),__vite__mapDeps([305,290]))})}render(){this._hasIndicators=this.layout==="auto"&&this.view&&this.view.container.clientWidth<=f$e||this.layout==="stack";const t=this._hasIndicators?this._renderCarousel():this._renderLayers(),i={[fe.stacked]:this._hasIndicators};return L("div",{class:this.classes(fe.base,i)},t||L("div",{class:fe.message},this.messages.noLegend))}_renderCarousel(){const t=[],i=this.activeLayerInfos;if(i)for(const r of i)this._renderSections(r,t);return t?.length?L("calcite-carousel",{class:fe.carousel,label:this.messages.carousel},t.map(((r,s)=>L("calcite-carousel-item",{class:fe.carouselItem,key:s,label:mv(this.messagesCommon.pagination.pageText,{index:s+1,total:t.length})},r)))):null}_renderLayers(){const t=this.activeLayerInfos,i=t?.toArray()?.map((r=>this._renderLegendForLayer(r))).filter(Boolean);return i?.length?i:null}_renderLegendForLayer(t){if(!t.ready)return null;if(t.children.length){const i=t.children.toArray().map(this._renderLegendForLayer,this);return L("section",{class:this.classes(fe.service,fe.groupLayer),key:t.layer.uid},L("div",{class:fe.serviceCaptionContainer},t.title),i)}return this._renderLegendElementsForLayer(t)}_renderLegendElementsForLayer(t){const i=t.legendElements?.filter(Boolean);if(!i?.length)return null;const r=i.map((n=>L(Ts,{activeLayerInfo:t,effectList:t.effectList,hasIndicators:this._hasIndicators,headingLevel:this.headingLevel,isChild:!1,key:`${t.layer.uid}-${n.type}`,layer:t.layer,legendElement:n,messages:this.messages}))),s={[fe.groupLayerChild]:!!t.parent};return L("section",{class:this.classes(fe.service,s),key:t.layer.uid},L("div",{class:fe.serviceCaptionContainer},L("div",{class:fe.serviceCaptionText},t.title)),L("div",{class:fe.serviceContent},r))}_renderSections(t,i){if(!t.ready)return;if(t.children.length)for(const s of t.children)this._renderSections(s,i);const r=t.legendElements;if(r?.length)for(const s of r){const n=L(Ts,{activeLayerInfo:t,effectList:t.effectList,hasIndicators:this._hasIndicators,headingLevel:this.headingLevel,isChild:!1,key:`${t.layer.uid}-${s.type}`,layer:t.layer,legendElement:s,messages:this.messages});n&&i.push(n)}}};h([f()],Cs.prototype,"activeLayerInfos",void 0),h([f()],Cs.prototype,"headingLevel",void 0),h([f()],Cs.prototype,"layout",void 0),h([f(),Go("esri/widgets/Legend/t9n/Legend")],Cs.prototype,"messages",void 0),h([f(),Go("esri/t9n/common")],Cs.prototype,"messagesCommon",void 0),h([f({readOnly:!0})],Cs.prototype,"type",void 0),h([f()],Cs.prototype,"view",void 0),Cs=h([I("esri.widgets.Legend.styles.card.CardView")],Cs);const dt="esri-legend",_e={service:`${dt}__service`,label:`${dt}__service-label`,layer:`${dt}__layer`,groupLayer:`${dt}__group-layer`,groupLayerChild:`${dt}__group-layer-child`,layerTable:`${dt}__layer-table`,layerTableSizeRamp:`${dt}__layer-table--size-ramp`,layerChildTable:`${dt}__layer-child-table`,layerCaption:`${dt}__layer-caption`,layerBody:`${dt}__layer-body`,layerRow:`${dt}__layer-row`,layerInfo:`${dt}__layer-cell ${dt}__layer-cell--info`,imageryLayerStretchedImage:`${dt}__imagery-layer-image--stretched`,imageryLayerInfoStretched:`${dt}__imagery-layer-info--stretched`,symbolContainer:`${dt}__layer-cell ${dt}__layer-cell--symbols`,symbol:`${dt}__symbol`,rampContainer:`${dt}__ramps`,sizeRamp:`${dt}__size-ramp`,colorRamp:`${dt}__color-ramp`,opacityRamp:`${dt}__opacity-ramp`,rampLabelsContainer:`${dt}__ramp-labels`,rampLabel:`${dt}__ramp-label`,message:`${dt}__message`,univariateAboveAndBelowLabel:"esri-univariate-above-and-below-ramp__label"},m$e=24;let yc=class extends vi{constructor(t,i){super(t,i),this.legendElement=null,this.opacity=1}get _preview(){const t=this.legendElement.preview;if(!t)return null;const i=this.legendElement.type==="opacity-ramp"?_e.opacityRamp:"";return t.className=`${_e.colorRamp} ${i}`,this.opacity!=null&&(t.style.opacity=this.opacity.toString()),t}render(){const{legendElement:t,_preview:i}=this;if(!i)return null;const r={width:`${m$e}px`},s={height:i.style.height};return L("div",{class:_e.layerRow,key:`${this.key}-row`},L("div",{class:_e.symbolContainer,styles:r},L("div",{afterCreate:At,bind:i,class:_e.rampContainer})),L("div",{class:_e.layerInfo},L("div",{class:_e.rampLabelsContainer,styles:s},t.infos.map(((n,o)=>this._renderRampLabel(n,o,t.type))))))}_renderRampLabel(t,i,r){return L("div",{class:t.label?_e.rampLabel:void 0,key:`${this.key}-stop-${t.label??i}-label`},rB(t,r,this.messages))}};h([f()],yc.prototype,"_preview",null),h([f()],yc.prototype,"legendElement",void 0),h([f()],yc.prototype,"messages",void 0),h([f()],yc.prototype,"opacity",void 0),yc=h([I("esri.widgets.Legend.styles.classic.ColorRamp")],yc);let ny=class extends vi{constructor(t,i){super(t,i),this.legendElement=null}render(){const t=this.legendElement.infos.map((i=>this._renderRow(i))).filter(Boolean);return t.length?this.legendElement.theme==="spike"?oB(this.legendElement):L("div",{class:_e.layerBody},t):null}_renderRow(t){return t.preview?L("div",{class:_e.layerRow,key:`${this.key}-${t.label}-row`},L("div",{class:this.classes(_e.symbolContainer,_e.sizeRamp)},L("div",{afterCreate:At,bind:t.preview,class:_e.symbol})),L("div",{class:_e.layerInfo},ef(this.messages,t.label,!1)||"")):null}};h([f()],ny.prototype,"legendElement",void 0),h([f()],ny.prototype,"messages",void 0),ny=h([I("esri.widgets.Legend.styles.classic.SizeRamp")],ny);let gc=class extends vi{constructor(e,t){super(e,t),this.effectList=null,this.legendElement=null,this.opacity=1}render(){const{legendElement:e,opacity:t,effectList:i,key:r}=this,{sizeRampElement:s,colorRampElement:n}=uB(e,t);if(!s)return null;const o=this.messages.previewColorRampAriaLabel,a=rf(s,"above",!0),l=rf(s,"below",!0),u=12,c=tf(n,{width:u,height:a,rampAlignment:"vertical",opacity:t,type:"above",effectList:i,ariaLabel:o}),d=tf(n,{width:u,height:l,rampAlignment:"vertical",opacity:t,type:"below",effectList:i,ariaLabel:o}),m=zw(s),y=s.infos.map((P=>P.label)),g=y.map(((P,k)=>k===0?L("div",{class:P?c?_e.univariateAboveAndBelowLabel:_e.rampLabel:void 0,key:`${r}-color-ramp-above-label-${P??k}`},P):k===2?L("div",null):null)),_=y.length-1,v=Math.floor(y.length/2),b=y.map(((P,k)=>k===v||k===_?L("div",{class:P?c?_e.univariateAboveAndBelowLabel:_e.rampLabel:void 0,key:`${r}-color-ramp-below-label-${P??k}`},P):null)),S={display:"table-cell",verticalAlign:"middle"},$={marginTop:`${m}px`},E={height:`${a}px`},C={height:`${l}px`};return L("div",{key:`${r}-container`,styles:hB},L("div",{class:_e.layerBody},s.infos.map(((P,k)=>L("div",{class:this.classes(_e.layerRow,_e.sizeRamp),key:`${r}-row-${k}`},L("div",{afterCreate:At,bind:P.preview,class:_e.symbol,styles:S}),c||k%2!=0?null:L("div",{class:_e.layerInfo},y[k]))))),c?L("div",{styles:$},L("div",{styles:aE},L("div",{styles:Hd},L("div",{afterCreate:At,bind:c,class:_e.rampContainer})),L("div",{styles:Hd},L("div",{class:_e.rampLabelsContainer,styles:E},g))),L("div",{styles:aE},L("div",{styles:Hd},L("div",{afterCreate:At,bind:d,class:_e.rampContainer})),L("div",{styles:Hd},L("div",{class:_e.rampLabelsContainer,styles:C},b)))):null)}};h([f()],gc.prototype,"effectList",void 0),h([f()],gc.prototype,"legendElement",void 0),h([f()],gc.prototype,"messages",void 0),h([f()],gc.prototype,"opacity",void 0),gc=h([I("esri.widgets.Legend.styles.classic.UnivariateAboveAndBelowRamp")],gc);let _c=class extends vi{constructor(t,i){super(t,i),this.effectList=null,this.legendElement=null,this.opacity=1}render(){const{legendElement:t,opacity:i,effectList:r,key:s}=this,{sizeRampElement:n,colorRampElement:o}=cB(t);if(!n)return null;const a=zw(n),l=12,u=rf(n,"full",!1),c=tf(o,{width:l,height:u,rampAlignment:"vertical",opacity:i,type:"full",effectList:r,ariaLabel:this.messages?.previewColorRampAriaLabel}),d=n.infos.length-1,m=n.infos.map(((v,b)=>b===0||b===d?L("div",{class:v.label?o?_e.univariateAboveAndBelowLabel:_e.rampLabel:void 0,key:`${s}-color-ramp-label-${v.label??b}`},v.label):null)),y={display:"table-cell",verticalAlign:"middle"},g={marginTop:`${a}px`},_={height:`${u}px`};return L("div",{key:`${s}-container`,styles:hB},L("div",{class:_e.layerBody},n.infos.map(((v,b)=>L("div",{class:this.classes(_e.layerRow,_e.sizeRamp),key:`${s}-row-${b}`},L("div",{afterCreate:At,bind:v.preview,class:_e.symbol,styles:y}))))),L("div",{styles:g},L("div",{styles:aE},L("div",{styles:Hd},L("div",{afterCreate:At,bind:c,class:_e.rampContainer})),L("div",{styles:Hd},L("div",{class:_e.rampLabelsContainer,styles:_},m)))))}};h([f()],_c.prototype,"effectList",void 0),h([f()],_c.prototype,"legendElement",void 0),h([f()],_c.prototype,"messages",void 0),h([f()],_c.prototype,"opacity",void 0),_c=h([I("esri.widgets.Legend.styles.classic.UnivariateColorSizeRamp")],_c);var uE;let Ll=uE=class extends vi{constructor(e,t){super(e,t),this.effectList=null,this.isChild=!1,this.legendElement=null}render(){const e=this._renderLegendElement(),t=sB(this.legendElement,this.messages),i=this.isChild?_e.layerChildTable:_e.layerTable,r=t?L("div",{class:_e.layerCaption},t):null,s={[_e.layerTableSizeRamp]:this.legendElement.type==="size-ramp"||!this.isChild};return L("section",{class:this.classes(i,s),key:`${this.key}-table`},r,e)}_renderLegendElement(){switch(this.legendElement.type){case"symbol-table":return this._renderSymbolTable(this.legendElement);case"size-ramp":return L(ny,{key:this.key,legendElement:this.legendElement,messages:this.messages});case"color-ramp":case"opacity-ramp":case"heatmap-ramp":case"stretch-ramp":return L(yc,{key:this.key,legendElement:this.legendElement,messages:this.messages,opacity:this.layer.opacity});case"relationship-ramp":return Nj(this.legendElement,this.id,{opacity:this.layer.opacity,effectList:this.effectList,ariaLabel:this.messages.previewRelationshipRampAriaLabel,key:this.key});case"pie-chart-ramp":return L("div",{afterCreate:At,bind:this.legendElement.preview,key:`${this.key}-preview`});case"univariate-above-and-below-ramp":return L(gc,{effectList:this.effectList,key:this.key,legendElement:this.legendElement,messages:this.messages,opacity:this.layer.opacity});case"univariate-color-size-ramp":return L(_c,{effectList:this.effectList,key:this.key,legendElement:this.legendElement,messages:this.messages,opacity:this.layer.opacity});default:return null}}_renderSymbolTable(e){const t=e.infos.map((i=>this._renderElementInfo(i,e.legendType))).filter(Boolean);return t.length?L("div",{class:_e.layerBody},t):null}_renderElementInfo(e,t){const{layer:i}=this,r="label"in e?e.label:null,s=`${this.key}-${r}`;if("type"in e&&e.type)return L(uE,{effectList:this.effectList,isChild:!0,key:s,layer:i,legendElement:e,messages:this.messages});if(!("preview"in e&&e.preview||"src"in e&&e.src))return null;const n=iB(i,t),o={[_e.imageryLayerInfoStretched]:n},a={[_e.imageryLayerInfoStretched]:n};return L("div",{class:_e.layerRow,key:`${s}-row`},L("div",{class:this.classes(_e.symbolContainer,a)},this._renderPreview(e,n)),L("div",{class:this.classes(_e.layerInfo,o)},ef(this.messages,r,!1)||""))}_renderPreview(e,t){const{layer:i}=this;return"preview"in e&&e.preview?L("div",{afterCreate:At,bind:e.preview,class:_e.symbol}):"src"in e&&e.src?this._renderImage(e,i,t):null}_renderImage(e,t,i){const{label:r,src:s,opacity:n}=e,o={[_e.imageryLayerStretchedImage]:i,[_e.symbol]:!i},a={opacity:`${n??t.opacity}`},l=ef(this.messages,r,!1);return L("img",{alt:l,"aria-label":l,border:0,class:this.classes(o),height:e.height,src:s,styles:a,width:e.width})}};h([f()],Ll.prototype,"effectList",void 0),h([f()],Ll.prototype,"isChild",void 0),h([f()],Ll.prototype,"layer",void 0),h([f()],Ll.prototype,"legendElement",void 0),h([f()],Ll.prototype,"messages",void 0),Ll=uE=h([I("esri.widgets.Legend.styles.classic.LegendElement")],Ll);const y$e=`${dt}__`;let Ls=class extends vi{constructor(t,i){super(t,i),this.activeLayerInfos=null,this.headingLevel=3,this.messages=null,this.type="classic"}render(){const t=this.activeLayerInfos,i=t?.toArray().map((r=>this._renderLegendForLayer(r))).filter(Boolean);return i?.length?L("section",null,i):L("div",{class:_e.message,key:"no-legend"},this.messages.noLegend)}_renderLegendForLayer(t,i){if(!t.ready)return null;const r=`${t.layer.uid}-version-${t.version}`,s=`${y$e}${i?`${i}-`:""}${r}`,n=t.title?F1({level:this.headingLevel,class:this.classes(Ai.heading,_e.label)},t.title):null;if(t.children.length){const o=t.children.toArray().map((a=>this._renderLegendForLayer(a,r)));return L("section",{class:this.classes(_e.service,_e.groupLayer),key:s},n,o)}return this._renderLegendElementsForLayer(t,n,s)}_renderLegendElementsForLayer(t,i,r){const s=t.legendElements?.filter(Boolean);if(!s?.length)return null;const n=s.map((a=>L(Ll,{effectList:t.effectList,isChild:!1,key:`${r}-${a.type}`,layer:t.layer,legendElement:a,messages:this.messages}))),o={[_e.groupLayerChild]:!!t.parent};return L("section",{class:this.classes(_e.service,o),key:r},i,L("div",{class:_e.layer},n))}};h([f()],Ls.prototype,"activeLayerInfos",void 0),h([f()],Ls.prototype,"headingLevel",void 0),h([f(),Go("esri/widgets/Legend/t9n/Legend")],Ls.prototype,"messages",void 0),h([f({readOnly:!0})],Ls.prototype,"type",void 0),Ls=h([I("esri.widgets.Legend.styles.classic.ClassicView")],Ls);const g$e={base:"esri-legend"};let pi=class extends vi{constructor(e,t){super(e,t),this.headingLevel=3,this.messages=null,this.viewModel=new ns,this.style=new Ls}initialize(){this.addHandles([In((()=>this.view),"resize",(()=>this.scheduleRender())),In((()=>this.activeLayerInfos),"change",(()=>this._refreshActiveLayerInfos(this.activeLayerInfos))),te((()=>this.headingLevel),(e=>{const{style:t}=this;t&&(t.headingLevel=e)})),te((()=>this.style),((e,t)=>{t&&e!==t&&t.destroy(),e&&(e.activeLayerInfos=this.activeLayerInfos,e.type==="card"&&(e.view=this.view),e.headingLevel=this.headingLevel)}),Pt)])}destroy(){this.style?.destroy()}get activeLayerInfos(){return this.viewModel.activeLayerInfos}set activeLayerInfos(e){this.viewModel.activeLayerInfos=e}get basemapLegendVisible(){return this.viewModel.basemapLegendVisible}set basemapLegendVisible(e){this.viewModel.basemapLegendVisible=e}get groundLegendVisible(){return this.viewModel.groundLegendVisible}set groundLegendVisible(e){this.viewModel.groundLegendVisible=e}get hideLayersNotInCurrentView(){return this.viewModel.hideLayersNotInCurrentView}set hideLayersNotInCurrentView(e){this.viewModel.hideLayersNotInCurrentView=e}get keepCacheOnDestroy(){return this.viewModel.keepCacheOnDestroy}set keepCacheOnDestroy(e){this.viewModel.keepCacheOnDestroy=e}get respectLayerDefinitionExpression(){return this.viewModel.respectLayerDefinitionExpression}set respectLayerDefinitionExpression(e){this.viewModel.respectLayerDefinitionExpression=e}get respectLayerVisibility(){return this.viewModel.respectLayerVisibility}set respectLayerVisibility(e){this.viewModel.respectLayerVisibility=e}get icon(){return"legend"}set icon(e){this._overrideIfSome("icon",e)}get label(){return this.messages?.widgetLabel??""}set label(e){this._overrideIfSome("label",e)}get layerInfos(){return this.viewModel.layerInfos}set layerInfos(e){this.viewModel.layerInfos=e}set style(e){const t=this._get("style");e!==t&&t?.destroy(),this._set("style",e)}castStyle(e){if(e instanceof Cs||e instanceof Ls)return e;if(typeof e=="string")return e==="card"?new Cs:new Ls;if(e&&typeof e.type=="string"){const t={...e};return delete t.type,e.type==="card"?new Cs(t):new Ls(t)}return new Ls}get view(){return this.viewModel.view}set view(e){this.viewModel.view=e}render(){return L("div",{class:this.classes(g$e.base,Ai.widget,this.style instanceof Ls?Ai.panel:null)},this.style.render())}_refreshActiveLayerInfos(e){e.forEach((t=>{this.removeHandles(`version_${t.layer.uid}`),this._renderOnActiveLayerInfoChange(t)})),this.scheduleRender()}_renderOnActiveLayerInfoChange(e){const t=te((()=>e.version),(()=>this.scheduleRender()));this.addHandles(t,`version_${e.layer.uid}`);const i=In((()=>e.children),"change",(()=>e.children.forEach((r=>this._renderOnActiveLayerInfoChange(r)))),Pt);this.addHandles(i,`version_${e.layer.uid}`),e.children.forEach((r=>this._renderOnActiveLayerInfoChange(r)))}};h([f()],pi.prototype,"activeLayerInfos",null),h([f()],pi.prototype,"basemapLegendVisible",null),h([f()],pi.prototype,"groundLegendVisible",null),h([f()],pi.prototype,"headingLevel",void 0),h([f()],pi.prototype,"hideLayersNotInCurrentView",null),h([f()],pi.prototype,"keepCacheOnDestroy",null),h([f()],pi.prototype,"respectLayerDefinitionExpression",null),h([f()],pi.prototype,"respectLayerVisibility",null),h([f()],pi.prototype,"icon",null),h([f()],pi.prototype,"label",null),h([f()],pi.prototype,"layerInfos",null),h([f(),Go("esri/widgets/Legend/t9n/Legend")],pi.prototype,"messages",void 0),h([f()],pi.prototype,"style",null),h([Ke("style")],pi.prototype,"castStyle",null),h([f()],pi.prototype,"view",null),h([f()],pi.prototype,"viewModel",void 0),pi=h([I("esri.widgets.Legend")],pi);const E5e=pi,cE=(e=>e)(["operational-layers","basemap","ground"]),_$e={type:["average","color-burn","color-dodge","color","darken","destination-atop","destination-in","destination-out","destination-over","difference","exclusion","hard-light","hue","invert","lighten","lighter","luminosity","minus","multiply","normal","overlay","plus","reflect","saturation","screen","soft-light","source-atop","source-in","source-out","vivid-light","xor"],nonNullable:!0,json:{read:!1,write:!1,origins:{"web-map":{read:!0,write:{layerContainerTypes:cE}},"portal-item":{read:!0,write:{layerContainerTypes:cE}}}}},CN={read:{reader:Uye},write:{allowNull:!0,writer:jye,layerContainerTypes:cE}},v$e={json:{read:!1,write:!1,origins:{"web-map":CN,"portal-item":CN}}},C5e=e=>{let t=class extends e{constructor(){super(...arguments),this.blendMode="normal",this.effect=null}};return h([f(_$e)],t.prototype,"blendMode",void 0),h([f(v$e)],t.prototype,"effect",void 0),t=h([I("esri.layers.mixins.BlendLayer")],t),t};var hE;let oy=hE=class extends ee{constructor(e){super(e)}async collectRequiredFields(e,t){return ur(e,t,this.expression)}clone(){return new hE({expression:this.expression,title:this.title})}equals(e){return this.expression===e.expression&&this.title===e.title}};h([f({type:String,json:{write:{isRequired:!0}}})],oy.prototype,"expression",void 0),h([f({type:String,json:{write:!0}})],oy.prototype,"title",void 0),oy=hE=h([I("esri.symbols.support.FeatureExpressionInfo")],oy);const PN=oy;function P5e(e){return!!e&&Mw[e]!=null}function I5e(e){return 1/(Mw[e]||1)}function b$e(){const e=Object.keys(Mw);return mE(e,"decimal-degrees"),e.sort(),e}const w$e=b$e();var dE;const b_=cr()({onTheGround:"on-the-ground",relativeToGround:"relative-to-ground",relativeToScene:"relative-to-scene",absoluteHeight:"absolute-height"}),IN=new Ye({foot:"feet",kilometer:"kilometers",meter:"meters",mile:"miles","us-foot":"us-feet",yard:"yards"});var Ip;let yl=(Ip=class extends ee{constructor(t){super(t),this.featureExpressionInfo=void 0,this.offset=null}readFeatureExpressionInfo(t,i){return t!=null?t.expression?t:void 0:i.featureExpression&&i.featureExpression.value===0?{expression:"0"}:void 0}writeFeatureExpressionInfo(t,i,r,s){i[r]=t.write({},s),t.expression==="0"&&(i.featureExpression={value:0})}get mode(){const{offset:t,featureExpressionInfo:i}=this;return this._isOverridden("mode")?this._get("mode"):t!=null||i?"relative-to-ground":"on-the-ground"}set mode(t){this._override("mode",t)}set unit(t){this._set("unit",t)}write(t,i){return this.offset||this.mode||this.featureExpressionInfo||this.unit?super.write(t,i):null}clone(){return new dE({mode:this.mode,offset:this.offset,featureExpressionInfo:this.featureExpressionInfo?this.featureExpressionInfo.clone():void 0,unit:this.unit})}equals(t){return this.mode===t.mode&&this.offset===t.offset&&this.unit===t.unit&&pH(this.featureExpressionInfo,t.featureExpressionInfo)}},dE=Ip,Ip);h([f({type:PN,json:{write:!0}})],yl.prototype,"featureExpressionInfo",void 0),h([Ae("featureExpressionInfo",["featureExpressionInfo","featureExpression"])],yl.prototype,"readFeatureExpressionInfo",null),h([$e("featureExpressionInfo",{featureExpressionInfo:{type:PN},"featureExpression.value":{type:[0]}})],yl.prototype,"writeFeatureExpressionInfo",null),h([f({type:b_.apiValues,nonNullable:!0,json:{type:b_.jsonValues,read:b_.read,write:{writer:b_.write,isRequired:!0}}})],yl.prototype,"mode",null),h([f({type:Number,json:{write:!0}})],yl.prototype,"offset",void 0),h([f({type:w$e,json:{type:String,read:IN.read,write:IN.write}})],yl.prototype,"unit",null),yl=dE=h([I("esri.symbols.support.ElevationInfo")],yl);const A5e=e=>{let t=class extends e{constructor(){super(...arguments),this.minScale=0,this.maxScale=0}get effectiveScaleRange(){const i={minScale:this.minScale,maxScale:this.maxScale},r=this.parent;r&&"effectiveScaleRange"in r&&S$e(i,r.effectiveScaleRange);const s=this._get("effectiveScaleRange");return s&&s.minScale===i.minScale&&s.maxScale===i.maxScale?s:i}};return h([f({type:Number,nonNullable:!0,json:{write:!0}})],t.prototype,"minScale",void 0),h([f({type:Number,nonNullable:!0,json:{write:!0}})],t.prototype,"maxScale",void 0),h([f({readOnly:!0})],t.prototype,"effectiveScaleRange",null),t=h([I("esri.layers.mixins.ScaleRangeLayer")],t),t};function S$e(e,t){return e.minScale=e.minScale>0?t.minScale>0?Math.min(e.minScale,t.minScale):e.minScale:t.minScale,e.maxScale=e.maxScale>0?t.maxScale>0?Math.max(e.maxScale,t.maxScale):e.maxScale:t.maxScale,e}export{obe as $,KTe as A,Ey as B,Z as C,zK as D,Xt as E,bde as F,GK as G,QTe as H,Li as I,O3e as J,Ee as K,IR as L,D3e as M,Nf as N,ze as O,iPe as P,vV as Q,ci as R,Er as S,k8 as T,_f as U,OI as V,h as W,f as X,I as Y,bMe as Z,J as _,SLe as a,Hce as a$,wu as a0,xe as a1,Ae as a2,$e as a3,Ot as a4,It as a5,AE as a6,Fe as a7,XTe as a8,X$e as a9,gi as aA,OC as aB,Zne as aC,O8 as aD,ZCe as aE,WCe as aF,zCe as aG,Ky as aH,Xy as aI,Rne as aJ,_3 as aK,Dee as aL,jye as aM,Uye as aN,Td as aO,xh as aP,uz as aQ,cr as aR,me as aS,ye as aT,C5e as aU,A5e as aV,kt as aW,yl as aX,lL as aY,gQ as aZ,he as a_,ot as aa,jq as ab,No as ac,b4 as ad,at as ae,st as af,yr as ag,cE as ah,NCe as ai,xt as aj,ee as ak,Ye as al,Goe as am,Wi as an,jC as ao,ab as ap,le as aq,XE as ar,ne as as,Ine as at,NI as au,Bs as av,Ni as aw,hh as ax,ae as ay,V as az,rr as b,kO as b$,Uge as b0,jge as b1,Gge as b2,jle as b3,Su as b4,uee as b5,yf as b6,aee as b7,Lte as b8,bz as b9,iw as bA,_ce as bB,_6 as bC,mf as bD,Ate as bE,hee as bF,dee as bG,pee as bH,Bce as bI,Wy as bJ,xb as bK,Vi as bL,op as bM,vL as bN,GPe as bO,qQ as bP,pPe as bQ,Tg as bR,lG as bS,_h as bT,yK as bU,cn as bV,Yoe as bW,Ui as bX,rR as bY,Xv as bZ,WAe as b_,Hte as ba,Gs as bb,Qle as bc,UK as bd,pEe as be,Ap as bf,KCe as bg,vh as bh,oh as bi,Rn as bj,Tr as bk,J0e as bl,p_e as bm,xU as bn,a_e as bo,Lce as bp,ehe as bq,OM as br,K7 as bs,r_e as bt,Q7 as bu,X7 as bv,f_e as bw,l_e as bx,Z0e as by,X0e as bz,LLe as c,Bl as c$,LO as c0,wr as c1,hAe as c2,Fde as c3,iSe as c4,mG as c5,jk as c6,Uk as c7,Vk as c8,zk as c9,$g as cA,aD as cB,ke as cC,gn as cD,Yt as cE,mt as cF,Og as cG,ge as cH,se as cI,b0e as cJ,Oa as cK,v0e as cL,Cie as cM,bTe as cN,it as cO,STe as cP,wTe as cQ,xTe as cR,$Te as cS,MTe as cT,lr as cU,ux as cV,In as cW,qCe as cX,te as cY,Pt as cZ,K_e as c_,u1 as ca,Wp as cb,Zy as cc,St as cd,kn as ce,LE as cf,yt as cg,Lg as ch,Bo as ci,ar as cj,zy as ck,D0 as cl,MC as cm,UV as cn,Qt as co,Rc as cp,kQ as cq,ST as cr,zMe as cs,OU as ct,xLe as cu,ELe as cv,x7 as cw,Ri as cx,cCe as cy,mE as cz,j as d,jPe as d$,Yr as d0,Hs as d1,ex as d2,wt as d3,av as d4,U_ as d5,QS as d6,ix as d7,zU as d8,ce as d9,gMe as dA,of as dB,Ave as dC,Re as dD,zt as dE,V1e as dF,dg as dG,X as dH,Sj as dI,Ny as dJ,Tj as dK,SRe as dL,wf as dM,d5e as dN,p5e as dO,U1e as dP,cwe as dQ,Eoe as dR,LPe as dS,WPe as dT,rY as dU,h5e as dV,hRe as dW,jx as dX,cRe as dY,Eg as dZ,Ja as d_,og as da,Tt as db,Wv as dc,tpe as dd,ni as de,w_ as df,Hg as dg,k$ as dh,LEe as di,MPe as dj,qPe as dk,Ha as dl,p4 as dm,ro as dn,br as dp,uy as dq,CS as dr,I$e as ds,Mde as dt,LN as du,UIe as dv,Gle as dw,cf as dx,Hr as dy,B$e as dz,xI as e,C4 as e$,JQ as e0,Xn as e1,iEe as e2,VN as e3,zN as e4,oY as e5,Fb as e6,zb as e7,tC as e8,iC as e9,SU as eA,bce as eB,vU as eC,wU as eD,Zp as eE,ZH as eF,EMe as eG,Wq as eH,ih as eI,CE as eJ,_Me as eK,Lie as eL,mU as eM,$u as eN,Fce as eO,xte as eP,vce as eQ,bU as eR,Zce as eS,nEe as eT,vv as eU,Pb as eV,Ib as eW,pD as eX,Ke as eY,J$e as eZ,oH as e_,nY as ea,qs as eb,Gg as ec,Hy as ed,tEe as ee,A4 as ef,Boe as eg,une as eh,JCe as ei,Uo as ej,sw as ek,Kse as el,L8 as em,Sne as en,ePe as eo,jr as ep,QCe as eq,vne as er,BC as es,lEe as et,S4 as eu,QE as ev,KZ as ew,ks as ex,Vb as ey,yU as ez,JTe as f,gTe as f$,CTe as f0,I5e as f1,Ug as f2,mMe as f3,kE as f4,Nt as f5,Kt as f6,Ct as f7,gr as f8,$r as f9,zi as fA,Vy as fB,M9 as fC,T9 as fD,lLe as fE,bLe as fF,oC as fG,T$e as fH,cu as fI,Bc as fJ,cMe as fK,Va as fL,uMe as fM,m0e as fN,Me as fO,LCe as fP,ICe as fQ,Uke as fR,ACe as fS,qg as fT,Ci as fU,qke as fV,kCe as fW,jc as fX,E$e as fY,C$e as fZ,yTe as f_,Ga as fa,Mce as fb,Tce as fc,Yce as fd,yu as fe,wQ as ff,Ie as fg,VS as fh,FE as fi,rh as fj,qr as fk,Ms as fl,yD as fm,pke as fn,uke as fo,w4 as fp,VTe as fq,Ue as fr,tt as fs,xEe as ft,Bee as fu,HQ as fv,AEe as fw,Xa as fx,Wa as fy,vA as fz,MLe as g,y3 as g$,rg as g0,Dt as g1,RV as g2,er as g3,We as g4,Vs as g5,Br as g6,gEe as g7,jp as g8,nz as g9,Ub as gA,kEe as gB,bh as gC,i0 as gD,GV as gE,pye as gF,nAe as gG,vt as gH,YP as gI,mwe as gJ,VPe as gK,CPe as gL,$Ee as gM,g2 as gN,gh as gO,Le as gP,uf as gQ,lf as gR,pMe as gS,ei as gT,wRe as gU,kc as gV,zce as gW,RTe as gX,Rue as gY,uEe as gZ,bue as g_,rP as ga,cke as gb,Gce as gc,Fp as gd,fH as ge,kse as gf,mH as gg,gq as gh,kRe as gi,Eie as gj,YLe as gk,KLe as gl,ske as gm,E5e as gn,fEe as go,kW as gp,RI as gq,Zee as gr,TTe as gs,rMe as gt,Ns as gu,mD as gv,BRe as gw,C_ as gx,zx as gy,Md as gz,Cb as h,OZ as h$,P4 as h0,I4 as h1,Ft as h2,oEe as h3,yte as h4,vz as h5,Ice as h6,wz as h7,tY as h8,See as h9,vRe as hA,W_e as hB,Tie as hC,$ie as hD,gie as hE,dA as hF,Ba as hG,pz as hH,Vg as hI,Mq as hJ,rCe as hK,Wd as hL,Kq as hM,Vo as hN,e1e as hO,F4 as hP,hY as hQ,U4 as hR,CLe as hS,Hke as hT,Cke as hU,qEe as hV,Lv as hW,VEe as hX,fMe as hY,AMe as hZ,IZ as h_,z as ha,wte as hb,wee as hc,rw as hd,P$e as he,M_ as hf,F$e as hg,Vce as hh,Pce as hi,YR as hj,Wle as hk,wPe as hl,bPe as hm,ooe as hn,I6 as ho,rre as hp,TMe as hq,Nr as hr,vMe as hs,$D as ht,wMe as hu,SMe as hv,kp as hw,kb as hx,Bg as hy,OCe as hz,nLe as i,JV as i$,FZ as i0,Mn as i1,hke as i2,ake as i3,_7 as i4,CP as i5,wie as i6,Zfe as i7,Yfe as i8,_Le as i9,Wc as iA,kAe as iB,dn as iC,d1 as iD,Fk as iE,GIe as iF,rU as iG,lP as iH,EM as iI,dh as iJ,Tue as iK,sU as iL,lR as iM,Nk as iN,SW as iO,js as iP,Lp as iQ,xE as iR,nH as iS,SEe as iT,Jt as iU,Sue as iV,$ue as iW,iU as iX,M$e as iY,Iy as iZ,jM as i_,tme as ia,vLe as ib,rme as ic,bfe as id,rLe as ie,Ym as ig,gLe as ih,kLe as ii,mLe as ij,$9 as ik,Zde as il,Jv as im,Yv as io,PAe as ip,Rs as iq,qk as ir,Zv as is,Gk as it,UM as iu,FU as iv,BM as iw,RAe as ix,Jp as iy,LAe as iz,wH as j,SC as j$,kC as j0,T as j1,P1 as j2,WN as j3,cee as j4,lee as j5,xce as j6,Qce as j7,the as j8,Lue as j9,pj as jA,cS as jB,v7 as jC,pH as jD,us as jE,oz as jF,ui as jG,xMe as jH,h8 as jI,nTe as jJ,PLe as jK,V$e as jL,U$e as jM,z$e as jN,Bq as jO,yh as jP,ON as jQ,Wn as jR,hMe as jS,uA as jT,dke as jU,OK as jV,ZQ as jW,YQ as jX,bu as jY,Xl as jZ,h4 as j_,Aw as ja,c_e as jb,iz as jc,iY as jd,uY as je,Av as jf,$ce as jg,gU as jh,Y1 as ji,Th as jj,Rce as jk,Ti as jl,aH as jm,XN as jn,B9 as jo,GE as jp,qo as jq,ad as jr,xa as js,fke as jt,Rg as ju,ri as jv,ft as jw,hs as jx,LRe as jy,ARe as jz,ZTe as k,vi as k$,Ok as k0,K3e as k1,X3e as k2,J3e as k3,Y3e as k4,eAe as k5,Q3e as k6,Z3e as k7,W3e as k8,Eue as k9,LQ as kA,P6 as kB,vIe as kC,FN as kD,UY as kE,ZY as kF,Ng as kG,OTe as kH,nb as kI,mA as kJ,pE as kK,cTe as kL,CEe as kM,UE as kN,WMe as kO,HMe as kP,mEe as kQ,CW as kR,EW as kS,TEe as kT,$_e as kU,k$e as kV,gwe as kW,ZAe as kX,ct as kY,mTe as kZ,xg as k_,kI as ka,H3e as kb,KMe as kc,nC as kd,BY as ke,gE as kf,j$e as kg,_E as kh,G$e as ki,rQ as kj,mW as kk,VMe as kl,bke as km,YC as kn,EPe as ko,$Pe as kp,Yue as kq,Jue as kr,F5 as ks,_U as kt,$le as ku,qMe as kv,RRe as kw,id as kx,WTe as ky,qTe as kz,mK as l,Ua as l$,t0 as l0,L as l1,mv as l2,Go as l3,OLe as l4,Ai as l5,Ype as l6,tfe as l7,bq as l8,K$e as l9,Il as lA,Fm as lB,Rd as lC,b8 as lD,XCe as lE,Doe as lF,FK as lG,Eke as lH,kke as lI,lIe as lJ,aIe as lK,cA as lL,ku as lM,DN as lN,R$e as lO,Bk as lP,OAe as lQ,Qk as lR,NAe as lS,Ze as lT,LOe as lU,Ro as lV,Nd as lW,xOe as lX,SOe as lY,oMe as lZ,pw as l_,JN as la,Ab as lb,sMe as lc,ege as ld,dO as le,Yp as lf,bne as lg,wne as lh,c5e as li,Z6 as lj,L6 as lk,wEe as ll,H8 as lm,cP as ln,az as lo,dw as lp,tCe as lq,eCe as lr,kV as ls,AV as lt,tle as lu,rle as lv,oIe as lw,Mt as lx,yQ as ly,De as lz,En as m,Y$e as m$,Fo as m0,tr as m1,ry as m2,mAe as m3,eP as m4,MM as m5,CV as m6,Xg as m7,Wke as m8,ou as m9,xr as mA,wa as mB,Wl as mC,mi as mD,Ioe as mE,ice as mF,x_e as mG,ap as mH,M_e as mI,Kg as mJ,lle as mK,tz as mL,S_e as mM,T_e as mN,Yee as mO,_Ee as mP,AQ as mQ,DQ as mR,Wg as mS,Zg as mT,Yg as mU,bte as mV,_te as mW,vte as mX,NN as mY,nD as mZ,PE as m_,ppe as ma,mpe as mb,ype as mc,mye as md,gy as me,DCe as mf,xC as mg,$Me as mh,ID as mi,v$e as mj,ob as mk,ILe as ml,Gke as mm,PCe as mn,s5e as mo,Hue as mp,sAe as mq,Ode as mr,sR as ms,G3e as mt,Hde as mu,Une as mv,$te as mw,mte as mx,gte as my,gm as mz,abe as n,O6 as n$,L4 as n0,II as n1,vD as n2,zpe as n3,Dke as n4,Sh as n5,io as n6,u0e as n7,cEe as n8,xPe as n9,F_e as nA,D_e as nB,AP as nC,bge as nD,gke as nE,fTe as nF,Hp as nG,_$e as nH,Nh as nI,yq as nJ,Hk as nK,Vl as nL,Fpe as nM,CAe as nN,Dk as nO,Wde as nP,Xk as nQ,Jk as nR,An as nS,Mue as nT,aEe as nU,WOe as nV,Kb as nW,Qb as nX,ZOe as nY,Hv as nZ,HOe as n_,SPe as na,TE as nb,kte as nc,Ite as nd,Ace as ne,Pte as nf,coe as ng,xue as nh,rEe as ni,wpe as nj,gD as nk,Rp as nl,Mg as nm,Q$e as nn,Lx as no,_8 as np,$Re as nq,xIe as nr,SIe as ns,Mle as nt,BE as nu,sTe as nv,cSe as nw,NOe as nx,dP as ny,t5e as nz,mu as o,bve as o$,l5e as o0,Nde as o1,oAe as o2,aAe as o3,a5e as o4,ir as o5,Ike as o6,Ake as o7,Pke as o8,iI as o9,sIe as oA,nIe as oB,FRe as oC,zRe as oD,DRe as oE,_C as oF,yMe as oG,NRe as oH,ORe as oI,zl as oJ,N$e as oK,YV as oL,Yme as oM,Us as oN,mw as oO,ZV as oP,XV as oQ,sue as oR,BIe as oS,pue as oT,qIe as oU,bf as oV,yge as oW,mge as oX,Gl as oY,vve as oZ,Rge as o_,Cue as oa,e5e as ob,xRe as oc,Eh as od,k1e as oe,Gf as of,wn as og,eEe as oh,o5e as oi,n5e as oj,r5e as ok,i5e as ol,JOe as om,eI as on,m_ as oo,AG as op,XOe as oq,YOe as or,Sr as os,zbe as ot,QOe as ou,bwe as ov,ZRe as ow,ZZ as ox,B8 as oy,rIe as oz,Cg as p,uR as p$,m7 as p0,bn as p1,Vd as p2,xn as p3,cte as p4,ZEe as p5,Lw as p6,Fi as p7,Gr as p8,Mi as p9,lv as pA,ETe as pB,S0e as pC,RCe as pD,P0e as pE,Kke as pF,Za as pG,Ya as pH,On as pI,fu as pJ,N2e as pK,xAe as pL,G4 as pM,Sle as pN,dle as pO,ple as pP,bEe as pQ,tte as pR,HTe as pS,PTe as pT,QLe as pU,Ra as pV,vr as pW,YTe as pX,aMe as pY,Cle as pZ,so as p_,_A as pa,yoe as pb,woe as pc,HPe as pd,fwe as pe,xW as pf,dMe as pg,aG as ph,cG as pi,Ch as pj,xu as pk,RC as pl,tke as pm,t7 as pn,e7 as po,ule as pp,Tle as pq,rS as pr,bIe as ps,iS as pt,YEe as pu,kv as pv,xle as pw,Wce as px,hle as py,Vr as pz,eMe as q,tMe as q$,HU as q0,vAe as q1,bAe as q2,wAe as q3,SAe as q4,lAe as q5,cAe as q6,iQ as q7,sg as q8,uAe as q9,j2e as qA,xwe as qB,Jb as qC,KOe as qD,hb as qE,NU as qF,sRe as qG,jde as qH,Ude as qI,kU as qJ,$G as qK,VOe as qL,UOe as qM,RU as qN,RO as qO,JP as qP,Qg as qQ,vu as qR,hu as qS,joe as qT,U8 as qU,Fne as qV,ur as qW,fs as qX,e3 as qY,ITe as qZ,ATe as q_,fpe as qa,bY as qb,zo as qc,zle as qd,tP as qe,OQ as qf,vEe as qg,ig as qh,ZL as qi,Kae as qj,Qae as qk,nx as ql,jTe as qm,wIe as qn,uye as qo,vTe as qp,_Te as qq,vY as qr,Dd as qs,bV as qt,$W as qu,_w as qv,Jpe as qw,zEe as qx,G2e as qy,bN as qz,UTe as r,epe as r$,iH as r0,yi as r1,Mw as r2,aO as r3,uRe as r4,j3e as r5,iE as r6,zOe as r7,Wye as r8,YCe as r9,iRe as rA,be as rB,q0e as rC,V0e as rD,tRe as rE,fb as rF,Ry as rG,pb as rH,j7 as rI,U7 as rJ,hwe as rK,D0e as rL,N0e as rM,PT as rN,fAe as rO,z0e as rP,s0 as rQ,Vde as rR,ROe as rS,j0e as rT,OOe as rU,pAe as rV,DOe as rW,Qke as rX,oSe as rY,nSe as rZ,bG as r_,VCe as ra,GCe as rb,UCe as rc,BCe as rd,jCe as re,HCe as rf,Rse as rg,CCe as rh,qAe as ri,TI as rj,FCe as rk,LTe as rl,ZW as rm,PD as rn,nRe as ro,xT as rp,oRe as rq,eRe as rr,ti as rs,G0e as rt,fj as ru,Xke as rv,z7 as rw,Iw as rx,rRe as ry,kOe as rz,TLe as s,HAe as s$,jSe as s0,dAe as s1,oR as s2,B3e as s3,q3e as s4,dwe as s5,lwe as s6,yAe as s7,gAe as s8,$Ae as s9,Bne as sA,WC as sB,Kme as sC,IEe as sD,EIe as sE,zte as sF,LV as sG,X6 as sH,HD as sI,Fte as sJ,Mee as sK,gle as sL,vke as sM,_ke as sN,age as sO,nCe as sP,$0e as sQ,Ide as sR,k4 as sS,PEe as sT,vm as sU,lke as sV,Gie as sW,mRe as sX,fRe as sY,Rk as sZ,yke as s_,MAe as sa,tAe as sb,TAe as sc,EAe as sd,Rde as se,Gde as sf,Dde as sg,s9 as sh,Np as si,_Ae as sj,$de as sk,iMe as sl,Pue as sm,H5 as sn,gbe as so,Ane as sp,eLe as sq,tLe as sr,F1 as ss,One as st,l9 as su,Qy as sv,tg as sw,kne as sx,q$e as sy,Gne as sz,H as t,_n as t$,GAe as t0,BAe as t1,jAe as t2,UAe as t3,hpe as t4,qU as t5,rAe as t6,iAe as t7,lpe as t8,wS as t9,Wte as tA,J7 as tB,UEe as tC,P5e as tD,Dae as tE,RIe as tF,kge as tG,BPe as tH,APe as tI,OPe as tJ,kPe as tK,H$e as tL,QPe as tM,KPe as tN,D$e as tO,BZ as tP,PPe as tQ,MEe as tR,UPe as tS,Kp as tT,$se as tU,tce as tV,cU as tW,nMe as tX,t_ as tY,PA as tZ,HEe as t_,J2e as ta,U3e as tb,Bd as tc,$H as td,vq as te,Kce as tf,IAe as tg,AAe as th,FPe as ti,zPe as tj,kue as tk,Yte as tl,Zte as tm,J6 as tn,tj as to,Dse as tp,VU as tq,ALe as tr,Qn as ts,jIe as tt,$Le as tu,zke as tv,Vke as tw,jke as tx,lb as ty,Ote as tz,tPe as u,Lke as u0,Ei as u1,uj as u2,bRe as u3,_T as u4,OIe as u5,Iv as u6,RPe as u7,dte as u8,TPe as u9,ERe as uA,CRe as uB,NPe as uC,GEe as uD,AL as uE,jEe as uF,EEe as uG,IL as uH,IC as uI,hD as uJ,lMe as uK,DPe as uL,Tte as uM,Ste as uN,PRe as uO,MRe as uP,kw as uQ,PL as uR,IRe as uS,Rte as uT,REe as uU,NEe as uV,YAe as uW,Mh as uX,f5e as uY,axe as uZ,y5e as u_,ave as ua,Jke as ub,hj as uc,Id as ud,loe as ue,yPe as uf,aj as ug,jj as uh,Gj as ui,j_e as uj,L$e as uk,mq as ul,A$e as um,IPe as un,DAe as uo,ble as up,sEe as uq,nle as ur,aoe as us,GRe as ut,UMe as uu,aC as uv,TRe as uw,jT as ux,uC as uy,BEe as uz,mh as v,_u as w,aLe as x,N as y,jK as z};
