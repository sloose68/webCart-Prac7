const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/ElevationLayer-CXHp7esL.js","assets/ArcGISCachedService-Bzw7_OyX.js","assets/TileInfoTilemapCache-C6XB-lot.js","assets/TilemapCache-CFPaCxfU.js","assets/ByteSizeUnit-BsxeN7wM.js","assets/WorkerHandle-C8IfMtWs.js","assets/layersCreator-BrQYwzG-.js","assets/loadUtils-C6tYOmSm.js","assets/fetchService-BHBbYtrG.js","assets/associatedFeatureServiceUtils-TKcG0exE.js","assets/lazyLayerLoader-ERDzX15J.js","assets/portalLayers-BbZcK54n.js","assets/geometryEngineBase-B9CjWDWD.js","assets/_commonjsHelpers-DCkdB7M8.js","assets/arcgisLayers-DzG4O9sV.js","assets/statsWorker-qbB2PU6i.js","assets/utils-C8txB8o5.js","assets/utils-CztKhyhh.js","assets/ClassBreaksDefinition-BJEqQgUP.js","assets/geometryEngineWorker-BeElq9cK.js","assets/geometryEngineJSON-CO8CMyeT.js","assets/json-Wa8cmqdu.js","assets/CSVSourceWorker-D6O0cYRx.js","assets/date-DCujAECq.js","assets/OptimizedFeature-DXawZqVI.js","assets/executeQueryForSnapping-D-W-pqgD.js","assets/queryUtils-LdDtF0Uj.js","assets/QueryEngine-D8aBAaI7.js","assets/featureConversionUtils-CLKc-TL5.js","assets/OptimizedFeatureSet-BR8EEvDc.js","assets/WhereClauseCache-D5cd6bMJ.js","assets/WhereClause-0wjTjh8V.js","assets/timeSupport-B0KgrVns.js","assets/QueryEngineCapabilities-CsRUnGk7.js","assets/SnappingCandidate-DGkpYqI6.js","assets/FixedIntervalBinParameters-DDYTuBwd.js","assets/FeatureStore-BW6_C6Jm.js","assets/BoundsStore-DfT7iDex.js","assets/PooledRBush-1GokHj4O.js","assets/optimizedFeatureQueryEngineAdapter-BesAiM_c.js","assets/number-Bst4n29M.js","assets/clientSideDefaults-C9J3dTWQ.js","assets/EdgeProcessingWorker--nNGcbrG.js","assets/workerHelper-Bo6mU7HB.js","assets/InterleavedLayout-nuJLUfeT.js","assets/BufferView-C34xwGfY.js","assets/types-BKo2foNY.js","assets/edgeProcessing-BxOyNFaR.js","assets/deduplicate-DF-VtV2y.js","assets/Indices-BmED5Jc-.js","assets/VertexAttribute-BfkzOMLV.js","assets/glUtil-DC3rhG4W.js","assets/VertexElementDescriptor-BLyltQyJ.js","assets/Normals-BHE8SSsW.js","assets/ElevationSamplerWorker-9eC-BDPF.js","assets/MeshLocalVertexSpace-COWcaa-l.js","assets/vertexSpaceConversion-CUfeeBYD.js","assets/mat3f64-B5o_lm6j.js","assets/mat4f64-q_b6UJoq.js","assets/spatialReferenceEllipsoidUtils-CaVCUFwP.js","assets/computeTranslationToOriginAndRotation-7eQGGBSb.js","assets/projectPointToVector-BntUtADA.js","assets/meshVertexSpaceUtils-Bb8IoviT.js","assets/vec3-C1_LdcMY.js","assets/vec4-BktBw16h.js","assets/FeatureServiceSnappingSourceWorker-ytDD3ADU.js","assets/symbologySnappingCandidates-DWCfPVhJ.js","assets/pbfQueryUtils-B1Vg6oKs.js","assets/pbf-BtUhcBfS.js","assets/query-BP2eh2V_.js","assets/GeoJSONSourceWorker-Cwbf_gOC.js","assets/geojson-BzVwP0r9.js","assets/sourceUtils-BtYKKslQ.js","assets/MemorySourceWorker-CX-T8u_l.js","assets/objectIdUtils-BmFjqQA3.js","assets/PBFDecoderWorker-CJLB6BXK.js","assets/dehydratedFeatures-B9771ZuC.js","assets/FeaturePipelineWorker-DMR_O_w7.js","assets/AttributeStore-Bs3IW0-x.js","assets/Utils-C7AwGdUV.js","assets/UpdateTracking2D-BYq6_I2u.js","assets/constants-BFLErLYb.js","assets/streamLayerUtils-CKwt2uXH.js","assets/MeshWriterRegistry-D1EpRtVh.js","assets/TechniqueType-pk2C5RYg.js","assets/PieChartMeshWriter-sObqKfPm.js","assets/libtess-BD8RCkFu.js","assets/earcut-D9gy186-.js","assets/QueueProcessor-BVvANoyd.js","assets/operatorGeodeticDensify-CmTo9YFg.js","assets/SimpleGeometryCursor-B92kdZ15.js","assets/geodeticCurveType-CirnHLSB.js","assets/normalizeUtilsSync-BDBZcs-V.js","assets/ogcFeatureUtils-UbfI3sGo.js","assets/bundle-B2FM5W1M.js","assets/CircularArray-CujHzHWW.js","assets/createConnection-2zjeGcum.js","assets/PointCloudWorker-C0__zR_Y.js","assets/quat-v-4FoJvm.js","assets/quatf64-aQ5IuZRd.js","assets/vec3f32-WCVSSNPR.js","assets/PointCloudUniqueValueRenderer-1iWk-FqF.js","assets/I3SBinaryReader-BS-AJFu1.js","assets/orientedBoundingBox-DBzTgw-5.js","assets/plane-UM7dTH0q.js","assets/vectorStacks-o2ABMMQ_.js","assets/RasterWorker-ZVRVOhRv.js","assets/GeographicTransformation-BttaCsP2.js","assets/dataUtils-4yuI7tRO.js","assets/RasterSymbolizer-DM7GVIcT.js","assets/rasterFunctionHelper-Ci3VPap3.js","assets/clipUtils-Udkz6YVS.js","assets/rasterProjectionHelper-DQ6l7p-Z.js","assets/PolynomialTransform-BXhUVi4m.js","assets/SceneLayerSnappingSourceWorker-DO2SeHKH.js","assets/lineSegment-DlzB3dta.js","assets/sphere-Zq0FFRBH.js","assets/Octree-DCXcdIFm.js","assets/SceneLayerWorker-BE2fkfEp.js","assets/projectVectorToVector-DDaZNS98.js","assets/I3SUtil-CXnpHB5s.js","assets/edgeUtils-BH7NKYts.js","assets/NormalAttribute.glsl-vaQi7OoC.js","assets/glsl-Cj7KC756.js","assets/ShaderOutput-Bdd80V3g.js","assets/BindType-BBwFZqyN.js","assets/WFSSourceWorker-Ckk26Vi2.js","assets/wfsUtils--zWnJOuJ.js","assets/xmlUtils-CtUoQO7q.js","assets/WorkerTileHandler-nC5hIpyc.js","assets/constants-BwsikM5h.js","assets/config-DHajyIwB.js","assets/StyleDefinition-htb1aXAC.js","assets/SourceLayerData-bMCUAKEz.js","assets/StyleRepository-mCJplwCr.js","assets/Feature3DPipelineWorker-Dc4-te33.js","assets/dehydratedFeatureUtils-VBJdeQTp.js","assets/hydratedFeatures-DmqWY_MV.js","assets/OutputColorHighlightOID.glsl-DJFYPx4A.js","assets/videoUtils-BtTccKab.js","assets/requestImageUtils-Cr78SR0p.js","assets/basicInterfaces-N86vRvDz.js","assets/TextureFormat-1mYWTFa-.js","assets/triangle-lzlUG5A4.js","assets/renderState-XsiBUpch.js","assets/boundedPlane-FjeP7DNv.js","assets/HUDMaterial.glsl-BEd3M-F3.js","assets/ShaderBuilder-6EiPRc2v.js","assets/HUDMaterial-C5giYqBF.js","assets/primitiveObjectSymbolUtils-Du1aDVrc.js","assets/IntersectorType-gQim6TH1.js","assets/RealisticTree.glsl-U1Uc9pRk.js","assets/TextureCompressionWorker-DfVjw9uT.js","assets/Popup-QY14Ao02.js","assets/unitFormatUtils-ChDNs4Ud.js","assets/quantityUtils-BrHPXnqo.js","assets/AttachmentInfo-Vi0q6JMG.js","assets/featureUtils-DZAb1560.js","assets/executeQueryJSON-BeobjtaJ.js","assets/shared-l3rpE-jC.js","assets/NetworkElement-ebwqduh9.js","assets/ReactiveSet-D2Od0o5J.js","assets/layerViewUtils-DKAt--v3.js","assets/arcadeUtils-YoRP2rat.js","assets/arcade-BcRjyS1W.js","assets/aiServices-ChHDnQpT.js","assets/ImmutableArray-BPVd6ESQ.js","assets/commonProperties-DHiB1uzW.js","assets/unitConversion-DOYOT2rI.js","assets/batchExec-CfRd1Izs.js","assets/geometryServiceUtils-BFZpQDam.js","assets/project-BkLjFe79.js","assets/webglDeps-DWJWwPVg.js","assets/ProgramTemplate-CV2s5TMF.js","assets/FramebufferObject-J9vQGfVh.js","assets/NestedMap-wm1q4thl.js","assets/mapViewDeps-BG3K5zX5.js","assets/FeatureCommandQueue-BaAIf_uj.js","assets/GraphShaderModule-CiJGZZXH.js","assets/utils-D5lHKt24.js","assets/WGLContainer-gqfrfYoD.js","assets/Container-BN_aiuQ-.js","assets/SDFHelper-B8CmVOsr.js","assets/GridShader-DWEU3KzW.js","assets/testSVGPremultipliedAlpha-djwY6vN0.js","assets/SymbolFader-Dah-dRdG.js","assets/RenderingContext-CCQdqNo-.js","assets/utils-DVSqFSAJ.js","assets/utils-ehcGqGxa.js","assets/projectOperator-B93eMjjM.js","assets/GraphicsView2D-Bl8xvMNI.js","assets/GraphicContainer-WgzuSq9z.js","assets/AGraphicContainer-CgvD3gmE.js","assets/TechniqueInstance-DVVWFkGB.js","assets/TileContainer-SLffMg4T.js","assets/gridUtils-0rqLQ37u.js","assets/TileLayerView2D-Ptkpbdzr.js","assets/imageUtils-B_taYTJP.js","assets/BitmapTechnique-B-Vj4FuC.js","assets/bitmapUtils-DEzZa_Au.js","assets/LayerView-Doz3WFOp.js","assets/HighlightGraphicContainer-DHI3MXUM.js","assets/RefreshableLayerView-DG_T2LlN.js","assets/MapServiceLayerViewHelper-a3ZqGLoy.js","assets/drapedUtils-D3sFmBYu.js","assets/popupUtils-CIX694tH.js","assets/FeatureLayerView2D-C2fVO2VI.js","assets/timeSupport-DndpBYpf.js","assets/AttributeBinsFeatureSet-Wb3GLxm8.js","assets/AttributeBinsQuery-HwAtokxK.js","assets/constants-B4mRqufT.js","assets/BaseDynamicLayerView2D-BqRtisVk.js","assets/BitmapContainer-BrIx6j1N.js","assets/ExportStrategy-D99IXndo.js","assets/CatalogLayerView2D-CJPOpgnw.js","assets/CatalogDynamicGroupLayerView2D-BEXvBIW1.js","assets/CatalogFootprintLayerView2D-CgdOBDd1.js","assets/GeoRSSLayerView2D-YOL94o05.js","assets/GraphicsLayerView2D-DQVA4h7c.js","assets/GroupLayerView2D-CKZYZkGp.js","assets/ImageryLayerView2D-CldsVw7C.js","assets/RasterVFDisplayObject-BKUHj5dt.js","assets/ImageryTileLayerView2D-BzMkHW7e.js","assets/rasterFieldUtils-Cjx32SLS.js","assets/rasterUtils-Dyedd_Vk.js","assets/RawBlockCache-C42ZG3W3.js","assets/KMLLayerView2D-CNidZHvA.js","assets/kmlUtils-CY4PQAO_.js","assets/KnowledgeGraphLayerView2D-Cvid4tsf.js","assets/MapImageLayerView2D-DgPlyA4k.js","assets/MapNotesLayerView2D-CbXxBwer.js","assets/MediaLayerView2D-BnycMmqP.js","assets/mediaLayerUtils-DcL2olpv.js","assets/OverlayContainer-DB_qyHrv.js","assets/OGCFeatureLayerView2D-DTNQJuTz.js","assets/RouteLayerView2D-CpByvJ2N.js","assets/Stop-AFIpb8TM.js","assets/networkEnums-K3xDolAa.js","assets/StreamLayerView2D-ZKlT1qTs.js","assets/SubtypeGroupLayerView2D-DCFCVj5T.js","assets/VectorTileLayerView2D-DvncI6Q_.js","assets/VideoLayerView2D-CBI6x4FO.js","assets/GraphicsLayer-DozMfMNJ.js","assets/videoUtils-BopvI4GX.js","assets/WMSLayerView2D-DXUbXXrU.js","assets/ExportWMSImageParameters-DybRNsKF.js","assets/WMTSLayerView2D-Biu_ci01.js","assets/apng-BxXEKkq7.js","assets/index-DUj_Tbgt.js","assets/index-BGx1ee1l.js","assets/guid-Bu7NDcrC.js","assets/useT9n-DpanCk0a.js","assets/index-O6rR6W0e.js","assets/dom-B1coy8XZ.js","assets/observers-CiZ48nRg.js","assets/ref-B_KoaLBp.js","assets/static-BjTCol81.js","assets/form-CxLWnhhv.js","assets/interactive-Bc9-1TCe.js","assets/label-BSMgtm1E.js","assets/component-BML7pKH5.js","assets/index-C1XTlK1w.js","assets/index-CPI-i8d7.js","assets/customElement-Ch6nRPCE.js","assets/array-CaayCXLe.js","assets/index-Bt0t3P1G.js","assets/layersLoader-4g6LI2h-.js","assets/jsonContext-r92RYpBI.js","assets/featureLayerUtils-BHYhyg6k.js","assets/originUtils-g6LU6MiT.js","assets/utils-CjMZHEOD.js","assets/saveUtils-foTgqyXp.js","assets/FeatureLayerSource-VqjKXT1y.js","assets/External-Cp8Od0-H.js","assets/MeshTransform-Dcdd75Iq.js","assets/axisAngleDegrees-BGUQttvb.js","assets/editingSupport-DzVNRpoc.js","assets/QueryTask-BQj94v77.js","assets/executeForIds-BnjGQ6gN.js"])))=>i.map(i=>d[i]);
var SY=Object.getPrototypeOf;var xY=Reflect.get;var YL=t=>{throw TypeError(t)};var cx=(t,e,r)=>e.has(t)||YL("Cannot "+r);var ot=(t,e,r)=>(cx(t,e,"read from private field"),r?r.call(t):e.get(t)),Sn=(t,e,r)=>e.has(t)?YL("Cannot add the same private member more than once"):e instanceof WeakSet?e.add(t):e.set(t,r),xn=(t,e,r,i)=>(cx(t,e,"write to private field"),i?i.call(t,r):e.set(t,r),r),ey=(t,e,r)=>(cx(t,e,"access private method"),r);var XL=(t,e,r)=>xY(SY(t),r,e);(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const s of document.querySelectorAll('link[rel="modulepreload"]'))i(s);new MutationObserver(s=>{for(const n of s)if(n.type==="childList")for(const o of n.addedNodes)o.tagName==="LINK"&&o.rel==="modulepreload"&&i(o)}).observe(document,{childList:!0,subtree:!0});function r(s){const n={};return s.integrity&&(n.integrity=s.integrity),s.referrerPolicy&&(n.referrerPolicy=s.referrerPolicy),s.crossOrigin==="use-credentials"?n.credentials="include":s.crossOrigin==="anonymous"?n.credentials="omit":n.credentials="same-origin",n}function i(s){if(s.ep)return;s.ep=!0;const n=r(s);fetch(s.href,n)}})();function c(t,e,r,i){var s,n=arguments.length,o=n<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,r):i;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")o=Reflect.decorate(t,e,r,i);else for(var a=t.length-1;a>=0;a--)(s=t[a])&&(o=(n<3?s(o):n>3?s(e,r,o):s(e,r))||o);return n>3&&o&&Object.defineProperty(e,r,o),o}function eLe(t,e){return function(r,i){e(r,i,t)}}function tLe(t,e,r,i){function s(n){return n instanceof r?n:new r((function(o){o(n)}))}return new(r||(r=Promise))((function(n,o){function a(h){try{u(i.next(h))}catch(p){o(p)}}function l(h){try{u(i.throw(h))}catch(p){o(p)}}function u(h){h.done?n(h.value):s(h.value).then(a,l)}u((i=i.apply(t,[])).next())}))}function rLe(t,e,r){if(e!=null){if(typeof e!="object"&&typeof e!="function")throw new TypeError("Object expected.");var i,s;if(i===void 0){if(!Symbol.dispose)throw new TypeError("Symbol.dispose is not defined.");i=e[Symbol.dispose]}if(typeof i!="function")throw new TypeError("Object not disposable.");s&&(i=function(){try{s.call(this)}catch(n){return Promise.reject(n)}}),t.stack.push({value:e,dispose:i,async:r})}return e}var $Y=typeof SuppressedError=="function"?SuppressedError:function(t,e,r){var i=new Error(r);return i.name="SuppressedError",i.error=t,i.suppressed=e,i};function iLe(t){function e(n){t.error=t.hasError?new $Y(n,t.error,"An error was suppressed during disposal."):n,t.hasError=!0}var r,i=0;function s(){for(;r=t.stack.pop();)try{if(!r.async&&i===1)return i=0,t.stack.push(r),Promise.resolve().then(s);if(r.dispose){var n=r.dispose.call(r.value);if(r.async)return i|=2,Promise.resolve(n).then(s,(function(o){return e(o),s()}))}else i|=1}catch(o){e(o)}if(i===1)return t.hasError?Promise.reject(t.error):Promise.resolve();if(t.hasError)throw t.error}return s()}const MY="modulepreload",TY=function(t){return"/webCart-Prac7/"+t},KL={},J=function(e,r,i){let s=Promise.resolve();if(r&&r.length>0){let l=function(u){return Promise.all(u.map(h=>Promise.resolve(h).then(p=>({status:"fulfilled",value:p}),p=>({status:"rejected",reason:p}))))};document.getElementsByTagName("link");const o=document.querySelector("meta[property=csp-nonce]"),a=o?.nonce||o?.getAttribute("nonce");s=l(r.map(u=>{if(u=TY(u),u in KL)return;KL[u]=!0;const h=u.endsWith(".css"),p=h?'[rel="stylesheet"]':"";if(document.querySelector(`link[href="${u}"]${p}`))return;const m=document.createElement("link");if(m.rel=h?"stylesheet":MY,h||(m.as="script"),m.crossOrigin="",m.href=u,a&&m.setAttribute("nonce",a),document.head.appendChild(m),h)return new Promise((y,g)=>{m.addEventListener("load",y),m.addEventListener("error",()=>g(new Error(`Unable to preload CSS for ${u}`)))})}))}function n(o){const a=new Event("vite:preloadError",{cancelable:!0});if(a.payload=o,window.dispatchEvent(a),!a.defaultPrevented)throw o}return s.then(o=>{for(const a of o||[])a.status==="rejected"&&n(a.reason);return e().catch(n)})};let Uu;function z(t){return typeof Uu[t]=="function"?Uu[t]=Uu[t](globalThis):Uu[t]}Uu=globalThis.dojoConfig?.has||globalThis.esriConfig?.has?{...globalThis.dojoConfig?.has,...globalThis.esriConfig?.has}:{},z.add=(t,e,r,i)=>{(i||Uu[t]===void 0)&&(Uu[t]=e),r&&z(t)},z.cache=Uu,z.add("big-integer-warning-enabled",!0),z.add("esri-deprecation-warnings",!0),z.add("esri-tests-disable-screenshots",!1),z.add("esri-tests-use-full-window",!1),z.add("esri-tests-post-to-influx",!0),z.add("esri-cim-animations-enable-status","enabled"),z.add("esri-cim-animations-spotlight",!1),z.add("esri-cim-animations-freeze-time",!1),(()=>{z.add("host-webworker",globalThis.WorkerGlobalScope!==void 0&&self instanceof globalThis.WorkerGlobalScope);const t=typeof window<"u"&&typeof location<"u"&&typeof document<"u"&&window.location===location&&window.document===document;if(z.add("host-browser",t),z.add("host-node",typeof globalThis.process=="object"&&globalThis.process.versions?.node&&globalThis.process.versions.v8),z.add("dom",t),z("host-browser")){const e=navigator,r=e.userAgent,i=e.appVersion,s=parseFloat(i);if(z.add("wp",parseFloat(r.split("Windows Phone")[1])||void 0),z.add("msapp",parseFloat(r.split("MSAppHost/")[1])||void 0),z.add("khtml",i.includes("Konqueror")?s:void 0),z.add("edge",parseFloat(r.split("Edge/")[1])||void 0),z.add("opr",parseFloat(r.split("OPR/")[1])||void 0),z.add("webkit",!z("wp")&&!z("edge")&&parseFloat(r.split("WebKit/")[1])||void 0),z.add("chrome",!z("edge")&&!z("opr")&&parseFloat(r.split("Chrome/")[1])||void 0),z.add("android",!z("wp")&&parseFloat(r.split("Android ")[1])||void 0),z.add("safari",!i.includes("Safari")||z("wp")||z("chrome")||z("android")||z("edge")||z("opr")?void 0:parseFloat(i.split("Version/")[1])),z.add("mac",i.includes("Macintosh")),!z("wp")&&/(iPhone|iPod|iPad)/.test(r)){const n=RegExp.$1.replace(/P/,"p"),o=/OS ([\d_]+)/.test(r)?RegExp.$1:"1",a=parseFloat(o.replace(/_/,".").replaceAll("_",""));z.add(n,a),z.add("ios",a)}z("webkit")||(!r.includes("Gecko")||z("wp")||z("khtml")||z("edge")||z.add("mozilla",s),z("mozilla")&&z.add("ff",parseFloat(r.split("Firefox/")[1]||r.split("Minefield/")[1])||void 0))}})(),(()=>{if(globalThis.navigator){const t=navigator.userAgent,e=/Android|webOS|iPhone|iPad|iPod|BlackBerry|Opera Mini|IEMobile/i.test(t),r=/iPhone/i.test(t);e&&z.add("esri-mobile",e),r&&z.add("esri-iPhone",r),z.add("esri-geolocation",!!navigator.geolocation)}z.add("esri-wasm","WebAssembly"in globalThis),z.add("esri-performance-mode-frames-between-render",20),z.add("esri-force-performance-mode",!1),z.add("esri-shared-array-buffer",(()=>{const t="SharedArrayBuffer"in globalThis,e=globalThis.crossOriginIsolated===!1;return t&&!e})),z.add("wasm-simd",(()=>{const t=[0,97,115,109,1,0,0,0,1,5,1,96,0,1,123,3,2,1,0,10,10,1,8,0,65,0,253,15,253,98,11];return WebAssembly.validate(new Uint8Array(t))})),z.add("esri-atomics","Atomics"in globalThis),z.add("esri-workers","Worker"in globalThis),z.add("web-feat:cache","caches"in globalThis),z.add("esri-workers-arraybuffer-transfer",!z("safari")||Number(z("safari"))>=12),z.add("workers-pool-size",8),z.add("featurelayer-simplify-thresholds",[.5,.5,.5,.5]),z.add("featurelayer-simplify-payload-size-factors",[1,1,4]),z.add("featurelayer-fast-triangulation-enabled",!0),z.add("featurelayer-animation-enabled",!0),z.add("featurelayer-snapshot-enabled",!0),z.add("featurelayer-snapshot-initial-tolerance",0),z.add("featurelayer-snapshot-point-min-threshold",8e4),z.add("featurelayer-snapshot-point-max-threshold",4e5),z.add("featurelayer-snapshot-multipoint-min-threshold",2e4),z.add("featurelayer-snapshot-multipoint-max-threshold",1e5),z.add("featurelayer-snapshot-polygon-min-threshold",1e3),z.add("featurelayer-snapshot-polygon-max-threshold",2e3),z.add("featurelayer-snapshot-polyline-min-threshold",1e3),z.add("featurelayer-snapshot-polyline-max-threshold",2e3),z.add("featurelayer-snapshot-max-vertex-count",25e4),z.add("featurelayer-snapshot-non-hosted-exceedslimit-enabled",!1),z.add("featurelayer-snapshot-concurrency",4),z.add("featurelayer-snapshot-coverage",.1),z.add("featurelayer-query-max-depth",4),z.add("featurelayer-query-pausing-enabled",!1),z.add("featurelayer-query-tile-concurrency",4),z.add("featurelayer-query-tile-max-features",6e5),z.add("featurelayer-advanced-symbols",!1),z.add("featurelayer-pbf",!0),z.add("featurelayer-pbf-statistics",!1),z.add("feature-layers-workers",!0),z.add("feature-polyline-generalization-factor",1),z.add("mapview-transitions-duration",200),z.add("mapview-essential-goto-duration",200),z.add("mapview-srswitch-adjust-rotation-scale-threshold",24e6),z.add("mapserver-pbf-version-support",10.81),z.add("mapservice-popup-identify-max-tolerance",20),z.add("request-queue-concurrency-hosted",16),z.add("request-queue-concurrency-non-hosted",4),z.add("curve-densification-coarse-segments",128),z.add("curve-densification-max-segments",2e3),z.add("curve-densification-min-segments",3),z.add("curve-densification-pixel-deviation",.5),z.add("view-readyState-waiting-delay",1e3),z.add("gradient-depth-bias",.01),z.add("gradient-depth-epsilon",1e-8),z.add("enable-feature:esri-compress-textures",!0),z("host-webworker")||z("host-browser")&&(z.add("esri-csp-restrictions",(()=>{try{new Function}catch{return!0}return!1})),z.add("esri-image-decode",(()=>{if("decode"in new Image){const t=new Image;return t.src='data:image/svg+xml;charset=UTF-8,<svg version="1.1" xmlns="http://www.w3.org/2000/svg"></svg>',void t.decode().then((()=>{z.add("esri-image-decode",!0,!0,!0)})).catch((()=>{z.add("esri-image-decode",!1,!0,!0)}))}return!1})),z.add("esri-url-encodes-apostrophe",(()=>{const t=window.document.createElement("a");return t.href="?'",t.href.includes("?%27")})))})();function sLe(t){}function EY(t){return()=>t}function nLe(t){return t}var is;let RP=(is=class{constructor(e=1){this._seed=e}set seed(e){this._seed=e??Math.random()*is._m}getInt(){return this._seed=(is._a*this._seed+is._c)%is._m,this._seed}getFloat(){return this.getInt()/(is._m-1)}getIntRange(e,r){return Math.round(this.getFloatRange(e,r))}getFloatRange(e,r){const i=r-e;return e+this.getInt()/is._m*i}},is._m=2147483647,is._a=48271,is._c=0,is);const IY=1.5,oLe=1/IY,aLe=.5;function lLe(t,e){return e?t.filter(((r,i,s)=>s.findIndex(e.bind(null,r))===i)):Array.from(new Set(t))}function CY(t,e,r,i,s,n,o){if(t==null&&i==null)return!0;e=Math.max(0,e),s=Math.max(0,s),r=Math.max(0,r<0?(t?.length??0)+r:r),n=Math.max(0,n<0?(i?.length??0)+n:n);const a=r-e;if(t==null||i==null||a!==n-s)return!1;if(o){for(let l=0;l<a;l++)if(!o(t[e+l],i[s+l]))return!1}else for(let l=0;l<a;l++)if(t[e+l]!==i[s+l])return!1;return!0}function FS(t,e,r){return CY(t,0,t?.length??0,e,0,e?.length??0,r)}function QL(t,e,r){let i,s;return r?(i=e.filter((n=>!t.some((o=>r(o,n))))),s=t.filter((n=>!e.some((o=>r(o,n)))))):(i=e.filter((n=>!t.includes(n))),s=t.filter((n=>!e.includes(n)))),{added:i,removed:s}}function uLe(t){return t&&typeof t.length=="number"}let K6=class{constructor(){this.last=0}};const Q6=new K6;function hM(t,e,r,i){i=i||Q6;const s=Math.max(0,i.last-10);for(let o=s;o<r;++o)if(t[o]===e)return i.last=o,o;const n=Math.min(s,r);for(let o=0;o<n;++o)if(t[o]===e)return i.last=o,o;return-1}function PY(t,e,r,i){const s=t.length,n=hM(t,e,s,i);if(n!==-1)return t[n]=t[s-1],t.pop(),e}const $n=new Set;function AY(t,e,r=t.length,i=e.length,s,n){if(i===0||r===0)return r;$n.clear();for(let a=0;a<i;++a)$n.add(e[a]);s=s||Q6;const o=Math.max(0,s.last-10);for(let a=o;a<r;++a)if($n.has(t[a])&&(n?.push(t[a]),$n.delete(t[a]),t[a]=t[r-1],--r,--a,$n.size===0||r===0))return $n.clear(),r;for(let a=0;a<o;++a)if($n.has(t[a])&&(n?.push(t[a]),$n.delete(t[a]),t[a]=t[r-1],--r,--a,$n.size===0||r===0))return $n.clear(),r;return $n.clear(),r}function hLe(t,e,r){const i=t.length;if(e>=i)return t.slice();const s=kP(r),n=new Set,o=[];for(;o.length<e;){const a=Math.floor(s()*i);n.has(a)||(n.add(a),o.push(t[a]))}return o}function kP(t){return t?(eR.seed=t,()=>eR.getFloat()):Math.random}const eR=new RP;function ez(t,e){if(!t)return t;const r=kP(e);for(let i=t.length-1;i>0;i--){const s=Math.floor(r()*(i+1)),n=t[i];t[i]=t[s],t[s]=n}return t}function OP(t,e){const r=t.indexOf(e);return r!==-1?(t.splice(r,1),e):null}function ii(t,e){return t!=null}const dLe=[];function pLe(t){return t instanceof ArrayBuffer}function NP(t){return t?.constructor?.name==="Int8Array"}function tz(t){return t?.constructor?.name==="Uint8Array"}function rz(t){return t?.constructor?.name==="Uint8ClampedArray"}function FP(t){return t?.constructor?.name==="Int16Array"}function iz(t){return t?.constructor?.name==="Uint16Array"}function DP(t){return t?.constructor?.name==="Int32Array"}function sz(t){return t?.constructor?.name==="Uint32Array"}function LY(t){return t?.constructor?.name==="Float16Array"}function DS(t){return t?.constructor?.name==="Float32Array"}function zS(t){return t?.constructor?.name==="Float64Array"}function nz(t){return"buffer"in t}const oz=1024;function fLe(t){return zS(t)||DS(t)||DP(t)||FP(t)||NP(t)}function mLe(t){return zS(t)||DS(t)}function yLe(t){return zS(t)?179769e303:LY(t)?65504:DS(t)?3402823e32:sz(t)?4294967295:iz(t)?65535:tz(t)||rz(t)?255:DP(t)?2147483647:FP(t)?32767:NP(t)?127:256}const gLe=-32768,vLe=-2147483648;function RY(t,e){let r;for(r in t)t.hasOwnProperty(r)&&t[r]===void 0&&delete t[r];return t}function k(t){if(!t||typeof t!="object"||typeof t=="function")return t;const e=uz(t);if(e!=null)return e;if(Ub(t))return t.clone();if(az(t))return t.map(k);if(lz(t))throw new Error("Trying to clone an unclonable Accessor instance");const r={};for(const i of Object.getOwnPropertyNames(t))r[i]=k(t[i]);return r}function dM(t){if(!t||typeof t!="object"||typeof t=="function"||"HTMLElement"in globalThis&&t instanceof HTMLElement)return t;const e=uz(t);if(e!=null)return e;if(az(t)){let i=!0;const s=t.map((n=>{const o=dM(n);return n!=null&&o==null&&(i=!1),o}));return i?s:null}if(Ub(t))return t.clone();if(t instanceof File||t instanceof Blob)return t;if(lz(t))return null;const r=new(Object.getPrototypeOf(t)).constructor;for(const i of Object.getOwnPropertyNames(t)){const s=t[i],n=dM(s);if(s!=null&&n==null)return null;r[i]=n}return r}function Ub(t){return typeof t.clone=="function"}function az(t){return typeof t.map=="function"&&typeof t.forEach=="function"}function lz(t){return typeof t.notifyChange=="function"&&typeof t.watch=="function"}function tR(t){if(Object.prototype.toString.call(t)!=="[object Object]")return!1;const e=Object.getPrototypeOf(t);return e===null||e===Object.prototype}function uz(t){if(NP(t)||tz(t)||rz(t)||FP(t)||iz(t)||DP(t)||sz(t)||DS(t)||zS(t))return t.slice();if(t instanceof Date)return new Date(t.getTime());if(t instanceof ArrayBuffer)return t.slice(0,t.byteLength);if(t instanceof Map){const e=new Map;for(const[r,i]of t)e.set(r,k(i));return e}if(t instanceof Set){const e=new Set;for(const r of t)e.add(k(r));return e}return null}function zP(t,e){return t===e||typeof t=="number"&&isNaN(t)&&typeof e=="number"&&isNaN(e)||typeof t?.getTime=="function"&&typeof e?.getTime=="function"&&t.getTime()===e.getTime()||!1}function cz(t,e){return t===e||(t==null||typeof t=="string"?t===e:typeof t=="number"?t===e||typeof e=="number"&&isNaN(t)&&isNaN(e):t instanceof Date?e instanceof Date&&t.getTime()===e.getTime():Array.isArray(t)?Array.isArray(e)&&FS(t,e):t instanceof Set?e instanceof Set&&OY(t,e):t instanceof Map?e instanceof Map&&NY(t,e):!!tR(t)&&tR(e)&&kY(t,e))}function kY(t,e){if(t===null||e===null)return!1;const r=Object.keys(t);if(e===null||Object.keys(e).length!==r.length)return!1;for(const i of r)if(t[i]!==e[i]||!Object.prototype.hasOwnProperty.call(e,i))return!1;return!0}function OY(t,e){if(t.size!==e.size)return!1;for(const r of t)if(!e.has(r))return!1;return!0}function NY(t,e){if(t.size!==e.size)return!1;for(const[r,i]of t){const s=e.get(r);if(s!==i||s===void 0&&!e.has(r))return!1}return!0}function VP(t,e,r=!1){return dz(t,e,r)}function fv(t,e){if(e!=null)return e[t]||hz(t.split("."),!1,e)}function Cr(t,e,r){const i=t.split("."),s=i.pop(),n=hz(i,!0,r);n&&s&&(n[s]=e)}function rR(t,e){if(t==null&&e==null)return!1;if(t==null||e==null)return!0;if(typeof t=="object"){if(Array.isArray(t)){const r=e;if(t.length!==r.length)return!0;for(let i=0;i<t.length;i++)if(rR(t[i],r[i]))return!0;return!1}if(Object.keys(t).length!==Object.keys(e).length)return!0;for(const r in t)if(rR(t[r],e[r]))return!0;return!1}return t!==e}function hz(t,e,r){let i=r;for(const s of t){if(i==null)return;if(!(s in i)){if(!e)return;i[s]={}}i=i[s]}return i}function dz(t,e,r){return e?Object.keys(e).reduce(((i,s)=>{if(s==="__proto__")return i;let n=i[s],o=e[s];return n===o?i:n===void 0?(i[s]=k(o),i):(Array.isArray(o)||Array.isArray(i)?(n=n?Array.isArray(n)?i[s]=n.slice():i[s]=[n]:i[s]=[],o&&(Array.isArray(o)||(o=[o]),r?o.forEach((a=>{n.includes(a)||n.push(a)})):i[s]=o.slice())):o&&typeof o=="object"?i[s]=dz(n,o,r):i.hasOwnProperty(s)&&!e.hasOwnProperty(s)||(i[s]=o),i)}),t||{}):t}const Ge={apiKey:void 0,apiKeys:{scopes:[]},applicationName:"",applicationUrl:globalThis.location?.href,assetsPath:"",fontsUrl:"https://static.arcgis.com/fonts",geometryServiceUrl:"https://utility.arcgisonline.com/arcgis/rest/services/Geometry/GeometryServer",geoRSSServiceUrl:"https://utility.arcgis.com/sharing/rss",kmlServiceUrl:"https://utility.arcgis.com/sharing/kml",userPrivilegesApplied:!0,portalUrl:"https://www.arcgis.com",respectPrefersReducedMotion:!0,routeServiceUrl:"https://route-api.arcgis.com/arcgis/rest/services/World/Route/NAServer/Route_World",workers:{loaderConfig:{has:{},paths:{},map:{},packages:[]}},request:{crossOriginNoCorsDomains:null,httpsDomains:["arcgis.com","arcgisonline.com","esrikr.com","premiumservices.blackbridge.com","esripremium.accuweather.com","gbm.digitalglobe.com","firstlook.digitalglobe.com","msi.digitalglobe.com"],interceptors:[],internalInterceptors:[],maxUrlLength:2e3,priority:"high",proxyRules:[],proxyUrl:null,timeout:62e3,trustedServers:[],useIdentity:!0},log:{interceptors:[],level:null}};if(globalThis.esriConfig&&(VP(Ge,globalThis.esriConfig,!0),delete Ge.has),!Ge.assetsPath){{const t="4.33";Ge.assetsPath=`https://js.arcgis.com/${t}/@arcgis/core/assets`}Ge.defaultAssetsPath=Ge.assetsPath}const FY=/\{([^}]+)\}/g;function iR(t){return t??""}function gc(t,e){return e?t.replaceAll(FY,typeof e=="object"?(r,i)=>iR(fv(i,e)):(r,i)=>iR(e(i))):t}function _Le(t,e){return t.replaceAll(/([.$?*|{}()[\]\\/+\-^])/g,(r=>e?.includes(r)?r:`\\${r}`))}function pz(t){let e=0;for(let r=0;r<t.length;r++)e=(e<<5)-e+t.charCodeAt(r),e|=0;return e}let sR;function DY(t){return sR??=new DOMParser,sR.parseFromString(t||"","text/html").body.innerText||""}function bLe(t,e){return new RegExp(`{${e}}`,"ig").test(t)}function wLe(t,...e){let r=t[0];for(let i=0;i<e.length;++i)r+=e[i]+t[i+1];return r}const nR={info:0,warn:1,error:2,none:3};var hr;let q=(hr=class{constructor(e){this.level=null,this._module="",this._parent=null,this.writer=null,this._loggedMessages={error:new Map,warn:new Map,info:new Map},e.level!=null&&(this.level=e.level),e.writer!=null&&(this.writer=e.writer),this._module=e.module,hr._loggers.set(this.module,this);const r=this.module.lastIndexOf(".");r!==-1&&(this._parent=hr.getLogger(this.module.slice(0,r)))}get module(){return this._module}get parent(){return this._parent}error(...e){this._log("error","always",...e)}warn(...e){this._log("warn","always",...e)}info(...e){this._log("info","always",...e)}errorOnce(...e){this._log("error","once",...e)}warnOnce(...e){this._log("warn","once",...e)}infoOnce(...e){this._log("info","once",...e)}errorOncePerTick(...e){this._log("error","oncePerTick",...e)}warnOncePerTick(...e){this._log("warn","oncePerTick",...e)}infoOncePerTick(...e){this._log("info","oncePerTick",...e)}get test(){}static get test(){}static getLogger(e){return e=typeof e!="string"?e.declaredClass:e,hr._loggers.get(e)||new hr({module:e})}_log(e,r,...i){if(this._matchLevel(e)){if(r!=="always"&&!hr._throttlingDisabled){const s=VY(i),n=this._loggedMessages[e].get(s);if(r==="once"&&n!=null||r==="oncePerTick"&&n&&n>=hr._tickCounter)return;this._loggedMessages[e].set(s,hr._tickCounter),hr._scheduleTickCounterIncrement()}for(const s of Ge.log.interceptors)if(s(e,this.module,...i))return;this._inheritedWriter()(e,this.module,...i)}}_parentWithMember(e,r){let i=this;for(;i!=null;){const s=i[e];if(s!=null)return s;i=i.parent}return r}_inheritedWriter(){return this._parentWithMember("writer",zY)}_matchLevel(e){const r=Ge.log.level||"warn";return nR[this._parentWithMember("level",r)]<=nR[e]}static _scheduleTickCounterIncrement(){hr._tickCounterScheduled||(hr._tickCounterScheduled=!0,Promise.resolve().then((()=>{hr._tickCounter++,hr._tickCounterScheduled=!1})))}},hr._loggers=new Map,hr._tickCounter=0,hr._tickCounterScheduled=!1,hr._throttlingDisabled=!1,hr);function zY(t,e,...r){console[t](`[${e}]`,...r)}function VY(...t){return pz(JSON.stringify(t,(r,i)=>typeof i!="object"||Array.isArray(i)?i:"[Object]"))}function jY(t,e){return t.replaceAll(/\$\{([^\s:}]*)(?::([^\s:}]+))?\}/g,((r,i)=>i===""?"$":(fv(i,e)??"").toString()))}let fz=class{constructor(e,r,i=void 0){this.name=e,this.details=i,this.message=(r&&jY(r,i))??""}toString(){return"["+this.name+"]: "+this.message}},F=class mz extends fz{constructor(e,r,i){super(e,r,i)}toJSON(){if(this.details!=null)try{return{name:this.name,message:this.message,details:JSON.parse(JSON.stringify(this.details,((e,r)=>{if(r&&typeof r=="object"&&typeof r.toJSON=="function")return r;try{return k(r)}catch{return"[object]"}})))}}catch(e){throw q.getLogger("esri.core.Error").error(e),e}return{name:this.name,message:this.message,details:this.details}}static fromJSON(e){return new mz(e.name,e.message,e.details)}};F.prototype.type="error";function T0(t){return t&&typeof t=="object"&&"toJSON"in t&&typeof t.toJSON=="function"}const UY=/^https:\/\/([a-z\d-]+)(\.maps([^.]*))?\.arcgis\.com/i,GY={devext:{customBaseUrl:"mapsdevext.arcgis.com",portalHostname:"devext.arcgis.com"},qaext:{customBaseUrl:"mapsqa.arcgis.com",portalHostname:"qaext.arcgis.com"},www:{customBaseUrl:"maps.arcgis.com",portalHostname:"www.arcgis.com"}};function oR(t){const e=t?.match(UY);if(!e)return null;const[,r,i,s]=e;if(!r)return null;let n=null,o=null,a=null;const{devext:l,qaext:u,www:h}=GY;if(i)if(n=r,s)switch(s.toLowerCase()){case"devext":({customBaseUrl:o,portalHostname:a}=l);break;case"qa":({customBaseUrl:o,portalHostname:a}=u);break;default:return null}else({customBaseUrl:o,portalHostname:a}=h);else switch(r.toLowerCase()){case"devext":({customBaseUrl:o,portalHostname:a}=l);break;case"qaext":({customBaseUrl:o,portalHostname:a}=u);break;case"www":({customBaseUrl:o,portalHostname:a}=h);break;default:return null}return{customBaseUrl:o,isPortal:!1,portalHostname:a,urlKey:n}}function yz(t){return/\/(sharing|usrsvcs)\/(appservices|servers)\//i.test(t)}function gz(t){const e=/^https?:\/\/(?:cdn|[a-z\d-]+\.maps)\.arcgis\.com/i,r=/^https?:\/\/(?:cdndev|[a-z\d-]+\.mapsdevext)\.arcgis\.com/i,i=/^https?:\/\/(?:cdnqa|[a-z\d-]+\.mapsqa)\.arcgis\.com/i;return e.test(t)?t=t.replace(e,"https://www.arcgis.com"):r.test(t)?t=t.replace(r,"https://devext.arcgis.com"):i.test(t)&&(t=t.replace(i,"https://qaext.arcgis.com")),t}function vz(t){const e=atob(t),r=new Uint8Array(e.length);for(let i=0;i<e.length;i++)r[i]=e.charCodeAt(i);return r.buffer}function BY(t){const e=new Uint8Array(t);let r="";for(let i=0;i<e.length;i++)r+=String.fromCharCode(e[i]);return btoa(r)}const qY=()=>q.getLogger("esri.core.urlUtils"),Im=Ge.request,aR="esri/config: esriConfig.request.proxyUrl is not set.",_z=/^\s*[a-z][a-z0-9-+.]*:(?![0-9])/i,bz=/^\s*http:/i,HY=/^\s*https:/i,WY=/^\s*file:/i,wz=/:\d+$/,ZY=/^https?:\/\/[^/]+\.arcgis.com\/sharing(\/|$)/i,JY=new RegExp("^(([^:/?#]+):)?(//([^/?#]*))?([^?#]*)(\\?([^#]*))?(#(.*))?$"),YY=new RegExp("^((([^[:]+):)?([^@]+)@)?(\\[([^\\]]+)\\]|([^[:]*))(:([0-9]+))?$");let df=class{constructor(e=""){this.uri=e,this.scheme=null,this.authority=null,this.path=null,this.query=null,this.fragment=null,this.user=null,this.password=null,this.host=null,this.port=null;let r=this.uri.match(JY);this.scheme=r[2]||(r[1]?"":null),this.authority=r[4]||(r[3]?"":null),this.path=r[5],this.query=r[7]||(r[6]?"":null),this.fragment=r[9]||(r[8]?"":null),this.authority!=null&&(r=this.authority.match(YY),this.user=r[3]||null,this.password=r[4]||null,this.host=r[6]||r[7],this.port=r[9]||null)}toString(){return this.uri}};const e_={},XY=new df(Ge.applicationUrl);let _i=XY;const KY=QY();let jP=KY;const UP=()=>_i,$Le=()=>jP;function QY(){const t=_i.path,e=t.slice(0,t.lastIndexOf("/")+1);return`${`${_i.scheme}://${_i.host}${_i.port!=null?`:${_i.port}`:""}`}${e}`}function Pr(t){if(!t)return null;const e={path:null,query:null},r=new df(t),i=t.indexOf("?");return r.query===null?e.path=t:(e.path=t.slice(0,i),e.query=GP(r.query)),r.fragment&&(e.hash=r.fragment,r.query===null&&(e.path=e.path.slice(0,e.path.length-(r.fragment.length+1)))),e}function GP(t){const e=t.split("&"),r={};for(const i of e){if(!i)continue;const s=i.indexOf("=");let n,o;s<0?(n=decodeURIComponent(i),o=""):(n=decodeURIComponent(i.slice(0,s)),o=decodeURIComponent(i.slice(s+1)));let a=r[n];typeof a=="string"&&(a=r[n]=[a]),Array.isArray(a)?a.push(o):r[n]=o}return r}function E0(t,e){return t?Object.keys(t).map((r=>{const i=t[r];if(i==null)return"";const s=encodeURIComponent(r)+"=",n=e?.[r];return n?s+encodeURIComponent(n(i)):Array.isArray(i)?i.map((o=>T0(o)?s+encodeURIComponent(JSON.stringify(o)):s+encodeURIComponent(o))).join("&"):T0(i)?s+encodeURIComponent(JSON.stringify(i)):s+encodeURIComponent(i)})).filter((r=>r)).join("&"):""}function Sz(t=!1){let e,r=Im.proxyUrl;if(typeof t=="string"){e=oX(t);const i=VS(t);i&&(r=i.proxyUrl)}else e=!!t;if(!r)throw qY().warn(aR),new F("urlUtils:proxy-not-set",aR);return e&&fM()&&(r=ZP(r)),Pr(r)}function MLe(t,e=!1){const r=VS(t);let i,s;if(r){const n=BP(r.proxyUrl);i=n.path,s=n.query?GP(n.query):null}else if(e){const n=Sz(t);i=n.path,s=n.query}if(i){const n=Pr(t);t=i+"?"+n.path;const o=E0({...s,...n.query});o&&(t=`${t}?${o}`)}return t}const ty={path:"",query:""};function BP(t){const e=t.indexOf("?");return e!==-1?(ty.path=t.slice(0,e),ty.query=t.slice(e+1)):(ty.path=t,ty.query=null),ty}function xz(t){return t=(t=Bb(t=hX(t=BP(t).path),!0)).toLowerCase()}function eX(t){const e={proxyUrl:t.proxyUrl,urlPrefix:xz(t.urlPrefix)},r=Im.proxyRules,i=e.urlPrefix;let s=r.length;for(let n=0;n<r.length;n++){const o=r[n].urlPrefix;if(i.indexOf(o)===0){if(i.length===o.length)return-1;s=n;break}o.indexOf(i)===0&&(s=n+1)}return r.splice(s,0,e),s}function VS(t){const e=Im.proxyRules,r=xz(t);for(let i=0;i<e.length;i++)if(r.indexOf(e[i].urlPrefix)===0)return e[i]}function tX(t,e){if(!t||!e)return!1;t=Gb(t),e=Gb(e);const r=oR(t),i=oR(e);return r!=null&&i!=null?r.portalHostname===i.portalHostname:r==null&&i==null&&va(t,e,!0)}function $z(t,e){return t=Gb(t),e=Gb(e),Bb(t)===Bb(e)}function Gb(t){const e=(t=fn(t)).indexOf("/sharing");return e>0?t.slice(0,e):t.replace(/\/+$/,"")}function pM(t,e=Im.interceptors){const r=i=>i instanceof RegExp?i.test(t):typeof i=="string"?t.startsWith(i):i==null;if(e){for(const i of e)if(Array.isArray(i.urls)){if(i.urls.some(r))return i}else if(r(i.urls))return i}return null}function va(t,e,r=!1){if(!t||!e)return!1;const i=yM(t),s=yM(e);return!(!r&&i.scheme!==s.scheme)&&i.host!=null&&s.host!=null&&i.host.toLowerCase()===s.host.toLowerCase()&&i.port===s.port}function qP(t){if(typeof t=="string"){if(!cs(t))return!0;t=yM(t)}if(va(t,_i))return!0;const e=Im.trustedServers||[];for(let r=0;r<e.length;r++){const i=rX(e[r]);for(let s=0;s<i.length;s++)if(va(t,i[s]))return!0}return!1}function rX(t){return e_[t]||(WP(t)||Sa(t)?e_[t]=[new df(on(t))]:e_[t]=[new df(`http://${t}`),new df(`https://${t}`)]),e_[t]}function on(t,e=jP,r){return Sa(t)?r?.preserveProtocolRelative?t:_i.scheme==="http"&&_i.authority===ks(t).slice(2)?`http:${t}`:`https:${t}`:WP(t)?t:ud(t[0]==="/"?cX(e):e,t)}function HP(t,e=jP,r){if(t==null||!cs(t))return t;const i=fn(t),s=i.toLowerCase(),n=fn(e).toLowerCase().replace(/\/+$/,""),o=r?fn(r).toLowerCase().replace(/\/+$/,""):null;if(o&&n.indexOf(o)!==0)return t;const a=(p,m,y)=>(y=p.indexOf(m,y))===-1?p.length:y;let l=a(s,"/",s.indexOf("//")+2),u=-1;for(;s.slice(0,l+1)===n.slice(0,l)+"/"&&(u=l+1,l!==s.length);)l=a(s,"/",l+1);if(u===-1||o&&u<o.length)return t;t=i.slice(u);const h=n.slice(u-1).replaceAll(/[^/]+/g,"").length;if(h>0)for(let p=0;p<h;p++)t=`../${t}`;else t=`./${t}`;return t}function fn(t){return t=fX(t=pX(t=dX(t=on(t=t.trim()))))}function ud(...t){const e=t.filter(ii);if(!e?.length)return;const r=[];if(cs(e[0])){const s=e[0],n=s.indexOf("//");n!==-1&&(r.push(s.slice(0,n+1)),lX(e[0])&&(r[0]+="/"),e[0]=s.slice(n+2))}else e[0][0]==="/"&&r.push("");const i=e.reduce(((s,n)=>n?s.concat(n.split("/")):s),[]);for(let s=0;s<i.length;s++){const n=i[s];n===".."&&r.length>0&&r[r.length-1]!==".."?r.pop():(!n&&s===i.length-1||n&&(n!=="."||r.length===0))&&r.push(n)}return r.join("/")}function ks(t,e=!1){if(t==null||Cm(t)||xd(t))return null;let r=t.indexOf("://");if(r===-1&&Sa(t))r=2;else{if(r===-1)return null;r+=3}const i=t.indexOf("/",r);return i!==-1&&(t=t.slice(0,i)),e&&(t=Bb(t,!0)),t}function cs(t){return Sa(t)||WP(t)}function Cm(t){return t!=null&&t.slice(0,5)==="blob:"}function xd(t){return t!=null&&t.slice(0,5)==="data:"}function iX(t){const e=rm(t);return e?.isBase64?vz(e.data):null}function TLe(t){return BY(t).replaceAll("+","-").replaceAll("/","_").replace(/=+$/,"")}const sX=/^data:(.*?)(;base64)?,(.*)$/;function rm(t){const e=t.match(sX);if(!e)return null;const[,r,i,s]=e;return{mediaType:r,isBase64:!!i,data:s}}function Mz(t){return t.isBase64?`data:${t.mediaType};base64,${t.data}`:`data:${t.mediaType},${t.data}`}async function nX(t){return(await fetch(t)).blob()}function ELe(t){const e=iX(t);if(!e)return null;const r=rm(t);return new Blob([e],{type:r.mediaType})}function Sa(t){return t!=null&&t[0]==="/"&&t[1]==="/"}function WP(t){return t!=null&&_z.test(t)}function oX(t){return t!=null&&HY.test(t)||_i.scheme==="https"&&Sa(t)}function aX(t){return t!=null&&bz.test(t)||_i.scheme==="http"&&Sa(t)}function lX(t){return t!=null&&WY.test(t)}function ZP(t){return Sa(t)?`https:${t}`:t.replace(bz,"https:")}function uX(){return _i.scheme==="http"}function fM(){return _i.scheme==="https"}function Bb(t,e=!1){return Sa(t)?t.slice(2):(t=t.replace(_z,""),e&&t.length>1&&t[0]==="/"&&t[1]==="/"&&(t=t.slice(2)),t)}function cX(t){const e=t.indexOf("//"),r=t.indexOf("/",e+2);return r===-1?t:t.slice(0,r)}function JP(t){let e=0;if(cs(t)){const i=t.indexOf("//");i!==-1&&(e=i+2)}const r=t.lastIndexOf("/");return r<e?t:t.slice(0,r+1)}function ILe(t,e){if(!t)return"";const r=Pr(t).path.replace(/\/+$/,""),i=r.slice(r.lastIndexOf("/")+1);if(!e?.length)return i;const s=new RegExp(`\\.(${e.join("|")})$`,"i");return i.replace(s,"")}function hX(t){return t.endsWith("/")?t:`${t}/`}function Tz(t){return t.replace(/\/+$/,"")}function dX(t){if(/^https?:\/\//i.test(t)){const e=BP(t);t=(t=e.path.replaceAll(/\/{2,}/g,"/")).replace("/","//"),e.query&&(t+=`?${e.query}`)}return t}function pX(t){return t.replace(/^(https?:\/\/)(arcgis\.com)/i,"$1www.$2")}function fX(t){const e=Im.httpsDomains;if(!aX(t))return t;const r=t.indexOf("/",7);let i;if(i=r===-1?t:t.slice(0,r),i=i.toLowerCase().slice(7),wz.test(i)){if(!i.endsWith(":80"))return t;i=i.slice(0,-3),t=t.replace(":80","")}return uX()&&i===_i.authority&&!ZY.test(t)||(fM()&&i===_i.authority||e&&e.some((s=>i===s||i.endsWith(`.${s}`)))||fM()&&!VS(t))&&(t=ZP(t)),t}function mM(t,e,r){if(!(e&&r&&t&&cs(t)))return t;const i=t.indexOf("//"),s=t.indexOf("/",i+2),n=t.indexOf(":",i+2),o=Math.min(s<0?t.length:s,n<0?t.length:n);return t.slice(i+2,o).toLowerCase()!==e.toLowerCase()?t:`${t.slice(0,i+2)}${r}${t.slice(o)}`}function Ez(t,e){const r=new URL(t);return r.host=e,r.port&&!wz.test(e)&&(r.port=""),r.toString()}function mX(t){return new URL(t).host}function yM(t){return typeof t=="string"?new df(on(t)):(t.scheme||(t.scheme=_i.scheme),t)}function CLe(t){return gX.test(t)}function Iz(t,e){const r=Pr(t),i=Object.keys(r.query||{});return i.length>0&&e&&e.warn("removeQueryParameters()",`Url query parameters are not supported, the following parameters have been removed: ${i.join(", ")}.`),r.path}function yX(t,e,r){const i=Pr(t),s=i.query||{};return s[e]=String(r),`${i.path}?${E0(s)}`}function y1(t,e){if(!e)return t;const r=Pr(t),i=r.query||{};for(const[n,o]of Object.entries(e))o!=null&&(i[n]=o);const s=E0(i);return s?`${r.path}?${s}`:r.path}function Cz(t){if(t==null)return null;const e=t.match(Pz);return e?e[2]:null}function lR(t){if(t==null)return null;const e=t.match(Pz);return e?{path:e[1],extension:e[2]}:{path:t,extension:null}}async function PLe(t){return typeof t=="string"?rm(t)??{data:t}:new Promise(((e,r)=>{const i=new FileReader;i.readAsDataURL(t),i.onload=()=>e(rm(i.result)),i.onerror=s=>r(s)}))}const Pz=/([^.]*)\.([^/]*)$/,gX=/(^data:image\/svg|\.svg$)/i,Az="20250903",Lz="39b1ef512004eb2837696c72250a1294d18a21b1";Symbol.dispose??=Symbol("Symbol.dispose"),Symbol.asyncDispose??=Symbol("Symbol.asyncDispose");const vX="4.33";let Ve,YP=vX;YP="4.33.13";function ALe(t){Ve=t}function _X(t){const e=Ve?.findCredential(t);return e?.token?yX(t,"token",e.token):t}z("host-webworker")||globalThis.$arcgis||Object.defineProperty(globalThis,"$arcgis",{configurable:!1,enumerable:!0,writable:!1,value:{}}),z("host-webworker");function bX(t,e){for(const r of t.values())if(e(r))return!0;return!1}function LLe(t,e){for(const r of t.values())if(e(r))return r;return null}function Pm(t,e,r){const i=t.get(e);if(i!==void 0)return i;const s=r();return t.set(e,s),s}function RLe(t){const e=new Map;return r=>(e.has(r)||e.set(r,t(r)),e.get(r))}const wX={remove:()=>{}};function He(t){return t?{remove(){t&&(t(),t=void 0)}}:wX}function Rz(t){t.forEach((e=>e?.remove()))}function kLe(t){Rz(t),t.length=0}function $d(t){return He((()=>Rz(t)))}function OLe(t){return He((()=>t()?.remove()))}function NLe(t){return He((()=>t?.abort()))}function FLe(t){return He(t!=null?()=>t.destroy():void 0)}function SX(t){return typeof t=="object"&&!!t&&"remove"in t&&typeof t.remove=="function"}function DLe(t){SX(t)&&t.remove()}function zLe(t){return{[Symbol.dispose](){t.remove()}}}function xX(t){return{setTimeout:(e,r)=>{const i=t.setTimeout(e,r);return He((()=>t.clearTimeout(i)))}}}const Am=xX(globalThis);function jS(t){return $X(t)||kz(t)}function $X(t){return t!=null&&typeof t=="object"&&"on"in t&&typeof t.on=="function"}function kz(t){return t!=null&&typeof t=="object"&&"addEventListener"in t&&typeof t.addEventListener=="function"}function Lm(t,e,r){if(!jS(t))throw new TypeError("target is not a Evented or EventTarget object");return kz(t)?MX(t,e,r):t.on(e,r)}function MX(t,e,r,i){if(Array.isArray(e)){const s=e.slice();for(const n of s)t.addEventListener(n,r,i);return He((()=>{for(const n of s)t.removeEventListener(n,r,i)}))}return t.addEventListener(e,r,i),He((()=>t.removeEventListener(e,r,i)))}function Oz(t,e,r){if(!jS(t))throw new TypeError("target is not a Evented or EventTarget object");if("once"in t)return t.once(e,r);const i=Lm(t,e,(s=>{i.remove(),r.call(t,s)}));return i}function mv(t,e){if(t==null)throw new Error(e??"value is None")}function At(t){return t?.destroy(),null}function VLe(t){return t?.dispose(),null}function Lt(t){return t?.remove(),null}function im(t){return t?.abort(),null}function jLe(t){return t?.release(),null}function TX(t,e,r){return t!=null&&e!=null?r!=null?r(t,e):t.equals(e):t===e}function Nz(t,e){let r;return t.some(((i,s)=>(r=e(i,s),r!=null))),r??void 0}function St(t="Aborted"){return new F("AbortError",t)}function xt(t,e="Aborted"){if(yn(t))throw St(e)}function yv(t){return t instanceof AbortSignal?t:t?.signal??void 0}function yn(t){const e=yv(t);return e!=null&&e.aborted}function Do(t){if(xi(t))throw t}function uR(t){if(!xi(t))throw t}function ao(t,e){const r=yv(t);if(r!=null){if(!r.aborted)return Oz(r,"abort",(()=>e()));e()}}function XP(t,e){const r=yv(t);if(r!=null)return xt(r),Oz(r,"abort",(()=>e(St())))}function Fz(t,e){return yv(e)==null?t:new Promise(((r,i)=>{let s=ao(e,(()=>i(St())));const n=()=>{s=Lt(s)};t.then(n,n),t.then(r,i)}))}function xi(t){return t?.name==="AbortError"}async function gM(t){try{return await t}catch(e){if(!xi(e))throw e;return}}async function KP(t){if(!t)return;if(typeof t.forEach!="function"){const r=Object.keys(t),i=r.map((o=>t[o])),s=await KP(i),n={};return r.map(((o,a)=>n[o]=s[a])),n}const e=t;return Promise.allSettled(e).then((r=>Array.from(e,((i,s)=>{const n=r[s];return n.status==="fulfilled"?{promise:i,value:n.value}:{promise:i,error:n.reason}}))))}async function EX(t){return(await Promise.allSettled(t)).filter((e=>e.status==="fulfilled")).map((e=>e.value))}async function ULe(t){return(await Promise.allSettled(t)).filter((e=>e.status==="rejected")).map((e=>e.reason))}function Dz(t,e=void 0,r){const i=new AbortController;return ao(r,(()=>i.abort())),new Promise(((s,n)=>{let o=setTimeout((()=>{o=0,s(e)}),t);ao(i,(()=>{o&&(clearTimeout(o),n(St()))}))}))}function GLe(t,e,r,i){const s=r&&"abort"in r?r:null;i!=null||s||(i=r);let n=setTimeout((()=>{n=0,s?.abort()}),e);const o=()=>i||new F("promiseUtils:timeout","The wrapped promise did not resolve within "+e+" ms");return t.then((a=>{if(n===0)throw o();return clearTimeout(n),a}),(a=>{throw clearTimeout(n),n===0?o():a}))}function IX(t,e){const r=new AbortController,i=setTimeout((()=>r.abort()),e);return ao(t,(()=>{r.abort(),clearTimeout(i)})),{...t,signal:r.signal}}function Ia(t){return t&&typeof t.then=="function"}function vM(t){return Ia(t)?t:Promise.resolve(t)}function US(t,e=-1){let r,i,s,n,o=null;const a=(...l)=>{if(r){i=l,n&&n.reject(St()),n=Ns();const m=n.promise;if(o){const y=o;o=null,y.abort()}return m}if(s=n||Ns(),n=null,e>0){const m=new AbortController;r=vM(t(...l,m.signal));const y=r;Dz(e).then((()=>{r===y&&(n?m.abort():o=m)}))}else r=1,r=vM(t(...l));const u=()=>{const m=i;i=s=r=o=null,m!=null&&a(...m)},h=r,p=s;return h.then(u,u),h.then(p.resolve,p.reject),p.promise};return a}function Ns(){let t,e;const r=new Promise(((s,n)=>{t=s,e=n})),i=s=>{t(s)};return i.resolve=s=>t(s),i.reject=s=>e(s),i.timeout=(s,n)=>Am.setTimeout((()=>i.reject(n)),s),i.promise=r,i}function BLe(t,e){e.then(t.resolve,t.reject)}async function cR(t){await Promise.resolve(),xt(t)}function Fl(t,e){const r=e?.url?.path;if(t&&r&&(t=on(t,r,{preserveProtocolRelative:!0}),e.portalItem&&e.readResourcePaths)){const i=HP(t,e.portalItem.itemUrl);i!=null&&CX.test(i)&&e.readResourcePaths.push(e.portalItem.resourceFromPath(i).path)}return(t=_M(t,e?.portal))&&BS.test(t)?QP(t):t}function cd(t,e,r=sm.YES){if((t=t&&BS.test(t)?Uz(t):t)==null)return t;!cs(t)&&e?.blockedRelativeUrls&&e.blockedRelativeUrls.push(t);let i=on(t);if(e){const s=e.verifyItemRelativeUrls?.rootPath||e.url?.path;if(s){const n=_M(s,e.portal),o=_M(i,e.portal);i=HP(o,n,n),i!=null&&i!==o&&i!==t&&e.verifyItemRelativeUrls&&e.verifyItemRelativeUrls.writtenUrls.push(i)}}return i=jz(i,e?.portal),cs(i)&&(i=fn(i)),e?.resources&&e?.portalItem&&!cs(i)&&!xd(i)&&r===sm.YES&&e.resources.toKeep.push({resource:e.portalItem.resourceFromPath(i),compress:!1}),i}function GS(t,e,r){return Fl(t,r)}function hd(t,e,r,i){const s=cd(t,i);s!==void 0&&(e[r]=s)}const BS=/\/items\/([^/]+)\/resources\/(.*)/,CX=/^\.\/resources\//;function zz(t){return(t?.match(BS)??null)?.[1]??null}function Vz(t){const e=t?.match(BS)??null;if(e==null)return null;const r=e[2],i=r.lastIndexOf("/");if(i===-1){const{path:o,extension:a}=lR(r);return{prefix:null,filename:o,extension:a}}const{path:s,extension:n}=lR(r.slice(i+1));return{prefix:r.slice(0,i),filename:s,extension:n}}function jz(t,e){return e&&!e.isPortal&&e.urlKey&&e.customBaseUrl?mM(t,`${e.urlKey}.${e.customBaseUrl}`,e.portalHostname):t}function _M(t,e){if(!e||e.isPortal||!e.urlKey||!e.customBaseUrl)return t;const r=`${e.urlKey}.${e.customBaseUrl}`,i=UP();return va(i,`${i.scheme}://${r}`)?mM(t,e.portalHostname,r):mM(t,r,e.portalHostname)}function QP(t){if(!t)return t||null;let e=t;return e&&Ve&&!Ve.findCredential(e)&&(e=gz(e),e=e.replace(/^https?:\/\/www\.arcgis\.com/,"https://cdn.arcgis.com"),e=e.replace(/^https?:\/\/devext\.arcgis\.com/,"https://cdndev.arcgis.com"),e=e.replace(/^https?:\/\/qaext\.arcgis\.com/,"https://cdnqa.arcgis.com")),e}function Uz(t){if(!t)return t||null;let e=t;return e=e.replace(/^https?:\/\/cdn\.arcgis\.com/,"https://www.arcgis.com"),e=e.replace(/^https?:\/\/cdndev\.arcgis\.com/,"https://devext.arcgis.com"),e=e.replace(/^https?:\/\/cdnqa\.arcgis\.com/,"https://qaext.arcgis.com"),e&&Ve&&!Ve.findCredential(e)&&(e=gz(e)),e}var sm;(function(t){t[t.YES=0]="YES",t[t.NO=1]="NO"})(sm||(sm={}));const PX=Object.freeze(Object.defineProperty({__proto__:null,get MarkKeep(){return sm},ensureMainOnlineDomain:jz,fromCDNUrl:Uz,fromJSON:Fl,itemIdFromResourceUrl:zz,prefixAndFilenameFromResourceUrl:Vz,read:GS,toCDNUrl:QP,toJSON:cd,write:hd},Symbol.toStringTag,{value:"Module"})),Gz={mapserver:"MapServer",imageserver:"ImageServer",featureserver:"FeatureServer",knowledgegraphserver:"KnowledgeGraphServer",sceneserver:"SceneServer",streamserver:"StreamServer",vectortileserver:"VectorTileServer","3dtilesserver":"3DTilesServer",videoserver:"VideoServer"},Bz=Object.values(Gz),qz=new RegExp(`^((?:https?:)?\\/\\/\\S+?\\/rest\\/services\\/(.+?)\\/(${Bz.join("|")}))(?:\\/(?:layers\\/)?(\\d+))?`,"i"),AX=new RegExp(`^((?:https?:)?\\/\\/\\S+?\\/([^/\\n]+)\\/(${Bz.join("|")}))(?:\\/(?:layers\\/)?(\\d+))?`,"i"),LX=/(.*?)\/(?:layers\/)?(\d+)\/?$/i;function qLe(t){return qz.test(t)}function vc(t){if(t==null)return null;const e=Pr(t),r=e?.path.match(qz)||e?.path.match(AX);if(!r)return null;const[,i,s,n,o]=r,a=s.indexOf("/");return{title:e3(a!==-1?s.slice(a+1):s),serverType:Gz[n.toLowerCase()],sublayer:o!=null&&o!==""?parseInt(o,10):null,url:{path:i}}}function RX(t){const e=Pr(t).path.match(LX);return e?{serviceUrl:e[1],sublayerId:Number(e[2])}:null}function e3(t){return(t=t.replaceAll(/\s*[/_]+\s*/g," "))[0].toUpperCase()+t.slice(1)}function kX(t,e){const r=[];if(t){const i=vc(t);i!=null&&i.title&&r.push(i.title)}if(e){const i=e3(e);r.push(i)}if(r.length===2){if(r[0].toLowerCase().includes(r[1].toLowerCase()))return r[0];if(r[1].toLowerCase().includes(r[0].toLowerCase()))return r[1]}return r.join(" - ")}function qb(t){let e=ks(t,!0);return!!e&&(e=e.toLowerCase(),e.endsWith(".arcgis.com")&&(e.startsWith("services")||e.startsWith("tiles")||e.startsWith("features")||/^[a-z\d-]+\.svcs[a-z\d-]*\./.test(e)))}function OX(t,e){return t&&Tz(Iz(t,e))}function NX(t){let{url:e}=t;if(!e)return{url:e};e=Iz(e,t.logger);const r=Pr(e),i=vc(r.path);let s;if(i!=null)i.sublayer!=null&&t.layer.layerId==null&&(s=i.sublayer),e=i.url.path;else if(t.nonStandardUrlAllowed){const n=RX(r.path);n!=null&&(e=n.serviceUrl,s=n.sublayerId)}return{url:Tz(e),layerId:s}}function FX(t,e,r,i,s){hd(e,i,"url",s),i.url&&t.layerId!=null&&(i.url=ud(i.url,r,t.layerId.toString()))}function HLe(t){if(!t)return!1;const e=t.toLowerCase(),r=e.includes("/services/"),i=e.includes("/mapserver/wmsserver"),s=e.includes("/imageserver/wmsserver"),n=e.includes("/wmsserver");return r&&(i||s||n)}const DX=new Set(["elevation3d.arcgis.com","js.arcgis.com","jsdev.arcgis.com","jsqa.arcgis.com","static.arcgis.com"]);function t3(t){if(!r3(t))return null;const e=i=>i instanceof RegExp?i.test(t):typeof i=="string"&&t.startsWith(i),r=Ge.apiKeys;if(Array.isArray(r.scopes)){for(const i of r.scopes)if(Array.isArray(i.urls)){if(i.urls.some(e))return i.token}else if(e(i.urls))return i.token}return r.basemapStyles&&/^https?:\/\/(i?basemaps|basemapstyles)-api\.arcgis\.com\//i.test(t)?r.basemapStyles:Ge.apiKey&&/^https?:\/\/.+\.arcgis\.com(\/|$)/i.test(t)?Ge.apiKey:null}function bM(){return Ge.apiKey!=null||Ge.apiKeys.basemapStyles!=null}function zX(t,e){return e?r3(t):t3(t)!=null}function r3(t){const e=ks(t,!0);return!!e&&!DX.has(e)&&!t.endsWith("/sharing/rest/generateToken")}function VX(t,e,r=!1,i){return new Promise(((s,n)=>{if(yn(i))return void n(hR());let o=()=>{u(),n(new Error(`Unable to load ${e}`))},a=()=>{const h=t;u(),s(h)},l=()=>{if(!t)return;const h=t;u(),h.src="",n(hR())};const u=()=>{z("esri-image-decode")||(t.removeEventListener("error",o),t.removeEventListener("load",a)),o=null,a=null,t=null,i?.removeEventListener("abort",l),l=null,r&&URL.revokeObjectURL(e)};i?.addEventListener("abort",l),z("esri-image-decode")?t.decode().then(a,o):(t.addEventListener("error",o),t.addEventListener("load",a))}))}function hR(){try{return new DOMException("Aborted","AbortError")}catch{const t=new Error;return t.name="AbortError",t}}const Hz="Timeout exceeded";function jX(){return new Error(Hz)}function WLe(t){return typeof t=="object"&&!!t&&"message"in t&&t.message===Hz}function UX(t){Ge.request.crossOriginNoCorsDomains||(Ge.request.crossOriginNoCorsDomains={});const e=Ge.request.crossOriginNoCorsDomains;for(let r of t)r=r.toLowerCase(),/^https?:\/\//.test(r)?e[ks(r)??""]=0:(e[ks("http://"+r)??""]=0,e[ks("https://"+r)??""]=0)}function GX(t){const e=Ge.request.crossOriginNoCorsDomains;if(e){let r=ks(t);if(r)return r=r.toLowerCase(),!va(r,UP())&&e[r]<Date.now()-36e5}return!1}async function BX(t){const e=Pr(t);t=e.path,e.query?.f==="json"&&(t+="?f=json");try{await fetch(t,{mode:"no-cors",credentials:"include"})}catch{}const r=Ge.request.crossOriginNoCorsDomains,i=ks(t);r&&i&&(r[i.toLowerCase()]=Date.now())}const wM=new Map;function qX(t,e){const r=e?.preferredHost;if(!r||va(t,`https://${r}`,!0))return;const i=vc(t);if(!i||i.serverType!=="FeatureServer"||yz(t))return;const s=i.url.path.toLowerCase();wM.has(s)||wM.set(s,r)}function dR(t){const e=vc(t)?.url.path.toLowerCase();if(!e)return t;const r=wM.get(e);return r?Ez(t,r):t}async function et(t,e){t instanceof URL&&(t=t.toString()),e?.query instanceof URLSearchParams&&(e.query=GP(e.query.toString().replaceAll("+"," ")));const r=xd(t),i=Cm(t);i||r||(t=fn(t));const s={url:t,requestOptions:{...e}},n=y=>({data:y,getAllHeaders:nm,getHeader:nm,httpStatus:200,requestOptions:s.requestOptions,url:s.url}),o=pM(t,en.internalInterceptors);if(o){const y=await fR(o,s);if(y!=null)return n(y)}let a=pM(t);if(a){const y=await fR(a,s);if(y!=null)return n(y);a.after||a.error||(a=null)}if(t=s.url,(e=s.requestOptions).responseType==="image"&&(z("host-webworker")||z("host-node")))throw io("request:invalid-parameters",new Error("responseType 'image' is not supported in Web Workers or Node environment"),s);if(e.method==="head"){if(e.body)throw io("request:invalid-parameters",new Error("body parameter cannot be set when method is 'head'"),s);if(r||i)throw io("request:invalid-parameters",new Error("data and blob URLs are not supported for method 'head'"),s)}if(await YX(),Hb)return Hb.execute(t,e);const l=new AbortController,u=ao(e,(()=>l.abort())),h={controller:l,credential:void 0,credentialToken:void 0,fetchOptions:void 0,hasToken:!1,interceptor:a,params:s,redoRequest:!1,useIdentity:en.useIdentity,useProxy:!1,useSSL:!1,withCredentials:!1},p=e.useRequestQueue?tK(h):xM(h),m=await p.finally((()=>u?.remove()));return a?.after?.(m),m}let Hb,Wz=!1;const en=Ge.request,Zz="FormData"in globalThis,HX=new Set([499,498,403,401]),WX=new Set(["COM_0056","COM_0057","SB_0008"]),ZX=[/\/arcgis\/tokens/i,/\/sharing(\/rest)?\/generatetoken/i,/\/rest\/info/i],nm=()=>null,Wb=Symbol();function JX(t){const e=ks(t);e&&!et._corsServers.includes(e)&&et._corsServers.push(e)}function pR(t){const e=ks(t);return!e||e.endsWith(".arcgis.com")||et._corsServers.includes(e)||qP(e)}function io(t,e,r,i){let s;const n={url:r.url,requestOptions:r.requestOptions,getAllHeaders:nm,getHeader:nm,ssl:!1};if(e instanceof F)return e.details?(e.details=k(e.details),e.details.url=r.url,e.details.requestOptions=r.requestOptions):e.details=n,e;if(e){const o=i&&(()=>Array.from(i.headers)),a=i&&(h=>i.headers.get(h)),l=i?.status,u=e.message;u&&(s=u),o&&a&&(n.getAllHeaders=o,n.getHeader=a),n.httpStatus=(e.httpCode!=null?e.httpCode:e.code)||l||0,n.subCode=e.subcode,n.messageCode=e.messageCode,typeof e.details=="string"?(n.messages=[e.details],s??=e.details):(n.messages=e.details,s??=n.messages?.[0]),n.raw=Wb in e?e[Wb]:e}return s??="Error",xi(e)?St():new F(t,s,n)}async function YX(){z("host-webworker")&&(!Hb&&globalThis.invokeStaticMessage?Hb=await J(()=>import("./request-DQdSJYUt.js"),[]):Wz=!0)}async function SM(){Ve||await J(()=>import("./IdentityManager-DTnbKN5B.js"),[])}async function XX(t){const e=t.params.url,r=t.params.requestOptions,i=t.controller.signal,s=r.body;let n=null,o=null;if(Zz&&"HTMLFormElement"in globalThis&&(s instanceof FormData?n=s:s instanceof HTMLFormElement&&(n=new FormData(s))),typeof s=="string"&&(o=s),t.fetchOptions={cache:r.cacheBust?"no-cache":"default",credentials:"same-origin",headers:r.headers||{},method:r.method==="head"?"HEAD":"GET",mode:"cors",priority:en.priority,redirect:"follow",signal:i},(n||o)&&(t.fetchOptions.body=n||o),(Wz||r.authMode==="anonymous")&&(t.useIdentity=!1),t.hasToken=!!(/token=/i.test(e)||r.query?.token||n?.get("token")),!t.hasToken){const a=t3(e);a&&(r.query??={},r.query.token=a,t.hasToken=!0)}if(t.useIdentity&&!t.hasToken&&!t.credential&&!t.credentialToken&&!Jz(e)&&!yn(i)){let a;r.authMode==="immediate"?(await SM(),a=await Ve.getCredential(e,{signal:i})):r.authMode==="no-prompt"?(await SM(),a=await Ve.getCredential(e,{prompt:!1,signal:i}).catch((()=>{}))):Ve&&(a=Ve.findCredential(e)),a&&(t.credential=a,t.credentialToken=a.token,t.useSSL=!!a.ssl)}}function Jz(t){return ZX.some((e=>e.test(t)))}async function KX(t){let e=t.params.url,r=dR(e);const i=t.params.requestOptions,s=t.fetchOptions??{},n=Cm(e)||xd(e),o=i.responseType||"json",a=n?0:i.timeout!=null?i.timeout:en.timeout;let l=!1;if(!n){t.useSSL&&(e=ZP(e));let y={...i.query};t.credentialToken&&(y.token=t.credentialToken);let g=E0(y);z("esri-url-encodes-apostrophe")&&(g=g.replaceAll("'","%27"));const v=r.length+1+g.length;let _;l=i.method==="delete"||i.method==="post"||i.method==="put"||!!i.body||v>en.maxUrlLength;const b=i.useProxy||!!VS(e);if(b){const S=Sz(e);_=S.path,!l&&_.length+1+v>en.maxUrlLength&&(l=!0),S.query&&(y={...S.query,...y})}if(s.method==="HEAD"&&(l||b)){if(l)throw v>en.maxUrlLength?io("request:invalid-parameters",new Error("URL exceeds maximum length"),t.params):io("request:invalid-parameters",new Error("cannot use POST request when method is 'head'"),t.params);if(b)throw io("request:invalid-parameters",new Error("cannot use proxy when method is 'head'"),t.params)}l?(s.method=i.method==="delete"?"DELETE":i.method==="put"?"PUT":"POST",i.body?e=y1(e,y):(s.body=E0(y),s.headers||(s.headers={}),s.headers["Content-Type"]="application/x-www-form-urlencoded")):e=y1(e,y),b&&(t.useProxy=!0,e=`${_}?${e}`),y.token&&Zz&&s.body instanceof FormData&&!yz(e)&&s.body.set("token",y.token),i.hasOwnProperty("withCredentials")?t.withCredentials=i.withCredentials:va(e,UP())||(qP(e)||Ve&&Ve.findServerInfo(e)?.webTierAuth)&&(t.withCredentials=!0),t.withCredentials&&(s.credentials="include",GX(e)&&await BX(l?y1(e,y):e)),r=dR(e)}let u,h,p=0,m=!1;a>0&&(p=setTimeout((()=>{m=!0,t.controller.abort()}),a));try{if(i.responseType==="native-request-init")h=s,h.url=r,i.signal?h.signal=i.signal:delete h.signal;else if(i.responseType!=="image"||s.cache!=="default"||s.method!=="GET"||l||QX(i.headers)||!n&&!t.useProxy&&en.proxyUrl&&!pR(e)){if(et._beforeFetch&&await et._beforeFetch(e,s),u=await fetch(r,s),et._afterFetch&&await et._afterFetch(u),t.useProxy||JX(e),i.responseType==="native")h=u;else if(s.method!=="HEAD")if(u.ok){switch(o){case"array-buffer":h=await u.arrayBuffer();break;case"blob":case"image":h=await u.blob();break;default:h=await u.text()}if(p&&(clearTimeout(p),p=0),o==="json"||o==="xml"||o==="document")if(h)switch(o){case"json":h=JSON.parse(h);break;case"xml":h=mR(h,"application/xml");break;case"document":h=mR(h,"text/html")}else h=null;if(h){if(o==="array-buffer"||o==="blob"){const y=u.headers.get("Content-Type");if(y&&/application\/json|text\/plain/i.test(y)&&h[o==="blob"?"size":"byteLength"]<=750)try{const g=await new Response(h).json();g.error&&(h=g)}catch{}}o==="image"&&h instanceof Blob&&(h=await yR(URL.createObjectURL(h),t,!0))}}else{h=await u.text();try{h=JSON.parse(h)}catch{}}}else h=await yR(r,t)}catch(y){if(y.name==="AbortError")throw m?jX():St("Request canceled");if(!(!u&&y instanceof TypeError&&en.proxyUrl)||i.body||i.method==="delete"||i.method==="head"||i.method==="post"||i.method==="put"||t.useProxy||pR(e))throw y;t.redoRequest=!0,eX({proxyUrl:en.proxyUrl,urlPrefix:ks(e)??""})}finally{p&&clearTimeout(p)}return[u,h]}async function fR(t,e){if(t.responseData!=null)return t.responseData;if(t.headers&&(e.requestOptions.headers={...e.requestOptions.headers,...t.headers}),t.query&&(e.requestOptions.query={...e.requestOptions.query,...t.query}),t.before){let r,i;try{i=await t.before(e)}catch(s){r=io("request:interceptor",s,e)}if((i instanceof Error||i instanceof F)&&(r=io("request:interceptor",i,e)),r)throw t.error&&t.error(r),r;return i}}function QX(t){if(t){for(const e of Object.getOwnPropertyNames(t))if(t[e])return!0}return!1}function mR(t,e){let r;try{r=new DOMParser().parseFromString(t,e)}catch{}if(!r||r.getElementsByTagName("parsererror").length)throw new SyntaxError("XML Parse error");return r}et._corsServers=["https://server.arcgisonline.com","https://services.arcgisonline.com"],et._beforeFetch=void 0,et._afterFetch=void 0;const eK=new Map;async function tK(t){const e=iK(t.params.url);if(!e)return xM(t);const{QueueProcessor:r}=await J(()=>import("./QueueProcessor-BVvANoyd.js"),[]);return Pm(eK,e.origin,(()=>{const s=e.isHosted?z("request-queue-concurrency-hosted"):z("request-queue-concurrency-non-hosted");return new r({concurrency:s,process:n=>{if(yn(n.params.requestOptions))throw io("",St("Request canceled"),n.params);return xM(n)}})})).push(t)}async function xM(t){let e,r;await XX(t);try{do[e,r]=await KX(t);while(!await rK(t,e,r))}catch(n){const o=io("request:server",n,t.params,e);throw o.details.ssl=t.useSSL,t.interceptor?.error&&t.interceptor.error(o),o}const i=t.params.url;if(r)if(/\/sharing\/rest\/(accounts|portals)\/self/i.test(i)){if(!t.hasToken&&!t.credentialToken&&r.user?.username&&!qP(i)){const n=ks(i,!0);n&&en.trustedServers.push(n)}Array.isArray(r.authorizedCrossOriginNoCorsDomains)&&UX(r.authorizedCrossOriginNoCorsDomains)}else(t.params.requestOptions.responseType||"json")==="json"&&qX(i,r);const s=t.credential;if(s&&Ve){let o=Ve.findServerInfo(s.server)?.owningSystemUrl;if(o){o=o.replace(/\/?$/,"/sharing");const a=Ve.findCredential(o,s.userId);a&&Ve._getIdenticalSvcIdx(o,a)===-1&&a.resources.unshift(o)}}return{data:r,getAllHeaders:e?()=>Array.from(e.headers):nm,getHeader:e?n=>e.headers.get(n):nm,httpStatus:e?.status??200,requestOptions:t.params.requestOptions,ssl:t.useSSL,url:t.params.url}}async function rK(t,e,r){if(t.redoRequest)return t.redoRequest=!1,!1;const i=t.params.requestOptions;if(!e||i.responseType==="native"||i.responseType==="native-request-init")return!0;let s,n;if(r&&(r.error&&typeof r.error=="object"?s=r.error:r.status==="error"&&Array.isArray(r.messages)&&(s={...r},s[Wb]=r,s.details=r.messages)),!s&&!e.ok)throw s=new Error(`Unable to load ${e.url} status: ${e.status}`),s[Wb]=r,s;let o,a=null;s&&(n=Number(s.code),a=s.hasOwnProperty("subcode")?Number(s.subcode):null,o=s.messageCode,o=o?.toUpperCase());const l=i.authMode;if(n===403&&(a===4||s.message?.toLowerCase().includes("ssl")&&!s.message.toLowerCase().includes("permission"))){if(!t.useSSL)return t.useSSL=!0,!1}else if(!t.hasToken&&t.useIdentity&&(l!=="no-prompt"||n===498)&&n!==void 0&&HX.has(n)&&!Jz(t.params.url)&&(n!==403||(!o||!WX.has(o))&&(a==null||a===2&&t.credentialToken))){await SM();try{const u=await Ve.getCredential(t.params.url,{error:io("request:server",s,t.params),credential:t.credential,prompt:l!=="no-prompt",signal:t.controller.signal,token:t.credentialToken});return t.credential=u,t.credentialToken=u.token,t.useSSL=t.useSSL||u.ssl,!1}catch(u){if(l==="no-prompt")return t.credential=void 0,t.credentialToken=void 0,!1;s=u}}if(s)throw s;return!0}function yR(t,e,r=!1){const i=e.controller.signal,s=new Image;return e.withCredentials?s.crossOrigin="use-credentials":s.crossOrigin="anonymous",s.alt="",s.fetchPriority=en.priority,s.src=t,VX(s,t,r,i)}function iK(t){let e,r;return typeof t=="string"?(e=ks(t,!0),r=qb(t)):(e=t.origin,r=qb(t.toString())),e==null?null:{origin:e,isHosted:r}}function sK(t){return t?.release&&typeof t.release=="function"}function nK(t){return t?.acquire&&typeof t.acquire=="function"}var ic;let Md=(ic=class{constructor(e,r,i,s=1,n=0){this._ctor=e,this._acquireFunction=r,this._releaseFunction=i,this.allocationSize=s,this._pool=new Array(n),this._initialSize=n;for(let o=0;o<n;o++)this._pool[o]=new this._ctor;this.allocationSize=Math.max(s,1)}destroy(){this.prune(0)}acquire(...e){let r;if(ic.test.disabled)r=new this._ctor;else{if(this._pool.length===0){const i=this.allocationSize;for(let s=0;s<i;s++)this._pool[s]=new this._ctor}r=this._pool.pop()}return this._acquireFunction?this._acquireFunction(r,...e):nK(r)&&r.acquire(...e),r}release(e){e&&!ic.test.disabled&&(this._releaseFunction?this._releaseFunction(e):sK(e)&&e.release(),this._pool.push(e))}prune(e=this._initialSize){if(!(e>=this._pool.length)){for(let r=e;r<this._pool.length;++r){const i=this._pool[r];this._dispose(i)}this._pool.length=e}}_dispose(e){e.dispose&&typeof e.dispose=="function"&&e.dispose()}},ic.test={disabled:!1},ic);function oK(t){t.length=0}let Fi=class{constructor(e=50,r=50){this._pool=new Md(Array,void 0,oK,r,e)}acquire(){return this._pool.acquire()}release(e){this._pool.release(e)}prune(){this._pool.prune(0)}static acquire(){return hx.acquire()}static release(e){return hx.release(e)}static prune(){hx.prune()}};const hx=new Fi(100),gR=new WeakMap;function aK(t,e,r=!1){const i=` DEPRECATED - ${e}`;if(!r)return void t.warn(i);let s=gR.get(t);s||(s=new Set,gR.set(t,s)),s.has(e)||(s.add(e),t.warn(i))}const Zb="https://www.esriurl.com/";function i3(t,e,r,i={}){z("esri-deprecation-warnings")&&nc(t,`This widget is deprecated. Use the ${e} component instead.`,{see:[`${e} component reference: ${Zb}${r}/`,`Esri's move to web components: ${Zb}components-transition-plan/`],replacement:`<${r}></${r}>`,warnOnce:!0,...i})}function lK(t,e,r,i={}){z("esri-deprecation-warnings")&&nc(t,`This view model is deprecated. Use the ${e} component directly instead.`,{see:[`${e} component reference: ${Zb}${r}/`,`Esri's move to web components: ${Zb}components-transition-plan/`],replacement:`<${r}></${r}>`,warnOnce:!0,...i})}function JLe(t,e,r={}){z("esri-deprecation-warnings")&&nc(t,`Module: ${e}`,r)}function Yz(t,e,r={}){if(z("esri-deprecation-warnings")){const{moduleName:i}=r;nc(t,`Function: ${(i?i+"::":"")+e+"()"}`,r)}}function Xz(t,e,r={}){if(z("esri-deprecation-warnings")){const{moduleName:i}=r;nc(t,`Property: ${(i?i+"::":"")+e}`,r)}}function uK(t,e,r={}){z("esri-deprecation-warnings")&&nc(t,`Multiple argument constructor: ${e}`,{warnOnce:!0,replacement:`new ${e}({ <your properties here> })`,...r})}function nc(t,e,r={}){if(z("esri-deprecation-warnings")){const{replacement:i,version:s,see:n,warnOnce:o}=r;let a=e;if(i&&(a+=`
	 Replacement: ${i}`),s&&(a+=`
	 Version: ${s}`),n)if(Array.isArray(n)){a+=`
	 See for more details:`;for(const l of n)a+=`
		${l}`}else a+=`
	 See ${n} for more details.`;aK(t,a,o)}}function YLe(t){const e=[];return function*(){yield*e;for(const r of t)e.push(r),yield r}}function cK(t,e){for(const r of t)if(r!=null&&e(r))return r}function Jb(t){return t!=null&&typeof t[Symbol.iterator]=="function"}let Rm=class{constructor(){this._groups=new Map}destroy(){this.removeAll()}get size(){let e=0;return this._groups.forEach((r=>{e+=r.length})),e}add(e,r){if(Jb(e)){const i=this._getOrCreateGroup(r);for(const s of e)_R(s)&&i.push(s)}else _R(e)&&this._getOrCreateGroup(r).push(e);return this}forEach(e,r){if(typeof e=="function")this._groups.forEach((i=>i.forEach(e)));else{const i=this._getGroup(e);i&&r&&i.forEach(r)}}has(e){return this._groups.has(t_(e))}remove(e){if(typeof e!="string"&&Jb(e)){for(const r of e)this.remove(r);return this}return this.has(e)?(vR(this._getGroup(e)),this._groups.delete(t_(e)),this):this}removeAll(){return this._groups.forEach(vR),this._groups.clear(),this}removeReference(e){return this._groups.delete(e),this}_getOrCreateGroup(e){if(this.has(e))return this._getGroup(e);const r=[];return this._groups.set(t_(e),r),r}_getGroup(e){return this._groups.get(t_(e))}};function t_(t){return t||"_default_"}function vR(t){for(const e of t)e instanceof Rm?e.removeAll():e.remove()}function _R(t){return t!=null&&(!!t.remove||t instanceof Rm)}const Kz=Symbol("Accessor-beforeDestroy");function qi(t){return t.__accessor__??null}function hK(t,e){return t?.metadata?.[e]!=null}function g1(t,e,r){return r?Yb(t,e,{policy:r,path:""}):Yb(t,e,null)}function Yb(t,e,r){return e?Object.keys(e).reduce(((i,s)=>{const n=s;if(n==="__proto__")return i;let o=null,a="merge";if(r&&(o=r.path?`${r.path}.${s}`:s,a=r.policy(o)),a==="replace"||a==="replace-arrays"&&Array.isArray(i[n]))return i[n]=e[n],i;if(i[n]===void 0)return i[n]=k(e[n]),i;let l=i[n],u=e[n];if(l===u)return i;if(Array.isArray(u)||Array.isArray(i))l=l?Array.isArray(l)?i[n]=l.slice():i[n]=[l]:i[n]=[],u&&(Array.isArray(u)||(u=[u]),u.forEach((h=>{l.includes(h)||l.push(h)})));else if(u&&typeof u=="object")if(r){const h=r.path;r.path=o,i[n]=Yb(l,u,r),r.path=h}else i[n]=Yb(l,u,null);else i.hasOwnProperty(s)&&!e.hasOwnProperty(s)||(i[n]=u);return i}),t||{}):t}function Qz(t){return Array.isArray(t)?t:t.split(".")}function bR(t){return t.includes(",")?t.split(",").map((e=>e.trim())):[t.trim()]}function dK(t){if(Array.isArray(t)){const e=[];for(const r of t)e.push(...bR(r));return e}return bR(t)}function eV(t,e,r,i){const s=dK(e);if(s.length!==1){const n=s.map((o=>i(t,o,r)));return $d(n)}return i(t,s[0],r)}function tV(t,e){const r=t[t.length-1]==="?"?t.slice(0,-1):t;if(e.getItemAt!=null||Array.isArray(e)){const s=parseInt(r,10);if(!isNaN(s))return Array.isArray(e)?e[s]:e.at(s)}const i=qi(e);return hK(i,r)?i.get(r):e[r]}function rV(t,e,r){if(t==null)return t;const i=tV(e[r],t);return!i&&r<e.length-1?void 0:r===e.length-1?i:rV(i,e,r+1)}function gv(t,e,r=0){return typeof e!="string"||e.includes(".")?rV(t,Qz(e),r):tV(e,t)}function un(t,e){return gv(t,e)}function wR(t,e){return gv(e,t)!==void 0}const Ps={INITIALIZING:0,CONSTRUCTING:1,CONSTRUCTED:2,DESTROYING:3,DESTROYED:4};function vv(t){let e=t.constructor.__accessorMetadata__;const r=Object.prototype.hasOwnProperty.call(t.constructor,"__accessorMetadata__");if(e){if(!r){e=Object.create(e);for(const i in e)e[i]=k(e[i]);Object.defineProperty(t.constructor,"__accessorMetadata__",{value:e,enumerable:!1,configurable:!0,writable:!0})}}else e={},Object.defineProperty(t.constructor,"__accessorMetadata__",{value:e,enumerable:!1,configurable:!0,writable:!0});return t.constructor.__accessorMetadata__}function _v(t,e){const r=vv(t);let i=r[e];return i||(i=r[e]={}),i}function pK(t,e){return g1(t,e,mK)}const fK=/^(?:[^.]+\.)?(?:value|type|(?:json\.type|json\.origins\.[^.]\.type))$/;function mK(t){return fK.test(t)?"replace":"merge"}let yK=class{constructor(e,r){this._observers=e,this._observer=r}remove(){OP(this._observers,this._observer)}},iV=class{constructor(){this._observers=null,this.destroyed=!1}observe(e){if(this.destroyed||e.destroyed)return gK;this._observers==null&&(this._observers=[]);const r=this._observers;let i=!1,s=!1;const n=r.length;for(let o=0;o<n;++o){const a=r[o];if(a.destroyed)s=!0;else if(a===e){i=!0;break}}return i||(r.push(e),s&&this._removeDestroyedObservers()),new yK(r,e)}_removeDestroyedObservers(){const e=this._observers;if(!e||e.length===0)return;const r=e.length;let i=0;for(let s=0;s<r;++s){for(;s+i<r&&e[s+i].destroyed;)++i;if(i>0){if(!(s+i<r))break;e[s]=e[s+i]}}e.length=r-i}destroy(){if(this.destroyed)return;this.destroyed=!0;const e=this._observers;if(e!=null){for(const r of e)r.onCommitted();this._observers=null}}};const gK=He();var xe;(function(t){t[t.DEFAULTS=0]="DEFAULTS",t[t.COMPUTED=1]="COMPUTED",t[t.SERVICE=2]="SERVICE",t[t.PORTAL_ITEM=3]="PORTAL_ITEM",t[t.WEB_SCENE=4]="WEB_SCENE",t[t.WEB_MAP=5]="WEB_MAP",t[t.LINK_CHART=6]="LINK_CHART",t[t.USER=7]="USER"})(xe||(xe={}));const $M=xe.USER+1;function Ml(t){switch(t){case"defaults":return xe.DEFAULTS;case"service":return xe.SERVICE;case"portal-item":return xe.PORTAL_ITEM;case"web-scene":return xe.WEB_SCENE;case"web-map":return xe.WEB_MAP;case"link-chart":return xe.LINK_CHART;case"user":return xe.USER;default:return null}}function I0(t){switch(t){case xe.DEFAULTS:return"defaults";case xe.SERVICE:return"service";case xe.PORTAL_ITEM:return"portal-item";case xe.WEB_SCENE:return"web-scene";case xe.WEB_MAP:return"web-map";case xe.LINK_CHART:return"link-chart";case xe.USER:return"user"}}function vK(t){return I0(t)}const It={Dirty:1,Overridden:2,Computing:4,NonNullable:8,HasDefaultValue:16,DepTrackingInitialized:32,AutoTracked:64,ExplicitlyTracking:128};let qS=class{constructor(e){this.accessed=void 0,this._handles=void 0,this._observer=e}destroy(){this.accessed?.clear(),this.clear()}onAccessed(e){this._observer!=null&&e!==this._observer&&(this.accessed==null&&(this.accessed=new Set),this.accessed.add(e))}onTrackingEnd(){this._observer!=null&&(this.clear(),this.accessed!=null&&(this._handles==null&&(this._handles=[]),this.accessed.forEach((e=>{this._handles.push(e.observe(this._observer))})),this.accessed.clear()))}clear(){if(this._handles!=null){for(let e=0;e<this._handles.length;++e)this._handles[e].remove();this._handles.length=0}}};const Xb=new qS,Vy=[];let qg=Xb;function we(t){qg.onAccessed(t)}let v1=!1,_1=!1;function Dl(t,e,r){if(v1)return s3(t,e,r);let i=null;return sV(t),i=e.call(r),nV(),i}function _K(t,e){return Dl(Xb,t,e)}function s3(t,e,r){const i=v1;v1=!0,sV(t);let s=null;try{s=e.call(r)}catch(n){_1&&q.getLogger("esri.core.accessorSupport.tracking").error(n)}return nV(),v1=i,s}function sV(t){qg=t,Vy.push(t)}function nV(){const t=Vy.length;if(t>1){const e=Vy.pop();qg=Vy[t-2],e.onTrackingEnd()}else if(t===1){const e=Vy.pop();qg=Xb,e.onTrackingEnd()}else qg=Xb}function oV(t,e){if(e.flags&It.DepTrackingInitialized)return;e.flags|=It.DepTrackingInitialized;const r=_1;_1=!1,e.flags&It.AutoTracked?s3(e.trackingTarget,e.metadata.get,t):aV(t,e),_1=r}const bK=[];function aV(t,e){e.flags&It.ExplicitlyTracking||(e.flags|=It.ExplicitlyTracking,s3(e.trackingTarget,(()=>{const r=e.metadata.dependsOn||bK;for(const i of r)if(typeof i!="string"||i.includes(".")){const s=Qz(i);for(let n=0,o=t;n<s.length&&o!=null&&typeof o=="object";++n)o=SR(o,s[n],n!==s.length-1)}else SR(t,i,!1)})),e.flags&=-129)}function SR(t,e,r){const i=e[e.length-1]==="?"?e.slice(0,-1):e;if(t.getItemAt!=null||Array.isArray(t)){const n=parseInt(i,10);if(!isNaN(n))return Array.isArray(t)?t[n]:t.at(n)}const s=qi(t);if(s){const n=s.propertiesByName.get(i);n&&(we(n),oV(t,n))}return r?t[i]:void 0}let xR=class extends iV{constructor(e,r){super(),this.propertyName=e,this.metadata=r,this.trackingTarget=new qS(this),this.flags=0,this.flags=It.Dirty|(r.nonNullable?It.NonNullable:0)|(r.hasOwnProperty("value")?It.HasDefaultValue:0)|(r.get===void 0?It.DepTrackingInitialized:0)|(r.dependsOn===void 0?It.AutoTracked:0)}destroy(){this.flags&It.Dirty&&this.onCommitted(),super.destroy(),this.trackingTarget.destroy()}getComputed(e){e.mutable&&we(this);const r=e.store,i=this.propertyName,s=this.flags,n=r.get(i);if(s&It.Computing||~s&It.Dirty&&r.has(i))return n;this.flags|=It.Computing;const o=e.host;let a;s&It.AutoTracked?a=Dl(this.trackingTarget,this.metadata.get,o):(aV(o,this),a=this.metadata.get.call(o)),this.flags|=It.DepTrackingInitialized,r.set(i,a,xe.COMPUTED);const l=r.get(i);return l===n?this.flags&=-2:_K(this.commit,this),this.flags&=-5,l}notifyChange(){this.onInvalidated(),this.onCommitted()}invalidate(){this.onInvalidated()}commit(){this.flags&=-2,this.onCommitted()}onInvalidated(){~this.flags&It.Overridden&&(this.flags|=It.Dirty);const e=this._observers;if(e&&e.length>0)for(const r of e)r.onInvalidated()}onCommitted(){const e=this._observers;if(e&&e.length>0){const r=e.slice();for(const i of r)i.onCommitted()}}},wK=class lV{constructor(){this._values=new Map,this.multipleOriginsSupported=!1}clone(e){const r=new lV;return this._values.forEach(((i,s)=>{e&&e.has(s)||r.set(s,k(i))})),r}get(e){return this._values.get(e)}originOf(){return xe.USER}keys(){return[...this._values.keys()]}set(e,r){this._values.set(e,r)}delete(e){this._values.delete(e)}has(e){return this._values.has(e)}isAtOrigin(e,r){return this.has(e)}isBelowOrigin(e,r){return!this.has(e)}forEach(e){this._values.forEach(e)}};function Dd(t,e,r){return t!==void 0}function $R(t,e,r,i){return t!==void 0&&(!(r==null&&t.flags&It.NonNullable)||(i.lifecycle,!1))}let SK=class{constructor(e){this.host=e,this.propertiesByName=new Map,this.ctorArgs=null,this.lifecycle=Ps.INITIALIZING,this.store=new wK,this.mutable=!0,this._origin=xe.USER;const r=this.host.constructor.__accessorMetadata__;for(const i in r){const s=new xR(i,r[i]);this.propertiesByName.set(i,s)}this.metadata=r}initialize(){this.lifecycle=Ps.CONSTRUCTING}constructed(){this.lifecycle=Ps.CONSTRUCTED}destroy(){this.lifecycle=Ps.DESTROYED,this.propertiesByName.forEach((e=>e.destroy()))}get initialized(){return this.lifecycle!==Ps.INITIALIZING}get(e){const r=this.propertiesByName.get(e);if(!Dd(r))return;if(r.metadata.get)return r.getComputed(this);this.mutable&&we(r);const i=this.store;return i.has(e)?i.get(e):r.metadata.value}originOf(e){const r=this.store.originOf(e);if(r===void 0){const i=this.propertiesByName.get(e);if(i!==void 0&&i.flags&It.HasDefaultValue)return"defaults"}return I0(r)}has(e){return this.propertiesByName.has(e)&&this.store.has(e)}keys(){return[...this.propertiesByName.keys()]}internalGet(e){const r=this.propertiesByName.get(e);if(Dd(r))return this.store.has(e)?this.store.get(e):r.metadata.value}internalSet(e,r){const i=this.propertiesByName.get(e);Dd(i)&&this._internalSet(i,r)}getDependsInfo(e,r,i){const s=this.propertiesByName.get(r);if(!Dd(s))return"";const n=new qS,o=Dl(n,(()=>s.metadata.get?.call(e)));let a=`${i}${e.declaredClass.split(".").pop()}.${r}: ${o}
`;const l=n.accessed??new Set;if(l.size===0)return a;i+="  ";for(const u of l)u instanceof xR&&(a+=`${i}${u.propertyName}: undefined
`);return a}setAtOrigin(e,r,i){const s=this.propertiesByName.get(e);if(Dd(s))return this._setAtOrigin(s,r,i)}isOverridden(e){const r=this.propertiesByName.get(e);return r!==void 0&&!!(r.flags&It.Overridden)}clearOrigin(e,r){const i=this.store,s=this.propertiesByName.get(e);if(!Dd(s))return;const n=i.isAtOrigin(e,r)&&!(s.flags&It.Overridden);i.delete(e,r),n&&s.notifyChange()}clearOverride(e){const r=this.propertiesByName.get(e);r&&r.flags&It.Overridden&&(r.flags&=-3,r.notifyChange())}override(e,r){const i=this.propertiesByName.get(e);if(!$R(i,e,r,this))return;const s=i.metadata.cast;if(s){const n=this._cast(s,r),{valid:o,value:a}=n;if(dx.release(n),!o)return;r=a}i.flags|=It.Overridden,this._internalSet(i,r)}set(e,r){const i=this.propertiesByName.get(e);if(!$R(i,e,r,this))return;const s=i.metadata.cast;if(s){const o=this._cast(s,r),{valid:a,value:l}=o;if(dx.release(o),!a)return;r=l}const n=i.metadata.set;n?n.call(this.host,r):this._internalSet(i,r)}setDefaultOrigin(e){this._origin=Ml(e)}getDefaultOrigin(){return I0(this._origin)}notifyChange(e){const r=this.propertiesByName.get(e);r!==void 0&&r.notifyChange()}invalidate(e){const r=this.propertiesByName.get(e);r!==void 0&&r.invalidate()}commit(e){const r=this.propertiesByName.get(e);r!==void 0&&r.commit()}_internalSet(e,r){const i=this.lifecycle!==Ps.INITIALIZING?this._origin:xe.DEFAULTS;this._setAtOrigin(e,r,i)}_setAtOrigin(e,r,i){const s=this.store,n=e.propertyName;if(s.isAtOrigin(n,i)&&zP(r,s.get(n))&&~e.flags&It.Overridden)return;const o=s.isBelowOrigin(n,i)||s.isAtOrigin(n,i);o&&e.invalidate(),s.set(n,r,i),o&&e.commit(),oV(this.host,e)}_cast(e,r){const i=dx.acquire();return i.valid=!0,i.value=r,e&&(i.value=e.call(this.host,r,i)),i}},xK=class{constructor(){this.value=null,this.valid=!0}acquire(){this.valid=!0}release(){this.value=null}};const dx=new Md(xK);function Kb(t,e,r){if(t&&e)if(typeof e=="object")for(const i of Object.getOwnPropertyNames(e))Kb(t,i,e[i]);else{if(e.includes(".")){const s=e.split("."),n=s.splice(-1,1)[0];return void Kb(un(t,s),n,r)}const i=t.__accessor__;i!=null&&$K(e,i),t[e]=r}}function $K(t,e){if(z("esri-unknown-property-errors")&&!MK(t,e))throw new F("set:unknown-property",TK(t,e))}function MK(t,e){return e.metadata[t]!=null}function TK(t,e){return"setting unknown property '"+t+"' on instance of "+e.host.declaredClass}let EK;function IK(){return EK}var MR;(function(t){t[t.Ignore=0]="Ignore",t[t.Destroy=1]="Destroy",t[t.ThrowError=2]="ThrowError"})(MR||(MR={}));let uV=class extends Md{constructor(){super(...arguments),this._set=new Set}destroy(){super.destroy(),this._set=null}acquire(...e){const r=super.acquire(...e);return this._set.delete(r),r}release(e){e&&!this._set.has(e)&&(super.release(e),this._set.add(e))}_dispose(e){this._set.delete(e),super._dispose(e)}};const r_=[];function Qb(t){r_.push(t),r_.length===1&&queueMicrotask((()=>{const e=r_.slice();r_.length=0;for(const r of e)r()}))}let Hg=class{constructor(e,r=30){this.name=e,this._counter=0,this._samples=new Array(r)}push(e){e!=null&&(this._samples[++this._counter%this._samples.length]=e)}set(e){e!=null&&(this._samples[this._counter%this._samples.length]=e)}get median(){return this._samples.slice().sort(((e,r)=>e-r))[Math.floor(this._samples.length/2)]}get average(){return this._samples.reduce(((e,r)=>e+r),0)/this._samples.length}get last(){return this._samples[this._counter%this._samples.length]}};var MM;(function(t){const e=(n,o,a,l)=>{let u=o,h=o;const p=a>>>1,m=n[u-1];for(;h<=p;){h=u<<1,h<a&&l(n[h-1],n[h])<0&&++h;const y=n[h-1];if(l(y,m)<=0)break;n[u-1]=y,u=h}n[u-1]=m},r=(n,o)=>n<o?-1:n>o?1:0;function i(n,o,a,l){o===void 0&&(o=0),a===void 0&&(a=n.length),l===void 0&&(l=r);for(let h=a>>>1;h>o;h--)e(n,h,a,l);const u=o+1;for(let h=a-1;h>o;h--){const p=n[o];n[o]=n[h],n[h]=p,e(n,u,h,l)}}function*s(n,o,a,l){o===void 0&&(o=0),a===void 0&&(a=n.length),l===void 0&&(l=r);for(let h=a>>>1;h>o;h--)e(n,h,a,l),yield;const u=o+1;for(let h=a-1;h>o;h--){const p=n[o];n[o]=n[h],n[h]=p,e(n,u,h,l),yield}}t.sort=i,t.iterableSort=s})(MM||(MM={}));const TR=MM,CK=1.5,PK=1.1;let Wg=class{constructor(e){this.data=[],this._length=0,this._allocator=void 0,this._deallocator=()=>null,this._shrink=()=>{},this._hint=new K6,e&&(e.initialSize&&(this.data=new Array(e.initialSize)),e.allocator&&(this._allocator=e.allocator),e.deallocator!==void 0&&(this._deallocator=e.deallocator),e.shrink&&(this._shrink=()=>ER(this)))}toArray(){return this.data.slice(0,this.length)}filter(e){const r=new Array;for(let i=0;i<this._length;i++){const s=this.data[i];e(s)&&r.push(s)}return r}at(e){if((e=Math.trunc(e)||0)<0&&(e+=this._length),!(e<0||e>=this._length))return this.data[e]}includes(e,r){const i=this.data.indexOf(e,r);return i!==-1&&i<this.length}get length(){return this._length}set length(e){if(e>this._length){if(this._allocator){for(;this._length<e;)this.data[this._length++]=this._allocator(this.data[this._length]);return}this._length=e}else{if(this._deallocator)for(let r=e;r<this._length;++r)this.data[r]=this._deallocator(this.data[r]);this._length=e,this._shrink()}}clear(){this.length=0}prune(){this.clear(),this.data=[]}push(e){this.data[this._length++]=e}pushArray(e,r=e.length){for(let i=0;i<r;i++)this.data[this._length++]=e[i]}fill(e,r){for(let i=0;i<r;i++)this.data[this._length++]=e}pushNew(){this._allocator&&(this.data[this.length]=this._allocator(this.data[this.length]));const e=this.data[this._length];return++this._length,e}unshift(e){this.data.unshift(e),this._length++,ER(this)}pop(){if(this.length===0)return;const e=this.data[this.length-1];return this.length=this.length-1,this._shrink(),e}remove(e){const r=hM(this.data,e,this.length,this._hint);if(r!==-1)return this.data.splice(r,1),this.length=this.length-1,e}removeUnordered(e){return this.removeUnorderedIndex(hM(this.data,e,this.length,this._hint))}removeUnorderedIndex(e){if(!(e>=this.length||e<0))return this.swapElements(e,this.length-1),this.pop()}removeUnorderedMany(e,r=e.length,i){this.length=AY(this.data,e,this.length,r,this._hint,i),this._shrink()}front(){if(this.length!==0)return this.data[0]}back(){if(this.length!==0)return this.data[this.length-1]}swapElements(e,r){if(e>=this.length||r>=this.length||e===r)return;const i=this.data[e];this.data[e]=this.data[r],this.data[r]=i}sort(e){TR.sort(this.data,0,this.length,e)}iterableSort(e){return TR.iterableSort(this.data,0,this.length,e)}some(e,r){for(let i=0;i<this.length;++i)if(e.call(r,this.data[i],i,this.data))return!0;return!1}find(e,r){const{data:i,length:s}=this;for(let n=0;n<s;++n)if(e.call(r,i[n]))return i[n]}filterInPlace(e,r){let i=0;for(let s=0;s<this._length;++s){const n=this.data[s];e.call(r,n,s,this.data)&&(this.data[s]=this.data[i],this.data[i]=n,i++)}if(this._deallocator)for(let s=i;s<this._length;s++)this.data[s]=this._deallocator(this.data[s]);return this._length=i,this._shrink(),this}forAll(e,r){const{data:i,length:s}=this;for(let n=0;n<s;++n)e.call(r,i[n],n,i)}forEach(e,r){this.data.slice(0,this.length).forEach(e,r)}map(e,r){const i=new Array(this.length);for(let s=0;s<this.length;++s)i[s]=e.call(r,this.data[s],s,this.data);return i}reduce(e,r){let i=r;for(let s=0;s<this.length;++s)i=e(i,this.data[s],s,this.data);return i}has(e){const r=this.length,i=this.data;for(let s=0;s<r;++s)if(i[s]===e)return!0;return!1}*[Symbol.iterator](){for(let e=0;e<this.length;e++)yield this.data[e]}};function ER(t){t.data.length>CK*t.length&&(t.data.length=Math.floor(t.length*PK))}function aRe(t){return t}function AK(t){return 1e3*t}function lRe(t){return t}function uRe(t){return .001*t}let LK=class{constructor(e){this.phases=e,this.paused=!1,this.ticks=-1,this.removed=!1}},RK=class{constructor(e){this.callback=e,this.isActive=!0}remove(){this.isActive=!1}},TM=0;const ry={time:0,deltaTime:0,elapsedFrameTime:0,frameDuration:0},EM=["prepare","preRender","render","postRender","update","finish"],IM=[],dd=new Wg;let kK=class{constructor(e){this._task=e}remove(){this._task.removed=!0}pause(){this._task.paused=!0}resume(){this._task.paused=!1,cV()}};function OK(){Wh!=null&&(cancelAnimationFrame(Wh),Wh=requestAnimationFrame(n3))}function cV(){Wh==null&&(TM=performance.now(),Wh=requestAnimationFrame(n3))}const ew={frameTasks:dd,willDispatch:!1,clearFrameTasks:NK,dispatch:dV,executeFrameTasks:FK,reschedule:OK};function bv(t){const e=new RK(t);return IM.push(e),ew.willDispatch||(ew.willDispatch=!0,Qb(dV)),e}function om(t){const e=new LK(t);return dd.push(e),cV(),new kK(e)}let Wh=null;function NK(t=!1){dd.forAll((e=>{e.removed=!0})),t&&hV()}function n3(){const t=performance.now();Wh=null,Wh=dd.some((r=>!r.paused&&!r.removed))?requestAnimationFrame(n3):null,ew.executeFrameTasks(t)}function FK(t){const e=t-TM;TM=t;const r=1e3/60,i=Math.max(0,e-r);ry.time=t,ry.frameDuration=r-i;for(let s=0;s<EM.length;s++){const n=performance.now(),o=EM[s];dd.forAll((a=>{a.paused||a.removed||(s===0&&a.ticks++,a.phases[o]&&(ry.elapsedFrameTime=performance.now()-t,ry.deltaTime=a.ticks===0?0:e,a.phases[o]?.call(a,ry)))})),jK[s].push(performance.now()-n)}hV(),UK.push(performance.now()-t)}const i_=new Wg;function hV(){dd.forAll((t=>{t.removed&&i_.push(t)})),dd.removeUnorderedMany(i_.data,i_.length),i_.clear()}function dV(){for(;IM.length;){const t=IM.shift();t.isActive&&t.callback()}ew.willDispatch=!1}function DK(t=1,e){const r=Ns(),i=()=>{yn(e)?r.reject(St()):t===0?r():(--t,Qb((()=>i())))};return i(),r.promise}function zK(t){return DK(1,t)}async function VK(t){await zK(t),await new Promise((e=>requestAnimationFrame((()=>{t?.aborted||e()}))))}const jK=EM.map((t=>new Hg(t))),UK=new Hg("total");function pV(t,e){for(const r of t.values())if(e(r))return!0;return!1}function tw(t,e){if(!e)return t;for(const r of e)r!=null&&t.add(r);return t}function IR(t,e){return e!=null&&t.add(e),t}function o3(t,e){const r=new Set;return tw(r,t),tw(r,e),r}function GK(t,e){const r=new Set;for(const i of e)t.has(i)&&r.add(i);return r}function pRe(t,e){if(!t||!e)return!1;if(t===e)return!0;for(const r of t)if(!e.has(r))return!1;return!0}function fRe(t,e){if(t==null&&e==null)return!0;if(t==null||e==null||t.size!==e.size)return!1;for(const r of t)if(!e.has(r))return!1;return!0}function BK(t,e){const r=new Set(t);for(const i of e)r.delete(i);return r}function qK(t,e){return BK(o3(t,e),GK(t,e))}let HK=0;function b1(){return++HK}let HS=class extends qS{constructor(e){super(new WK(e)),this._observer&&CR.register(this,new WeakRef(this._observer),this)}destroy(){this._observer&&CR.unregister(this._observer),this.accessed?.clear(),this.clear(),this._observer?.destroy()}},WK=class{constructor(e){this._notify=e,this._invalidCount=0,this.destroyed=!1}onInvalidated(){this._invalidCount++}onCommitted(){if(this.destroyed)return;const e=this._invalidCount;if(e===1)return this._invalidCount=0,void this._notify();this._invalidCount=e>0?e-1:0}destroy(){this.destroyed=!0,this._notify=ZK}};const CR=new FinalizationRegistry((t=>{t.deref()?.destroy()}));function ZK(){}let pf=!1;const rw=[];function fV(t,e){let r=new HS(n),i=null,s=!1;function n(){if(!r||s)return;if(pf)return void gV(n);const a=i;r.clear(),pf=!0,s=!0,i=Dl(r,t),s=!1,pf=!1,e(i,a),vV()}function o(){r&&(r.destroy(),r=null,i=null)}return s=!0,i=Dl(r,t),s=!1,He(o)}function mV(t,e){let r=new HS(s),i=null;function s(){e(i,o)}function n(){r&&(r.destroy(),r=null),i=null}function o(){return r?(r.clear(),i=Dl(r,t),i):null}return o(),He(n)}function yV(t,e){let r=!1,i=!1;const s=!!e?.sync;let n=new HS((()=>{r||i||(i=!0,s?o():queueMicrotask(o))}));function o(){i=!1,n&&!r&&(pf?gV(o):(n.clear(),pf=!0,r=!0,Dl(n,t),r=!1,pf=!1,vV()))}function a(){n&&(n.destroy(),n=null)}return r=!0,Dl(n,t),r=!1,He(a)}function gV(t){rw.includes(t)||rw.unshift(t)}function vV(){for(;rw.length;)rw.pop()()}var Zg;(function(t){t[t.Untracked=0]="Untracked",t[t.Tracked=1]="Tracked"})(Zg||(Zg={}));var rd;let a3=(rd=class{constructor(){this.uid=b1(),this.removed=!1,this.type=null,this.oldValue=null,this.callback=null,this.getValue=null,this.target=null,this.path=null,this.equals=null}static acquireUntracked(e,r,i,s,n){return this.pool.acquire(Zg.Untracked,e,r,i,s,n,zP)}static acquireTracked(e,r,i,s){return this.pool.acquire(Zg.Tracked,e,r,i,null,null,s)}notify(e,r){this.type===Zg.Untracked?this.callback.call(this.target,e,r,this.path,this.target):this.callback.call(null,e,r,void 0,void 0)}acquire(e,r,i,s,n,o,a){this.uid=b1(),this.removed=!1,this.type=e,this.oldValue=r,this.callback=i,this.getValue=s,this.target=n,this.path=o,this.equals=a}release(){this.target=this.path=this.oldValue=this.callback=this.getValue=null,this.uid=b1(),this.removed=!0}},rd.pool=new uV(rd),rd);const w1=new Fi,Rl=new Set;let iw;function sw(t){Rl.delete(t),Rl.add(t),iw||(iw=bv(XK))}function JK(t){if(t.removed)return;const e=t.oldValue,r=t.getValue();t.equals(e,r)||(t.oldValue=r,t.notify(r,e))}function YK(t){for(const e of Rl.values())e.target===t&&(e.removed=!0)}function XK(){let t=10;for(;iw&&t--;){iw=null;const e=KK(),r=w1.acquire();for(const i of e){const s=i.uid;JK(i),s===i.uid&&i.removed&&r.push(i)}for(const i of Rl)i.removed&&(r.push(i),Rl.delete(i));for(const i of r)a3.pool.release(i);w1.release(r),w1.release(e),CM.forEach((i=>i()))}}function KK(){const t=w1.acquire();t.length=Rl.size;let e=0;for(const r of Rl)t[e]=r,++e;return Rl.clear(),t}const CM=new Set;function QK(t){return CM.add(t),He((()=>CM.delete(t)))}function eQ(t,e,r){let i=eV(t,e,r,((s,n,o)=>{let a,l,u=mV((()=>gv(s,n)),((h,p)=>{s.__accessor__?.lifecycle===Ps.DESTROYED||a&&a.uid!==l?i.remove():(a||(a=a3.acquireUntracked(h,o,p,s,n),l=a.uid),sw(a))}));return He((()=>{u.remove(),a&&(a.uid!==l||a.removed||(a.removed=!0,sw(a)),a=null),i=u=null}))}));return i}function tQ(t,e,r){const i=eV(t,e,r,((s,n,o)=>{let a=!1;return fV((()=>gv(s,n)),((l,u)=>{s.__accessor__.lifecycle!==Ps.DESTROYED?a||(a=!0,zP(u,l)||o.call(s,l,u,n,s),a=!1):i.remove()}))}));return i}function rQ(t,e,r,i=!1){return t.__accessor__&&t.__accessor__.lifecycle!==Ps.DESTROYED?i?tQ(t,e,r):eQ(t,e,r):He()}function iQ(t,e,r){let i,s,n=mV(t,((o,a)=>{i&&i.uid!==s?n.remove():(i||(i=a3.acquireTracked(o,e,a,r),s=i.uid),sw(i))}));return He((()=>{n.remove(),i&&(i.uid!==s||i.removed||(i.removed=!0,sw(i)),i=null),n=null}))}function sQ(t,e,r){let i=!1;return fV(t,((s,n)=>{i||(i=!0,r(n,s)||e(s,n),i=!1)}))}function nQ(t,e,r=!1,i=cz){return r?sQ(t,e,i):iQ(t,e,i)}function PR(t){return pV(Rl,(e=>e.oldValue===t))}const Zh=()=>q.getLogger("esri.core.accessorSupport.ensureTypes");function oQ(t){if(t==null)return t;const e=new Date(t);return isNaN(e.getTime())?(Zh().error("Accessor#set",`Invalid date value: '${t}', falling back to current date`),new Date):e}function aQ(t){return t==null?t:!!t}function wv(t){return t==null?t:t.toString()}function Di(t,e=0){return t==null?t:(t=parseFloat(t),isNaN(t)?e:t)}function l3(t){return t==null?t:Math.round(parseFloat(t))}function lQ(t){return null}function uQ(t,e){return r=>{let i=t(r);return e.step!=null&&(i=Math.round(i/e.step)*e.step),e.min!=null&&(i=Math.max(e.min,i)),e.max!=null&&(i=Math.min(e.max,i)),i}}function _V(t){return t?.constructor&&t.constructor.__accessorMetadata__!==void 0}function nw(t,e){return e!=null&&t&&!(e instanceof t)}function bV(t){return t&&"isCollection"in t}function AR(t){return t?.Type?typeof t.Type=="function"?t.Type:t.Type.base:null}function cQ(t,e){if(!e?.constructor||!bV(e.constructor))return PM(t,e)?e:new t(e);const r=AR(t.prototype.itemType),i=AR(e.constructor.prototype.itemType);return r?i?r===i?e:r.prototype.isPrototypeOf(i.prototype)?new t(e):(PM(t,e),e):new t(e):e}function PM(t,e){return!!_V(e)&&(Zh().error("Accessor#set","Assigning an instance of '"+(e.declaredClass||"unknown")+"' which is not a subclass of '"+WS(t)+"'"),!0)}function km(t,e){return e==null?e:bV(t)?cQ(t,e):nw(t,e)?PM(t,e)?e:new t(e):e}function WS(t){return t?.prototype?.declaredClass||"unknown"}const hQ=new WeakMap;function dQ(t){switch(t){case Number:return e=>Di(e);case qe:return l3;case Boolean:return aQ;case String:return wv;case Date:return oQ;case ZS:return lQ;default:return Pm(hQ,t,(()=>km.bind(null,t)))}}function br(t,e){const r=dQ(t);return arguments.length===1?r:r(e)}function C0(t,e,r){return arguments.length===1?C0.bind(null,t):e&&(Array.isArray(e)?e.map((i=>t(i,r))):[t(e,r)])}function pQ(t,e){return arguments.length===1?C0((r=>br(t,r))):C0((r=>br(t,r)),e)}function wV(t,e,r){return e!==0&&Array.isArray(r)?r.map((i=>wV(t,e-1,i))):t(r)}function ow(t,e,r){if(arguments.length===2)return n=>ow(t,e,n);if(!r)return r;r=wV(t,e,r);let i=e,s=r;for(;i>0&&Array.isArray(s);)i--,s=s[0];if(s!==void 0)for(let n=0;n<i;n++)r=[r];return r}function fQ(t,e,r){return arguments.length===2?ow((i=>br(t,i)),e):ow((i=>br(t,i)),e,r)}function SV(t){return!!Array.isArray(t)&&!t.some((e=>{const r=typeof e;return!(r==="string"||r==="number"||r==="function"&&t.length>1)}))}function AM(t,e){if(arguments.length===2)return AM(t).call(null,e);const r=new Set,i=t.filter((a=>typeof a!="function")),s=t.filter((a=>typeof a=="function"));for(const a of t)typeof a!="string"&&typeof a!="number"||r.add(a);let n=null,o=null;return(a,l)=>{if(a==null)return a;const u=typeof a,h=u==="string"||u==="number";return h&&(r.has(a)||s.some((p=>u==="string"&&p===String||u==="number"&&p===Number)))||u==="object"&&s.some((p=>!nw(a,p)))?a:(h&&i.length?(n||(n=i.map((p=>typeof p=="string"?`'${p}'`:`${p}`)).join(", ")),Zh().error("Accessor#set",`'${a}' is not a valid value for this property, only the following values are valid: ${n}`)):typeof a=="object"&&s.length?(o||(o=s.map((p=>WS(p))).join(", ")),Zh().error("Accessor#set",`'${a}' is not a valid value for this property, value must be one of ${o}`)):Zh().error("Accessor#set",`'${a}' is not a valid value for this property`),l&&(l.valid=!1),null)}}function xa(t,e){if(arguments.length===2)return xa(t).call(null,e);const r={},i=[],s=[];for(const l in t.typeMap){const u=t.typeMap[l];r[l]=br(u),i.push(WS(u)),s.push(l)}const n=()=>`'${i.join("', '")}'`,o=()=>`'${s.join("', '")}'`,a=typeof t.key=="string"?l=>l[t.key]:t.key;return l=>{if(t.base&&!nw(t.base,l)||l==null)return l;const u=a(l)||t.defaultKeyValue,h=r[u];if(!h)return Zh().error("Accessor#set",`Invalid property value, value needs to be one of ${n()}, or a plain object that can autocast (having .type = ${o()})`),null;if(!nw(t.typeMap[u],l))return l;if(typeof t.key=="string"&&!_V(l)){const p={};for(const m in l)m!==t.key&&(p[m]=l[m]);return h(p)}return h(l)}}let qe=class{},ZS=class{};const _Re={native:t=>({type:"native",value:t}),array:t=>({type:"array",value:t}),oneOf:t=>({type:"one-of",values:t})};function mQ(t){if(!t||!("type"in t))return!1;switch(t.type){case"native":case"array":case"one-of":return!0}return!1}function xV(t){switch(t.type){case"native":return br(t.value);case"array":return C0(xV(t.value));case"one-of":return yQ(t);default:return null}}function yQ(t){let e=null;return(r,i)=>RM(r,t)?r:(e==null&&(e=LM(t)),Zh().error("Accessor#set",`Invalid property value, value needs to be of type ${e}`),i&&(i.valid=!1),null)}function LM(t){switch(t.type){case"native":switch(t.value){case Number:return"number";case String:return"string";case Boolean:return"boolean";case qe:return"integer";case Date:return"date";case ZS:return"null";default:return WS(t.value)}case"array":return`array of ${LM(t.value)}`;case"one-of":{const e=t.values.map((r=>LM(r)));return`one of ${e.slice(0,-1)} or ${e[e.length-1]}`}}return"unknown"}function RM(t,e){if(t==null)return!0;switch(e.type){case"native":switch(e.value){case Number:case qe:return typeof t=="number";case Boolean:return typeof t=="boolean";case String:return typeof t=="string";case ZS:return t===null}return t instanceof e.value;case"array":return!!Array.isArray(t)&&!t.some((r=>!RM(r,e.value)));case"one-of":return e.values.some((r=>RM(t,r)))}}function d(t={}){return(e,r)=>{if(e===Function.prototype)throw new Error(`Inappropriate use of @property() on a static field: ${e.name}.${r}. Accessor does not support static properties.`);const i=Object.getOwnPropertyDescriptor(e,r),s=_v(e,r);i&&(i.get||i.set?(s.get=i.get||s.get,s.set=i.set||s.set):"value"in i&&("value"in t&&q.getLogger("esri.core.accessorSupport.decorators.property").warn(`@property() will redefine the value of "${r}" on "${e.constructor.name}" already defined in the metadata`,t),s.value=t.value=i.value)),t.readOnly!=null&&(s.readOnly=t.readOnly);const n=t.aliasOf;if(n){const l=typeof n=="string"?n:n.source,u=typeof n=="string"?null:n.overridable===!0;let h;s.dependsOn=[l],s.get=function(){let p=un(this,l);if(typeof p=="function"){h||(h=l.split(".").slice(0,-1).join("."));const m=un(this,h);m&&(p=p.bind(m))}return p},s.readOnly||(s.set=u?function(p){this._override(r,p)}:function(p){Kb(this,l,p)})}const o=t.type,a=t.types;if(!s.cast){let l;o?l=gQ(o):a&&(l=Array.isArray(a)?C0(xa(a[0])):xa(a)),t.cast=vQ(t.cast,l)}pK(s,t),t.range&&(s.cast=uQ(s.cast,t.range))}}function u3(t,e,r){const i=_v(t,r);i.json||(i.json={});let s=i.json;return e!==void 0&&(s.origins||(s.origins={}),s.origins[e]||(s.origins[e]={}),s=s.origins[e]),s}function gQ(t){let e=0,r=t;if(mQ(t))return xV(t);for(;Array.isArray(r)&&r.length===1&&typeof r[0]!="string"&&typeof r[0]!="number";)r=r[0],e++;const i=r;if(SV(i))return e===0?AM(i):ow(AM(i),e);if(e===1)return pQ(i);if(e>1)return fQ(i,e);const s=t;return s.from?s.from:br(s)}function vQ(t,e){if(t||e)return t?e?(r,i)=>e(t(r,i),i):t:e}function _Q(t){if(t.json&&t.json.origins){const e=t.json.origins,r={"web-document":["web-scene","web-map"]};for(const i in r)if(e[i]){const s=e[i];r[i].forEach((n=>{e[n]=s})),delete e[i]}}}let Fs=class extends fz{constructor(e,r,i){super(e,r,i)}};Fs.prototype.type="warning";function $V(t){return!!t&&t.prototype?.declaredClass&&t.prototype.declaredClass.indexOf("esri.core.Collection")===0}const kM=()=>q.getLogger("esri.core.accessorSupport.extensions.serializableProperty.reader");function LR(t,e,r){t&&(!r&&!e.read||e.read?.reader||e.read?.enabled===!1||SQ(t)&&Cr("read.reader",Om(t),e))}function Om(t){const e=t.ndimArray??0;if(e>1)return wQ(t);if(e===1)return RR(t);if("type"in t&&TV(t.type)){const r=t.type.prototype?.itemType?.Type,i=RR(typeof r=="function"?{type:r}:{types:r});return(s,n,o)=>{const a=i(s,n,o);return a&&new t.type(a)}}return c3(t)}function c3(t){return"type"in t?bQ(t.type):xQ(t.types)}function bQ(t){return t.prototype.read?(e,r,i)=>{if(e==null)return e;const s=typeof e;if(s!=="object")return void kM().error(`Expected JSON value of type 'object' to deserialize type '${t.prototype.declaredClass}', but got '${s}'`);const n=new t;return n.read(e,i),n}:t.fromJSON}function MV(t,e,r,i){return i!==0&&Array.isArray(e)?e.map((s=>MV(t,s,r,i-1))):t(e,void 0,r)}function wQ(t){const e=c3(t),r=MV.bind(null,e),i=t.ndimArray??0;return(s,n,o)=>{if(s==null)return s;s=r(s,o,i);let a=i,l=s;for(;a>0&&Array.isArray(l);)a--,l=l[0];if(l!==void 0)for(let u=0;u<a;u++)s=[s];return s}}function RR(t){const e=c3(t);return(r,i,s)=>{if(r==null)return r;if(Array.isArray(r)){const o=[];for(const a of r){const l=e(a,void 0,s);l!==void 0&&o.push(l)}return o}const n=e(r,void 0,s);return n!==void 0?[n]:void 0}}function TV(t){if(!$V(t))return!1;const e=t.prototype.itemType;return!(!e||!e.Type)&&(typeof e.Type=="function"?h3(e.Type):EV(e.Type))}function SQ(t){return"types"in t?EV(t.types):h3(t.type)}function h3(t){return!Array.isArray(t)&&!!t&&t.prototype&&("read"in t.prototype||"fromJSON"in t||TV(t))}function EV(t){for(const e in t.typeMap)if(!h3(t.typeMap[e]))return!1;return!0}function xQ(t){let e=null;const r=t.errorContext??"type",i=t.validate;return(s,n,o)=>{if(s==null)return s;const a=typeof s;if(a!=="object")return void kM().error(`Expected JSON value of type 'object' to deserialize, but got '${a}'`);e||(e=$Q(t));const l=t.key;if(typeof l!="string")return;const u=s[l],h=u?e[u]:t.defaultKeyValue?t.typeMap[t.defaultKeyValue]:void 0;if(!h){const m=`Type '${u||"unknown"}' is not supported`;return o?.messages&&s&&o.messages.push(new Fs(`${r}:unsupported`,m,{definition:s,context:o})),void kM().error(m)}const p=new h;return p.read(s,o),i?i(p):p}}function $Q(t){const e={};for(const r in t.typeMap){const i=t.typeMap[r],s=vv(i.prototype);if(typeof t.key=="function")continue;const n=s[t.key];if(!n)continue;if(n.json?.type&&Array.isArray(n.json.type)&&n.json.type.length===1&&typeof n.json.type[0]=="string"){e[n.json.type[0]]=i;continue}const o=n.json?.write;if(!o?.writer){e[r]=i;continue}const a=o.target,l=typeof a=="string"?a:t.key,u={};o.writer(r,u,l),u[l]&&(e[u[l]]=i)}return e}function MQ(t){if(t.json||(t.json={}),OR(t.json),NR(t.json),kR(t.json),t.json.origins)for(const e in t.json.origins)OR(t.json.origins[e]),NR(t.json.origins[e]),kR(t.json.origins[e]);return!0}function kR(t){t.name&&(t.read&&typeof t.read=="object"?t.read.source===void 0&&(t.read.source=t.name):t.read={source:t.name},t.write&&typeof t.write=="object"?t.write.target===void 0&&(t.write.target=t.name):t.write={target:t.name})}function OR(t){typeof t.read=="boolean"?t.read={enabled:t.read}:typeof t.read=="function"?t.read={enabled:!0,reader:t.read}:t.read&&typeof t.read=="object"&&t.read.enabled===void 0&&(t.read.enabled=!0)}function NR(t){typeof t.write=="boolean"?t.write={enabled:t.write}:typeof t.write=="function"?t.write={enabled:!0,writer:t.write}:t.write&&typeof t.write=="object"&&t.write.enabled===void 0&&(t.write.enabled=!0)}function FR(t,e){if(!e.write||e.write.writer||e.write.enabled===!1&&!e.write.overridePolicy)return;const r=t?.ndimArray??0;t&&(r===1||"type"in t&&$V(t.type))?e.write.writer=IQ:r>1?e.write.writer=CQ(r):e.types?Array.isArray(e.types)?e.write.writer=EQ(e.types[0]):e.write.writer=TQ(e.types):e.write.writer=P0}function TQ(t){return(e,r,i,s)=>e?IV(e,t,s)?P0(e,r,i,s):void 0:P0(e,r,i,s)}function IV(t,e,r){for(const i in e.typeMap)if(t instanceof e.typeMap[i])return!0;if(r?.messages){const i=e.errorContext??"type",s=`Values of type '${(typeof e.key!="function"?t[e.key]:t.declaredClass)??"Unknown"}' cannot be written`;r&&r.messages&&t&&r.messages.push(new F(`${i}:unsupported`,s,{definition:t,context:r})),q.getLogger("esri.core.accessorSupport.extensions.serializableProperty.writer").error(s)}return!1}function EQ(t){return(e,r,i,s)=>!e||!Array.isArray(e)?P0(e,r,i,s):P0(e.filter((n=>IV(n,t,s))),r,i,s)}function P0(t,e,r,i){Cr(r,aw(t,i),e)}function aw(t,e){return t&&typeof t.write=="function"?t.write({},e):t&&typeof t.toJSON=="function"?t.toJSON():typeof t=="number"?lw(t):t}function lw(t){return t===-1/0?-Number.MAX_VALUE:t===1/0?Number.MAX_VALUE:isNaN(t)?null:t}function IQ(t,e,r,i){let s;t===null?s=null:t&&typeof t.map=="function"?(s=t.map((n=>aw(n,i))),typeof s.toArray=="function"&&(s=s.toArray())):s=[aw(t,i)],Cr(r,s,e)}function CV(t,e,r){return r!==0&&Array.isArray(t)?t.map((i=>CV(i,e,r-1))):aw(t,e)}function CQ(t){return(e,r,i,s)=>{let n;if(e===null)n=null;else{n=CV(e,s,t);let o=t,a=n;for(;o>0&&Array.isArray(a);)o--,a=a[0];if(a!==void 0)for(let l=0;l<o;l++)n=[n]}Cr(i,n,r)}}function PQ(t,e){return d3(t,"any",e?.origin)}function OM(t,e){return d3(t,"read",e?.origin)}function PV(t,e){return d3(t,"write",e?.origin)}function d3(t,e,r){let i=t?.json;if(i?.origins&&r){let s;s=r==="link-chart"?i.origins[r]&&(e==="any"||e in i.origins[r])?i.origins[r]:i.origins["web-map"]:i.origins[r],s&&(e==="any"||e in s)&&(i=s)}return i}function AQ(t){const e=LQ(t);if(t.json.origins)for(const r in t.json.origins){const i=t.json.origins[r],s=i.types?RQ(i):e;LR(s,i,!1),i.types&&!i.write&&t.json.write?.enabled&&(i.write={...t.json.write}),FR(s,i)}LR(e,t.json,!0),FR(e,t.json)}function LQ(t){return t.json.types?NM(t.json):t.type?AV(t):NM(t)}function RQ(t){return t.type?AV(t):NM(t)}function AV(t){if(!t.type)return;let e=0,r=t.type;for(;Array.isArray(r)&&!SV(r);)r=r[0],e++;return{type:r,ndimArray:e}}function NM(t){if(!t.types)return;let e=0,r=t.types;for(;Array.isArray(r);)r=r[0],e++;return{types:r,ndimArray:e}}function kQ(t){MQ(t)&&(_Q(t),AQ(t))}const px=new Set,fx=new Set;function C(t){return e=>{t??="esri.core.Accessor",e.prototype.declaredClass=t,NQ(e);const r=[],i=[];let s=e.prototype;for(;s;)s.hasOwnProperty("initialize")&&!px.has(s.initialize)&&(px.add(s.initialize),r.push(s.initialize)),s.hasOwnProperty("destroy")&&!fx.has(s.destroy)&&(fx.add(s.destroy),i.push(s.destroy)),s=Object.getPrototypeOf(s);px.clear(),fx.clear();const n=class extends e{constructor(...a){if(super(...a),this.constructor===n&&typeof this.postscript=="function"){if(r.length&&Object.defineProperty(this,"initialize",{enumerable:!1,configurable:!0,value(){for(let l=r.length-1;l>=0;l--)r[l].call(this)}}),i.length){let l=!1;const u=this[Kz];Object.defineProperty(this,"destroy",{enumerable:!1,configurable:!0,value(){if(!l){this.__accessor__.lifecycle=Ps.DESTROYING,l=!0,u.call(this);for(let h=0;h<i.length;h++)i[h].call(this)}}})}Object.defineProperty(this,Symbol.dispose,{enumerable:!1,configurable:!0,value(){this.destroy()}}),this.postscript()}}};n.__accessorMetadata__=vv(e.prototype),n.prototype.declaredClass=t;const o=(t||"AccessorSubclass").split(".").slice(-1)[0];return Object.defineProperty(n,"name",{value:o,configurable:!0}),n}}function OQ(t,e){return e.get==null?function(){const r=this.__accessor__,i=r.propertiesByName.get(t);if(i===void 0)return;r.mutable&&we(i);const s=r.store;return s.has(t)?s.get(t):i.metadata.value}:function(){const r=this.__accessor__,i=r.propertiesByName.get(t);if(i!==void 0)return i.getComputed(r)}}function NQ(t){const e=t.prototype,r=vv(e),i={};for(const s of Object.getOwnPropertyNames(r)){const n=r[s];kQ(n),i[s]={enumerable:!0,configurable:!0,get:OQ(s,n),set(o){const a=this.__accessor__;if(a!==void 0){if(a.mutable)return a.initialized&&n.readOnly?DR("read-only",s):a.lifecycle===Ps.CONSTRUCTED&&n.constructOnly?DR("construct-only",s):void a.set(s,o)}else Object.defineProperty(this,s,{enumerable:!0,configurable:!0,writable:!0,value:o})}}}Object.defineProperties(t.prototype,i)}const DR=(t,e)=>{q.getLogger("esri.core.Accessor").error(`cannot assign to ${t} property '${e}'`)};var zR,VR;function FQ(t){if(t==null)return{value:t};if(Array.isArray(t))return{type:[t[0]],value:null};switch(typeof t){case"object":return t.constructor?.__accessorMetadata__||t instanceof Date?{type:t.constructor,value:t}:t;case"boolean":return{type:Boolean,value:t};case"string":return{type:String,value:t};case"number":return{type:Number,value:t};case"function":return{type:t,value:null};default:return}}const Yl=Symbol("Accessor-Handles"),mx=Symbol("Accessor-Initialized");var sc;let ce=(sc=class{static createSubclass(e={}){if(Array.isArray(e))throw new Error("Multi-inheritance unsupported since 4.16");const{properties:r,declaredClass:i,constructor:s}=e;delete e.declaredClass,delete e.properties,delete e.constructor;const n=this;class o extends n{constructor(...l){super(...l),this.inherited=null,s&&s.apply(this,l)}}vv(o.prototype);for(const a in e){const l=e[a];o.prototype[a]=typeof l=="function"?function(...u){const h=this.inherited;let p;this.inherited=function(...m){if(n.prototype[a])return n.prototype[a].apply(this,m)};try{p=l.apply(this,u)}catch(m){throw this.inherited=h,m}return this.inherited=h,p}:e[a]}for(const a in r){const l=FQ(r[a]);d(l)(o.prototype,a)}return C(i)(o)}static freeze(e){return e instanceof sc?e.__accessor__.mutable=!1:Object.freeze(e),e}static isFrozen(e){return e instanceof sc?!e.__accessor__.mutable:Object.isFrozen(e)}constructor(...e){if(this[zR]=null,this[VR]=!1,this.constructor===sc)throw new Error("[accessor] cannot instantiate Accessor. This can be fixed by creating a subclass of Accessor");const r=new SK(this);Object.defineProperty(this,"__accessor__",{enumerable:!1,value:r}),e.length>0&&(r.ctorArgs=this.normalizeCtorArgs?.apply(this,e)??e[0])}postscript(){const e=this.__accessor__,r=e.ctorArgs;e.initialize(),r&&(this.set(r),e.ctorArgs=null),e.constructed(),this.initialize(),this[mx]=!0}initialize(){}[Kz](){this[Yl]=At(this[Yl])}destroy(){this.destroyed||(YK(this),this.__accessor__.destroy(),IK()?.onInstanceDestroy(this))}[Symbol.dispose](){this.destroy()}get constructed(){return this.__accessor__&&this.__accessor__.initialized||!1}get initialized(){return this[mx]}get destroyed(){return this.__accessor__?.lifecycle===Ps.DESTROYED||!1}get destroying(){return this.__accessor__?.lifecycle===Ps.DESTROYING||!1}commitProperty(e){un(this,e)}hasOwnProperty(e){return this.__accessor__?this.__accessor__.has(e):Object.prototype.hasOwnProperty.call(this,e)}keys(){return this.__accessor__?this.__accessor__.keys():[]}set(e,r){return Kb(this,e,r),this}watch(e,r,i){return Yz(q.getLogger(this),"`watch` is deprecated in favor of reactiveUtils.watch",{replacement:"reactiveUtils.watch",version:"4.32",see:"https://arcg.is/1vaqf42#watch",warnOnce:!0}),rQ(this,e,r,i)}addHandles(e,r){if(this.destroyed){const i=Array.isArray(e)?e:[e];for(const s of i)s.remove();return}(this[Yl]??=new Rm).add(e,r)}removeHandles(e){this[Yl]?.remove(e)}removeAllHandles(){this[Yl]?.removeAll()}removeHandlesReference(e){this[Yl]?.removeReference(e)}hasHandles(e){return this[Yl]?.has(e)===!0}_override(e,r){r===void 0?this.__accessor__.clearOverride(e):this.__accessor__.override(e,r)}_clearOverride(e){return this.__accessor__.clearOverride(e)}_overrideIfSome(e,r){r==null?this.__accessor__.clearOverride(e):this.__accessor__.override(e,r)}_isOverridden(e){return this.__accessor__.isOverridden(e)}notifyChange(e){this.__accessor__.notifyChange(e)}_get(e){return this.__accessor__.internalGet(e)}_set(e,r){return this.__accessor__.internalSet(e,r),this}},zR=Yl,VR=mx,sc),S1=class LV{constructor(){this._emitter=new LV.EventEmitter(this)}emit(e,r){return this._emitter.emit(e,r)}on(e,r){return this._emitter.on(e,r)}once(e,r){return this._emitter.once(e,r)}hasEventListener(e){return this._emitter.hasEventListener(e)}};(function(t){class e{constructor(s=null){this._target=s,this._listenersMap=null}clear(){this._listenersMap?.clear(),this._listenersMap=null}destroy(){this.clear()}emit(s,n){let o=this._listenersMap?.get(s);if(!o)return!1;const a=this._target||this;let l=!1;for(const u of o.slice()){const h="deref"in u?u.deref():u;h?h?.call(a,n):l=!0}return l&&(o=o.filter((u=>!("deref"in u)||u.deref()!=null)),this._listenersMap.set(s,o)),o.length>0}on(s,n){if(Array.isArray(s)){const a=s.map((l=>this.on(l,n)));return $d(a)}if(s.includes(","))throw new TypeError("Evented.on() with a comma delimited string of event types is not supported");this._listenersMap??=new Map;const o=this._listenersMap.get(s)||[];return o.push(n),this._listenersMap.set(s,o),He((()=>{const a=this._listenersMap?.get(s),l=a?.indexOf(n)??-1;l>=0&&a.splice(l,1)}))}once(s,n){const o=this.on(s,(a=>{o.remove(),("deref"in n?n.deref():n)?.call(null,a)}));return o}hasEventListener(s){const n=this._listenersMap?.get(s);return n!=null&&n.length>0}}t.EventEmitter=e,t.EventedMixin=i=>{let s=class extends i{constructor(){super(...arguments),this._emitter=new e}destroy(){this._emitter.clear()}emit(n,o){return this._emitter.emit(n,o)}on(n,o){return this._emitter.on(n,o)}once(n,o){return this._emitter.once(n,o)}hasEventListener(n){return this._emitter.hasEventListener(n)}};return s=c([C("esri.core.Evented")],s),s};let r=class extends ce{constructor(){super(...arguments),this._emitter=new S1.EventEmitter(this)}destroy(){this._emitter.clear()}emit(i,s){return this._emitter.emit(i,s)}on(i,s){return this._emitter.on(i,s)}once(i,s){return this._emitter.once(i,s)}hasEventListener(i){return this._emitter.hasEventListener(i)}};r=c([C("esri.core.Evented.EventedAccessor")],r),t.EventedAccessor=r})(S1||(S1={}));const Ca=S1;var Qe;(function(t){t[t.ADD=1]="ADD",t[t.REMOVE=2]="REMOVE",t[t.MOVE=4]="MOVE"})(Qe||(Qe={}));function p3(t){return(e,r)=>{e[r]=t}}let Sv=class extends iV{notify(){const e=this._observers;if(e&&e.length>0){const r=e.slice();for(const i of r)i.onInvalidated(),i.onCommitted()}}};var Ga;let DQ=class{constructor(){this.target=null,this.cancellable=!1,this.defaultPrevented=!1,this.item=void 0,this.type=void 0}preventDefault(){this.cancellable&&(this.defaultPrevented=!0)}reset(e){this.defaultPrevented=!1,this.item=e}},zQ=class{constructor(e,r,i,s,n){this.target=e,this.added=r,this.removed=i,this.start=s,this.deleteCount=n}};const zs=new Md(DQ,void 0,(t=>{t.item=null,t.target=null,t.defaultPrevented=!1,t.cancellable=!1}));function jR(t){t&&typeof t=="object"&&"destroy"in t&&typeof t.destroy=="function"&&t.destroy()}function yx(t){return t?t instanceof Mu?t.toArray():t.length?Array.prototype.slice.apply(t):[]:[]}function gx(t){if(t?.length)return t[0]}function VQ(t,e,r,i){const s=Math.min(t.length-r,e.length-i);let n=0;for(;n<s&&t[r+n]===e[i+n];)n++;return n}function RV(t,e,r,i){e&&e.forEach(((s,n,o)=>{t.push(s),RV(t,r.call(i,s,n,o),r,i)}))}const Xl=new Set,Kl=new Set,Ql=new Set,vx=new Map;let jQ=0;var id;let Mu=(id=class extends Ca.EventedAccessor{static isCollection(e){return e!=null&&e instanceof Ga}constructor(e){super(e),this._chgListeners=[],this._notifications=null,this._updating=!1,this._timer=null,this._observable=new Sv,this.length=0,this._items=[],Object.defineProperty(this,"uid",{value:jQ++})}normalizeCtorArgs(e){return e?Array.isArray(e)||e instanceof Ga?{items:e}:e:{}}destroy(){this._removeAllRaw(),this._timer&&this._timer.remove(),this._emitter.destroy(),this._notifications=null}*[Symbol.iterator](){yield*this.items}get items(){return we(this._observable),this._items}set items(e){this._emitBeforeChanges(Qe.ADD)||(this._splice(0,this.length,yx(e)),this._emitAfterChanges(Qe.ADD))}hasEventListener(e){return!this.destroyed&&(e==="change"?this._chgListeners.length>0:this._emitter.hasEventListener(e))}on(e,r){if(this.destroyed)return He();if(e==="change"){const i=this._chgListeners,s={removed:!1,callback:r};return i.push(s),this._notifications&&this._notifications.push({listeners:i.slice(),items:this._items.slice(),changes:[]}),He((()=>{s.removed=!0,i.splice(i.indexOf(s),1)}))}return this._emitter.on(e,r)}once(e,r){const i="deref"in r?()=>r.deref():()=>r,s=this.on(e,(n=>{i()?.call(null,n),s.remove()}));return s}add(e,r){if(we(this._observable),this._emitBeforeChanges(Qe.ADD))return this;const i=this.getNextIndex(r??null);return this._splice(i,0,[e]),this._emitAfterChanges(Qe.ADD),this}addMany(e,r=this._items.length){if(we(this._observable),!e?.length)return this;if(this._emitBeforeChanges(Qe.ADD))return this;const i=this.getNextIndex(r);return this._splice(i,0,yx(e)),this._emitAfterChanges(Qe.ADD),this}at(e){if(we(this._observable),(e=Math.trunc(e)||0)<0&&(e+=this.length),!(e<0||e>=this.length))return this._items[e]}removeAll(){if(we(this._observable),!this.length||this._emitBeforeChanges(Qe.REMOVE))return[];const e=this._removeAllRaw();return this._emitAfterChanges(Qe.REMOVE),e}_removeAllRaw(){return this.length===0?[]:this._splice(0,this.length)||[]}clone(){return we(this._observable),this._createNewInstance({items:this._items.map(k)})}concat(...e){we(this._observable);const r=e.map(yx);return this._createNewInstance({items:this._items.concat(...r)})}drain(e,r){if(we(this._observable),!this.length||this._emitBeforeChanges(Qe.REMOVE))return;const i=this._splice(0,this.length),s=i.length;for(let n=0;n<s;n++)e.call(r,i[n],n,i);this._emitAfterChanges(Qe.REMOVE)}destroyAll(){this.drain(jR)}destroyMany(e){const r=this.removeMany(e);return r.forEach(jR),r}every(e,r){return we(this._observable),this._items.every(e,r)}filter(e,r){we(this._observable);const i=arguments.length===2?this._items.filter(e,r):this._items.filter(e);return this._createNewInstance({items:i})}find(e,r){return we(this._observable),this._items.find(e,r)}findIndex(e,r){return we(this._observable),this._items.findIndex(e,r)}flatten(e,r){we(this._observable);const i=[];return RV(i,this,e,r),new Ga(i)}forEach(e,r){return we(this._observable),this._items.forEach(e,r)}getItemAt(e){return we(this._observable),this._items[e]}getNextIndex(e){we(this._observable);const r=this.length;return(e=e??r)<0?e=0:e>r&&(e=r),e}includes(e,r=0){return we(this._observable),this._items.includes(e,r)}indexOf(e,r=0){return we(this._observable),this._items.indexOf(e,r)}join(e=","){return we(this._observable),this._items.join(e)}lastIndexOf(e,r=this.length-1){return we(this._observable),this._items.lastIndexOf(e,r)}map(e,r){we(this._observable);const i=this._items.map(e,r);return new Ga({items:i})}reorder(e,r=this.length-1){we(this._observable);const i=this.indexOf(e);if(i!==-1){if(r<0?r=0:r>=this.length&&(r=this.length-1),i!==r){if(this._emitBeforeChanges(Qe.MOVE))return e;this._splice(i,1),this._splice(r,0,[e]),this._emitAfterChanges(Qe.MOVE)}return e}}pop(){if(we(this._observable),!this.length||this._emitBeforeChanges(Qe.REMOVE))return;const e=gx(this._splice(this.length-1,1));return this._emitAfterChanges(Qe.REMOVE),e}push(...e){return we(this._observable),this._emitBeforeChanges(Qe.ADD)||(this._splice(this.length,0,e),this._emitAfterChanges(Qe.ADD)),this.length}reduce(e,r){we(this._observable);const i=this._items;return arguments.length===2?i.reduce(e,r):i.reduce(e)}reduceRight(e,r){we(this._observable);const i=this._items;return arguments.length===2?i.reduceRight(e,r):i.reduceRight(e)}remove(e){return we(this._observable),this.removeAt(this.indexOf(e))}removeAt(e){if(we(this._observable),e<0||e>=this.length||this._emitBeforeChanges(Qe.REMOVE))return;const r=gx(this._splice(e,1));return this._emitAfterChanges(Qe.REMOVE),r}removeMany(e){if(we(this._observable),!e?.length||this._emitBeforeChanges(Qe.REMOVE))return[];const r=e instanceof Ga?e.toArray():e,i=this._items,s=[],n=r.length;for(let o=0;o<n;o++){const a=r[o],l=i.indexOf(a);if(l>-1){const u=1+VQ(r,i,o+1,l+1),h=this._splice(l,u);h&&h.length>0&&s.push.apply(s,h),o+=u-1}}return this._emitAfterChanges(Qe.REMOVE),s}reverse(){if(we(this._observable),this._emitBeforeChanges(Qe.MOVE))return this;const e=this._splice(0,this.length);return e&&(e.reverse(),this._splice(0,0,e)),this._emitAfterChanges(Qe.MOVE),this}shift(){if(we(this._observable),!this.length||this._emitBeforeChanges(Qe.REMOVE))return;const e=gx(this._splice(0,1));return this._emitAfterChanges(Qe.REMOVE),e}slice(e=0,r=this.length){return we(this._observable),this._createNewInstance({items:this._items.slice(e,r)})}some(e,r){return we(this._observable),this._items.some(e,r)}sort(e){if(we(this._observable),!this.length||this._emitBeforeChanges(Qe.MOVE)||!this._requiresSort(e))return this;const r=this._splice(0,this.length);return arguments.length?r.sort(e):r.sort(),this._splice(0,0,r),this._emitAfterChanges(Qe.MOVE),this}_requiresSort(e=(r,i)=>r===i?0:r<i?-1:1){const r=this.length-1;for(let i=0;i<r;i++)if(e(this.items[i],this.items[i+1])>0)return!0;return!1}splice(e,r,...i){we(this._observable),arguments.length===1&&(r=this.length),r??=0;const s=(r?Qe.REMOVE:0)|(i.length?Qe.ADD:0);if(this._emitBeforeChanges(s))return[];const n=this._splice(e,r,i)||[];return this._emitAfterChanges(s),n}toArray(){return we(this._observable),this._items.slice()}toJSON(e){return we(this._observable),this.toArray().map((r=>T0(r)?r.toJSON(e):r))}toLocaleString(){return we(this._observable),this._items.toLocaleString()}toString(){return we(this._observable),this._items.toString()}unshift(...e){return we(this._observable),!e.length||this._emitBeforeChanges(Qe.ADD)||(this._splice(0,0,e),this._emitAfterChanges(Qe.ADD)),this.length}_createNewInstance(e){return new this.constructor(e)}_splice(e,r,i){const s=this._items,n=this.itemType;let o,a;if(!this._notifications&&this.hasEventListener("change")&&(this._notifications=[{listeners:this._chgListeners.slice(),items:this._items.slice(),changes:[]}],this._timer&&this._timer.remove(),this._updating=!0,this._timer=bv((()=>this._dispatchChange()))),e<0&&(e+=this.length),r){if(a=s.splice(e,r),this.hasEventListener("before-remove")){const l=zs.acquire();l.target=this,l.cancellable=!0;for(let u=0,h=a.length;u<h;u++)o=a[u],l.reset(o),this.emit("before-remove",l),l.defaultPrevented&&(a.splice(u,1),s.splice(e,0,o),e+=1,u-=1,h-=1);zs.release(l)}if(this.length=this._items.length,this.hasEventListener("after-remove")){const l=zs.acquire();l.target=this,l.cancellable=!1;const u=a.length;for(let h=0;h<u;h++)l.reset(a[h]),this.emit("after-remove",l);zs.release(l)}}if(i?.length){if(n){const p=[];for(const m of i){const y=n.ensureType(m);y==null&&m!=null||p.push(y)}i=p}const l=this.hasEventListener("before-add"),u=this.hasEventListener("after-add"),h=e===this.length;if(l||u){const p=zs.acquire();p.target=this,p.cancellable=!0;const m=zs.acquire();m.target=this,m.cancellable=!1;for(const y of i)l?(p.reset(y),this.emit("before-add",p),p.defaultPrevented||(h?s.push(y):s.splice(e++,0,y),this._set("length",s.length),u&&(m.reset(y),this.emit("after-add",m)))):(h?s.push(y):s.splice(e++,0,y),this._set("length",s.length),m.reset(y),this.emit("after-add",m));zs.release(m),zs.release(p)}else{if(h)for(const p of i)s.push(p);else s.splice(e,0,...i);this._set("length",s.length)}}if((i?.length||a?.length)&&this._notifyChangeEvent(i,a),this.hasEventListener("after-splice")){const l=new zQ(this,i,a,e,r);this.emit("after-splice",l)}return a}_emitBeforeChanges(e){let r=!1;if(this.hasEventListener("before-changes")){const i=zs.acquire();i.target=this,i.cancellable=!0,i.type=e,this.emit("before-changes",i),r=i.defaultPrevented,zs.release(i)}return r}_emitAfterChanges(e){if(this.hasEventListener("after-changes")){const r=zs.acquire();r.target=this,r.cancellable=!1,r.type=e,this.emit("after-changes",r),zs.release(r)}this._observable.notify()}_notifyChangeEvent(e,r){this.hasEventListener("change")&&this._notifications&&this._notifications[this._notifications.length-1].changes.push({added:e,removed:r})}get updating(){return this._updating}_dispatchChange(){if(this._timer&&(this._timer.remove(),this._timer=null),this._updating=!1,!this._notifications)return;const e=this._notifications;this._notifications=null;for(const r of e){const i=r.changes;Xl.clear(),Kl.clear(),Ql.clear();for(const{added:u,removed:h}of i){if(u)if(Ql.size===0&&Kl.size===0)for(const p of u)Xl.add(p);else for(const p of u)Kl.has(p)?(Ql.add(p),Kl.delete(p)):Ql.has(p)||Xl.add(p);if(h)if(Ql.size===0&&Xl.size===0)for(const p of h)Kl.add(p);else for(const p of h)Xl.has(p)?Xl.delete(p):(Ql.delete(p),Kl.add(p))}const s=Fi.acquire();Xl.forEach((u=>{s.push(u)}));const n=Fi.acquire();Kl.forEach((u=>{n.push(u)}));const o=this._items,a=r.items,l=Fi.acquire();if(Ql.forEach((u=>{a.indexOf(u)!==o.indexOf(u)&&l.push(u)})),r.listeners&&(s.length||n.length||l.length)){const u={target:this,added:s,removed:n,moved:l},h=r.listeners.length;for(let p=0;p<h;p++){const m=r.listeners[p];m.removed||m.callback.call(this,u)}}Fi.release(s),Fi.release(n),Fi.release(l)}Xl.clear(),Kl.clear(),Ql.clear()}},Ga=id,id.ofType=e=>{if(!e)return Ga;if(vx.has(e))return vx.get(e);let r=null;if(typeof e=="function")r=e.prototype.declaredClass;else if(e.base)r=e.base.prototype.declaredClass;else for(const s in e.typeMap){const n=e.typeMap[s].prototype.declaredClass;r?r+=` | ${n}`:r=n}let i=class extends Ga{};return c([p3({Type:e,ensureType:typeof e=="function"?br(e):xa(e)})],i.prototype,"itemType",void 0),i=c([C(`esri.core.Collection<${r}>`)],i),vx.set(e,i),i},id);c([d()],Mu.prototype,"_updating",void 0),c([d()],Mu.prototype,"length",void 0),c([d()],Mu.prototype,"items",null),c([d({readOnly:!0})],Mu.prototype,"updating",null),Mu=Ga=c([C("esri.core.Collection")],Mu);const se=Mu;function zl(t,e,r=se){return e||(e=new r),e===t||(e.removeAll(),UQ(t)?e.addMany(t):t&&e.add(t)),e}function kV(t){return t}function UQ(t){return t&&(Array.isArray(t)||"items"in t&&Array.isArray(t.items))}let GQ=class OV{constructor(){this._values=new Map,this.multipleOriginsSupported=!1}clone(e){const r=new OV;return this._values.forEach(((i,s)=>{e&&e.has(s)||r.set(s,k(i.value),i.origin)})),r}get(e,r){r=this._normalizeOrigin(r);const i=this._values.get(e);return r==null||i?.origin===r?i?.value:void 0}originOf(e){return this._values.get(e)?.origin??xe.USER}keys(e){e=this._normalizeOrigin(e);const r=[...this._values.keys()];return e==null?r:r.filter((i=>this._values.get(i)?.origin===e))}set(e,r,i){if((i=this._normalizeOrigin(i))===xe.DEFAULTS){const s=this._values.get(e);if(s?.origin!=null&&s.origin>i)return}this._values.set(e,new BQ(r,i))}delete(e,r){(r=this._normalizeOrigin(r))!=null&&this._values.get(e)?.origin!==r||this._values.delete(e)}has(e,r){return(r=this._normalizeOrigin(r))!=null?this._values.get(e)?.origin===r:this._values.has(e)}isAtOrigin(e,r){return r=this._normalizeOrigin(r),this.has(e,r)&&this.originOf(e)===r}isBelowOrigin(e,r){return r=this._normalizeOrigin(r),!this.has(e)||this.originOf(e)<r}forEach(e){this._values.forEach((({value:r},i)=>e(r,i)))}_normalizeOrigin(e){if(e!=null)return e===xe.DEFAULTS?e:xe.USER}},BQ=class{constructor(e,r){this.value=e,this.origin=r}};function NV(t,e,r){e.keys().forEach((s=>{r.set(s,e.get(s),xe.DEFAULTS)}));const i=t.metadata;Object.keys(i).forEach((s=>{t.internalGet(s)&&r.set(s,t.internalGet(s),xe.DEFAULTS)}))}function qQ(t,e,r){if(!t?.read||t.read.enabled===!1||!t.read.source)return!1;const i=t.read.source;if(typeof i=="string"){if(i===e||i.includes(".")&&i.indexOf(e)===0&&wR(i,r))return!0}else for(const s of i)if(s===e||s.includes(".")&&s.indexOf(e)===0&&wR(s,r))return!0;return!1}function HQ(t){return t&&(!t.read||t.read.enabled!==!1&&!t.read.source)}function WQ(t,e,r,i,s){let n=OM(e[r],s);HQ(n)&&(t[r]=!0);for(const o of Object.getOwnPropertyNames(e))n=OM(e[o],s),qQ(n,r,i)&&(t[o]=!0)}function ZQ(t,e,r,i){const s=r.metadata,n=PQ(s[e],i),o=n?.default;if(o===void 0)return;const a=typeof o=="function"?o.call(t,e,i):o;a!==void 0&&r.set(e,a)}const FV={origin:"service"};function DV(t,e,r=FV){if(!e||typeof e!="object")return;const i=qi(t),s=i.metadata,n={};for(const o of Object.getOwnPropertyNames(e))WQ(n,s,o,e,r);i.setDefaultOrigin(r.origin);for(const o of Object.getOwnPropertyNames(n)){const a=OM(s[o],r).read,l=a?.source;let u;u=l&&typeof l=="string"?gv(e,l):e[o],a?.reader&&(u=a.reader.call(t,u,e,r)),u!==void 0&&i.set(o,u)}if(!r||!r.ignoreDefaults){i.setDefaultOrigin("defaults");for(const o of Object.getOwnPropertyNames(s))n[o]||ZQ(t,o,i,r)}i.setDefaultOrigin("user")}function JQ(t,e,r,i=FV){const s={...i,messages:[]};r(s),s.messages?.forEach((n=>{n.type!=="warning"||t.loaded?i?.messages&&i.messages.push(n):t.loadWarnings.push(n)}))}function YQ(t,e,r,i,s){const n={};return e.write?.writer?.call(t,i,n,r,s),n}function zV(t,e,r,i,s,n){if(!i?.write)return!1;const o=un(t,r);if(!s&&i.write.overridePolicy){const a=i.write.overridePolicy.call(t,o,r,n??void 0);a!==void 0&&(s=a)}if(s||(s=i.write),!s||s.enabled===!1||s.layerContainerTypes&&n?.layerContainerType&&!s.layerContainerTypes.includes(n.layerContainerType))return!1;if((o===null&&!s.allowNull&&!s.writerEnsuresNonNull||o===void 0)&&s.isRequired){const a=new F("web-document-write:property-required",`Missing value for required property '${r}' on '${t.declaredClass}'`,{propertyName:r,target:t});return a&&n?.messages?n.messages.push(a):a&&!n&&q.getLogger("esri.core.accessorSupport.write").error(a.name,a.message),!1}return!(o===void 0||o===null&&!s.allowNull&&!s.writerEnsuresNonNull||!s.alwaysWriteDefaults&&(!e.store.multipleOriginsSupported||e.store.originOf(r)===xe.DEFAULTS)&&XQ(t,r,n,i,o)||!s.ignoreOrigin&&n?.origin&&e.store.multipleOriginsSupported&&e.store.originOf(r)<Ml(n.origin))}function XQ(t,e,r,i,s){const n=i.default;if(n===void 0)return!1;if(i.defaultEquals!=null)return i.defaultEquals(s);if(typeof n=="function"){if(Array.isArray(s)){const o=n.call(t,e,r??void 0);return FS(o,s)}return!1}return n===s}function KQ(t,e,r,i){const s=qi(t),n=s.metadata,o=PV(n[e],i);return!!o&&zV(t,s,e,o,r,i)}function VV(t,e,r){if(t&&typeof t.toJSON=="function"&&(!t.toJSON.isDefaultToJSON||!t.write))return g1(e,t.toJSON(r));const i=qi(t),s=i.metadata;for(const n in s){const o=PV(s[n],r);if(!zV(t,i,n,o,void 0,r))continue;const a=un(t,n),l=YQ(t,o,o.write&&typeof o.write.target=="string"?o.write.target:n,a,r);Object.keys(l).length>0&&(e=g1(e,l),r?.resources?.pendingOperations?.length&&r.resources.pendingOperations.push(Promise.all(r.resources.pendingOperations).then((()=>g1(e,l,(()=>"replace-arrays"))))),r?.writtenProperties&&r.writtenProperties.push({target:t,propName:n,oldOrigin:vK(i.store.originOf(n)),newOrigin:r.origin}))}return e}const jV=t=>{let e=class extends t{constructor(...r){super(...r);const i=qi(this),s=i.store,n=new GQ;i.store=n,NV(i,s,n)}read(r,i){DV(this,r,i)}write(r,i){return VV(this,r??{},i)}toJSON(r){return this.write({},r)}static fromJSON(r,i){return QQ.call(this,r,i)}};return e=c([C("esri.core.JSONSupport")],e),e.prototype.toJSON.isDefaultToJSON=!0,e};function QQ(t,e){if(!t)return null;if(t.declaredClass)throw new Error("JSON object is already hydrated");const r=new this;return r.read(t,e),r}let jy=class extends jV(ce){};jy=c([C("esri.core.JSONSupport")],jy),(function(t){t.JSONSupportMixin=jV})(jy||(jy={}));const W=jy;var Tu;(function(t){t[t.PENDING=0]="PENDING",t[t.RESOLVED=1]="RESOLVED",t[t.REJECTED=2]="REJECTED"})(Tu||(Tu={}));let eee=class{constructor(){this._resolver=Ns(),this._status=Tu.PENDING,this._resolvingPromises=[],this._resolver.promise.then((()=>{this._status=Tu.RESOLVED,this._cleanUp()}),(()=>{this._status=Tu.REJECTED,this._cleanUp()})),this.promise=this._resolver.promise}destroy(){this._cleanUp()}addResolvingPromise(e){this._resolvingPromises.push(e),this._tryResolve()}isResolved(){return this._status===Tu.RESOLVED}isRejected(){return this._status===Tu.REJECTED}isFulfilled(){return this._status!==Tu.PENDING}abort(){this._resolver.reject(St())}_cleanUp(){this._allPromise=null,this._resolvingPromises=null}_tryResolve(){if(this.isFulfilled())return;const e=Ns(),r=[...this._resolvingPromises,e.promise],i=this._allPromise=Promise.all(r);i.then((()=>{this.isFulfilled()||this._allPromise!==i||this._resolver.resolve()}),(s=>{this.isFulfilled()||this._allPromise!==i||xi(s)||this._resolver.reject(s)})),e.resolve()}};const UV=t=>{let e=class extends t{constructor(...r){super(...r),this._promiseProps=new eee,this.addResolvingPromise(Promise.resolve())}destroy(){this._promiseProps.destroy()}isResolved(){return this._promiseProps.isResolved()}isRejected(){return this._promiseProps.isRejected()}isFulfilled(){return this._promiseProps.isFulfilled()}when(r,i){return this._promiseProps.promise.then((()=>this)).then(r,i)}catch(r){return this.when(null,r)}addResolvingPromise(r){r&&!this._promiseProps.isFulfilled()&&this._promiseProps.addResolvingPromise("_promiseProps"in r?r.when():r)}};return e=c([C("esri.core.Promise")],e),e};let Tl=class extends UV(ce){};Tl=c([C("esri.core.Promise")],Tl),(function(t){t.EsriPromiseMixin=UV})(Tl||(Tl={}));const tee="not-loaded",ree="loading",iee="failed",UR="loaded",GV=t=>{let e=class extends t{constructor(...r){super(...r),this._loadController=null,this.loadError=null,this.loadStatus="not-loaded",this._set("loadWarnings",[]),this.addResolvingPromise(new Promise((i=>{const s=this.load.bind(this);this.load=n=>{const o=new Promise(((a,l)=>{const u=XP(n,l);this.destroyed&&l(new F("load:instance-destroyed",`Instance of '${this.declaredClass||this.constructor.name}' is already destroyed`,{instance:this})),this.when(a,l).finally((()=>{u&&u.remove()}))}));if(this.loadStatus===tee){this._set("loadStatus",ree);const a=this._loadController=new AbortController;s({signal:a.signal})}return i(),o}}))),this.when((()=>{this._set("loadStatus",UR),this._loadController=null}),(i=>{this._set("loadStatus",iee),this._set("loadError",i),this._loadController=null}))}destroy(){this._loadController&&(this._loadController=im(this._loadController),this._promiseProps.abort()),this._set("loadError",null),this._set("loadWarnings",[])}get loaded(){return this.loadStatus===UR}get loadWarnings(){return this._get("loadWarnings")}load(){return null}cancelLoad(){return this.isFulfilled()||(this._set("loadError",new F("load:cancelled","Cancelled")),this._loadController?.abort(),this._promiseProps.abort()),this}};return c([d({readOnly:!0})],e.prototype,"loaded",null),c([d({readOnly:!0})],e.prototype,"loadError",void 0),c([d({clonable:!1})],e.prototype,"loadStatus",void 0),c([d({type:[Fs],readOnly:!0})],e.prototype,"loadWarnings",null),e=c([C("esri.core.Loadable")],e),e};let Ls=class extends GV(Tl){};Ls=c([C("esri.core.Loadable")],Ls),(function(t){function e(r){return!(!r||!r.load)}t.LoadableMixin=GV,t.isLoadable=e})(Ls||(Ls={}));function see(t,e,r){return KP(t.map(((i,s)=>e.apply(r,[i,s]))))}async function nee(t,e,r){return(await KP(t.map(((i,s)=>e.apply(r,[i,s]))))).map((i=>i.value))}function f3(t){return{ok:!0,value:t}}function m3(t){return{ok:!1,error:t}}function oee(t){return t!=null&&t.ok===!0?t.value:null}function aee(t){return t!=null&&t.ok===!1?t.error:null}async function JS(t){if(t==null)return{ok:!1,error:new Error("no promise provided")};try{return f3(await t)}catch(e){return m3(e)}}async function lee(t){try{return f3(await t)}catch(e){return Do(e),m3(e)}}function YS(t,e){return new cu(t,e)}let cu=class extends ce{get value(){return oee(this._result)}get error(){return aee(this._result)}get finished(){return this._result!=null}constructor(e,r){super({}),this._result=null,this._abortHandle=null,this.abort=()=>{this._abortController=im(this._abortController)},this.remove=this.abort,this._abortController=new AbortController;const{signal:i}=this._abortController;this.promise=e(i),this.promise.then((s=>{this._result=f3(s),this._cleanup()}),(s=>{this._result=m3(s),this._cleanup()})),this._abortHandle=ao(r,this.abort)}normalizeCtorArgs(){return{}}destroy(){this.abort()}_cleanup(){this._abortHandle=Lt(this._abortHandle),this._abortController=null}};c([d()],cu.prototype,"value",null),c([d()],cu.prototype,"error",null),c([d()],cu.prototype,"finished",null),c([d()],cu.prototype,"promise",void 0),c([d()],cu.prototype,"_result",void 0),cu=c([C("esri.core.asyncUtils.ReactiveTask")],cu);async function BV(t,e){return await t.load(),uee(t,e)}async function uee(t,e){const r=[],i=(...n)=>{for(const o of n)o!=null&&(Array.isArray(o)?i(...o):se.isCollection(o)?o.forEach((a=>i(a))):Ls.isLoadable(o)&&r.push(o))};e(i);let s=null;if(await nee(r,(async n=>{const o=await JS(cee(n)?n.loadAll():n.load());o.ok!==!1||s||(s=o)})),s)throw s.error;return t}function cee(t){return"loadAll"in t&&typeof t.loadAll=="function"}function re(t,e,r){let i,s;return e===void 0?(s=t,i=[void 0]):typeof e!="string"?(s=t,i=[void 0],r=e):(s=e,i=Array.isArray(t)?t:[t]),(n,o)=>{const a=n.constructor.prototype;for(const l of i){const u=u3(n,l,s);u.write&&typeof u.write=="object"||(u.write={}),r&&(u.write.target=r),u.write.writer=a[o]}}}let De=class{constructor(e,r={ignoreUnknown:!1,useNumericKeys:!1}){this._jsonToAPI=e,this._options=r,this.apiValues=[],this.jsonValues=[],this._apiToJSON=hee(e),this.apiValues=GR(this._apiToJSON),this.jsonValues=GR(this._jsonToAPI),this.read=i=>this.fromJSON(i),this.write=(i,s,n)=>{const o=this.toJSON(i);o!==void 0&&Cr(n,o,s)},this.write.isJSONMapWriter=!0}toJSON(e){if(e==null)return null;if(this._apiToJSON.hasOwnProperty(e)){const r=this._apiToJSON[e];return this._options.useNumericKeys?+r:r}return this._options.ignoreUnknown?null:e}fromJSON(e){return e!=null&&this._jsonToAPI.hasOwnProperty(e)?this._jsonToAPI[e]:this._options.ignoreUnknown?void 0:e}};function hee(t){const e={};for(const r in t)e[t[r]]=r;return e}function GR(t){const e=[];for(const r in t)e.push(r);return e.sort(),e}function Wr(){return function(t,e){return new De(t,{ignoreUnknown:!0,...e})}}let y3=class{constructor(e,r,i,s,n,o){this.semiMajorAxis=e,this.flattening=r,this.outerAtmosphereRimWidth=i,this.atmosphereHeight=s,this.scaleHeight=n;const a=1-this.flattening;this.semiMinorAxis=this.semiMajorAxis*a,this.halfSemiMajorAxis=this.semiMajorAxis/2,this.halfCircumference=Math.PI*this.semiMajorAxis,this.metersPerDegree=this.halfCircumference/180,this.inverseFlattening=1/(1-this.flattening)-1,this.eccentricitySquared=o||2*this.flattening-this.flattening*this.flattening,this.meanRadiusSemiAxes=(2*this.semiMajorAxis+this.semiMinorAxis)/3}get radius(){return this.semiMajorAxis}};const Gt=new y3(6378137,1/298.257223563,3e5,1e5,.085,.006694379990137799),_a=new y3(3396190,1/169.8944472236118,23e4,6e4,.111),oc=new y3(1737400,0,0,0,0);function Et(t){if(!Ge.assetsPath)throw q.getLogger("esri.assets").errorOnce("The API assets location needs to be set using config.assetsPath. More information: https://arcg.is/1OzLe50"),new F("assets:path-not-set","config.assetsPath is not set");return ud(Ge.assetsPath,t)}let _x,N=null;function g3(){return!!N}function dee(){return!!z("esri-wasm")}function qV(){return _x||(_x=J(()=>import("./pe-wasm-DzdsRf4N.js"),[]).then((({default:t})=>t({locateFile:e=>Et(`esri/geometry/support/${e}`)}))).then((t=>{ZV(t)})),_x)}var FM,Ct;(function(t){function e(n,o,a){N.ensureCache.prepare();const l=$h(a),u=a===l,h=N.ensureFloat64(l),p=N._pe_geog_to_proj(N.getPointer(n),o,h);return p&&Nu(a,o,h,u),p}function r(n,o,a,l){switch(l){case Ct.PE_TRANSFORM_P_TO_G:return i(n,o,a);case Ct.PE_TRANSFORM_G_TO_P:return e(n,o,a)}return 0}function i(n,o,a){return s(n,o,a,0)}function s(n,o,a,l){N.ensureCache.prepare();const u=$h(a),h=a===u,p=N.ensureFloat64(u),m=N._pe_proj_to_geog_center(N.getPointer(n),o,p,l);return m&&Nu(a,o,p,h),m}t.geogToProj=e,t.projGeog=r,t.projToGeog=i,t.projToGeogCenter=s})(FM||(FM={})),(function(t){function e(){t.PE_BUFFER_MAX=N.PeDefs.prototype.PE_BUFFER_MAX,t.PE_NAME_MAX=N.PeDefs.prototype.PE_NAME_MAX,t.PE_MGRS_MAX=N.PeDefs.prototype.PE_MGRS_MAX,t.PE_USNG_MAX=N.PeDefs.prototype.PE_USNG_MAX,t.PE_DD_MAX=N.PeDefs.prototype.PE_DD_MAX,t.PE_DDM_MAX=N.PeDefs.prototype.PE_DDM_MAX,t.PE_DMS_MAX=N.PeDefs.prototype.PE_DMS_MAX,t.PE_UTM_MAX=N.PeDefs.prototype.PE_UTM_MAX,t.PE_PARM_MAX=N.PeDefs.prototype.PE_PARM_MAX,t.PE_TYPE_NONE=N.PeDefs.prototype.PE_TYPE_NONE,t.PE_TYPE_GEOGCS=N.PeDefs.prototype.PE_TYPE_GEOGCS,t.PE_TYPE_PROJCS=N.PeDefs.prototype.PE_TYPE_PROJCS,t.PE_TYPE_GEOGTRAN=N.PeDefs.prototype.PE_TYPE_GEOGTRAN,t.PE_TYPE_COORDSYS=N.PeDefs.prototype.PE_TYPE_COORDSYS,t.PE_TYPE_UNIT=N.PeDefs.prototype.PE_TYPE_UNIT,t.PE_TYPE_LINUNIT=N.PeDefs.prototype.PE_TYPE_LINUNIT,t.PE_STR_OPTS_NONE=N.PeDefs.prototype.PE_STR_OPTS_NONE,t.PE_STR_AUTH_NONE=N.PeDefs.prototype.PE_STR_AUTH_NONE,t.PE_STR_AUTH_TOP=N.PeDefs.prototype.PE_STR_AUTH_TOP,t.PE_STR_NAME_CANON=N.PeDefs.prototype.PE_STR_NAME_CANON,t.PE_STR_FMT_WKT=N.PeDefs.prototype.PE_STR_FMT_WKT,t.PE_STR_FMT_WKT2=N.PeDefs.prototype.PE_STR_FMT_WKT2,t.PE_PARM_X0=N.PeDefs.prototype.PE_PARM_X0,t.PE_PARM_ND=N.PeDefs.prototype.PE_PARM_ND,t.PE_TRANSFORM_1_TO_2=N.PeDefs.prototype.PE_TRANSFORM_1_TO_2,t.PE_TRANSFORM_2_TO_1=N.PeDefs.prototype.PE_TRANSFORM_2_TO_1,t.PE_TRANSFORM_P_TO_G=N.PeDefs.prototype.PE_TRANSFORM_P_TO_G,t.PE_TRANSFORM_G_TO_P=N.PeDefs.prototype.PE_TRANSFORM_G_TO_P,t.PE_HORIZON_RECT=N.PeDefs.prototype.PE_HORIZON_RECT,t.PE_HORIZON_POLY=N.PeDefs.prototype.PE_HORIZON_POLY,t.PE_HORIZON_LINE=N.PeDefs.prototype.PE_HORIZON_LINE,t.PE_HORIZON_DELTA=N.PeDefs.prototype.PE_HORIZON_DELTA}t.init=e})(Ct||(Ct={}));let HV=null;var DM;(function(t){const e={},r={},i=y=>{const g=y.getType();switch(g){case Ct.PE_TYPE_GEOGCS:y=N.castObject(y,N.PeGeogcs);break;case Ct.PE_TYPE_PROJCS:y=N.castObject(y,N.PeProjcs);break;case Ct.PE_TYPE_GEOGTRAN:y=N.castObject(y,N.PeGeogtran);break;default:g&Ct.PE_TYPE_UNIT&&(y=N.castObject(y,N.PeUnit))}return y};function s(){N.PeFactory.prototype.initialize(null)}function n(y){return o(Ct.PE_TYPE_COORDSYS,y)}function o(y,g){let v=null,_=e[y];if(_||(_={},e[y]=_),_.hasOwnProperty(String(g))&&(v=_[g],N.compare(v,N.NULL)&&(v=null)),!v){const b=N.PeFactory.prototype.factoryByType(y,g);N.compare(b,N.NULL)||(v=i(b),_[g]=v)}return v}function a(y,g){let v=null,_=r[y];if(_||(_={},r[y]=_),_.hasOwnProperty(g)&&(v=_[g],N.compare(v,N.NULL)&&(v=null)),!v){const b=N.PeFactory.prototype.fromString(y,g);N.compare(b,N.NULL)||(v=i(b),_[g]=v)}return v}function l(y){return o(Ct.PE_TYPE_GEOGCS,y)}function u(y){return o(Ct.PE_TYPE_GEOGTRAN,y)}function h(y){return N.PeFactory.prototype.getCode(y)}function p(y){return o(Ct.PE_TYPE_PROJCS,y)}function m(y){return o(Ct.PE_TYPE_UNIT,y)}t.initialize=s,t.coordsys=n,t.factoryByType=o,t.fromString=a,t.geogcs=l,t.geogtran=u,t.getCode=h,t.projcs=p,t.unit=m})(DM||(DM={}));let WV=null;var uw,zM,VM,jM,UM,GM,cw,BM,hw,dw,qM;function ZV(t){function e(n,o,a){n[o]=a(n[o])}N=t,Ct.init(),uw.init(),cw.init(),hw.init(),dw.init(),HV=class extends N.PeDouble{constructor(n=NaN){super(n)}destroy(){N.destroy(this)}[Symbol.dispose](){this.destroy()}},WV=class extends N.PeGCSExtent{destroy(){N.destroy(this)}[Symbol.dispose](){this.destroy()}};const r=[N.PeAngunit,N.PeDatum,N.PeGeogcs,N.PeGeogtran,N.PeObject,N.PeParameter,N.PePrimem,N.PeProjcs,N.PeSpheroid,N.PeUnit];for(const n of r)e(n.prototype,"getName",(o=>function(){return o.call(this,new Array(Ct.PE_NAME_MAX))}));for(const n of[N.PeGeogtran,N.PeProjcs])e(n.prototype,"getParameters",(o=>function(){const a=new Array(Ct.PE_PARM_MAX);let l=o.call(this);for(let u=0;u<a.length;u++){const h=N.getValue(l,"*");a[u]=h?N.wrapPointer(h,N.PeParameter):null,l+=Int32Array.BYTES_PER_ELEMENT}return a}));e(N.PeHorizon.prototype,"getCoord",(n=>function(o=!1){const a=this.getSize();if(!a)return null;const l=[];return Nu(l,a,n.call(this),o),l})),e(N.PeGTlistExtendedEntry.prototype,"getEntries",(n=>{const o=N._pe_getPeGTlistExtendedGTsSize();return function(){let a=null;const l=n.call(this);if(!N.compare(l,N.NULL)){a=[l];const u=this.getSteps();if(u>1){const h=N.getPointer(l);for(let p=1;p<u;p++)a.push(N.wrapPointer(h+o*p,N.PeGTlistExtendedGTs))}}return a}}));const i=N._pe_getPeHorizonSize(),s=n=>function(){let o=this._cache;if(o||(o=new Map,this._cache=o),o.has(n))return o.get(n);let a=null;const l=n.call(this);if(!N.compare(l,N.NULL)){a=[l];const u=l.getNump();if(u>1){const h=N.getPointer(l);for(let p=1;p<u;p++)a.push(N.wrapPointer(h+i*p,N.PeHorizon))}}return o.set(n,a),a};e(N.PeProjcs.prototype,"horizonGcsGenerate",s),e(N.PeProjcs.prototype,"horizonPcsGenerate",s),N.PeObject.prototype.toString=function(n=Ct.PE_STR_OPTS_NONE){N.ensureCache.prepare();const o=N.getPointer(this),a=N.ensureInt8(new Array(Ct.PE_BUFFER_MAX));return N.UTF8ToString(N._pe_object_to_string_ext(o,n,a))},N.PeGeogcs.prototype.destroy=function(){this.Delete(),jn(this),this.ptr=0},N.PeGeogcs.prototype[Symbol.dispose]=function(){this.destroy()},N.PeProjcs.prototype.destroy=function(){this.Delete(),jn(this),this.ptr=0},N.PeProjcs.prototype[Symbol.dispose]=function(){this.destroy()}}function jn(t){if(!t)return;const e=N.getClass(t);if(!e)return;const r=N.getCache(e);if(!r)return;const i=N.getPointer(t);i&&delete r[i]}function s_(t,e){const r=[],i=new Array(e);for(let s=0;s<t;s++)r.push(N.ensureInt8(i));return r}function $h(t){return ArrayBuffer.isView(t)?t:Array.isArray(t[0])?t.flat():t}function Nu(t,e,r,i=!1){if(i)for(let s=0;s<2*e;s++)t[s]=N.getValue(r+s*Float64Array.BYTES_PER_ELEMENT,"double");else{const s=t.length===0;for(let n=0;n<e;n++)s&&(t[n]=new Array(2)),t[n][0]=N.getValue(r,"double"),t[n][1]=N.getValue(r+Float64Array.BYTES_PER_ELEMENT,"double"),r+=2*Float64Array.BYTES_PER_ELEMENT}}(function(t){let e;function r(){t.PE_GTLIST_OPTS_COMMON=N.PeGTlistExtended.prototype.PE_GTLIST_OPTS_COMMON,e=N._pe_getPeGTlistExtendedEntrySize()}function i(s,n,o,a,l,u){let h=null;const p=new N.PeInteger(u);try{const m=N.PeGTlistExtended.prototype.getGTlist(s,n,o,a,l,p);if((u=p.val)&&(h=[m],u>1)){const y=N.getPointer(m);for(let g=1;g<u;g++)h.push(N.wrapPointer(y+e*g,N.PeGTlistExtendedEntry))}}finally{N.destroy(p)}return h}t.init=r,t.getGTlist=i})(uw||(uw={})),(function(t){function e(r){if(r?.length){for(const i of r)jn(i),i.getEntries().forEach((s=>{jn(s);const n=s.getGeogtran();jn(n),n.getParameters().forEach(jn),[n.getGeogcs1(),n.getGeogcs2()].forEach((o=>{jn(o);const a=o.getDatum();jn(a),jn(a.getSpheroid()),jn(o.getPrimem()),jn(o.getUnit())}))}));N.PeGTlistExtendedEntry.prototype.Delete(r[0])}}t.destroy=e})(zM||(zM={})),(function(t){function e(r,i,s,n,o){N.ensureCache.prepare();const a=$h(s),l=s===a,u=N.ensureFloat64(a);let h=0;n&&(h=N.ensureFloat64(n));const p=N._pe_geog_to_geog(N.getPointer(r),i,u,h,o);return p&&Nu(s,i,u,l),p}t.geogToGeog=e})(VM||(VM={})),(function(t){function e(n,o,a,l,u,h,p,m){N.PeLineType.prototype.geodesic_coordinate(n,o,a,l,u,h,p,m)}function r(n,o,a,l,u,h,p,m,y){N.PeLineType.prototype.geodetic_coordinate(n,o,a,l,u,h,p,m,y)}function i(n,o,a,l,u,h,p,m,y,g){N.PeLineType.prototype.geodetic_distance(n,o,a,l,u,h,p,m,y,g)}function s(n,o,a,l,u,h,p,m,y){N.PeLineType.prototype.great_elliptic_distance(n,o,a,l,u,h,p,m,y)}t.geodesicCoordinate=e,t.geodeticCoordinate=r,t.geodeticDistance=i,t.greatEllipticDistance=s})(jM||(jM={})),(function(t){function e(o,a){return N.PeMath.prototype.phi_to_eta(o,a)}function r(o,a){return N.PeMath.prototype.eta_to_phi(o,a)}function i(o,a){return N.PeMath.prototype.phi_to_phig(o,a)}function s(o,a,l){return N.PeMath.prototype.q(o,a,l)}function n(o,a){return N.PeMath.prototype.q90(o,a)}t.phiToEta=e,t.etaToPhi=r,t.phiToPhig=i,t.q=s,t.q90=n})(UM||(UM={})),(function(t){const e=(u,h,p,m,y,g)=>{let v,_;switch(N.ensureCache.prepare(),u){case"dd":v=N._pe_geog_to_dd,_=Ct.PE_DD_MAX;break;case"ddm":v=N._pe_geog_to_ddm,_=Ct.PE_DDM_MAX;break;case"dms":v=N._pe_geog_to_dms,_=Ct.PE_DMS_MAX}let b=0;h&&(b=N.getPointer(h));const S=$h(m),$=N.ensureFloat64(S),T=s_(p,_),I=v(b,p,$,y,N.ensureInt32(T));if(I)for(let P=0;P<p;P++)g[P]=N.UTF8ToString(T[P]);return I},r=(u,h,p,m,y)=>{let g;switch(N.ensureCache.prepare(),u){case"dd":g=N._pe_dd_to_geog;break;case"ddm":g=N._pe_ddm_to_geog;break;case"dms":g=N._pe_dms_to_geog}let v=0;h&&(v=N.getPointer(h));const _=m.map((T=>N.ensureString(T))),b=N.ensureInt32(_),S=N.ensureFloat64(new Array(2*p)),$=g(v,p,b,S);return $&&Nu(y,p,S),$};function i(u,h,p,m,y){return e("dms",u,h,p,m,y)}function s(u,h,p,m){return r("dms",u,h,p,m)}function n(u,h,p,m,y){return e("ddm",u,h,p,m,y)}function o(u,h,p,m){return r("ddm",u,h,p,m)}function a(u,h,p,m,y){return e("dd",u,h,p,m,y)}function l(u,h,p,m){return r("dd",u,h,p,m)}t.geogToDms=i,t.dmsToGeog=s,t.geogToDdm=n,t.ddmToGeog=o,t.geogToDd=a,t.ddToGeog=l})(GM||(GM={})),(function(t){function e(){t.PE_MGRS_STYLE_NEW=N.PeNotationMgrs.prototype.PE_MGRS_STYLE_NEW,t.PE_MGRS_STYLE_OLD=N.PeNotationMgrs.prototype.PE_MGRS_STYLE_OLD,t.PE_MGRS_STYLE_AUTO=N.PeNotationMgrs.prototype.PE_MGRS_STYLE_AUTO,t.PE_MGRS_180_ZONE_1_PLUS=N.PeNotationMgrs.prototype.PE_MGRS_180_ZONE_1_PLUS,t.PE_MGRS_ADD_SPACES=N.PeNotationMgrs.prototype.PE_MGRS_ADD_SPACES}function r(s,n,o,a,l,u,h){N.ensureCache.prepare();let p=0;s&&(p=N.getPointer(s));const m=$h(o),y=N.ensureFloat64(m),g=s_(n,Ct.PE_MGRS_MAX),v=N.ensureInt32(g),_=N._pe_geog_to_mgrs_extended(p,n,y,a,l,u,v);if(_)for(let b=0;b<n;b++)h[b]=N.UTF8ToString(g[b]);return _}function i(s,n,o,a,l){N.ensureCache.prepare();let u=0;s&&(u=N.getPointer(s));const h=o.map((g=>N.ensureString(g))),p=N.ensureInt32(h),m=N.ensureFloat64(new Array(2*n)),y=N._pe_mgrs_to_geog_extended(u,n,p,a,m);return y&&Nu(l,n,m),y}t.init=e,t.geogToMgrsExtended=r,t.mgrsToGeogExtended=i})(cw||(cw={})),(function(t){function e(i,s,n,o,a,l,u){N.ensureCache.prepare();let h=0;i&&(h=N.getPointer(i));const p=$h(n),m=N.ensureFloat64(p),y=s_(s,Ct.PE_MGRS_MAX),g=N.ensureInt32(y),v=N._pe_geog_to_usng(h,s,m,o,a,l,g);if(v)for(let _=0;_<s;_++)u[_]=N.UTF8ToString(y[_]);return v}function r(i,s,n,o){N.ensureCache.prepare();let a=0;i&&(a=N.getPointer(i));const l=n.map((m=>N.ensureString(m))),u=N.ensureInt32(l),h=N.ensureFloat64(new Array(2*s)),p=N._pe_usng_to_geog(a,s,u,h);return p&&Nu(o,s,h),p}t.geogToUsng=e,t.usngToGeog=r})(BM||(BM={})),(function(t){function e(){t.PE_UTM_OPTS_NONE=N.PeNotationUtm.prototype.PE_UTM_OPTS_NONE,t.PE_UTM_OPTS_ADD_SPACES=N.PeNotationUtm.prototype.PE_UTM_OPTS_ADD_SPACES,t.PE_UTM_OPTS_NS=N.PeNotationUtm.prototype.PE_UTM_OPTS_NS}function r(s,n,o,a,l){N.ensureCache.prepare();let u=0;s&&(u=N.getPointer(s));const h=$h(o),p=N.ensureFloat64(h),m=s_(n,Ct.PE_UTM_MAX),y=N.ensureInt32(m),g=N._pe_geog_to_utm(u,n,p,a,y);if(g)for(let v=0;v<n;v++)l[v]=N.UTF8ToString(m[v]);return g}function i(s,n,o,a,l){N.ensureCache.prepare();let u=0;s&&(u=N.getPointer(s));const h=o.map((g=>N.ensureString(g))),p=N.ensureInt32(h),m=N.ensureFloat64(new Array(2*n)),y=N._pe_utm_to_geog(u,n,p,a,m);return y&&Nu(l,n,m),y}t.init=e,t.geogToUtm=r,t.utmToGeog=i})(hw||(hw={})),(function(t){const e=new Map;function r(){t.PE_PCSINFO_OPTION_NONE=N.PePCSInfo.prototype.PE_PCSINFO_OPTION_NONE,t.PE_PCSINFO_OPTION_DOMAIN=N.PePCSInfo.prototype.PE_PCSINFO_OPTION_DOMAIN,t.PE_POLE_OUTSIDE_BOUNDARY=N.PePCSInfo.prototype.PE_POLE_OUTSIDE_BOUNDARY,t.PE_POLE_POINT=N.PePCSInfo.prototype.PE_POLE_POINT}function i(s,n=t.PE_PCSINFO_OPTION_DOMAIN){let o=null,a=null;return e.has(s)&&(a=e.get(s),a[n]&&(o=a[n])),o||(o=N.PePCSInfo.prototype.generate(s,n),a||(a=[],e.set(s,a)),a[n]=o),o}t.init=r,t.generate=i})(dw||(dw={})),(function(t){function e(){return N.PeVersion.prototype.version_string()}t.versionString=e})(qM||(qM={}));const pee=Object.freeze(Object.defineProperty({__proto__:null,get PeCSTransformations(){return FM},get PeDefs(){return Ct},get PeDouble(){return HV},get PeFactory(){return DM},get PeGCSExtent(){return WV},get PeGTTransformations(){return VM},get PeGTlistExtended(){return uw},get PeGTlistExtendedEntry(){return zM},get PeLineType(){return jM},get PeMath(){return UM},get PeNotationDms(){return GM},get PeNotationMgrs(){return cw},get PeNotationUsng(){return BM},get PeNotationUtm(){return hw},get PePCSInfo(){return dw},get PeVersion(){return qM},_init:ZV,get _pe(){return N},isLoaded:g3,isSupported:dee,load:qV},Symbol.toStringTag,{value:"Module"}));var pd;(function(t){t[t.CGCS2000=4490]="CGCS2000",t[t.GCSMARS2000=104971]="GCSMARS2000",t[t.GCSMARS2000_SPHERE=104905]="GCSMARS2000_SPHERE",t[t.GCSMOON2000=104903]="GCSMOON2000"})(pd||(pd={}));let f;const E={values:[1,.3048,.3048006096012192,.3047972654,.9143917962,.201166195164,.9143984146160287,.3047994715386762,20.11676512155263,20.11678249437587,.9143985307444408,.91439523,.3047997101815088,20.1168,20.116756,5e4,15e4],units:["Meter","Foot","Foot_US","Foot_Clarke","Yard_Clarke","Link_Clarke","Yard_Sears","Foot_Sears","Chain_Sears","Chain_Benoit_1895_B","Yard_Indian","Yard_Indian_1937","Foot_Gold_Coast","Chain","Chain_Sears_1922_Truncated","50_Kilometers","150_Kilometers"],2066:5,2136:12,2155:2,2157:0,2158:0,2159:12,2160:12,2204:2,2219:0,2220:0,2254:2,2255:2,2256:1,2265:1,2266:1,2267:2,2268:2,2269:1,2270:1,2271:2,2272:2,2273:1,2294:0,2295:0,2314:3,2899:2,2900:2,2901:1,2909:1,2910:1,2911:2,2912:2,2913:1,2914:1,2992:1,2993:0,2994:1,3080:1,3089:2,3090:0,3091:2,3102:2,3141:0,3142:0,3167:14,3359:2,3360:0,3361:1,3362:0,3363:2,3364:0,3365:2,3366:3,3404:2,3405:0,3406:0,3407:3,3439:0,3440:0,3479:1,3480:0,3481:1,3482:0,3483:1,3484:0,3485:2,3486:0,3487:2,3488:0,3489:0,3490:2,3491:0,3492:2,3493:0,3494:2,3495:0,3496:2,3497:0,3498:2,3499:0,3500:2,3501:0,3502:2,3503:0,3504:2,3505:0,3506:2,3507:0,3508:2,3509:0,3510:2,3511:0,3512:2,3513:0,3514:0,3515:2,3516:0,3517:2,3518:0,3519:2,3520:0,3521:2,3522:0,3523:2,3524:0,3525:2,3526:0,3527:2,3528:0,3529:2,3530:0,3531:2,3532:0,3533:2,3534:0,3535:2,3536:0,3537:2,3538:0,3539:2,3540:0,3541:2,3542:0,3543:2,3544:0,3545:2,3546:0,3547:2,3548:0,3549:2,3550:0,3551:2,3552:0,3553:2,3582:2,3583:0,3584:2,3585:0,3586:2,3587:0,3588:1,3589:0,3590:1,3591:0,3592:0,3593:1,3598:2,3599:0,3600:2,3605:1,3606:0,3607:0,3608:2,3609:0,3610:2,3611:0,3612:2,3613:0,3614:2,3615:0,3616:2,3617:0,3618:2,3619:0,3620:2,3621:0,3622:2,3623:0,3624:2,3625:0,3626:2,3627:0,3628:2,3629:0,3630:2,3631:0,3632:2,3633:0,3634:1,3635:0,3636:1,3640:2,3641:0,3642:2,3643:0,3644:1,3645:0,3646:1,3647:0,3648:1,3649:0,3650:2,3651:0,3652:2,3653:0,3654:2,3655:0,3656:1,3657:0,3658:2,3659:0,3660:2,3661:0,3662:2,3663:0,3664:2,3668:2,3669:0,3670:2,3671:0,3672:2,3673:0,3674:2,3675:0,3676:1,3677:2,3678:0,3679:1,3680:2,3681:0,3682:1,3683:2,3684:0,3685:0,3686:2,3687:0,3688:2,3689:0,3690:2,3691:0,3692:2,3696:2,3697:0,3698:2,3699:0,3700:2,3793:0,3794:0,3812:0,3854:0,3857:0,3920:0,3978:0,3979:0,3991:2,3992:2,4026:0,4037:0,4038:0,4071:0,4082:0,4083:0,4087:0,4088:0,4217:2,4414:0,4415:0,4417:0,4434:0,4437:0,4438:2,4439:2,4462:0,4467:0,4471:0,4474:0,4559:0,4647:0,4822:0,4826:0,4839:0,5018:0,5041:0,5042:0,5048:0,5221:0,5223:0,5234:0,5235:0,5243:0,5247:0,5266:0,5316:0,5320:0,5321:0,5325:0,5337:0,5361:0,5362:0,5367:0,5382:0,5383:0,5396:0,5456:0,5457:0,5469:0,5472:4,5490:0,5513:0,5514:0,5523:0,5559:0,5588:1,5589:3,5596:0,5627:0,5629:0,5641:0,5643:0,5644:0,5646:2,5654:2,5655:2,5659:0,5700:0,5825:0,5836:0,5837:0,5839:0,5842:0,5844:0,5858:0,5879:0,5880:0,5887:0,5890:0,6128:1,6129:1,6141:1,6204:0,6210:0,6211:0,6307:0,6312:0,6316:0,6362:0,6391:1,6405:1,6406:0,6407:1,6408:0,6409:1,6410:0,6411:2,6412:0,6413:2,6414:0,6415:0,6416:2,6417:0,6418:2,6419:0,6420:2,6421:0,6422:2,6423:0,6424:2,6425:0,6426:2,6427:0,6428:2,6429:0,6430:2,6431:0,6432:2,6433:0,6434:2,6435:0,6436:2,6437:0,6438:2,6439:0,6440:0,6441:2,6442:0,6443:2,6444:0,6445:2,6446:0,6447:2,6448:0,6449:2,6450:0,6451:2,6452:0,6453:2,6454:0,6455:2,6456:0,6457:2,6458:0,6459:2,6460:0,6461:2,6462:0,6463:2,6464:0,6465:2,6466:0,6467:2,6468:0,6469:2,6470:0,6471:2,6472:0,6473:2,6474:0,6475:2,6476:0,6477:2,6478:0,6479:2,6484:2,6485:0,6486:2,6487:0,6488:2,6489:0,6490:2,6491:0,6492:2,6493:0,6494:1,6495:0,6496:1,6497:0,6498:0,6499:1,6500:0,6501:2,6502:0,6503:2,6504:0,6505:2,6506:0,6507:2,6508:0,6509:0,6510:2,6515:1,6516:0,6518:0,6519:2,6520:0,6521:2,6522:0,6523:2,6524:0,6525:2,6526:0,6527:2,6528:0,6529:2,6530:0,6531:2,6532:0,6533:2,6534:0,6535:2,6536:0,6537:2,6538:0,6539:2,6540:0,6541:2,6542:0,6543:2,6544:0,6545:1,6546:0,6547:1,6548:0,6549:2,6550:0,6551:2,6552:0,6553:2,6554:0,6555:2,6556:0,6557:1,6558:0,6559:1,6560:0,6561:1,6562:0,6563:2,6564:0,6565:2,6566:0,6567:0,6568:2,6569:0,6570:1,6571:0,6572:2,6573:0,6574:2,6575:0,6576:2,6577:0,6578:2,6582:2,6583:0,6584:2,6585:0,6586:2,6587:0,6588:2,6589:0,6590:2,6591:0,6592:0,6593:2,6594:0,6595:2,6596:0,6597:2,6598:0,6599:2,6600:0,6601:2,6602:0,6603:2,6605:2,6606:0,6607:2,6608:0,6609:2,6610:0,6611:0,6612:2,6613:0,6614:2,6615:0,6616:2,6617:0,6618:2,6633:2,6646:0,6703:0,6784:0,6785:1,6786:0,6787:1,6788:0,6789:1,6790:0,6791:1,6792:0,6793:1,6794:0,6795:1,6796:0,6797:1,6798:0,6799:1,6800:0,6801:1,6802:0,6803:1,6804:0,6805:1,6806:0,6807:1,6808:0,6809:1,6810:0,6811:1,6812:0,6813:1,6814:0,6815:1,6816:0,6817:1,6818:0,6819:1,6820:0,6821:1,6822:0,6823:1,6824:0,6825:1,6826:0,6827:1,6828:0,6829:1,6830:0,6831:1,6832:0,6833:1,6834:0,6835:1,6836:0,6837:1,6838:0,6839:1,6840:0,6841:1,6842:0,6843:1,6844:0,6845:1,6846:0,6847:1,6848:0,6849:1,6850:0,6851:1,6852:0,6853:1,6854:0,6855:1,6856:0,6857:1,6858:0,6859:1,6860:0,6861:1,6862:0,6863:1,6867:0,6868:1,6870:0,6875:0,6876:0,6879:0,6880:2,6884:0,6885:1,6886:0,6887:1,6915:0,6922:0,6923:2,6924:0,6925:2,6962:0,6984:0,6991:0,7128:2,7131:0,7132:2,7142:0,7257:0,7258:2,7259:0,7260:2,7261:0,7262:2,7263:0,7264:2,7265:0,7266:2,7267:0,7268:2,7269:0,7270:2,7271:0,7272:2,7273:0,7274:2,7275:0,7276:2,7277:0,7278:2,7279:0,7280:2,7281:0,7282:2,7283:0,7284:2,7285:0,7286:2,7287:0,7288:2,7289:0,7290:2,7291:0,7292:2,7293:0,7294:2,7295:0,7296:2,7297:0,7298:2,7299:0,7300:2,7301:0,7302:2,7303:0,7304:2,7305:0,7306:2,7307:0,7308:2,7309:0,7310:2,7311:0,7312:2,7313:0,7314:2,7315:0,7316:2,7317:0,7318:2,7319:0,7320:2,7321:0,7322:2,7323:0,7324:2,7325:0,7326:2,7327:0,7328:2,7329:0,7330:2,7331:0,7332:2,7333:0,7334:2,7335:0,7336:2,7337:0,7338:2,7339:0,7340:2,7341:0,7342:2,7343:0,7344:2,7345:0,7346:2,7347:0,7348:2,7349:0,7350:2,7351:0,7352:2,7353:0,7354:2,7355:0,7356:2,7357:0,7358:2,7359:0,7360:2,7361:0,7362:2,7363:0,7364:2,7365:0,7366:2,7367:0,7368:2,7369:0,7370:2,7877:0,7878:0,7882:0,7883:0,7887:0,7899:0,7991:0,7992:0,8035:2,8036:2,8058:0,8059:0,8082:0,8083:0,8088:0,8090:0,8091:2,8092:0,8093:2,8095:0,8096:2,8097:0,8098:2,8099:0,8100:2,8101:0,8102:2,8103:0,8104:2,8105:0,8106:2,8107:0,8108:2,8109:0,8110:2,8111:0,8112:2,8113:0,8114:2,8115:0,8116:2,8117:0,8118:2,8119:0,8120:2,8121:0,8122:2,8123:0,8124:2,8125:0,8126:2,8127:0,8128:2,8129:0,8130:2,8131:0,8132:2,8133:0,8134:2,8135:0,8136:2,8137:0,8138:2,8139:0,8140:2,8141:0,8142:2,8143:0,8144:2,8145:0,8146:2,8147:0,8148:2,8149:0,8150:2,8151:0,8152:2,8153:0,8154:2,8155:0,8156:2,8157:0,8158:2,8159:0,8160:2,8161:0,8162:2,8163:0,8164:2,8165:0,8166:2,8167:0,8168:2,8169:0,8170:2,8171:0,8172:2,8173:0,8177:2,8179:0,8180:2,8181:0,8182:2,8184:0,8185:2,8187:0,8189:2,8191:0,8193:2,8196:0,8197:2,8198:0,8200:2,8201:0,8202:2,8203:0,8204:2,8205:0,8206:2,8207:0,8208:2,8209:0,8210:2,8212:0,8213:2,8214:0,8216:2,8218:0,8220:2,8222:0,8224:2,8225:0,8226:2,8311:0,8312:1,8313:0,8314:1,8315:0,8316:1,8317:0,8318:1,8319:0,8320:1,8321:0,8322:1,8323:0,8324:1,8325:0,8326:1,8327:0,8328:1,8329:0,8330:1,8331:0,8332:1,8333:0,8334:1,8335:0,8336:1,8337:0,8338:1,8339:0,8340:1,8341:0,8342:1,8343:0,8344:1,8345:0,8346:1,8347:0,8348:1,8352:0,8353:0,8379:0,8380:2,8381:0,8382:2,8383:0,8384:2,8385:0,8387:2,8391:0,8395:0,8433:0,8441:0,8455:0,8456:0,8531:2,8682:0,8686:0,8687:0,8692:0,8693:0,8826:0,8903:0,8950:0,8951:0,9039:0,9040:0,9141:0,9149:0,9150:0,9191:0,9221:0,9222:0,9249:0,9250:0,9252:0,9254:0,9265:0,9284:0,9285:0,9300:0,9354:0,9367:0,9373:0,9377:0,9387:0,9391:0,9456:0,9473:0,9498:0,9674:0,9678:0,9680:0,9709:0,9712:0,9713:0,9716:0,9741:0,9748:2,9749:2,9761:0,9766:0,9793:0,9794:0,9869:0,9874:0,9875:0,9880:0,9895:0,9943:0,9945:0,9947:0,9967:0,9972:0,9977:0,10160:0,10183:0,10188:0,10194:0,10199:0,10207:0,10212:0,10217:0,10222:0,10227:0,10235:0,10240:0,10250:0,10254:0,10270:0,10275:0,10280:0,10306:0,10329:0,10471:0,10477:0,10481:2,10516:2,10592:0,10594:0,10596:0,10598:0,10601:0,10603:0,10626:0,10632:0,10641:0,10665:0,10674:0,10744:0,10745:0,10759:0,10773:0,10802:0,10820:0,20002:0,20042:0,20050:1,20499:0,20538:0,20539:0,20790:0,20791:0,21291:0,21292:0,21500:0,21817:0,21818:0,22032:0,22033:0,22091:0,22092:0,22239:0,22240:0,22332:0,22337:0,22338:0,22391:0,22392:0,22639:0,22700:0,22739:0,22770:0,22780:0,22832:0,23090:0,23095:0,23239:0,23240:0,23433:0,23700:0,24047:0,24048:0,24100:3,24200:0,24305:0,24306:0,24382:10,24383:0,24500:0,24547:0,24548:0,24571:9,24600:0,25e3:0,25231:0,25884:0,25932:0,26237:0,26331:0,26332:0,26432:0,26591:0,26592:0,26632:0,26692:0,27120:0,27200:0,27291:6,27292:6,27429:0,27492:0,27493:0,27500:0,28232:0,28600:0,28991:0,28992:0,29100:0,29101:0,29220:0,29221:0,29333:0,29635:0,29636:0,29701:0,29738:0,29739:0,29849:0,29850:0,29871:8,29872:7,29873:0,29874:0,30200:5,30339:0,30340:0,30591:0,30592:0,30791:0,30792:0,30800:0,31028:0,31121:0,31154:0,31170:0,31171:0,31370:0,31528:0,31529:0,31600:0,31700:0,31838:0,31839:0,31900:0,31901:0,32061:0,32062:0,32098:0,32099:2,32100:0,32104:0,32161:0,32766:0,53048:0,53049:0,65061:2,65062:2,102041:2,102064:11,102068:15,102069:16,102118:2,102119:1,102120:2,102121:2,102217:2,102218:0,102219:2,102220:2,102378:1,102379:1,102380:0,102381:1,102589:2,102599:2,102600:2,102604:2,102647:0,102704:2,102705:2,102706:0,102731:0,102732:0,102759:1,102760:1,102761:2,102762:0,102763:2,102764:0,102765:0,102766:2,102970:1,102974:2,102993:0,102994:0,102995:2,102996:2,103015:0,103016:2,103017:0,103018:2,103025:0,103026:0,103027:2,103028:2,103035:0,103036:0,103037:2,103038:2,103039:0,103040:0,103041:2,103042:2,103043:0,103044:0,103045:2,103046:2,103047:0,103048:0,103049:2,103050:2,103051:0,103052:2,103053:0,103054:2,103055:0,103056:2,103057:0,103058:0,103059:2,103060:2,103061:0,103062:0,103063:2,103064:2,103069:2,103070:0,103071:0,103072:2,103073:2,103086:0,103087:0,103088:2,103089:2,103094:1,103095:0,103096:2,103103:0,103104:2,103105:0,103106:2,103121:0,103122:2,103123:0,103124:0,103125:1,103126:1,103127:0,103128:0,103129:2,103130:2,103131:0,103132:0,103133:2,103134:2,103135:0,103136:0,103137:1,103138:1,103139:0,103140:2,103141:0,103142:2,103143:0,103144:2,103145:0,103146:1,103147:0,103148:0,103149:2,103150:2,103151:0,103152:2,103172:0,103173:2,103174:0,103175:0,103176:2,103177:2,103178:0,103179:0,103180:2,103181:2,103182:0,103183:0,103184:2,103185:2,103228:0,103229:0,103230:2,103231:2,103250:0,103251:2,103252:0,103253:2,103260:0,103261:0,103262:2,103263:2,103270:0,103271:0,103272:2,103273:2,103274:0,103275:0,103276:2,103277:2,103278:0,103279:0,103280:2,103281:2,103282:0,103283:0,103284:2,103285:2,103286:0,103287:2,103288:0,103289:2,103290:0,103291:2,103292:0,103293:0,103294:2,103295:2,103296:0,103297:0,103298:2,103299:2,103376:2,103377:0,103378:0,103379:2,103380:2,103393:0,103394:0,103395:2,103396:2,103472:0,103473:1,103474:0,103475:2,103482:0,103483:2,103484:0,103485:2,103500:0,103501:2,103502:0,103503:0,103504:1,103505:1,103506:0,103507:0,103508:2,103509:2,103510:0,103511:0,103512:2,103513:2,103514:0,103515:2,103516:0,103517:2,103518:0,103519:2,103520:0,103521:1,103522:0,103523:0,103524:2,103525:2,103526:0,103527:2,103561:2,103562:2,103563:0,103564:0,103565:2,103566:2,103567:0,103568:0,103569:2,103570:2,103584:0,103585:2,103586:0,103587:2,103588:1,103589:0,103590:2,103591:1,103592:0,103593:2,103594:1,103695:2,103897:1,103978:2,103979:0,103980:2,103981:0};for(f=2e3;f<=2045;f++)E[f]=0;for(f=2056;f<=2065;f++)E[f]=0;for(f=2067;f<=2135;f++)E[f]=0;for(f=2137;f<=2154;f++)E[f]=0;for(f=2161;f<=2170;f++)E[f]=0;for(f=2172;f<=2193;f++)E[f]=0;for(f=2195;f<=2198;f++)E[f]=0;for(f=2200;f<=2203;f++)E[f]=0;for(f=2205;f<=2217;f++)E[f]=0;for(f=2222;f<=2224;f++)E[f]=1;for(f=2225;f<=2250;f++)E[f]=2;for(f=2251;f<=2253;f++)E[f]=1;for(f=2257;f<=2264;f++)E[f]=2;for(f=2274;f<=2279;f++)E[f]=2;for(f=2280;f<=2282;f++)E[f]=1;for(f=2283;f<=2289;f++)E[f]=2;for(f=2290;f<=2292;f++)E[f]=0;for(f=2308;f<=2313;f++)E[f]=0;for(f=2315;f<=2491;f++)E[f]=0;for(f=2494;f<=2866;f++)E[f]=0;for(f=2867;f<=2869;f++)E[f]=1;for(f=2870;f<=2888;f++)E[f]=2;for(f=2891;f<=2895;f++)E[f]=2;for(f=2896;f<=2898;f++)E[f]=1;for(f=2902;f<=2908;f++)E[f]=2;for(f=2915;f<=2920;f++)E[f]=2;for(f=2921;f<=2923;f++)E[f]=1;for(f=2924;f<=2930;f++)E[f]=2;for(f=2931;f<=2962;f++)E[f]=0;for(f=2964;f<=2968;f++)E[f]=2;for(f=2969;f<=2973;f++)E[f]=0;for(f=2975;f<=2991;f++)E[f]=0;for(f=2995;f<=3051;f++)E[f]=0;for(f=3054;f<=3079;f++)E[f]=0;for(f=3081;f<=3088;f++)E[f]=0;for(f=3092;f<=3101;f++)E[f]=0;for(f=3106;f<=3138;f++)E[f]=0;for(f=3146;f<=3151;f++)E[f]=0;for(f=3153;f<=3166;f++)E[f]=0;for(f=3168;f<=3172;f++)E[f]=0;for(f=3174;f<=3203;f++)E[f]=0;for(f=3294;f<=3358;f++)E[f]=0;for(f=3367;f<=3403;f++)E[f]=0;for(f=3408;f<=3416;f++)E[f]=0;for(f=3417;f<=3438;f++)E[f]=2;for(f=3441;f<=3446;f++)E[f]=2;for(f=3447;f<=3450;f++)E[f]=0;for(f=3451;f<=3459;f++)E[f]=2;for(f=3460;f<=3478;f++)E[f]=0;for(f=3554;f<=3559;f++)E[f]=0;for(f=3560;f<=3570;f++)E[f]=2;for(f=3571;f<=3581;f++)E[f]=0;for(f=3594;f<=3597;f++)E[f]=0;for(f=3601;f<=3604;f++)E[f]=0;for(f=3637;f<=3639;f++)E[f]=0;for(f=3665;f<=3667;f++)E[f]=0;for(f=3693;f<=3695;f++)E[f]=0;for(f=3701;f<=3727;f++)E[f]=0;for(f=3728;f<=3739;f++)E[f]=2;for(f=3740;f<=3751;f++)E[f]=0;for(f=3753;f<=3760;f++)E[f]=2;for(f=3761;f<=3773;f++)E[f]=0;for(f=3775;f<=3777;f++)E[f]=0;for(f=3779;f<=3781;f++)E[f]=0;for(f=3783;f<=3785;f++)E[f]=0;for(f=3788;f<=3791;f++)E[f]=0;for(f=3797;f<=3802;f++)E[f]=0;for(f=3814;f<=3816;f++)E[f]=0;for(f=3825;f<=3829;f++)E[f]=0;for(f=3832;f<=3841;f++)E[f]=0;for(f=3844;f<=3852;f++)E[f]=0;for(f=3873;f<=3885;f++)E[f]=0;for(f=3890;f<=3893;f++)E[f]=0;for(f=3907;f<=3912;f++)E[f]=0;for(f=3942;f<=3950;f++)E[f]=0;for(f=3968;f<=3970;f++)E[f]=0;for(f=3973;f<=3976;f++)E[f]=0;for(f=3986;f<=3989;f++)E[f]=0;for(f=3994;f<=3997;f++)E[f]=0;for(f=4048;f<=4051;f++)E[f]=0;for(f=4056;f<=4063;f++)E[f]=0;for(f=4093;f<=4096;f++)E[f]=0;for(f=4390;f<=4398;f++)E[f]=0;for(f=4399;f<=4413;f++)E[f]=2;for(f=4418;f<=4433;f++)E[f]=2;for(f=4455;f<=4457;f++)E[f]=2;for(f=4484;f<=4489;f++)E[f]=0;for(f=4491;f<=4554;f++)E[f]=0;for(f=4568;f<=4589;f++)E[f]=0;for(f=4652;f<=4656;f++)E[f]=0;for(f=4766;f<=4800;f++)E[f]=0;for(f=5014;f<=5016;f++)E[f]=0;for(f=5069;f<=5072;f++)E[f]=0;for(f=5105;f<=5130;f++)E[f]=0;for(f=5167;f<=5188;f++)E[f]=0;for(f=5253;f<=5259;f++)E[f]=0;for(f=5269;f<=5275;f++)E[f]=0;for(f=5292;f<=5311;f++)E[f]=0;for(f=5329;f<=5331;f++)E[f]=0;for(f=5343;f<=5349;f++)E[f]=0;for(f=5355;f<=5357;f++)E[f]=0;for(f=5387;f<=5389;f++)E[f]=0;for(f=5459;f<=5463;f++)E[f]=0;for(f=5479;f<=5482;f++)E[f]=0;for(f=5518;f<=5520;f++)E[f]=0;for(f=5530;f<=5539;f++)E[f]=0;for(f=5550;f<=5552;f++)E[f]=0;for(f=5562;f<=5583;f++)E[f]=0;for(f=5623;f<=5625;f++)E[f]=2;for(f=5631;f<=5639;f++)E[f]=0;for(f=5649;f<=5653;f++)E[f]=0;for(f=5663;f<=5680;f++)E[f]=0;for(f=5682;f<=5685;f++)E[f]=0;for(f=5875;f<=5877;f++)E[f]=0;for(f=5896;f<=5899;f++)E[f]=0;for(f=5921;f<=5940;f++)E[f]=0;for(f=6050;f<=6125;f++)E[f]=0;for(f=6244;f<=6275;f++)E[f]=0;for(f=6328;f<=6348;f++)E[f]=0;for(f=6350;f<=6356;f++)E[f]=0;for(f=6366;f<=6372;f++)E[f]=0;for(f=6381;f<=6387;f++)E[f]=0;for(f=6393;f<=6404;f++)E[f]=0;for(f=6480;f<=6483;f++)E[f]=0;for(f=6511;f<=6514;f++)E[f]=0;for(f=6579;f<=6581;f++)E[f]=0;for(f=6619;f<=6624;f++)E[f]=0;for(f=6625;f<=6627;f++)E[f]=2;for(f=6628;f<=6632;f++)E[f]=0;for(f=6634;f<=6637;f++)E[f]=0;for(f=6669;f<=6692;f++)E[f]=0;for(f=6707;f<=6709;f++)E[f]=0;for(f=6720;f<=6723;f++)E[f]=0;for(f=6732;f<=6738;f++)E[f]=0;for(f=6931;f<=6933;f++)E[f]=0;for(f=6956;f<=6959;f++)E[f]=0;for(f=7005;f<=7007;f++)E[f]=0;for(f=7057;f<=7070;f++)E[f]=2;for(f=7074;f<=7082;f++)E[f]=0;for(f=7109;f<=7118;f++)E[f]=0;for(f=7119;f<=7127;f++)E[f]=1;for(f=7374;f<=7376;f++)E[f]=0;for(f=7528;f<=7586;f++)E[f]=0;for(f=7587;f<=7645;f++)E[f]=2;for(f=7692;f<=7696;f++)E[f]=0;for(f=7755;f<=7787;f++)E[f]=0;for(f=7791;f<=7795;f++)E[f]=0;for(f=7799;f<=7801;f++)E[f]=0;for(f=7803;f<=7805;f++)E[f]=0;for(f=7825;f<=7831;f++)E[f]=0;for(f=7845;f<=7859;f++)E[f]=0;for(f=8013;f<=8032;f++)E[f]=0;for(f=8065;f<=8068;f++)E[f]=1;for(f=8518;f<=8529;f++)E[f]=2;for(f=8533;f<=8536;f++)E[f]=2;for(f=8538;f<=8540;f++)E[f]=2;for(f=8677;f<=8679;f++)E[f]=0;for(f=8836;f<=8840;f++)E[f]=0;for(f=8857;f<=8859;f++)E[f]=0;for(f=8908;f<=8910;f++)E[f]=0;for(f=9154;f<=9159;f++)E[f]=0;for(f=9205;f<=9218;f++)E[f]=0;for(f=9271;f<=9273;f++)E[f]=0;for(f=9295;f<=9297;f++)E[f]=0;for(f=9356;f<=9360;f++)E[f]=0;for(f=9404;f<=9407;f++)E[f]=0;for(f=9476;f<=9482;f++)E[f]=0;for(f=9487;f<=9494;f++)E[f]=0;for(f=9697;f<=9699;f++)E[f]=0;for(f=9821;f<=9865;f++)E[f]=0;for(f=10285;f<=10291;f++)E[f]=0;for(f=10314;f<=10317;f++)E[f]=0;for(f=10448;f<=10465;f++)E[f]=0;for(f=10726;f<=10729;f++)E[f]=0;for(f=10731;f<=10733;f++)E[f]=0;for(f=11114;f<=11118;f++)E[f]=0;for(f=20004;f<=20032;f++)E[f]=0;for(f=20047;f<=20049;f++)E[f]=0;for(f=20062;f<=20092;f++)E[f]=0;for(f=20135;f<=20138;f++)E[f]=0;for(f=20248;f<=20258;f++)E[f]=0;for(f=20348;f<=20358;f++)E[f]=0;for(f=20436;f<=20440;f++)E[f]=0;for(f=20822;f<=20824;f++)E[f]=0;for(f=20904;f<=20932;f++)E[f]=0;for(f=20934;f<=20936;f++)E[f]=0;for(f=21004;f<=21032;f++)E[f]=0;for(f=21035;f<=21037;f++)E[f]=0;for(f=21095;f<=21097;f++)E[f]=0;for(f=21148;f<=21150;f++)E[f]=0;for(f=21207;f<=21264;f++)E[f]=0;for(f=21307;f<=21364;f++)E[f]=0;for(f=21413;f<=21423;f++)E[f]=0;for(f=21453;f<=21463;f++)E[f]=0;for(f=21473;f<=21483;f++)E[f]=0;for(f=21780;f<=21782;f++)E[f]=0;for(f=21891;f<=21894;f++)E[f]=0;for(f=21896;f<=21899;f++)E[f]=0;for(f=22171;f<=22177;f++)E[f]=0;for(f=22181;f<=22187;f++)E[f]=0;for(f=22191;f<=22197;f++)E[f]=0;for(f=22207;f<=22222;f++)E[f]=0;for(f=22229;f<=22232;f++)E[f]=0;for(f=22234;f<=22236;f++)E[f]=0;for(f=22243;f<=22250;f++)E[f]=0;for(f=22262;f<=22265;f++)E[f]=0;for(f=22307;f<=22322;f++)E[f]=0;for(f=22348;f<=22357;f++)E[f]=0;for(f=22407;f<=22422;f++)E[f]=0;for(f=22462;f<=22465;f++)E[f]=0;for(f=22521;f<=22525;f++)E[f]=0;for(f=22607;f<=22622;f++)E[f]=0;for(f=22641;f<=22646;f++)E[f]=0;for(f=22648;f<=22657;f++)E[f]=0;for(f=22707;f<=22722;f++)E[f]=0;for(f=22762;f<=22765;f++)E[f]=0;for(f=22807;f<=22822;f++)E[f]=0;for(f=22991;f<=22994;f++)E[f]=0;for(f=23028;f<=23038;f++)E[f]=0;for(f=23301;f<=23333;f++)E[f]=2;for(f=23830;f<=23853;f++)E[f]=0;for(f=23866;f<=23872;f++)E[f]=0;for(f=23877;f<=23884;f++)E[f]=0;for(f=23886;f<=23894;f++)E[f]=0;for(f=23946;f<=23948;f++)E[f]=0;for(f=24311;f<=24313;f++)E[f]=0;for(f=24342;f<=24347;f++)E[f]=0;for(f=24370;f<=24374;f++)E[f]=10;for(f=24375;f<=24381;f++)E[f]=0;for(f=24718;f<=24721;f++)E[f]=0;for(f=24817;f<=24821;f++)E[f]=0;for(f=24877;f<=24882;f++)E[f]=0;for(f=24891;f<=24893;f++)E[f]=0;for(f=25391;f<=25395;f++)E[f]=0;for(f=25828;f<=25838;f++)E[f]=0;for(f=26191;f<=26195;f++)E[f]=0;for(f=26391;f<=26393;f++)E[f]=0;for(f=26701;f<=26722;f++)E[f]=0;for(f=26729;f<=26799;f++)E[f]=2;for(f=26801;f<=26803;f++)E[f]=2;for(f=26811;f<=26813;f++)E[f]=2;for(f=26847;f<=26870;f++)E[f]=2;for(f=26891;f<=26899;f++)E[f]=0;for(f=26901;f<=26923;f++)E[f]=0;for(f=26929;f<=26946;f++)E[f]=0;for(f=26948;f<=26998;f++)E[f]=0;for(f=27037;f<=27040;f++)E[f]=0;for(f=27205;f<=27232;f++)E[f]=0;for(f=27258;f<=27260;f++)E[f]=0;for(f=27391;f<=27398;f++)E[f]=0;for(f=27561;f<=27564;f++)E[f]=0;for(f=27571;f<=27574;f++)E[f]=0;for(f=27581;f<=27584;f++)E[f]=0;for(f=27591;f<=27594;f++)E[f]=0;for(f=27700;f<=27707;f++)E[f]=0;for(f=28191;f<=28193;f++)E[f]=0;for(f=28348;f<=28358;f++)E[f]=0;for(f=28402;f<=28432;f++)E[f]=0;for(f=28462;f<=28492;f++)E[f]=0;for(f=29118;f<=29122;f++)E[f]=0;for(f=29168;f<=29172;f++)E[f]=0;for(f=29177;f<=29185;f++)E[f]=0;for(f=29187;f<=29195;f++)E[f]=0;for(f=29900;f<=29903;f++)E[f]=0;for(f=30161;f<=30179;f++)E[f]=0;for(f=30491;f<=30494;f++)E[f]=0;for(f=30729;f<=30732;f++)E[f]=0;for(f=31251;f<=31259;f++)E[f]=0;for(f=31265;f<=31268;f++)E[f]=0;for(f=31275;f<=31279;f++)E[f]=0;for(f=31281;f<=31297;f++)E[f]=0;for(f=31461;f<=31469;f++)E[f]=0;for(f=31491;f<=31495;f++)E[f]=0;for(f=31917;f<=31922;f++)E[f]=0;for(f=31965;f<=32e3;f++)E[f]=0;for(f=32001;f<=32003;f++)E[f]=2;for(f=32005;f<=32031;f++)E[f]=2;for(f=32033;f<=32060;f++)E[f]=2;for(f=32064;f<=32067;f++)E[f]=2;for(f=32074;f<=32077;f++)E[f]=2;for(f=32081;f<=32086;f++)E[f]=0;for(f=32107;f<=32130;f++)E[f]=0;for(f=32133;f<=32159;f++)E[f]=0;for(f=32164;f<=32167;f++)E[f]=2;for(f=32180;f<=32199;f++)E[f]=0;for(f=32201;f<=32260;f++)E[f]=0;for(f=32301;f<=32360;f++)E[f]=0;for(f=32401;f<=32460;f++)E[f]=0;for(f=32501;f<=32560;f++)E[f]=0;for(f=32601;f<=32662;f++)E[f]=0;for(f=32664;f<=32667;f++)E[f]=2;for(f=32701;f<=32761;f++)E[f]=0;for(f=53001;f<=53004;f++)E[f]=0;for(f=53008;f<=53019;f++)E[f]=0;for(f=53021;f<=53032;f++)E[f]=0;for(f=53034;f<=53037;f++)E[f]=0;for(f=53042;f<=53046;f++)E[f]=0;for(f=53074;f<=53080;f++)E[f]=0;for(f=54001;f<=54004;f++)E[f]=0;for(f=54008;f<=54019;f++)E[f]=0;for(f=54021;f<=54032;f++)E[f]=0;for(f=54034;f<=54037;f++)E[f]=0;for(f=54042;f<=54046;f++)E[f]=0;for(f=54048;f<=54053;f++)E[f]=0;for(f=54074;f<=54080;f++)E[f]=0;for(f=54090;f<=54096;f++)E[f]=0;for(f=54098;f<=54101;f++)E[f]=0;for(f=65161;f<=65163;f++)E[f]=0;for(f=102001;f<=102040;f++)E[f]=0;for(f=102042;f<=102063;f++)E[f]=0;for(f=102065;f<=102067;f++)E[f]=0;for(f=102070;f<=102117;f++)E[f]=0;for(f=102122;f<=102216;f++)E[f]=0;for(f=102221;f<=102377;f++)E[f]=0;for(f=102382;f<=102388;f++)E[f]=0;for(f=102389;f<=102398;f++)E[f]=2;for(f=102399;f<=102444;f++)E[f]=0;for(f=102445;f<=102447;f++)E[f]=2;for(f=102448;f<=102458;f++)E[f]=0;for(f=102459;f<=102468;f++)E[f]=2;for(f=102469;f<=102499;f++)E[f]=0;for(f=102500;f<=102519;f++)E[f]=1;for(f=102520;f<=102524;f++)E[f]=0;for(f=102525;f<=102529;f++)E[f]=2;for(f=102530;f<=102588;f++)E[f]=0;for(f=102590;f<=102598;f++)E[f]=0;for(f=102601;f<=102603;f++)E[f]=0;for(f=102605;f<=102628;f++)E[f]=0;for(f=102629;f<=102646;f++)E[f]=2;for(f=102648;f<=102700;f++)E[f]=2;for(f=102701;f<=102703;f++)E[f]=0;for(f=102707;f<=102730;f++)E[f]=2;for(f=102733;f<=102758;f++)E[f]=2;for(f=102767;f<=102900;f++)E[f]=0;for(f=102901;f<=102933;f++)E[f]=2;for(f=102934;f<=102950;f++)E[f]=13;for(f=102951;f<=102963;f++)E[f]=0;for(f=102965;f<=102969;f++)E[f]=0;for(f=102971;f<=102973;f++)E[f]=0;for(f=102975;f<=102989;f++)E[f]=0;for(f=102990;f<=102992;f++)E[f]=1;for(f=102997;f<=103002;f++)E[f]=0;for(f=103003;f<=103008;f++)E[f]=2;for(f=103009;f<=103011;f++)E[f]=0;for(f=103012;f<=103014;f++)E[f]=2;for(f=103019;f<=103021;f++)E[f]=0;for(f=103022;f<=103024;f++)E[f]=2;for(f=103029;f<=103031;f++)E[f]=0;for(f=103032;f<=103034;f++)E[f]=2;for(f=103065;f<=103068;f++)E[f]=0;for(f=103074;f<=103076;f++)E[f]=0;for(f=103077;f<=103079;f++)E[f]=1;for(f=103080;f<=103082;f++)E[f]=0;for(f=103083;f<=103085;f++)E[f]=2;for(f=103090;f<=103093;f++)E[f]=0;for(f=103097;f<=103099;f++)E[f]=0;for(f=103100;f<=103102;f++)E[f]=2;for(f=103107;f<=103109;f++)E[f]=0;for(f=103110;f<=103112;f++)E[f]=2;for(f=103113;f<=103116;f++)E[f]=0;for(f=103117;f<=103120;f++)E[f]=2;for(f=103153;f<=103157;f++)E[f]=0;for(f=103158;f<=103162;f++)E[f]=2;for(f=103163;f<=103165;f++)E[f]=0;for(f=103166;f<=103168;f++)E[f]=1;for(f=103169;f<=103171;f++)E[f]=2;for(f=103186;f<=103188;f++)E[f]=0;for(f=103189;f<=103191;f++)E[f]=2;for(f=103192;f<=103195;f++)E[f]=0;for(f=103196;f<=103199;f++)E[f]=2;for(f=103200;f<=103224;f++)E[f]=0;for(f=103225;f<=103227;f++)E[f]=1;for(f=103232;f<=103237;f++)E[f]=0;for(f=103238;f<=103243;f++)E[f]=2;for(f=103244;f<=103246;f++)E[f]=0;for(f=103247;f<=103249;f++)E[f]=2;for(f=103254;f<=103256;f++)E[f]=0;for(f=103257;f<=103259;f++)E[f]=2;for(f=103264;f<=103266;f++)E[f]=0;for(f=103267;f<=103269;f++)E[f]=2;for(f=103300;f<=103375;f++)E[f]=0;for(f=103381;f<=103383;f++)E[f]=0;for(f=103384;f<=103386;f++)E[f]=1;for(f=103387;f<=103389;f++)E[f]=0;for(f=103390;f<=103392;f++)E[f]=2;for(f=103397;f<=103399;f++)E[f]=0;for(f=103400;f<=103471;f++)E[f]=2;for(f=103476;f<=103478;f++)E[f]=0;for(f=103479;f<=103481;f++)E[f]=2;for(f=103486;f<=103488;f++)E[f]=0;for(f=103489;f<=103491;f++)E[f]=2;for(f=103492;f<=103495;f++)E[f]=0;for(f=103496;f<=103499;f++)E[f]=2;for(f=103528;f<=103543;f++)E[f]=0;for(f=103544;f<=103548;f++)E[f]=2;for(f=103549;f<=103551;f++)E[f]=0;for(f=103552;f<=103554;f++)E[f]=1;for(f=103555;f<=103557;f++)E[f]=2;for(f=103558;f<=103560;f++)E[f]=0;for(f=103571;f<=103573;f++)E[f]=0;for(f=103574;f<=103576;f++)E[f]=2;for(f=103577;f<=103580;f++)E[f]=0;for(f=103581;f<=103583;f++)E[f]=2;for(f=103595;f<=103694;f++)E[f]=0;for(f=103696;f<=103699;f++)E[f]=0;for(f=103700;f<=103793;f++)E[f]=2;for(f=103794;f<=103890;f++)E[f]=0;for(f=103891;f<=103896;f++)E[f]=2;for(f=103900;f<=103971;f++)E[f]=2;for(f=103972;f<=103977;f++)E[f]=0;for(f=112e3;f<=112101;f++)E[f]=0;const JV=[102100,102113,3857,3785,900913],fee=[104905,104971],mee=[4326,...JV,...fee],A0=[-20037508342788905e-9,20037508342788905e-9],HM=[-20037508342787e-6,20037508342787e-6],bx={wkTemplate:'PROJCS["WGS_1984_Web_Mercator_Auxiliary_Sphere",GEOGCS["GCS_WGS_1984",DATUM["D_WGS_1984",SPHEROID["WGS_1984",6378137.0,298.257223563]],PRIMEM["Greenwich",0.0],UNIT["Degree",0.0174532925199433]],PROJECTION["Mercator_Auxiliary_Sphere"],PARAMETER["False_Easting",0.0],PARAMETER["False_Northing",0.0],PARAMETER["Central_Meridian",{Central_Meridian}],PARAMETER["Standard_Parallel_1",0.0],PARAMETER["Auxiliary_Sphere_Type",0.0],UNIT["Meter",1.0]]',valid:A0,origin:HM,dx:1e-5},YV={102113:{wkTemplate:'PROJCS["WGS_1984_Web_Mercator",GEOGCS["GCS_WGS_1984_Major_Auxiliary_Sphere",DATUM["D_WGS_1984_Major_Auxiliary_Sphere",SPHEROID["WGS_1984_Major_Auxiliary_Sphere",6378137.0,0.0]],PRIMEM["Greenwich",0.0],UNIT["Degree",0.0174532925199433]],PROJECTION["Mercator"],PARAMETER["False_Easting",0.0],PARAMETER["False_Northing",0.0],PARAMETER["Central_Meridian",{Central_Meridian}],PARAMETER["Standard_Parallel_1",0.0],UNIT["Meter",1.0]]',valid:A0,origin:HM,dx:1e-5},102100:bx,3785:{wkTemplate:'PROJCS["WGS_1984_Web_Mercator",GEOGCS["GCS_WGS_1984_Major_Auxiliary_Sphere",DATUM["D_WGS_1984_Major_Auxiliary_Sphere",SPHEROID["WGS_1984_Major_Auxiliary_Sphere",6378137.0,0.0]],PRIMEM["Greenwich",0.0],UNIT["Degree",0.0174532925199433]],PROJECTION["Mercator"],PARAMETER["False_Easting",0.0],PARAMETER["False_Northing",0.0],PARAMETER["Central_Meridian",{Central_Meridian}],PARAMETER["Standard_Parallel_1",0.0],UNIT["Meter",1.0]]',valid:A0,origin:HM,dx:1e-5},3857:bx,4326:{wkTemplate:'GEOGCS["GCS_WGS_1984",DATUM["D_WGS_1984",SPHEROID["WGS_1984",6378137.0,298.257223563]],PRIMEM["Greenwich",{Central_Meridian}],UNIT["Degree",0.0174532925199433]]',altTemplate:'PROJCS["WGS_1984_Plate_Carree",GEOGCS["GCS_WGS_1984",DATUM["D_WGS_1984",SPHEROID["WGS_1984",6378137.0,298.257223563]],PRIMEM["Greenwich",0.0],UNIT["Degree",0.0174532925199433]],PROJECTION["Plate_Carree"],PARAMETER["False_Easting",0.0],PARAMETER["False_Northing",0.0],PARAMETER["Central_Meridian",{Central_Meridian}],UNIT["Degrees",111319.491]]',valid:[-180,180],origin:[-180,90],dx:1e-5},104971:{wkTemplate:'GEOGCS["Mars_2000_(Sphere)",DATUM["Mars_2000_(Sphere)",SPHEROID["Mars_2000_(Sphere)",3396190.0,0.0]],PRIMEM["Reference_Meridian",0.0],UNIT["Degree",0.0174532925199433]]',valid:[-180,180],origin:[-180,90],dx:1e-5},104905:{wkTemplate:'GEOGCS["GCS_Mars_2000",DATUM["D_Mars_2000",SPHEROID["Mars_2000_IAU_IAG",3396190.0,169.8944472236118]],PRIMEM["Reference_Meridian",0.0],UNIT["Degree",0.0174532925199433]]',valid:[-180,180],origin:[-180,90],dx:1e-5},900913:bx};function mr(t,e){if(t===e)return!0;if(t==null||e==null)return!1;const r=t.wkid,i=e.wkid;if(r!=null||i!=null){if(r===i||lo(t)&&lo(e))return!0;const o=t.latestWkid;if(o!=null&&i===o)return!0;const a=e.latestWkid;return a!=null&&r===a}let s,n;return t.wkt2&&e.wkt2?(s=t.wkt2,n=e.wkt2):t.wkt&&e.wkt&&(s=t.wkt,n=e.wkt),!(!s||!n)&&s.toUpperCase()===n.toUpperCase()}function Si(t){const e=t?.wkid;return e!=null&&e>=2e3&&YV[e]||null}function XV(t){if(!t)return;const{wkid:e,vcsWkid:r}=t;if(e)return r?JSON.stringify({wkid:e,vcsWkid:r}):String(e);const i=t.wkt||t.wkt2;return JSON.stringify(i?r?{wkt:i,vcsWkid:r}:{wkt:i}:{})}function Td(t){if(!as(t))return!1;const{wkid:e}=t;if(e)return E[e]==null;const r=t.wkt2||t.wkt;return!!r&&/^\s*(?:GEOGCS|GEOGCRS|GEOGRAPHICCRS)/i.test(r)}function yee(t){return!(KV(t)||QV(t))}function fd(t){return t?.wkid===4326}function LRe(t){return/^\s*(?:GEOD|GEODETIC|GEOG|GEOGRAPHIC|PROJ|PROJECTED|VERT|VERTICAL|ENG|ENGINEERING|PARAMETRIC|TIME|DERIVEDPROJ|COMPOUND|BOUND)CRS/i.test(t)}function BR(t){return t?.wkid===pd.CGCS2000}function lo(t){const e=t?.wkid;return e!=null&&e>=2e3&&JV.includes(e)}function gee(t){return t?.wkid===32662}function XS(t){return t===pd.GCSMARS2000||t===pd.GCSMARS2000_SPHERE}function KV(t){return XS(t?.wkid)}function KS(t){return t===pd.GCSMOON2000}function QV(t){return KS(t?.wkid)}function vee(t){const e=t?.wkid;return e!=null&&e>=2e3&&mee.includes(e)}function as(t){if(t==null)return!1;const e=t.wkid;return e!=null&&e>=2e3||t.wkt2!=null||t.wkt!=null}const ej={wkid:4326,wkt:gc(YV[4326].wkTemplate,{Central_Meridian:"0.0"})},tj={wkid:102100,latestWkid:3857},_ee={wkid:32662};function v3(t){return{wkt:`GEOCCS["Spherical geocentric",
    DATUM["Not specified",
      SPHEROID["Sphere",${t.radius},0]],
    PRIMEM["Greenwich",0.0,
      AUTHORITY["EPSG","8901"]],
    UNIT["m",1.0],
    AXIS["Geocentric X",OTHER],
    AXIS["Geocentric Y",EAST],
    AXIS["Geocentric Z",NORTH]
  ]`}}const bee=v3(Gt),_3=v3(_a),b3=v3(oc),wee={wkt:`GEOCCS["WGS 84",
  DATUM["WGS_1984",
    SPHEROID["WGS 84",${Gt.radius},298.257223563,
      AUTHORITY["EPSG","7030"]],
    AUTHORITY["EPSG","6326"]],
  PRIMEM["Greenwich",0,
    AUTHORITY["EPSG","8901"]],
  UNIT["m",1.0,
    AUTHORITY["EPSG","9001"]],
  AXIS["Geocentric X",OTHER],
  AXIS["Geocentric Y",OTHER],
  AXIS["Geocentric Z",NORTH],
  AUTHORITY["EPSG","4978"]
]`},See=_3.wkt.toUpperCase(),xee=b3.wkt.toUpperCase();function $ee(t){if(t!=null&&as(t)){const e=t.wkid,r=t.wkt2??t.wkt;if(XS(e))return _a;const i=r?.toUpperCase();if(r&&i===See)return _a;if(KS(e)||i&&i===xee)return oc}return Gt}function RRe(t){return XS(t)?_a:KS(t)?oc:Gt}function pw(t){return mr(t,bee)}function ac(t){return pw(t)||mr(t,_3)||mr(t,b3)}const rj=39.37,Mee=Gt.radius*Math.PI/200,ij=/(?:LENGTH)?UNIT\[([^\]]+)]]$/i,am=E,sj=/UNIT\[([^\]]+)]/i,Tee=new Set([4305,4807,4810,4811,4812,4816,4819,4821,4901,4902,37225,104025,104026,104139,104140]),Eee=Wr()({millimeter:"millimeters",centimeter:"centimeters",meter:"meters",meter_german:"german-meters",kilometer:"kilometers",decimeter:"decimeters",micrometer:"micrometers",nanometer:"nanometers","50_kilometers":"50-kilometers","150_kilometers":"150-kilometers",foot:"feet",foot_us:"us-feet",foot_clarke:"clarke-feet",fathom:"fathoms",nautical_mile:"nautical-miles",chain_us:"us-chains",link_us:"us-links",mile_us:"us-miles",yard_clarke:"clarke-yards",chain_clarke:"clarke-chains",link_clarke:"clarke-links",yard_sears:"sears-yards",foot_sears:"sears-feet",chain_sears:"sears-chains",link_sears:"sears-links",yard_benoit_1895_a:"benoit-1895-a-yards",foot_benoit_1895_a:"benoit-1895-a-feet",chain_benoit_1895_a:"benoit-1895-a-chains",link_benoit_1895_a:"benoit-1895-a-links",yard_benoit_1895_b:"benoit-1895-b-yards",foot_benoit_1895_b:"benoit-1895-b-feet",chain_benoit_1895_b:"benoit-1895-b-chains",link_benoit_1895_b:"benoit-1895-b-links",foot_1865:"1865-feet",foot_indian:"indian-feet",foot_indian_1937:"indian-1937-feet",foot_indian_1962:"indian-1962-feet",foot_indian_1975:"indian-1975-feet",yard_indian:"indian-yards",yard_indian_1937:"indian-1937-yards",yard_indian_1962:"indian-1962-yards",yard_indian_1975:"indian-1975-yards",statute_mile:"statute-miles",foot_gold_coast:"gold-coast-feet",foot_british_1936:"british-1936-feet",yard:"yards",chain:"chains",link:"links",yard_sears_1922_truncated:"sears-1922-truncated-yards",foot_sears_1922_truncated:"sears-1922-truncated-feet",chain_sears_1922_truncated:"sears-1922-truncated-chains",link_sears_1922_truncated:"sears-1922-truncated-links",yard_us:"us-yards",inch:"inches",inch_us:"us-inches",rod:"rods",rod_us:"us-rods",nautical_mile_us:"us-nautical-miles",nautical_mile_uk:"uk-nautical-miles",smoot:"smoots",vara_tx:"tx-vara",point:"points"}),Mn=t=>t*t,eu=t=>t*t*t,L0={length:{baseUnit:"meters",units:{millimeters:{inBaseUnits:.001},centimeters:{inBaseUnits:.01},meters:{inBaseUnits:1},feet:{inBaseUnits:.3048},"us-feet":{inBaseUnits:.3048006096012192},"clarke-feet":{inBaseUnits:.3047972654},fathoms:{inBaseUnits:1.8288},"nautical-miles":{inBaseUnits:1852},"german-meters":{inBaseUnits:1.0000135965},"us-chains":{inBaseUnits:20.11684023368047},"us-links":{inBaseUnits:.2011684023368047},"us-miles":{inBaseUnits:1609.347218694438},kilometers:{inBaseUnits:1e3},"clarke-yards":{inBaseUnits:.9143917962},"clarke-chains":{inBaseUnits:20.1166195164},"clarke-links":{inBaseUnits:.201166195164},"sears-yards":{inBaseUnits:.9143984146160287},"sears-feet":{inBaseUnits:.3047994715386762},"sears-chains":{inBaseUnits:20.11676512155263},"sears-links":{inBaseUnits:.2011676512155263},"benoit-1895-a-yards":{inBaseUnits:.9143992},"benoit-1895-a-feet":{inBaseUnits:.3047997333333333},"benoit-1895-a-chains":{inBaseUnits:20.1167824},"benoit-1895-a-links":{inBaseUnits:.201167824},"benoit-1895-b-yards":{inBaseUnits:.9143992042898124},"benoit-1895-b-feet":{inBaseUnits:.3047997347632708},"benoit-1895-b-chains":{inBaseUnits:20.11678249437587},"benoit-1895-b-links":{inBaseUnits:.2011678249437587},"1865-feet":{inBaseUnits:.3048008333333334},"indian-feet":{inBaseUnits:.3047995102481469},"indian-1937-feet":{inBaseUnits:.30479841},"indian-1962-feet":{inBaseUnits:.3047996},"indian-1975-feet":{inBaseUnits:.3047995},"indian-yards":{inBaseUnits:.9143985307444408},"indian-1937-yards":{inBaseUnits:.91439523},"indian-1962-yards":{inBaseUnits:.9143988},"indian-1975-yards":{inBaseUnits:.9143985},miles:{inBaseUnits:1609.344},"statute-miles":{inBaseUnits:1609.344},"gold-coast-feet":{inBaseUnits:.3047997101815088},"british-1936-feet":{inBaseUnits:.3048007491},yards:{inBaseUnits:.9144},chains:{inBaseUnits:20.1168},links:{inBaseUnits:.201168},"sears-1922-truncated-yards":{inBaseUnits:.914398},"sears-1922-truncated-feet":{inBaseUnits:.3047993333333334},"sears-1922-truncated-chains":{inBaseUnits:20.116756},"sears-1922-truncated-links":{inBaseUnits:.20116756},"us-yards":{inBaseUnits:.9144018288036576},decimeters:{inBaseUnits:.1},inches:{inBaseUnits:.0254},"us-inches":{inBaseUnits:.0254000508001016},rods:{inBaseUnits:5.0292},"us-rods":{inBaseUnits:5.029210058420118},"us-nautical-miles":{inBaseUnits:1853.248},"uk-nautical-miles":{inBaseUnits:1853.184},smoots:{inBaseUnits:1.7018},"tx-vara":{inBaseUnits:.8466683600033867},points:{inBaseUnits:.0003527777777777778},micrometers:{inBaseUnits:1e-6},nanometers:{inBaseUnits:1e-9},"50-kilometers":{inBaseUnits:5e4},"150-kilometers":{inBaseUnits:15e4}}},area:{baseUnit:"square-meters",units:{"square-millimeters":{inBaseUnits:Mn(.001)},"square-centimeters":{inBaseUnits:Mn(.01)},"square-decimeters":{inBaseUnits:Mn(.1)},"square-meters":{inBaseUnits:1},"square-kilometers":{inBaseUnits:Mn(1e3)},"square-inches":{inBaseUnits:Mn(.0254)},"square-feet":{inBaseUnits:Mn(.3048)},"square-yards":{inBaseUnits:Mn(.9144)},"square-miles":{inBaseUnits:Mn(1609.344)},"square-nautical-miles":{inBaseUnits:Mn(1852)},"square-us-feet":{inBaseUnits:Mn(1200/3937)},acres:{inBaseUnits:.0015625*Mn(1609.344)},ares:{inBaseUnits:100},hectares:{inBaseUnits:1e4}}},volume:{baseUnit:"liters",units:{liters:{inBaseUnits:1},"cubic-millimeters":{inBaseUnits:1e3*eu(.001)},"cubic-centimeters":{inBaseUnits:1e3*eu(.01)},"cubic-decimeters":{inBaseUnits:1e3*eu(.1)},"cubic-meters":{inBaseUnits:1e3},"cubic-kilometers":{inBaseUnits:1e3*eu(1e3)},"cubic-inches":{inBaseUnits:1e3*eu(.0254)},"cubic-feet":{inBaseUnits:1e3*eu(.3048)},"cubic-yards":{inBaseUnits:1e3*eu(.9144)},"cubic-miles":{inBaseUnits:1e3*eu(1609.344)}}},angle:{baseUnit:"radians",units:{radians:{inBaseUnits:1},degrees:{inBaseUnits:Math.PI/180}}}},Iee=(()=>{const t={};for(const e in L0)for(const r in L0[e].units)t[r]=e;return t})();function Cee(t,e,r){return t*L0[r].units[e].inBaseUnits}function Pee(t,e,r){return t/L0[r].units[e].inBaseUnits}const Aee=["inches","feet","yards","miles","nautical-miles","us-feet","millimeters","centimeters","decimeters","meters","kilometers"],Lee=["metric","imperial"],nj=[...Lee,...Aee],Ree=new Map([["meters","square-meters"],["feet","square-feet"],["us-feet","square-us-feet"]]);function WM(t){const e=Iee[t];if(!e)throw new Error("unknown type");return e}function qR(t,e=null){return e=e||WM(t),L0[e].baseUnit===t}function ut(t,e,r){if(e===r)return t;const i=WM(e);if(i!==WM(r))throw new Error("incompatible units");const s=qR(e,i)?t:Cee(t,e,i);return qR(r,i)?s:Pee(s,r,i)}function kRe(t,e,r,i=!1){if(!i&&Td(e))throw new Error("Unable to convert from an angular unit to a linear unit.");const s=Ed(e);return s!==r&&(t=s?ut(t,s,r):ut(t*=vn(e),"meters",r)),t}function ORe(t,e,r,i=!1){if(!i&&Td(r))throw new Error("Unable to convert from a linear unit to an angular unit.");const s=Ed(r);return e!==s&&(t=s?ut(t,e,s):ut(t,e,"meters")/vn(r)),t}function kee(t){switch(t){case"metric":return"meters";case"imperial":return"feet";default:return t}}function NRe(t){return kee(t)}function FRe(t){switch(t){case"metric":return"square-meters";case"imperial":return"square-feet";default:return t}}function DRe(t,e){const r=ut(t,e,"meters");return Math.abs(r)<3e3?"meters":"kilometers"}function zRe(t,e){const r=ut(t,e,"meters");return Math.abs(r)<1e5?"meters":"kilometers"}function VRe(t,e){const r=ut(t,e,"feet");return Math.abs(r)<1e3?"feet":"miles"}function jRe(t,e){const r=ut(t,e,"feet");return Math.abs(r)<1e5?"feet":"miles"}function URe(t,e){const r=ut(t,e,"square-meters");return Math.abs(r)<3e6?"square-meters":"square-kilometers"}function GRe(t,e){const r=ut(t,e,"square-feet");return Math.abs(r)<1e6?"square-feet":"square-miles"}function Oee(t,e,r){return ut(t,e,"meters")/(r*Math.PI/180)}function w3(t){return Eee.fromJSON(t.toLowerCase())||null}function fw(t){if(t!=null&&!yee(t))return 1;const e=vn(t);return e>1e5?1:e}function oj(t){return vn(t)>=$ee(t).metersPerDegree?"meters":Ed(t)}function vn(t,e=Gt.metersPerDegree){return aj(t,!0)??e}function aj(t,e=!1){const r=t?.wkid??null,i=t?.wkt2??t?.wkt??null;let s=null;if(r){if(XS(r))return _a.metersPerDegree;if(KS(r))return oc.metersPerDegree;s=am.values[am[r]],!s&&e&&Tee.has(r)&&(s=Mee)}else i&&(cj(i)?s=HR(ij.exec(i),s):uj(i)&&(s=HR(sj.exec(i),s)));return s}function BRe(t){return Td(t)?1:vn(t)}function HR(t,e){return t?.[1]?lj(t[1]):e}function lj(t){return parseFloat(t.split(",")[1])}function Ed(t){const e=t?.wkid??null,r=t?.wkt2??t?.wkt??null;let i=null;if(e)i=am.units[am[e]];else if(r){const s=cj(r)?ij:uj(r)?sj:null;if(s){const n=s.exec(r);n?.[1]&&(i=Fee(n[1]))}}return i!=null?w3(i):null}function qRe(t){const e=Ed(t);return e!=null&&nj.includes(e)?e:null}function HRe(t){const e=oj(t);return e!=null&&nj.includes(e)?e:null}function WRe(t){const e=Ed(t);return e==null?null:Ree.get(e)}function uj(t){return/^GEOCCS/i.test(t)}function cj(t){return/^\s*(?:PROJCS|PROJCRS|PROJECTEDCRS)/i.test(t)}const Nee=1e-7;function Fee(t){let r=/[\\"']{1}([^\\"']+)/.exec(t)?.[1];if(!r||!w3(r)){const i=lj(t);r=null;const s=am.values;for(let n=0;n<s.length;++n)if(Math.abs(i-s[n])<Nee){r=am.units[n];break}}return r}function Dee(t){const e=Ed(t);if(e==null)return null;switch(e){case"feet":case"us-feet":case"clarke-feet":case"fathoms":case"nautical-miles":case"us-chains":case"us-links":case"us-miles":case"clarke-yards":case"clarke-chains":case"clarke-links":case"sears-yards":case"sears-feet":case"sears-chains":case"sears-links":case"benoit-1895-a-yards":case"benoit-1895-a-feet":case"benoit-1895-a-chains":case"benoit-1895-a-links":case"benoit-1895-b-yards":case"benoit-1895-b-feet":case"benoit-1895-b-chains":case"benoit-1895-b-links":case"1865-feet":case"indian-feet":case"indian-1937-feet":case"indian-1962-feet":case"indian-1975-feet":case"indian-yards":case"indian-1937-yards":case"indian-1962-yards":case"indian-1975-yards":case"statute-miles":case"gold-coast-feet":case"british-1936-feet":case"yards":case"chains":case"links":case"sears-1922-truncated-yards":case"sears-1922-truncated-feet":case"sears-1922-truncated-chains":case"sears-1922-truncated-links":case"us-yards":case"inches":case"us-inches":case"rods":case"us-rods":case"us-nautical-miles":case"uk-nautical-miles":case"smoots":case"tx-vara":case"points":return"imperial";case"millimeters":case"centimeters":case"meters":case"german-meters":case"kilometers":case"decimeters":case"micrometers":case"nanometers":case"50-kilometers":case"150-kilometers":return"metric"}return null}const zee={esriAcres:"acres",esriAres:"ares",esriHectares:"hectares",esriSquareCentimeters:"square-centimeters",esriSquareDecimeters:"square-decimeters",esriSquareFeet:"square-feet",esriSquareInches:"square-inches",esriSquareKilometers:"square-kilometers",esriSquareMeters:"square-meters",esriSquareMiles:"square-miles",esriSquareMillimeters:"square-millimeters",esriSquareUsFeet:"square-us-feet",esriSquareYards:"square-yards"},Vee={esriCentimeters:"centimeters",esriDecimeters:"decimeters",esriFeet:"feet",esriInches:"inches",esriKilometers:"kilometers",esriMeters:"meters",esriMiles:"miles",esriMillimeters:"millimeters",esriNauticalMiles:"nautical-miles",esriYards:"yards"},jee={esriDUDecimalDegrees:"degrees",esriDURadians:"radians"},Uee=Wr()(zee),Gee=Wr()(Vee),ZRe=Wr()(jee);var vo,Go;let ne=(Go=class extends W{static fromJSON(e){if(!e)return null;if(e?.wkid===102100)return vo.WebMercator;if(e?.wkid===4326)return vo.WGS84;const r=new vo;return r.read(e),r}constructor(e){super(e),this.latestWkid=null,this.wkid=null,this.wkt=null,this.wkt2=null,this.vcsWkid=null,this.latestVcsWkid=null,this.imageCoordinateSystem=null}normalizeCtorArgs(e){return e&&typeof e=="object"?e:{[typeof e=="string"?"wkt":"wkid"]:e}}get isWGS84(){return fd(this)}get isWebMercator(){return lo(this)}get isGeographic(){return Td(this)}get isWrappable(){return vee(this)}get metersPerUnit(){return vn(this)}get unit(){return Ed(this)||(this.isGeographic?"degrees":null)}writeWkt(e,r){this.wkid||(r.wkt=e)}clone(){if(this===vo.WGS84)return new vo(ej);if(this===vo.WebMercator)return new vo(tj);const e=new vo;return this.wkid!=null?(e.wkid=this.wkid,this.latestWkid!=null&&(e.latestWkid=this.latestWkid),this.vcsWkid!=null&&(e.vcsWkid=this.vcsWkid),this.latestVcsWkid!=null&&(e.latestVcsWkid=this.latestVcsWkid)):(this.wkt!=null&&(e.wkt=this.wkt),this.wkt2!=null&&(e.wkt2=this.wkt2)),this.imageCoordinateSystem&&(e.imageCoordinateSystem=k(this.imageCoordinateSystem)),e}equals(e){if(e==null)return!1;if(this.imageCoordinateSystem||e.imageCoordinateSystem){if(this.imageCoordinateSystem==null||e.imageCoordinateSystem==null)return!1;const{id:r,referenceServiceName:i}=e.imageCoordinateSystem,{geodataXform:s}=e.imageCoordinateSystem,n=this.imageCoordinateSystem;return r==null||s?JSON.stringify(n)===JSON.stringify(e.imageCoordinateSystem):i?n.id===r&&n.referenceServiceName===i:n.id===r}return mr(this,e)}toJSON(e){return this.write(void 0,e)}},vo=Go,Go.GCS_NAD_1927=null,Go.WGS84=null,Go.WebMercator=null,Go.PlateCarree=null,Go);c([d({readOnly:!0})],ne.prototype,"isWGS84",null),c([d({readOnly:!0})],ne.prototype,"isWebMercator",null),c([d({readOnly:!0})],ne.prototype,"isGeographic",null),c([d({readOnly:!0})],ne.prototype,"isWrappable",null),c([d({type:qe,json:{write:!0}})],ne.prototype,"latestWkid",void 0),c([d({readOnly:!0})],ne.prototype,"metersPerUnit",null),c([d({readOnly:!0})],ne.prototype,"unit",null),c([d({type:qe,json:{write:!0,origins:{"web-scene":{write:{overridePolicy(){return{isRequired:this.wkt==null}}}}}}})],ne.prototype,"wkid",void 0),c([d({type:String,json:{origins:{"web-scene":{write:{overridePolicy(){return{isRequired:this.wkid==null}}}}}}})],ne.prototype,"wkt",void 0),c([re("wkt"),re("web-scene","wkt")],ne.prototype,"writeWkt",null),c([d({type:String,json:{write:!1}})],ne.prototype,"wkt2",void 0),c([d({type:qe,json:{write:!0}})],ne.prototype,"vcsWkid",void 0),c([d({type:qe,json:{write:!0}})],ne.prototype,"latestVcsWkid",void 0),c([d()],ne.prototype,"imageCoordinateSystem",void 0),ne=vo=c([C("esri.geometry.SpatialReference")],ne),ne.prototype.toJSON.isDefaultToJSON=!0,ne.GCS_NAD_1927=ce.freeze(new ne({wkid:4267,wkt:'GEOGCS["GCS_North_American_1927",DATUM["D_North_American_1927",SPHEROID["Clarke_1866",6378206.4,294.9786982]],PRIMEM["Greenwich",0.0],UNIT["Degree",0.0174532925199433]]'})),ne.WGS84=ce.freeze(new ne(ej)),ne.WebMercator=ce.freeze(new ne(tj)),ne.PlateCarree=ce.freeze(new ne(_ee));function K(t,e,r){let i,s;return e===void 0||Array.isArray(e)?(s=t,r=e,i=[void 0]):(s=e,i=Array.isArray(t)?t:[t]),(n,o)=>{const a=n.constructor.prototype;i.forEach((l=>{const u=u3(n,l,s);u.read&&typeof u.read=="object"||(u.read={}),u.read.reader=a[o],r&&(u.read.source=(u.read.source||[]).concat(r))}))}}let Gr=class extends W{constructor(...e){super(...e),this.type=null,this.hasM=!1,this.hasZ=!1,this.spatialReference=ne.WGS84}get cache(){return this.commitProperty("spatialReference"),{}}get extent(){return null}readSpatialReference(e,r){if(e instanceof ne)return e;if(e!=null){const i=new ne;return i.read(e,r),i}return e}clone(){return console.warn(".clone() is not implemented for "+this.declaredClass),null}clearCache(){this.notifyChange("cache")}getCacheValue(e){return this.cache[e]}setCacheValue(e,r){this.cache[e]=r}};c([d()],Gr.prototype,"type",void 0),c([d({readOnly:!0})],Gr.prototype,"cache",null),c([d({readOnly:!0})],Gr.prototype,"extent",null),c([d({type:Boolean,json:{write:{overridePolicy:t=>({enabled:t})}}})],Gr.prototype,"hasM",void 0),c([d({type:Boolean,json:{write:{overridePolicy:t=>({enabled:t})}}})],Gr.prototype,"hasZ",void 0),c([d({type:ne,json:{write:!0},value:ne.WGS84})],Gr.prototype,"spatialReference",void 0),c([K("spatialReference")],Gr.prototype,"readSpatialReference",null),Gr=c([C("esri.geometry.Geometry")],Gr);const Bee=Object.prototype.toString;function qee(t){const e="__accessorMetadata__"in t?br(t):t;return function(...r){if(r.push(e),typeof r[2]=="number")throw new Error("Using @cast has parameter decorator is not supported since 4.16");return Hee.apply(this,r)}}function Hee(t,e,r,i){_v(t,e).cast=i}function Wee(t){return(e,r)=>{_v(e,t).cast=e[r]}}function We(...t){if(t.length!==3||typeof t[1]!="string")return t.length===1&&Bee.call(t[0])==="[object Function]"?qee(t[0]):t.length===1&&typeof t[0]=="string"?Wee(t[0]):void 0}function lm(t){if(t&&typeof t=="object"&&"type"in t&&t.type==="mesh")throw new F("internal:mesh","Mesh geometries are not supported for this operation")}function Zee(t){t.forEach(lm)}const Jee=57.29577951308232,Yee=.017453292519943;function WR(t){return t*Jee}function ZR(t){return t*Yee}function YRe(t){return Math.PI/2-2*Math.atan(Math.exp(-t/Gt.radius))}function ZM(t){return t.wkid!=null||t.wkt!=null}const wx=[0,0];function mw(t,e,r,i,s){const n=t,o=s;if(o.spatialReference=r,"x"in n&&"x"in o)[o.x,o.y]=e(n.x,n.y,wx,i);else if("xmin"in n&&"xmin"in o)[o.xmin,o.ymin]=e(n.xmin,n.ymin,wx,i),[o.xmax,o.ymax]=e(n.xmax,n.ymax,wx,i);else if("paths"in n&&"paths"in o||"rings"in n&&"rings"in o){const a="paths"in n?n.paths:n.rings,l=[];let u;for(let h=0;h<a.length;h++){const p=a[h];u=[],l.push(u);for(let m=0;m<p.length;m++)u.push(e(p[m][0],p[m][1],[0,0],i)),p[m].length>2&&u[m].push(p[m][2]),p[m].length>3&&u[m].push(p[m][3])}"paths"in o?o.paths=l:o.rings=l}else if("points"in n&&"points"in o){const a=n.points,l=[];for(let u=0;u<a.length;u++)l[u]=e(a[u][0],a[u][1],[0,0],i),a[u].length>2&&l[u].push(a[u][2]),a[u].length>3&&l[u].push(a[u][3]);o.points=l}return s}function x1(t,e){const r=t&&(ZM(t)?t:t.spatialReference),i=e&&(ZM(e)?e:e.spatialReference);return!(t&&"type"in t&&t.type==="mesh"||e&&"type"in e&&e.type==="mesh"||!r||!i)&&(!!mr(i,r)||lo(i)&&fd(r)||lo(r)&&fd(i))}function QS(t,e){if(t==null)return null;const r=t.spatialReference,i=e&&(ZM(e)?e:e.spatialReference);return x1(r,i)?mr(r,i)?k(t):lo(i)?mw(t,Bp,ne.WebMercator,!1,k(t)):fd(i)?mw(t,e2,ne.WGS84,!1,k(t)):null:null}function Bp(t,e,r=[0,0]){e>89.99999?e=89.99999:e<-89.99999&&(e=-89.99999);const i=ZR(e);return r[0]=ZR(t)*Gt.radius,r[1]=Gt.halfSemiMajorAxis*Math.log((1+Math.sin(i))/(1-Math.sin(i))),r}function e2(t,e,r=[0,0],i=!1){if(t===A0[0])r[0]=-180;else if(t===A0[1])r[0]=180;else{const s=WR(t/Gt.radius);r[0]=i?s:s-360*Math.floor((s+180)/360)}return r[1]=WR(Math.PI/2-2*Math.atan(Math.exp(-e/Gt.radius))),r}function Jh(t,e=!1,r=k(t)){return lm(t),lm(r),mw(t,Bp,ne.WebMercator,e,r)}function Oh(t,e=!1,r=k(t)){return lm(t),lm(r),mw(t,e2,ne.WGS84,e,r)}function hj(t,e){const r=t.x-e.x,i=t.y-e.y,s=t.z!=null&&e.z!=null?t.z-e.z:0;return Math.sqrt(r*r+i*i+s*s)}function Xee(t){return dj(t,pj)?.[0]??null}function Kee(t){return dj(t,pj)?.[1]??null}function dj({x:t,y:e,spatialReference:r},i=[0,0]){if(r){if(lo(r))return e2(t,e,i);if(Td(r))return i[0]=t,i[1]=e,i}return null}const pj=[0,0];var $1;const Sx=[0,0];function JR(t){return t&&(t.declaredClass==="esri.geometry.SpatialReference"||t.wkid!=null)}let ge=$1=class extends Gr{static copy(t,e){e._set("x",t._get("x")),e._set("y",t._get("y")),e._set("z",t._get("z")),e._set("m",t._get("m"));const r=t._get("spatialReference");e._set("spatialReference",ce.isFrozen(r)?r:r.clone())}constructor(...t){super(...t),this.x=0,this.y=0,this.z=void 0,this.m=void 0,this.type="point"}normalizeCtorArgs(t,e,r,i,s){let n;if(Array.isArray(t))n=t,s=e,t=n[0],e=n[1],r=n[2],i=n[3];else if(t&&typeof t=="object"){if(n=t,t=n.x!=null?n.x:n.longitude,e=n.y!=null?n.y:n.latitude,r=n.z,i=n.m,(s=n.spatialReference)&&s.declaredClass!=="esri.geometry.SpatialReference"&&(s=new ne(s)),n.longitude!=null||n.latitude!=null){if(n.longitude==null)q.getLogger(this).warn(".longitude=","Latitude was defined without longitude");else if(n.latitude==null)q.getLogger(this).warn(".latitude=","Longitude was defined without latitude");else if(!n.declaredClass&&s?.isWebMercator){const a=Bp(n.longitude,n.latitude,Sx);t=a[0],e=a[1]}}}else JR(r)?(s=r,r=null):JR(i)&&(s=i,i=null);const o={x:t,y:e};return o.x==null&&o.y!=null?q.getLogger(this).warn(".y=","Y coordinate was defined without an X coordinate"):o.y==null&&o.x!=null&&q.getLogger(this).warn(".x=","X coordinate was defined without a Y coordinate"),s!=null&&(o.spatialReference=s),r!=null&&(o.z=r),i!=null&&(o.m=i),o}get cache(){return this.commitProperty("x"),this.commitProperty("y"),this.commitProperty("z"),this.commitProperty("m"),this.commitProperty("spatialReference"),{}}get hasM(){return this.m!==void 0}set hasM(t){t!==(this._get("m")!==void 0)&&(this._set("m",t?0:void 0),this._set("hasM",t))}get hasZ(){return this.z!==void 0}set hasZ(t){t!==(this._get("z")!==void 0)&&(this._set("z",t?0:void 0),this._set("hasZ",t))}get latitude(){return Kee(this)}set latitude(t){const{spatialReference:e,x:r}=this;t!=null&&e&&(e.isWebMercator?this._set("y",Bp(r,t,Sx)[1]):e.isGeographic&&this._set("y",t),this._set("latitude",t))}get longitude(){return Xee(this)}set longitude(t){const{y:e,spatialReference:r}=this;t!=null&&r&&(r.isWebMercator?this._set("x",Bp(t,e,Sx)[0]):r.isGeographic&&this._set("x",t),this._set("longitude",t))}writeX(t,e,r){e[r]=isNaN(t)?"NaN":t}readX(t){return typeof t=="string"?NaN:t}clone(){const t=new $1;return t.x=this.x,t.y=this.y,t.z=this.z,t.m=this.m,t.spatialReference=this.spatialReference,t}copy(t){return $1.copy(t,this),this}equals(t){if(t==null)return!1;const{x:e,y:r,z:i,m:s,spatialReference:n}=this,{z:o,m:a}=t;let{x:l,y:u,spatialReference:h}=t;if(!n.equals(h))if(n.isWebMercator&&h.isWGS84)[l,u]=Bp(l,u),h=n;else{if(!n.isWGS84||!h.isWebMercator)return!1;[l,u]=e2(l,u),h=n}return e===l&&r===u&&i===o&&s===a&&n.wkid===h.wkid}offset(t,e,r){return this.x+=t,this.y+=e,r!=null&&(this.z=(this.z??0)+r),this}normalize(){if(!this.spatialReference)return this;const t=Si(this.spatialReference);if(!t)return this;let e=this.x;const[r,i]=t.valid,s=2*i;let n;return e>i?(n=Math.ceil(Math.abs(e-i)/s),e-=n*s):e<r&&(n=Math.ceil(Math.abs(e-r)/s),e+=n*s),this._set("x",e),this}distance(t){return hj(this,t)}toArray(){const t=this.hasZ,e=this.hasM;return t&&e?[this.x,this.y,this.z,this.m]:t?[this.x,this.y,this.z]:e?[this.x,this.y,this.m]:[this.x,this.y]}toJSON(t){return this.write({},t)}};c([d({readOnly:!0})],ge.prototype,"cache",null),c([d({type:Boolean,json:{read:!1,write:{enabled:!1,overridePolicy:null}}})],ge.prototype,"hasM",null),c([d({type:Boolean,json:{read:!1,write:{enabled:!1,overridePolicy:null}}})],ge.prototype,"hasZ",null),c([d({type:Number})],ge.prototype,"latitude",null),c([d({type:Number})],ge.prototype,"longitude",null),c([d({type:Number,json:{type:[Number,String],write:{isRequired:!0,allowNull:!0}}}),We((t=>isNaN(t)?t:Di(t)))],ge.prototype,"x",void 0),c([re("x")],ge.prototype,"writeX",null),c([K("x")],ge.prototype,"readX",null),c([d({type:Number,json:{write:!0}})],ge.prototype,"y",void 0),c([d({type:Number,json:{write:{overridePolicy(){return{enabled:this.hasZ}}}}})],ge.prototype,"z",void 0),c([d({type:Number,json:{write:{overridePolicy(){return{enabled:this.hasM}}}}})],ge.prototype,"m",void 0),ge=$1=c([C("esri.geometry.Point")],ge),ge.prototype.toJSON.isDefaultToJSON=!0;const xx=[0,0];function xv(t,e){return e!=null&&Pi(t,e.x,e.y,e.z)}function XRe(t,e){if(!e.points?.length)return!1;for(const r of e.points)if(!um(t,r))return!1;return!0}function Qee(t,e){const{xmin:r,ymin:i,zmin:s,xmax:n,ymax:o,zmax:a}=e;return t.hasZ&&e.hasZ?Pi(t,r,i,s)&&Pi(t,r,o,s)&&Pi(t,n,o,s)&&Pi(t,n,i,s)&&Pi(t,r,i,a)&&Pi(t,r,o,a)&&Pi(t,n,o,a)&&Pi(t,n,i,a):Pi(t,r,i)&&Pi(t,r,o)&&Pi(t,n,o)&&Pi(t,n,i)}function um(t,e){return Pi(t,e[0],e[1])}function ete(t,e){return Pi(t,e[0],e[1],e[2])}function Pi(t,e,r,i){return e>=t.xmin&&e<=t.xmax&&r>=t.ymin&&r<=t.ymax&&(i==null||!t.hasZ||i>=t.zmin&&i<=t.zmax)}function S3(t,e){return xx[1]=e.y,xx[0]=e.x,tte(t,xx)}function tte(t,e){return x3(t.rings,e)}function x3(t,e){if(!t)return!1;if(rte(t))return YR(!1,t,e);let r=!1;for(let i=0,s=t.length;i<s;i++)r=YR(r,t[i],e);return r}function rte(t){return!Array.isArray(t[0][0])}function YR(t,e,r){const[i,s]=r;let n=t,o=0;for(let a=0,l=e.length;a<l;a++){o++,o===l&&(o=0);const[u,h]=e[a],[p,m]=e[o];(h<s&&m>=s||m<s&&h>=s)&&u+(s-h)/(m-h)*(p-u)<i&&(n=!n)}return n}function ite(t,e){return xv(t,e)}function ste(t,e){const r=t.hasZ&&e.hasZ;let i,s,n;if(t.xmin<=e.xmin){if(i=e.xmin,t.xmax<i)return!1}else if(i=t.xmin,e.xmax<i)return!1;if(t.ymin<=e.ymin){if(s=e.ymin,t.ymax<s)return!1}else if(s=t.ymin,e.ymax<s)return!1;if(r&&e.hasZ){if(t.zmin<=e.zmin){if(n=e.zmin,t.zmax<n)return!1}else if(n=t.zmin,e.zmax<n)return!1}return!0}function nte(t,e){const{points:r,hasZ:i}=e,s=i?ete:um;for(const n of r)if(s(t,n))return!0;return!1}const md=[0,0],yd=[0,0],gd=[0,0],vd=[0,0],ote=[md,yd,gd,vd],fj=[[gd,md],[md,yd],[yd,vd],[vd,gd]];function ate(t,e){return lte(t,e.rings)}function lte(t,e){md[0]=t.xmin,md[1]=t.ymax,yd[0]=t.xmax,yd[1]=t.ymax,gd[0]=t.xmin,gd[1]=t.ymin,vd[0]=t.xmax,vd[1]=t.ymin;for(const r of ote)if(x3(e,r))return!0;for(const r of e){if(!r.length)continue;let i=r[0];if(um(t,i))return!0;for(let s=1;s<r.length;s++){const n=r[s];if(um(t,n)||mj(i,n,fj))return!0;i=n}}return!1}function ute(t,e){md[0]=t.xmin,md[1]=t.ymax,yd[0]=t.xmax,yd[1]=t.ymax,gd[0]=t.xmin,gd[1]=t.ymin,vd[0]=t.xmax,vd[1]=t.ymin;const r=e.paths;for(const i of r){if(!r.length)continue;let s=i[0];if(um(t,s))return!0;for(let n=1;n<i.length;n++){const o=i[n];if(um(t,o)||mj(s,o,fj))return!0;s=o}}return!1}const Or=[0,0];function cte(t){for(let e=0;e<t.length;e++){const r=t[e];for(let s=0;s<r.length-1;s++){const n=r[s],o=r[s+1];for(let a=e+1;a<t.length;a++)for(let l=0;l<t[a].length-1;l++){const u=t[a][l],h=t[a][l+1];if(yw(n,o,u,h,Or)&&!(Or[0]===n[0]&&Or[1]===n[1]||Or[0]===u[0]&&Or[1]===u[1]||Or[0]===o[0]&&Or[1]===o[1]||Or[0]===h[0]&&Or[1]===h[1]))return!0}}const i=r.length;if(!(i<=4))for(let s=0;s<i-3;s++){let n=i-1;s===0&&(n=i-2);const o=r[s],a=r[s+1];for(let l=s+2;l<n;l++){const u=r[l],h=r[l+1];if(yw(o,a,u,h,Or)&&!(Or[0]===o[0]&&Or[1]===o[1]||Or[0]===u[0]&&Or[1]===u[1]||Or[0]===a[0]&&Or[1]===a[1]||Or[0]===h[0]&&Or[1]===h[1]))return!0}}}return!1}function mj(t,e,r){for(let i=0;i<r.length;i++)if(yw(t,e,r[i][0],r[i][1]))return!0;return!1}function yw(t,e,r,i,s){const[n,o]=t,[a,l]=e,[u,h]=r,[p,m]=i,y=p-u,g=n-u,v=a-n,_=m-h,b=o-h,S=l-o,$=_*v-y*S;if($===0)return!1;const T=(y*b-_*g)/$,I=(v*b-S*g)/$;return T>=0&&T<=1&&I>=0&&I<=1&&(s&&(s[0]=n+T*(a-n),s[1]=o+T*(l-o)),!0)}function hte(t){switch(t){case"esriGeometryEnvelope":case"extent":return ste;case"esriGeometryMultipoint":case"multipoint":return nte;case"esriGeometryPoint":case"point":return ite;case"esriGeometryMultiPatch":case"multipatch":case"esriGeometryPolygon":case"polygon":return ate;case"esriGeometryPolyline":case"polyline":return ute}}var Ln;function dte(t){return t&&(t.declaredClass==="esri.geometry.SpatialReference"||t.wkid!=null)}function tu(t,e,r){return e==null?r:r==null?e:t(e,r)}let Le=Ln=class extends Gr{constructor(...t){super(...t),this.type="extent",this.xmin=0,this.ymin=0,this.mmin=void 0,this.zmin=void 0,this.xmax=0,this.ymax=0,this.mmax=void 0,this.zmax=void 0}normalizeCtorArgs(t,e,r,i,s){return dte(t)?{spatialReference:t,xmin:0,ymin:0,xmax:0,ymax:0}:typeof t=="object"?(t.spatialReference=t.spatialReference==null?ne.WGS84:t.spatialReference,t):{xmin:t,ymin:e,xmax:r,ymax:i,spatialReference:s??ne.WGS84}}static fromPoint(t){return new Ln({xmin:t.x,ymin:t.y,zmin:t.z,xmax:t.x,ymax:t.y,zmax:t.z,spatialReference:t.spatialReference})}get cache(){return this.commitProperty("xmin"),this.commitProperty("ymin"),this.commitProperty("zmin"),this.commitProperty("mmin"),this.commitProperty("xmax"),this.commitProperty("ymax"),this.commitProperty("zmax"),this.commitProperty("mmax"),this.commitProperty("spatialReference"),{}}get center(){const t=new ge({x:.5*(this.xmin+this.xmax),y:.5*(this.ymin+this.ymax),spatialReference:this.spatialReference});return this.hasZ&&(t.z=.5*(this.zmin+this.zmax)),this.hasM&&(t.m=.5*(this.mmin+this.mmax)),t}get extent(){return this.clone()}get hasM(){return this.mmin!=null&&this.mmax!=null}get hasZ(){return this.zmin!=null&&this.zmax!=null}get height(){return Math.abs(this.ymax-this.ymin)}get width(){return Math.abs(this.xmax-this.xmin)}centerAt(t){const e=this.center;return t.z!=null&&this.hasZ?this.offset(t.x-e.x,t.y-e.y,t.z-e.z):this.offset(t.x-e.x,t.y-e.y)}clone(){const t=new Ln;return t.xmin=this.xmin,t.ymin=this.ymin,t.xmax=this.xmax,t.ymax=this.ymax,t.spatialReference=this.spatialReference,this.zmin!=null&&(t.zmin=this.zmin,t.zmax=this.zmax),this.mmin!=null&&(t.mmin=this.mmin,t.mmax=this.mmax),t}contains(t){if(!t)return!1;const e=this.spatialReference,r=t.spatialReference;return e&&r&&!e.equals(r)&&x1(e,r)&&(t=e.isWebMercator?Jh(t):Oh(t,!0)),t.type==="point"?xv(this,t):t.type==="extent"&&Qee(this,t)}equals(t){if(this===t)return!0;if(t==null)return!1;const e=this.spatialReference,r=t.spatialReference;return e&&r&&!e.equals(r)&&x1(e,r)&&(t=e.isWebMercator?Jh(t):Oh(t,!0)),this.xmin===t.xmin&&this.ymin===t.ymin&&this.zmin===t.zmin&&this.mmin===t.mmin&&this.xmax===t.xmax&&this.ymax===t.ymax&&this.zmax===t.zmax&&this.mmax===t.mmax}expand(t){const e=.5*(1-t),r=this.width*e,i=this.height*e;if(this.xmin+=r,this.ymin+=i,this.xmax-=r,this.ymax-=i,this.hasZ){const s=(this.zmax-this.zmin)*e;this.zmin+=s,this.zmax-=s}if(this.hasM){const s=(this.mmax-this.mmin)*e;this.mmin+=s,this.mmax-=s}return this}intersects(t){if(t==null)return!1;t.type==="mesh"&&(t=t.extent);const e=this.spatialReference,r=t.spatialReference;return e&&r&&!mr(e,r)&&x1(e,r)&&(t=e.isWebMercator?Jh(t):Oh(t,!0)),hte(t.type)(this,t)}normalize(){const t=this._normalize(!1,!0);return Array.isArray(t)?t:[t]}offset(t,e,r){return this.xmin+=t,this.ymin+=e,this.xmax+=t,this.ymax+=e,r!=null&&(this.zmin+=r,this.zmax+=r),this}shiftCentralMeridian(){return this._normalize(!0)}union(t){return this===t||(this.xmin=Math.min(this.xmin,t.xmin),this.ymin=Math.min(this.ymin,t.ymin),this.xmax=Math.max(this.xmax,t.xmax),this.ymax=Math.max(this.ymax,t.ymax),(this.hasZ||t.hasZ)&&(this.zmin=tu(Math.min,this.zmin,t.zmin),this.zmax=tu(Math.max,this.zmax,t.zmax)),(this.hasM||t.hasM)&&(this.mmin=tu(Math.min,this.mmin,t.mmin),this.mmax=tu(Math.max,this.mmax,t.mmax))),this}intersection(t){return this===t?this:t!=null&&this.intersects(t)?(this.xmin=Math.max(this.xmin,t.xmin),this.ymin=Math.max(this.ymin,t.ymin),this.xmax=Math.min(this.xmax,t.xmax),this.ymax=Math.min(this.ymax,t.ymax),(this.hasZ||t.hasZ)&&(this.zmin=tu(Math.max,this.zmin,t.zmin),this.zmax=tu(Math.min,this.zmax,t.zmax)),(this.hasM||t.hasM)&&(this.mmin=tu(Math.max,this.mmin,t.mmin),this.mmax=tu(Math.min,this.mmax,t.mmax)),this):null}toJSON(t){return this.write({},t)}_shiftCM(t=Si(this.spatialReference)){if(!t||!this.spatialReference)return this;const e=this.spatialReference,r=this._getCM(t);if(r){const i=e.isWebMercator?Oh(r):r;this.xmin-=r.x,this.xmax-=r.x,e.isWebMercator||(i.x=$x(i.x,t).x),this.spatialReference=new ne(gc((e.isWGS84?t.altTemplate:null)??t.wkTemplate,{Central_Meridian:i.x}))}return this}_getCM(t){let e=null;const[r,i]=t.valid,s=this.xmin,n=this.xmax;return s>=r&&s<=i&&n>=r&&n<=i||(e=this.center),e}_normalize(t,e,r){const i=this.spatialReference;if(!i)return this;const s=r??Si(i);if(s==null)return this;const n=this._getParts(s).map((l=>l.extent));if(n.length<2)return n[0]||this;if(n.length>2)return t?this._shiftCM(s):this.set({xmin:s.valid[0],xmax:s.valid[1]});if(t)return this._shiftCM(s);if(e)return n;let o=!0,a=!0;return n.forEach((l=>{l.hasZ||(o=!1),l.hasM||(a=!1)})),{rings:n.map((l=>{const u=[[l.xmin,l.ymin],[l.xmin,l.ymax],[l.xmax,l.ymax],[l.xmax,l.ymin],[l.xmin,l.ymin]];if(o){const h=(l.zmax-l.zmin)/2;for(let p=0;p<u.length;p++)u[p].push(h)}if(a){const h=(l.mmax-l.mmin)/2;for(let p=0;p<u.length;p++)u[p].push(h)}return u})),hasZ:o,hasM:a,spatialReference:i}}_getParts(t){let e=this.cache._parts;if(!e){e=[];const{ymin:s,ymax:n,spatialReference:o}=this,a=this.width,l=this.xmin,u=this.xmax;let h;t=t||Si(o);const[p,m]=t.valid;h=$x(this.xmin,t);const y=h.x,g=h.frameId;h=$x(this.xmax,t);const v=h.x,_=h.frameId,b=y===v&&a>0;if(a>2*m){const S=new Ln(l<u?y:v,s,m,n,o),$=new Ln(p,s,l<u?v:y,n,o),T=new Ln(0,s,m,n,o),I=new Ln(p,s,0,n,o),P=[],R=[];S.contains(T)&&P.push(g),S.contains(I)&&R.push(g),$.contains(T)&&P.push(_),$.contains(I)&&R.push(_);for(let D=g+1;D<_;D++)P.push(D),R.push(D);e.push({extent:S,frameIds:[g]},{extent:$,frameIds:[_]},{extent:T,frameIds:P},{extent:I,frameIds:R})}else y>v||b?e.push({extent:new Ln(y,s,m,n,o),frameIds:[g]},{extent:new Ln(p,s,v,n,o),frameIds:[_]}):e.push({extent:new Ln(y,s,v,n,o),frameIds:[g]});this.cache._parts=e}const r=this.hasZ,i=this.hasM;if(r||i){const s={};r&&(s.zmin=this.zmin,s.zmax=this.zmax),i&&(s.mmin=this.mmin,s.mmax=this.mmax);for(let n=0;n<e.length;n++)e[n].extent.set(s)}return e}};function $x(t,e){const[r,i]=e.valid,s=2*i;let n,o=0;return t>i?(n=Math.ceil(Math.abs(t-i)/s),t-=n*s,o=n):t<r&&(n=Math.ceil(Math.abs(t-r)/s),t+=n*s,o=-n),{x:t,frameId:o}}c([d({readOnly:!0})],Le.prototype,"cache",null),c([d({readOnly:!0})],Le.prototype,"center",null),c([d({readOnly:!0})],Le.prototype,"extent",null),c([d({readOnly:!0,json:{write:{enabled:!1,overridePolicy:null}}})],Le.prototype,"hasM",null),c([d({readOnly:!0,json:{write:{enabled:!1,overridePolicy:null}}})],Le.prototype,"hasZ",null),c([d({readOnly:!0})],Le.prototype,"height",null),c([d({readOnly:!0})],Le.prototype,"width",null),c([d({type:Number,json:{type:[Number,String],write:{enabled:!0,allowNull:!0}}})],Le.prototype,"xmin",void 0),c([d({type:Number,json:{write:!0}})],Le.prototype,"ymin",void 0),c([d({type:Number,json:{origins:{"web-scene":{write:!1}},write:{overridePolicy(){return{enabled:this.hasM}}}}})],Le.prototype,"mmin",void 0),c([d({type:Number,json:{origins:{"web-scene":{write:!1}},write:{overridePolicy(){return{enabled:this.hasZ}}}}})],Le.prototype,"zmin",void 0),c([d({type:Number,json:{write:!0}})],Le.prototype,"xmax",void 0),c([d({type:Number,json:{write:!0}})],Le.prototype,"ymax",void 0),c([d({type:Number,json:{origins:{"web-scene":{write:!1}},write:{overridePolicy(){return{enabled:this.hasM}}}}})],Le.prototype,"mmax",void 0),c([d({type:Number,json:{origins:{"web-scene":{write:!1}},write:{overridePolicy(){return{enabled:this.hasZ}}}}})],Le.prototype,"zmax",void 0),Le=Ln=c([C("esri.geometry.Extent")],Le),Le.prototype.toJSON.isDefaultToJSON=!0;let Jg;const pte=globalThis.esriConfig?.locale??globalThis.dojoConfig?.locale,JM=globalThis.document?.documentElement;function yj(){const t=JM?.getAttribute("lang"),e=globalThis.navigator?.language;return pte??t??e??"en"}function hs(){return Jg===void 0&&(Jg=yj()),Jg}const fte=/^(?<language>[a-z]{2,3})(?:-[a-z]{3})?(?:-[A-Z][a-z]{3})?(?:-(?<region>[A-Z]{2}|\d{3}))?(?:-.*)?$/;function $3(t=hs()){return fte.exec(t)?.groups}const M1=[];function M3(t){return M1.push(t),He((()=>{M1.splice(M1.indexOf(t),1)}))}const T1=[];function T3(t){return T1.push(t),He((()=>T1.splice(T1.indexOf(t),1)))}function XR(){const t=yj();Jg!==t&&([...T1].forEach((e=>e(t))),Jg=t,[...M1].forEach((e=>e(t))))}globalThis.addEventListener?.("languagechange",XR),JM&&new MutationObserver((()=>{XR()})).observe(JM,{attributeFilter:["lang"]});let n_;function mte(t){return n_&&!n_.destroyed||(n_=t()),n_}var YM;const yte=new De({avgRating:"avg-rating",numRatings:"num-ratings",numComments:"num-comments",numViews:"num-views"});let Kt=YM=class extends ce{constructor(t){super(t),this.categories=null,this.disableExtraQuery=!1,this.extent=null,this.filter=null,this.num=10,this.query=null,this.sortField=null,this.start=1}get sortOrder(){return this._get("sortOrder")||"asc"}set sortOrder(t){t!=="asc"&&t!=="desc"||this._set("sortOrder",t)}clone(){return new YM({categories:this.categories?k(this.categories):null,disableExtraQuery:this.disableExtraQuery,extent:this.extent?this.extent.clone():null,filter:this.filter,num:this.num,query:this.query,sortField:this.sortField,sortOrder:this.sortOrder,start:this.start})}toRequestOptions(t,e){let r=[];this.categories&&(r=this.categories.map((o=>Array.isArray(o)?JSON.stringify(o):o)));let i="";if(this.extent){const o=QS(this.extent,ne.WGS84);o!=null&&(i=`${o.xmin},${o.ymin},${o.xmax},${o.ymax}`)}let s=this.query;!this.disableExtraQuery&&t.extraQuery&&(s="("+s+")"+t.extraQuery);const n={categories:r,bbox:i,q:s,filter:this.filter,num:this.num,sortField:null,sortOrder:null,start:this.start};return this.sortField&&(n.sortField=this.sortField.split(",").map((o=>yte.toJSON(o.trim()))).join(","),n.sortOrder=this.sortOrder),{query:{...e,...n}}}};c([d()],Kt.prototype,"categories",void 0),c([d()],Kt.prototype,"disableExtraQuery",void 0),c([d({type:Le})],Kt.prototype,"extent",void 0),c([d()],Kt.prototype,"filter",void 0),c([d()],Kt.prototype,"num",void 0),c([d()],Kt.prototype,"query",void 0),c([d()],Kt.prototype,"sortField",void 0),c([d()],Kt.prototype,"sortOrder",null),c([d()],Kt.prototype,"start",void 0),Kt=YM=c([C("esri.portal.PortalQueryParams")],Kt);var XM;let Jt=XM=class extends W{constructor(t){super(t),this.access=null,this.created=null,this.description=null,this.id=null,this.isInvitationOnly=!1,this.modified=null,this.owner=null,this.portal=null,this.snippet=null,this.sortField=null,this.sortOrder=null,this.sourceJSON=null,this.tags=null,this.title=null}get thumbnailUrl(){const t=this.url,e=this.thumbnail;return t&&e&&this.portal?this.portal?.normalizeUrl(`${t}/info/${e}?f=json`):null}get url(){const t=this.portal?.restUrl;return t?t+"/community/groups/"+this.id:null}fetchCategorySchema(t){return this.portal.request(this.url+"/categorySchema",t).then((e=>{const r=e.categorySchema||[];return r.some((i=>i.source==="contentCategorySetsGroupQuery.LivingAtlas"))?this._fetchCategorySchemaSet("LivingAtlas",t):r}))}fetchMembers(t){return this.portal.request(this.url+"/users",t)}getThumbnailUrl(t){let e=this.thumbnailUrl;return e&&t&&(e+=`&w=${t}`),e}toJSON(){throw new F("internal:not-yet-implemented","PortalGroup.toJSON is not yet implemented")}static fromJSON(t){if(!t)return null;if(t.declaredClass)throw new Error("JSON object is already hydrated");const e=new XM({sourceJSON:t});return e.read(t),e}queryItems(t,e){let r=br(Kt,t);const i=this.portal;return parseFloat(i.currentVersion)>5?(r=r||new Kt,i.queryPortal(`/content/groups/${this.id}/search`,r,"PortalItem",e)):(r=r?r.clone():new Kt,r.query="group:"+this.id+(r.query?" "+r.query:""),i.queryItems(r,e))}_fetchCategorySchemaSet(t,e){const r=this.portal;return r.fetchSelf(r.authMode,!0,e).then((i=>{const s=i.contentCategorySetsGroupQuery;if(s){const n=new Kt({disableExtraQuery:!0,num:1,query:s});return r.queryGroups(n,e)}throw new F("portal-group:fetchCategorySchema","contentCategorySetsGroupQuery value not found")})).then((i=>{if(i.total){const s=i.results[0],n=new Kt({num:1,query:`typekeywords:"${t}"`});return s.queryItems(n,e)}throw new F("portal-group:fetchCategorySchema","contentCategorySetsGroupQuery group not found")})).then((i=>i.total?i.results[0].fetchData("json",e).then((s=>{const n=s?.categorySchema;return n?.length?n:[]})):[]))}};c([d()],Jt.prototype,"access",void 0),c([d({type:Date})],Jt.prototype,"created",void 0),c([d()],Jt.prototype,"description",void 0),c([d()],Jt.prototype,"id",void 0),c([d()],Jt.prototype,"isInvitationOnly",void 0),c([d({type:Date})],Jt.prototype,"modified",void 0),c([d()],Jt.prototype,"owner",void 0),c([d()],Jt.prototype,"portal",void 0),c([d()],Jt.prototype,"snippet",void 0),c([d()],Jt.prototype,"sortField",void 0),c([d()],Jt.prototype,"sortOrder",void 0),c([d()],Jt.prototype,"sourceJSON",void 0),c([d()],Jt.prototype,"tags",void 0),c([d()],Jt.prototype,"thumbnail",void 0),c([d({readOnly:!0})],Jt.prototype,"thumbnailUrl",null),c([d()],Jt.prototype,"title",void 0),c([d({readOnly:!0})],Jt.prototype,"url",null),Jt=XM=c([C("esri.portal.PortalGroup")],Jt);let Vc=class extends ce{constructor(e){super(e),this.nextQueryParams=null,this.queryParams=null,this.results=null,this.total=null}};c([d()],Vc.prototype,"nextQueryParams",void 0),c([d()],Vc.prototype,"queryParams",void 0),c([d()],Vc.prototype,"results",void 0),c([d()],Vc.prototype,"total",void 0),Vc=c([C("esri.portal.PortalQueryResult")],Vc);let Ba=class extends W{constructor(e){super(e),this.created=null,this.id=null,this.portal=null,this.title=null,this.username=null}get url(){const e=this.portal?.restUrl;return e?`${e}/content/users/${this.username}/${this.id}`:null}toJSON(){throw new F("internal:not-yet-implemented","PortalFolder.toJSON is not yet implemented")}};c([d({type:Date})],Ba.prototype,"created",void 0),c([d()],Ba.prototype,"id",void 0),c([d()],Ba.prototype,"portal",void 0),c([d()],Ba.prototype,"title",void 0),c([d({readOnly:!0})],Ba.prototype,"url",null),c([d()],Ba.prototype,"username",void 0),Ba=c([C("esri.portal.PortalFolder")],Ba);var KM;let at=KM=class extends W{constructor(t){super(t),this.access=null,this.created=null,this.culture=null,this.description=null,this.email=null,this.fullName=null,this.id=null,this.modified=null,this.orgId=null,this.portal=null,this.preferredView=null,this.privileges=null,this.region=null,this.role=null,this.roleId=null,this.sourceJSON=null,this.units=null,this.username=null,this.userLicenseTypeId=null,this.userType=null}get thumbnailUrl(){const t=this.url,e=this.thumbnail;return t&&e?this.portal.normalizeUrl(`${t}/info/${e}?f=json`):null}get userContentUrl(){const t=this.portal?.restUrl;return t?`${t}/content/users/${this.id}`:null}get url(){const t=this.portal?.restUrl;return t?`${t}/community/users/${this.id}`:null}addItem(t){const e=t&&t.item,r=t?.data,i=t?.folder,s={method:"post"};e&&(s.query=e.createPostQuery(),r!=null&&(typeof r=="string"?s.query.text=r:typeof r=="object"&&(s.query.text=JSON.stringify(r))));let n=this.userContentUrl;return i&&(n+="/"+(typeof i=="string"?i:i.id)),this.portal.request(n+"/addItem",s).then((o=>(e.id=o.id,e.portal=this.portal,e.loaded?e.reload():e.load())))}async deleteItem(t,e=!1){let r=this.userContentUrl;t.ownerFolder&&(r+="/"+t.ownerFolder);const i=e?{permanentDelete:!0}:{};await this.portal.request(r+`/items/${t.id}/delete`,{method:"post",query:i}),t.id=null,t.portal=null}async deleteItems(t,e=!1){t=t.slice();const r=this.userContentUrl+"/deleteItems",i=[],s=t.map((n=>n.id));if(s.length){const n={method:"post",query:{items:s.join(","),permanentDelete:e}},o=await this.portal.request(r,n);for(const a of o.results){const l=t.find((p=>a.itemId===p.id)),u=a.success;let h=null;u?(l.id=null,l.portal=null):a.error&&(h=new F("portal:delete-item-failed",a.error.message,a.error)),i.push({item:l,success:u,error:h})}}return i}fetchFolders(){const t={query:{num:1}};return this.portal.request(this.userContentUrl??"",t).then((e=>{let r;return r=e&&e.folders?e.folders.map((i=>{const s=Ba.fromJSON(i);return s.portal=this.portal,s})):[],r}))}fetchGroups(){return this.portal.request(this.url??"").then((t=>{let e;return e=t&&t.groups?t.groups.map((r=>{const i=Jt.fromJSON(r);return i.portal=this.portal,i})):[],e}))}async fetchItems(t){t??={};let e=this.userContentUrl??"";t.folder&&(e+="/"+t.folder.id);const{default:r}=await J(()=>Promise.resolve().then(()=>gj),void 0),i={folders:!1,inRecycleBin:!!t.inRecycleBin||null,foldersContent:!(t.folder||!t.includeSubfolderItems)||null,num:t.num||10,start:t.start||1,sortField:t.sortField||"created",sortOrder:t.sortOrder||"asc"},s=await this.portal.request(e,{query:i});let n;return s?.items?(n=s.items.map((o=>{const a=r.fromJSON(o);return a.portal=this.portal,a})),await Promise.all(n.map((o=>o.load()))),{items:n,nextStart:s.nextStart,total:s.total}):{items:[],nextStart:-1,total:0}}fetchTags(){return this.portal.request(this.url+"/tags").then((t=>t.tags))}getThumbnailUrl(t){let e=this.thumbnailUrl;return e&&t&&(e+=`&w=${t}`),e}queryFavorites(t){return this.favGroupId?(this._favGroup||(this._favGroup=new Jt({id:this.favGroupId,portal:this.portal})),this._favGroup.queryItems(t)):Promise.reject(new F("internal:unknown","Unknown internal error",{internalError:"Unknown favGroupId"}))}async restoreItem(t,e){const r=this.userContentUrl,i=e?{folderID:typeof e=="string"?e:e.id}:null;await this.portal.request(r+`/items/${t.id}/restore`,{method:"post",query:i})}toJSON(){throw new F("internal:not-yet-implemented","PortalUser.toJSON is not yet implemented")}static fromJSON(t){if(!t)return null;if(t.declaredClass)throw new Error("JSON object is already hydrated");const e=new KM({sourceJSON:t});return e.read(t),e}};c([d()],at.prototype,"access",void 0),c([d({type:Date})],at.prototype,"created",void 0),c([d()],at.prototype,"culture",void 0),c([d()],at.prototype,"description",void 0),c([d()],at.prototype,"email",void 0),c([d()],at.prototype,"favGroupId",void 0),c([d()],at.prototype,"fullName",void 0),c([d()],at.prototype,"id",void 0),c([d({type:Date})],at.prototype,"modified",void 0),c([d()],at.prototype,"orgId",void 0),c([d()],at.prototype,"portal",void 0),c([d()],at.prototype,"preferredView",void 0),c([d()],at.prototype,"privileges",void 0),c([d()],at.prototype,"region",void 0),c([d()],at.prototype,"role",void 0),c([d()],at.prototype,"roleId",void 0),c([d()],at.prototype,"sourceJSON",void 0),c([d()],at.prototype,"thumbnail",void 0),c([d({readOnly:!0})],at.prototype,"thumbnailUrl",null),c([d()],at.prototype,"units",void 0),c([d({readOnly:!0})],at.prototype,"userContentUrl",null),c([d({readOnly:!0})],at.prototype,"url",null),c([d()],at.prototype,"username",void 0),c([d()],at.prototype,"userLicenseTypeId",void 0),c([d()],at.prototype,"userType",void 0),at=KM=c([C("esri.portal.PortalUser")],at);var ys;let iy;const KR={PortalGroup:()=>Promise.resolve({default:Jt}),PortalItem:()=>J(()=>Promise.resolve().then(()=>gj),void 0),PortalUser:()=>Promise.resolve({default:at})};var Bo;let Y=(Bo=class extends W.JSONSupportMixin(Ls){constructor(e){super(e),this._esriIdCredentialCreateHandle=null,this.access=null,this.allSSL=!1,this.authMode="auto",this.authorizedCrossOriginDomains=null,this.basemapGalleryGroupQuery=null,this.basemapGalleryGroupQuery3D=null,this.bingKey=null,this.canListApps=!1,this.canListData=!1,this.canListPreProvisionedItems=!1,this.canProvisionDirectPurchase=!1,this.canSearchPublic=!0,this.canShareBingPublic=!1,this.canSharePublic=!1,this.canSignInArcGIS=!1,this.canSignInIDP=!1,this.colorSetsGroupQuery=null,this.commentsEnabled=!1,this.created=null,this.culture=null,this.customBaseUrl=null,this.default3DBasemapQuery=null,this.defaultBasemap=null,this.defaultDevBasemap=null,this.defaultExtent=null,this.defaultVectorBasemap=null,this.description=null,this.devBasemapGalleryGroupQuery=null,this.eueiEnabled=null,this.featuredGroups=null,this.featuredItemsGroupQuery=null,this.galleryTemplatesGroupQuery=null,this.layoutGroupQuery=null,this.livingAtlasGroupQuery=null,this.hasCategorySchema=!1,this.hasClassificationSchema=!1,this.helperServices=null,this.homePageFeaturedContent=null,this.homePageFeaturedContentCount=null,this.httpPort=null,this.httpsPort=null,this.id=null,this.ipCntryCode=null,this.isPortal=!1,this.isReadOnly=!1,this.layerTemplatesGroupQuery=null,this.maxTokenExpirationMinutes=null,this.modified=null,this.name=null,this.portalHostname=null,this.portalMode=null,this.portalProperties=null,this.region=null,this.recycleBinEnabled=!1,this.rotatorPanels=null,this.showHomePageDescription=!1,this.sourceJSON=null,this.supportsHostedServices=!1,this.symbolSetsGroupQuery=null,this.templatesGroupQuery=null,this.units=null,this.url=Ge.portalUrl,this.urlKey=null,this.user=null,this.use3dBasemaps=!0,this.useDefault3dBasemap=!1,this.useStandardizedQuery=!1,this.useVectorBasemaps=!1,this.vectorBasemapGalleryGroupQuery=null}normalizeCtorArgs(e){return typeof e=="string"?{url:e}:e}destroy(){QR.unregister(this),this.defaultBasemap=At(this.defaultBasemap),this.defaultDevBasemap=At(this.defaultDevBasemap),this.defaultVectorBasemap=At(this.defaultVectorBasemap),this._esriIdCredentialCreateHandle=Lt(this._esriIdCredentialCreateHandle)}readAuthorizedCrossOriginDomains(e){if(e)for(const r of e)Ge.request.trustedServers.includes(r)||Ge.request.trustedServers.push(r);return e}readDefaultBasemap(e){return this._readBasemap(e)}readDefaultDevBasemap(e){return this._readBasemap(e)}readDefaultVectorBasemap(e){return this._readBasemap(e)}get extraQuery(){const e=this.user?.orgId,r=!e||this.canSearchPublic;return this.id&&!r?` AND orgid:${this.id}`:null}get hasAPIKey(){return zX(this.restUrl)}get isOrganization(){return!!this.access}get itemPageUrl(){return this.url?`${this.url}/home/item.html`:null}get restUrl(){let e=this.url;if(e){const r=e.indexOf("/sharing");e=r>0?e.slice(0,r):this.url.replace(/\/+$/,""),e+="/sharing/rest"}return e}get thumbnailUrl(){const e=this.restUrl,r=this.thumbnail;return e&&r?this._normalizeSSL(e+"/portals/self/resources/"+r):null}readUrlKey(e){return e&&e.toLowerCase()}readUser(e){let r=null;return e&&(r=at.fromJSON(e),r.portal=this),r}load(e){const r=J(()=>Promise.resolve().then(()=>fse),void 0).then((({default:i})=>{xt(e),iy=i})).then((()=>this.sourceJSON?this.sourceJSON:this.fetchSelf(this.authMode,!1,e))).then((i=>{if(!this.hasAPIKey&&Ve){const s=Ve;this.credential=s.findCredential(this.restUrl),this.credential||this.authMode!==ys.AUTH_MODE_AUTO&&this.authMode!==ys.AUTH_MODE_NO_PROMPT||(this._esriIdCredentialCreateHandle?.remove(),this._esriIdCredentialCreateHandle=s.on("credential-create",gte(new WeakRef(this))),QR.register(this,this._esriIdCredentialCreateHandle,this))}this.sourceJSON=i,this.read(i)}));return this.addResolvingPromise(r),Promise.resolve(this)}async createElevationLayers(){await this.load();const e=this._getHelperService("defaultElevationLayers"),r=(await J(async()=>{const{default:i}=await import("./ElevationLayer-CXHp7esL.js");return{default:i}},__vite__mapDeps([0,1,2,3,4,5]))).default;return e?e.map((i=>new r({id:i.id,url:i.url}))):[]}async fetchBasemaps(e,r){const i=await this._fetchBasemaps(e,r);if(r?.include3d===!0&&this.use3dBasemaps!==!1){const s=await this._fetchBasemaps3D(e,r);i.unshift(...s)}return i}async fetchDefault3DBasemap(e){if(!this.useDefault3dBasemap||!this.default3DBasemapQuery||this.default3DBasemapQuery==="none")return null;const r=new Kt;r.query=this.default3DBasemapQuery,r.disableExtraQuery=!0;const i=(await this.queryItems(r,e)).results.find((s=>s.type==="Web Scene"));return i?new iy({portalItem:i}):null}fetchCategorySchema(e){return this.hasCategorySchema?this.request(this.restUrl+"/portals/self/categorySchema",e).then((r=>r.categorySchema)):yn(e)?Promise.reject(St()):Promise.resolve([])}async fetchClassificationSchema(e){return this.hasClassificationSchema?this.request(this.restUrl+"/portals/self/classification/classificationSchema",e).then((r=>r.classificationSchema)):null}fetchFeaturedGroups(e){const r=this.featuredGroups,i=new Kt({num:100,sortField:"title"});if(r?.length){const s=[];for(const n of r)s.push(`(title:"${n.title}" AND owner:${n.owner})`);return i.query=s.join(" OR "),this.queryGroups(i,e).then((n=>n.results))}return yn(e)?Promise.reject(St()):Promise.resolve([])}fetchRegions(e){const r=this.user?.culture||this.culture||hs();return this.request(this.restUrl+"/portals/regions",{...e,query:{culture:r}})}fetchSettings(e){const r=this.user?.culture||this.culture||hs();return this.request(this.restUrl+"/portals/self/settings",{...e,query:{culture:r}})}static getDefault(){return mte((()=>new ys))}queryGroups(e,r){return this.queryPortal("/community/groups",e,"PortalGroup",r)}queryItems(e,r){return this.queryPortal("/search",e,"PortalItem",r)}queryUsers(e,r){return e.sortField||(e.sortField="username"),this.queryPortal("/community/users",e,"PortalUser",r)}fetchSelf(e=this.authMode,r=!1,i){const s=this.restUrl+"/portals/self",n={authMode:e,query:{culture:hs().toLowerCase()},withCredentials:!0,...i};return n.authMode==="auto"&&(n.authMode="no-prompt"),r&&(n.query.default=!0),this.request(s,n)}queryPortal(e,r,i,s){const n=br(Kt,r),o=a=>this.request(this.restUrl+e,{...n.toRequestOptions(this),...s}).then((l=>{const u=n.clone();return u.start=l.nextStart,new Vc({nextQueryParams:u,queryParams:n,total:l.total,results:ys._resultsToTypedArray(a,{portal:this},l,s)})})).then((l=>Promise.all(l.results.map((u=>typeof u.when=="function"?u.when():l))).then((()=>l),(u=>(Do(u),l)))));return i&&KR[i]?KR[i]().then((({default:a})=>(xt(s),o(a)))):o()}signIn(){if(this.hasAPIKey)return this.load().then((()=>{if(!this.user)throw new F("portal:not-authenticated","Unable to authenticate user. Portal.user is missing")}));if(this.authMode===ys.AUTH_MODE_ANONYMOUS||this.authMode===ys.AUTH_MODE_NO_PROMPT&&!Ve)return Promise.reject(new F("portal:invalid-auth-mode",`Current "authMode"' is "${this.authMode}"`));if(this.loadStatus==="failed")return Promise.reject(this.loadError);const e=r=>Promise.resolve().then((()=>this.loadStatus==="not-loaded"?(r||(this.authMode="immediate"),this.load().then((()=>null))):this.loadStatus==="loading"?this.load().then((()=>this.credential?null:(this.credential=r,this.fetchSelf("immediate")))):this.user&&this.credential===r?null:(this.credential=r,this.fetchSelf("immediate")))).then((i=>{i&&(this.sourceJSON=i,this.read(i))}));return Ve?Ve.getCredential(this.restUrl,{prompt:this.authMode!==ys.AUTH_MODE_NO_PROMPT}).then((r=>e(r))):e(this.credential)}normalizeUrl(e){const r=this.credential?.token;return this._normalizeSSL(r?e+(e.includes("?")?"&":"?")+"token="+r:e)}requestToTypedArray(e,r,i){return this.request(e,r).then((s=>{const n=ys._resultsToTypedArray(i,{portal:this},s);return Promise.all(n.map((o=>typeof o.when=="function"?o.when():s))).then((()=>n),(()=>n))}))}request(e,r={}){const i={f:"json",...r.query},{authMode:s=this.authMode===ys.AUTH_MODE_ANONYMOUS||this.authMode===ys.AUTH_MODE_NO_PROMPT?this.authMode:"auto",body:n=null,cacheBust:o=!1,method:a="auto",responseType:l="json",signal:u}=r,h={authMode:s,body:n,cacheBust:o,method:a,query:i,responseType:l,timeout:0,signal:u};return r.withCredentials&&(h.withCredentials=!0),et(this._normalizeSSL(e),h).then((p=>p.data))}toJSON(){throw new F("internal:not-yet-implemented","Portal.toJSON is not yet implemented")}static fromJSON(e){if(!e)return null;if(e.declaredClass)throw new Error("JSON object is already hydrated");return new ys({sourceJSON:e})}_getHelperService(e){const r=this.helperServices&&this.helperServices[e];if(!r)throw new F("portal:service-not-found",`The \`helperServices\` do not include an entry named "${e}"`);return r}async _fetchBasemaps(e,r){const i=new Kt;i.query=e||(bM()?this.devBasemapGalleryGroupQuery:this.useVectorBasemaps?this.vectorBasemapGalleryGroupQuery:this.basemapGalleryGroupQuery),i.disableExtraQuery=!0;const s=await this.queryGroups(i,r);if(!s.total)return[];const n=s.results[0];i.num=100,i.query='type:"Web Map" -type:"Web Application"',i.sortField=n.sortField||"name",i.sortOrder=n.sortOrder||"desc";const o=await n.queryItems(i,r);return o.total?o.results.filter((a=>a.type==="Web Map")).map((a=>new iy({portalItem:a}))):[]}async _fetchBasemaps3D(e,r){const i=e||this.basemapGalleryGroupQuery3D;if(!i)return[];if(bM())return[];const s=new Kt({query:i,disableExtraQuery:!0}),n=await this.queryGroups(s,r);if(!n.total)return[];const o=n.results[0];s.num=100,s.query='type:"Web Scene"',s.sortField=o.sortField||"name",s.sortOrder=o.sortOrder||"desc";const a=await o.queryItems(s,r);return a.total?a.results.filter((l=>l.type==="Web Scene")).map((l=>new iy({portalItem:l}))):[]}_normalizeSSL(e){return e.replace(/^http:/i,"https:").replace(":7080",":7443")}_readBasemap(e){if(e){const r=iy.fromJSON(e);return r.portalItem={portal:this},r}return null}static _resultsToTypedArray(e,r,i,s){let n;if(i){const o=s!=null?s.signal:null;n=i.listings||i.notifications||i.userInvitations||i.tags||i.items||i.groups||i.comments||i.provisions||i.results||i.relatedItems||i,(e||r)&&(n=n.map((a=>{const l=Object.assign(e?e.fromJSON(a):a,r);return typeof l.load=="function"&&l.load(o),l})))}else n=[];return n}},ys=Bo,Bo.AUTH_MODE_ANONYMOUS="anonymous",Bo.AUTH_MODE_AUTO="auto",Bo.AUTH_MODE_IMMEDIATE="immediate",Bo.AUTH_MODE_NO_PROMPT="no-prompt",Bo);c([d()],Y.prototype,"access",void 0),c([d()],Y.prototype,"allSSL",void 0),c([d()],Y.prototype,"authMode",void 0),c([d()],Y.prototype,"authorizedCrossOriginDomains",void 0),c([K("authorizedCrossOriginDomains")],Y.prototype,"readAuthorizedCrossOriginDomains",null),c([d()],Y.prototype,"basemapGalleryGroupQuery",void 0),c([d({json:{name:"3DBasemapGalleryGroupQuery"}})],Y.prototype,"basemapGalleryGroupQuery3D",void 0),c([d()],Y.prototype,"bingKey",void 0),c([d()],Y.prototype,"canListApps",void 0),c([d()],Y.prototype,"canListData",void 0),c([d()],Y.prototype,"canListPreProvisionedItems",void 0),c([d()],Y.prototype,"canProvisionDirectPurchase",void 0),c([d()],Y.prototype,"canSearchPublic",void 0),c([d()],Y.prototype,"canShareBingPublic",void 0),c([d()],Y.prototype,"canSharePublic",void 0),c([d()],Y.prototype,"canSignInArcGIS",void 0),c([d()],Y.prototype,"canSignInIDP",void 0),c([d()],Y.prototype,"colorSetsGroupQuery",void 0),c([d()],Y.prototype,"commentsEnabled",void 0),c([d({type:Date})],Y.prototype,"created",void 0),c([d()],Y.prototype,"credential",void 0),c([d()],Y.prototype,"culture",void 0),c([d()],Y.prototype,"currentVersion",void 0),c([d()],Y.prototype,"customBaseUrl",void 0),c([d()],Y.prototype,"default3DBasemapQuery",void 0),c([d()],Y.prototype,"defaultBasemap",void 0),c([K("defaultBasemap")],Y.prototype,"readDefaultBasemap",null),c([d()],Y.prototype,"defaultDevBasemap",void 0),c([K("defaultDevBasemap")],Y.prototype,"readDefaultDevBasemap",null),c([d({type:Le})],Y.prototype,"defaultExtent",void 0),c([d()],Y.prototype,"defaultVectorBasemap",void 0),c([K("defaultVectorBasemap")],Y.prototype,"readDefaultVectorBasemap",null),c([d()],Y.prototype,"description",void 0),c([d()],Y.prototype,"devBasemapGalleryGroupQuery",void 0),c([d()],Y.prototype,"eueiEnabled",void 0),c([d({readOnly:!0})],Y.prototype,"extraQuery",null),c([d()],Y.prototype,"featuredGroups",void 0),c([d()],Y.prototype,"featuredItemsGroupQuery",void 0),c([d()],Y.prototype,"galleryTemplatesGroupQuery",void 0),c([d()],Y.prototype,"layoutGroupQuery",void 0),c([d()],Y.prototype,"livingAtlasGroupQuery",void 0),c([d({readOnly:!0})],Y.prototype,"hasAPIKey",null),c([d()],Y.prototype,"hasCategorySchema",void 0),c([d()],Y.prototype,"hasClassificationSchema",void 0),c([d()],Y.prototype,"helpBase",void 0),c([d()],Y.prototype,"helperServices",void 0),c([d()],Y.prototype,"helpMap",void 0),c([d()],Y.prototype,"homePageFeaturedContent",void 0),c([d()],Y.prototype,"homePageFeaturedContentCount",void 0),c([d()],Y.prototype,"httpPort",void 0),c([d()],Y.prototype,"httpsPort",void 0),c([d()],Y.prototype,"id",void 0),c([d()],Y.prototype,"ipCntryCode",void 0),c([d({readOnly:!0})],Y.prototype,"isOrganization",null),c([d()],Y.prototype,"isPortal",void 0),c([d()],Y.prototype,"isReadOnly",void 0),c([d({readOnly:!0})],Y.prototype,"itemPageUrl",null),c([d()],Y.prototype,"layerTemplatesGroupQuery",void 0),c([d()],Y.prototype,"maxTokenExpirationMinutes",void 0),c([d({type:Date})],Y.prototype,"modified",void 0),c([d()],Y.prototype,"name",void 0),c([d()],Y.prototype,"portalHostname",void 0),c([d()],Y.prototype,"portalMode",void 0),c([d()],Y.prototype,"portalProperties",void 0),c([d()],Y.prototype,"region",void 0),c([d()],Y.prototype,"recycleBinEnabled",void 0),c([d({readOnly:!0})],Y.prototype,"restUrl",null),c([d()],Y.prototype,"rotatorPanels",void 0),c([d()],Y.prototype,"showHomePageDescription",void 0),c([d()],Y.prototype,"sourceJSON",void 0),c([d()],Y.prototype,"staticImagesUrl",void 0),c([d({json:{name:"2DStylesGroupQuery"}})],Y.prototype,"stylesGroupQuery2d",void 0),c([d({json:{name:"stylesGroupQuery"}})],Y.prototype,"stylesGroupQuery3d",void 0),c([d()],Y.prototype,"supportsHostedServices",void 0),c([d()],Y.prototype,"symbolSetsGroupQuery",void 0),c([d()],Y.prototype,"templatesGroupQuery",void 0),c([d()],Y.prototype,"thumbnail",void 0),c([d({readOnly:!0})],Y.prototype,"thumbnailUrl",null),c([d()],Y.prototype,"units",void 0),c([d()],Y.prototype,"url",void 0),c([d()],Y.prototype,"urlKey",void 0),c([K("urlKey")],Y.prototype,"readUrlKey",null),c([d()],Y.prototype,"user",void 0),c([K("user")],Y.prototype,"readUser",null),c([d()],Y.prototype,"use3dBasemaps",void 0),c([d()],Y.prototype,"useDefault3dBasemap",void 0),c([d()],Y.prototype,"useStandardizedQuery",void 0),c([d()],Y.prototype,"useVectorBasemaps",void 0),c([d()],Y.prototype,"vectorBasemapGalleryGroupQuery",void 0),Y=ys=c([C("esri.portal.Portal")],Y);const QR=new FinalizationRegistry((t=>{t.remove()}));function gte(t){const e=Ve;return()=>{const r=t.deref();r&&e.findCredential(r.restUrl)&&r.signIn().catch((()=>{}))}}let qa=class extends ce{constructor(e){super(e),this.portalItem=null}normalizeCtorArgs(e){return e?.portalItem&&e.path?{...e,path:ek(e.path,e.portalItem)}:e}set path(e){e!=null&&cs(e)?q.getLogger(this).error("portalitemresource:invalid-path","A portal item resource path must be relative"):this._set("path",e)}_castPath(e){return ek(e,this.portalItem)}get url(){return this.portalItem&&this.path?`${this.portalItem.itemUrl}/resources/${this.path}`:null}get cdnUrl(){return this.portalItem&&this.path?`${this.portalItem.itemCdnUrl}/resources/${this.path}`:null}get itemRelativeUrl(){return this.portalItem&&this.path?`./resources/${this.path}`:null}fetch(e="json",r){const i=this.cdnUrl;if(i==null)throw new F("portal-item-resource:fetch","Portal item resource does not refer to a valid item or path");return this.portalItem.portal.request(i,{responseType:e,query:{token:this.portalItem.apiKey,_ts:r?.cacheBust?Date.now():null},signal:r?.signal})}async update(e,r){const{addOrUpdateResources:i}=await J(()=>import("./resourceUtils-Z5-Yru0O.js"),[]);return await i(this.portalItem,[{resource:this,content:e,compress:r?.compress,access:r?.access}],"update",r),this}hasPath(){return this.path!=null}};function ek(t,e){return t==null?t:(t=t.replace(/^\/+/,""),e!=null&&cs(t)&&(t=HP(t,e.itemUrl)),t?.replace(/^\/+/,"").replace(/^(\.\/)?resources\//,""))}c([d()],qa.prototype,"portalItem",void 0),c([d({type:String,value:null})],qa.prototype,"path",null),c([We("path")],qa.prototype,"_castPath",null),c([d({type:String,readOnly:!0})],qa.prototype,"url",null),c([d({type:String,readOnly:!0})],qa.prototype,"cdnUrl",null),c([d({type:String,readOnly:!0})],qa.prototype,"itemRelativeUrl",null),qa=c([C("esri.portal.PortalItemResource")],qa);let Nh=class extends ce{constructor(e){super(e),this.created=null,this.rating=null}};c([d({type:Date})],Nh.prototype,"created",void 0),c([d()],Nh.prototype,"rating",void 0),Nh=c([C("esri.portal.PortalRating")],Nh);var jc;const vte=new Set(["3DTiles Service","CSV","Feature Collection","Feature Service","Feed","GeoJson","Group Layer","Image Service","KML","Knowledge Graph Layer","Map Service","Media Layer","Scene Service","Stream Service","Video Service","Vector Tile Service","WCS","WFS","WMS","WMTS"]),_te=new Set(["KML","GeoJson","CSV"]);let Ee=jc=class extends W.JSONSupportMixin(Ls){static from(t){return km(jc,t)}constructor(t){super(t),this.access=null,this.accessInformation=null,this.apiKey=null,this.applicationProxies=null,this.avgRating=null,this.categories=null,this.classification=null,this.created=null,this.culture=null,this.description=null,this.extent=null,this.groupCategories=null,this.id=null,this.isOrgItem=!1,this.itemControl=null,this.licenseInfo=null,this.modified=null,this.name=null,this.numComments=null,this.numRatings=null,this.numViews=null,this.owner=null,this.ownerFolder=null,this.portal=null,this.screenshots=null,this.size=null,this.snippet=null,this.sourceJSON=null,this.sourceUrl=null,this.spatialReference=null,this.tags=null,this.title=null,this.type=null,this.typeKeywords=null,this.url=null}destroy(){this.portal=null}get displayName(){const t=this.type,e=this.typeKeywords||[];let r=t;return t==="Feature Service"||t==="Feature Collection"?r=e.includes("Table")?"Table":e.includes("Route Layer")?"Route Layer":e.includes("Markup")?"Markup":"Feature Layer":t==="Image Service"?r=e.includes("Elevation 3D Layer")?"Elevation Layer":e.includes("Tiled Imagery")?"Tiled Imagery Layer":"Imagery Layer":t==="Scene Service"?r="Scene Layer":t==="Video Service"?r="Video Layer":t==="Scene Package"?r="Scene Layer Package":t==="Stream Service"?r="Feature Layer":t==="Geoprocessing Service"?r=e.includes("Web Tool")?"Tool":"Geoprocessing Service":t==="Geoenrichment Service"?r="GeoEnrichment Service":t==="Geocoding Service"?r="Locator":t==="Microsoft Powerpoint"?r="Microsoft PowerPoint":t==="GeoJson"?r="GeoJSON":t==="Globe Service"?r="Globe Layer":t==="Vector Tile Service"?r="Tile Layer":t==="netCDF"?r="NetCDF":t==="Map Service"?r=e.includes("Spatiotemporal")||!e.includes("Hosted Service")&&!e.includes("Tiled")||e.includes("Relational")?"Map Image Layer":"Tile Layer":t?.toLowerCase().includes("add in")?r=t.replaceAll(/(add in)/gi,"Add-In"):t==="datastore catalog service"?r="Big Data File Share":t==="Compact Tile Package"?r="Tile Package (tpkx)":t==="Raster function template"?r="Raster Function Template":t==="OGCFeatureServer"?r="OGC Feature Layer":t==="web mapping application"&&e.includes("configurableApp")?r="Instant App":t==="Insights Page"?r="Insights Report":t==="Excalibur Imagery Project"?r="Excalibur Project":t==="3DTiles Service"?r="3D tiles layer":t==="3DTiles Package"&&(r="3D tiles package"),r}readExtent(t){return t&&t.length?new Le(t[0][0],t[0][1],t[1][0],t[1][1]):null}get iconUrl(){const t=this.type?.toLowerCase()||"",e=this.typeKeywords||[],r="esri/images/portal/",i="16";let s,n=!1,o=!1,a=!1,l=!1,u=!1,h=!1,p=!1,m=!1;return t.indexOf("service")>0||t==="feature collection"||t==="kml"||t==="wms"||t==="wmts"||t==="wfs"?(n=e.includes("Hosted Service"),t==="feature service"||t==="feature collection"||t==="kml"||t==="wfs"?(o=e.includes("Table"),a=e.includes("Route Layer"),l=e.includes("Markup"),u=e.includes("Spatiotemporal"),h=e.includes("UtilityNetwork"),s=u&&o?"spatiotemporaltable":o?"table":a?"routelayer":l?"markup":u?"spatiotemporal":h?"utilitynetwork":n?"featureshosted":"features"):t==="map service"||t==="wms"||t==="wmts"?(u=e.includes("Spatiotemporal"),p=e.includes("Relational"),s=u||p?"mapimages":n||e.includes("Tiled")||t==="wmts"?"maptiles":"mapimages"):s=t==="scene service"?e.includes("Line")?"sceneweblayerline":e.includes("3DObject")?"sceneweblayermultipatch":e.includes("Point")?"sceneweblayerpoint":e.includes("IntegratedMesh")?"sceneweblayermesh":e.includes("PointCloud")?"sceneweblayerpointcloud":e.includes("Polygon")?"sceneweblayerpolygon":e.includes("Building")?"sceneweblayerbuilding":e.includes("Voxel")?"sceneweblayervoxel":"sceneweblayer":t==="image service"?e.includes("Elevation 3D Layer")?"elevationlayer":e.includes("Tiled Imagery")?"tiledimagerylayer":"imagery":t==="stream service"?"streamlayer":t==="vector tile service"?"vectortile":t==="datastore catalog service"?"datastorecollection":t==="geocoding service"?"geocodeservice":t==="video service"?e.includes("Live Stream")?"livestreamvideolayer":"videolayer":t==="geoprocessing service"?e.includes("Web Tool")?"tool":"layers":t==="geodata service"?"geodataservice":t==="3dtiles service"?e.includes("3DObject")?"3dobjecttileslayer":e.includes("IntegratedMesh")?"integratedmeshtileslayer":"3dtileslayer":"layers"):t==="web map"||t==="cityengine web scene"?s="maps":t==="web scene"?s=e.includes("ViewingMode-Local")?"webscenelocal":"websceneglobal":t==="web mapping application"&&e.includes("configurableApp")?s="instantapps":t==="web mapping application"||t==="mobile application"||t==="application"||t==="operation view"||t==="desktop application"?s="apps":t==="map document"||t==="map package"||t==="published map"||t==="scene document"||t==="globe document"||t==="basemap package"||t==="mobile basemap package"||t==="mobile map package"||t==="project package"||t==="project template"||t==="pro map"||t==="layout"||t==="layer"&&e.includes("ArcGIS Pro")||t==="explorer map"&&e.indexOf("Explorer Document")?s="mapsgray":t==="service definition"||t==="shapefile"||t==="cad drawing"||t==="geojson"||t==="netcdf"||t==="administrative report"?s="datafiles":t==="360 vr experience"?s="360vr":t==="explorer add in"||t==="desktop add in"||t==="windows viewer add in"||t==="windows viewer configuration"?s="appsgray":t==="arcgis pro add in"||t==="arcgis pro configuration"?s="addindesktop":t==="pdf"?s="pdf":t==="microsoft word"?s="word":t==="microsoft excel"?s="excel":t==="microsoft powerpoint"?s="ppt":t==="rule package"||t==="file geodatabase"||t==="sqlite geodatabase"||t==="csv collection"||t==="kml collection"||t==="windows mobile package"||t==="map template"||t==="desktop application template"||t==="gml"||t==="arcpad package"||t==="code sample"||t==="document link"||t==="earth configuration"||t==="operations dashboard add in"||t==="rules package"||t==="workflow manager package"||t==="explorer map"&&e.includes("Explorer Mapping Application")||e.includes("Document")?s="datafilesgray":t==="network analysis service"||t==="geoprocessing service"||t==="geodata service"||t==="geometry service"||t==="geoprocessing package"||t==="locator package"||t==="geoprocessing sample"||t==="workflow manager service"?s="toolsgray":t==="layer"||t==="layer package"||t==="explorer layer"?s="layersgray":t==="analysis model"?s="analysismodel":t==="scene package"?s="scenepackage":t==="3dtiles package"?s="3dtileslayerpackage":t==="3dtiles service"?s="3dtileslayer":t==="mobile scene package"?s="mobilescenepackage":t==="tile package"||t==="compact tile package"?s="tilepackage":t==="task file"?s="taskfile":t==="report template"?s="report-template":t==="statistical data collection"?s="statisticaldatacollection":t==="insights workbook"?s="workbook":t==="insights model"?s="insightsmodel":t==="insights page"?s="insightspage":t==="insights theme"?s="insightstheme":t==="hub initiative"?s="hubinitiative":t==="hub page"?s="hubpage":t==="hub site application"?s="hubsite":t==="hub event"?s="hubevent":t==="hub project"?s="hubproject":t==="relational database connection"?s="relationaldatabaseconnection":t==="big data file share"?s="datastorecollection":t==="image collection"?s="imagecollection":t==="desktop style"?s="desktopstyle":t==="style"?s=e.includes("Dictionary")?"dictionarystyle":"style":t==="dashboard"?s="dashboard":t==="raster function template"?s="rasterprocessingtemplate":t==="vector tile package"?s="vectortilepackage":t==="ortho mapping project"?s="orthomappingproject":t==="ortho mapping template"?s="orthomappingtemplate":t==="solution"?s="solutions":t==="geopackage"?s="geopackage":t==="deep learning package"?s="deeplearningpackage":t==="real time analytic"?s="realtimeanalytics":t==="reality mapping project"?s="realitymappingproject":t==="big data analytic"?s="bigdataanalytics":t==="feed"?s="feed":t==="excalibur imagery project"?s="excaliburimageryproject":t==="notebook"?s="notebook":t==="storymap"?s="storymap":t==="survey123 add in"?s="survey123addin":t==="mission"?s="mission":t==="mission report"?s="missionreport":t==="mission template"?s="missiontemplate":t==="quickcapture project"?s="quickcaptureproject":t==="pro report"?s="proreport":t==="pro report template"?s="proreporttemplate":t==="urban model"?s="urbanmodel":t==="urban project"?s="urbanproject":t==="web experience"?s="experiencebuilder":t==="web experience template"?s="webexperiencetemplate":t==="experience builder widget"?s="experiencebuilderwidget":t==="experience builder widget package"?s="experiencebuilderwidgetpackage":t==="workflow"?s="workflow":t==="kernel gateway connection"?s="kernelgatewayconnection":t==="insights script"?s="insightsscript":t==="hub initiative template"?s="hubinitiativetemplate":t==="storymap theme"?s="storymaptheme":t==="knowledge graph"?s="knowledgegraph":t==="knowledge graph layer"?s="knowledgegraphlayer":t==="knowledge studio project"?s="knowledgestudio":t==="native application"?s="nativeapp":t==="native application installer"?s="nativeappinstaller":t==="web link chart"?s="linkchart":t==="knowledge graph web investigation"?s="investigation":t==="ogcfeatureserver"?s="features":t==="pro presentation"?s="propresentation":t==="pro project"?s="proproject":t==="insights workbook package"?s="insightsworkbookpackage":t==="apache parquet"?s="apacheparquet":t==="notebook code snippet library"?s="notebookcodesnippets":t==="suitability model"?s="suitabilitymodel":t==="esri classifier definition"?s="classifierdefinition":t==="esri classification schema"?s="classificationschema":t==="insights data engineering workbook"?s="dataengineeringworkbook":t==="insights data engineering model"?s="dataengineeringmodel":t==="deep learning studio project"?s="deeplearningproject":t==="discussion"?s="discussion":t==="allsource project"?s="allsourceproject":t==="api key"?s="apikey":t==="data pipeline"?s="datapipelines":t==="group layer"?(m=e.includes("Map"),s=m?"layergroup2d":"layergroup"):s=t==="media layer"?"onlinemedialayer":t==="form"?e.includes("Survey123")?"survey":"datafilesgray":t==="csv"?"csv":t==="image"?"image":"maps",s?Et(r+s+i+".png"):null}get isLayer(){return this.type!=null&&vte.has(this.type)}get itemCdnUrl(){return QP(this.itemUrl)}get itemPageUrl(){const t=this.portal?.itemPageUrl;return t&&this.id?`${t}?id=${this.id}`:null}get itemUrl(){const t=this.portal?.restUrl;return t&&this.id?`${t}/content/items/${this.id}`:null}get thumbnailUrl(){const t=this.itemUrl,e=this.thumbnail;return t&&e?this.portal?.normalizeUrl(`${t}/info/${e}?f=json`)??null:null}get userItemUrl(){const t=this.portal?.restUrl;if(!t)return null;const e=this.owner||this.portal?.user?.id;return e?`${t}/content/users/${this.ownerFolder?`${e}/${this.ownerFolder}`:e}/items/${this.id}`:null}load(t){const e=this.portal??(this.portal=Y.getDefault()),r=e.load(t).then((()=>this.sourceJSON?this.sourceJSON:this.id&&this.itemUrl?e.request(this.itemUrl,{signal:t!=null?t.signal:null,query:{token:this.apiKey}}):{})).then((i=>{this.sourceJSON=i,this.read(i)}));return this.addResolvingPromise(r),Promise.resolve(this)}async addRating(t){const e={method:"post",query:{}},r=t instanceof Nh?t.rating:t;return r==null||isNaN(r)||typeof t!="number"||(e.query.rating=r),this.portal?(await this.portal.request(this.itemUrl+"/addRating",e),new Nh({rating:r,created:new Date})):null}clone(){const t={access:this.access,accessInformation:this.accessInformation,applicationProxies:k(this.applicationProxies),avgRating:this.avgRating,categories:k(this.categories),classification:k(this.classification),created:k(this.created),culture:this.culture,description:this.description,extent:k(this.extent),groupCategories:k(this.groupCategories),id:this.id,itemControl:this.itemControl,licenseInfo:this.licenseInfo,modified:k(this.modified),name:this.name,numComments:this.numComments,numRatings:this.numRatings,numViews:this.numViews,owner:this.owner,ownerFolder:this.ownerFolder,portal:this.portal,screenshots:k(this.screenshots),size:this.size,snippet:this.snippet,sourceUrl:this.sourceUrl,spatialReference:this.spatialReference,tags:k(this.tags),thumbnail:this.thumbnail,title:this.title,type:this.type,typeKeywords:k(this.typeKeywords),url:this.url};this.loaded&&(t.loadStatus="loaded");const e=new jc({sourceJSON:this.sourceJSON}).set(t);return e._set("isOrgItem",this.isOrgItem),e}createPostQuery(){const t=this.toJSON();for(const e of["tags","typeKeywords","categories"])t[e]=t[e]?.join(", ");for(const e of["extent","classification"]){const r=t[e];r&&(t[e]=JSON.stringify(r))}return t}async deleteRating(){await this.portal.request(this.itemUrl+"/deleteRating",{method:"post"})}fetchData(t="json",e){return this.portal.request(this.itemUrl+"/data",{responseType:t,...e,query:{token:this.apiKey}})}async fetchRating(t){const e=await this.portal.request(this.itemUrl+"/rating",{query:{token:this.apiKey},...t});return e.rating!=null?(e.created=new Date(e.created),new Nh(e)):null}fetchRelatedItems(t,e){return this.portal.requestToTypedArray(this.itemUrl+"/relatedItems",{query:{...t,token:this.apiKey},...e},jc)}getThumbnailUrl(t){let e=this.thumbnailUrl;return e&&t&&(e+=`&w=${t}`),e}reload(){return this.portal.request(this.itemUrl??"",{cacheBust:!0,query:{token:this.apiKey}}).then((t=>(this.applicationProxies&&!Object.hasOwn(t,"appProxies")&&(this.applicationProxies=null),this.sourceJSON=t,this.read(t),this)))}update(t){return this.id?this.load().then((()=>this.portal.signIn())).then((()=>{const e=t?.data,r={method:"post"};r.query=this.createPostQuery();for(const i in r.query)r.query[i]===null&&(r.query[i]="");return r.query.clearEmptyFields=!0,e!=null&&(typeof e=="string"?r.query.text=e:typeof e=="object"&&(r.query.text=JSON.stringify(e))),this.portal.request(`${this.userItemUrl}/update`,r).then((()=>this.reload()))})):Promise.reject(new F("portal:item-does-not-exist","The item does not exist yet and cannot be updated"))}async copy(t){if(!this.id)throw new F("portal:item-does-not-exist","The item does not exist yet");await this.load();const{portal:e,itemUrl:r}=this;await e.signIn();const{copyResources:i,folder:s,tags:n,title:o}=t||{},a={method:"post",query:{copyPrivateResources:i==="all",folder:typeof s=="string"?s:s?.id,includeResources:!!i,tags:n?.join(","),title:o}},{itemId:l}=await e.request(`${r}/copy`,a);return new jc({id:l,portal:e})}updateThumbnail(t){return this.id?this.load().then((()=>this.portal.signIn())).then((()=>{const e=t.thumbnail,r=t.filename,i={method:"post"};if(typeof e=="string")xd(e)?i.query={data:e}:i.query={url:on(e)},r!=null&&(i.query.filename=r);else{const s=new FormData;r!=null?s.append("file",e,r):s.append("file",e),i.body=s}return this.portal.request(`${this.userItemUrl}/updateThumbnail`,i).then((()=>this.reload()))})):Promise.reject(new F("portal:item-does-not-exist","The item does not exist yet and cannot be updated"))}async fetchResources(t={},e){const{fetchResources:r}=await J(()=>import("./resourceUtils-Z5-Yru0O.js"),[]);return r(this,t,e)}async addResource(t,e,r){const{addOrUpdateResources:i}=await J(()=>import("./resourceUtils-Z5-Yru0O.js"),[]);return t.portalItem=this,await i(this,[{resource:t,content:e,compress:r?.compress,access:r?.access}],"add",r),t}async removeResource(t,e){const{removeResource:r}=await J(()=>import("./resourceUtils-Z5-Yru0O.js"),[]);if(t.portalItem&&t.portalItem.itemUrl!==this.itemUrl)throw new F("removeresource:portal-item-mismatch","The portal item associated with the provided resource does not match the item");return r(this,t,e)}async removeAllResources(t){const{removeAllResources:e}=await J(()=>import("./resourceUtils-Z5-Yru0O.js"),[]);return e(this,t)}resourceFromPath(t){return new qa({portalItem:this,path:t})}toJSON(){const t=this.extent,e={accessInformation:this.accessInformation,categories:k(this.categories),classification:k(this.classification),created:this.created?.getTime(),description:this.description,extent:t&&[[t.xmin,t.ymin],[t.xmax,t.ymax]],id:this.id,isOrgItem:this.isOrgItem,licenseInfo:this.licenseInfo,modified:this.modified?.getTime(),name:this.name,owner:this.owner,ownerFolder:this.ownerFolder,snippet:this.snippet,sourceUrl:this.sourceUrl,spatialReference:this.spatialReference,tags:k(this.tags),thumbnail:this.thumbnail,title:this.title,type:this.type,typeKeywords:k(this.typeKeywords),url:this.url};return RY(e)}static fromJSON(t){if(!t)return null;if(t.declaredClass)throw new Error("JSON object is already hydrated");return new jc({sourceJSON:t})}_getPostQuery(){const t=this.toJSON();for(const e in t)e==="tags"&&t[e]!==null&&(t[e]=t[e].join(", ")),e==="typeKeywords"&&t[e]!==null&&(t[e]=t[e].join(", ")),e==="extent"&&t[e]&&(t[e]=JSON.stringify(t[e]));return t}};c([d({type:["private","shared","org","public"]})],Ee.prototype,"access",void 0),c([d()],Ee.prototype,"accessInformation",void 0),c([d({type:String})],Ee.prototype,"apiKey",void 0),c([d({json:{read:{source:"appProxies"}}})],Ee.prototype,"applicationProxies",void 0),c([d()],Ee.prototype,"avgRating",void 0),c([d()],Ee.prototype,"categories",void 0),c([d()],Ee.prototype,"classification",void 0),c([d({type:Date})],Ee.prototype,"created",void 0),c([d()],Ee.prototype,"culture",void 0),c([d()],Ee.prototype,"description",void 0),c([d({readOnly:!0})],Ee.prototype,"displayName",null),c([d({type:Le})],Ee.prototype,"extent",void 0),c([K("extent")],Ee.prototype,"readExtent",null),c([d()],Ee.prototype,"groupCategories",void 0),c([d({readOnly:!0})],Ee.prototype,"iconUrl",null),c([d()],Ee.prototype,"id",void 0),c([d({readOnly:!0})],Ee.prototype,"isLayer",null),c([d({type:Boolean,readOnly:!0})],Ee.prototype,"isOrgItem",void 0),c([d()],Ee.prototype,"itemControl",void 0),c([d({readOnly:!0})],Ee.prototype,"itemPageUrl",null),c([d({readOnly:!0})],Ee.prototype,"itemUrl",null),c([d()],Ee.prototype,"licenseInfo",void 0),c([d({type:Date})],Ee.prototype,"modified",void 0),c([d()],Ee.prototype,"name",void 0),c([d()],Ee.prototype,"numComments",void 0),c([d()],Ee.prototype,"numRatings",void 0),c([d()],Ee.prototype,"numViews",void 0),c([d()],Ee.prototype,"owner",void 0),c([d()],Ee.prototype,"ownerFolder",void 0),c([d({type:Y})],Ee.prototype,"portal",void 0),c([d()],Ee.prototype,"screenshots",void 0),c([d()],Ee.prototype,"size",void 0),c([d()],Ee.prototype,"snippet",void 0),c([d()],Ee.prototype,"sourceJSON",void 0),c([d({type:String})],Ee.prototype,"sourceUrl",void 0),c([d({type:String})],Ee.prototype,"spatialReference",void 0),c([d()],Ee.prototype,"tags",void 0),c([d()],Ee.prototype,"thumbnail",void 0),c([d({readOnly:!0})],Ee.prototype,"thumbnailUrl",null),c([d()],Ee.prototype,"title",void 0),c([d()],Ee.prototype,"type",void 0),c([d()],Ee.prototype,"typeKeywords",void 0),c([d({type:String,json:{read(t,e){if(_te.has(e.type)){const r=this.portal?.restUrl;t||=r&&this.id?`${r}/content/items/${this.id}/data`:null}return t}}})],Ee.prototype,"url",void 0),c([d({readOnly:!0})],Ee.prototype,"userItemUrl",null),Ee=jc=c([C("esri.portal.PortalItem")],Ee);const gj=Object.freeze(Object.defineProperty({__proto__:null,get default(){return Ee}},Symbol.toStringTag,{value:"Module"})),vj={ar:!0,bg:!0,bs:!0,ca:!0,cs:!0,da:!0,de:!0,el:!0,en:!0,es:!0,et:!0,fi:!0,fr:!0,he:!0,hr:!0,hu:!0,id:!0,it:!0,ja:!0,ko:!0,lt:!0,lv:!0,nb:"no",nl:!0,no:!0,nn:"no",pl:!0,pt:"pt-BR","pt-BR":!0,"pt-PT":!0,ro:!0,ru:!0,sk:!0,sl:!0,sr:!0,sv:!0,th:!0,tr:!0,uk:!0,vi:!0,zh:"zh-CN","zh-CN":!0,"zh-HK":!0,"zh-TW":!0};function bte(t){return t in vj}function tk(t){if(bte(t)){const e=vj[t];return e===!0?t:e}return null}const Uy=[],ff=new Map;function rk(t){for(const e of ff.keys())bj(t.pattern,e)&&ff.delete(e)}function wte(t){return Uy.includes(t)||(rk(t),Uy.unshift(t)),He((()=>{const e=Uy.indexOf(t);e>-1&&(Uy.splice(e,1),rk(t))}))}async function E3(t){const e=hs();ff.has(t)||ff.set(t,Ste(t,e));const r=ff.get(t);return r&&await xte.add(r),r}function _j(t){const e=$3(t);return e?tk(t)??tk(e.language):null}async function Ste(t,e){const r=[];for(const i of Uy)if(bj(i.pattern,t))try{return await i.fetchMessageBundle(t,e)}catch(s){r.push(s)}throw r.length?new F("intl:message-bundle-error",`Errors occurred while loading "${t}"`,{errors:r}):new F("intl:no-message-bundle-loader",`No loader found for message bundle "${t}"`)}function bj(t,e){return typeof t=="string"?e.startsWith(t):t.test(e)}T3((()=>{ff.clear()}));const xte=new class{constructor(){this._numLoading=0,this._dfd=null}async waitForAll(){this._dfd&&await this._dfd.promise}add(t){return this._increase(),t.then((()=>this._decrease()),(()=>this._decrease())),this.waitForAll()}_increase(){this._numLoading++,this._dfd||(this._dfd=Ns())}_decrease(){this._numLoading=Math.max(this._numLoading-1,0),this._dfd&&this._numLoading===0&&(this._dfd.resolve(),this._dfd=null)}};async function $te(t){if(!t)return;const e=t.includes("-vector")?t.slice(0,t.indexOf("-vector")):t.includes("-3d")?t.slice(0,t.indexOf("-3d")):t,r=await E3("esri/t9n/basemaps");return r[t]||r[e]}const cm={satellite:{id:"satellite",classic:!0,get thumbnailUrl(){return Et("esri/images/basemap/satellite.jpg")},baseMapLayers:[{id:"satellite-base-layer",url:"//services.arcgisonline.com/ArcGIS/rest/services/World_Imagery/MapServer",layerType:"ArcGISTiledMapServiceLayer",title:"World Imagery",showLegend:!1,visibility:!0,opacity:1}]},hybrid:{id:"hybrid",classic:!0,get thumbnailUrl(){return Et("esri/images/basemap/hybrid.jpg")},baseMapLayers:[{id:"hybrid-base-layer",url:"//services.arcgisonline.com/ArcGIS/rest/services/World_Imagery/MapServer",layerType:"ArcGISTiledMapServiceLayer",title:"World Imagery",showLegend:!1,visibility:!0,opacity:1},{id:"hybrid-reference-layer",styleUrl:"https://cdn.arcgis.com/sharing/rest/content/items/30d6b8271e1849cd9c3042060001f425/resources/styles/root.json",layerType:"VectorTileLayer",title:"Hybrid Reference Layer",isReference:!0,showLegend:!1,visibility:!0,opacity:1}]},terrain:{id:"terrain",classic:!0,get thumbnailUrl(){return Et("esri/images/basemap/terrain.jpg")},baseMapLayers:[{id:"terrain-base-layer",url:"//services.arcgisonline.com/ArcGIS/rest/services/World_Terrain_Base/MapServer",layerType:"ArcGISTiledMapServiceLayer",title:"World Terrain Base",showLegend:!1,visibility:!0,opacity:1},{id:"terrain-reference-layer",url:"//services.arcgisonline.com/ArcGIS/rest/services/Reference/World_Reference_Overlay/MapServer",layerType:"ArcGISTiledMapServiceLayer",title:"World Reference Overlay",isReference:!0,showLegend:!1,visibility:!0,opacity:1}]},oceans:{id:"oceans",classic:!0,get thumbnailUrl(){return Et("esri/images/basemap/oceans.jpg")},baseMapLayers:[{id:"oceans-base-layer",url:"//services.arcgisonline.com/arcgis/rest/services/Ocean/World_Ocean_Base/MapServer",layerType:"ArcGISTiledMapServiceLayer",title:"World Ocean Base",showLegend:!1,visibility:!0,opacity:1},{id:"oceans-reference-layer",url:"//services.arcgisonline.com/arcgis/rest/services/Ocean/World_Ocean_Reference/MapServer",layerType:"ArcGISTiledMapServiceLayer",title:"World Ocean Reference",isReference:!0,showLegend:!1,visibility:!0,opacity:1}]},osm:{id:"osm",classic:!0,get thumbnailUrl(){return Et("esri/images/basemap/osm.jpg")},baseMapLayers:[{id:"osm-base-layer",layerType:"OpenStreetMap",title:"Open Street Map",showLegend:!1,visibility:!0,opacity:1}]},"dark-gray-vector":{id:"dark-gray-vector",classic:!0,get thumbnailUrl(){return Et("esri/images/basemap/dark-gray-vector.jpg")},baseMapLayers:[{id:"dark-gray-base-layer",styleUrl:"https://cdn.arcgis.com/sharing/rest/content/items/5e9b3685f4c24d8781073dd928ebda50/resources/styles/root.json",layerType:"VectorTileLayer",title:"Dark Gray Base",visibility:!0,opacity:1},{id:"dark-gray-reference-layer",styleUrl:"https://cdn.arcgis.com/sharing/rest/content/items/747cb7a5329c478cbe6981076cc879c5/resources/styles/root.json",layerType:"VectorTileLayer",title:"Dark Gray Reference",isReference:!0,visibility:!0,opacity:1}]},get"dark-gray"(){return{...this["dark-gray-vector"],id:"dark-gray"}},"gray-vector":{id:"gray-vector",classic:!0,get thumbnailUrl(){return Et("esri/images/basemap/gray-vector.jpg")},baseMapLayers:[{id:"gray-base-layer",styleUrl:"https://cdn.arcgis.com/sharing/rest/content/items/291da5eab3a0412593b66d384379f89f/resources/styles/root.json",layerType:"VectorTileLayer",title:"Light Gray Base",visibility:!0,opacity:1},{id:"gray-reference-layer",styleUrl:"https://cdn.arcgis.com/sharing/rest/content/items/1768e8369a214dfab4e2167d5c5f2454/resources/styles/root.json",layerType:"VectorTileLayer",title:"Light Gray Reference",isReference:!0,visibility:!0,opacity:1}]},get gray(){return{...this["gray-vector"],id:"gray"}},"streets-vector":{id:"streets-vector",classic:!0,get thumbnailUrl(){return Et("esri/images/basemap/streets-vector.jpg")},baseMapLayers:[{id:"streets-vector-base-layer",styleUrl:"//cdn.arcgis.com/sharing/rest/content/items/de26a3cf4cc9451298ea173c4b324736/resources/styles/root.json",layerType:"VectorTileLayer",title:"World Streets",visibility:!0,opacity:1}]},get streets(){return{...this["streets-vector"],id:"streets"}},"topo-vector":{id:"topo-vector",classic:!0,get thumbnailUrl(){return Et("esri/images/basemap/topo-vector.jpg")},baseMapLayers:[{id:"world-hillshade-layer",url:"//services.arcgisonline.com/arcgis/rest/services/Elevation/World_Hillshade/MapServer",layerType:"ArcGISTiledMapServiceLayer",title:"World Hillshade",showLegend:!1,visibility:!0,opacity:1},{id:"topo-vector-base-layer",styleUrl:"//cdn.arcgis.com/sharing/rest/content/items/7dc6cea0b1764a1f9af2e679f642f0f5/resources/styles/root.json",layerType:"VectorTileLayer",title:"World Topo",visibility:!0,opacity:1}]},get topo(){return{...this["topo-vector"],id:"topo"}},"streets-night-vector":{id:"streets-night-vector",classic:!0,get thumbnailUrl(){return Et("esri/images/basemap/streets-night.jpg")},baseMapLayers:[{id:"streets-night-vector-base-layer",styleUrl:"//cdn.arcgis.com/sharing/rest/content/items/86f556a2d1fd468181855a35e344567f/resources/styles/root.json",layerType:"VectorTileLayer",title:"World Streets Night",visibility:!0,opacity:1}]},"streets-relief-vector":{id:"streets-relief-vector",classic:!0,get thumbnailUrl(){return Et("esri/images/basemap/streets-relief.jpg")},baseMapLayers:[{id:"world-hillshade-layer",url:"//services.arcgisonline.com/arcgis/rest/services/Elevation/World_Hillshade/MapServer",layerType:"ArcGISTiledMapServiceLayer",title:"World Hillshade",showLegend:!1,visibility:!0,opacity:1},{id:"streets-relief-vector-base-layer",styleUrl:"//www.arcgis.com/sharing/rest/content/items/b266e6d17fc345b498345613930fbd76/resources/styles/root.json",title:"World Streets Relief",layerType:"VectorTileLayer",visibility:!0,opacity:1}]},"streets-navigation-vector":{id:"streets-navigation-vector",classic:!0,get thumbnailUrl(){return Et("esri/images/basemap/streets-navigation.jpg")},baseMapLayers:[{id:"streets-navigation-vector-base-layer",styleUrl:"//cdn.arcgis.com/sharing/rest/content/items/63c47b7177f946b49902c24129b87252/resources/styles/root.json",layerType:"VectorTileLayer",title:"World Streets Navigation",visibility:!0,opacity:1}]},"topo-3d":{id:"topo-3d",is3d:!0,get thumbnailUrl(){return Et("esri/images/basemap/topo-3d.png")},baseMapLayers:[{id:"topo-3d-base-layer",styleUrl:"https://www.arcgis.com/sharing/rest/content/items/1e7d1784d1ef4b79ba6764d0bd6c3150/resources/styles/root.json",layerType:"VectorTileLayer",title:"Topographic",visibility:!0,opacity:1},{id:"topo-3d-trees",title:"Trees",url:"https://basemaps3d.arcgis.com/arcgis/rest/services/OpenStreetMap3D_Trees_Thematic_v1/SceneServer",itemId:"f75fef56b2d944fe92ef9f7737b4f953",layerType:"ArcGISSceneServiceLayer"},{id:"topo-3d-places-and-labels",title:"Places and Labels",url:"https://basemaps3d.arcgis.com/arcgis/rest/services/OpenStreetMap3D_DarkLabels_v1/SceneServer",itemId:"a84404ad39c64c328d0596e361ec459b",layerType:"ArcGISSceneServiceLayer"},{id:"topo-3d-buildings",title:"Buildings",url:"https://basemaps3d.arcgis.com/arcgis/rest/services/OpenStreetMap3D_Buildings_v1/SceneServer",itemId:"ca0470dbbddb4db28bad74ed39949e25",layerType:"ArcGISSceneServiceLayer"}]},"navigation-3d":{id:"navigation-3d",is3d:!0,get thumbnailUrl(){return Et("esri/images/basemap/navigation-3d.jpg")},baseMapLayers:[{id:"navigation-3d-base-layer",styleUrl:"https://www.arcgis.com/sharing/rest/content/items/ccc904ff872b4144b94934e55e32784b/resources/styles/root.json",layerType:"VectorTileLayer",title:"Navigation",visibility:!0,opacity:1},{id:"navigation-3d-places-and-labels",title:"Places and Labels",url:"https://basemaps3d.arcgis.com/arcgis/rest/services/OpenStreetMap3D_DarkLabels_v1/SceneServer",itemId:"a84404ad39c64c328d0596e361ec459b",layerType:"ArcGISSceneServiceLayer"},{id:"navigation-3d-buildings",title:"Buildings",url:"https://basemaps3d.arcgis.com/arcgis/rest/services/OpenStreetMap3D_Buildings_v1/SceneServer",itemId:"ca0470dbbddb4db28bad74ed39949e25",layerType:"ArcGISSceneServiceLayer"}]},"streets-3d":{id:"streets-3d",is3d:!0,get thumbnailUrl(){return Et("esri/images/basemap/streets-3d.png")},baseMapLayers:[{id:"streets-3d-base-layer",styleUrl:"https://www.arcgis.com/sharing/rest/content/items/198298c4c64c4cb19de5b46aa00c198d/resources/styles/root.json",layerType:"VectorTileLayer",title:"Streets",visibility:!0,opacity:1},{id:"streets-3d-places-and-labels",title:"Places and Labels",url:"https://basemaps3d.arcgis.com/arcgis/rest/services/OpenStreetMap3D_DarkLabels_v1/SceneServer",itemId:"a84404ad39c64c328d0596e361ec459b",layerType:"ArcGISSceneServiceLayer"},{id:"streets-3d-buildings",title:"Buildings",url:"https://basemaps3d.arcgis.com/arcgis/rest/services/OpenStreetMap3D_Buildings_v1/SceneServer",itemId:"ca0470dbbddb4db28bad74ed39949e25",layerType:"ArcGISSceneServiceLayer"}]},"osm-3d":{id:"osm-3d",is3d:!0,get thumbnailUrl(){return Et("esri/images/basemap/osm-3d.png")},baseMapLayers:[{id:"osm-3d-base-layer",styleUrl:"https://www.arcgis.com/sharing/rest/content/items/8628d259c9d14bdc848771c23c513940/resources/styles/root.json",layerType:"VectorTileLayer",title:"OpenStreetMap",visibility:!0,opacity:1},{id:"osm-3d-trees",title:"Trees",url:"https://basemaps3d.arcgis.com/arcgis/rest/services/OpenStreetMap3D_Trees_Thematic_v1/SceneServer",itemId:"f75fef56b2d944fe92ef9f7737b4f953",layerType:"ArcGISSceneServiceLayer"},{id:"osm-3d-places-and-labels",title:"Places and Labels",url:"https://basemaps3d.arcgis.com/arcgis/rest/services/OpenStreetMap3D_DarkLabels_v1/SceneServer",itemId:"a84404ad39c64c328d0596e361ec459b",layerType:"ArcGISSceneServiceLayer"},{id:"osm-3d-buildings",title:"Buildings",url:"https://basemaps3d.arcgis.com/arcgis/rest/services/OpenStreetMap3D_Buildings_v1/SceneServer",itemId:"ca0470dbbddb4db28bad74ed39949e25",layerType:"ArcGISSceneServiceLayer"}]},"gray-3d":{id:"gray-3d",is3d:!0,get thumbnailUrl(){return Et("esri/images/basemap/gray-3d.png")},baseMapLayers:[{id:"gray-3d-base-layer",styleUrl:"https://www.arcgis.com/sharing/rest/content/items/01a14b466345455ba4176d2e6390db92/resources/styles/root.json",layerType:"VectorTileLayer",title:"Streets",visibility:!0,opacity:1},{id:"gray-3d-places-and-labels",title:"Places and Labels",url:"https://basemaps3d.arcgis.com/arcgis/rest/services/OpenStreetMap3D_DarkLabels_v1/SceneServer",itemId:"a84404ad39c64c328d0596e361ec459b",layerType:"ArcGISSceneServiceLayer"},{id:"gray-3d-buildings",title:"Buildings",url:"https://basemaps3d.arcgis.com/arcgis/rest/services/OpenStreetMap3D_Buildings_v1/SceneServer",itemId:"ca0470dbbddb4db28bad74ed39949e25",layerType:"ArcGISSceneServiceLayer"}]},"navigation-dark-3d":{id:"navigation-dark-3d",itemId:"5a1365328b4943f09a54cf5fd1205707",is3d:!0,baseMapLayers:[{id:"navigation-dark-3d-base-layer",styleUrl:"https://www.arcgis.com/sharing/rest/content/items/451a1777ab3f4bf095fae24a117439d9/resources/styles/root.json",layerType:"VectorTileLayer",title:"Navigation Dark"},{id:"navigation-dark-3d-places-and-labels",title:"Places and Labels",url:"https://basemaps3d.arcgis.com/arcgis/rest/services/OpenStreetMap3D_LightLabels_v1/SceneServer/layers/0",itemId:"f364b70b012a4da5a4b5921e193eac4a",layerType:"ArcGISSceneServiceLayer"},{id:"navigation-dark-3d-buildings",title:"Buildings",url:"https://basemaps3d.arcgis.com/arcgis/rest/services/OpenStreetMap3D_Buildings_v1/SceneServer",itemId:"ca0470dbbddb4db28bad74ed39949e25",layerType:"ArcGISSceneServiceLayer"}]},"streets-dark-3d":{id:"streets-dark-3d",itemId:"8a4efa2c20484ec9b4557895e65736ff",is3d:!0,baseMapLayers:[{id:"streets-dark-3d-base-layer",styleUrl:"https://www.arcgis.com/sharing/rest/content/items/bc599b6d741a4ac084b7eea7bf8c5938/resources/styles/root.json",layerType:"VectorTileLayer",title:"OpenStreetMap Streets Night (for 3D)"},{id:"streets-dark-3d-places-and-labels",title:"Places and Labels",url:"https://basemaps3d.arcgis.com/arcgis/rest/services/OpenStreetMap3D_LightLabels_v1/SceneServer",itemId:"f364b70b012a4da5a4b5921e193eac4a",layerType:"ArcGISSceneServiceLayer"},{id:"streets-dark-3d-buildings",title:"Buildings",url:"https://basemaps3d.arcgis.com/arcgis/rest/services/OpenStreetMap3D_Buildings_v1/SceneServer",itemId:"ca0470dbbddb4db28bad74ed39949e25",layerType:"ArcGISSceneServiceLayer"}]},"dark-gray-3d":{id:"dark-gray-3d",itemId:"a8b7322a5fe94002bb0f5e0eeb0c5c18",is3d:!0,baseMapLayers:[{id:"dark-gray-3d-base-layer",styleUrl:"https://www.arcgis.com/sharing/rest/content/items/4178f71acb934fb89f169e7d667c20c6/resources/styles/root.json",layerType:"VectorTileLayer",title:"OpenStreetMap Dark Gray Canvas (for 3D)"},{id:"dark-gray-3d-places-and-labels",title:"Places and Labels",url:"https://basemaps3d.arcgis.com/arcgis/rest/services/OpenStreetMap3D_LightLabels_v1/SceneServer/layers/0",itemId:"f364b70b012a4da5a4b5921e193eac4a",layerType:"ArcGISSceneServiceLayer"},{id:"dark-gray-3d-buildings",title:"Buildings",url:"https://basemaps3d.arcgis.com/arcgis/rest/services/OpenStreetMap3D_Buildings_v1/SceneServer",itemId:"ca0470dbbddb4db28bad74ed39949e25",layerType:"ArcGISSceneServiceLayer"}]}},uo="system",lc="unknown",$a="UTC",Mte=Intl.DateTimeFormat().resolvedOptions().timeZone,ik=new Map([["AUS Central Standard Time","Australia/Darwin"],["AUS Eastern Standard Time","Australia/Sydney"],["Afghanistan Standard Time","Asia/Kabul"],["Alaskan Standard Time","America/Anchorage"],["Aleutian Standard Time","America/Adak"],["Altai Standard Time","Asia/Barnaul"],["Arab Standard Time","Asia/Riyadh"],["Arabian Standard Time","Asia/Dubai"],["Arabic Standard Time","Asia/Baghdad"],["Argentina Standard Time","America/Buenos_Aires"],["Astrakhan Standard Time","Europe/Astrakhan"],["Atlantic Standard Time","America/Halifax"],["Aus Central W. Standard Time","Australia/Eucla"],["Azerbaijan Standard Time","Asia/Baku"],["Azores Standard Time","Atlantic/Azores"],["Bahia Standard Time","America/Bahia"],["Bangladesh Standard Time","Asia/Dhaka"],["Belarus Standard Time","Europe/Minsk"],["Bougainville Standard Time","Pacific/Bougainville"],["Canada Central Standard Time","America/Regina"],["Cape Verde Standard Time","Atlantic/Cape_Verde"],["Caucasus Standard Time","Asia/Yerevan"],["Cen. Australia Standard Time","Australia/Adelaide"],["Central America Standard Time","America/Guatemala"],["Central Asia Standard Time","Asia/Bishkek"],["Central Brazilian Standard Time","America/Cuiaba"],["Central Europe Standard Time","Europe/Budapest"],["Central European Standard Time","Europe/Warsaw"],["Central Pacific Standard Time","Pacific/Guadalcanal"],["Central Standard Time","America/Chicago"],["Central Standard Time (Mexico)","America/Mexico_City"],["Chatham Islands Standard Time","Pacific/Chatham"],["China Standard Time","Asia/Shanghai"],["Cuba Standard Time","America/Havana"],["Dateline Standard Time","Etc/GMT+12"],["E. Africa Standard Time","Africa/Nairobi"],["E. Australia Standard Time","Australia/Brisbane"],["E. Europe Standard Time","Europe/Chisinau"],["E. South America Standard Time","America/Sao_Paulo"],["Easter Island Standard Time","Pacific/Easter"],["Eastern Standard Time","America/New_York"],["Eastern Standard Time (Mexico)","America/Cancun"],["Egypt Standard Time","Africa/Cairo"],["Ekaterinburg Standard Time","Asia/Yekaterinburg"],["FLE Standard Time","Europe/Kiev"],["Fiji Standard Time","Pacific/Fiji"],["GMT Standard Time","Europe/London"],["GTB Standard Time","Europe/Bucharest"],["Georgian Standard Time","Asia/Tbilisi"],["Greenland Standard Time","America/Godthab"],["Greenwich Standard Time","Atlantic/Reykjavik"],["Haiti Standard Time","America/Port-au-Prince"],["Hawaiian Standard Time","Pacific/Honolulu"],["India Standard Time","Asia/Calcutta"],["Iran Standard Time","Asia/Tehran"],["Israel Standard Time","Asia/Jerusalem"],["Jordan Standard Time","Asia/Amman"],["Kaliningrad Standard Time","Europe/Kaliningrad"],["Korea Standard Time","Asia/Seoul"],["Libya Standard Time","Africa/Tripoli"],["Line Islands Standard Time","Pacific/Kiritimati"],["Lord Howe Standard Time","Australia/Lord_Howe"],["Magadan Standard Time","Asia/Magadan"],["Magallanes Standard Time","America/Punta_Arenas"],["Marquesas Standard Time","Pacific/Marquesas"],["Mauritius Standard Time","Indian/Mauritius"],["Middle East Standard Time","Asia/Beirut"],["Montevideo Standard Time","America/Montevideo"],["Morocco Standard Time","Africa/Casablanca"],["Mountain Standard Time","America/Denver"],["Mountain Standard Time (Mexico)","America/Mazatlan"],["Myanmar Standard Time","Asia/Rangoon"],["N. Central Asia Standard Time","Asia/Novosibirsk"],["Namibia Standard Time","Africa/Windhoek"],["Nepal Standard Time","Asia/Katmandu"],["New Zealand Standard Time","Pacific/Auckland"],["Newfoundland Standard Time","America/St_Johns"],["Norfolk Standard Time","Pacific/Norfolk"],["North Asia East Standard Time","Asia/Irkutsk"],["North Asia Standard Time","Asia/Krasnoyarsk"],["North Korea Standard Time","Asia/Pyongyang"],["Omsk Standard Time","Asia/Omsk"],["Pacific SA Standard Time","America/Santiago"],["Pacific Standard Time","America/Los_Angeles"],["Pacific Standard Time (Mexico)","America/Tijuana"],["Pakistan Standard Time","Asia/Karachi"],["Paraguay Standard Time","America/Asuncion"],["Qyzylorda Standard Time","Asia/Qyzylorda"],["Romance Standard Time","Europe/Paris"],["Russia Time Zone 10","Asia/Srednekolymsk"],["Russia Time Zone 11","Asia/Kamchatka"],["Russia Time Zone 3","Europe/Samara"],["Russian Standard Time","Europe/Moscow"],["SA Eastern Standard Time","America/Cayenne"],["SA Pacific Standard Time","America/Bogota"],["SA Western Standard Time","America/La_Paz"],["SE Asia Standard Time","Asia/Bangkok"],["Saint Pierre Standard Time","America/Miquelon"],["Sakhalin Standard Time","Asia/Sakhalin"],["Samoa Standard Time","Pacific/Apia"],["Sao Tome Standard Time","Africa/Sao_Tome"],["Saratov Standard Time","Europe/Saratov"],["Singapore Standard Time","Asia/Singapore"],["South Africa Standard Time","Africa/Johannesburg"],["South Sudan Standard Time","Africa/Juba"],["Sri Lanka Standard Time","Asia/Colombo"],["Sudan Standard Time","Africa/Khartoum"],["Syria Standard Time","Asia/Damascus"],["Taipei Standard Time","Asia/Taipei"],["Tasmania Standard Time","Australia/Hobart"],["Tocantins Standard Time","America/Araguaina"],["Tokyo Standard Time","Asia/Tokyo"],["Tomsk Standard Time","Asia/Tomsk"],["Tonga Standard Time","Pacific/Tongatapu"],["Transbaikal Standard Time","Asia/Chita"],["Turkey Standard Time","Europe/Istanbul"],["Turks And Caicos Standard Time","America/Grand_Turk"],["US Eastern Standard Time","America/Indianapolis"],["US Mountain Standard Time","America/Phoenix"],["UTC","Etc/GMT"],["UTC+01","Etc/GMT-1"],["UTC+02","Etc/GMT-2"],["UTC+03","Etc/GMT-3"],["UTC+04","Etc/GMT-4"],["UTC+05","Etc/GMT-5"],["UTC+06","Etc/GMT-6"],["UTC+07","Etc/GMT-7"],["UTC+08","Etc/GMT-8"],["UTC+09","Etc/GMT-9"],["UTC+10","Etc/GMT-10"],["UTC+11","Etc/GMT-11"],["UTC+12","Etc/GMT-12"],["UTC+13","Etc/GMT-13"],["UTC+14","Etc/GMT-14"],["UTC-01","Etc/GMT+1"],["UTC-02","Etc/GMT+2"],["UTC-03","Etc/GMT+3"],["UTC-04","Etc/GMT+4"],["UTC-05","Etc/GMT+5"],["UTC-06","Etc/GMT+6"],["UTC-07","Etc/GMT+7"],["UTC-08","Etc/GMT+8"],["UTC-09","Etc/GMT+9"],["UTC-10","Etc/GMT+10"],["UTC-11","Etc/GMT+11"],["UTC-12","Etc/GMT+12"],["Ulaanbaatar Standard Time","Asia/Ulaanbaatar"],["Venezuela Standard Time","America/Caracas"],["Vladivostok Standard Time","Asia/Vladivostok"],["Volgograd Standard Time","Europe/Volgograd"],["W. Australia Standard Time","Australia/Perth"],["W. Central Africa Standard Time","Africa/Lagos"],["W. Europe Standard Time","Europe/Berlin"],["W. Mongolia Standard Time","Asia/Hovd"],["West Asia Standard Time","Asia/Tashkent"],["West Bank Standard Time","Asia/Hebron"],["West Pacific Standard Time","Pacific/Port_Moresby"],["Yakutsk Standard Time","Asia/Yakutsk"],["Yukon Standard Time","America/Whitehorse"]]);class Id extends Error{}class Tte extends Id{constructor(e){super(`Invalid DateTime: ${e.toMessage()}`)}}class Ete extends Id{constructor(e){super(`Invalid Interval: ${e.toMessage()}`)}}class Ite extends Id{constructor(e){super(`Invalid Duration: ${e.toMessage()}`)}}class qp extends Id{}class wj extends Id{constructor(e){super(`Invalid unit ${e}`)}}class fi extends Id{}class ru extends Id{constructor(){super("Zone is an abstract class")}}const ae="numeric",co="short",Os="long",gw={year:ae,month:ae,day:ae},Sj={year:ae,month:co,day:ae},Cte={year:ae,month:co,day:ae,weekday:co},xj={year:ae,month:Os,day:ae},$j={year:ae,month:Os,day:ae,weekday:Os},Mj={hour:ae,minute:ae},Tj={hour:ae,minute:ae,second:ae},Ej={hour:ae,minute:ae,second:ae,timeZoneName:co},Ij={hour:ae,minute:ae,second:ae,timeZoneName:Os},Cj={hour:ae,minute:ae,hourCycle:"h23"},Pj={hour:ae,minute:ae,second:ae,hourCycle:"h23"},Aj={hour:ae,minute:ae,second:ae,hourCycle:"h23",timeZoneName:co},Lj={hour:ae,minute:ae,second:ae,hourCycle:"h23",timeZoneName:Os},Rj={year:ae,month:ae,day:ae,hour:ae,minute:ae},kj={year:ae,month:ae,day:ae,hour:ae,minute:ae,second:ae},Oj={year:ae,month:co,day:ae,hour:ae,minute:ae},Nj={year:ae,month:co,day:ae,hour:ae,minute:ae,second:ae},Pte={year:ae,month:co,day:ae,weekday:co,hour:ae,minute:ae},Fj={year:ae,month:Os,day:ae,hour:ae,minute:ae,timeZoneName:co},Dj={year:ae,month:Os,day:ae,hour:ae,minute:ae,second:ae,timeZoneName:co},zj={year:ae,month:Os,day:ae,weekday:Os,hour:ae,minute:ae,timeZoneName:Os},Vj={year:ae,month:Os,day:ae,weekday:Os,hour:ae,minute:ae,second:ae,timeZoneName:Os};class Cd{get type(){throw new ru}get name(){throw new ru}get ianaName(){return this.name}get isUniversal(){throw new ru}offsetName(e,r){throw new ru}formatOffset(e,r){throw new ru}offset(e){throw new ru}equals(e){throw new ru}get isValid(){throw new ru}}let Mx=null;class t2 extends Cd{static get instance(){return Mx===null&&(Mx=new t2),Mx}get type(){return"system"}get name(){return new Intl.DateTimeFormat().resolvedOptions().timeZone}get isUniversal(){return!1}offsetName(e,{format:r,locale:i}){return Xj(e,r,i)}formatOffset(e,r){return Yg(this.offset(e),r)}offset(e){return-new Date(e).getTimezoneOffset()}equals(e){return e.type==="system"}get isValid(){return!0}}const QM=new Map;function Ate(t){let e=QM.get(t);return e===void 0&&(e=new Intl.DateTimeFormat("en-US",{hour12:!1,timeZone:t,year:"numeric",month:"2-digit",day:"2-digit",hour:"2-digit",minute:"2-digit",second:"2-digit",era:"short"}),QM.set(t,e)),e}const Lte={year:0,month:1,day:2,era:3,hour:4,minute:5,second:6};function Rte(t,e){const r=t.format(e).replace(/\u200E/g,""),i=/(\d+)\/(\d+)\/(\d+) (AD|BC),? (\d+):(\d+):(\d+)/.exec(r),[,s,n,o,a,l,u,h]=i;return[o,s,n,a,l,u,h]}function kte(t,e){const r=t.formatToParts(e),i=[];for(let s=0;s<r.length;s++){const{type:n,value:o}=r[s],a=Lte[n];n==="era"?i[a]=o:Ae(a)||(i[a]=parseInt(o,10))}return i}const Tx=new Map;class ps extends Cd{static create(e){let r=Tx.get(e);return r===void 0&&Tx.set(e,r=new ps(e)),r}static resetCache(){Tx.clear(),QM.clear()}static isValidSpecifier(e){return this.isValidZone(e)}static isValidZone(e){if(!e)return!1;try{return new Intl.DateTimeFormat("en-US",{timeZone:e}).format(),!0}catch{return!1}}constructor(e){super(),this.zoneName=e,this.valid=ps.isValidZone(e)}get type(){return"iana"}get name(){return this.zoneName}get isUniversal(){return!1}offsetName(e,{format:r,locale:i}){return Xj(e,r,i,this.name)}formatOffset(e,r){return Yg(this.offset(e),r)}offset(e){if(!this.valid)return NaN;const r=new Date(e);if(isNaN(r))return NaN;const i=Ate(this.name);let[s,n,o,a,l,u,h]=i.formatToParts?kte(i,r):Rte(i,r);a==="BC"&&(s=-Math.abs(s)+1);const m=i2({year:s,month:n,day:o,hour:l===24?0:l,minute:u,second:h,millisecond:0});let y=+r;const g=y%1e3;return y-=g>=0?g:1e3+g,(m-y)/(60*1e3)}equals(e){return e.type==="iana"&&e.name===this.name}get isValid(){return this.valid}}let sk={};function Ote(t,e={}){const r=JSON.stringify([t,e]);let i=sk[r];return i||(i=new Intl.ListFormat(t,e),sk[r]=i),i}const eT=new Map;function tT(t,e={}){const r=JSON.stringify([t,e]);let i=eT.get(r);return i===void 0&&(i=new Intl.DateTimeFormat(t,e),eT.set(r,i)),i}const rT=new Map;function Nte(t,e={}){const r=JSON.stringify([t,e]);let i=rT.get(r);return i===void 0&&(i=new Intl.NumberFormat(t,e),rT.set(r,i)),i}const iT=new Map;function Fte(t,e={}){const{base:r,...i}=e,s=JSON.stringify([t,i]);let n=iT.get(s);return n===void 0&&(n=new Intl.RelativeTimeFormat(t,e),iT.set(s,n)),n}let Gy=null;function Dte(){return Gy||(Gy=new Intl.DateTimeFormat().resolvedOptions().locale,Gy)}const sT=new Map;function jj(t){let e=sT.get(t);return e===void 0&&(e=new Intl.DateTimeFormat(t).resolvedOptions(),sT.set(t,e)),e}const nT=new Map;function zte(t){let e=nT.get(t);if(!e){const r=new Intl.Locale(t);e="getWeekInfo"in r?r.getWeekInfo():r.weekInfo,"minimalDays"in e||(e={...Uj,...e}),nT.set(t,e)}return e}function Vte(t){const e=t.indexOf("-x-");e!==-1&&(t=t.substring(0,e));const r=t.indexOf("-u-");if(r===-1)return[t];{let i,s;try{i=tT(t).resolvedOptions(),s=t}catch{const l=t.substring(0,r);i=tT(l).resolvedOptions(),s=l}const{numberingSystem:n,calendar:o}=i;return[s,n,o]}}function jte(t,e,r){return(r||e)&&(t.includes("-u-")||(t+="-u"),r&&(t+=`-ca-${r}`),e&&(t+=`-nu-${e}`)),t}function Ute(t){const e=[];for(let r=1;r<=12;r++){const i=ue.utc(2009,r,1);e.push(t(i))}return e}function Gte(t){const e=[];for(let r=1;r<=7;r++){const i=ue.utc(2016,11,13+r);e.push(t(i))}return e}function o_(t,e,r,i){const s=t.listingMode();return s==="error"?null:s==="en"?r(e):i(e)}function Bte(t){return t.numberingSystem&&t.numberingSystem!=="latn"?!1:t.numberingSystem==="latn"||!t.locale||t.locale.startsWith("en")||jj(t.locale).numberingSystem==="latn"}class qte{constructor(e,r,i){this.padTo=i.padTo||0,this.floor=i.floor||!1;const{padTo:s,floor:n,...o}=i;if(!r||Object.keys(o).length>0){const a={useGrouping:!1,...i};i.padTo>0&&(a.minimumIntegerDigits=i.padTo),this.inf=Nte(e,a)}}format(e){if(this.inf){const r=this.floor?Math.floor(e):e;return this.inf.format(r)}else{const r=this.floor?Math.floor(e):L3(e,3);return vr(r,this.padTo)}}}class Hte{constructor(e,r,i){this.opts=i,this.originalZone=void 0;let s;if(this.opts.timeZone)this.dt=e;else if(e.zone.type==="fixed"){const o=-1*(e.offset/60),a=o>=0?`Etc/GMT+${o}`:`Etc/GMT${o}`;e.offset!==0&&ps.create(a).valid?(s=a,this.dt=e):(s="UTC",this.dt=e.offset===0?e:e.setZone("UTC").plus({minutes:e.offset}),this.originalZone=e.zone)}else e.zone.type==="system"?this.dt=e:e.zone.type==="iana"?(this.dt=e,s=e.zone.name):(s="UTC",this.dt=e.setZone("UTC").plus({minutes:e.offset}),this.originalZone=e.zone);const n={...this.opts};n.timeZone=n.timeZone||s,this.dtf=tT(r,n)}format(){return this.originalZone?this.formatToParts().map(({value:e})=>e).join(""):this.dtf.format(this.dt.toJSDate())}formatToParts(){const e=this.dtf.formatToParts(this.dt.toJSDate());return this.originalZone?e.map(r=>{if(r.type==="timeZoneName"){const i=this.originalZone.offsetName(this.dt.ts,{locale:this.dt.locale,format:this.opts.timeZoneName});return{...r,value:i}}else return r}):e}resolvedOptions(){return this.dtf.resolvedOptions()}}class Wte{constructor(e,r,i){this.opts={style:"long",...i},!r&&Jj()&&(this.rtf=Fte(e,i))}format(e,r){return this.rtf?this.rtf.format(e,r):mre(r,e,this.opts.numeric,this.opts.style!=="long")}formatToParts(e,r){return this.rtf?this.rtf.formatToParts(e,r):[]}}const Uj={firstDay:1,minimalDays:4,weekend:[6,7]};class ct{static fromOpts(e){return ct.create(e.locale,e.numberingSystem,e.outputCalendar,e.weekSettings,e.defaultToEN)}static create(e,r,i,s,n=!1){const o=e||Qt.defaultLocale,a=o||(n?"en-US":Dte()),l=r||Qt.defaultNumberingSystem,u=i||Qt.defaultOutputCalendar,h=aT(s)||Qt.defaultWeekSettings;return new ct(a,l,u,h,o)}static resetCache(){Gy=null,eT.clear(),rT.clear(),iT.clear(),sT.clear(),nT.clear()}static fromObject({locale:e,numberingSystem:r,outputCalendar:i,weekSettings:s}={}){return ct.create(e,r,i,s)}constructor(e,r,i,s,n){const[o,a,l]=Vte(e);this.locale=o,this.numberingSystem=r||a||null,this.outputCalendar=i||l||null,this.weekSettings=s,this.intl=jte(this.locale,this.numberingSystem,this.outputCalendar),this.weekdaysCache={format:{},standalone:{}},this.monthsCache={format:{},standalone:{}},this.meridiemCache=null,this.eraCache={},this.specifiedLocale=n,this.fastNumbersCached=null}get fastNumbers(){return this.fastNumbersCached==null&&(this.fastNumbersCached=Bte(this)),this.fastNumbersCached}listingMode(){const e=this.isEnglish(),r=(this.numberingSystem===null||this.numberingSystem==="latn")&&(this.outputCalendar===null||this.outputCalendar==="gregory");return e&&r?"en":"intl"}clone(e){return!e||Object.getOwnPropertyNames(e).length===0?this:ct.create(e.locale||this.specifiedLocale,e.numberingSystem||this.numberingSystem,e.outputCalendar||this.outputCalendar,aT(e.weekSettings)||this.weekSettings,e.defaultToEN||!1)}redefaultToEN(e={}){return this.clone({...e,defaultToEN:!0})}redefaultToSystem(e={}){return this.clone({...e,defaultToEN:!1})}months(e,r=!1){return o_(this,e,e8,()=>{const i=r?{month:e,day:"numeric"}:{month:e},s=r?"format":"standalone";return this.monthsCache[s][e]||(this.monthsCache[s][e]=Ute(n=>this.extract(n,i,"month"))),this.monthsCache[s][e]})}weekdays(e,r=!1){return o_(this,e,i8,()=>{const i=r?{weekday:e,year:"numeric",month:"long",day:"numeric"}:{weekday:e},s=r?"format":"standalone";return this.weekdaysCache[s][e]||(this.weekdaysCache[s][e]=Gte(n=>this.extract(n,i,"weekday"))),this.weekdaysCache[s][e]})}meridiems(){return o_(this,void 0,()=>s8,()=>{if(!this.meridiemCache){const e={hour:"numeric",hourCycle:"h12"};this.meridiemCache=[ue.utc(2016,11,13,9),ue.utc(2016,11,13,19)].map(r=>this.extract(r,e,"dayperiod"))}return this.meridiemCache})}eras(e){return o_(this,e,n8,()=>{const r={era:e};return this.eraCache[e]||(this.eraCache[e]=[ue.utc(-40,1,1),ue.utc(2017,1,1)].map(i=>this.extract(i,r,"era"))),this.eraCache[e]})}extract(e,r,i){const s=this.dtFormatter(e,r),n=s.formatToParts(),o=n.find(a=>a.type.toLowerCase()===i);return o?o.value:null}numberFormatter(e={}){return new qte(this.intl,e.forceSimple||this.fastNumbers,e)}dtFormatter(e,r={}){return new Hte(e,this.intl,r)}relFormatter(e={}){return new Wte(this.intl,this.isEnglish(),e)}listFormatter(e={}){return Ote(this.intl,e)}isEnglish(){return this.locale==="en"||this.locale.toLowerCase()==="en-us"||jj(this.intl).locale.startsWith("en-us")}getWeekSettings(){return this.weekSettings?this.weekSettings:Yj()?zte(this.locale):Uj}getStartOfWeek(){return this.getWeekSettings().firstDay}getMinDaysInFirstWeek(){return this.getWeekSettings().minimalDays}getWeekendDays(){return this.getWeekSettings().weekend}equals(e){return this.locale===e.locale&&this.numberingSystem===e.numberingSystem&&this.outputCalendar===e.outputCalendar}toString(){return`Locale(${this.locale}, ${this.numberingSystem}, ${this.outputCalendar})`}}let Ex=null;class _r extends Cd{static get utcInstance(){return Ex===null&&(Ex=new _r(0)),Ex}static instance(e){return e===0?_r.utcInstance:new _r(e)}static parseSpecifier(e){if(e){const r=e.match(/^utc(?:([+-]\d{1,2})(?::(\d{2}))?)?$/i);if(r)return new _r(s2(r[1],r[2]))}return null}constructor(e){super(),this.fixed=e}get type(){return"fixed"}get name(){return this.fixed===0?"UTC":`UTC${Yg(this.fixed,"narrow")}`}get ianaName(){return this.fixed===0?"Etc/UTC":`Etc/GMT${Yg(-this.fixed,"narrow")}`}offsetName(){return this.name}formatOffset(e,r){return Yg(this.fixed,r)}get isUniversal(){return!0}offset(){return this.fixed}equals(e){return e.type==="fixed"&&e.fixed===this.fixed}get isValid(){return!0}}class Zte extends Cd{constructor(e){super(),this.zoneName=e}get type(){return"invalid"}get name(){return this.zoneName}get isUniversal(){return!1}offsetName(){return null}formatOffset(){return""}offset(){return NaN}equals(){return!1}get isValid(){return!1}}function Fu(t,e){if(Ae(t)||t===null)return e;if(t instanceof Cd)return t;if(ere(t)){const r=t.toLowerCase();return r==="default"?e:r==="local"||r==="system"?t2.instance:r==="utc"||r==="gmt"?_r.utcInstance:_r.parseSpecifier(r)||ps.create(t)}else return Ku(t)?_r.instance(t):typeof t=="object"&&"offset"in t&&typeof t.offset=="function"?t:new Zte(t)}const I3={arab:"[-]",arabext:"[-]",bali:"[-]",beng:"[-]",deva:"[-]",fullwide:"[-]",gujr:"[-]",hanidec:"[|||||||||]",khmr:"[-]",knda:"[-]",laoo:"[-]",limb:"[-]",mlym:"[-]",mong:"[-]",mymr:"[-]",orya:"[-]",tamldec:"[-]",telu:"[-]",thai:"[-]",tibt:"[-]",latn:"\\d"},nk={arab:[1632,1641],arabext:[1776,1785],bali:[6992,7001],beng:[2534,2543],deva:[2406,2415],fullwide:[65296,65303],gujr:[2790,2799],khmr:[6112,6121],knda:[3302,3311],laoo:[3792,3801],limb:[6470,6479],mlym:[3430,3439],mong:[6160,6169],mymr:[4160,4169],orya:[2918,2927],tamldec:[3046,3055],telu:[3174,3183],thai:[3664,3673],tibt:[3872,3881]},Jte=I3.hanidec.replace(/[\[|\]]/g,"").split("");function Yte(t){let e=parseInt(t,10);if(isNaN(e)){e="";for(let r=0;r<t.length;r++){const i=t.charCodeAt(r);if(t[r].search(I3.hanidec)!==-1)e+=Jte.indexOf(t[r]);else for(const s in nk){const[n,o]=nk[s];i>=n&&i<=o&&(e+=i-n)}}return parseInt(e,10)}else return e}const oT=new Map;function Xte(){oT.clear()}function Tn({numberingSystem:t},e=""){const r=t||"latn";let i=oT.get(r);i===void 0&&(i=new Map,oT.set(r,i));let s=i.get(e);return s===void 0&&(s=new RegExp(`${I3[r]}${e}`),i.set(e,s)),s}let ok=()=>Date.now(),ak="system",lk=null,uk=null,ck=null,hk=60,dk,pk=null;class Qt{static get now(){return ok}static set now(e){ok=e}static set defaultZone(e){ak=e}static get defaultZone(){return Fu(ak,t2.instance)}static get defaultLocale(){return lk}static set defaultLocale(e){lk=e}static get defaultNumberingSystem(){return uk}static set defaultNumberingSystem(e){uk=e}static get defaultOutputCalendar(){return ck}static set defaultOutputCalendar(e){ck=e}static get defaultWeekSettings(){return pk}static set defaultWeekSettings(e){pk=aT(e)}static get twoDigitCutoffYear(){return hk}static set twoDigitCutoffYear(e){hk=e%100}static get throwOnInvalid(){return dk}static set throwOnInvalid(e){dk=e}static resetCaches(){ct.resetCache(),ps.resetCache(),ue.resetCache(),Xte()}}class eo{constructor(e,r){this.reason=e,this.explanation=r}toMessage(){return this.explanation?`${this.reason}: ${this.explanation}`:this.reason}}const Gj=[0,31,59,90,120,151,181,212,243,273,304,334],Bj=[0,31,60,91,121,152,182,213,244,274,305,335];function cn(t,e){return new eo("unit out of range",`you specified ${e} (of type ${typeof e}) as a ${t}, which is invalid`)}function C3(t,e,r){const i=new Date(Date.UTC(t,e-1,r));t<100&&t>=0&&i.setUTCFullYear(i.getUTCFullYear()-1900);const s=i.getUTCDay();return s===0?7:s}function qj(t,e,r){return r+($v(t)?Bj:Gj)[e-1]}function Hj(t,e){const r=$v(t)?Bj:Gj,i=r.findIndex(n=>n<e),s=e-r[i];return{month:i+1,day:s}}function P3(t,e){return(t-e+7)%7+1}function vw(t,e=4,r=1){const{year:i,month:s,day:n}=t,o=qj(i,s,n),a=P3(C3(i,s,n),r);let l=Math.floor((o-a+14-e)/7),u;return l<1?(u=i-1,l=R0(u,e,r)):l>R0(i,e,r)?(u=i+1,l=1):u=i,{weekYear:u,weekNumber:l,weekday:a,...n2(t)}}function fk(t,e=4,r=1){const{weekYear:i,weekNumber:s,weekday:n}=t,o=P3(C3(i,1,e),r),a=mf(i);let l=s*7+n-o-7+e,u;l<1?(u=i-1,l+=mf(u)):l>a?(u=i+1,l-=mf(i)):u=i;const{month:h,day:p}=Hj(u,l);return{year:u,month:h,day:p,...n2(t)}}function Ix(t){const{year:e,month:r,day:i}=t,s=qj(e,r,i);return{year:e,ordinal:s,...n2(t)}}function mk(t){const{year:e,ordinal:r}=t,{month:i,day:s}=Hj(e,r);return{year:e,month:i,day:s,...n2(t)}}function yk(t,e){if(!Ae(t.localWeekday)||!Ae(t.localWeekNumber)||!Ae(t.localWeekYear)){if(!Ae(t.weekday)||!Ae(t.weekNumber)||!Ae(t.weekYear))throw new qp("Cannot mix locale-based week fields with ISO-based week fields");return Ae(t.localWeekday)||(t.weekday=t.localWeekday),Ae(t.localWeekNumber)||(t.weekNumber=t.localWeekNumber),Ae(t.localWeekYear)||(t.weekYear=t.localWeekYear),delete t.localWeekday,delete t.localWeekNumber,delete t.localWeekYear,{minDaysInFirstWeek:e.getMinDaysInFirstWeek(),startOfWeek:e.getStartOfWeek()}}else return{minDaysInFirstWeek:4,startOfWeek:1}}function Kte(t,e=4,r=1){const i=r2(t.weekYear),s=hn(t.weekNumber,1,R0(t.weekYear,e,r)),n=hn(t.weekday,1,7);return i?s?n?!1:cn("weekday",t.weekday):cn("week",t.weekNumber):cn("weekYear",t.weekYear)}function Qte(t){const e=r2(t.year),r=hn(t.ordinal,1,mf(t.year));return e?r?!1:cn("ordinal",t.ordinal):cn("year",t.year)}function Wj(t){const e=r2(t.year),r=hn(t.month,1,12),i=hn(t.day,1,_w(t.year,t.month));return e?r?i?!1:cn("day",t.day):cn("month",t.month):cn("year",t.year)}function Zj(t){const{hour:e,minute:r,second:i,millisecond:s}=t,n=hn(e,0,23)||e===24&&r===0&&i===0&&s===0,o=hn(r,0,59),a=hn(i,0,59),l=hn(s,0,999);return n?o?a?l?!1:cn("millisecond",s):cn("second",i):cn("minute",r):cn("hour",e)}function Ae(t){return typeof t>"u"}function Ku(t){return typeof t=="number"}function r2(t){return typeof t=="number"&&t%1===0}function ere(t){return typeof t=="string"}function tre(t){return Object.prototype.toString.call(t)==="[object Date]"}function Jj(){try{return typeof Intl<"u"&&!!Intl.RelativeTimeFormat}catch{return!1}}function Yj(){try{return typeof Intl<"u"&&!!Intl.Locale&&("weekInfo"in Intl.Locale.prototype||"getWeekInfo"in Intl.Locale.prototype)}catch{return!1}}function rre(t){return Array.isArray(t)?t:[t]}function gk(t,e,r){if(t.length!==0)return t.reduce((i,s)=>{const n=[e(s),s];return i&&r(i[0],n[0])===i[0]?i:n},null)[1]}function ire(t,e){return e.reduce((r,i)=>(r[i]=t[i],r),{})}function hm(t,e){return Object.prototype.hasOwnProperty.call(t,e)}function aT(t){if(t==null)return null;if(typeof t!="object")throw new fi("Week settings must be an object");if(!hn(t.firstDay,1,7)||!hn(t.minimalDays,1,7)||!Array.isArray(t.weekend)||t.weekend.some(e=>!hn(e,1,7)))throw new fi("Invalid week settings");return{firstDay:t.firstDay,minimalDays:t.minimalDays,weekend:Array.from(t.weekend)}}function hn(t,e,r){return r2(t)&&t>=e&&t<=r}function sre(t,e){return t-e*Math.floor(t/e)}function vr(t,e=2){const r=t<0;let i;return r?i="-"+(""+-t).padStart(e,"0"):i=(""+t).padStart(e,"0"),i}function Eu(t){if(!(Ae(t)||t===null||t===""))return parseInt(t,10)}function Mc(t){if(!(Ae(t)||t===null||t===""))return parseFloat(t)}function A3(t){if(!(Ae(t)||t===null||t==="")){const e=parseFloat("0."+t)*1e3;return Math.floor(e)}}function L3(t,e,r=!1){const i=10**e;return(r?Math.trunc:Math.round)(t*i)/i}function $v(t){return t%4===0&&(t%100!==0||t%400===0)}function mf(t){return $v(t)?366:365}function _w(t,e){const r=sre(e-1,12)+1,i=t+(e-r)/12;return r===2?$v(i)?29:28:[31,null,31,30,31,30,31,31,30,31,30,31][r-1]}function i2(t){let e=Date.UTC(t.year,t.month-1,t.day,t.hour,t.minute,t.second,t.millisecond);return t.year<100&&t.year>=0&&(e=new Date(e),e.setUTCFullYear(t.year,t.month-1,t.day)),+e}function vk(t,e,r){return-P3(C3(t,1,e),r)+e-1}function R0(t,e=4,r=1){const i=vk(t,e,r),s=vk(t+1,e,r);return(mf(t)-i+s)/7}function lT(t){return t>99?t:t>Qt.twoDigitCutoffYear?1900+t:2e3+t}function Xj(t,e,r,i=null){const s=new Date(t),n={hourCycle:"h23",year:"numeric",month:"2-digit",day:"2-digit",hour:"2-digit",minute:"2-digit"};i&&(n.timeZone=i);const o={timeZoneName:e,...n},a=new Intl.DateTimeFormat(r,o).formatToParts(s).find(l=>l.type.toLowerCase()==="timezonename");return a?a.value:null}function s2(t,e){let r=parseInt(t,10);Number.isNaN(r)&&(r=0);const i=parseInt(e,10)||0,s=r<0||Object.is(r,-0)?-i:i;return r*60+s}function Kj(t){const e=Number(t);if(typeof t=="boolean"||t===""||Number.isNaN(e))throw new fi(`Invalid unit value ${t}`);return e}function bw(t,e){const r={};for(const i in t)if(hm(t,i)){const s=t[i];if(s==null)continue;r[e(i)]=Kj(s)}return r}function Yg(t,e){const r=Math.trunc(Math.abs(t/60)),i=Math.trunc(Math.abs(t%60)),s=t>=0?"+":"-";switch(e){case"short":return`${s}${vr(r,2)}:${vr(i,2)}`;case"narrow":return`${s}${r}${i>0?`:${i}`:""}`;case"techie":return`${s}${vr(r,2)}${vr(i,2)}`;default:throw new RangeError(`Value format ${e} is out of range for property format`)}}function n2(t){return ire(t,["hour","minute","second","millisecond"])}const nre=["January","February","March","April","May","June","July","August","September","October","November","December"],Qj=["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],ore=["J","F","M","A","M","J","J","A","S","O","N","D"];function e8(t){switch(t){case"narrow":return[...ore];case"short":return[...Qj];case"long":return[...nre];case"numeric":return["1","2","3","4","5","6","7","8","9","10","11","12"];case"2-digit":return["01","02","03","04","05","06","07","08","09","10","11","12"];default:return null}}const t8=["Monday","Tuesday","Wednesday","Thursday","Friday","Saturday","Sunday"],r8=["Mon","Tue","Wed","Thu","Fri","Sat","Sun"],are=["M","T","W","T","F","S","S"];function i8(t){switch(t){case"narrow":return[...are];case"short":return[...r8];case"long":return[...t8];case"numeric":return["1","2","3","4","5","6","7"];default:return null}}const s8=["AM","PM"],lre=["Before Christ","Anno Domini"],ure=["BC","AD"],cre=["B","A"];function n8(t){switch(t){case"narrow":return[...cre];case"short":return[...ure];case"long":return[...lre];default:return null}}function hre(t){return s8[t.hour<12?0:1]}function dre(t,e){return i8(e)[t.weekday-1]}function pre(t,e){return e8(e)[t.month-1]}function fre(t,e){return n8(e)[t.year<0?0:1]}function mre(t,e,r="always",i=!1){const s={years:["year","yr."],quarters:["quarter","qtr."],months:["month","mo."],weeks:["week","wk."],days:["day","day","days"],hours:["hour","hr."],minutes:["minute","min."],seconds:["second","sec."]},n=["hours","minutes","seconds"].indexOf(t)===-1;if(r==="auto"&&n){const p=t==="days";switch(e){case 1:return p?"tomorrow":`next ${s[t][0]}`;case-1:return p?"yesterday":`last ${s[t][0]}`;case 0:return p?"today":`this ${s[t][0]}`}}const o=Object.is(e,-0)||e<0,a=Math.abs(e),l=a===1,u=s[t],h=i?l?u[1]:u[2]||u[1]:l?s[t][0]:t;return o?`${a} ${h} ago`:`in ${a} ${h}`}function _k(t,e){let r="";for(const i of t)i.literal?r+=i.val:r+=e(i.val);return r}const yre={D:gw,DD:Sj,DDD:xj,DDDD:$j,t:Mj,tt:Tj,ttt:Ej,tttt:Ij,T:Cj,TT:Pj,TTT:Aj,TTTT:Lj,f:Rj,ff:Oj,fff:Fj,ffff:zj,F:kj,FF:Nj,FFF:Dj,FFFF:Vj};class bi{static create(e,r={}){return new bi(e,r)}static parseFormat(e){let r=null,i="",s=!1;const n=[];for(let o=0;o<e.length;o++){const a=e.charAt(o);a==="'"?(i.length>0&&n.push({literal:s||/^\s+$/.test(i),val:i}),r=null,i="",s=!s):s||a===r?i+=a:(i.length>0&&n.push({literal:/^\s+$/.test(i),val:i}),i=a,r=a)}return i.length>0&&n.push({literal:s||/^\s+$/.test(i),val:i}),n}static macroTokenToFormatOpts(e){return yre[e]}constructor(e,r){this.opts=r,this.loc=e,this.systemLoc=null}formatWithSystemDefault(e,r){return this.systemLoc===null&&(this.systemLoc=this.loc.redefaultToSystem()),this.systemLoc.dtFormatter(e,{...this.opts,...r}).format()}dtFormatter(e,r={}){return this.loc.dtFormatter(e,{...this.opts,...r})}formatDateTime(e,r){return this.dtFormatter(e,r).format()}formatDateTimeParts(e,r){return this.dtFormatter(e,r).formatToParts()}formatInterval(e,r){return this.dtFormatter(e.start,r).dtf.formatRange(e.start.toJSDate(),e.end.toJSDate())}resolvedOptions(e,r){return this.dtFormatter(e,r).resolvedOptions()}num(e,r=0){if(this.opts.forceSimple)return vr(e,r);const i={...this.opts};return r>0&&(i.padTo=r),this.loc.numberFormatter(i).format(e)}formatDateTimeFromString(e,r){const i=this.loc.listingMode()==="en",s=this.loc.outputCalendar&&this.loc.outputCalendar!=="gregory",n=(y,g)=>this.loc.extract(e,y,g),o=y=>e.isOffsetFixed&&e.offset===0&&y.allowZ?"Z":e.isValid?e.zone.formatOffset(e.ts,y.format):"",a=()=>i?hre(e):n({hour:"numeric",hourCycle:"h12"},"dayperiod"),l=(y,g)=>i?pre(e,y):n(g?{month:y}:{month:y,day:"numeric"},"month"),u=(y,g)=>i?dre(e,y):n(g?{weekday:y}:{weekday:y,month:"long",day:"numeric"},"weekday"),h=y=>{const g=bi.macroTokenToFormatOpts(y);return g?this.formatWithSystemDefault(e,g):y},p=y=>i?fre(e,y):n({era:y},"era"),m=y=>{switch(y){case"S":return this.num(e.millisecond);case"u":case"SSS":return this.num(e.millisecond,3);case"s":return this.num(e.second);case"ss":return this.num(e.second,2);case"uu":return this.num(Math.floor(e.millisecond/10),2);case"uuu":return this.num(Math.floor(e.millisecond/100));case"m":return this.num(e.minute);case"mm":return this.num(e.minute,2);case"h":return this.num(e.hour%12===0?12:e.hour%12);case"hh":return this.num(e.hour%12===0?12:e.hour%12,2);case"H":return this.num(e.hour);case"HH":return this.num(e.hour,2);case"Z":return o({format:"narrow",allowZ:this.opts.allowZ});case"ZZ":return o({format:"short",allowZ:this.opts.allowZ});case"ZZZ":return o({format:"techie",allowZ:this.opts.allowZ});case"ZZZZ":return e.zone.offsetName(e.ts,{format:"short",locale:this.loc.locale});case"ZZZZZ":return e.zone.offsetName(e.ts,{format:"long",locale:this.loc.locale});case"z":return e.zoneName;case"a":return a();case"d":return s?n({day:"numeric"},"day"):this.num(e.day);case"dd":return s?n({day:"2-digit"},"day"):this.num(e.day,2);case"c":return this.num(e.weekday);case"ccc":return u("short",!0);case"cccc":return u("long",!0);case"ccccc":return u("narrow",!0);case"E":return this.num(e.weekday);case"EEE":return u("short",!1);case"EEEE":return u("long",!1);case"EEEEE":return u("narrow",!1);case"L":return s?n({month:"numeric",day:"numeric"},"month"):this.num(e.month);case"LL":return s?n({month:"2-digit",day:"numeric"},"month"):this.num(e.month,2);case"LLL":return l("short",!0);case"LLLL":return l("long",!0);case"LLLLL":return l("narrow",!0);case"M":return s?n({month:"numeric"},"month"):this.num(e.month);case"MM":return s?n({month:"2-digit"},"month"):this.num(e.month,2);case"MMM":return l("short",!1);case"MMMM":return l("long",!1);case"MMMMM":return l("narrow",!1);case"y":return s?n({year:"numeric"},"year"):this.num(e.year);case"yy":return s?n({year:"2-digit"},"year"):this.num(e.year.toString().slice(-2),2);case"yyyy":return s?n({year:"numeric"},"year"):this.num(e.year,4);case"yyyyyy":return s?n({year:"numeric"},"year"):this.num(e.year,6);case"G":return p("short");case"GG":return p("long");case"GGGGG":return p("narrow");case"kk":return this.num(e.weekYear.toString().slice(-2),2);case"kkkk":return this.num(e.weekYear,4);case"W":return this.num(e.weekNumber);case"WW":return this.num(e.weekNumber,2);case"n":return this.num(e.localWeekNumber);case"nn":return this.num(e.localWeekNumber,2);case"ii":return this.num(e.localWeekYear.toString().slice(-2),2);case"iiii":return this.num(e.localWeekYear,4);case"o":return this.num(e.ordinal);case"ooo":return this.num(e.ordinal,3);case"q":return this.num(e.quarter);case"qq":return this.num(e.quarter,2);case"X":return this.num(Math.floor(e.ts/1e3));case"x":return this.num(e.ts);default:return h(y)}};return _k(bi.parseFormat(r),m)}formatDurationFromString(e,r){const i=l=>{switch(l[0]){case"S":return"millisecond";case"s":return"second";case"m":return"minute";case"h":return"hour";case"d":return"day";case"w":return"week";case"M":return"month";case"y":return"year";default:return null}},s=l=>u=>{const h=i(u);return h?this.num(l.get(h),u.length):u},n=bi.parseFormat(r),o=n.reduce((l,{literal:u,val:h})=>u?l:l.concat(h),[]),a=e.shiftTo(...o.map(i).filter(l=>l));return _k(n,s(a))}}const o8=/[A-Za-z_+-]{1,256}(?::?\/[A-Za-z0-9_+-]{1,256}(?:\/[A-Za-z0-9_+-]{1,256})?)?/;function Nm(...t){const e=t.reduce((r,i)=>r+i.source,"");return RegExp(`^${e}$`)}function Fm(...t){return e=>t.reduce(([r,i,s],n)=>{const[o,a,l]=n(e,s);return[{...r,...o},a||i,l]},[{},null,1]).slice(0,2)}function Dm(t,...e){if(t==null)return[null,null];for(const[r,i]of e){const s=r.exec(t);if(s)return i(s)}return[null,null]}function a8(...t){return(e,r)=>{const i={};let s;for(s=0;s<t.length;s++)i[t[s]]=Eu(e[r+s]);return[i,null,r+s]}}const l8=/(?:(Z)|([+-]\d\d)(?::?(\d\d))?)/,gre=`(?:${l8.source}?(?:\\[(${o8.source})\\])?)?`,R3=/(\d\d)(?::?(\d\d)(?::?(\d\d)(?:[.,](\d{1,30}))?)?)?/,u8=RegExp(`${R3.source}${gre}`),k3=RegExp(`(?:T${u8.source})?`),vre=/([+-]\d{6}|\d{4})(?:-?(\d\d)(?:-?(\d\d))?)?/,_re=/(\d{4})-?W(\d\d)(?:-?(\d))?/,bre=/(\d{4})-?(\d{3})/,wre=a8("weekYear","weekNumber","weekDay"),Sre=a8("year","ordinal"),xre=/(\d{4})-(\d\d)-(\d\d)/,c8=RegExp(`${R3.source} ?(?:${l8.source}|(${o8.source}))?`),$re=RegExp(`(?: ${c8.source})?`);function yf(t,e,r){const i=t[e];return Ae(i)?r:Eu(i)}function Mre(t,e){return[{year:yf(t,e),month:yf(t,e+1,1),day:yf(t,e+2,1)},null,e+3]}function zm(t,e){return[{hours:yf(t,e,0),minutes:yf(t,e+1,0),seconds:yf(t,e+2,0),milliseconds:A3(t[e+3])},null,e+4]}function Mv(t,e){const r=!t[e]&&!t[e+1],i=s2(t[e+1],t[e+2]),s=r?null:_r.instance(i);return[{},s,e+3]}function Tv(t,e){const r=t[e]?ps.create(t[e]):null;return[{},r,e+1]}const Tre=RegExp(`^T?${R3.source}$`),Ere=/^-?P(?:(?:(-?\d{1,20}(?:\.\d{1,20})?)Y)?(?:(-?\d{1,20}(?:\.\d{1,20})?)M)?(?:(-?\d{1,20}(?:\.\d{1,20})?)W)?(?:(-?\d{1,20}(?:\.\d{1,20})?)D)?(?:T(?:(-?\d{1,20}(?:\.\d{1,20})?)H)?(?:(-?\d{1,20}(?:\.\d{1,20})?)M)?(?:(-?\d{1,20})(?:[.,](-?\d{1,20}))?S)?)?)$/;function Ire(t){const[e,r,i,s,n,o,a,l,u]=t,h=e[0]==="-",p=l&&l[0]==="-",m=(y,g=!1)=>y!==void 0&&(g||y&&h)?-y:y;return[{years:m(Mc(r)),months:m(Mc(i)),weeks:m(Mc(s)),days:m(Mc(n)),hours:m(Mc(o)),minutes:m(Mc(a)),seconds:m(Mc(l),l==="-0"),milliseconds:m(A3(u),p)}]}const Cre={GMT:0,EDT:-240,EST:-300,CDT:-300,CST:-360,MDT:-360,MST:-420,PDT:-420,PST:-480};function O3(t,e,r,i,s,n,o){const a={year:e.length===2?lT(Eu(e)):Eu(e),month:Qj.indexOf(r)+1,day:Eu(i),hour:Eu(s),minute:Eu(n)};return o&&(a.second=Eu(o)),t&&(a.weekday=t.length>3?t8.indexOf(t)+1:r8.indexOf(t)+1),a}const Pre=/^(?:(Mon|Tue|Wed|Thu|Fri|Sat|Sun),\s)?(\d{1,2})\s(Jan|Feb|Mar|Apr|May|Jun|Jul|Aug|Sep|Oct|Nov|Dec)\s(\d{2,4})\s(\d\d):(\d\d)(?::(\d\d))?\s(?:(UT|GMT|[ECMP][SD]T)|([Zz])|(?:([+-]\d\d)(\d\d)))$/;function Are(t){const[,e,r,i,s,n,o,a,l,u,h,p]=t,m=O3(e,s,i,r,n,o,a);let y;return l?y=Cre[l]:u?y=0:y=s2(h,p),[m,new _r(y)]}function Lre(t){return t.replace(/\([^()]*\)|[\n\t]/g," ").replace(/(\s\s+)/g," ").trim()}const Rre=/^(Mon|Tue|Wed|Thu|Fri|Sat|Sun), (\d\d) (Jan|Feb|Mar|Apr|May|Jun|Jul|Aug|Sep|Oct|Nov|Dec) (\d{4}) (\d\d):(\d\d):(\d\d) GMT$/,kre=/^(Monday|Tuesday|Wednesday|Thursday|Friday|Saturday|Sunday), (\d\d)-(Jan|Feb|Mar|Apr|May|Jun|Jul|Aug|Sep|Oct|Nov|Dec)-(\d\d) (\d\d):(\d\d):(\d\d) GMT$/,Ore=/^(Mon|Tue|Wed|Thu|Fri|Sat|Sun) (Jan|Feb|Mar|Apr|May|Jun|Jul|Aug|Sep|Oct|Nov|Dec) ( \d|\d\d) (\d\d):(\d\d):(\d\d) (\d{4})$/;function bk(t){const[,e,r,i,s,n,o,a]=t;return[O3(e,s,i,r,n,o,a),_r.utcInstance]}function Nre(t){const[,e,r,i,s,n,o,a]=t;return[O3(e,a,r,i,s,n,o),_r.utcInstance]}const Fre=Nm(vre,k3),Dre=Nm(_re,k3),zre=Nm(bre,k3),Vre=Nm(u8),h8=Fm(Mre,zm,Mv,Tv),jre=Fm(wre,zm,Mv,Tv),Ure=Fm(Sre,zm,Mv,Tv),Gre=Fm(zm,Mv,Tv);function Bre(t){return Dm(t,[Fre,h8],[Dre,jre],[zre,Ure],[Vre,Gre])}function qre(t){return Dm(Lre(t),[Pre,Are])}function Hre(t){return Dm(t,[Rre,bk],[kre,bk],[Ore,Nre])}function Wre(t){return Dm(t,[Ere,Ire])}const Zre=Fm(zm);function Jre(t){return Dm(t,[Tre,Zre])}const Yre=Nm(xre,$re),Xre=Nm(c8),Kre=Fm(zm,Mv,Tv);function Qre(t){return Dm(t,[Yre,h8],[Xre,Kre])}const wk="Invalid Duration",d8={weeks:{days:7,hours:168,minutes:10080,seconds:10080*60,milliseconds:10080*60*1e3},days:{hours:24,minutes:1440,seconds:1440*60,milliseconds:1440*60*1e3},hours:{minutes:60,seconds:3600,milliseconds:3600*1e3},minutes:{seconds:60,milliseconds:60*1e3},seconds:{milliseconds:1e3}},eie={years:{quarters:4,months:12,weeks:52,days:365,hours:365*24,minutes:365*24*60,seconds:365*24*60*60,milliseconds:365*24*60*60*1e3},quarters:{months:3,weeks:13,days:91,hours:2184,minutes:2184*60,seconds:2184*60*60,milliseconds:2184*60*60*1e3},months:{weeks:4,days:30,hours:720,minutes:720*60,seconds:720*60*60,milliseconds:720*60*60*1e3},...d8},Vs=146097/400,zd=146097/4800,tie={years:{quarters:4,months:12,weeks:Vs/7,days:Vs,hours:Vs*24,minutes:Vs*24*60,seconds:Vs*24*60*60,milliseconds:Vs*24*60*60*1e3},quarters:{months:3,weeks:Vs/28,days:Vs/4,hours:Vs*24/4,minutes:Vs*24*60/4,seconds:Vs*24*60*60/4,milliseconds:Vs*24*60*60*1e3/4},months:{weeks:zd/7,days:zd,hours:zd*24,minutes:zd*24*60,seconds:zd*24*60*60,milliseconds:zd*24*60*60*1e3},...d8},Fh=["years","quarters","months","weeks","days","hours","minutes","seconds","milliseconds"],rie=Fh.slice(0).reverse();function iu(t,e,r=!1){const i={values:r?e.values:{...t.values,...e.values||{}},loc:t.loc.clone(e.loc),conversionAccuracy:e.conversionAccuracy||t.conversionAccuracy,matrix:e.matrix||t.matrix};return new Ye(i)}function p8(t,e){let r=e.milliseconds??0;for(const i of rie.slice(1))e[i]&&(r+=e[i]*t[i].milliseconds);return r}function Sk(t,e){const r=p8(t,e)<0?-1:1;Fh.reduceRight((i,s)=>{if(Ae(e[s]))return i;if(i){const n=e[i]*r,o=t[s][i],a=Math.floor(n/o);e[s]+=a*r,e[i]-=a*o*r}return s},null),Fh.reduce((i,s)=>{if(Ae(e[s]))return i;if(i){const n=e[i]%1;e[i]-=n,e[s]+=n*t[i][s]}return s},null)}function iie(t){const e={};for(const[r,i]of Object.entries(t))i!==0&&(e[r]=i);return e}class Ye{constructor(e){const r=e.conversionAccuracy==="longterm"||!1;let i=r?tie:eie;e.matrix&&(i=e.matrix),this.values=e.values,this.loc=e.loc||ct.create(),this.conversionAccuracy=r?"longterm":"casual",this.invalid=e.invalid||null,this.matrix=i,this.isLuxonDuration=!0}static fromMillis(e,r){return Ye.fromObject({milliseconds:e},r)}static fromObject(e,r={}){if(e==null||typeof e!="object")throw new fi(`Duration.fromObject: argument expected to be an object, got ${e===null?"null":typeof e}`);return new Ye({values:bw(e,Ye.normalizeUnit),loc:ct.fromObject(r),conversionAccuracy:r.conversionAccuracy,matrix:r.matrix})}static fromDurationLike(e){if(Ku(e))return Ye.fromMillis(e);if(Ye.isDuration(e))return e;if(typeof e=="object")return Ye.fromObject(e);throw new fi(`Unknown duration argument ${e} of type ${typeof e}`)}static fromISO(e,r){const[i]=Wre(e);return i?Ye.fromObject(i,r):Ye.invalid("unparsable",`the input "${e}" can't be parsed as ISO 8601`)}static fromISOTime(e,r){const[i]=Jre(e);return i?Ye.fromObject(i,r):Ye.invalid("unparsable",`the input "${e}" can't be parsed as ISO 8601`)}static invalid(e,r=null){if(!e)throw new fi("need to specify a reason the Duration is invalid");const i=e instanceof eo?e:new eo(e,r);if(Qt.throwOnInvalid)throw new Ite(i);return new Ye({invalid:i})}static normalizeUnit(e){const r={year:"years",years:"years",quarter:"quarters",quarters:"quarters",month:"months",months:"months",week:"weeks",weeks:"weeks",day:"days",days:"days",hour:"hours",hours:"hours",minute:"minutes",minutes:"minutes",second:"seconds",seconds:"seconds",millisecond:"milliseconds",milliseconds:"milliseconds"}[e&&e.toLowerCase()];if(!r)throw new wj(e);return r}static isDuration(e){return e&&e.isLuxonDuration||!1}get locale(){return this.isValid?this.loc.locale:null}get numberingSystem(){return this.isValid?this.loc.numberingSystem:null}toFormat(e,r={}){const i={...r,floor:r.round!==!1&&r.floor!==!1};return this.isValid?bi.create(this.loc,i).formatDurationFromString(this,e):wk}toHuman(e={}){if(!this.isValid)return wk;const r=Fh.map(i=>{const s=this.values[i];return Ae(s)?null:this.loc.numberFormatter({style:"unit",unitDisplay:"long",...e,unit:i.slice(0,-1)}).format(s)}).filter(i=>i);return this.loc.listFormatter({type:"conjunction",style:e.listStyle||"narrow",...e}).format(r)}toObject(){return this.isValid?{...this.values}:{}}toISO(){if(!this.isValid)return null;let e="P";return this.years!==0&&(e+=this.years+"Y"),(this.months!==0||this.quarters!==0)&&(e+=this.months+this.quarters*3+"M"),this.weeks!==0&&(e+=this.weeks+"W"),this.days!==0&&(e+=this.days+"D"),(this.hours!==0||this.minutes!==0||this.seconds!==0||this.milliseconds!==0)&&(e+="T"),this.hours!==0&&(e+=this.hours+"H"),this.minutes!==0&&(e+=this.minutes+"M"),(this.seconds!==0||this.milliseconds!==0)&&(e+=L3(this.seconds+this.milliseconds/1e3,3)+"S"),e==="P"&&(e+="T0S"),e}toISOTime(e={}){if(!this.isValid)return null;const r=this.toMillis();return r<0||r>=864e5?null:(e={suppressMilliseconds:!1,suppressSeconds:!1,includePrefix:!1,format:"extended",...e,includeOffset:!1},ue.fromMillis(r,{zone:"UTC"}).toISOTime(e))}toJSON(){return this.toISO()}toString(){return this.toISO()}[Symbol.for("nodejs.util.inspect.custom")](){return this.isValid?`Duration { values: ${JSON.stringify(this.values)} }`:`Duration { Invalid, reason: ${this.invalidReason} }`}toMillis(){return this.isValid?p8(this.matrix,this.values):NaN}valueOf(){return this.toMillis()}plus(e){if(!this.isValid)return this;const r=Ye.fromDurationLike(e),i={};for(const s of Fh)(hm(r.values,s)||hm(this.values,s))&&(i[s]=r.get(s)+this.get(s));return iu(this,{values:i},!0)}minus(e){if(!this.isValid)return this;const r=Ye.fromDurationLike(e);return this.plus(r.negate())}mapUnits(e){if(!this.isValid)return this;const r={};for(const i of Object.keys(this.values))r[i]=Kj(e(this.values[i],i));return iu(this,{values:r},!0)}get(e){return this[Ye.normalizeUnit(e)]}set(e){if(!this.isValid)return this;const r={...this.values,...bw(e,Ye.normalizeUnit)};return iu(this,{values:r})}reconfigure({locale:e,numberingSystem:r,conversionAccuracy:i,matrix:s}={}){const o={loc:this.loc.clone({locale:e,numberingSystem:r}),matrix:s,conversionAccuracy:i};return iu(this,o)}as(e){return this.isValid?this.shiftTo(e).get(e):NaN}normalize(){if(!this.isValid)return this;const e=this.toObject();return Sk(this.matrix,e),iu(this,{values:e},!0)}rescale(){if(!this.isValid)return this;const e=iie(this.normalize().shiftToAll().toObject());return iu(this,{values:e},!0)}shiftTo(...e){if(!this.isValid)return this;if(e.length===0)return this;e=e.map(o=>Ye.normalizeUnit(o));const r={},i={},s=this.toObject();let n;for(const o of Fh)if(e.indexOf(o)>=0){n=o;let a=0;for(const u in i)a+=this.matrix[u][o]*i[u],i[u]=0;Ku(s[o])&&(a+=s[o]);const l=Math.trunc(a);r[o]=l,i[o]=(a*1e3-l*1e3)/1e3}else Ku(s[o])&&(i[o]=s[o]);for(const o in i)i[o]!==0&&(r[n]+=o===n?i[o]:i[o]/this.matrix[n][o]);return Sk(this.matrix,r),iu(this,{values:r},!0)}shiftToAll(){return this.isValid?this.shiftTo("years","months","weeks","days","hours","minutes","seconds","milliseconds"):this}negate(){if(!this.isValid)return this;const e={};for(const r of Object.keys(this.values))e[r]=this.values[r]===0?0:-this.values[r];return iu(this,{values:e},!0)}get years(){return this.isValid?this.values.years||0:NaN}get quarters(){return this.isValid?this.values.quarters||0:NaN}get months(){return this.isValid?this.values.months||0:NaN}get weeks(){return this.isValid?this.values.weeks||0:NaN}get days(){return this.isValid?this.values.days||0:NaN}get hours(){return this.isValid?this.values.hours||0:NaN}get minutes(){return this.isValid?this.values.minutes||0:NaN}get seconds(){return this.isValid?this.values.seconds||0:NaN}get milliseconds(){return this.isValid?this.values.milliseconds||0:NaN}get isValid(){return this.invalid===null}get invalidReason(){return this.invalid?this.invalid.reason:null}get invalidExplanation(){return this.invalid?this.invalid.explanation:null}equals(e){if(!this.isValid||!e.isValid||!this.loc.equals(e.loc))return!1;function r(i,s){return i===void 0||i===0?s===void 0||s===0:i===s}for(const i of Fh)if(!r(this.values[i],e.values[i]))return!1;return!0}}const Vd="Invalid Interval";function sie(t,e){return!t||!t.isValid?Yt.invalid("missing or invalid start"):!e||!e.isValid?Yt.invalid("missing or invalid end"):e<t?Yt.invalid("end before start",`The end of an interval must be after its start, but you had start=${t.toISO()} and end=${e.toISO()}`):null}class Yt{constructor(e){this.s=e.start,this.e=e.end,this.invalid=e.invalid||null,this.isLuxonInterval=!0}static invalid(e,r=null){if(!e)throw new fi("need to specify a reason the Interval is invalid");const i=e instanceof eo?e:new eo(e,r);if(Qt.throwOnInvalid)throw new Ete(i);return new Yt({invalid:i})}static fromDateTimes(e,r){const i=sy(e),s=sy(r),n=sie(i,s);return n??new Yt({start:i,end:s})}static after(e,r){const i=Ye.fromDurationLike(r),s=sy(e);return Yt.fromDateTimes(s,s.plus(i))}static before(e,r){const i=Ye.fromDurationLike(r),s=sy(e);return Yt.fromDateTimes(s.minus(i),s)}static fromISO(e,r){const[i,s]=(e||"").split("/",2);if(i&&s){let n,o;try{n=ue.fromISO(i,r),o=n.isValid}catch{o=!1}let a,l;try{a=ue.fromISO(s,r),l=a.isValid}catch{l=!1}if(o&&l)return Yt.fromDateTimes(n,a);if(o){const u=Ye.fromISO(s,r);if(u.isValid)return Yt.after(n,u)}else if(l){const u=Ye.fromISO(i,r);if(u.isValid)return Yt.before(a,u)}}return Yt.invalid("unparsable",`the input "${e}" can't be parsed as ISO 8601`)}static isInterval(e){return e&&e.isLuxonInterval||!1}get start(){return this.isValid?this.s:null}get end(){return this.isValid?this.e:null}get lastDateTime(){return this.isValid&&this.e?this.e.minus(1):null}get isValid(){return this.invalidReason===null}get invalidReason(){return this.invalid?this.invalid.reason:null}get invalidExplanation(){return this.invalid?this.invalid.explanation:null}length(e="milliseconds"){return this.isValid?this.toDuration(e).get(e):NaN}count(e="milliseconds",r){if(!this.isValid)return NaN;const i=this.start.startOf(e,r);let s;return r?.useLocaleWeeks?s=this.end.reconfigure({locale:i.locale}):s=this.end,s=s.startOf(e,r),Math.floor(s.diff(i,e).get(e))+(s.valueOf()!==this.end.valueOf())}hasSame(e){return this.isValid?this.isEmpty()||this.e.minus(1).hasSame(this.s,e):!1}isEmpty(){return this.s.valueOf()===this.e.valueOf()}isAfter(e){return this.isValid?this.s>e:!1}isBefore(e){return this.isValid?this.e<=e:!1}contains(e){return this.isValid?this.s<=e&&this.e>e:!1}set({start:e,end:r}={}){return this.isValid?Yt.fromDateTimes(e||this.s,r||this.e):this}splitAt(...e){if(!this.isValid)return[];const r=e.map(sy).filter(o=>this.contains(o)).sort((o,a)=>o.toMillis()-a.toMillis()),i=[];let{s}=this,n=0;for(;s<this.e;){const o=r[n]||this.e,a=+o>+this.e?this.e:o;i.push(Yt.fromDateTimes(s,a)),s=a,n+=1}return i}splitBy(e){const r=Ye.fromDurationLike(e);if(!this.isValid||!r.isValid||r.as("milliseconds")===0)return[];let{s:i}=this,s=1,n;const o=[];for(;i<this.e;){const a=this.start.plus(r.mapUnits(l=>l*s));n=+a>+this.e?this.e:a,o.push(Yt.fromDateTimes(i,n)),i=n,s+=1}return o}divideEqually(e){return this.isValid?this.splitBy(this.length()/e).slice(0,e):[]}overlaps(e){return this.e>e.s&&this.s<e.e}abutsStart(e){return this.isValid?+this.e==+e.s:!1}abutsEnd(e){return this.isValid?+e.e==+this.s:!1}engulfs(e){return this.isValid?this.s<=e.s&&this.e>=e.e:!1}equals(e){return!this.isValid||!e.isValid?!1:this.s.equals(e.s)&&this.e.equals(e.e)}intersection(e){if(!this.isValid)return this;const r=this.s>e.s?this.s:e.s,i=this.e<e.e?this.e:e.e;return r>=i?null:Yt.fromDateTimes(r,i)}union(e){if(!this.isValid)return this;const r=this.s<e.s?this.s:e.s,i=this.e>e.e?this.e:e.e;return Yt.fromDateTimes(r,i)}static merge(e){const[r,i]=e.sort((s,n)=>s.s-n.s).reduce(([s,n],o)=>n?n.overlaps(o)||n.abutsStart(o)?[s,n.union(o)]:[s.concat([n]),o]:[s,o],[[],null]);return i&&r.push(i),r}static xor(e){let r=null,i=0;const s=[],n=e.map(l=>[{time:l.s,type:"s"},{time:l.e,type:"e"}]),o=Array.prototype.concat(...n),a=o.sort((l,u)=>l.time-u.time);for(const l of a)i+=l.type==="s"?1:-1,i===1?r=l.time:(r&&+r!=+l.time&&s.push(Yt.fromDateTimes(r,l.time)),r=null);return Yt.merge(s)}difference(...e){return Yt.xor([this].concat(e)).map(r=>this.intersection(r)).filter(r=>r&&!r.isEmpty())}toString(){return this.isValid?`[${this.s.toISO()}  ${this.e.toISO()})`:Vd}[Symbol.for("nodejs.util.inspect.custom")](){return this.isValid?`Interval { start: ${this.s.toISO()}, end: ${this.e.toISO()} }`:`Interval { Invalid, reason: ${this.invalidReason} }`}toLocaleString(e=gw,r={}){return this.isValid?bi.create(this.s.loc.clone(r),e).formatInterval(this):Vd}toISO(e){return this.isValid?`${this.s.toISO(e)}/${this.e.toISO(e)}`:Vd}toISODate(){return this.isValid?`${this.s.toISODate()}/${this.e.toISODate()}`:Vd}toISOTime(e){return this.isValid?`${this.s.toISOTime(e)}/${this.e.toISOTime(e)}`:Vd}toFormat(e,{separator:r="  "}={}){return this.isValid?`${this.s.toFormat(e)}${r}${this.e.toFormat(e)}`:Vd}toDuration(e,r){return this.isValid?this.e.diff(this.s,e,r):Ye.invalid(this.invalidReason)}mapEndpoints(e){return Yt.fromDateTimes(e(this.s),e(this.e))}}class a_{static hasDST(e=Qt.defaultZone){const r=ue.now().setZone(e).set({month:12});return!e.isUniversal&&r.offset!==r.set({month:6}).offset}static isValidIANAZone(e){return ps.isValidZone(e)}static normalizeZone(e){return Fu(e,Qt.defaultZone)}static getStartOfWeek({locale:e=null,locObj:r=null}={}){return(r||ct.create(e)).getStartOfWeek()}static getMinimumDaysInFirstWeek({locale:e=null,locObj:r=null}={}){return(r||ct.create(e)).getMinDaysInFirstWeek()}static getWeekendWeekdays({locale:e=null,locObj:r=null}={}){return(r||ct.create(e)).getWeekendDays().slice()}static months(e="long",{locale:r=null,numberingSystem:i=null,locObj:s=null,outputCalendar:n="gregory"}={}){return(s||ct.create(r,i,n)).months(e)}static monthsFormat(e="long",{locale:r=null,numberingSystem:i=null,locObj:s=null,outputCalendar:n="gregory"}={}){return(s||ct.create(r,i,n)).months(e,!0)}static weekdays(e="long",{locale:r=null,numberingSystem:i=null,locObj:s=null}={}){return(s||ct.create(r,i,null)).weekdays(e)}static weekdaysFormat(e="long",{locale:r=null,numberingSystem:i=null,locObj:s=null}={}){return(s||ct.create(r,i,null)).weekdays(e,!0)}static meridiems({locale:e=null}={}){return ct.create(e).meridiems()}static eras(e="short",{locale:r=null}={}){return ct.create(r,null,"gregory").eras(e)}static features(){return{relative:Jj(),localeWeek:Yj()}}}function xk(t,e){const r=s=>s.toUTC(0,{keepLocalTime:!0}).startOf("day").valueOf(),i=r(e)-r(t);return Math.floor(Ye.fromMillis(i).as("days"))}function nie(t,e,r){const i=[["years",(l,u)=>u.year-l.year],["quarters",(l,u)=>u.quarter-l.quarter+(u.year-l.year)*4],["months",(l,u)=>u.month-l.month+(u.year-l.year)*12],["weeks",(l,u)=>{const h=xk(l,u);return(h-h%7)/7}],["days",xk]],s={},n=t;let o,a;for(const[l,u]of i)r.indexOf(l)>=0&&(o=l,s[l]=u(t,e),a=n.plus(s),a>e?(s[l]--,t=n.plus(s),t>e&&(a=t,s[l]--,t=n.plus(s))):t=a);return[t,s,a,o]}function oie(t,e,r,i){let[s,n,o,a]=nie(t,e,r);const l=e-s,u=r.filter(p=>["hours","minutes","seconds","milliseconds"].indexOf(p)>=0);u.length===0&&(o<e&&(o=s.plus({[a]:1})),o!==s&&(n[a]=(n[a]||0)+l/(o-s)));const h=Ye.fromObject(n,i);return u.length>0?Ye.fromMillis(l,i).shiftTo(...u).plus(h):h}const aie="missing Intl.DateTimeFormat.formatToParts support";function st(t,e=r=>r){return{regex:t,deser:([r])=>e(Yte(r))}}const lie="",f8=`[ ${lie}]`,m8=new RegExp(f8,"g");function uie(t){return t.replace(/\./g,"\\.?").replace(m8,f8)}function $k(t){return t.replace(/\./g,"").replace(m8," ").toLowerCase()}function En(t,e){return t===null?null:{regex:RegExp(t.map(uie).join("|")),deser:([r])=>t.findIndex(i=>$k(r)===$k(i))+e}}function Mk(t,e){return{regex:t,deser:([,r,i])=>s2(r,i),groups:e}}function l_(t){return{regex:t,deser:([e])=>e}}function cie(t){return t.replace(/[\-\[\]{}()*+?.,\\\^$|#\s]/g,"\\$&")}function hie(t,e){const r=Tn(e),i=Tn(e,"{2}"),s=Tn(e,"{3}"),n=Tn(e,"{4}"),o=Tn(e,"{6}"),a=Tn(e,"{1,2}"),l=Tn(e,"{1,3}"),u=Tn(e,"{1,6}"),h=Tn(e,"{1,9}"),p=Tn(e,"{2,4}"),m=Tn(e,"{4,6}"),y=_=>({regex:RegExp(cie(_.val)),deser:([b])=>b,literal:!0}),v=(_=>{if(t.literal)return y(_);switch(_.val){case"G":return En(e.eras("short"),0);case"GG":return En(e.eras("long"),0);case"y":return st(u);case"yy":return st(p,lT);case"yyyy":return st(n);case"yyyyy":return st(m);case"yyyyyy":return st(o);case"M":return st(a);case"MM":return st(i);case"MMM":return En(e.months("short",!0),1);case"MMMM":return En(e.months("long",!0),1);case"L":return st(a);case"LL":return st(i);case"LLL":return En(e.months("short",!1),1);case"LLLL":return En(e.months("long",!1),1);case"d":return st(a);case"dd":return st(i);case"o":return st(l);case"ooo":return st(s);case"HH":return st(i);case"H":return st(a);case"hh":return st(i);case"h":return st(a);case"mm":return st(i);case"m":return st(a);case"q":return st(a);case"qq":return st(i);case"s":return st(a);case"ss":return st(i);case"S":return st(l);case"SSS":return st(s);case"u":return l_(h);case"uu":return l_(a);case"uuu":return st(r);case"a":return En(e.meridiems(),0);case"kkkk":return st(n);case"kk":return st(p,lT);case"W":return st(a);case"WW":return st(i);case"E":case"c":return st(r);case"EEE":return En(e.weekdays("short",!1),1);case"EEEE":return En(e.weekdays("long",!1),1);case"ccc":return En(e.weekdays("short",!0),1);case"cccc":return En(e.weekdays("long",!0),1);case"Z":case"ZZ":return Mk(new RegExp(`([+-]${a.source})(?::(${i.source}))?`),2);case"ZZZ":return Mk(new RegExp(`([+-]${a.source})(${i.source})?`),2);case"z":return l_(/[a-z_+-/]{1,256}?/i);case" ":return l_(/[^\S\n\r]/);default:return y(_)}})(t)||{invalidReason:aie};return v.token=t,v}const die={year:{"2-digit":"yy",numeric:"yyyyy"},month:{numeric:"M","2-digit":"MM",short:"MMM",long:"MMMM"},day:{numeric:"d","2-digit":"dd"},weekday:{short:"EEE",long:"EEEE"},dayperiod:"a",dayPeriod:"a",hour12:{numeric:"h","2-digit":"hh"},hour24:{numeric:"H","2-digit":"HH"},minute:{numeric:"m","2-digit":"mm"},second:{numeric:"s","2-digit":"ss"},timeZoneName:{long:"ZZZZZ",short:"ZZZ"}};function pie(t,e,r){const{type:i,value:s}=t;if(i==="literal"){const l=/^\s+$/.test(s);return{literal:!l,val:l?" ":s}}const n=e[i];let o=i;i==="hour"&&(e.hour12!=null?o=e.hour12?"hour12":"hour24":e.hourCycle!=null?e.hourCycle==="h11"||e.hourCycle==="h12"?o="hour12":o="hour24":o=r.hour12?"hour12":"hour24");let a=die[o];if(typeof a=="object"&&(a=a[n]),a)return{literal:!1,val:a}}function fie(t){return[`^${t.map(r=>r.regex).reduce((r,i)=>`${r}(${i.source})`,"")}$`,t]}function mie(t,e,r){const i=t.match(e);if(i){const s={};let n=1;for(const o in r)if(hm(r,o)){const a=r[o],l=a.groups?a.groups+1:1;!a.literal&&a.token&&(s[a.token.val[0]]=a.deser(i.slice(n,n+l))),n+=l}return[i,s]}else return[i,{}]}function yie(t){const e=n=>{switch(n){case"S":return"millisecond";case"s":return"second";case"m":return"minute";case"h":case"H":return"hour";case"d":return"day";case"o":return"ordinal";case"L":case"M":return"month";case"y":return"year";case"E":case"c":return"weekday";case"W":return"weekNumber";case"k":return"weekYear";case"q":return"quarter";default:return null}};let r=null,i;return Ae(t.z)||(r=ps.create(t.z)),Ae(t.Z)||(r||(r=new _r(t.Z)),i=t.Z),Ae(t.q)||(t.M=(t.q-1)*3+1),Ae(t.h)||(t.h<12&&t.a===1?t.h+=12:t.h===12&&t.a===0&&(t.h=0)),t.G===0&&t.y&&(t.y=-t.y),Ae(t.u)||(t.S=A3(t.u)),[Object.keys(t).reduce((n,o)=>{const a=e(o);return a&&(n[a]=t[o]),n},{}),r,i]}let Cx=null;function gie(){return Cx||(Cx=ue.fromMillis(1555555555555)),Cx}function vie(t,e){if(t.literal)return t;const r=bi.macroTokenToFormatOpts(t.val),i=_8(r,e);return i==null||i.includes(void 0)?t:i}function y8(t,e){return Array.prototype.concat(...t.map(r=>vie(r,e)))}class g8{constructor(e,r){if(this.locale=e,this.format=r,this.tokens=y8(bi.parseFormat(r),e),this.units=this.tokens.map(i=>hie(i,e)),this.disqualifyingUnit=this.units.find(i=>i.invalidReason),!this.disqualifyingUnit){const[i,s]=fie(this.units);this.regex=RegExp(i,"i"),this.handlers=s}}explainFromTokens(e){if(this.isValid){const[r,i]=mie(e,this.regex,this.handlers),[s,n,o]=i?yie(i):[null,null,void 0];if(hm(i,"a")&&hm(i,"H"))throw new qp("Can't include meridiem when specifying 24-hour format");return{input:e,tokens:this.tokens,regex:this.regex,rawMatches:r,matches:i,result:s,zone:n,specificOffset:o}}else return{input:e,tokens:this.tokens,invalidReason:this.invalidReason}}get isValid(){return!this.disqualifyingUnit}get invalidReason(){return this.disqualifyingUnit?this.disqualifyingUnit.invalidReason:null}}function v8(t,e,r){return new g8(t,r).explainFromTokens(e)}function _ie(t,e,r){const{result:i,zone:s,specificOffset:n,invalidReason:o}=v8(t,e,r);return[i,s,n,o]}function _8(t,e){if(!t)return null;const i=bi.create(e,t).dtFormatter(gie()),s=i.formatToParts(),n=i.resolvedOptions();return s.map(o=>pie(o,t,n))}const Px="Invalid DateTime",Tk=864e13;function By(t){return new eo("unsupported zone",`the zone "${t.name}" is not supported`)}function Ax(t){return t.weekData===null&&(t.weekData=vw(t.c)),t.weekData}function Lx(t){return t.localWeekData===null&&(t.localWeekData=vw(t.c,t.loc.getMinDaysInFirstWeek(),t.loc.getStartOfWeek())),t.localWeekData}function Tc(t,e){const r={ts:t.ts,zone:t.zone,c:t.c,o:t.o,loc:t.loc,invalid:t.invalid};return new ue({...r,...e,old:r})}function b8(t,e,r){let i=t-e*60*1e3;const s=r.offset(i);if(e===s)return[i,e];i-=(s-e)*60*1e3;const n=r.offset(i);return s===n?[i,s]:[t-Math.min(s,n)*60*1e3,Math.max(s,n)]}function u_(t,e){t+=e*60*1e3;const r=new Date(t);return{year:r.getUTCFullYear(),month:r.getUTCMonth()+1,day:r.getUTCDate(),hour:r.getUTCHours(),minute:r.getUTCMinutes(),second:r.getUTCSeconds(),millisecond:r.getUTCMilliseconds()}}function E1(t,e,r){return b8(i2(t),e,r)}function Ek(t,e){const r=t.o,i=t.c.year+Math.trunc(e.years),s=t.c.month+Math.trunc(e.months)+Math.trunc(e.quarters)*3,n={...t.c,year:i,month:s,day:Math.min(t.c.day,_w(i,s))+Math.trunc(e.days)+Math.trunc(e.weeks)*7},o=Ye.fromObject({years:e.years-Math.trunc(e.years),quarters:e.quarters-Math.trunc(e.quarters),months:e.months-Math.trunc(e.months),weeks:e.weeks-Math.trunc(e.weeks),days:e.days-Math.trunc(e.days),hours:e.hours,minutes:e.minutes,seconds:e.seconds,milliseconds:e.milliseconds}).as("milliseconds"),a=i2(n);let[l,u]=b8(a,r,t.zone);return o!==0&&(l+=o,u=t.zone.offset(l)),{ts:l,o:u}}function jd(t,e,r,i,s,n){const{setZone:o,zone:a}=r;if(t&&Object.keys(t).length!==0||e){const l=e||a,u=ue.fromObject(t,{...r,zone:l,specificOffset:n});return o?u:u.setZone(a)}else return ue.invalid(new eo("unparsable",`the input "${s}" can't be parsed as ${i}`))}function c_(t,e,r=!0){return t.isValid?bi.create(ct.create("en-US"),{allowZ:r,forceSimple:!0}).formatDateTimeFromString(t,e):null}function Rx(t,e){const r=t.c.year>9999||t.c.year<0;let i="";return r&&t.c.year>=0&&(i+="+"),i+=vr(t.c.year,r?6:4),e?(i+="-",i+=vr(t.c.month),i+="-",i+=vr(t.c.day)):(i+=vr(t.c.month),i+=vr(t.c.day)),i}function Ik(t,e,r,i,s,n){let o=vr(t.c.hour);return e?(o+=":",o+=vr(t.c.minute),(t.c.millisecond!==0||t.c.second!==0||!r)&&(o+=":")):o+=vr(t.c.minute),(t.c.millisecond!==0||t.c.second!==0||!r)&&(o+=vr(t.c.second),(t.c.millisecond!==0||!i)&&(o+=".",o+=vr(t.c.millisecond,3))),s&&(t.isOffsetFixed&&t.offset===0&&!n?o+="Z":t.o<0?(o+="-",o+=vr(Math.trunc(-t.o/60)),o+=":",o+=vr(Math.trunc(-t.o%60))):(o+="+",o+=vr(Math.trunc(t.o/60)),o+=":",o+=vr(Math.trunc(t.o%60)))),n&&(o+="["+t.zone.ianaName+"]"),o}const w8={month:1,day:1,hour:0,minute:0,second:0,millisecond:0},bie={weekNumber:1,weekday:1,hour:0,minute:0,second:0,millisecond:0},wie={ordinal:1,hour:0,minute:0,second:0,millisecond:0},S8=["year","month","day","hour","minute","second","millisecond"],Sie=["weekYear","weekNumber","weekday","hour","minute","second","millisecond"],xie=["year","ordinal","hour","minute","second","millisecond"];function $ie(t){const e={year:"year",years:"year",month:"month",months:"month",day:"day",days:"day",hour:"hour",hours:"hour",minute:"minute",minutes:"minute",quarter:"quarter",quarters:"quarter",second:"second",seconds:"second",millisecond:"millisecond",milliseconds:"millisecond",weekday:"weekday",weekdays:"weekday",weeknumber:"weekNumber",weeksnumber:"weekNumber",weeknumbers:"weekNumber",weekyear:"weekYear",weekyears:"weekYear",ordinal:"ordinal"}[t.toLowerCase()];if(!e)throw new wj(t);return e}function Ck(t){switch(t.toLowerCase()){case"localweekday":case"localweekdays":return"localWeekday";case"localweeknumber":case"localweeknumbers":return"localWeekNumber";case"localweekyear":case"localweekyears":return"localWeekYear";default:return $ie(t)}}function Mie(t){if(qy===void 0&&(qy=Qt.now()),t.type!=="iana")return t.offset(qy);const e=t.name;let r=uT.get(e);return r===void 0&&(r=t.offset(qy),uT.set(e,r)),r}function Pk(t,e){const r=Fu(e.zone,Qt.defaultZone);if(!r.isValid)return ue.invalid(By(r));const i=ct.fromObject(e);let s,n;if(Ae(t.year))s=Qt.now();else{for(const l of S8)Ae(t[l])&&(t[l]=w8[l]);const o=Wj(t)||Zj(t);if(o)return ue.invalid(o);const a=Mie(r);[s,n]=E1(t,a,r)}return new ue({ts:s,zone:r,loc:i,o:n})}function Ak(t,e,r){const i=Ae(r.round)?!0:r.round,s=(o,a)=>(o=L3(o,i||r.calendary?0:2,!0),e.loc.clone(r).relFormatter(r).format(o,a)),n=o=>r.calendary?e.hasSame(t,o)?0:e.startOf(o).diff(t.startOf(o),o).get(o):e.diff(t,o).get(o);if(r.unit)return s(n(r.unit),r.unit);for(const o of r.units){const a=n(o);if(Math.abs(a)>=1)return s(a,o)}return s(t>e?-0:0,r.units[r.units.length-1])}function Lk(t){let e={},r;return t.length>0&&typeof t[t.length-1]=="object"?(e=t[t.length-1],r=Array.from(t).slice(0,t.length-1)):r=Array.from(t),[e,r]}let qy;const uT=new Map;class ue{constructor(e){const r=e.zone||Qt.defaultZone;let i=e.invalid||(Number.isNaN(e.ts)?new eo("invalid input"):null)||(r.isValid?null:By(r));this.ts=Ae(e.ts)?Qt.now():e.ts;let s=null,n=null;if(!i)if(e.old&&e.old.ts===this.ts&&e.old.zone.equals(r))[s,n]=[e.old.c,e.old.o];else{const a=Ku(e.o)&&!e.old?e.o:r.offset(this.ts);s=u_(this.ts,a),i=Number.isNaN(s.year)?new eo("invalid input"):null,s=i?null:s,n=i?null:a}this._zone=r,this.loc=e.loc||ct.create(),this.invalid=i,this.weekData=null,this.localWeekData=null,this.c=s,this.o=n,this.isLuxonDateTime=!0}static now(){return new ue({})}static local(){const[e,r]=Lk(arguments),[i,s,n,o,a,l,u]=r;return Pk({year:i,month:s,day:n,hour:o,minute:a,second:l,millisecond:u},e)}static utc(){const[e,r]=Lk(arguments),[i,s,n,o,a,l,u]=r;return e.zone=_r.utcInstance,Pk({year:i,month:s,day:n,hour:o,minute:a,second:l,millisecond:u},e)}static fromJSDate(e,r={}){const i=tre(e)?e.valueOf():NaN;if(Number.isNaN(i))return ue.invalid("invalid input");const s=Fu(r.zone,Qt.defaultZone);return s.isValid?new ue({ts:i,zone:s,loc:ct.fromObject(r)}):ue.invalid(By(s))}static fromMillis(e,r={}){if(Ku(e))return e<-Tk||e>Tk?ue.invalid("Timestamp out of range"):new ue({ts:e,zone:Fu(r.zone,Qt.defaultZone),loc:ct.fromObject(r)});throw new fi(`fromMillis requires a numerical input, but received a ${typeof e} with value ${e}`)}static fromSeconds(e,r={}){if(Ku(e))return new ue({ts:e*1e3,zone:Fu(r.zone,Qt.defaultZone),loc:ct.fromObject(r)});throw new fi("fromSeconds requires a numerical input")}static fromObject(e,r={}){e=e||{};const i=Fu(r.zone,Qt.defaultZone);if(!i.isValid)return ue.invalid(By(i));const s=ct.fromObject(r),n=bw(e,Ck),{minDaysInFirstWeek:o,startOfWeek:a}=yk(n,s),l=Qt.now(),u=Ae(r.specificOffset)?i.offset(l):r.specificOffset,h=!Ae(n.ordinal),p=!Ae(n.year),m=!Ae(n.month)||!Ae(n.day),y=p||m,g=n.weekYear||n.weekNumber;if((y||h)&&g)throw new qp("Can't mix weekYear/weekNumber units with year/month/day or ordinals");if(m&&h)throw new qp("Can't mix ordinal dates with month/day");const v=g||n.weekday&&!y;let _,b,S=u_(l,u);v?(_=Sie,b=bie,S=vw(S,o,a)):h?(_=xie,b=wie,S=Ix(S)):(_=S8,b=w8);let $=!1;for(const U of _){const Z=n[U];Ae(Z)?$?n[U]=b[U]:n[U]=S[U]:$=!0}const T=v?Kte(n,o,a):h?Qte(n):Wj(n),I=T||Zj(n);if(I)return ue.invalid(I);const P=v?fk(n,o,a):h?mk(n):n,[R,D]=E1(P,u,i),V=new ue({ts:R,zone:i,o:D,loc:s});return n.weekday&&y&&e.weekday!==V.weekday?ue.invalid("mismatched weekday",`you can't specify both a weekday of ${n.weekday} and a date of ${V.toISO()}`):V.isValid?V:ue.invalid(V.invalid)}static fromISO(e,r={}){const[i,s]=Bre(e);return jd(i,s,r,"ISO 8601",e)}static fromRFC2822(e,r={}){const[i,s]=qre(e);return jd(i,s,r,"RFC 2822",e)}static fromHTTP(e,r={}){const[i,s]=Hre(e);return jd(i,s,r,"HTTP",r)}static fromFormat(e,r,i={}){if(Ae(e)||Ae(r))throw new fi("fromFormat requires an input string and a format");const{locale:s=null,numberingSystem:n=null}=i,o=ct.fromOpts({locale:s,numberingSystem:n,defaultToEN:!0}),[a,l,u,h]=_ie(o,e,r);return h?ue.invalid(h):jd(a,l,i,`format ${r}`,e,u)}static fromString(e,r,i={}){return ue.fromFormat(e,r,i)}static fromSQL(e,r={}){const[i,s]=Qre(e);return jd(i,s,r,"SQL",e)}static invalid(e,r=null){if(!e)throw new fi("need to specify a reason the DateTime is invalid");const i=e instanceof eo?e:new eo(e,r);if(Qt.throwOnInvalid)throw new Tte(i);return new ue({invalid:i})}static isDateTime(e){return e&&e.isLuxonDateTime||!1}static parseFormatForOpts(e,r={}){const i=_8(e,ct.fromObject(r));return i?i.map(s=>s?s.val:null).join(""):null}static expandFormat(e,r={}){return y8(bi.parseFormat(e),ct.fromObject(r)).map(s=>s.val).join("")}static resetCache(){qy=void 0,uT.clear()}get(e){return this[e]}get isValid(){return this.invalid===null}get invalidReason(){return this.invalid?this.invalid.reason:null}get invalidExplanation(){return this.invalid?this.invalid.explanation:null}get locale(){return this.isValid?this.loc.locale:null}get numberingSystem(){return this.isValid?this.loc.numberingSystem:null}get outputCalendar(){return this.isValid?this.loc.outputCalendar:null}get zone(){return this._zone}get zoneName(){return this.isValid?this.zone.name:null}get year(){return this.isValid?this.c.year:NaN}get quarter(){return this.isValid?Math.ceil(this.c.month/3):NaN}get month(){return this.isValid?this.c.month:NaN}get day(){return this.isValid?this.c.day:NaN}get hour(){return this.isValid?this.c.hour:NaN}get minute(){return this.isValid?this.c.minute:NaN}get second(){return this.isValid?this.c.second:NaN}get millisecond(){return this.isValid?this.c.millisecond:NaN}get weekYear(){return this.isValid?Ax(this).weekYear:NaN}get weekNumber(){return this.isValid?Ax(this).weekNumber:NaN}get weekday(){return this.isValid?Ax(this).weekday:NaN}get isWeekend(){return this.isValid&&this.loc.getWeekendDays().includes(this.weekday)}get localWeekday(){return this.isValid?Lx(this).weekday:NaN}get localWeekNumber(){return this.isValid?Lx(this).weekNumber:NaN}get localWeekYear(){return this.isValid?Lx(this).weekYear:NaN}get ordinal(){return this.isValid?Ix(this.c).ordinal:NaN}get monthShort(){return this.isValid?a_.months("short",{locObj:this.loc})[this.month-1]:null}get monthLong(){return this.isValid?a_.months("long",{locObj:this.loc})[this.month-1]:null}get weekdayShort(){return this.isValid?a_.weekdays("short",{locObj:this.loc})[this.weekday-1]:null}get weekdayLong(){return this.isValid?a_.weekdays("long",{locObj:this.loc})[this.weekday-1]:null}get offset(){return this.isValid?+this.o:NaN}get offsetNameShort(){return this.isValid?this.zone.offsetName(this.ts,{format:"short",locale:this.locale}):null}get offsetNameLong(){return this.isValid?this.zone.offsetName(this.ts,{format:"long",locale:this.locale}):null}get isOffsetFixed(){return this.isValid?this.zone.isUniversal:null}get isInDST(){return this.isOffsetFixed?!1:this.offset>this.set({month:1,day:1}).offset||this.offset>this.set({month:5}).offset}getPossibleOffsets(){if(!this.isValid||this.isOffsetFixed)return[this];const e=864e5,r=6e4,i=i2(this.c),s=this.zone.offset(i-e),n=this.zone.offset(i+e),o=this.zone.offset(i-s*r),a=this.zone.offset(i-n*r);if(o===a)return[this];const l=i-o*r,u=i-a*r,h=u_(l,o),p=u_(u,a);return h.hour===p.hour&&h.minute===p.minute&&h.second===p.second&&h.millisecond===p.millisecond?[Tc(this,{ts:l}),Tc(this,{ts:u})]:[this]}get isInLeapYear(){return $v(this.year)}get daysInMonth(){return _w(this.year,this.month)}get daysInYear(){return this.isValid?mf(this.year):NaN}get weeksInWeekYear(){return this.isValid?R0(this.weekYear):NaN}get weeksInLocalWeekYear(){return this.isValid?R0(this.localWeekYear,this.loc.getMinDaysInFirstWeek(),this.loc.getStartOfWeek()):NaN}resolvedLocaleOptions(e={}){const{locale:r,numberingSystem:i,calendar:s}=bi.create(this.loc.clone(e),e).resolvedOptions(this);return{locale:r,numberingSystem:i,outputCalendar:s}}toUTC(e=0,r={}){return this.setZone(_r.instance(e),r)}toLocal(){return this.setZone(Qt.defaultZone)}setZone(e,{keepLocalTime:r=!1,keepCalendarTime:i=!1}={}){if(e=Fu(e,Qt.defaultZone),e.equals(this.zone))return this;if(e.isValid){let s=this.ts;if(r||i){const n=e.offset(this.ts),o=this.toObject();[s]=E1(o,n,e)}return Tc(this,{ts:s,zone:e})}else return ue.invalid(By(e))}reconfigure({locale:e,numberingSystem:r,outputCalendar:i}={}){const s=this.loc.clone({locale:e,numberingSystem:r,outputCalendar:i});return Tc(this,{loc:s})}setLocale(e){return this.reconfigure({locale:e})}set(e){if(!this.isValid)return this;const r=bw(e,Ck),{minDaysInFirstWeek:i,startOfWeek:s}=yk(r,this.loc),n=!Ae(r.weekYear)||!Ae(r.weekNumber)||!Ae(r.weekday),o=!Ae(r.ordinal),a=!Ae(r.year),l=!Ae(r.month)||!Ae(r.day),u=a||l,h=r.weekYear||r.weekNumber;if((u||o)&&h)throw new qp("Can't mix weekYear/weekNumber units with year/month/day or ordinals");if(l&&o)throw new qp("Can't mix ordinal dates with month/day");let p;n?p=fk({...vw(this.c,i,s),...r},i,s):Ae(r.ordinal)?(p={...this.toObject(),...r},Ae(r.day)&&(p.day=Math.min(_w(p.year,p.month),p.day))):p=mk({...Ix(this.c),...r});const[m,y]=E1(p,this.o,this.zone);return Tc(this,{ts:m,o:y})}plus(e){if(!this.isValid)return this;const r=Ye.fromDurationLike(e);return Tc(this,Ek(this,r))}minus(e){if(!this.isValid)return this;const r=Ye.fromDurationLike(e).negate();return Tc(this,Ek(this,r))}startOf(e,{useLocaleWeeks:r=!1}={}){if(!this.isValid)return this;const i={},s=Ye.normalizeUnit(e);switch(s){case"years":i.month=1;case"quarters":case"months":i.day=1;case"weeks":case"days":i.hour=0;case"hours":i.minute=0;case"minutes":i.second=0;case"seconds":i.millisecond=0;break}if(s==="weeks")if(r){const n=this.loc.getStartOfWeek(),{weekday:o}=this;o<n&&(i.weekNumber=this.weekNumber-1),i.weekday=n}else i.weekday=1;if(s==="quarters"){const n=Math.ceil(this.month/3);i.month=(n-1)*3+1}return this.set(i)}endOf(e,r){return this.isValid?this.plus({[e]:1}).startOf(e,r).minus(1):this}toFormat(e,r={}){return this.isValid?bi.create(this.loc.redefaultToEN(r)).formatDateTimeFromString(this,e):Px}toLocaleString(e=gw,r={}){return this.isValid?bi.create(this.loc.clone(r),e).formatDateTime(this):Px}toLocaleParts(e={}){return this.isValid?bi.create(this.loc.clone(e),e).formatDateTimeParts(this):[]}toISO({format:e="extended",suppressSeconds:r=!1,suppressMilliseconds:i=!1,includeOffset:s=!0,extendedZone:n=!1}={}){if(!this.isValid)return null;const o=e==="extended";let a=Rx(this,o);return a+="T",a+=Ik(this,o,r,i,s,n),a}toISODate({format:e="extended"}={}){return this.isValid?Rx(this,e==="extended"):null}toISOWeekDate(){return c_(this,"kkkk-'W'WW-c")}toISOTime({suppressMilliseconds:e=!1,suppressSeconds:r=!1,includeOffset:i=!0,includePrefix:s=!1,extendedZone:n=!1,format:o="extended"}={}){return this.isValid?(s?"T":"")+Ik(this,o==="extended",r,e,i,n):null}toRFC2822(){return c_(this,"EEE, dd LLL yyyy HH:mm:ss ZZZ",!1)}toHTTP(){return c_(this.toUTC(),"EEE, dd LLL yyyy HH:mm:ss 'GMT'")}toSQLDate(){return this.isValid?Rx(this,!0):null}toSQLTime({includeOffset:e=!0,includeZone:r=!1,includeOffsetSpace:i=!0}={}){let s="HH:mm:ss.SSS";return(r||e)&&(i&&(s+=" "),r?s+="z":e&&(s+="ZZ")),c_(this,s,!0)}toSQL(e={}){return this.isValid?`${this.toSQLDate()} ${this.toSQLTime(e)}`:null}toString(){return this.isValid?this.toISO():Px}[Symbol.for("nodejs.util.inspect.custom")](){return this.isValid?`DateTime { ts: ${this.toISO()}, zone: ${this.zone.name}, locale: ${this.locale} }`:`DateTime { Invalid, reason: ${this.invalidReason} }`}valueOf(){return this.toMillis()}toMillis(){return this.isValid?this.ts:NaN}toSeconds(){return this.isValid?this.ts/1e3:NaN}toUnixInteger(){return this.isValid?Math.floor(this.ts/1e3):NaN}toJSON(){return this.toISO()}toBSON(){return this.toJSDate()}toObject(e={}){if(!this.isValid)return{};const r={...this.c};return e.includeConfig&&(r.outputCalendar=this.outputCalendar,r.numberingSystem=this.loc.numberingSystem,r.locale=this.loc.locale),r}toJSDate(){return new Date(this.isValid?this.ts:NaN)}diff(e,r="milliseconds",i={}){if(!this.isValid||!e.isValid)return Ye.invalid("created by diffing an invalid DateTime");const s={locale:this.locale,numberingSystem:this.numberingSystem,...i},n=rre(r).map(Ye.normalizeUnit),o=e.valueOf()>this.valueOf(),a=o?this:e,l=o?e:this,u=oie(a,l,n,s);return o?u.negate():u}diffNow(e="milliseconds",r={}){return this.diff(ue.now(),e,r)}until(e){return this.isValid?Yt.fromDateTimes(this,e):this}hasSame(e,r,i){if(!this.isValid)return!1;const s=e.valueOf(),n=this.setZone(e.zone,{keepLocalTime:!0});return n.startOf(r,i)<=s&&s<=n.endOf(r,i)}equals(e){return this.isValid&&e.isValid&&this.valueOf()===e.valueOf()&&this.zone.equals(e.zone)&&this.loc.equals(e.loc)}toRelative(e={}){if(!this.isValid)return null;const r=e.base||ue.fromObject({},{zone:this.zone}),i=e.padding?this<r?-e.padding:e.padding:0;let s=["years","months","days","hours","minutes","seconds"],n=e.unit;return Array.isArray(e.unit)&&(s=e.unit,n=void 0),Ak(r,this.plus(i),{...e,numeric:"always",units:s,unit:n})}toRelativeCalendar(e={}){return this.isValid?Ak(e.base||ue.fromObject({},{zone:this.zone}),this,{...e,numeric:"auto",units:["years","months","days"],calendary:!0}):null}static min(...e){if(!e.every(ue.isDateTime))throw new fi("min requires all arguments be DateTimes");return gk(e,r=>r.valueOf(),Math.min)}static max(...e){if(!e.every(ue.isDateTime))throw new fi("max requires all arguments be DateTimes");return gk(e,r=>r.valueOf(),Math.max)}static fromFormatExplain(e,r,i={}){const{locale:s=null,numberingSystem:n=null}=i,o=ct.fromOpts({locale:s,numberingSystem:n,defaultToEN:!0});return v8(o,e,r)}static fromStringExplain(e,r,i={}){return ue.fromFormatExplain(e,r,i)}static buildFormatParser(e,r={}){const{locale:i=null,numberingSystem:s=null}=r,n=ct.fromOpts({locale:i,numberingSystem:s,defaultToEN:!0});return new g8(n,e)}static fromFormatParser(e,r,i={}){if(Ae(e)||Ae(r))throw new fi("fromFormatParser requires an input string and a format parser");const{locale:s=null,numberingSystem:n=null}=i,o=ct.fromOpts({locale:s,numberingSystem:n,defaultToEN:!0});if(!o.equals(r.locale))throw new fi(`fromFormatParser called with a locale of ${o}, but the format parser was created for ${r.locale}`);const{result:a,zone:l,specificOffset:u,invalidReason:h}=r.explainFromTokens(e);return h?ue.invalid(h):jd(a,l,i,`format ${r.format}`,e,u)}static get DATE_SHORT(){return gw}static get DATE_MED(){return Sj}static get DATE_MED_WITH_WEEKDAY(){return Cte}static get DATE_FULL(){return xj}static get DATE_HUGE(){return $j}static get TIME_SIMPLE(){return Mj}static get TIME_WITH_SECONDS(){return Tj}static get TIME_WITH_SHORT_OFFSET(){return Ej}static get TIME_WITH_LONG_OFFSET(){return Ij}static get TIME_24_SIMPLE(){return Cj}static get TIME_24_WITH_SECONDS(){return Pj}static get TIME_24_WITH_SHORT_OFFSET(){return Aj}static get TIME_24_WITH_LONG_OFFSET(){return Lj}static get DATETIME_SHORT(){return Rj}static get DATETIME_SHORT_WITH_SECONDS(){return kj}static get DATETIME_MED(){return Oj}static get DATETIME_MED_WITH_SECONDS(){return Nj}static get DATETIME_MED_WITH_WEEKDAY(){return Pte}static get DATETIME_FULL(){return Fj}static get DATETIME_FULL_WITH_SECONDS(){return Dj}static get DATETIME_HUGE(){return zj}static get DATETIME_HUGE_WITH_SECONDS(){return Vj}}function sy(t){if(ue.isDateTime(t))return t;if(t&&t.valueOf&&Ku(t.valueOf()))return ue.fromJSDate(t);if(t&&typeof t=="object")return ue.fromObject(t);throw new fi(`Unknown datetime argument: ${t}, of type ${typeof t}`)}const Tie="shortOffset";function Eie(t){return"timeZoneIANA"in t}function Iie(t){return t.startsWith("UTC")}function ww(t,e=!1){return{json:{read:{source:t,reader:(r,i)=>i[t]?I1(i[t]):null},write:!!e&&{allowNull:!0,writer(r,i){i[t]=r?Cie(r):null}}}}}function I1(t,e=uo){return t?Eie(t)?t.timeZoneIANA:Pie(t,e):e}function Cie(t){return{timeZoneIANA:t}}function Pie(t,e=uo){if(!t||!ik.has(t.timeZone))return e;const r=ik.get(t.timeZone);return Iie(t.timeZone)||t.respectsDaylightSaving?r:Aie(r)}function Aie(t){const e=ue.local().setZone(t),r=Math.min(e.set({month:1,day:1}).offset,e.set({month:5}).offset);return r===0?"Etc/UTC":`Etc/GMT${_r.instance(-r).formatOffset(0,"narrow")}`}function Lie(t,e,r,i,s){if(e&&s==="date")return{timeZone:$a,timeZoneName:void 0};const n=i.timeStyle||i.hour,o=r===lc;return{timeZone:o?s==="timestamp-offset"?void 0:t??$a:r,timeZoneName:o&&n?Tie:void 0}}function Rie(t){const e=new Set(["etc/utc","etc/gmt","gmt"]),r=new Set(Intl.supportedValuesOf("timeZone").map((i=>i.toLowerCase())));return t===uo||t===lc||e.has(t.toLowerCase())||r.has(t.toLowerCase())}const kie={year:void 0,month:void 0,day:void 0,weekday:void 0},Oie={hour:void 0,minute:void 0,second:void 0},x8={timeZone:$a},fo={year:"numeric",month:"numeric",day:"numeric"},ny={year:"numeric",month:"long",day:"numeric"},oy={year:"numeric",month:"short",day:"numeric"},ay={year:"numeric",month:"long",weekday:"long",day:"numeric"},Iu={hour:"numeric",minute:"numeric"},Uc={...Iu,second:"numeric"},$8={hourCycle:"h23"},ly={...Iu,...$8},uy={...Uc,...$8},M8={"short-date":fo,"short-date-short-time":{...fo,...Iu},"short-date-short-time-24":{...fo,...ly},"short-date-long-time":{...fo,...Uc},"short-date-long-time-24":{...fo,...uy},"short-date-le":fo,"short-date-le-short-time":{...fo,...Iu},"short-date-le-short-time-24":{...fo,...ly},"short-date-le-long-time":{...fo,...Uc},"short-date-le-long-time-24":{...fo,...uy},"long-month-day-year":ny,"long-month-day-year-short-time":{...ny,...Iu},"long-month-day-year-short-time-24":{...ny,...ly},"long-month-day-year-long-time":{...ny,...Uc},"long-month-day-year-long-time-24":{...ny,...uy},"day-short-month-year":oy,"day-short-month-year-short-time":{...oy,...Iu},"day-short-month-year-short-time-24":{...oy,...ly},"day-short-month-year-long-time":{...oy,...Uc},"day-short-month-year-long-time-24":{...oy,...uy},"long-date":ay,"long-date-short-time":{...ay,...Iu},"long-date-short-time-24":{...ay,...ly},"long-date-long-time":{...ay,...Uc},"long-date-long-time-24":{...ay,...uy},"long-month-year":{month:"long",year:"numeric"},"short-month-year":{month:"short",year:"numeric"},year:{year:"numeric"},"short-time":Iu,"long-time":Uc},Nie=Wr()({shortDate:"short-date",shortDateShortTime:"short-date-short-time",shortDateShortTime24:"short-date-short-time-24",shortDateLongTime:"short-date-long-time",shortDateLongTime24:"short-date-long-time-24",shortDateLE:"short-date-le",shortDateLEShortTime:"short-date-le-short-time",shortDateLEShortTime24:"short-date-le-short-time-24",shortDateLELongTime:"short-date-le-long-time",shortDateLELongTime24:"short-date-le-long-time-24",longMonthDayYear:"long-month-day-year",longMonthDayYearShortTime:"long-month-day-year-short-time",longMonthDayYearShortTime24:"long-month-day-year-short-time-24",longMonthDayYearLongTime:"long-month-day-year-long-time",longMonthDayYearLongTime24:"long-month-day-year-long-time-24",dayShortMonthYear:"day-short-month-year",dayShortMonthYearShortTime:"day-short-month-year-short-time",dayShortMonthYearShortTime24:"day-short-month-year-short-time-24",dayShortMonthYearLongTime:"day-short-month-year-long-time",dayShortMonthYearLongTime24:"day-short-month-year-long-time-24",longDate:"long-date",longDateShortTime:"long-date-short-time",longDateShortTime24:"long-date-short-time-24",longDateLongTime:"long-date-long-time",longDateLongTime24:"long-date-long-time-24",longMonthYear:"long-month-year",shortMonthYear:"short-month-year",year:"year"}),T8={ar:"ar-u-nu-latn-ca-gregory",nn:"no-NN"},Fie=new Intl.DateTimeFormat("bs",{month:"long"}).formatToParts(new Date(2025,2)),Die=Fie.find((({type:t})=>t==="month"))?.value.toLowerCase();function E8(){const t=hs(),e=$3(t)?.language;return(e&&T8[e])??t}Die!=="mart"&&(T8.bs="sr-Latn-CS");let cT=new WeakMap;const o2=M8["short-date-short-time"];function zie(t){let e=cT.get(t);if(!e){const r=E8(),i=N3(t.timeZone??uo),s={...t,timeZone:i};e=new Intl.DateTimeFormat(r,s),cT.set(t,e)}return e}function cy(t){return M8[t]}function to(t,e=o2){return zie(e).format(t)}function Vie(t,e=o2){return to(new Date(t),{...e,...x8,...Oie})}function jie(t,e=o2){return to(new Date(`1970-01-01T${t}Z`),{...e,...x8,...kie})}function Uie(t,e=o2){if(e.timeZone)return to(new Date(t),e);const r=ue.fromISO(t,{setZone:!0}),i=r.offset===0?$a:e.timeZone,s={...e,timeZone:i};return r.toLocaleString(s,{locale:E8()})}function N3(t){switch(t){case uo:return Mte;case lc:return $a;default:return t}}T3((()=>{cT=new WeakMap}));const Gie={ar:"ar-u-nu-latn",bs:"sr-Latn-CS",nn:"no-NN"};let C1=new WeakMap,I8={};function hT(t){const e=t||I8;if(!C1.has(e)){const r=hs(),i=$3(r)?.language,s=i&&Gie[i]||r;C1.set(e,new Intl.NumberFormat(s,t))}return C1.get(e)}function rke(t={}){const e={};return t.digitSeparator!=null&&(e.useGrouping=t.digitSeparator),t.places!=null&&(e.minimumFractionDigits=e.maximumFractionDigits=t.places),e}function uc(t,e){return Object.is(t,-0)&&(t=0),hT(e).format(t)}function ike(t,e=hs()){if(!t)return null;let r=Rk.get(e);if(!r){const i=hT().formatToParts(12345.6),s=[...hT({useGrouping:!1}).format(9876543210)].reverse(),n=new Map(s.map(((p,m)=>[p,m]))),o=new RegExp(`[${i.find((p=>p.type==="group"))?.value}]`,"g"),a=new RegExp(`[${i.find((p=>p.type==="decimal"))?.value}]`),l=new RegExp(`[${s.join("")}]`,"g"),u=/[\u200E\u200F\u202A\u202B\u202C\u202D\u202E\u2066\u2067\u2068\u2069\u061C]/g,h=/[-\u2212\u2013\u2014\u2015]/g;r=p=>{if((p=p.trim().replaceAll(o,"").replace(a,".").replace(l,(y=>String(n.get(y)))).replaceAll(u,"").replaceAll(h,"-"))==="")return null;const m=Number(p);return isNaN(m)?null:m},Rk.set(e,r)}return r(t)}T3((()=>{C1=new WeakMap,I8={}}));const Rk=new Map,C8=()=>q.getLogger("esri.intl.substitute");function Sw(t,e,r={}){const{format:i={}}=r;return gc(t,(s=>Bie(s,e,i)))}function Bie(t,e,r){let i,s;const n=t.indexOf(":");if(n===-1?i=t.trim():(i=t.slice(0,n).trim(),s=t.slice(n+1).trim()),!i)return"";const o=fv(i,e);if(o==null)return"";const a=(s?r?.[s]:null)??r?.[i];return a?qie(o,a):s?Hie(o,s):F3(o)}function qie(t,e){switch(e.type){case"date":return to(t,e.intlOptions);case"number":return uc(t,e.intlOptions);default:return C8().warn("missing format descriptor for key {key}"),F3(t)}}function Hie(t,e){switch(e.toLowerCase()){case"dateformat":return to(t);case"numberformat":return uc(t);default:return C8().warn(`inline format is unsupported since 4.12: ${e}`),/^(dateformat|datestring)/i.test(e)?to(t):/^numberformat/i.test(e)?uc(t):F3(t)}}function F3(t){switch(typeof t){case"string":return t;case"number":return uc(t);case"boolean":return""+t;default:return t instanceof Date?to(t):""}}async function Wie(t,e,r,i){const s=e.exec(r);if(!s)throw new F("esri-intl:invalid-bundle",`Bundle id "${r}" is not compatible with the pattern "${e}"`);const n=s[1]?`${s[1]}/`:"",o=s[2],a=_j(i),l=`${n}${o}.json`,u=a?`${n}${o}_${a}.json`:l;let h;try{h=await kk(t(u))}catch(p){if(u===l)throw new F("intl:unknown-bundle",`Bundle "${r}" cannot be loaded`,{error:p});try{h=await kk(t(l))}catch(m){throw new F("intl:unknown-bundle",`Bundle "${r}" cannot be loaded`,{error:m})}}return h}async function kk(t){if(Ok.fetchBundleAsset!=null)return Ok.fetchBundleAsset(t);const e=await et(t,{responseType:"text"});return JSON.parse(e.data)}let Zie=class{constructor({base:e="",pattern:r,location:i=new URL(window.location.href)}){let s;s=typeof i=="string"?n=>new URL(n,new URL(i,window.location.href)).href:i instanceof URL?n=>new URL(n,i).href:i,this.pattern=typeof r=="string"?new RegExp(`^${r}`):r,this.getAssetUrl=s,e=e?e.endsWith("/")?e:e+"/":"",this.matcher=new RegExp(`^${e}(?:(.*)\\/)?(.*)$`)}fetchMessageBundle(e,r){return Wie(this.getAssetUrl,this.matcher,e,r)}};function Jie(t){return new Zie(t)}const Ok={};wte(Jie({pattern:"esri/",location:Et}));let Ha=class extends ce{constructor(e){super(e),this.apiKey=null,this.id=null,this.language=null,this.places=null,this.serviceUrl="https://basemapstyles-api.arcgis.com/arcgis/rest/services/styles/v2",this.worldview=null}get languageParameter(){const e=this.language;let r=e==="local"||e==="global"?e:_j(e??hs())??"global";return r=r==="no"?"nb":r,r}};c([d()],Ha.prototype,"apiKey",void 0),c([d()],Ha.prototype,"id",void 0),c([d()],Ha.prototype,"language",void 0),c([d()],Ha.prototype,"places",void 0),c([d()],Ha.prototype,"serviceUrl",void 0),c([d()],Ha.prototype,"worldview",void 0),Ha=c([C("esri.support.BasemapStyle")],Ha);const Yie=Ha;function ie(t,e,r={}){return D3(t,e,r,P8)}function fs(t,e,r={}){return D3(t,e,r,A8)}function D3(t,e,r={},i){let s=null;const n=r.once?(o,a)=>{i(o)&&(Lt(s),e(o,a))}:(o,a)=>{i(o)&&e(o,a)};if(s=nQ(t,n,r.sync,r.equals),r.initial){const o=t();n(o,o)}return s}function so(t,e,r,i={}){let s=null,n=null,o=null;function a(){s&&n&&(n.remove(),i.onListenerRemove?.(s),s=null,n=null)}function l(h){i.once&&i.once&&Lt(o),r(h)}const u=ie(t,((h,p)=>{a(),jS(h)&&(s=h,n=Lm(h,e,l),i.onListenerAdd?.(h))}),{sync:i.sync,initial:!0});return o=He((()=>{u.remove(),a()})),o}function Ev(t,e){return Xie(t,A8,e)}function Xie(t,e,r){if(yn(r))return Promise.reject(St());const i=t();if(e?.(i))return Promise.resolve(i);let s=null;function n(){s=Lt(s)}return new Promise(((o,a)=>{s=$d([ao(r,(()=>{n(),a(St())})),D3(t,(l=>{n(),o(l)}),{sync:!1,once:!0},e??P8)])}))}function P8(t){return!0}function A8(t){return!!t}function oke(t,e,r={}){let i=!1;const s=ie(t,((n,o)=>{i||e(n,o)}),r);return{remove(){s.remove()},pause(){i=!0},resume(){i=!1}}}const Ma={sync:!0},Ft={initial:!0},Oi={sync:!0,initial:!0},h_=new WeakMap;function L8(t){return!t.destroyed&&(h_.has(t)||t.addHandles([ie((()=>{const e=t.parent;return!(!e||!("type"in e))&&(e.type==="catalog-dynamic-group"||L8(e))}),(e=>h_.set(t,e)),Oi),He((()=>h_.delete(t)))]),h_.get(t))}function Kie(t){return t!=null&&typeof t=="object"&&"type"in t&&t.type==="feature"}function ake(t){return t!=null&&typeof t=="object"&&"type"in t&&t.type==="graphics"}function Qie(t){return t!=null&&typeof t=="object"&&"type"in t&&t.type==="map-image"}function ese(t){return t!=null&&typeof t=="object"&&"type"in t&&t.type==="knowledge-graph"&&"layers"in t}function lke(t){return t!=null&&typeof t=="object"&&"type"in t&&t.type==="knowledge-graph-sublayer"}function Nk(t){return t!=null&&typeof t=="object"&&"type"in t&&t.type==="subtype-group"&&"sublayers"in t}function lp(t){return t?.type==="subtype-sublayer"}const uke={Point:"SceneLayer","3DObject":"SceneLayer",IntegratedMesh:"IntegratedMeshLayer",PointCloud:"PointCloudLayer",Building:"BuildingSceneLayer"};function dT(t){const e=t?.type;return e==="building-scene"||e==="integrated-mesh"||e==="point-cloud"||e==="scene"}function cke(t){return t==="integrated-mesh"||t==="integrated-mesh-3dtiles"}function a2(t){return t?.type==="feature"&&!t.url&&t.source?.type==="memory"}function hke(t){const e=t?.type;return(e==="feature"||e==="subtype-group"||e==="oriented-imagery")&&t?.source?.type==="feature-layer"}async function z3(t,e){const r=Ve?.findServerInfo(t);if(r?.currentVersion!=null)return r.owningSystemUrl||null;const i=t.toLowerCase().indexOf("/rest/services");if(i===-1)return null;const s=`${t.slice(0,i)}/rest/info`,n=e!=null?e.signal:null,{data:o}=await et(s,{query:{f:"json"},responseType:"json",signal:n});return o?.owningSystemUrl||null}function R8(t){if(!("capabilities"in t))return!1;switch(t.type){case"catalog":case"catalog-footprint":case"csv":case"feature":case"geojson":case"imagery":case"knowledge-graph-sublayer":case"ogc-feature":case"oriented-imagery":case"scene":case"sublayer":case"subtype-group":case"subtype-sublayer":case"wfs":return!0;default:return!1}}function tse(t){return R8(t)?"effectiveCapabilities"in t?t.effectiveCapabilities:t.capabilities:null}function rse(t){if(!("editingEnabled"in t))return!1;switch(t.type){case"csv":case"feature":case"geojson":case"oriented-imagery":case"scene":case"subtype-group":case"subtype-sublayer":return!0;default:return!1}}function ise(t){return!!rse(t)&&("effectiveEditingEnabled"in t?t.effectiveEditingEnabled:t.editingEnabled)}function sse(t,e){return null}function dke(t){return null}function pT(t){return!t||t.type==="Feature Service"&&!t.sourceUrl}function pke(t,e){!e||!pT(t)||sse(t.url)}const nse=new Set(["bing-maps","imagery","imagery-tile","map-image","open-street-map","tile","unknown","unsupported","vector-tile","web-tile","wcs","wms","wmts"]),k8=new Set(["catalog","csv","feature","geo-rss","geojson","group","imagery","imagery-tile","kml","knowledge-graph","map-image","map-notes","media","ogc-feature","oriented-imagery","route","stream","subtype-group","tile","unknown","unsupported","vector-tile","video","web-tile","wcs","wfs","wms","wmts"]),ose=new Set([...k8,"link-chart"]);function ase(t){switch(t.layerContainerType){case"basemap":return nse;case"operational-layers":return t.origin==="link-chart"?ose:k8;default:return null}}function lse(t,e){if(e.restrictedWebMapWriting){const r=ase(e);return r==null||r.has(t.type)&&!a2(t)}return!0}function use(t,e){if(e)if(a2(t)){const r=fv("featureCollection.layers",e),i=r?.[0]?.layerDefinition;i&&Fk(t,i)}else t.type!=="group"&&Fk(t,e)}function Fk(t,e){"maxScale"in t&&(e.maxScale=lw(t.maxScale)??void 0),"minScale"in t&&(e.minScale=lw(t.minScale)??void 0)}function cse(t,e){if(use(t,e),e&&(e.id=t.id,"blendMode"in t&&(e.blendMode=t.blendMode,e.blendMode==="normal"&&delete e.blendMode),e.opacity=lw(t.opacity)??void 0,e.title=t.title||"Layer",e.visibility=t.visible,"legendEnabled"in t&&t.type!=="wmts"))if(a2(t)){const r=e.featureCollection;r&&(r.showLegend=t.legendEnabled)}else e.showLegend=t.legendEnabled}function Dk(t,e,r){if(!t.persistenceEnabled)return null;if(!("write"in t)||!t.write)return r?.messages&&r.messages.push(new F("layer:unsupported",`Layers (${t.title}, ${t.id}) of type '${t.declaredClass}' cannot be persisted`,{layer:t})),null;if(a2(t)&&!t.isTable)e=t.resourceInfo;else if(lse(t,r)){const i={};return t.write(i,r)?i:null}return e!=null&&cse(t,e=k(e)),e}var Hy;let hse=0,gs=Hy=class extends W.JSONSupportMixin(Ls){constructor(t){super(t),this.id=null,this.portalItem=null,this.spatialReference=null,this.style=null,this.thumbnailUrl=null,this.title="Basemap",this.id=Date.now().toString(16)+"-basemap-"+hse++,this.baseLayers=new se,this.referenceLayers=new se;const e=i=>{i.parent&&i.parent!==this&&"remove"in i.parent&&i.parent.remove(i),i.parent=this,i.type==="elevation"&&q.getLogger(this).error(`Layer '${i.title}, id:${i.id}' of type '${i.type}' is not supported as a basemap layer and will therefore be ignored.`)},r=i=>{i.parent=null};this.addHandles([this.baseLayers.on("after-add",(i=>e(i.item))),this.referenceLayers.on("after-add",(i=>e(i.item))),this.baseLayers.on("after-remove",(i=>r(i.item))),this.referenceLayers.on("after-remove",(i=>r(i.item)))])}initialize(){this.when().catch((t=>{q.getLogger(this).error("#load()",`Failed to load basemap (title: '${this.title}', id: '${this.id}')`,t)})),this.resourceInfo&&this.read(this.resourceInfo.data,this.resourceInfo.context)}destroy(){const t=this.baseLayers.toArray();for(const r of t)r.destroy();const e=this.referenceLayers.toArray();for(const r of e)r.destroy();this.baseLayers.destroy(),this.referenceLayers.destroy(),this.portalItem=At(this.portalItem)}normalizeCtorArgs(t){return t&&"resourceInfo"in t&&(this._set("resourceInfo",t.resourceInfo),delete(t={...t}).resourceInfo),t}set baseLayers(t){this._set("baseLayers",zl(t,this._get("baseLayers")))}_writeBaseLayers(t,e,r){const i=[];t&&(r={...r,layerContainerType:"basemap"},this.baseLayers.forEach((s=>{const n=Dk(s,r.webmap?r.webmap.getLayerJSONFromResourceInfo(s):null,r);n!=null&&i.push(n)})),this.referenceLayers.forEach((s=>{const n=Dk(s,r.webmap?r.webmap.getLayerJSONFromResourceInfo(s):null,r);n!=null&&(s.type!=="scene"&&(n.isReference=!0),i.push(n))}))),e.baseMapLayers=i}set referenceLayers(t){this._set("referenceLayers",zl(t,this._get("referenceLayers")))}writeTitle(t,e){e.title=t||"Basemap"}load(t){return this.addResolvingPromise(this._loadFromSource(t)),Promise.resolve(this)}loadAll(){return BV(this,(t=>{t(this.baseLayers,this.referenceLayers)}))}clone(){const t={id:this.id,title:this.title,portalItem:this.portalItem,baseLayers:this.baseLayers.map((e=>Ub(e)?e.clone():e)),referenceLayers:this.referenceLayers.map((e=>Ub(e)?e.clone():e))};return this.loaded&&(t.loadStatus="loaded"),new Hy({resourceInfo:this.resourceInfo}).set(t)}read(t,e){this.resourceInfo||this._set("resourceInfo",{data:t,context:e}),super.read(t,e)}write(t,e){return t=t||{},e?.origin||(e={origin:"web-map",...e}),super.write(t,e),!this.loaded&&this.resourceInfo?.data.baseMapLayers&&(t.baseMapLayers=this.resourceInfo.data.baseMapLayers.map((r=>{const i=k(r);return i.url&&Sa(i.url)&&(i.url=`https:${i.url}`),i.templateUrl&&Sa(i.templateUrl)&&(i.templateUrl=`https:${i.templateUrl}`),i}))),t}async _loadFromSource(t){const{resourceInfo:e,portalItem:r,style:i}=this;xt(t);const s=[];if(e){const n=e.context?e.context.url:null;if(s.push(this._loadLayersFromJSON(e.data,n,t)),e.data.id&&!e.data.title){const o=e.data.id;s.push($te(o).then((a=>{a&&this.read({title:a},e.context)})))}}else r?s.push(this._loadFromItem(r,t)):i&&s.push(this._loadFromStylesService(i,t));await Promise.all(s)}async _loadLayersFromJSON(t,e,r){const i=this.resourceInfo?.context,s=this.portalItem?.portal||i?.portal||null,n=pse[i?.origin||""]??"web-map",{populateOperationalLayers:o}=await J(async()=>{const{populateOperationalLayers:l}=await import("./layersCreator-BrQYwzG-.js");return{populateOperationalLayers:l}},__vite__mapDeps([6,7,8,9,10,11])),a=[];if(xt(r),t.baseMapLayers&&Array.isArray(t.baseMapLayers)){const l={context:{...i,origin:n,url:e,portal:s,layerContainerType:"basemap"},defaultLayerType:"DefaultTileLayer"},u=m=>n==="web-scene"&&m.layerType==="ArcGISSceneServiceLayer"||m.isReference,h=o(this.baseLayers,t.baseMapLayers.filter((m=>!u(m))),l);a.push(h);const p=o(this.referenceLayers,t.baseMapLayers.filter(u),l);a.push(p)}await Promise.allSettled(a)}async _loadFromItem(t,e){const r=await t.load(e),i=await r.fetchData("json",e),s=Pr(t.itemUrl??"");return this._set("resourceInfo",{data:i.baseMap??{},context:{origin:dse[t.type||""]??"web-map",portal:t.portal||Y.getDefault(),url:s}}),this.read(this.resourceInfo.data,this.resourceInfo.context),this.read({spatialReference:i.spatialReference},this.resourceInfo.context),this.read({title:t.title,thumbnailUrl:t.thumbnailUrl},{origin:"portal-item",portal:t.portal||Y.getDefault(),url:s}),this._loadLayersFromJSON(this.resourceInfo.data,s,e)}async _loadFromStylesService(t,e){const r=t.serviceUrl.endsWith("/webmaps")?t.serviceUrl.slice(0,-8):t.serviceUrl,i=`${r}/styles/${t.id}/self`,s=`${r}/webmaps/${t.id}`,n=t.apiKey??Ge.apiKeys.basemapStyles,[o,a]=await Promise.all([(await et(i,{query:{token:n},signal:e?.signal})).data,(await et(s,{query:{language:t.languageParameter,places:t.places,worldview:t.worldview,token:n},signal:e?.signal})).data]);this.thumbnailUrl??=o.thumbnailUrl;const l=Pr(s);if(this._set("resourceInfo",{data:a.baseMap??{},context:{origin:"web-map",url:l}}),this.read(this.resourceInfo.data,this.resourceInfo.context),this.read({spatialReference:a.spatialReference},this.resourceInfo.context),await this._loadLayersFromJSON(this.resourceInfo.data,l,e),n)for(const u of[...this.baseLayers,...this.referenceLayers])"apiKey"in u&&(u.apiKey=n)}static fromId(t){const e=cm[t];return e?e.itemId?new Hy({portalItem:{id:e.itemId,portal:{url:"https://www.arcgis.com"}}}):Hy.fromJSON(e,e.is3d?{origin:"web-scene",portal:new Y({url:"https://www.arcgis.com"})}:{origin:"web-map"}):null}};c([d({json:{write:{ignoreOrigin:!0,target:"baseMapLayers",writer(t,e,r,i){this._writeBaseLayers(t,e,i)}},origins:{"web-scene":{write:{ignoreOrigin:!0,target:{baseMapLayers:{type:se}},writer(t,e,r,i){this._writeBaseLayers(t,e,i)}}}}}})],gs.prototype,"baseLayers",null),c([d({type:String,json:{origins:{"web-scene":{write:!0}}}})],gs.prototype,"id",void 0),c([d({type:Ee})],gs.prototype,"portalItem",void 0),c([d()],gs.prototype,"referenceLayers",null),c([d({readOnly:!0})],gs.prototype,"resourceInfo",void 0),c([d({type:ne})],gs.prototype,"spatialReference",void 0),c([d({type:Yie})],gs.prototype,"style",void 0),c([d()],gs.prototype,"thumbnailUrl",void 0),c([d({type:String,json:{origins:{"web-scene":{write:{isRequired:!0}}}}})],gs.prototype,"title",void 0),c([re("title")],gs.prototype,"writeTitle",null),gs=Hy=c([C("esri.Basemap")],gs);const dse={"Web Scene":"web-scene","Web Map":"web-map","Link Chart":"link-chart"},pse={"web-scene":"web-scene","web-map":"web-map","link-chart":"link-chart"},Xg=gs,fse=Object.freeze(Object.defineProperty({__proto__:null,default:Xg},Symbol.toStringTag,{value:"Module"})),xw={transparent:[0,0,0,0],black:[0,0,0,1],silver:[192,192,192,1],gray:[128,128,128,1],white:[255,255,255,1],maroon:[128,0,0,1],red:[255,0,0,1],purple:[128,0,128,1],fuchsia:[255,0,255,1],green:[0,128,0,1],lime:[0,255,0,1],olive:[128,128,0,1],yellow:[255,255,0,1],navy:[0,0,128,1],blue:[0,0,255,1],teal:[0,128,128,1],aqua:[0,255,255,1],aliceblue:[240,248,255,1],antiquewhite:[250,235,215,1],aquamarine:[127,255,212,1],azure:[240,255,255,1],beige:[245,245,220,1],bisque:[255,228,196,1],blanchedalmond:[255,235,205,1],blueviolet:[138,43,226,1],brown:[165,42,42,1],burlywood:[222,184,135,1],cadetblue:[95,158,160,1],chartreuse:[127,255,0,1],chocolate:[210,105,30,1],coral:[255,127,80,1],cornflowerblue:[100,149,237,1],cornsilk:[255,248,220,1],crimson:[220,20,60,1],cyan:[0,255,255,1],darkblue:[0,0,139,1],darkcyan:[0,139,139,1],darkgoldenrod:[184,134,11,1],darkgray:[169,169,169,1],darkgreen:[0,100,0,1],darkgrey:[169,169,169,1],darkkhaki:[189,183,107,1],darkmagenta:[139,0,139,1],darkolivegreen:[85,107,47,1],darkorange:[255,140,0,1],darkorchid:[153,50,204,1],darkred:[139,0,0,1],darksalmon:[233,150,122,1],darkseagreen:[143,188,143,1],darkslateblue:[72,61,139,1],darkslategray:[47,79,79,1],darkslategrey:[47,79,79,1],darkturquoise:[0,206,209,1],darkviolet:[148,0,211,1],deeppink:[255,20,147,1],deepskyblue:[0,191,255,1],dimgray:[105,105,105,1],dimgrey:[105,105,105,1],dodgerblue:[30,144,255,1],firebrick:[178,34,34,1],floralwhite:[255,250,240,1],forestgreen:[34,139,34,1],gainsboro:[220,220,220,1],ghostwhite:[248,248,255,1],gold:[255,215,0,1],goldenrod:[218,165,32,1],greenyellow:[173,255,47,1],grey:[128,128,128,1],honeydew:[240,255,240,1],hotpink:[255,105,180,1],indianred:[205,92,92,1],indigo:[75,0,130,1],ivory:[255,255,240,1],khaki:[240,230,140,1],lavender:[230,230,250,1],lavenderblush:[255,240,245,1],lawngreen:[124,252,0,1],lemonchiffon:[255,250,205,1],lightblue:[173,216,230,1],lightcoral:[240,128,128,1],lightcyan:[224,255,255,1],lightgoldenrodyellow:[250,250,210,1],lightgray:[211,211,211,1],lightgreen:[144,238,144,1],lightgrey:[211,211,211,1],lightpink:[255,182,193,1],lightsalmon:[255,160,122,1],lightseagreen:[32,178,170,1],lightskyblue:[135,206,250,1],lightslategray:[119,136,153,1],lightslategrey:[119,136,153,1],lightsteelblue:[176,196,222,1],lightyellow:[255,255,224,1],limegreen:[50,205,50,1],linen:[250,240,230,1],magenta:[255,0,255,1],mediumaquamarine:[102,205,170,1],mediumblue:[0,0,205,1],mediumorchid:[186,85,211,1],mediumpurple:[147,112,219,1],mediumseagreen:[60,179,113,1],mediumslateblue:[123,104,238,1],mediumspringgreen:[0,250,154,1],mediumturquoise:[72,209,204,1],mediumvioletred:[199,21,133,1],midnightblue:[25,25,112,1],mintcream:[245,255,250,1],mistyrose:[255,228,225,1],moccasin:[255,228,181,1],navajowhite:[255,222,173,1],oldlace:[253,245,230,1],olivedrab:[107,142,35,1],orange:[255,165,0,1],orangered:[255,69,0,1],orchid:[218,112,214,1],palegoldenrod:[238,232,170,1],palegreen:[152,251,152,1],paleturquoise:[175,238,238,1],palevioletred:[219,112,147,1],papayawhip:[255,239,213,1],peachpuff:[255,218,185,1],peru:[205,133,63,1],pink:[255,192,203,1],plum:[221,160,221,1],powderblue:[176,224,230,1],rebeccapurple:[102,51,153,1],rosybrown:[188,143,143,1],royalblue:[65,105,225,1],saddlebrown:[139,69,19,1],salmon:[250,128,114,1],sandybrown:[244,164,96,1],seagreen:[46,139,87,1],seashell:[255,245,238,1],sienna:[160,82,45,1],skyblue:[135,206,235,1],slateblue:[106,90,205,1],slategray:[112,128,144,1],slategrey:[112,128,144,1],snow:[255,250,250,1],springgreen:[0,255,127,1],steelblue:[70,130,180,1],tan:[210,180,140,1],thistle:[216,191,216,1],tomato:[255,99,71,1],turquoise:[64,224,208,1],violet:[238,130,238,1],wheat:[245,222,179,1],whitesmoke:[245,245,245,1],yellowgreen:[154,205,50,1]};function O8(t){return!!xw[t]||!!xw[t.toLowerCase()]}function V3(t){return xw[t]??xw[t.toLowerCase()]}function mse(t){return[...V3(t)]}function kx(t,e,r){r<0&&++r,r>1&&--r;const i=6*r;return i<1?t+(e-t)*i:2*r<1?e:3*r<2?t+(e-t)*(2/3-r)*6:t}function N8(t,e,r,i=1){const s=(t%360+360)%360/360,n=r<=.5?r*(e+1):r+e-r*e,o=2*r-n;return[Math.round(255*kx(o,n,s+1/3)),Math.round(255*kx(o,n,s)),Math.round(255*kx(o,n,s-1/3)),i]}function yse(t){const e=t.length>5,r=e?8:4,i=(1<<r)-1,s=e?1:17,n=e?t.length===9:t.length===5;let o=+("0x"+t.slice(1));if(isNaN(o))return null;const a=[0,0,0,1];let l;return n&&(l=o&i,o>>=r,a[3]=s*l/255),l=o&i,o>>=r,a[2]=s*l,l=o&i,o>>=r,a[1]=s*l,l=o&i,o>>=r,a[0]=s*l,a}function F8(t){if(t[0]!=="#"||isNaN(+`0x${t.slice(1)}`))return null;switch(t.length){case 4:case 5:{const e=parseInt(t.slice(1,2),16),r=parseInt(t.slice(2,3),16),i=parseInt(t.slice(3,4),16),s=t.length===4?15:parseInt(t.slice(4),16);return[e+16*e,r+16*r,i+16*i,(s+16*s)/255]}case 7:case 9:return[parseInt(t.slice(1,3),16),parseInt(t.slice(3,5),16),parseInt(t.slice(5,7),16),(t.length===7?255:parseInt(t.slice(7),16))/255];default:return null}}function D8(t){const e=t.toLowerCase().match(/^(rgba?|hsla?)\(([\s.\-,%0-9]+)\)/);if(e){const r=e[2].split(/\s*,\s*/),i=e[1];if(i==="rgb"&&r.length===3||i==="rgba"&&r.length===4){const s=r[0];if(s.charAt(s.length-1)==="%"){const n=r.map((o=>2.56*parseFloat(o)));return r.length===4&&(n[3]=parseFloat(r[3])),zk(n)}return zk(r.map((n=>parseFloat(n))))}if(i==="hsl"&&r.length===3||i==="hsla"&&r.length===4)return N8(parseFloat(r[0]),parseFloat(r[1])/100,parseFloat(r[2])/100,parseFloat(r[3]??"1"))}return null}function zk(t){return t[0]=gf(t[0]),t[1]=gf(t[1]),t[2]=gf(t[2]),t[3]=t.length===4?V8(t[3]):1,t}function z8(t){let e=O8(t)?V3(t):null;return e??=D8(t),e??=F8(t),e}function fke(t){const e=z8(t);return e!=null?[e[0]/255,e[1]/255,e[2]/255,e[3]]:null}function V8(t){return j8(t,0,1)}function gf(t){return Math.round(j8(t,0,255))}function j8(t,e,r){return t=Number(t),isNaN(t)?r:t<e?e:t>r?r:t}const mke=2.2,Vk=new Float32Array(1);function yke(t){--t;for(let e=1;e<32;e<<=1)t|=t>>e;return t+1}function $i(t,e,r){return Math.min(Math.max(t,e),r)}function gse(t){return t--,t|=t>>1,t|=t>>2,t|=t>>4,t|=t>>8,t|=t>>16,++t}function Wy(t,e,r){return t+(e-t)*r}function gke(t,e,r,i,s){return Wy(i,s,(t-e)/(r-e))}function Vm(t){return t*Math.PI/180}function U8(t){return 180*t/Math.PI}function vke(t,e=1e-6){return(t<0?-1:1)/Math.max(Math.abs(t),e)}function _ke(t){return Math.acos($i(t,-1,1))}function vse(t){return Math.asin($i(t,-1,1))}function no(t,e,r=1e-6){return t===e?!0:!Number.isFinite(t)||!Number.isFinite(e)?!1:(t>e?t-e:e-t)<=r}function G8(t,e,r=1e-6){return!no(t,e,r)&&t>e}function fT(t,e,r=1e-6){return!no(t,e,r)&&t<e}function _se(t,e,r=1e-6){return no(t,e,r)||t>e}const $w=new DataView(new ArrayBuffer(Float64Array.BYTES_PER_ELEMENT));function mT(t){return $w.setFloat64(0,t),$w.getBigInt64(0)}function bse(t){return $w.setBigInt64(0,t),$w.getFloat64(0)}const P1=BigInt("1000000"),wse=B8(1);function B8(t){const e=mT(t=Math.abs(t)),r=bse(e<=P1?P1:e-P1);return Math.abs(t-r)}function bke(t,e,r=wse){if(t===e)return!0;if(!Number.isFinite(t)||!Number.isFinite(e))return!1;if(r!=null&&B8(Math.min(Math.abs(t),Math.abs(e)))<r)return Math.abs(t-e)<=r;const i=mT(t),s=mT(e);return i<0!=s<0?!1:!((i<s?s-i:i-s)>P1)}function wke(t,e,r=1e-6){if(t===e)return!0;if(!Number.isFinite(t)||!Number.isFinite(e))return!1;const i=Math.abs(t-e),s=Math.abs(t),n=Math.abs(e);if(t===0||e===0||s<1e-12&&n<1e-12){if(i>.01*r)return!1}else if(i/(s+n)>r)return!1;return!0}function Ske(t){return q8(Math.max(-jk,Math.min(t,jk)))}function q8(t){return Vk[0]=t,Vk[0]}function xke(t){const e=t[0]*t[0]+t[1]*t[1]+t[2]*t[2],r=t[3]*t[3]+t[4]*t[4]+t[5]*t[5],i=t[6]*t[6]+t[7]*t[7]+t[8]*t[8];return!(no(e,1)&&no(r,1)&&no(i,1))}const jk=q8(34028234663852886e22);function $ke(t,e,r){if(r===void 0||+r==0)return Math[t](e);if(e=+e,r=+r,isNaN(e)||typeof r!="number"||r%1!=0)return NaN;let i=e.toString().split("e");return i=(e=Math[t](+(i[0]+"e"+(i[1]?+i[1]-r:-r)))).toString().split("e"),+(i[0]+"e"+(i[1]?+i[1]+r:r))}function d_(t){return $i(l3(t),0,255)}function p_(t,e){const r=t.toString(16).padStart(2,"0");return e?r.slice(0,1):r}let A1=class Zi{static blendColors(e,r,i,s=new Zi){return s.r=Math.round(e.r+(r.r-e.r)*i),s.g=Math.round(e.g+(r.g-e.g)*i),s.b=Math.round(e.b+(r.b-e.b)*i),s.a=e.a+(r.a-e.a)*i,s._sanitize()}static fromRgb(e,r){const i=D8(e);return i?Zi.fromArray(i,r):null}static fromHex(e,r=new Zi){const i=F8(e);return i?Zi.fromArray(i,r):null}static fromArray(e,r=new Zi){return r._set(Number(e[0]),Number(e[1]),Number(e[2]),Number(e[3])),isNaN(r.a)&&(r.a=1),r._sanitize()}static fromString(e,r){const i=z8(e);return i?Zi.fromArray(i,r):null}static fromJSON(e){return e!=null?new Zi([e[0],e[1],e[2],(e[3]??255)/255]):void 0}static toUnitRGB(e){return e!=null?[e.r/255,e.g/255,e.b/255]:null}static toUnitRGBA(e){return e!=null?[e.r/255,e.g/255,e.b/255,e.a!=null?e.a:1]:null}constructor(e){this.r=255,this.g=255,this.b=255,this.a=1,e&&this.setColor(e)}get isBright(){return .299*this.r+.587*this.g+.114*this.b>=127}setColor(e){return typeof e=="string"?Zi.fromString(e,this):Array.isArray(e)?Zi.fromArray(e,this):(this._set(e.r??0,e.g??0,e.b??0,e.a??1),e instanceof Zi||this._sanitize()),this}toRgb(){return[this.r,this.g,this.b]}toRgba(){return[this.r,this.g,this.b,this.a]}toHex(e){const r=e?.capitalize??!1,i=e?.digits??6,s=i===3||i===4,n=i===4||i===8,o=`#${p_(this.r,s)}${p_(this.g,s)}${p_(this.b,s)}${n?p_(Math.round(255*this.a),s):""}`;return r?o.toUpperCase():o}toCss(e=!1){const r=this.r+", "+this.g+", "+this.b;return e?`rgba(${r}, ${this.a})`:`rgb(${r})`}toString(){return this.toCss(!0)}toJSON(){return this.toArray()}toArray(e=Zi.AlphaMode.ALWAYS){const r=d_(this.r),i=d_(this.g),s=d_(this.b);return e===Zi.AlphaMode.ALWAYS||this.a!==1?[r,i,s,d_(255*this.a)]:[r,i,s]}clone(){return new Zi(this.toRgba())}hash(){return this.r<<24|this.g<<16|this.b<<8|255*this.a}equals(e){return e!=null&&e.r===this.r&&e.g===this.g&&e.b===this.b&&e.a===this.a}_sanitize(){return this.r=gf(this.r),this.g=gf(this.g),this.b=gf(this.b),this.a=V8(this.a),this}_set(e,r,i,s){this.r=e,this.g=r,this.b=i,this.a=s}};A1.prototype.declaredClass="esri.Color",(function(t){var e;(e=t.AlphaMode||(t.AlphaMode={}))[e.ALWAYS=0]="ALWAYS",e[e.UNLESS_OPAQUE=1]="UNLESS_OPAQUE"})(A1||(A1={}));const Q=A1;function ye(t,e={}){const r=t instanceof De?t:new De(t,e),{alwaysWriteDefaults:i,default:s,ignoreUnknown:n=!0,name:o,nonNullable:a,readOnly:l=!1}=e;return d({type:n?r.apiValues:String,json:{type:r.jsonValues,default:s,name:o,read:!l&&{reader:r.read},write:{writer:r.write,alwaysWriteDefaults:i}},nonNullable:a,readOnly:l})}var yT;let L1=yT=class extends W{constructor(t){super(t),this.type="none"}clone(){return new yT({type:this.type})}};c([ye({none:"none",stayAbove:"stay-above"}),d({json:{write:{isRequired:!0}}})],L1.prototype,"type",void 0),L1=yT=c([C("esri.ground.NavigationConstraint")],L1);const Sse=Symbol("GroundInstance");function l2(t){const e=l3(100*(1-t));return Math.max(0,Math.min(e,100))}function k0(t){const e=1-t/100;return Math.max(0,Math.min(e,1))}var Uk,gT,X6;let Wa=gT=(X6=class extends W.JSONSupportMixin(Ls){constructor(t){super(t),this[Uk]=!0,this.opacity=1,this.surfaceColor=null,this.navigationConstraint=null,this.layers=new se;const e=i=>{i.parent&&i.parent!==this&&"remove"in i.parent&&i.parent.remove(i),i.parent=this,i.type!=="elevation"&&i.type!=="base-elevation"&&q.getLogger(this).error(`Layer '${i.title}, id:${i.id}' of type '${i.type}' is not supported as a ground layer and will therefore be ignored. Only layers of type 'elevation' are supported.`)},r=i=>{i.parent=null};this.addHandles([this.layers.on("after-add",(i=>e(i.item))),this.layers.on("after-remove",(i=>r(i.item)))])}initialize(){this.when().catch((t=>{xi(t)||q.getLogger(this).error("#load()","Failed to load ground",t)})),this.resourceInfo&&this.read(this.resourceInfo.data,this.resourceInfo.context)}destroy(){const t=this.layers.removeAll();for(const e of t)At(e);this.layers.destroy()}normalizeCtorArgs(t){return t&&"resourceInfo"in t&&(this._set("resourceInfo",t.resourceInfo),delete(t={...t}).resourceInfo),t}get layers(){return this._get("layers")}set layers(t){this._set("layers",zl(t,this._get("layers")))}writeLayers(t,e,r,i){const s=[];t&&(i={...i,layerContainerType:"ground"},t.forEach((n=>{if("write"in n){const o={};EY(n)().write(o,i)&&s.push(o)}else i?.messages&&i.messages.push(new F("layer:unsupported",`Layers (${n.title}, ${n.id}) of type '${n.declaredClass}' cannot be persisted in the ground`,{layer:n}))}))),e.layers=s}load(t){return this.addResolvingPromise(this._loadFromSource(t)),Promise.resolve(this)}loadAll(){return BV(this,(t=>{t(this.layers)}))}async queryElevation(t,e){await this.load({signal:e?.signal});const{ElevationQuery:r}=await J(()=>import("./ElevationQuery-DqmSsCyu.js"),[]);xt(e);const i=new r,s=this.layers.filter(Gk).toArray();return i.queryAll(s,t,e)}async createElevationSampler(t,e){await this.load({signal:e?.signal});const{ElevationQuery:r}=await J(()=>import("./ElevationQuery-DqmSsCyu.js"),[]);xt(e);const i=new r,s=this.layers.filter(Gk).toArray();return i.createSamplerAll(s,t,e)}clone(){const t={opacity:this.opacity,surfaceColor:k(this.surfaceColor),navigationConstraint:k(this.navigationConstraint),layers:this.layers.slice()};return this.loaded&&(t.loadStatus="loaded"),new gT({resourceInfo:this.resourceInfo}).set(t)}read(t,e){this.resourceInfo||this._set("resourceInfo",{data:t,context:e}),super.read(t,e)}_loadFromSource(t){const e=this.resourceInfo;return e?this._loadLayersFromJSON(e.data,e.context,t):Promise.resolve()}async _loadLayersFromJSON(t,e,r){const i=e?.origin||"web-scene",s=e?.portal||null,n=e?.url||null,{populateOperationalLayers:o}=await J(async()=>{const{populateOperationalLayers:l}=await import("./layersCreator-BrQYwzG-.js");return{populateOperationalLayers:l}},__vite__mapDeps([6,7,8,9,10,11]));xt(r);const a=[];if(t.layers&&Array.isArray(t.layers)){const l={context:{origin:i,url:n,portal:s,layerContainerType:"ground"},defaultLayerType:"ArcGISTiledElevationServiceLayer"};a.push(o(this.layers,t.layers,l))}await Promise.allSettled(a)}},Uk=Sse,X6);function xse(t){return t&&"createElevationSampler"in t}function Gk(t){return t.type==="elevation"||xse(t)}c([d({json:{read:!1,write:{isRequired:!0}}})],Wa.prototype,"layers",null),c([re("layers")],Wa.prototype,"writeLayers",null),c([d({readOnly:!0})],Wa.prototype,"resourceInfo",void 0),c([d({type:Number,nonNullable:!0,range:{min:0,max:1},json:{type:qe,read:{reader:k0,source:"transparency"},write:{writer:(t,e)=>{e.transparency=l2(t)},target:"transparency"}}})],Wa.prototype,"opacity",void 0),c([d({type:Q,json:{type:[qe],write:(t,e)=>{e.surfaceColor=t.toJSON().slice(0,3)}}})],Wa.prototype,"surfaceColor",void 0),c([d({type:L1,json:{write:!0}})],Wa.prototype,"navigationConstraint",void 0),Wa=gT=c([C("esri.Ground")],Wa);const Mw=Wa;let Vo=class extends se{constructor(e){super(e),this.getCollections=null}initialize(){this.addHandles(yV((()=>this._refresh()),Ma))}destroy(){this.getCollections=null}_refresh(){const e=this.getCollections!=null?this.getCollections():null;if(e==null)return void this.removeAll();let r=0;for(const i of e)i!=null&&(r=this._processCollection(r,i));this.splice(r)}_createNewInstance(e){return new se(e)}_processCollection(e,r){if(!r)return e;const i=this.itemFilterFunction??(s=>!!s);for(const s of r)if(s){if(i(s)){const n=this.indexOf(s,e);n>=0?n!==e&&this.reorder(s,e):this.add(s,e),++e}if(this.getChildrenFunction){const n=this.getChildrenFunction(s);if(Array.isArray(n))for(const o of n)e=this._processCollection(e,o);else e=this._processCollection(e,n)}}return e}};c([d()],Vo.prototype,"getCollections",void 0),c([d()],Vo.prototype,"getChildrenFunction",void 0),c([d()],Vo.prototype,"itemFilterFunction",void 0),Vo=c([C("esri.core.CollectionFlattener")],Vo);const H8=t=>{let e=class extends t{clone(){const r=qi(this);mv(r,"unable to clone instance of non-accessor class");const i=r.metadata,s=r.store,n={},o=new Map;for(const l in i){const u=i[l],h=s?.originOf(l),p=u.clonable;if(u.readOnly||p===!1||h!==xe.USER&&h!==xe.DEFAULTS&&h!==xe.WEB_MAP&&h!==xe.WEB_SCENE)continue;const m=this[l];let y=null;y=typeof p=="function"?p(m):p==="reference"?m:dM(m),m!=null&&y==null||(h===xe.DEFAULTS?o.set(l,y):n[l]=y)}const a=new(Object.getPrototypeOf(this)).constructor(n);if(o.size){const l=qi(a)?.store;if(l)for(const[u,h]of o)l.set(u,h,xe.DEFAULTS)}return a}};return e=c([C("esri.core.Clonable")],e),e};let Zy=class extends H8(ce){};Zy=c([C("esri.core.Clonable")],Zy),(function(t){t.ClonableMixin=H8})(Zy||(Zy={}));const Ce=Zy,$se="randomUUID"in crypto;function jm(){if($se)return crypto.randomUUID();const t=crypto.getRandomValues(new Uint16Array(8));t[3]=4095&t[3]|16384,t[4]=16383&t[4]|32768;const e=r=>t[r].toString(16).padStart(4,"0");return e(0)+e(1)+"-"+e(2)+"-"+e(3)+"-"+e(4)+"-"+e(5)+e(6)+e(7)}function Eke(){return`{${jm().toUpperCase()}}`}function Mse(){return`{${jm()}}`}function Tse(t){const e=t.toUpperCase();return t[0]!=="{"?`{${e}}`:e}const Ud={Base64:0,Hex:1,String:2,Raw:3},vf=8,W8=(1<<vf)-1;function Gu(t,e){const r=(65535&t)+(65535&e);return(t>>16)+(e>>16)+(r>>16)<<16|65535&r}function Ese(t){const e=[];for(let r=0,i=t.length*vf;r<i;r+=vf)e[r>>5]|=(t.charCodeAt(r/vf)&W8)<<r%32;return e}function Ise(t){const e=[];for(let r=0,i=32*t.length;r<i;r+=vf)e.push(String.fromCharCode(t[r>>5]>>>r%32&W8));return e.join("")}function Cse(t){const e="0123456789abcdef",r=[];for(let i=0,s=4*t.length;i<s;i++)r.push(e.charAt(t[i>>2]>>i%4*8+4&15)+e.charAt(t[i>>2]>>i%4*8&15));return r.join("")}function Pse(t){const r="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",i=[];for(let s=0,n=4*t.length;s<n;s+=3){const o=(t[s>>2]>>s%4*8&255)<<16|(t[s+1>>2]>>(s+1)%4*8&255)<<8|t[s+2>>2]>>(s+2)%4*8&255;for(let a=0;a<4;a++)8*s+6*a>32*t.length?i.push("="):i.push(r.charAt(o>>6*(3-a)&63))}return i.join("")}function Ase(t,e){return t<<e|t>>>32-e}function u2(t,e,r,i,s,n){return Gu(Ase(Gu(Gu(e,t),Gu(i,n)),s),r)}function oi(t,e,r,i,s,n,o){return u2(e&r|~e&i,t,e,s,n,o)}function ai(t,e,r,i,s,n,o){return u2(e&i|r&~i,t,e,s,n,o)}function li(t,e,r,i,s,n,o){return u2(e^r^i,t,e,s,n,o)}function ui(t,e,r,i,s,n,o){return u2(r^(e|~i),t,e,s,n,o)}function Lse(t,e){t[e>>5]|=128<<e%32,t[14+(e+64>>>9<<4)]=e;let r=1732584193,i=-271733879,s=-1732584194,n=271733878;for(let o=0;o<t.length;o+=16){const a=r,l=i,u=s,h=n;r=oi(r,i,s,n,t[o],7,-680876936),n=oi(n,r,i,s,t[o+1],12,-389564586),s=oi(s,n,r,i,t[o+2],17,606105819),i=oi(i,s,n,r,t[o+3],22,-1044525330),r=oi(r,i,s,n,t[o+4],7,-176418897),n=oi(n,r,i,s,t[o+5],12,1200080426),s=oi(s,n,r,i,t[o+6],17,-1473231341),i=oi(i,s,n,r,t[o+7],22,-45705983),r=oi(r,i,s,n,t[o+8],7,1770035416),n=oi(n,r,i,s,t[o+9],12,-1958414417),s=oi(s,n,r,i,t[o+10],17,-42063),i=oi(i,s,n,r,t[o+11],22,-1990404162),r=oi(r,i,s,n,t[o+12],7,1804603682),n=oi(n,r,i,s,t[o+13],12,-40341101),s=oi(s,n,r,i,t[o+14],17,-1502002290),i=oi(i,s,n,r,t[o+15],22,1236535329),r=ai(r,i,s,n,t[o+1],5,-165796510),n=ai(n,r,i,s,t[o+6],9,-1069501632),s=ai(s,n,r,i,t[o+11],14,643717713),i=ai(i,s,n,r,t[o],20,-373897302),r=ai(r,i,s,n,t[o+5],5,-701558691),n=ai(n,r,i,s,t[o+10],9,38016083),s=ai(s,n,r,i,t[o+15],14,-660478335),i=ai(i,s,n,r,t[o+4],20,-405537848),r=ai(r,i,s,n,t[o+9],5,568446438),n=ai(n,r,i,s,t[o+14],9,-1019803690),s=ai(s,n,r,i,t[o+3],14,-187363961),i=ai(i,s,n,r,t[o+8],20,1163531501),r=ai(r,i,s,n,t[o+13],5,-1444681467),n=ai(n,r,i,s,t[o+2],9,-51403784),s=ai(s,n,r,i,t[o+7],14,1735328473),i=ai(i,s,n,r,t[o+12],20,-1926607734),r=li(r,i,s,n,t[o+5],4,-378558),n=li(n,r,i,s,t[o+8],11,-2022574463),s=li(s,n,r,i,t[o+11],16,1839030562),i=li(i,s,n,r,t[o+14],23,-35309556),r=li(r,i,s,n,t[o+1],4,-1530992060),n=li(n,r,i,s,t[o+4],11,1272893353),s=li(s,n,r,i,t[o+7],16,-155497632),i=li(i,s,n,r,t[o+10],23,-1094730640),r=li(r,i,s,n,t[o+13],4,681279174),n=li(n,r,i,s,t[o],11,-358537222),s=li(s,n,r,i,t[o+3],16,-722521979),i=li(i,s,n,r,t[o+6],23,76029189),r=li(r,i,s,n,t[o+9],4,-640364487),n=li(n,r,i,s,t[o+12],11,-421815835),s=li(s,n,r,i,t[o+15],16,530742520),i=li(i,s,n,r,t[o+2],23,-995338651),r=ui(r,i,s,n,t[o],6,-198630844),n=ui(n,r,i,s,t[o+7],10,1126891415),s=ui(s,n,r,i,t[o+14],15,-1416354905),i=ui(i,s,n,r,t[o+5],21,-57434055),r=ui(r,i,s,n,t[o+12],6,1700485571),n=ui(n,r,i,s,t[o+3],10,-1894986606),s=ui(s,n,r,i,t[o+10],15,-1051523),i=ui(i,s,n,r,t[o+1],21,-2054922799),r=ui(r,i,s,n,t[o+8],6,1873313359),n=ui(n,r,i,s,t[o+15],10,-30611744),s=ui(s,n,r,i,t[o+6],15,-1560198380),i=ui(i,s,n,r,t[o+13],21,1309151649),r=ui(r,i,s,n,t[o+4],6,-145523070),n=ui(n,r,i,s,t[o+11],10,-1120210379),s=ui(s,n,r,i,t[o+2],15,718787259),i=ui(i,s,n,r,t[o+9],21,-343485551),r=Gu(r,a),i=Gu(i,l),s=Gu(s,u),n=Gu(n,h)}return[r,i,s,n]}function j3(t,e=Ud.Hex){const r=e||Ud.Base64,i=Lse(Ese(t),t.length*vf);switch(r){case Ud.Raw:return i;case Ud.Hex:return Cse(i);case Ud.String:return Ise(i);case Ud.Base64:return Pse(i)}}function Rse(t){return t&&"getAtOrigin"in t&&"originOf"in t}function vT(t){return U3[kse(t)]||Nse}function kse(t){return t.type==="json"?"application/json":t.type==="blob"?t.blob.type:Ose(t.url)}function Ose(t){const e=Cz(t);return _T[e]||Z8}const U3={},Z8="text/plain",Nse=U3[Z8],_T={png:"image/png",jpeg:"image/jpeg",jpg:"image/jpg",bmp:"image/bmp",gif:"image/gif",json:"application/json",txt:"text/plain",xml:"application/xml",svg:"image/svg+xml",zip:"application/zip",pbf:"application/vnd.mapbox-vector-tile",gz:"application/gzip","bin.gz":"application/octet-stream"};for(const t in _T)U3[_T[t]]=t;function Fse(t){const e=t?.origins??[void 0];return(r,i)=>{const s=Dse(t,r,i);for(const n of e){const o=u3(r,n,i);for(const a in s)o[a]=s[a]}}}function Dse(t,e,r){if(t?.type==="resource")return zse(t,e,r);switch(t?.type??"other"){case"other":return{read:!0,write:!0};case"url":{const{read:i,write:s}=PX;return{read:i,write:s}}}}function zse(t,e,r){const i=_v(e,r);return{type:String,read:(s,n,o)=>{const a=GS(s,n,o);return i.type===String?a:typeof i.type=="function"?new i.type({url:a}):void 0},write:{isRequired:i.json?.write?.isRequired,writer(s,n,o,a){if(!a?.resources)return typeof s=="string"?void(n[o]=cd(s,a)):void(n[o]=s.write({},a));const l=Use(s),u=cd(l,{...a,verifyItemRelativeUrls:a?.verifyItemRelativeUrls?{writtenUrls:a.verifyItemRelativeUrls.writtenUrls,rootPath:void 0}:void 0},sm.NO),h=i.type!==String&&(!Rse(this)||a?.origin&&this.originIdOf(r)>Ml(a.origin)),p={object:this,propertyName:r,value:s,targetUrl:u,dest:n,targetPropertyName:o,context:a,params:t};a?.portalItem&&u&&!cs(u)?h&&t?.contentAddressed?bT(p):h?Vse(p):jse(p):a?.portalItem&&(u==null||zz(u)!=null||Cm(u)||h)?bT(p):n[o]=u}}}}function bT(t){const{targetUrl:e,params:r,value:i,context:s,dest:n,targetPropertyName:o}=t;if(!s.portalItem)return;const a=Vz(e),l=Y8(i,e,s);if(r?.contentAddressed&&l.type!=="json")return void s.messages?.push(new F("persistable:contentAddressingUnsupported",`Property "${o}" is trying to serializing a resource with content of type ${l.type} with content addressing. Content addressing is only supported for json resources.`,{content:l}));const u=r?.contentAddressed&&l.type==="json"?j3(l.jsonString):a?.filename??jm(),h=ud(r?.prefix??a?.prefix,u),p=`${h}.${vT(l)}`;if(r?.contentAddressed&&s.resources&&l.type==="json"){const g=s.resources.toKeep.find((({resource:v})=>v.path===p))??s.resources.toAdd.find((({resource:v})=>v.path===p));if(g)return void(n[o]=g.resource.itemRelativeUrl)}const m=s.portalItem.resourceFromPath(p);Cm(e)&&s.resources&&s.resources.pendingOperations.push(nX(e).then((g=>{m.path=`${h}.${vT({type:"blob",blob:g})}`,n[o]=m.itemRelativeUrl})).catch((()=>{})));const y=r?.compress??!1;s.resources&&J8({...t,resource:m,content:l,compress:y,updates:s.resources.toAdd}),n[o]=m.itemRelativeUrl}function Vse(t){const{context:e,targetUrl:r,params:i,value:s,dest:n,targetPropertyName:o}=t;if(!e.portalItem)return;const a=e.portalItem.resourceFromPath(r),l=Y8(s,r,e),u=vT(l),h=Cz(a.path),p=i?.compress??!1;u===h?(e.resources&&J8({...t,resource:a,content:l,compress:p,updates:e.resources.toUpdate}),n[o]=r):bT(t)}function jse({context:t,targetUrl:e,dest:r,targetPropertyName:i}){t.portalItem&&t.resources&&(t.resources.toKeep.push({resource:t.portalItem.resourceFromPath(e),compress:!1}),r[i]=e)}function J8({object:t,propertyName:e,updates:r,resource:i,content:s,compress:n}){const o=a=>{Gse(t,e,a)};r.push({resource:i,content:s,compress:n,finish:o})}function Y8(t,e,r){return typeof t=="string"?{type:"url",url:e}:{type:"json",jsonString:JSON.stringify(t.toJSON(r))}}function Use(t){return t==null?null:typeof t=="string"?t:t.url}function Gse(t,e,r){typeof t[e]=="string"?t[e]=r.url:t[e].url=r.url}let R1=class extends Ce.ClonableMixin(W){constructor(e){super(e),this.color=null}};c([d({type:Q,json:{type:[qe],write:!0}})],R1.prototype,"color",void 0),R1=c([C("esri.effects.FocusAreaOutline")],R1);const Bse=R1;function c2(t){const e=[];for(t.reset();t.nextPath();){const r=[];for(;t.nextPoint();)r.push([t.x,t.y]);e.push(r)}return t.reset(),e}function Qu(t){const e=[];for(;t.nextPoint();)e.push([t.x,t.y]);return t.seekPathStart(),e}var Tw;(function(t){t[t.X=0]="X",t[t.Y=1]="Y",t[t.Z=2]="Z"})(Tw||(Tw={}));function Cke(t){if(!t)return null;if(Array.isArray(t))return t;const e=t.hasZ,r=t.hasM;if(t.type==="point")return r&&e?[t.x,t.y,t.z,t.m]:e?[t.x,t.y,t.z]:r?[t.x,t.y,t.m]:[t.x,t.y];if(t.type==="polygon")return t.rings.slice();if(t.type==="polyline")return t.paths.slice();if(t.type==="multipoint")return t.points.slice();if(t.type==="extent"){const i=t.clone().normalize();if(!i)return null;let s=!1,n=!1;return i.forEach((o=>{o.hasZ&&(s=!0),o.hasM&&(n=!0)})),i.map((o=>{const a=[[o.xmin,o.ymin],[o.xmin,o.ymax],[o.xmax,o.ymax],[o.xmax,o.ymin],[o.xmin,o.ymin]];if(s&&o.hasZ){const l=.5*(o.zmax-o.zmin);for(let u=0;u<a.length;u++)a[u].push(l)}if(n&&o.hasM){const l=.5*(o.mmax-o.mmin);for(let u=0;u<a.length;u++)a[u].push(l)}return a}))}return null}function h2(t,e){const r=e[0]-t[0],i=e[1]-t[1];if(t.length>2&&e.length>2){const s=t[2]-e[2];return Math.sqrt(r*r+i*i+s*s)}return Math.sqrt(r*r+i*i)}function X8(t,e,r){const i=t[0]+r*(e[0]-t[0]),s=t[1]+r*(e[1]-t[1]);return t.length>2&&e.length>2?[i,s,t[2]+r*(e[2]-t[2])]:[i,s]}function qse(t,e,r,i){return K8(t,e,r[i],r[i+1])}function K8(t,e,r,i){const[s,n]=e,[o,a]=r,[l,u]=i,h=l-o,p=u-a,m=h*h+p*p,y=(s-o)*h+(n-a)*p,g=Math.min(1,Math.max(0,y/m));return t[0]=o+h*g,t[1]=a+p*g,t}function Hse(t,e,r,i,s,n){let o=r,a=i,l=s-o,u=n-a;if(l!==0||u!==0){const h=((t-o)*l+(e-a)*u)/(l*l+u*u);h>1?(o=s,a=n):h>0&&(o+=l*h,a+=u*h)}return l=t-o,u=e-a,l*l+u*u}function Q8(t,e){return X8(t,e,.5)}function Wse(t){const e=t.length;let r=0;for(let i=0;i<e-1;++i)r+=h2(t[i],t[i+1]);return r}function Pke(t,e){if(e<=0)return t[0];const r=t.length;let i=0;for(let s=0;s<r-1;++s){const n=h2(t[s],t[s+1]);if(e-i<n){const o=(e-i)/n;return X8(t[s],t[s+1],o)}i+=n}return t[r-1]}function eU(t,e=Tw.X,r=Tw.Y){let i=0;const s=t.length;let n=t[0];for(let o=1;o<s;o++){const a=t[o];i+=(a[e]-n[e])*(a[r]+n[r]),n=a}if(tU(t)){const o=t[0];i+=(o[e]-n[e])*(o[r]+n[r])}return i>=0}function tU(t){const e=t.length;return e>0&&!FS(t[0],t[e-1])}function Zse(t){"rings"in t&&(Jse(t),Yse(t))}function Jse(t){if("rings"in t)for(const e of t.rings)tU(e)&&e.push(e[0].slice())}function Yse(t){if(!("rings"in t)||t.rings.length===0||eU(t.rings[0]))return!1;for(const e of t.rings)e.reverse();return!0}function Ake(t){return t.type!=="polygon"&&t.type!=="polyline"||Xse(t.type==="polygon"?t.rings:t.paths,t.spatialReference),t}function Xse(t,e){const r=Si(e);if(!r)return;const i=r.valid[0],s=r.valid[1],n=s-i;for(const o of t){let a=1/0,l=-1/0;for(const h of o){const p=Kse(h[0],i,s);a=Math.min(a,p),l=Math.max(l,p),h[0]=p}const u=l-a;n-u<u&&o.forEach((h=>{h[0]<0&&(h[0]+=n)}))}}function Kse(t,e,r){const i=r-e;return t<e?r-(e-t)%i:t>r?e+(t-e)%i:t}function Lke(t,e){if(t===e)return!0;if(t.type!==e.type)return!1;if(t.type==="point"||t.type==="mesh"||t.type==="extent")return!0;if(t.type==="multipoint")return t.points.length===e.points.length;const[r,i]=t.type==="polyline"?[t.paths,e.paths]:[t.rings,e.rings];return r.length===i.length&&r.every(((s,n)=>s.length===i[n].length))}function Rke(t){return t?t.hasZ?[t.xmax-t.xmin/2,t.ymax-t.ymin/2,t.zmax-t.zmin/2]:[t.xmax-t.xmin/2,t.ymax-t.ymin/2]:null}function rU(t){return t?Qse(t.rings,t.hasZ??!1):null}function Qse(t,e){if(!t?.length)return null;const r=[],i=[],s=e?[1/0,-1/0,1/0,-1/0,1/0,-1/0]:[1/0,-1/0,1/0,-1/0];for(let n=0,o=t.length;n<o;n++){const a=iU(t[n],e,s);a&&i.push(a)}if(i.sort(((n,o)=>{let a=n[2]-o[2];return a===0&&e&&(a=n[4]-o[4]),a})),i.length&&(r[0]=i[0][0],r[1]=i[0][1],e&&(r[2]=i[0][3]),(r[0]<s[0]||r[0]>s[1]||r[1]<s[2]||r[1]>s[3]||e&&(r[2]<s[4]||r[2]>s[5]))&&(r.length=0)),!r.length){const n=t[0]&&t[0].length?tne(t[0],e):null;if(!n)return null;r[0]=n[0],r[1]=n[1],e&&n.length>2&&(r[2]=n[2])}return r}function iU(t,e,r){let i=0,s=0,n=0,o=0,a=0;const l=t.length?t[0][0]:0,u=t.length?t[0][1]:0,h=t.length&&e?t[0][2]:0;for(let m=0;m<t.length;m++){const y=t[m],g=t[(m+1)%t.length],[v,_,b]=y,S=v-l,$=_-u,[T,I,P]=g,R=T-l,D=I-u,V=S*D-R*$;if(o+=V,i+=(S+R)*V,s+=($+D)*V,e&&y.length>2&&g.length>2){const U=b-h,Z=P-h,X=S*Z-R*U;n+=(U+Z)*X,a+=X}v<r[0]&&(r[0]=v),v>r[1]&&(r[1]=v),_<r[2]&&(r[2]=_),_>r[3]&&(r[3]=_),e&&(b<r[4]&&(r[4]=b),b>r[5]&&(r[5]=b))}if(o>0&&(o*=-1),a>0&&(a*=-1),!o)return null;o*=.5,a*=.5;const p=[i/(6*o)+l,s/(6*o)+u,o];return e&&(r[4]===r[5]||a===0?(p[3]=(r[4]+r[5])/2,p[4]=0):(p[3]=n/(6*a)+h,p[4]=a)),p}function ene(t,e){let r=0,i=0,s=0;t.nextPoint();const n=t.pathSize?t.x:0,o=t.pathSize?t.y:0;for(let a=0;a<t.pathSize;a++){t.seekInPath(a);const l=[t.x,t.y];t.seekInPath((a+1)%t.pathSize);const u=[t.x,t.y],[h,p]=l,m=h-n,y=p-o,[g,v]=u,_=g-n,b=v-o,S=m*b-_*y;s+=S,r+=(m+_)*S,i+=(y+b)*S,h<e[0]&&(e[0]=h),h>e[1]&&(e[1]=h),p<e[2]&&(e[2]=p),p>e[3]&&(e[3]=p)}return s>0&&(s*=-1),s?(s*=.5,[r/(6*s)+n,i/(6*s)+o,s]):null}function tne(t,e){const r=e?[0,0,0]:[0,0],i=e?[0,0,0]:[0,0];let s=0,n=0,o=0,a=0;for(let l=0,u=t.length;l<u-1;l++){const h=t[l],p=t[l+1];if(h&&p){r[0]=h[0],r[1]=h[1],i[0]=p[0],i[1]=p[1],e&&h.length>2&&p.length>2&&(r[2]=h[2],i[2]=p[2]);const m=h2(r,i);if(m){s+=m;const y=Q8(h,p);n+=m*y[0],o+=m*y[1],e&&y.length>2&&(a+=m*y[2])}}}return s>0?e?[n/s,o/s,a/s]:[n/s,o/s]:t.length?t[0]:null}function sU(t){const{hasZ:e,totalSize:r}=t;if(r===0)return null;const i=[],s=[],n=e?[Number.POSITIVE_INFINITY,Number.NEGATIVE_INFINITY,Number.POSITIVE_INFINITY,Number.NEGATIVE_INFINITY,Number.POSITIVE_INFINITY,Number.NEGATIVE_INFINITY]:[Number.POSITIVE_INFINITY,Number.NEGATIVE_INFINITY,Number.POSITIVE_INFINITY,Number.NEGATIVE_INFINITY];for(t.reset();t.nextPath();){const o=iU(Qu(t),t.hasZ,n);o&&s.push(o)}if(s.sort(((o,a)=>{let l=o[2]-a[2];return l===0&&e&&(l=o[4]-a[4]),l})),s.length&&(i[0]=s[0][0],i[1]=s[0][1],e&&(i[2]=s[0][3]),(i[0]<n[0]||i[0]>n[1]||i[1]<n[2]||i[1]>n[3]||e&&(i[2]<n[4]||i[2]>n[5]))&&(i.length=0)),!i.length){t.reset(),t.nextPath();const o=t.pathSize?rne(t):null;if(!o)return null;i[0]=o[0],i[1]=o[1],e&&o.length>2&&(i[2]=o[2])}return i}function rne(t){const{hasZ:e}=t,r=e?[0,0,0]:[0,0],i=e?[0,0,0]:[0,0];let s=0,n=0,o=0,a=0;if(t.nextPoint()){let l=t.x,u=t.y,h=t.z;for(;t.nextPoint();){const p=t.x,m=t.y,y=t.z;r[0]=l,r[1]=u,i[0]=p,i[1]=m,e&&(r[2]=h,i[2]=y);const g=h2(r,i);if(g){s+=g;const v=Q8(r,i);n+=g*v[0],o+=g*v[1],e&&v.length>2&&(a+=g*v[2])}l=p,u=m,h=y}}return s>0?e?[n/s,o/s,a/s]:[n/s,o/s]:t.pathSize?(t.seekPathStart(),t.nextPoint(),[t.x,t.y]):null}const ine=1e-6;function sne(t){let e=0;for(t.reset();t.nextPath();)e+=t.getCurrentRingArea();if(e<ine){const s=sU(t);return s?[s[0],s[1]]:null}const r=[0,0];if(t.reset(),!t.nextPath()||!t.nextPoint())return null;const i=[t.x,t.y];for(t.reset();t.nextPath();)one(r,i,t);return r[0]*=1/e,r[1]*=1/e,r[0]+=i[0],r[1]+=i[1],r}const nne=1/3;function one(t,e,r){if(!t||!r||r.pathSize<3)return null;r.nextPoint();const i=r.x,s=r.y;r.nextPoint();let n,o=r.x-i,a=r.y-s,l=0,u=0;for(;r.nextPoint();)l=r.x-i,u=r.y-s,n=.5*nne*(l*a-u*o),t[0]+=n*(o+l),t[1]+=n*(a+u),o=l,a=u;const h=r.getCurrentRingArea(),p=[i,s];return p[0]-=e[0],p[1]-=e[1],p[0]*=h,p[1]*=h,t[0]+=p[0],t[1]+=p[1],t}function nr(t=pne){return[t[0],t[1],t[2],t[3]]}function nU(t,e){return t!==e&&(t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3]),t}function ane(t,e,r,i,s=nr()){return s[0]=t,s[1]=e,s[2]=r,s[3]=i,s}function kke(t,e=nr()){return e[0]=t.xmin,e[1]=t.ymin,e[2]=t.xmax,e[3]=t.ymax,e}function lne(t,e,r=new Le){return r.xmin=t[0],r.ymin=t[1],r.xmax=t[2],r.ymax=t[3],r.spatialReference=e,r}function Jy(t,e){e[0]<t[0]&&(t[0]=e[0]),e[0]>t[2]&&(t[2]=e[0]),e[1]<t[1]&&(t[1]=e[1]),e[1]>t[3]&&(t[3]=e[1])}function Oke(t,e,r){if(e!=null)if("length"in e)wT(e)?(r[0]=Math.min(t[0],e[0]),r[1]=Math.min(t[1],e[1]),r[2]=Math.max(t[2],e[2]),r[3]=Math.max(t[3],e[3])):e.length!==2&&e.length!==3||(r[0]=Math.min(t[0],e[0]),r[1]=Math.min(t[1],e[1]),r[2]=Math.max(t[2],e[0]),r[3]=Math.max(t[3],e[1]));else switch(e.type){case"extent":r[0]=Math.min(t[0],e.xmin),r[1]=Math.min(t[1],e.ymin),r[2]=Math.max(t[2],e.xmax),r[3]=Math.max(t[3],e.ymax);break;case"point":r[0]=Math.min(t[0],e.x),r[1]=Math.min(t[1],e.y),r[2]=Math.max(t[2],e.x),r[3]=Math.max(t[3],e.y)}else nU(r,t)}function Nke(t,e,r=t){const i=e.length;let s=t[0],n=t[1],o=t[2],a=t[3];for(let l=0;l<i;l++){const u=e[l];s=Math.min(s,u[0]),n=Math.min(n,u[1]),o=Math.max(o,u[0]),a=Math.max(a,u[1])}return r[0]=s,r[1]=n,r[2]=o,r[3]=a,r}function Fke(t){for(let e=0;e<4;e++)if(!isFinite(t[e]))return!1;return!0}function d2(t){return t==null||t[0]>=t[2]?0:t[2]-t[0]}function p2(t){return t==null||t[1]>=t[3]?0:t[3]-t[1]}function Dke(t){return d2(t)*p2(t)}function Bk(t,e=[0,0]){return e[0]=(t[0]+t[2])/2,e[1]=(t[1]+t[3])/2,e}function une(t){const e=d2(t),r=p2(t);return Math.sqrt(e*e+r*r)}function zke(t,e){return cne(t,e.x,e.y)}function cne(t,e,r){return e>=t[0]&&r>=t[1]&&e<=t[2]&&r<=t[3]}function Vke(t,e){return Math.max(e[0],t[0])<=Math.min(e[2],t[2])&&Math.max(e[1],t[1])<=Math.min(e[3],t[3])}function jke(t,e,r){return Math.max(e[0],t[0])-r<=Math.min(e[2],t[2])&&Math.max(e[1],t[1])-r<=Math.min(e[3],t[3])}function hne(t,e){return e[0]>=t[0]&&e[2]<=t[2]&&e[1]>=t[1]&&e[3]<=t[3]}function Uke(t,e,r,i=t){return i[0]=t[0]+e,i[1]=t[1]+r,i[2]=t[2]+e,i[3]=t[3]+r,i}function dne(t){return t?nU(t,qk):nr(qk)}function wT(t){return t!=null&&t.length===4}function Gke(t,e){return wT(t)&&wT(e)?t[0]===e[0]&&t[1]===e[1]&&t[2]===e[2]&&t[3]===e[3]:t===e}const qk=[1/0,1/0,-1/0,-1/0],pne=[0,0,0,0];function oU(t){return t.xmin!==void 0&&t.ymin!==void 0&&t.xmax!==void 0&&t.ymax!==void 0}function aU(t){return t.points!==void 0}function lU(t){return t.x!==void 0&&t.y!==void 0}function uU(t){return t.paths!==void 0}function cU(t){return t.rings!==void 0}function hU(t){function e(r,i){return r==null?i:i==null?r:t(r,i)}return e}const Bu=hU(Math.min),qu=hU(Math.max);function G3(t,e){return uU(e)?dm(t,e.paths,!1,!1):cU(e)?dm(t,e.rings,!1,!1):aU(e)?B3(t,e.points,!1,!1,!1,!1):oU(e)?pU(t,e):(lU(e)&&(t[0]=e.x,t[1]=e.y,t[2]=e.x,t[3]=e.y),t)}function Iv(t){let e,r,i,s;for(t.reset(),e=i=1/0,r=s=-1/0;t.nextPath();){const n=dU(t);e=Math.min(n[0],e),i=Math.min(n[1],i),r=Math.max(n[2],r),s=Math.max(n[3],s)}return nr([e,i,r,s])}function dU(t){let e,r,i,s;for(e=i=1/0,r=s=-1/0;t.nextPoint();)e=Math.min(t.x,e),i=Math.min(t.y,i),r=Math.max(t.x,r),s=Math.max(t.y,s);return nr([e,i,r,s])}function Bke(t,e){return uU(e)?dm(t,e.paths,!0,!1):cU(e)?dm(t,e.rings,!0,!1):aU(e)?B3(t,e.points,!0,!1,!0,!1):oU(e)?pU(t,e,!0,!1,!0,!1):(lU(e)&&(t[0]=e.x,t[1]=e.y,t[2]=e.z,t[3]=e.x,t[4]=e.y,t[5]=e.z),t)}function dm(t,e,r,i){const s=r?3:2;if(!e.length||!e[0].length)return null;let n,o,a,l,[u,h]=e[0][0],[p,m]=e[0][0];for(let y=0;y<e.length;y++){const g=e[y];for(let v=0;v<g.length;v++){const _=g[v],[b,S]=_;if(u=Bu(u,b),h=Bu(h,S),p=qu(p,b),m=qu(m,S),r&&_.length>2){const $=_[2];n=Bu(n,$),o=qu(o,$)}if(i&&_.length>s){const $=_[s];a=Bu(n,$),l=qu(o,$)}}}return r?i?(t[0]=u,t[1]=h,t[2]=n,t[3]=a,t[4]=p,t[5]=m,t[6]=o,t[7]=l,t.length=8,t):(t[0]=u,t[1]=h,t[2]=n,t[3]=p,t[4]=m,t[5]=o,t.length=6,t):i?(t[0]=u,t[1]=h,t[2]=a,t[3]=p,t[4]=m,t[5]=l,t.length=6,t):(t[0]=u,t[1]=h,t[2]=p,t[3]=m,t.length=4,t)}function pU(t,e,r,i,s,n){const o=e.xmin,a=e.xmax,l=e.ymin,u=e.ymax;let h=e.zmin,p=e.zmax,m=e.mmin,y=e.mmax;return s?(h=h||0,p=p||0,n?(m=m||0,y=y||0,t[0]=o,t[1]=l,t[2]=h,t[3]=m,t[4]=a,t[5]=u,t[6]=p,t[7]=y,t):(t[0]=o,t[1]=l,t[2]=h,t[3]=a,t[4]=u,t[5]=p,t)):n?(m=m||0,y=y||0,t[0]=o,t[1]=l,t[2]=m,t[3]=a,t[4]=u,t[5]=y,t):(t[0]=o,t[1]=l,t[2]=a,t[3]=u,t)}function B3(t,e,r,i,s,n){const o=r?3:2,a=i&&n,l=r&&s;if(!e.length||!e[0].length)return null;let u,h,p,m,[y,g]=e[0],[v,_]=e[0];for(let b=0;b<e.length;b++){const S=e[b],[$,T]=S;if(y=Bu(y,$),g=Bu(g,T),v=qu(v,$),_=qu(_,T),l&&S.length>2){const I=S[2];u=Bu(u,I),h=qu(h,I)}if(a&&S.length>o){const I=S[o];p=Bu(u,I),m=qu(h,I)}}return s?(u=u||0,h=h||0,n?(p=p||0,m=m||0,t[0]=y,t[1]=g,t[2]=u,t[3]=p,t[4]=v,t[5]=_,t[6]=h,t[7]=m,t):(t[0]=y,t[1]=g,t[2]=u,t[3]=v,t[4]=_,t[5]=h,t)):n?(p=p||0,m=m||0,t[0]=y,t[1]=g,t[2]=p,t[3]=v,t[4]=_,t[5]=m,t):(t[0]=y,t[1]=g,t[2]=v,t[3]=_,t)}function fne(t){return t.xmin!==void 0&&t.ymin!==void 0&&t.xmax!==void 0&&t.ymax!==void 0}function mne(t){return t.points!==void 0}function yne(t){return t.x!==void 0&&t.y!==void 0}function gne(t){return t.paths!==void 0}function vne(t){return t.rings!==void 0}const q3=[];function fU(t,e,r,i){return{xmin:t,ymin:e,xmax:r,ymax:i}}function mU(t,e,r,i,s,n){return{xmin:t,ymin:e,zmin:r,xmax:i,ymax:s,zmax:n}}function yU(t,e,r,i,s,n){return{xmin:t,ymin:e,mmin:r,xmax:i,ymax:s,mmax:n}}function gU(t,e,r,i,s,n,o,a){return{xmin:t,ymin:e,zmin:r,mmin:i,xmax:s,ymax:n,zmax:o,mmax:a}}function H3(t,e=!1,r=!1){return e?r?gU(t[0],t[1],t[2],t[3],t[4],t[5],t[6],t[7]):mU(t[0],t[1],t[2],t[3],t[4],t[5]):r?yU(t[0],t[1],t[2],t[3],t[4],t[5]):fU(t[0],t[1],t[2],t[3])}function qke(t){return t?fne(t)?t:yne(t)?bne(t):vne(t)?vU(t):gne(t)?_U(t):mne(t)?_ne(t):null:null}function _ne(t){const{hasZ:e,hasM:r,points:i}=t;return H3(B3(q3,i,e??!1,r??!1),e,r)}function bne(t){const{x:e,y:r,z:i,m:s}=t,n=s!=null;return i!=null?n?gU(e,r,i,s,e,r,i,s):mU(e,r,i,e,r,i):n?yU(e,r,s,e,r,s):fU(e,r,e,r)}function vU(t){const{hasZ:e,hasM:r,rings:i}=t,s=dm(q3,i,e??!1,r??!1);return s?H3(s,e,r):null}function _U(t){const{hasZ:e,hasM:r,paths:i}=t,s=dm(q3,i,e??!1,r??!1);return s?H3(s,e,r):null}function pm(t,e,r=!1){let{hasM:i,hasZ:s}=t;Array.isArray(e)?e.length!==4||i||s?e.length===3&&r&&!i?(s=!0,i=!1):e.length===3&&i&&s&&(i=!1,s=!1):(i=!0,s=!0):(s=!s&&e.hasZ&&(!i||e.hasM),i=!i&&e.hasM&&(!s||e.hasZ)),t.hasZ=s,t.hasM=i}var k1;function Hk(t){return!Array.isArray(t[0])}function wne(t){return typeof t[0]?.[0]=="number"}function Sne(t){if(!t)return;let{rings:e,hasM:r,hasZ:i,spatialReference:s}=t;switch(e??=[],wne(e)&&(e=[e]),e[0]?.[0]?.length){case 4:i??=!0,r??=!0;break;case 3:i??=r!==!0,r??=!i;break;default:i??=!1,r??=!1}return s??=ne.WGS84,{...t,hasM:r,hasZ:i,rings:e,spatialReference:s}}let yt=k1=class extends Gr{static fromExtent(t){const e=t.clone().normalize(),{spatialReference:r}=t;let i=!1,s=!1;for(const o of e)o.hasZ&&(i=!0),o.hasM&&(s=!0);const n={rings:e.map((o=>{const a=[[o.xmin,o.ymin],[o.xmin,o.ymax],[o.xmax,o.ymax],[o.xmax,o.ymin],[o.xmin,o.ymin]];if(i&&o.hasZ){const l=o.zmin+.5*(o.zmax-o.zmin);for(let u=0;u<a.length;u++)a[u].push(l)}if(s&&o.hasM){const l=o.mmin+.5*(o.mmax-o.mmin);for(let u=0;u<a.length;u++)a[u].push(l)}return a})),spatialReference:r};return i&&(n.hasZ=!0),s&&(n.hasM=!0),new k1(n)}constructor(t){super(Sne(t)),this.curveRings=void 0,this.rings=[],this.type="polygon"}get cache(){return this.commitProperty("curveRings"),this.commitProperty("hasM"),this.commitProperty("hasZ"),this.commitProperty("rings"),this.commitProperty("spatialReference"),{}}get centroid(){const t=rU(this);if(!t||isNaN(t[0])||isNaN(t[1])||this.hasZ&&isNaN(t[2]))return null;const e=new ge;return e.x=t[0],e.y=t[1],e.spatialReference=this.spatialReference,this.hasZ&&(e.z=t[2]),e}writeCurveRings(t,e){e.curveRings=k(t)}get extent(){const t=vU(this),{spatialReference:e}=this;return t?new Le({...t,spatialReference:e}):null}get isSelfIntersecting(){return Xz(q.getLogger(this),"isSelfIntersecting",{replacement:"Please use simplifyOperator.isSimple() instead.",version:"4.33",warnOnce:!0}),cte(this.rings)}writeRings(t,e){e.rings=k(this.rings)}addRing(t){if(!t)return;const e=this.rings,r=e.length;if(Hk(t)){const i=[];for(let s=0,n=t.length;s<n;s++)i[s]=t[s].toArray();e[r]=i}else e[r]=t.slice();return this.notifyChange("rings"),this}clone(){const t=new k1;return t.spatialReference=this.spatialReference,t.rings=k(this.rings),t.curveRings=k(this.curveRings),t.hasZ=this.hasZ,t.hasM=this.hasM,t}equals(t){if(this===t)return!0;if(t==null)return!1;const e=this.spatialReference,r=t.spatialReference;if(e!=null!=(r!=null)||e!=null&&r!=null&&!e.equals(r)||this.rings.length!==t.rings.length)return!1;const i=([s,n,o,a],[l,u,h,p])=>s===l&&n===u&&(o==null&&h==null||o===h)&&(a==null&&p==null||a===p);for(let s=0;s<this.rings.length;s++){const n=this.rings[s],o=t.rings[s];if(!FS(n,o,i))return!1}return!0}contains(t){if(!t)return!1;const e=QS(t,this.spatialReference);return S3(this,e??t)}isClockwise(t){const e=Hk(t)?t.map((r=>this.hasZ?this.hasM?[r.x,r.y,r.z,r.m]:[r.x,r.y,r.z]:[r.x,r.y])):t;return eU(e)}getPoint(t,e){if(!this._validateInputs(t,e))return null;const r=this.rings[t][e],i=this.hasZ,s=this.hasM;return i&&!s?new ge(r[0],r[1],r[2],void 0,this.spatialReference):s&&!i?new ge(r[0],r[1],void 0,r[2],this.spatialReference):i&&s?new ge(r[0],r[1],r[2],r[3],this.spatialReference):new ge(r[0],r[1],this.spatialReference)}insertPoint(t,e,r){return this._validateInputs(t,e,!0)?(pm(this,r),Array.isArray(r)||(r=r.toArray()),this.rings[t].splice(e,0,r),this.notifyChange("rings"),this):this}removePoint(t,e){if(!this._validateInputs(t,e))return null;const r=new ge(this.rings[t].splice(e,1)[0],this.spatialReference);return this.notifyChange("rings"),r}removeRing(t){if(!this._validateInputs(t,null))return null;const e=this.rings.splice(t,1)[0],r=this.spatialReference,i=e.map((s=>new ge(s,r)));return this.notifyChange("rings"),i}setPoint(t,e,r){return this._validateInputs(t,e)?(pm(this,r),Array.isArray(r)||(r=r.toArray()),this.rings[t][e]=r,this.notifyChange("rings"),this):this}_validateInputs(t,e,r=!1){if(t==null||t<0||t>=this.rings.length)return!1;if(e!=null){const i=this.rings[t];if(r&&(e<0||e>i.length)||!r&&(e<0||e>=i.length))return!1}return!0}toJSON(t){return this.write({},t)}};c([d({readOnly:!0})],yt.prototype,"cache",null),c([d({readOnly:!0})],yt.prototype,"centroid",null),c([d({json:{write:!0,origins:{"portal-item":{write:!1},"web-map":{write:!1},"web-scene":{write:!1}}}})],yt.prototype,"curveRings",void 0),c([re("curveRings")],yt.prototype,"writeCurveRings",null),c([d({readOnly:!0})],yt.prototype,"extent",null),c([d({readOnly:!0})],yt.prototype,"isSelfIntersecting",null),c([d({type:[[[Number]]],json:{write:{isRequired:!0}}})],yt.prototype,"rings",void 0),c([re("rings")],yt.prototype,"writeRings",null),yt=k1=c([C("esri.geometry.Polygon")],yt),yt.prototype.toJSON.isDefaultToJSON=!0;function _c(){return[0,0,0]}function xne(t){return[t[0],t[1],t[2]]}function Um(t,e,r){return[t,e,r]}function $ne(t,e,r){return[t,e,r]}function Mne(t,e=_c()){const r=Math.min(3,t.length);for(let i=0;i<r;++i)e[i]=t[i];return e}function bU(){return _c()}function wU(){return Um(1,1,1)}function SU(){return Um(1,0,0)}function xU(){return Um(0,1,0)}function $U(){return Um(0,0,1)}const Tne=bU(),MU=wU(),Ene=SU(),Ine=xU(),Cne=$U();Object.freeze(Object.defineProperty({__proto__:null,ONES:MU,UNIT_X:Ene,UNIT_Y:Ine,UNIT_Z:Cne,ZEROS:Tne,clone:xne,create:_c,freeze:$ne,fromArray:Mne,fromValues:Um,ones:wU,unitX:SU,unitY:xU,unitZ:$U,zeros:bU},Symbol.toStringTag,{value:"Module"}));var ST;function Wk(t){return(e,r)=>e==null?r:r==null?e:t(e,r)}function Pne(t){return t&&(t.declaredClass==="esri.geometry.SpatialReference"||t.wkid!=null)}let Bn=ST=class extends Gr{constructor(...t){super(...t),this.points=[],this.type="multipoint"}normalizeCtorArgs(t,e){if(!t&&!e)return{};const r={};Array.isArray(t)?(r.points=t,r.spatialReference=e):Pne(t)?r.spatialReference=t:(t.points&&(r.points=t.points),t.spatialReference&&(r.spatialReference=t.spatialReference),t.hasZ&&(r.hasZ=t.hasZ),t.hasM&&(r.hasM=t.hasM));const i=r.points?.[0];return i&&(r.hasZ===void 0&&r.hasM===void 0?(r.hasZ=i.length>2,r.hasM=!1):r.hasZ===void 0?r.hasZ=i.length>3:r.hasM===void 0&&(r.hasM=i.length>3)),r}get cache(){return this.commitProperty("points"),this.commitProperty("hasZ"),this.commitProperty("hasM"),this.commitProperty("spatialReference"),{}}get extent(){const t=this.points;if(!t.length)return null;const e=new Le,r=this.hasZ,i=this.hasM,s=r?3:2,n=t[0],o=Wk(Math.min),a=Wk(Math.max);let l,u,h,p,[m,y]=n,[g,v]=n;for(let _=0,b=t.length;_<b;_++){const S=t[_],[$,T]=S;if(m=o(m,$),y=o(y,T),g=a(g,$),v=a(v,T),r&&S.length>2){const I=S[2];l=o(l,I),h=a(h,I)}if(i&&S.length>s){const I=S[s];u=o(u,I),p=a(p,I)}}return e.xmin=m,e.ymin=y,e.xmax=g,e.ymax=v,e.spatialReference=this.spatialReference,r?(e.zmin=l,e.zmax=h):(e.zmin=void 0,e.zmax=void 0),i?(e.mmin=u,e.mmax=p):(e.mmin=void 0,e.mmax=void 0),e}writePoints(t,e){e.points=k(this.points)}addPoint(t){return pm(this,t),Array.isArray(t)?this.points.push(t):this.points.push(t.toArray()),this.notifyChange("points"),this}clone(){const t={points:k(this.points),spatialReference:this.spatialReference};return this.hasZ&&(t.hasZ=!0),this.hasM&&(t.hasM=!0),new ST(t)}getPoint(t){if(!this._validateInputs(t))return null;const e=this.points[t],r={x:e[0],y:e[1],spatialReference:this.spatialReference};let i=2;return this.hasZ&&(r.z=e[2],i=3),this.hasM&&(r.m=e[i]),new ge(r)}removePoint(t){if(!this._validateInputs(t))return null;const e=new ge(this.points.splice(t,1)[0],this.spatialReference);return this.notifyChange("points"),e}setPoint(t,e){return this._validateInputs(t)?(pm(this,e),Array.isArray(e)||(e=e.toArray()),this.points[t]=e,this.notifyChange("points"),this):this}toJSON(t){return this.write({},t)}_validateInputs(t){return t!=null&&t>=0&&t<this.points.length}};c([d({readOnly:!0})],Bn.prototype,"cache",null),c([d()],Bn.prototype,"extent",null),c([d({type:[[Number]],json:{write:{isRequired:!0}}})],Bn.prototype,"points",void 0),c([re("points")],Bn.prototype,"writePoints",null),Bn=ST=c([C("esri.geometry.Multipoint")],Bn),Bn.prototype.toJSON.isDefaultToJSON=!0;var xT;function Ane(t){return!Array.isArray(t[0])}function Lne(t){return typeof t[0]?.[0]=="number"}function Rne(t){if(!t)return;let{paths:e,hasM:r,hasZ:i,spatialReference:s}=t;switch(e??=[],Lne(e)&&(e=[e]),e[0]?.[0]?.length){case 4:i??=!0,r??=!0;break;case 3:i??=r!==!0,r??=!i;break;default:i??=!1,r??=!1}return s??=ne.WGS84,{...t,hasM:r,hasZ:i,paths:e,spatialReference:s}}let er=xT=class extends Gr{constructor(t){super(Rne(t)),this.curvePaths=void 0,this.paths=[],this.type="polyline"}get cache(){return this.commitProperty("curvePaths"),this.commitProperty("hasM"),this.commitProperty("hasZ"),this.commitProperty("paths"),this.commitProperty("spatialReference"),{}}writeCurvePaths(t,e){e.curvePaths=k(t)}get extent(){const t=_U(this),{spatialReference:e}=this;return t?new Le({...t,spatialReference:e}):null}writePaths(t,e){e.paths=k(this.paths)}addPath(t){if(!t)return;const e=this.paths,r=e.length;if(Ane(t)){const i=[];for(let s=0,n=t.length;s<n;s++)i[s]=t[s].toArray();e[r]=i}else e[r]=t.slice();return this.notifyChange("paths"),this}clone(){const t=new xT;return t.spatialReference=this.spatialReference,t.paths=k(this.paths),t.curvePaths=k(this.curvePaths),t.hasZ=this.hasZ,t.hasM=this.hasM,t}getPoint(t,e){if(!this._validateInputs(t,e))return null;const r=this.paths[t][e],i=this.hasZ,s=this.hasM;return i&&!s?new ge(r[0],r[1],r[2],void 0,this.spatialReference):s&&!i?new ge(r[0],r[1],void 0,r[2],this.spatialReference):i&&s?new ge(r[0],r[1],r[2],r[3],this.spatialReference):new ge(r[0],r[1],this.spatialReference)}insertPoint(t,e,r){return this._validateInputs(t,e,!0)?(pm(this,r),Array.isArray(r)||(r=r.toArray()),this.paths[t].splice(e,0,r),this.notifyChange("paths"),this):this}removePath(t){if(!this._validateInputs(t,null))return null;const e=this.paths.splice(t,1)[0],r=this.spatialReference,i=e.map((s=>new ge(s,r)));return this.notifyChange("paths"),i}removePoint(t,e){if(!this._validateInputs(t,e))return null;const r=new ge(this.paths[t].splice(e,1)[0],this.spatialReference);return this.notifyChange("paths"),r}setPoint(t,e,r){return this._validateInputs(t,e)?(pm(this,r),Array.isArray(r)||(r=r.toArray()),this.paths[t][e]=r,this.notifyChange("paths"),this):this}_validateInputs(t,e,r=!1){if(t==null||t<0||t>=this.paths.length)return!1;if(e!=null){const i=this.paths[t];if(r&&(e<0||e>i.length)||!r&&(e<0||e>=i.length))return!1}return!0}toJSON(t){return this.write({},t)}};c([d({readOnly:!0})],er.prototype,"cache",null),c([d({json:{write:!0,origins:{"portal-item":{write:!1},"web-map":{write:!1},"web-scene":{write:!1}}}})],er.prototype,"curvePaths",void 0),c([re("curvePaths")],er.prototype,"writeCurvePaths",null),c([d({readOnly:!0})],er.prototype,"extent",null),c([d({type:[[[Number]]],json:{write:{isRequired:!0}}})],er.prototype,"paths",void 0),c([re("paths")],er.prototype,"writePaths",null),er=xT=c([C("esri.geometry.Polyline")],er),er.prototype.toJSON.isDefaultToJSON=!0;const ns=Math.PI/180,kne=/(?:SPHEROID|ELLIPSOID)\[([^\]]+)]/i,su=Gt.radius,In=Gt.eccentricitySquared,One={a1:su*In,a2:su*In*su*In,a3:su*In*In/2,a4:su*In*su*In*2.5,a5:su*In+su*In*In/2,a6:1-In},Nne={4267:{a:63782064e-1,f:1/294.9786982},4269:{a:6378137,f:1/298.257222101},4326:{a:Gt.radius,f:Gt.flattening},4490:{a:6378137,f:1/298.257222101},104900:{a:2439700,f:0},104901:{a:6051e3,f:0},104902:{a:6051800,f:0},104903:{a:oc.radius,f:oc.flattening},104904:{a:3393400,f:1/192.0430107526882},104905:{a:_a.radius,f:_a.flattening},104906:{a:6200,f:0},104907:{a:11100,f:0},104908:{a:71492e3,f:.06487439154031222},104909:{a:8200,f:0},104910:{a:83500,f:0},104911:{a:1e4,f:0},104912:{a:2409300,f:0},104913:{a:15e3,f:0},104914:{a:4e4,f:0},104915:{a:1562090,f:0},104916:{a:2632345,f:0},104917:{a:85e3,f:0},104918:{a:1821460,f:0},104919:{a:5e3,f:0},104920:{a:12e3,f:0},104921:{a:3e4,f:3},104922:{a:18e3,f:0},104923:{a:14e3,f:0},104924:{a:49300,f:0},104925:{a:60268e3,f:1/10.2079945799458},104926:{a:16e3,f:0},104927:{a:9500,f:0},104928:{a:56e4,f:0},104929:{a:249400,f:0},104930:{a:59500,f:0},104931:{a:16e3,f:0},104932:{a:133e3,f:0},104933:{a:718e3,f:0},104934:{a:888e3,f:0},104935:{a:1986300,f:0},104936:{a:1e4,f:0},104937:{a:41900,f:0},104938:{a:11e4,f:0},104939:{a:50100,f:0},104940:{a:764e3,f:0},104941:{a:11e3,f:0},104942:{a:529800,f:0},104943:{a:2575e3,f:0},104944:{a:25559e3,f:1/43.61604095563141},104945:{a:578900,f:0},104946:{a:33e3,f:0},104947:{a:21e3,f:0},104948:{a:13e3,f:0},104949:{a:31e3,f:0},104950:{a:27e3,f:0},104951:{a:42e3,f:0},104952:{a:235800,f:0},104953:{a:761400,f:0},104954:{a:15e3,f:0},104955:{a:54e3,f:0},104956:{a:77e3,f:0},104957:{a:27e3,f:0},104958:{a:788900,f:0},104959:{a:584700,f:0},104960:{a:24764e3,f:.01708124697141011},104961:{a:74e3,f:0},104962:{a:79e3,f:0},104963:{a:104e3,f:.14423076923076922},104964:{a:29e3,f:0},104965:{a:17e4,f:0},104966:{a:208e3,f:0},104967:{a:4e4,f:0},104968:{a:1352600,f:0},104969:{a:1195e3,f:0},104970:{a:593e3,f:0},104971:{a:_a.radius,f:0},104972:{a:47e4,f:0},104973:{a:255e3,f:0},104974:{a:2439400,f:0}};var j;(function(t){t[t.UNKNOWN=0]="UNKNOWN",t[t.SPHERICAL_ECEF=1]="SPHERICAL_ECEF",t[t.WGS84=2]="WGS84",t[t.WEB_MERCATOR=3]="WEB_MERCATOR",t[t.WGS84_ECEF=4]="WGS84_ECEF",t[t.CGCS2000=5]="CGCS2000",t[t.SPHERICAL_MARS_PCPF=6]="SPHERICAL_MARS_PCPF",t[t.GCSMARS2000=7]="GCSMARS2000",t[t.SPHERICAL_MOON_PCPF=8]="SPHERICAL_MOON_PCPF",t[t.GCSMOON2000=9]="GCSMOON2000",t[t.LON_LAT=10]="LON_LAT",t[t.PLATE_CARREE=11]="PLATE_CARREE"})(j||(j={}));const Fne={[j.WGS84]:{[j.CGCS2000]:Mt,[j.GCSMARS2000]:null,[j.GCSMOON2000]:null,[j.LON_LAT]:Mt,[j.SPHERICAL_ECEF]:Qg,[j.SPHERICAL_MARS_PCPF]:null,[j.SPHERICAL_MOON_PCPF]:null,[j.UNKNOWN]:null,[j.WEB_MERCATOR]:_f,[j.PLATE_CARREE]:bf,[j.WGS84]:Mt,[j.WGS84_ECEF]:xf},[j.CGCS2000]:{[j.CGCS2000]:Mt,[j.GCSMARS2000]:null,[j.GCSMOON2000]:null,[j.LON_LAT]:Mt,[j.SPHERICAL_ECEF]:Qg,[j.SPHERICAL_MARS_PCPF]:null,[j.SPHERICAL_MOON_PCPF]:null,[j.UNKNOWN]:null,[j.WEB_MERCATOR]:_f,[j.PLATE_CARREE]:bf,[j.WGS84]:Mt,[j.WGS84_ECEF]:xf},[j.GCSMARS2000]:{[j.CGCS2000]:null,[j.GCSMARS2000]:Mt,[j.GCSMOON2000]:null,[j.LON_LAT]:Mt,[j.SPHERICAL_ECEF]:null,[j.SPHERICAL_MARS_PCPF]:Yk,[j.SPHERICAL_MOON_PCPF]:null,[j.UNKNOWN]:null,[j.WEB_MERCATOR]:null,[j.PLATE_CARREE]:null,[j.WGS84]:null,[j.WGS84_ECEF]:null},[j.GCSMOON2000]:{[j.CGCS2000]:null,[j.GCSMARS2000]:null,[j.GCSMOON2000]:Mt,[j.LON_LAT]:Mt,[j.SPHERICAL_ECEF]:null,[j.SPHERICAL_MARS_PCPF]:null,[j.SPHERICAL_MOON_PCPF]:Jk,[j.UNKNOWN]:null,[j.WEB_MERCATOR]:null,[j.PLATE_CARREE]:null,[j.WGS84]:null,[j.WGS84_ECEF]:null},[j.WEB_MERCATOR]:{[j.CGCS2000]:Kg,[j.GCSMARS2000]:null,[j.GCSMOON2000]:null,[j.LON_LAT]:Kg,[j.SPHERICAL_ECEF]:zne,[j.SPHERICAL_MARS_PCPF]:null,[j.SPHERICAL_MOON_PCPF]:null,[j.UNKNOWN]:null,[j.WEB_MERCATOR]:Mt,[j.PLATE_CARREE]:Une,[j.WGS84]:Kg,[j.WGS84_ECEF]:Vne},[j.WGS84_ECEF]:{[j.CGCS2000]:$f,[j.GCSMARS2000]:null,[j.GCSMOON2000]:null,[j.LON_LAT]:$f,[j.SPHERICAL_ECEF]:Xne,[j.SPHERICAL_MARS_PCPF]:null,[j.SPHERICAL_MOON_PCPF]:null,[j.UNKNOWN]:null,[j.WEB_MERCATOR]:Kne,[j.PLATE_CARREE]:Gne,[j.WGS84]:$f,[j.WGS84_ECEF]:Mt},[j.SPHERICAL_ECEF]:{[j.CGCS2000]:Sf,[j.GCSMARS2000]:null,[j.GCSMOON2000]:null,[j.LON_LAT]:Sf,[j.SPHERICAL_ECEF]:Mt,[j.SPHERICAL_MARS_PCPF]:null,[j.SPHERICAL_MOON_PCPF]:null,[j.UNKNOWN]:null,[j.WEB_MERCATOR]:Zne,[j.PLATE_CARREE]:Bne,[j.WGS84]:Sf,[j.WGS84_ECEF]:Jne},[j.SPHERICAL_MARS_PCPF]:{[j.CGCS2000]:null,[j.GCSMARS2000]:Kk,[j.GCSMOON2000]:null,[j.LON_LAT]:Kk,[j.SPHERICAL_ECEF]:null,[j.SPHERICAL_MARS_PCPF]:Mt,[j.SPHERICAL_MOON_PCPF]:null,[j.UNKNOWN]:null,[j.WEB_MERCATOR]:null,[j.PLATE_CARREE]:null,[j.WGS84]:null,[j.WGS84_ECEF]:null},[j.SPHERICAL_MOON_PCPF]:{[j.CGCS2000]:null,[j.GCSMARS2000]:null,[j.GCSMOON2000]:Xk,[j.LON_LAT]:Xk,[j.SPHERICAL_ECEF]:null,[j.SPHERICAL_MARS_PCPF]:null,[j.SPHERICAL_MOON_PCPF]:Mt,[j.UNKNOWN]:null,[j.WEB_MERCATOR]:null,[j.PLATE_CARREE]:null,[j.WGS84]:null,[j.WGS84_ECEF]:null},[j.UNKNOWN]:{[j.CGCS2000]:null,[j.GCSMARS2000]:null,[j.GCSMOON2000]:null,[j.LON_LAT]:null,[j.SPHERICAL_ECEF]:null,[j.SPHERICAL_MARS_PCPF]:null,[j.SPHERICAL_MOON_PCPF]:null,[j.UNKNOWN]:Mt,[j.WEB_MERCATOR]:null,[j.PLATE_CARREE]:null,[j.WGS84]:null,[j.WGS84_ECEF]:null},[j.LON_LAT]:{[j.CGCS2000]:Mt,[j.GCSMARS2000]:Mt,[j.GCSMOON2000]:Mt,[j.LON_LAT]:Mt,[j.SPHERICAL_ECEF]:Qg,[j.SPHERICAL_MARS_PCPF]:Yk,[j.SPHERICAL_MOON_PCPF]:Jk,[j.UNKNOWN]:null,[j.WEB_MERCATOR]:_f,[j.PLATE_CARREE]:bf,[j.WGS84]:Mt,[j.WGS84_ECEF]:xf},[j.PLATE_CARREE]:{[j.CGCS2000]:wf,[j.GCSMARS2000]:null,[j.GCSMOON2000]:null,[j.LON_LAT]:wf,[j.SPHERICAL_ECEF]:qne,[j.SPHERICAL_MARS_PCPF]:null,[j.SPHERICAL_MOON_PCPF]:null,[j.UNKNOWN]:null,[j.WEB_MERCATOR]:Hne,[j.PLATE_CARREE]:Mt,[j.WGS84]:wf,[j.WGS84_ECEF]:Wne}};function TU(t,e){return Dne(t,e)?.projector}function Dne(t,e){if(t==null||e==null)return null;if(Ra.source.spatialReference===t&&Ra.dest.spatialReference===e)return Ra;const r=Zk(t,Ra.source),i=Zk(e,Ra.dest);return r===j.UNKNOWN&&i===j.UNKNOWN?mr(t,e)?Ra.projector=Mt:Ra.projector=null:Ra.projector=Fne[r][i],Ra}function Zk(t,e){return t?e.spatialReference===t?e.spatialReferenceId:(e.spatialReference=t,"metersPerUnit"in e&&(e.metersPerUnit=vn(t,1)),pw(t)?e.spatialReferenceId=j.SPHERICAL_ECEF:fd(t)?e.spatialReferenceId=j.WGS84:lo(t)?e.spatialReferenceId=j.WEB_MERCATOR:gee(t)?e.spatialReferenceId=j.PLATE_CARREE:t.wkt===wee.wkt?e.spatialReferenceId=j.WGS84_ECEF:t.wkid===pd.CGCS2000?e.spatialReferenceId=j.CGCS2000:t.wkt===_3.wkt?e.spatialReferenceId=j.SPHERICAL_MARS_PCPF:t.wkt===b3.wkt?e.spatialReferenceId=j.SPHERICAL_MOON_PCPF:KV(t)?e.spatialReferenceId=j.GCSMARS2000:QV(t)?e.spatialReferenceId=j.GCSMOON2000:e.spatialReferenceId=j.UNKNOWN):j.UNKNOWN}function Mt(t,e,r,i){t!==r&&(r[i++]=t[e++],r[i++]=t[e++],r[i]=t[e])}function Kg(t,e,r,i){r[i]=mm*(t[e]/Yh),r[i+1]=mm*(EU-2*Math.atan(Math.exp(-t[e+1]/Yh))),r[i+2]=t[e+2]}function zne(t,e,r,i){const s=t[e]/Yh,n=EU-2*Math.atan(Math.exp(-t[e+1]/Yh)),o=Yh+t[e+2],a=Math.cos(n)*o;r[i]=Math.cos(s)*a,r[i+1]=Math.sin(s)*a,r[i+2]=Math.sin(n)*o}function Vne(t,e,r,i){Kg(t,e,r,i),xf(r,i,r,i)}function jne(t,e,r,i,s){const n=.4999999*Math.PI,o=$i(fm*t[e+1],-n,n),a=Math.sin(o);r[i++]=fm*t[e]*s.radius,r[i++]=s.halfSemiMajorAxis*Math.log((1+a)/(1-a)),r[i]=t[e+2]}function _f(t,e,r,i){jne(t,e,r,i,Gt)}function bf(t,e,r,i){r[i]=t[e]*Qk,r[i+1]=t[e+1]*Qk,r[i+2]=t[e+2]}function wf(t,e,r,i){r[i]=t[e]*eO,r[i+1]=t[e+1]*eO,r[i+2]=t[e+2]}function Une(t,e,r,i){Kg(t,e,r,i),bf(r,i,r,i)}function Gne(t,e,r,i){$f(t,e,r,i),bf(r,i,r,i)}function Bne(t,e,r,i){Sf(t,e,r,i),bf(r,i,r,i)}function qne(t,e,r,i){wf(t,e,r,i),Qg(r,i,r,i)}function Hne(t,e,r,i){wf(t,e,r,i),_f(r,i,r,i)}function Wne(t,e,r,i){wf(t,e,r,i),xf(r,i,r,i)}function W3(t,e,r,i,s){const n=s+t[e+2],o=fm*t[e+1],a=fm*t[e],l=Math.cos(o)*n;r[i]=Math.cos(a)*l,r[i+1]=Math.sin(a)*l,r[i+2]=Math.sin(o)*n}function Jk(t,e,r,i){W3(t,e,r,i,oc.radius)}function Yk(t,e,r,i){W3(t,e,r,i,_a.radius)}function Qg(t,e,r,i){W3(t,e,r,i,Gt.radius)}function Z3(t,e,r,i,s){const n=t[e],o=t[e+1],a=t[e+2],l=Math.sqrt(n*n+o*o+a*a),u=vse(a/(l===0?1:l)),h=Math.atan2(o,n);r[i++]=mm*h,r[i++]=mm*u,r[i]=l-s}function Xk(t,e,r,i){Z3(t,e,r,i,oc.radius)}function Kk(t,e,r,i){Z3(t,e,r,i,_a.radius)}function Sf(t,e,r,i){Z3(t,e,r,i,Gt.radius)}function Zne(t,e,r,i){Sf(t,e,r,i),_f(r,i,r,i)}function Jne(t,e,r,i){Sf(t,e,r,i),xf(r,i,r,i)}function Yne(t,e,r,i,s){const n=fm*t[e],o=fm*t[e+1],a=t[e+2],l=Math.sin(o),u=Math.cos(o),h=s.radius/Math.sqrt(1-s.eccentricitySquared*l*l);r[i++]=(h+a)*u*Math.cos(n),r[i++]=(h+a)*u*Math.sin(n),r[i++]=(h*(1-s.eccentricitySquared)+a)*l}function xf(t,e,r,i){Yne(t,e,r,i,Gt)}function $f(t,e,r,i){const s=One,n=t[e],o=t[e+1],a=t[e+2];let l,u,h,p,m,y,g,v,_,b,S,$,T,I,P,R,D,V,U,Z,X;l=Math.abs(a),u=n*n+o*o,h=Math.sqrt(u),p=u+a*a,m=Math.sqrt(p),Z=Math.atan2(o,n),y=a*a/p,g=u/p,I=s.a2/m,P=s.a3-s.a4/m,g>.3?(v=l/m*(1+g*(s.a1+I+y*P)/m),U=Math.asin(v),b=v*v,_=Math.sqrt(1-b)):(_=h/m*(1-y*(s.a5-I-g*P)/m),U=Math.acos(_),b=1-_*_,v=Math.sqrt(b)),S=1-Gt.eccentricitySquared*b,$=Gt.radius/Math.sqrt(S),T=s.a6*$,I=h-$*_,P=l-T*v,D=_*I+v*P,R=_*P-v*I,V=R/(T/S+D),U+=V,X=D+R*V/2,a<0&&(U=-U),r[i++]=mm*Z,r[i++]=mm*U,r[i]=X}function Xne(t,e,r,i){$f(t,e,r,i),Qg(r,i,r,i)}function Kne(t,e,r,i){$f(t,e,r,i),_f(r,i,r,i)}const Ra={source:{spatialReference:null,spatialReferenceId:j.UNKNOWN,metersPerUnit:1},dest:{spatialReference:null,spatialReferenceId:j.UNKNOWN,metersPerUnit:1},projector:Mt},fm=Vm(1),mm=U8(1),EU=.5*Math.PI,Yh=Gt.radius,Qk=Yh*Math.PI/180,eO=180/(Yh*Math.PI);function Cv(t,e,r,i,s,n,o=Math.floor(t.length/3)){const a=TU(e,s);if(a==null)return!1;if(a===Mt){if(t===i&&r===n)return!0;const u=r+3*o;for(let h=r,p=n;h<u;h++,p++)i[p]=t[h];return!0}const l=r+3*o;for(let u=r,h=n;u<l;u+=3,h+=3)a(t,u,i,h);return!0}const Hke=Object.freeze(Object.defineProperty({__proto__:null,projectBuffer:Cv},Symbol.toStringTag,{value:"Module"}));function tO(t,e,r,i,s,n){return f_[0]=t,f_[1]=e,f_[2]=r,Cv(f_,i,0,s,n,0)}const f_=_c();let m_=0,Ox=class $T{static fromGE(e){const r=new $T;return r._wkt=e.wkt,r._wkid=e.wkid,r._isInverse=e.isInverse,r}constructor(e){this.uid=m_++,e?(this._wkt=e.wkt!=null?e.wkt:null,this._wkid=e.wkid!=null?e.wkid:-1,this._isInverse=e.isInverse!=null&&e.isInverse===!0):(this._wkt=null,this._wkid=-1,this._isInverse=!1)}get wkt(){return this._wkt}set wkt(e){this._wkt=e,this.uid=m_++}get wkid(){return this._wkid}set wkid(e){this._wkid=e,this.uid=m_++}get isInverse(){return this._isInverse}set isInverse(e){this._isInverse=e,this.uid=m_++}getInverse(){const e=new $T;return e._wkt=this.wkt,e._wkid=this._wkid,e._isInverse=!this.isInverse,e}},Ew=class Yy{static cacheKey(e,r){return[e.wkid?.toString()??"-1",e.wkt?.toString()??"",e.wkt2?.toString()??"",r.wkid?.toString()??"-1",r.wkt?.toString()??"",r.wkt2?.toString()??""].join()}static fromGE(e){const r=new Yy;let i="";for(const s of e.steps){const n=Ox.fromGE(s);r.steps.push(n),i+=n.uid.toString()+","}return r._cachedProjection={},r._gtlistentry=null,r._chain=i,r}constructor(e){if(this.steps=[],this._cachedProjection={},this._chain="",this._gtlistentry=null,e?.steps)for(const r of e.steps)r instanceof Ox?this.steps.push(r):this.steps.push(new Ox({wkid:r.wkid,wkt:r.wkt,isInverse:r.isInverse}))}getInverse(){const e=new Yy;e.steps=[];for(let r=this.steps.length-1;r>=0;r--){const i=this.steps[r];e.steps.push(i.getInverse())}return e}getGTListEntry(){let e="";for(const r of this.steps)e+=r.uid.toString()+",";return e!==this._chain&&(this._gtlistentry=null,this._cachedProjection={},this._chain=e),this._gtlistentry}assignCachedGe(e,r,i){this._cachedProjection[Yy.cacheKey(e,r)]=i}getCachedGeTransformation(e,r){let i="";for(const n of this.steps)i+=n.uid.toString()+",";i!==this._chain&&(this._gtlistentry=null,this._cachedProjection={},this._chain=i);const s=this._cachedProjection[Yy.cacheKey(e,r)];return s===void 0?null:s}};function IU(t,e,r){if(e==null||r==null||r.vcsWkid||mr(e,r)||ac(e)||ac(r))return null;const i=fw(e)/fw(r);if(i===1)return null;switch(t){case"point":case"esriGeometryPoint":return s=>Qne(s,i);case"polyline":case"esriGeometryPolyline":return s=>toe(s,i);case"polygon":case"esriGeometryPolygon":return s=>eoe(s,i);case"multipoint":case"esriGeometryMultipoint":return s=>roe(s,i);case"extent":case"esriGeometryEnvelope":return s=>ioe(s,i);default:return null}}function Qne(t,e){t?.z!=null&&(t.z*=e)}function eoe(t,e){if(t)for(const r of t.rings)for(const i of r)i.length>2&&(i[2]*=e)}function toe(t,e){if(t)for(const r of t.paths)for(const i of r)i.length>2&&(i[2]*=e)}function roe(t,e){if(t)for(const r of t.points)r.length>2&&(r[2]*=e)}function ioe(t,e){t&&t.zmin!=null&&t.zmax!=null&&(t.zmin*=e,t.zmax*=e)}let oo=null,cc=null,e0=null,O1={};const J3=new Sv;function Bl(){return!!oo&&g3()}function CU(){return!!Bl()||(we(J3),Vl(),!1)}function PU(t,e){return!t||!e||gn(t,e)||CU()}function soe(t,e){return!gn(t,e)&&!Bl()}function Vl(t){return e0==null&&(e0=Promise.all([qV(),J(()=>import("./geometryEngineBase-B9CjWDWD.js"),__vite__mapDeps([12,13])).then((e=>e.g)),J(()=>import("./hydrated-CihCz0wg.js"),[])])),e0.then((([,e,{hydratedAdapter:r}])=>{xt(t),cc=r,oo=e.default,oo._enableProjection(pee),J3.notify()}))}function bc(t,e,r=null,i=null){return Array.isArray(t)?t.length===0?[]:(Zee(t),MT(cc,t,t[0].spatialReference,e,r,i)):(lm(t),MT(cc,[t],t.spatialReference,e,r,i)[0])}function MT(t,e,r,i,s=null,n=null){if(r==null||i==null)return e;if(gn(r,i,s))return e.map((o=>N1(o,r,i)));if(s==null&&pw(r))return e.map((o=>N1(o,r,ne.WGS84))).map((o=>O0(o,i)));if(s==null&&pw(i))return e.map((o=>O0(o,ne.WGS84))).map((o=>N1(o,ne.WGS84,i)));if(s==null){const o=Ew.cacheKey(r,i);O1[o]!==void 0?s=O1[o]:((s=LU(r,i,void 0))==null&&(s=new Ew),O1[o]=s)}if(oo==null||t==null)throw new f2;return n!=null?oo._project(t,e,r,i,s,n):oo._project(t,e,r,i,s)}function noe(t,e){const r=AU([t],e);return r.pending!=null?{pending:r.pending,geometry:null}:r.geometries!=null?{pending:null,geometry:r.geometries[0]}:{pending:null,geometry:null}}function AU(t,e){if(!Bl()){for(const r of t)if(r!=null&&!mr(r.spatialReference,e)&&as(r.spatialReference)&&as(e)&&!gn(r.spatialReference,e))return we(J3),{pending:Vl(),geometries:null}}return{pending:null,geometries:t.map((r=>r==null?null:mr(r.spatialReference,e)?r:as(r.spatialReference)&&as(e)?O0(r,e):null))}}function LU(t,e,r=null){if(t==null||e==null)return null;if(oo==null||cc==null)throw new f2;const i=oo._getTransformation(cc,t,e,r,r?.spatialReference);return i!==null?Ew.fromGE(i):null}function ooe(t,e,r=null){if(oo==null||cc==null)throw new f2;const i=oo._getTransformationBySuitability(cc,t,e,r,r?.spatialReference);if(i!==null){const s=[];for(const n of i)s.push(Ew.fromGE(n));return s}return[]}let f2=class extends F{constructor(){super("projection:not-loaded","projection engine not fully loaded yet, please call load()")}};function aoe(){oo=null,cc=null,e0=null,O1={}}const loe={get loadPromise(){return e0}};function O0(t,e){try{const r=bc(t,e);if(r==null)return null;"xmin"in t&&"xmin"in r&&(r.zmin=t.zmin,r.zmax=t.zmax);const i=IU(r.type,t.spatialReference,e);return i?.(r),r}catch(r){if(!(r instanceof f2))throw r;return null}}async function RU(t,e,r){const i=t.spatialReference;return i!=null&&e!=null&&await Y3(i,e,null,r),O0(t,e)}function gn(t,e,r){return!r&&(!!mr(t,e)||as(t)&&as(e)&&!!TU(t,e))}function uoe(t,e){if(mr(t,e))return!0;if(!as(t)||!as(e))return!1;const r=fd(t)||lo(t)||BR(t),i=fd(e)||lo(e)||BR(e);return r&&i}async function Y3(t,e,r,i){if(Bl())return cR(i);if(Array.isArray(t)){for(const{source:s,dest:n,geographicTransformation:o}of t)if(s&&n&&!gn(s,n,o))return Vl(i)}else if(t&&e&&!gn(t,e,r))return Vl(i);return cR(i)}function N1(t,e,r){return t?"x"in t?kU(t,e,new ge,r,0):"xmin"in t?zU(t,e,new Le,r,0):"rings"in t?DU(t,e,new yt,r,0):"paths"in t?NU(t,e,new er,r,0):"points"in t?OU(t,e,new Bn,r,0):null:null}function coe(t,e,r=e.spatialReference,i=0){return r!=null&&t.spatialReference!=null&&kU(t,t.spatialReference,e,r,i)!=null}function kU(t,e,r,i,s){mi[0]=t.x,mi[1]=t.y;const n=t.z;return mi[2]=n!==void 0?n:s,Cv(mi,e,0,mi,i,0)?(r.x=mi[0],r.y=mi[1],r.spatialReference=i,n!==void 0||ac(i)?(r.z=mi[2],r.hasZ=!0):(r.z=void 0,r.hasZ=!1),t.m===void 0?(r.m=void 0,r.hasM=!1):(r.m=t.m,r.hasM=!0),r):null}function hoe(t,e,r=e.spatialReference,i=0){return t.spatialReference!=null&&r!=null&&OU(t,t.spatialReference,e,r,i)!=null}function OU(t,e,r,i,s){const{points:n,hasZ:o,hasM:a}=t,l=[],u=n.length,h=[];for(const m of n)h.push(m[0],m[1],o?m[2]:s);if(!Cv(h,e,0,h,i,0,u))return null;const p=o||ac(i);for(let m=0;m<u;++m){const y=3*m,g=h[y],v=h[y+1];p&&a?l.push([g,v,h[y+2],n[m][3]]):p?l.push([g,v,h[y+2]]):a?l.push([g,v,n[m][2]]):l.push([g,v])}return r.points=l,r.spatialReference=i,r.hasZ=o,r.hasM=a,r}function doe(t,e,r=e.spatialReference,i=0){return t.spatialReference!=null&&r!=null&&NU(t,t.spatialReference,e,r,i)!=null}function NU(t,e,r,i,s){const{paths:n,hasZ:o,hasM:a}=t,l=[];if(!VU(n,o??!1,a??!1,e,l,i,s))return null;const u=o||ac(i);return r.paths=l,r.spatialReference=i,r.hasZ=u,r.hasM=a,r}function FU(t,e,r=e.spatialReference,i=0){return t.spatialReference!=null&&r!=null&&DU(t,t.spatialReference,e,r,i)!=null}function DU(t,e,r,i,s){const{rings:n,hasZ:o,hasM:a}=t,l=[];if(!VU(n,o??!1,a??!1,e,l,i,s))return null;const u=o||ac(i);return r.rings=l,r.spatialReference=i,r.hasZ=u,r.hasM=a,r}function poe(t,e,r=e.spatialReference,i=0){return t.spatialReference!=null&&r!=null&&zU(t,t.spatialReference,e,r,i)!=null}function zU(t,e,r,i,s){const{xmin:n,ymin:o,xmax:a,ymax:l,hasZ:u,hasM:h}=t,p=u?t.zmin:s;if(!tO(n,o,p,e,mi,i))return null;const m=u||ac(i);r.xmin=mi[0],r.ymin=mi[1],m&&(r.zmin=mi[2]);const y=u?t.zmax:s;return tO(a,l,y,e,mi,i)?(r.xmax=mi[0],r.ymax=mi[1],m&&(r.zmax=mi[2]),h&&(r.mmin=t.mmin,r.mmax=t.mmax),r.spatialReference=i,r):null}function VU(t,e,r,i,s,n,o=0){const a=new Array;for(const h of t)for(const p of h)a.push(p[0],p[1],e?p[2]:o);if(!Cv(a,i,0,a,n,0))return!1;let l=0;s.length=0;const u=e||ac(n);for(const h of t){const p=new Array;for(const m of h)u&&r?p.push([a[l++],a[l++],a[l++],m[3]]):u?p.push([a[l++],a[l++],a[l++]]):r?(p.push([a[l++],a[l++],m[2]]),l++):(p.push([a[l++],a[l++]]),l++);s.push(p)}return!0}const mi=_c(),Zke=Object.freeze(Object.defineProperty({__proto__:null,canProjectWithoutEngine:gn,getTransformation:LU,getTransformations:ooe,initializeProjection:Y3,isEqualBaseGCS:uoe,isLoaded:Bl,isLoadedOrLoad:CU,isLoadedOrLoadFor:PU,load:Vl,project:bc,projectExtent:poe,projectMany:MT,projectMultipoint:hoe,projectOrLoad:noe,projectOrLoadMany:AU,projectPoint:coe,projectPolygon:FU,projectPolyline:doe,projectWithZConversion:RU,projectWithoutEngine:N1,requiresLoad:soe,test:loe,tryProjectWithZConversion:O0,unload:aoe},Symbol.toStringTag,{value:"Module"}));var F1;let TT=F1=class extends W.JSONSupportMixin(se.ofType(yt)){constructor(t){super(t)}clone(){return new F1(this.items.map((t=>t.clone())))}write(t,e){return this.toJSON(e)}toJSON(t){const e=t?.layer?.spatialReference;return e?this.toArray().map((r=>{if(!e.equals(r.spatialReference)){if(!gn(r.spatialReference,e))return t?.messages?.push(new Fs("scenefilter:unsupported","Scene filters with incompatible spatial references are not supported",{modification:this,spatialReference:t.layer.spatialReference,context:t})),null;const s=new yt;FU(r,s,e),r=s}const i=r.toJSON(t);return delete i.spatialReference,i})).filter((r=>r!=null)):this.toArray().map((r=>r.toJSON(t)))}static fromJSON(t,e){const r=new F1;return t.forEach((i=>r.add(yt.fromJSON(i,e)))),r}};TT=F1=c([C("esri.layers.support.PolygonCollection")],TT);const t0=TT;let Za=class extends W.JSONSupportMixin(Ce){constructor(e){super(e),this.id=`focusarea-${jm()}`,this.title=null,this.enabled=!0,this.outline=null,this.geometries=new t0}readGeometries(e,r,i){Array.isArray(e)?this.geometries=t0.fromJSON(e,i):i.hooks?.onAfterLoad?.((()=>this._loadGeometries(Fl(e,i),i)))}async _loadGeometries(e,r){const i=await et(e,{responseType:"json"});this.geometries=t0.fromJSON(i.data,r)}};c([d({type:String,nonNullable:!0,json:{write:!0,origins:{"web-scene":{write:{isRequired:!0}}}}}),d()],Za.prototype,"id",void 0),c([d({type:String,json:{write:!0}})],Za.prototype,"title",void 0),c([d({type:Boolean,nonNullable:!0,json:{write:!0,origins:{"web-scene":{write:{isRequired:!0}}}}})],Za.prototype,"enabled",void 0),c([d({type:Bse,json:{write:!0}})],Za.prototype,"outline",void 0),c([d({type:t0,nonNullable:!0,json:{write:!0,origins:{"web-scene":{write:{isRequired:!0}}}},clonable:t=>new t0(t.items.map((e=>e.clone())))}),Fse({origins:["web-scene","portal-item"],type:"resource",prefix:"geometries",contentAddressed:!0})],Za.prototype,"geometries",void 0),c([K(["web-scene","portal-item"],"geometries")],Za.prototype,"readGeometries",null),Za=c([C("esri.effects.FocusArea")],Za);const foe=Za;let Xy=class extends W.JSONSupportMixin(Ce){constructor(e){super(e),this.areas=new se,this.style="bright"}};c([d({type:se.ofType(foe),nonNullable:!0,json:{write:!0,origins:{"web-scene":{write:{isRequired:!0}}}},clonable:t=>new se(t.items.map((e=>e.clone())))})],Xy.prototype,"areas",void 0),c([d({type:["bright","dark"],nonNullable:!0,json:{write:!0}})],Xy.prototype,"style",void 0),Xy=c([C("esri.effects.FocusAreas")],Xy);const jU=Xy;function moe(t){return typeof t=="object"&&t!=null&&"loaded"in t&&t.loaded===!0&&"type"in t}function yoe(t){return!(!moe(t)||!tse(t)?.operations?.supportsEditing||"editingEnabled"in t&&!ise(t)||L8(t))}const goe=/^-?(\d+(\.\d+)?)\s*((px)|(pt))?$/i,voe="screenUtils.toPt: input not recognized!",UU=96;function Fe(t){return t?t/72*UU:0}function tt(t){return t?72*t/UU:0}function Be(t){if(typeof t=="string"){const e=t.match(goe);if(e){const r=Number(e[1]),i=e[3]&&e[3].toLowerCase(),s=t.charAt(0)==="-",n=i==="px"?tt(r):r;return s?-n:n}return console.warn(voe),null}return t}function or(t=0,e=0){return{x:t,y:e}}function Xke(t){return t?or(t.x,t.y):null}function Kke(t=0,e=0){return[t,e]}function Qke(t=0,e=0,r=0){return[t,e,r]}function eOe(t){return t}function tOe(t){return t}function rOe(t){return t}function iOe(t,e){return e?(e[0]=t.x,e[1]=t.y,e.length>2&&(e[2]=0),e):[t.x,t.y]}function m2(){const t=new Float32Array(16);return t[0]=1,t[5]=1,t[10]=1,t[15]=1,t}function _oe(t){const e=new Float32Array(16);return e[0]=t[0],e[1]=t[1],e[2]=t[2],e[3]=t[3],e[4]=t[4],e[5]=t[5],e[6]=t[6],e[7]=t[7],e[8]=t[8],e[9]=t[9],e[10]=t[10],e[11]=t[11],e[12]=t[12],e[13]=t[13],e[14]=t[14],e[15]=t[15],e}function boe(t,e,r,i,s,n,o,a,l,u,h,p,m,y,g,v){const _=new Float32Array(16);return _[0]=t,_[1]=e,_[2]=r,_[3]=i,_[4]=s,_[5]=n,_[6]=o,_[7]=a,_[8]=l,_[9]=u,_[10]=h,_[11]=p,_[12]=m,_[13]=y,_[14]=g,_[15]=v,_}const woe=m2();Object.freeze(Object.defineProperty({__proto__:null,IDENTITY:woe,clone:_oe,create:m2,fromValues:boe},Symbol.toStringTag,{value:"Module"}));let X3=1e-6;function Gi(){return X3}function Soe(t){X3=t}const y2=Math.random,xoe=Math.PI/180,$oe=180/Math.PI;function K3(t){return t*xoe}function Moe(t){return t*$oe}function Toe(t,e){return Math.abs(t-e)<=X3*Math.max(1,Math.abs(t),Math.abs(e))}Object.freeze(Object.defineProperty({__proto__:null,RANDOM:y2,equals:Toe,getEpsilon:Gi,setEpsilon:Soe,toDegree:Moe,toRadian:K3},Symbol.toStringTag,{value:"Module"}));function GU(t,e){return t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3],t[4]=e[4],t[5]=e[5],t[6]=e[6],t[7]=e[7],t[8]=e[8],t[9]=e[9],t[10]=e[10],t[11]=e[11],t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15],t}function wc(t,e,r,i,s,n,o,a,l,u,h,p,m,y,g,v,_){return t[0]=e,t[1]=r,t[2]=i,t[3]=s,t[4]=n,t[5]=o,t[6]=a,t[7]=l,t[8]=u,t[9]=h,t[10]=p,t[11]=m,t[12]=y,t[13]=g,t[14]=v,t[15]=_,t}function g2(t){return t[0]=1,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=1,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[10]=1,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,t}function Sc(t,e){if(t===e){const r=e[1],i=e[2],s=e[3],n=e[6],o=e[7],a=e[11];t[1]=e[4],t[2]=e[8],t[3]=e[12],t[4]=r,t[6]=e[9],t[7]=e[13],t[8]=i,t[9]=n,t[11]=e[14],t[12]=s,t[13]=o,t[14]=a}else t[0]=e[0],t[1]=e[4],t[2]=e[8],t[3]=e[12],t[4]=e[1],t[5]=e[5],t[6]=e[9],t[7]=e[13],t[8]=e[2],t[9]=e[6],t[10]=e[10],t[11]=e[14],t[12]=e[3],t[13]=e[7],t[14]=e[11],t[15]=e[15];return t}function Eoe(t,e){return BU(t,e)||g2(t),t}function BU(t,e){const r=e[0],i=e[1],s=e[2],n=e[3],o=e[4],a=e[5],l=e[6],u=e[7],h=e[8],p=e[9],m=e[10],y=e[11],g=e[12],v=e[13],_=e[14],b=e[15],S=r*a-i*o,$=r*l-s*o,T=r*u-n*o,I=i*l-s*a,P=i*u-n*a,R=s*u-n*l,D=h*v-p*g,V=h*_-m*g,U=h*b-y*g,Z=p*_-m*v,X=p*b-y*v,le=m*b-y*_;let ee=S*le-$*X+T*Z+I*U-P*V+R*D;return ee?(ee=1/ee,t[0]=(a*le-l*X+u*Z)*ee,t[1]=(s*X-i*le-n*Z)*ee,t[2]=(v*R-_*P+b*I)*ee,t[3]=(m*P-p*R-y*I)*ee,t[4]=(l*U-o*le-u*V)*ee,t[5]=(r*le-s*U+n*V)*ee,t[6]=(_*T-g*R-b*$)*ee,t[7]=(h*R-m*T+y*$)*ee,t[8]=(o*X-a*U+u*D)*ee,t[9]=(i*U-r*X-n*D)*ee,t[10]=(g*P-v*T+b*S)*ee,t[11]=(p*T-h*P-y*S)*ee,t[12]=(a*V-o*Z-l*D)*ee,t[13]=(r*Z-i*V+s*D)*ee,t[14]=(v*$-g*I-_*S)*ee,t[15]=(h*I-p*$+m*S)*ee,t):null}function Ioe(t,e){const r=e[0],i=e[1],s=e[2],n=e[3],o=e[4],a=e[5],l=e[6],u=e[7],h=e[8],p=e[9],m=e[10],y=e[11],g=e[12],v=e[13],_=e[14],b=e[15];return t[0]=a*(m*b-y*_)-p*(l*b-u*_)+v*(l*y-u*m),t[1]=-(i*(m*b-y*_)-p*(s*b-n*_)+v*(s*y-n*m)),t[2]=i*(l*b-u*_)-a*(s*b-n*_)+v*(s*u-n*l),t[3]=-(i*(l*y-u*m)-a*(s*y-n*m)+p*(s*u-n*l)),t[4]=-(o*(m*b-y*_)-h*(l*b-u*_)+g*(l*y-u*m)),t[5]=r*(m*b-y*_)-h*(s*b-n*_)+g*(s*y-n*m),t[6]=-(r*(l*b-u*_)-o*(s*b-n*_)+g*(s*u-n*l)),t[7]=r*(l*y-u*m)-o*(s*y-n*m)+h*(s*u-n*l),t[8]=o*(p*b-y*v)-h*(a*b-u*v)+g*(a*y-u*p),t[9]=-(r*(p*b-y*v)-h*(i*b-n*v)+g*(i*y-n*p)),t[10]=r*(a*b-u*v)-o*(i*b-n*v)+g*(i*u-n*a),t[11]=-(r*(a*y-u*p)-o*(i*y-n*p)+h*(i*u-n*a)),t[12]=-(o*(p*_-m*v)-h*(a*_-l*v)+g*(a*m-l*p)),t[13]=r*(p*_-m*v)-h*(i*_-s*v)+g*(i*m-s*p),t[14]=-(r*(a*_-l*v)-o*(i*_-s*v)+g*(i*l-s*a)),t[15]=r*(a*m-l*p)-o*(i*m-s*p)+h*(i*l-s*a),t}function Coe(t){const e=t[0],r=t[1],i=t[2],s=t[3],n=t[4],o=t[5],a=t[6],l=t[7],u=t[8],h=t[9],p=t[10],m=t[11],y=t[12],g=t[13],v=t[14],_=t[15];return(e*o-r*n)*(p*_-m*v)-(e*a-i*n)*(h*_-m*g)+(e*l-s*n)*(h*v-p*g)+(r*a-i*o)*(u*_-m*y)-(r*l-s*o)*(u*v-p*y)+(i*l-s*a)*(u*g-h*y)}function qU(t,e,r){const i=e[0],s=e[1],n=e[2],o=e[3],a=e[4],l=e[5],u=e[6],h=e[7],p=e[8],m=e[9],y=e[10],g=e[11],v=e[12],_=e[13],b=e[14],S=e[15];let $=r[0],T=r[1],I=r[2],P=r[3];return t[0]=$*i+T*a+I*p+P*v,t[1]=$*s+T*l+I*m+P*_,t[2]=$*n+T*u+I*y+P*b,t[3]=$*o+T*h+I*g+P*S,$=r[4],T=r[5],I=r[6],P=r[7],t[4]=$*i+T*a+I*p+P*v,t[5]=$*s+T*l+I*m+P*_,t[6]=$*n+T*u+I*y+P*b,t[7]=$*o+T*h+I*g+P*S,$=r[8],T=r[9],I=r[10],P=r[11],t[8]=$*i+T*a+I*p+P*v,t[9]=$*s+T*l+I*m+P*_,t[10]=$*n+T*u+I*y+P*b,t[11]=$*o+T*h+I*g+P*S,$=r[12],T=r[13],I=r[14],P=r[15],t[12]=$*i+T*a+I*p+P*v,t[13]=$*s+T*l+I*m+P*_,t[14]=$*n+T*u+I*y+P*b,t[15]=$*o+T*h+I*g+P*S,t}function Poe(t,e,r){const i=r[0],s=r[1],n=r[2];if(e===t)t[12]=e[0]*i+e[4]*s+e[8]*n+e[12],t[13]=e[1]*i+e[5]*s+e[9]*n+e[13],t[14]=e[2]*i+e[6]*s+e[10]*n+e[14],t[15]=e[3]*i+e[7]*s+e[11]*n+e[15];else{const o=e[0],a=e[1],l=e[2],u=e[3],h=e[4],p=e[5],m=e[6],y=e[7],g=e[8],v=e[9],_=e[10],b=e[11];t[0]=o,t[1]=a,t[2]=l,t[3]=u,t[4]=h,t[5]=p,t[6]=m,t[7]=y,t[8]=g,t[9]=v,t[10]=_,t[11]=b,t[12]=o*i+h*s+g*n+e[12],t[13]=a*i+p*s+v*n+e[13],t[14]=l*i+m*s+_*n+e[14],t[15]=u*i+y*s+b*n+e[15]}return t}function Aoe(t,e,r){const i=r[0],s=r[1],n=r[2];return t[0]=e[0]*i,t[1]=e[1]*i,t[2]=e[2]*i,t[3]=e[3]*i,t[4]=e[4]*s,t[5]=e[5]*s,t[6]=e[6]*s,t[7]=e[7]*s,t[8]=e[8]*n,t[9]=e[9]*n,t[10]=e[10]*n,t[11]=e[11]*n,t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15],t}function Loe(t,e,r,i){let s=i[0],n=i[1],o=i[2],a=Math.sqrt(s*s+n*n+o*o);if(a<=Gi())return void GU(t,e);a=1/a,s*=a,n*=a,o*=a;const l=Math.sin(r),u=Math.cos(r),h=1-u,p=e[0],m=e[1],y=e[2],g=e[3],v=e[4],_=e[5],b=e[6],S=e[7],$=e[8],T=e[9],I=e[10],P=e[11],R=s*s*h+u,D=n*s*h+o*l,V=o*s*h-n*l,U=s*n*h-o*l,Z=n*n*h+u,X=o*n*h+s*l,le=s*o*h+n*l,ee=n*o*h-s*l,ke=o*o*h+u;t[0]=p*R+v*D+$*V,t[1]=m*R+_*D+T*V,t[2]=y*R+b*D+I*V,t[3]=g*R+S*D+P*V,t[4]=p*U+v*Z+$*X,t[5]=m*U+_*Z+T*X,t[6]=y*U+b*Z+I*X,t[7]=g*U+S*Z+P*X,t[8]=p*le+v*ee+$*ke,t[9]=m*le+_*ee+T*ke,t[10]=y*le+b*ee+I*ke,t[11]=g*le+S*ee+P*ke,e!==t&&(t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15])}function Roe(t,e,r){const i=Math.sin(r),s=Math.cos(r),n=e[4],o=e[5],a=e[6],l=e[7],u=e[8],h=e[9],p=e[10],m=e[11];return e!==t&&(t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3],t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15]),t[4]=n*s+u*i,t[5]=o*s+h*i,t[6]=a*s+p*i,t[7]=l*s+m*i,t[8]=u*s-n*i,t[9]=h*s-o*i,t[10]=p*s-a*i,t[11]=m*s-l*i,t}function koe(t,e,r){const i=Math.sin(r),s=Math.cos(r),n=e[0],o=e[1],a=e[2],l=e[3],u=e[8],h=e[9],p=e[10],m=e[11];return e!==t&&(t[4]=e[4],t[5]=e[5],t[6]=e[6],t[7]=e[7],t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15]),t[0]=n*s-u*i,t[1]=o*s-h*i,t[2]=a*s-p*i,t[3]=l*s-m*i,t[8]=n*i+u*s,t[9]=o*i+h*s,t[10]=a*i+p*s,t[11]=l*i+m*s,t}function Ooe(t,e,r){const i=Math.sin(r),s=Math.cos(r),n=e[0],o=e[1],a=e[2],l=e[3],u=e[4],h=e[5],p=e[6],m=e[7];return e!==t&&(t[8]=e[8],t[9]=e[9],t[10]=e[10],t[11]=e[11],t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15]),t[0]=n*s+u*i,t[1]=o*s+h*i,t[2]=a*s+p*i,t[3]=l*s+m*i,t[4]=u*s-n*i,t[5]=h*s-o*i,t[6]=p*s-a*i,t[7]=m*s-l*i,t}function Noe(t,e){return t[0]=1,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=1,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[10]=1,t[11]=0,t[12]=e[0],t[13]=e[1],t[14]=e[2],t[15]=1,t}function Foe(t,e){return t[0]=e[0],t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=e[1],t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[10]=e[2],t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,t}function Doe(t,e,r){if(e===0)return g2(t);let i=r[0],s=r[1],n=r[2],o=Math.sqrt(i*i+s*s+n*n);if(o<=Gi())return null;o=1/o,i*=o,s*=o,n*=o;const a=Math.sin(e),l=Math.cos(e),u=1-l;return t[0]=i*i*u+l,t[1]=s*i*u+n*a,t[2]=n*i*u-s*a,t[3]=0,t[4]=i*s*u-n*a,t[5]=s*s*u+l,t[6]=n*s*u+i*a,t[7]=0,t[8]=i*n*u+s*a,t[9]=s*n*u-i*a,t[10]=n*n*u+l,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,t}function zoe(t,e){const r=Math.sin(e),i=Math.cos(e);return t[0]=1,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=i,t[6]=r,t[7]=0,t[8]=0,t[9]=-r,t[10]=i,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,t}function Voe(t,e){const r=Math.sin(e),i=Math.cos(e);return t[0]=i,t[1]=0,t[2]=-r,t[3]=0,t[4]=0,t[5]=1,t[6]=0,t[7]=0,t[8]=r,t[9]=0,t[10]=i,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,t}function joe(t,e){const r=Math.sin(e),i=Math.cos(e);return t[0]=i,t[1]=r,t[2]=0,t[3]=0,t[4]=-r,t[5]=i,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[10]=1,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,t}function HU(t,e,r){const i=e[0],s=e[1],n=e[2],o=e[3],a=i+i,l=s+s,u=n+n,h=i*a,p=i*l,m=i*u,y=s*l,g=s*u,v=n*u,_=o*a,b=o*l,S=o*u;return t[0]=1-(y+v),t[1]=p+S,t[2]=m-b,t[3]=0,t[4]=p-S,t[5]=1-(h+v),t[6]=g+_,t[7]=0,t[8]=m+b,t[9]=g-_,t[10]=1-(h+y),t[11]=0,t[12]=r[0],t[13]=r[1],t[14]=r[2],t[15]=1,t}function Uoe(t,e){const r=Goe,i=-e[0],s=-e[1],n=-e[2],o=e[3],a=e[4],l=e[5],u=e[6],h=e[7],p=i*i+s*s+n*n+o*o;return p>0?(r[0]=2*(a*o+h*i+l*n-u*s)/p,r[1]=2*(l*o+h*s+u*i-a*n)/p,r[2]=2*(u*o+h*n+a*s-l*i)/p):(r[0]=2*(a*o+h*i+l*n-u*s),r[1]=2*(l*o+h*s+u*i-a*n),r[2]=2*(u*o+h*n+a*s-l*i)),HU(t,e,r),t}const Goe=_c();function Boe(t,e){return t[0]=e[12],t[1]=e[13],t[2]=e[14],t}function qoe(t,e){const r=e[0],i=e[1],s=e[2],n=e[4],o=e[5],a=e[6],l=e[8],u=e[9],h=e[10];return t[0]=Math.sqrt(r*r+i*i+s*s),t[1]=Math.sqrt(n*n+o*o+a*a),t[2]=Math.sqrt(l*l+u*u+h*h),t}function Hoe(t,e){const r=e[0]+e[5]+e[10];let i=0;return r>0?(i=2*Math.sqrt(r+1),t[3]=.25*i,t[0]=(e[6]-e[9])/i,t[1]=(e[8]-e[2])/i,t[2]=(e[1]-e[4])/i):e[0]>e[5]&&e[0]>e[10]?(i=2*Math.sqrt(1+e[0]-e[5]-e[10]),t[3]=(e[6]-e[9])/i,t[0]=.25*i,t[1]=(e[1]+e[4])/i,t[2]=(e[8]+e[2])/i):e[5]>e[10]?(i=2*Math.sqrt(1+e[5]-e[0]-e[10]),t[3]=(e[8]-e[2])/i,t[0]=(e[1]+e[4])/i,t[1]=.25*i,t[2]=(e[6]+e[9])/i):(i=2*Math.sqrt(1+e[10]-e[0]-e[5]),t[3]=(e[1]-e[4])/i,t[0]=(e[8]+e[2])/i,t[1]=(e[6]+e[9])/i,t[2]=.25*i),t}function Woe(t,e,r,i){const s=e[0],n=e[1],o=e[2],a=e[3],l=s+s,u=n+n,h=o+o,p=s*l,m=s*u,y=s*h,g=n*u,v=n*h,_=o*h,b=a*l,S=a*u,$=a*h,T=i[0],I=i[1],P=i[2];return t[0]=(1-(g+_))*T,t[1]=(m+$)*T,t[2]=(y-S)*T,t[3]=0,t[4]=(m-$)*I,t[5]=(1-(p+_))*I,t[6]=(v+b)*I,t[7]=0,t[8]=(y+S)*P,t[9]=(v-b)*P,t[10]=(1-(p+g))*P,t[11]=0,t[12]=r[0],t[13]=r[1],t[14]=r[2],t[15]=1,t}function Zoe(t,e,r,i,s){const n=e[0],o=e[1],a=e[2],l=e[3],u=n+n,h=o+o,p=a+a,m=n*u,y=n*h,g=n*p,v=o*h,_=o*p,b=a*p,S=l*u,$=l*h,T=l*p,I=i[0],P=i[1],R=i[2],D=s[0],V=s[1],U=s[2],Z=(1-(v+b))*I,X=(y+T)*I,le=(g-$)*I,ee=(y-T)*P,ke=(1-(m+b))*P,Ze=(_+S)*P,it=(g+$)*R,ze=(_-S)*R,zt=(1-(m+v))*R;return t[0]=Z,t[1]=X,t[2]=le,t[3]=0,t[4]=ee,t[5]=ke,t[6]=Ze,t[7]=0,t[8]=it,t[9]=ze,t[10]=zt,t[11]=0,t[12]=r[0]+D-(Z*D+ee*V+it*U),t[13]=r[1]+V-(X*D+ke*V+ze*U),t[14]=r[2]+U-(le*D+Ze*V+zt*U),t[15]=1,t}function Joe(t,e){const r=e[0],i=e[1],s=e[2],n=e[3],o=r+r,a=i+i,l=s+s,u=r*o,h=i*o,p=i*a,m=s*o,y=s*a,g=s*l,v=n*o,_=n*a,b=n*l;return t[0]=1-p-g,t[1]=h+b,t[2]=m-_,t[3]=0,t[4]=h-b,t[5]=1-u-g,t[6]=y+v,t[7]=0,t[8]=m+_,t[9]=y-v,t[10]=1-u-p,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,t}function Yoe(t,e,r,i,s,n,o){const a=1/(r-e),l=1/(s-i),u=1/(n-o);return t[0]=2*n*a,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=2*n*l,t[6]=0,t[7]=0,t[8]=(r+e)*a,t[9]=(s+i)*l,t[10]=(o+n)*u,t[11]=-1,t[12]=0,t[13]=0,t[14]=o*n*2*u,t[15]=0,t}function Xoe(t,e,r,i,s){const n=1/Math.tan(e/2);let o;return t[0]=n/r,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=n,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[11]=-1,t[12]=0,t[13]=0,t[15]=0,s!=null&&s!==1/0?(o=1/(i-s),t[10]=(s+i)*o,t[14]=2*s*i*o):(t[10]=-1,t[14]=-2*i),t}function Koe(t,e,r,i){const s=Math.tan(e.upDegrees*Math.PI/180),n=Math.tan(e.downDegrees*Math.PI/180),o=Math.tan(e.leftDegrees*Math.PI/180),a=Math.tan(e.rightDegrees*Math.PI/180),l=2/(o+a),u=2/(s+n);return t[0]=l,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=u,t[6]=0,t[7]=0,t[8]=-(o-a)*l*.5,t[9]=(s-n)*u*.5,t[10]=i/(r-i),t[11]=-1,t[12]=0,t[13]=0,t[14]=i*r/(r-i),t[15]=0,t}function Qoe(t,e,r,i,s,n,o){const a=1/(e-r),l=1/(i-s),u=1/(n-o);return t[0]=-2*a,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=-2*l,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[10]=2*u,t[11]=0,t[12]=(e+r)*a,t[13]=(s+i)*l,t[14]=(o+n)*u,t[15]=1,t}function eae(t,e,r,i){const s=e[0],n=e[1],o=e[2];let a=s-r[0],l=n-r[1],u=o-r[2];const h=Gi();if(Math.abs(a)<h&&Math.abs(l)<h&&Math.abs(u)<h)return void g2(t);let p=1/Math.sqrt(a*a+l*l+u*u);a*=p,l*=p,u*=p;const m=i[0],y=i[1],g=i[2];let v=y*u-g*l,_=g*a-m*u,b=m*l-y*a;p=Math.sqrt(v*v+_*_+b*b),p?(p=1/p,v*=p,_*=p,b*=p):(v=0,_=0,b=0);let S=l*b-u*_,$=u*v-a*b,T=a*_-l*v;p=Math.sqrt(S*S+$*$+T*T),p?(p=1/p,S*=p,$*=p,T*=p):(S=0,$=0,T=0),t[0]=v,t[1]=S,t[2]=a,t[3]=0,t[4]=_,t[5]=$,t[6]=l,t[7]=0,t[8]=b,t[9]=T,t[10]=u,t[11]=0,t[12]=-(v*s+_*n+b*o),t[13]=-(S*s+$*n+T*o),t[14]=-(a*s+l*n+u*o),t[15]=1}function tae(t,e,r,i){const s=e[0],n=e[1],o=e[2],a=i[0],l=i[1],u=i[2];let h=s-r[0],p=n-r[1],m=o-r[2],y=h*h+p*p+m*m;y>0&&(y=1/Math.sqrt(y),h*=y,p*=y,m*=y);let g=l*m-u*p,v=u*h-a*m,_=a*p-l*h;return y=g*g+v*v+_*_,y>0&&(y=1/Math.sqrt(y),g*=y,v*=y,_*=y),t[0]=g,t[1]=v,t[2]=_,t[3]=0,t[4]=p*_-m*v,t[5]=m*g-h*_,t[6]=h*v-p*g,t[7]=0,t[8]=h,t[9]=p,t[10]=m,t[11]=0,t[12]=s,t[13]=n,t[14]=o,t[15]=1,t}function rae(t){return"mat4("+t[0]+", "+t[1]+", "+t[2]+", "+t[3]+", "+t[4]+", "+t[5]+", "+t[6]+", "+t[7]+", "+t[8]+", "+t[9]+", "+t[10]+", "+t[11]+", "+t[12]+", "+t[13]+", "+t[14]+", "+t[15]+")"}function iae(t){return Math.sqrt(t[0]**2+t[1]**2+t[2]**2+t[3]**2+t[4]**2+t[5]**2+t[6]**2+t[7]**2+t[8]**2+t[9]**2+t[10]**2+t[11]**2+t[12]**2+t[13]**2+t[14]**2+t[15]**2)}function sae(t,e,r){return t[0]=e[0]+r[0],t[1]=e[1]+r[1],t[2]=e[2]+r[2],t[3]=e[3]+r[3],t[4]=e[4]+r[4],t[5]=e[5]+r[5],t[6]=e[6]+r[6],t[7]=e[7]+r[7],t[8]=e[8]+r[8],t[9]=e[9]+r[9],t[10]=e[10]+r[10],t[11]=e[11]+r[11],t[12]=e[12]+r[12],t[13]=e[13]+r[13],t[14]=e[14]+r[14],t[15]=e[15]+r[15],t}function WU(t,e,r){return t[0]=e[0]-r[0],t[1]=e[1]-r[1],t[2]=e[2]-r[2],t[3]=e[3]-r[3],t[4]=e[4]-r[4],t[5]=e[5]-r[5],t[6]=e[6]-r[6],t[7]=e[7]-r[7],t[8]=e[8]-r[8],t[9]=e[9]-r[9],t[10]=e[10]-r[10],t[11]=e[11]-r[11],t[12]=e[12]-r[12],t[13]=e[13]-r[13],t[14]=e[14]-r[14],t[15]=e[15]-r[15],t}function nae(t,e,r){return t[0]=e[0]*r,t[1]=e[1]*r,t[2]=e[2]*r,t[3]=e[3]*r,t[4]=e[4]*r,t[5]=e[5]*r,t[6]=e[6]*r,t[7]=e[7]*r,t[8]=e[8]*r,t[9]=e[9]*r,t[10]=e[10]*r,t[11]=e[11]*r,t[12]=e[12]*r,t[13]=e[13]*r,t[14]=e[14]*r,t[15]=e[15]*r,t}function oae(t,e,r,i){return t[0]=e[0]+r[0]*i,t[1]=e[1]+r[1]*i,t[2]=e[2]+r[2]*i,t[3]=e[3]+r[3]*i,t[4]=e[4]+r[4]*i,t[5]=e[5]+r[5]*i,t[6]=e[6]+r[6]*i,t[7]=e[7]+r[7]*i,t[8]=e[8]+r[8]*i,t[9]=e[9]+r[9]*i,t[10]=e[10]+r[10]*i,t[11]=e[11]+r[11]*i,t[12]=e[12]+r[12]*i,t[13]=e[13]+r[13]*i,t[14]=e[14]+r[14]*i,t[15]=e[15]+r[15]*i,t}function aae(t,e){return t[0]===e[0]&&t[1]===e[1]&&t[2]===e[2]&&t[3]===e[3]&&t[4]===e[4]&&t[5]===e[5]&&t[6]===e[6]&&t[7]===e[7]&&t[8]===e[8]&&t[9]===e[9]&&t[10]===e[10]&&t[11]===e[11]&&t[12]===e[12]&&t[13]===e[13]&&t[14]===e[14]&&t[15]===e[15]}function lae(t,e){if(t===e)return!0;const r=t[0],i=t[1],s=t[2],n=t[3],o=t[4],a=t[5],l=t[6],u=t[7],h=t[8],p=t[9],m=t[10],y=t[11],g=t[12],v=t[13],_=t[14],b=t[15],S=e[0],$=e[1],T=e[2],I=e[3],P=e[4],R=e[5],D=e[6],V=e[7],U=e[8],Z=e[9],X=e[10],le=e[11],ee=e[12],ke=e[13],Ze=e[14],it=e[15],ze=Gi();return Math.abs(r-S)<=ze*Math.max(1,Math.abs(r),Math.abs(S))&&Math.abs(i-$)<=ze*Math.max(1,Math.abs(i),Math.abs($))&&Math.abs(s-T)<=ze*Math.max(1,Math.abs(s),Math.abs(T))&&Math.abs(n-I)<=ze*Math.max(1,Math.abs(n),Math.abs(I))&&Math.abs(o-P)<=ze*Math.max(1,Math.abs(o),Math.abs(P))&&Math.abs(a-R)<=ze*Math.max(1,Math.abs(a),Math.abs(R))&&Math.abs(l-D)<=ze*Math.max(1,Math.abs(l),Math.abs(D))&&Math.abs(u-V)<=ze*Math.max(1,Math.abs(u),Math.abs(V))&&Math.abs(h-U)<=ze*Math.max(1,Math.abs(h),Math.abs(U))&&Math.abs(p-Z)<=ze*Math.max(1,Math.abs(p),Math.abs(Z))&&Math.abs(m-X)<=ze*Math.max(1,Math.abs(m),Math.abs(X))&&Math.abs(y-le)<=ze*Math.max(1,Math.abs(y),Math.abs(le))&&Math.abs(g-ee)<=ze*Math.max(1,Math.abs(g),Math.abs(ee))&&Math.abs(v-ke)<=ze*Math.max(1,Math.abs(v),Math.abs(ke))&&Math.abs(_-Ze)<=ze*Math.max(1,Math.abs(_),Math.abs(Ze))&&Math.abs(b-it)<=ze*Math.max(1,Math.abs(b),Math.abs(it))}function uae(t){const e=Gi(),r=t[0],i=t[1],s=t[2],n=t[4],o=t[5],a=t[6],l=t[8],u=t[9],h=t[10];return Math.abs(1-(r*r+n*n+l*l))<=e&&Math.abs(1-(i*i+o*o+u*u))<=e&&Math.abs(1-(s*s+a*a+h*h))<=e}function cae(t){return t[0]===1&&t[1]===0&&t[2]===0&&t[4]===0&&t[5]===1&&t[6]===0&&t[8]===0&&t[9]===0&&t[10]===1}const hae=qU,dae=WU;Object.freeze(Object.defineProperty({__proto__:null,add:sae,adjoint:Ioe,copy:GU,determinant:Coe,equals:lae,exactEquals:aae,frob:iae,fromQuat:Joe,fromQuat2:Uoe,fromRotation:Doe,fromRotationTranslation:HU,fromRotationTranslationScale:Woe,fromRotationTranslationScaleOrigin:Zoe,fromScaling:Foe,fromTranslation:Noe,fromXRotation:zoe,fromYRotation:Voe,fromZRotation:joe,frustum:Yoe,getRotation:Hoe,getScale:qoe,getTranslation:Boe,hasIdentityRotation:cae,identity:g2,invert:BU,invertOrIdentity:Eoe,isOrthoNormal:uae,lookAt:eae,mul:hae,multiply:qU,multiplyScalar:nae,multiplyScalarAndAdd:oae,ortho:Qoe,perspective:Xoe,perspectiveFromFieldOfView:Koe,rotate:Loe,rotateX:Roe,rotateY:koe,rotateZ:Ooe,scale:Aoe,set:wc,str:rae,sub:dae,subtract:WU,targetTo:tae,translate:Poe,transpose:Sc},Symbol.toStringTag,{value:"Module"}));const pae=(t,e)=>{const r=wc(t,e,0,0,0,0,e,0,0,0,0,e,0,0,0,0,1);return Sc(r,r)},fae=(t,e)=>{const r=wc(t,e,0,0,.5-.5*e,0,e,0,.5-.5*e,0,0,e,.5-.5*e,0,0,0,1);return Sc(r,r)},mae=(t,e)=>{const r=1-e,i=wc(t,.2126+.7874*r,.7152-.7152*r,.0722-.0722*r,0,.2126-.2126*r,.7152+.2848*r,.0722-.0722*r,0,.2126-.2126*r,.7152-.7152*r,.0722+.9278*r,0,0,0,0,1);return Sc(i,i)},yae=(t,e)=>{const r=Math.sin(e*Math.PI/180),i=Math.cos(e*Math.PI/180),s=wc(t,.213+.787*i-.213*r,.715-.715*i-.715*r,.072-.072*i+.928*r,0,.213-.213*i+.143*r,.715+.285*i+.14*r,.072-.072*i-.283*r,0,.213-.213*i-.787*r,.715-.715*i+.715*r,.072+.928*i+.072*r,0,0,0,0,1);return Sc(s,s)},gae=(t,e)=>{const r=1-2*e,i=wc(t,r,0,0,e,0,r,0,e,0,0,r,e,0,0,0,1);return Sc(i,i)},vae=(t,e)=>{const r=wc(t,.213+.787*e,.715-.715*e,.072-.072*e,0,.213-.213*e,.715+.285*e,.072-.072*e,0,.213-.213*e,.715-.715*e,.072+.928*e,0,0,0,0,1);return Sc(r,r)},_ae=(t,e)=>{const r=1-e,i=wc(t,.393+.607*r,.769-.769*r,.189-.189*r,0,.349-.349*r,.686+.314*r,.168-.168*r,0,.272-.272*r,.534-.534*r,.131+.869*r,0,0,0,0,1);return Sc(i,i)};let ZU=class JU{constructor(e,r,i){this.strength=e,this.radius=r,this.threshold=i,this.type="bloom"}interpolate(e,r,i){this.strength=os(e.strength,r.strength,i),this.radius=os(e.radius,r.radius,i),this.threshold=os(e.threshold,r.threshold,i)}clone(){return new JU(this.strength,this.radius,this.threshold)}toJSON(){return{type:"bloom",radius:r0(this.radius),strength:this.strength,threshold:this.threshold}}},YU=class XU{constructor(e){this.radius=e,this.type="blur"}interpolate(e,r,i){this.radius=Math.round(os(e.radius,r.radius,i))}clone(){return new XU(this.radius)}toJSON(){return{type:"blur",radius:r0(this.radius)}}},ET=class KU{constructor(e,r){this.type=e,this.amount=r,this.type!=="invert"&&this.type!=="grayscale"&&this.type!=="sepia"||(this.amount=Math.min(this.amount,1))}get colorMatrix(){return this._colorMatrix||this._updateMatrix(),this._colorMatrix}interpolate(e,r,i){this.amount=os(e.amount,r.amount,i),this._updateMatrix()}clone(){return new KU(this.type,this.amount)}toJSON(){return{type:this.type,amount:this.amount}}_updateMatrix(){const e=this._colorMatrix||m2();switch(this.type){case"brightness":this._colorMatrix=pae(e,this.amount);break;case"contrast":this._colorMatrix=fae(e,this.amount);break;case"grayscale":this._colorMatrix=mae(e,this.amount);break;case"invert":this._colorMatrix=gae(e,this.amount);break;case"saturate":this._colorMatrix=vae(e,this.amount);break;case"sepia":this._colorMatrix=_ae(e,this.amount)}}},QU=class e9{constructor(e,r,i,s){this.offsetX=e,this.offsetY=r,this.blurRadius=i,this.color=s,this.type="drop-shadow"}interpolate(e,r,i){this.offsetX=os(e.offsetX,r.offsetX,i),this.offsetY=os(e.offsetY,r.offsetY,i),this.blurRadius=os(e.blurRadius,r.blurRadius,i),this.color[0]=Math.round(os(e.color[0],r.color[0],i)),this.color[1]=Math.round(os(e.color[1],r.color[1],i)),this.color[2]=Math.round(os(e.color[2],r.color[2],i)),this.color[3]=os(e.color[3],r.color[3],i)}clone(){return new e9(this.offsetX,this.offsetY,this.blurRadius,[...this.color])}toJSON(){const e=[...this.color];return e[3]*=255,{type:"drop-shadow",xoffset:r0(this.offsetX),yoffset:r0(this.offsetY),blurRadius:r0(this.blurRadius),color:e}}},t9=class r9{constructor(e){this.angle=e,this.type="hue-rotate"}get colorMatrix(){return this._colorMatrix||this._updateMatrix(),this._colorMatrix}interpolate(e,r,i){this.angle=os(e.angle,r.angle,i),this._updateMatrix()}clone(){return new r9(this.angle)}toJSON(){return{type:"hue-rotate",angle:this.angle}}_updateMatrix(){const e=this._colorMatrix||m2();this._colorMatrix=yae(e,this.angle)}},i9=class s9{constructor(e){this.amount=e,this.type="opacity",this.amount=Math.min(this.amount,1)}interpolate(e,r,i){this.amount=os(e.amount,r.amount,i)}clone(){return new s9(this.amount)}toJSON(){return{type:"opacity",amount:this.amount}}};function os(t,e,r){return t+(e-t)*r}function r0(t){return Math.round(1e3*tt(t))/1e3}function bae(t){switch(t.type){case"grayscale":case"sepia":case"invert":return new ET(t.type,0);case"saturate":case"brightness":case"contrast":return new ET(t.type,1);case"opacity":return new i9(1);case"hue-rotate":return new t9(0);case"blur":return new YU(0);case"drop-shadow":return new QU(0,0,0,[...V3("transparent")]);case"bloom":return new ZU(0,0,1)}}function n9(t,e){const r=t.length>e.length?t:e;return(t.length>e.length?e:t).every(((i,s)=>i.type===r[s].type))}function o9(t,e){const r=t.length>e.length?t:e,i=t.length>e.length?e:t;for(let s=i.length;s<r.length;s++)i.push(bae(r[s]))}function wae(t){const e=t[0];return!!e&&"type"in e}function Sae(t,e){return JSON.stringify(t??null)===JSON.stringify(e??null)}function sOe(t,e){return t.allLayerViews.find((i=>i.uid===e))?.layer.parent===t.map?.basemap}function xae(t){let e=null;const r=Mae(t),i=!r?.baseLayers.length;for(const s in cm){const n=Iae(r,a9(cm[s]),{mustMatchReferences:i});if(n==="equal"){e=s;break}n==="base-layers-equal"&&(e=s)}return e}function $ae(t,e){if(e==null||t==null)return{spatialReference:null,updating:!1};if(e.loadStatus==="not-loaded")return e.load(),{spatialReference:null,updating:!0};if(e.spatialReference)return{spatialReference:e.spatialReference,updating:!1};if(e.baseLayers.length===0)return{spatialReference:null,updating:!1};const r=e.baseLayers.at(0);switch(r.loadStatus){case"not-loaded":r.load();case"loading":return{spatialReference:null,updating:!0};case"failed":return{spatialReference:null,updating:!1}}const i=(("supportedSpatialReferences"in r?r.supportedSpatialReferences:null)||["tileInfo"in r?r.tileInfo?.spatialReference:r.spatialReference]).filter(Boolean),s=t.spatialReference;return s?{spatialReference:i.find((n=>s.equals(n)))??i[0]??null,updating:!1}:{spatialReference:i[0],updating:!1}}function Mae(t){return t?!t.loaded&&t.resourceInfo?a9(t.resourceInfo.data):{baseLayers:rO(t.baseLayers),referenceLayers:rO(t.referenceLayers)}:null}function rO(t){return(se.isCollection(t)?t.toArray():t).map(Tae)}function Tae(t){return{type:t.type,effect:"effect"in t?t.effect:void 0,url:l9("urlTemplate"in t&&t.urlTemplate||t.url||"styleUrl"in t&&t.styleUrl||""),minScale:"minScale"in t&&t.minScale!=null?t.minScale:0,maxScale:"maxScale"in t&&t.maxScale!=null?t.maxScale:0,opacity:t.opacity!=null?t.opacity:1,visible:t.visible==null||!!t.visible,sublayers:t.type!=="map-image"&&t.type!=="wms"||t.sublayers==null?void 0:t.sublayers?.map((e=>({id:e.id,visible:e.visible}))),activeLayerId:t.type==="wmts"?t.activeLayer?.id:void 0}}function iO(t){return t.isReference||t.layerType==="ArcGISSceneServiceLayer"}function a9(t){return t?{baseLayers:sO((t.baseMapLayers??[]).filter((e=>!iO(e)))),referenceLayers:sO((t.baseMapLayers??[]).filter((e=>iO(e))))}:null}function sO(t){return t.map((e=>Eae(e)))}function Eae(t){let e;switch(t.layerType){case"VectorTileLayer":e="vector-tile";break;case"ArcGISTiledMapServiceLayer":e="tile";break;case"ArcGISSceneServiceLayer":e="scene";break;default:e="unknown"}return{type:e,effect:t.effect,url:l9(t.templateUrl||t.urlTemplate||t.styleUrl||t.url),minScale:t.minScale??0,maxScale:t.maxScale??0,opacity:t.opacity??1,visible:t.visibility==null||!!t.visibility,sublayers:void 0,activeLayerId:void 0}}function Iae(t,e,r){return t!=null!=(e!=null)?"not-equal":!t||!e?"equal":nO(t.baseLayers,e.baseLayers)?nO(t.referenceLayers,e.referenceLayers)?"equal":r.mustMatchReferences?"not-equal":"base-layers-equal":"not-equal"}function nO(t,e){if(t.length!==e.length)return!1;for(let r=0;r<t.length;r++)if(!Cae(t[r],e[r]))return!1;return!0}function Cae(t,e){if(t.type!==e.type||t.url!==e.url||t.minScale!==e.minScale||t.maxScale!==e.maxScale||t.visible!==e.visible||t.opacity!==e.opacity||!Sae(t.effect,e.effect))return!1;if(t.activeLayerId!=null||e.activeLayerId!=null)return t.activeLayerId===e.activeLayerId;if(t.sublayers!=null||e.sublayers!=null){if(t.sublayers==null||e.sublayers==null||t.sublayers.length!==e.sublayers.length)return!1;for(let r=0;r<t.sublayers.length;r++){const i=t.sublayers.at(r),s=e.sublayers.at(r);if(i?.id!==s?.id||i?.visible!==s?.visible)return!1}}return!0}function l9(t){return t?fn(t).replace(/^\s*https?:/i,"").toLowerCase():""}function u9(t){if(!t)return null;const{thumbnailUrl:e}=t;if(e)return e;const r=xae(t);return r?cm[r].thumbnailUrl:Nz(t.baseLayers,Pae)}function Pae(t){return"portalItem"in t?t.portalItem?.thumbnailUrl:void 0}const Nx=()=>q.getLogger("esri.support.basemapUtils");function Aae(){return{}}function c9(t){for(const e in t){const r=t[e];At(r),delete t[e]}}function D1(t,e){let r;if(typeof t=="string"){const i=t in cm,s=!i&&t.includes("/");if(!i&&!s){if(bM())Nx().warn(`Unable to find basemap definition for: ${t}. See available styles at https://developers.arcgis.com/rest/basemap-styles/`);else{const n=Object.entries(cm).filter((([o,a])=>a.classic||a.is3d)).map((([o])=>`"${o}"`)).sort().join(", ");Nx().warn(`Unable to find basemap definition for: ${t}. Try one of these: ${n}`)}return null}e&&(r=e[t]),r||(r=i?Xg.fromId(t):new Xg({style:{id:t}}),e&&(e[t]=r))}else r=br(Xg,t);return r?.destroyed&&(Nx().warn("The provided basemap is already destroyed",{basemap:r}),r=null),r}function Lae(t){return new Vo({getCollections:()=>[t.tables,t.layers],getChildrenFunction:e=>{const r=[];return"tables"in e&&r.push(e.tables),"layers"in e&&r.push(e.layers),r},itemFilterFunction:e=>{const r=e.parent;return!!r&&"tables"in r&&r.tables.includes(e)}})}function Fx(t){for(const e of t.values())e?.destroy();t.clear()}const oO={"world-elevation":{id:"worldElevation",url:"//elevation3d.arcgis.com/arcgis/rest/services/WorldElevation3D/Terrain3D/ImageServer",layerType:"ArcGISTiledElevationServiceLayer"},"world-topobathymetry":{id:"worldTopoBathymetry",url:"//elevation3d.arcgis.com/arcgis/rest/services/WorldElevation3D/TopoBathy3D/ImageServer",layerType:"ArcGISTiledElevationServiceLayer"}};function Rae(t){let e=null;if(typeof t=="string")if(t in oO){const r=oO[t];e=new Mw({resourceInfo:{data:{layers:[r]}}})}else q.getLogger("esri.support.groundUtils").warn(`Unable to find ground definition for: ${t}. Try "world-elevation"`);else e=br(Mw,t);return e}let h9=0;const d9=t=>{let e=class extends t{constructor(...r){super(...r),Object.defineProperty(this,"uid",{writable:!1,configurable:!1,value:Date.now().toString(16)+"-object-"+h9++})}};return e=c([C("esri.core.Identifiable")],e),e},kae=t=>{let e=class extends t{constructor(...r){super(...r),Object.defineProperty(this,"uid",{writable:!1,configurable:!1,value:h9++})}};return e=c([C("esri.core.Identifiable.NumericIdentifiable")],e),e};let Ky=class extends d9(class{}){};Ky=c([C("esri.core.Identifiable")],Ky),(function(t){t.IdentifiableMixin=d9,t.NumericIdentifiableMixin=kae})(Ky||(Ky={}));const Pv=Ky;async function Oae(t){const e="portalItem"in t?t:{portalItem:t},{fromItem:r}=await J(async()=>{const{fromItem:i}=await import("./portalLayers-BbZcK54n.js");return{fromItem:i}},__vite__mapDeps([11,9,8,7,10]));try{return await r(e)}catch(i){const s=e?.portalItem,n=s?.id||"unset",o=s?.portal?.url||Ge.portalUrl;throw q.getLogger("esri.layers.support.fromPortalItem").error("#fromPortalItem()","Failed to create layer from portal item (portal: '"+o+"', id: '"+n+"')",i),i}}const IT={milliseconds:1,seconds:1e3,minutes:6e4,hours:36e5,days:864e5,weeks:6048e5,months:26784e5,years:31536e6,decades:31536e7,centuries:31536e8};function Dx(t,e,r,i=uo){const s=new ps(N3(i)),n=ue.fromJSDate(t,{zone:s}),o=r==="decades"||r==="centuries"?"year":f9(r);return r==="decades"&&(e*=10),r==="centuries"&&(e*=100),n.plus({[o]:e}).toJSDate()}function oOe(t,e,r="milliseconds"){const i=t.getTime(),s=p9(e,r,"milliseconds");return new Date(i+s)}function aO(t,e,r=uo){const i=new ps(N3(r)),s=ue.fromJSDate(t,{zone:i});if(e==="decades"||e==="centuries"){const o=s.startOf("year"),{year:a}=o,l=a-a%(e==="decades"?10:100);return o.set({year:l}).toJSDate()}const n=f9(e);return s.startOf(n).toJSDate()}function p9(t,e,r){return t===0?0:t*IT[e]/IT[r]}function aOe(t,e){return t&&e?t.intersection(e):t||e}function f9(t){switch(t){case"milliseconds":return"millisecond";case"seconds":return"second";case"minutes":return"minute";case"hours":return"hour";case"days":return"day";case"weeks":return"week";case"months":return"month";case"years":return"year"}}var js,Cf;let fr=(Cf=class extends W{static get allTime(){return lO}static get empty(){return Nae}static fromArray(e){return new js({start:e[0]!=null?new Date(e[0]):e[0],end:e[1]!=null?new Date(e[1]):e[1]})}constructor(e){super(e),this.end=null,this.start=null}readEnd(e,r){return r.end!=null?new Date(r.end):null}writeEnd(e,r){r.end=e?.getTime()??null}get isAllTime(){return this.equals(js.allTime)}get isEmpty(){return this.equals(js.empty)}readStart(e,r){return r.start!=null?new Date(r.start):null}writeStart(e,r){r.start=e?.getTime()??null}clone(){return new js({end:this.end,start:this.start})}equals(e){if(!e)return!1;const r=this.start?.getTime()??this.start,i=this.end?.getTime()??this.end,s=e.start?.getTime()??e.start,n=e.end?.getTime()??e.end;return r===s&&i===n}expandTo(e,r=uo){if(this.isEmpty||this.isAllTime)return this.clone();let i=this.start;i&&(i=aO(i,e,r));let s=this.end;if(s){const n=aO(s,e,r);s=s.getTime()===n.getTime()?n:Dx(n,1,e,r)}return new js({start:i,end:s})}intersection(e){if(!e)return this.clone();if(this.isEmpty||e.isEmpty)return js.empty;if(this.isAllTime)return e.clone();if(e.isAllTime)return this.clone();const r=this.start?.getTime()??-1/0,i=this.end?.getTime()??1/0,s=e.start?.getTime()??-1/0,n=e.end?.getTime()??1/0;let o,a;return s>=r&&s<=i?o=s:r>=s&&r<=n&&(o=r),i>=s&&i<=n?a=i:n>=r&&n<=i&&(a=n),o==null||a==null||isNaN(o)||isNaN(a)?js.empty:new js({start:o===-1/0?null:new Date(o),end:a===1/0?null:new Date(a)})}offset(e,r,i=uo){if(this.isEmpty||this.isAllTime)return this.clone();const s=new js,{start:n,end:o}=this;return n!=null&&(s.start=Dx(n,e,r,i)),o!=null&&(s.end=Dx(o,e,r,i)),s}toArray(){return this.isEmpty?[void 0,void 0]:[this.start?.getTime()??null,this.end?.getTime()??null]}union(e){if(!e||e.isEmpty)return this.clone();if(this.isEmpty)return e.clone();if(this.isAllTime||e.isAllTime)return lO.clone();const r=this.start!=null&&e.start!=null?new Date(Math.min(this.start.getTime(),e.start.getTime())):null,i=this.end!=null&&e.end!=null?new Date(Math.max(this.end.getTime(),e.end.getTime())):null;return new js({start:r,end:i})}},js=Cf,Cf);c([d({type:Date,json:{write:{allowNull:!0}}})],fr.prototype,"end",void 0),c([K("end")],fr.prototype,"readEnd",null),c([re("end")],fr.prototype,"writeEnd",null),c([d({readOnly:!0,json:{read:!1}})],fr.prototype,"isAllTime",null),c([d({readOnly:!0,json:{read:!1}})],fr.prototype,"isEmpty",null),c([d({type:Date,json:{write:{allowNull:!0}}})],fr.prototype,"start",void 0),c([K("start")],fr.prototype,"readStart",null),c([re("start")],fr.prototype,"writeStart",null),fr=js=c([C("esri.time.TimeExtent")],fr);const lO=new fr,Nae=new fr({start:void 0,end:void 0});let Fae=0,kt=class extends Ca.EventedMixin(Pv.IdentifiableMixin(Ls)){constructor(){super(...arguments),this.attributionDataUrl=null,this.fullExtent=new Le(-180,-90,180,90,ne.WGS84),this.id=Date.now().toString(16)+"-layer-"+Fae++,this.legendEnabled=!0,this.listMode="show",this.opacity=1,this.parent=null,this.persistenceEnabled=!1,this.popupEnabled=!0,this.attributionVisible=!0,this.spatialReference=ne.WGS84,this.title=null,this.type=null,this.url=null,this.visibilityTimeExtent=null,this.visible=!0}static async fromArcGISServerUrl(e){const r=typeof e=="string"?{url:e}:e;return(await J(async()=>{const{fromUrl:i}=await import("./arcgisLayers-DzG4O9sV.js");return{fromUrl:i}},__vite__mapDeps([14,9,8,10]))).fromUrl(r)}static fromPortalItem(e){return Oae(e)}initialize(){this.when().catch((e=>{xi(e)||q.getLogger(this).error("#load()",`Failed to load layer (title: '${this.title??"no title"}', id: '${this.id??"no id"}')`,{error:e})}))}destroy(){const e=this.parent;if(e){const r=this;"layers"in e&&e.layers.includes(r)?e.layers.remove(r):"tables"in e&&e.tables.includes(r)?e.tables.remove(r):"baseLayers"in e&&e.baseLayers.includes(r)?e.baseLayers.remove(r):"referenceLayers"in e&&e.referenceLayers.includes(r)&&e.referenceLayers.remove(r),this._set("parent",null)}}get effectiveVisible(){let e=this.visible;const r=this.parent;return e&&r&&"effectiveVisible"in r&&(e&&=r.effectiveVisible),e}get hasAttributionData(){return this.attributionDataUrl!=null}get parsedUrl(){return Pr(this.url)}createLayerView(e,r){return Promise.reject(new F("layer:create-layer-view","Layer does not support creating a layer view"))}async fetchAttributionData(){const e=this.attributionDataUrl;if(this.hasAttributionData&&e)return(await et(e,{query:{f:"json"},responseType:"json"})).data;throw new F("layer:no-attribution-data","Layer does not have attribution data")}};c([d({type:String})],kt.prototype,"attributionDataUrl",void 0),c([d({readOnly:!0})],kt.prototype,"effectiveVisible",null),c([d({type:Le})],kt.prototype,"fullExtent",void 0),c([d({readOnly:!0})],kt.prototype,"hasAttributionData",null),c([d({type:String,clonable:!1})],kt.prototype,"id",void 0),c([d({type:Boolean,nonNullable:!0})],kt.prototype,"legendEnabled",void 0),c([d({type:["show","hide","hide-children"]})],kt.prototype,"listMode",void 0),c([d({type:Number,range:{min:0,max:1},nonNullable:!0})],kt.prototype,"opacity",void 0),c([d({clonable:!1})],kt.prototype,"parent",void 0),c([d({readOnly:!0})],kt.prototype,"parsedUrl",null),c([d({type:Boolean,readOnly:!0})],kt.prototype,"persistenceEnabled",void 0),c([d({type:Boolean})],kt.prototype,"popupEnabled",void 0),c([d({type:Boolean})],kt.prototype,"attributionVisible",void 0),c([d({type:ne})],kt.prototype,"spatialReference",void 0),c([d({type:String})],kt.prototype,"title",void 0),c([d({readOnly:!0,json:{read:!1}})],kt.prototype,"type",void 0),c([d()],kt.prototype,"url",void 0),c([d({type:fr})],kt.prototype,"visibilityTimeExtent",void 0),c([d({type:Boolean,nonNullable:!0})],kt.prototype,"visible",void 0),kt=c([C("esri.layers.Layer")],kt);function CT(t,e,r){let i,s;if(t)for(let n=0,o=t.length;n<o;n++){if(i=t.at(n),i?.[e]===r)return i;if(i?.type==="group"&&(s=CT(i.layers,e,r),s))return s}}const Dae=t=>{let e=class extends t{constructor(...r){super(...r),this.layers=new se;const i=o=>{o.parent&&"remove"in o.parent&&o.parent.remove(o)},s=o=>{o.parent=this,this.layerAdded(o),o.type!=="elevation"&&o.type!=="base-elevation"||q.getLogger(this).error(`Layer 'title:${o.title}, id:${o.id}' of type '${o.type}' is not supported as an operational layer and will therefore be ignored.`)},n=o=>{o.parent=null,this.layerRemoved(o)};this.addHandles([this.layers.on("before-add",(o=>{if(o.item===this)return o.preventDefault(),void q.getLogger(this).error("#add()","Cannot add layer to itself.");i(o.item)})),this.layers.on("after-add",(o=>s(o.item))),this.layers.on("after-remove",(o=>n(o.item)))])}destroy(){const r=this.layers.toArray();for(const i of r)i.destroy();this.layers.destroy()}set layers(r){this._set("layers",zl(r,this._get("layers")))}add(r,i){const s=this.layers;if(i=s.getNextIndex(i),r instanceof kt){const n=r;n.parent===this?this.reorder(n,i):s.add(n,i)}else Ia(r)?r.then((n=>{this.destroyed||this.add(n,i)})):q.getLogger(this).error("#add()","The item being added is not a Layer or a Promise that resolves to a Layer.")}addMany(r,i){const s=this.layers;let n=s.getNextIndex(i);r.slice().forEach((o=>{o.parent!==this?(s.add(o,n),n+=1):this.reorder(o,n)}))}findLayerById(r){return CT(this.layers,"id",r)}findLayerByUid(r){return CT(this.layers,"uid",r)}remove(r){return this.layers.remove(r)}removeMany(r){return this.layers.removeMany(r)}removeAll(){return this.layers.removeAll()}reorder(r,i){return this.layers.reorder(r,i)}layerAdded(r){}layerRemoved(r){}};return c([d()],e.prototype,"layers",null),e=c([C("esri.support.LayersMixin")],e),e},zae=new Set(["feature","subtype-group"]);function PT(t,e,r){if(t)for(let i=0,s=t.length;i<s;i++){const n=t.at(i);if(n[e]===r)return n;if(n?.type==="group"){const o=PT(n.tables,e,r);if(o)return o}}}const Vae=t=>{let e=class extends t{constructor(...r){super(...r),this.tables=new se,this.addHandles([this.tables.on("after-add",(i=>{const s=i.item;s.parent&&s.parent!==this&&"tables"in s.parent&&s.parent.tables.remove(s),s.parent=this,zae.has(s.type)||q.getLogger(this).error(`Layer 'title:${s.title}, id:${s.id}' of type '${s.type}' is not supported as a table and will therefore be ignored.`)})),this.tables.on("after-remove",(i=>{i.item.parent=null}))])}destroy(){const r=this.tables.toArray();for(const i of r)i.destroy();this.tables.destroy()}set tables(r){this._set("tables",zl(r,this._get("tables")))}findTableById(r){return PT(this.tables,"id",r)}findTableByUid(r){return PT(this.tables,"uid",r)}};return c([d()],e.prototype,"tables",null),e=c([C("esri.support.TablesMixin")],e),e};let Us=class extends Vae(Dae(Ca.EventedMixin(ce))){constructor(e){super(e),this.allLayers=new Vo({getCollections:()=>[this.basemap?.baseLayers,this.ground?.layers,this.layers,this.basemap?.referenceLayers],getChildrenFunction:r=>"layers"in r?r.layers:null}),this.focusAreas=new jU,this.allTables=Lae(this),this.basemap=null,this.editableLayers=new Vo({getCollections:()=>[this.allLayers],itemFilterFunction:yoe}),this.ground=new Mw,this._basemapCache=Aae()}destroy(){c9(this._basemapCache),this._basemapCache=null,this.focusAreas.destroy(),this.allLayers.destroy(),this.allTables.destroy(),this.editableLayers.destroy(),this.basemap=At(this.basemap),At(this.ground),this._set("ground",null)}castBasemap(e){return D1(e,this._basemapCache)}castGround(e){return Rae(e)??this._get("ground")}findLayerById(e){return this.allLayers.find((r=>r.id===e))}findTableById(e){return this.allTables.find((r=>r.id===e))}};c([d({readOnly:!0,dependsOn:[]})],Us.prototype,"allLayers",void 0),c([d({type:jU,nonNullable:!0,json:{write:{overridePolicy:t=>({enabled:t.areas.length>0,ignoreOrigin:!0})}}})],Us.prototype,"focusAreas",void 0),c([d({readOnly:!0})],Us.prototype,"allTables",void 0),c([d({type:Xg,json:{read:{source:"baseMap"},write:{target:"baseMap"}}})],Us.prototype,"basemap",void 0),c([We("basemap")],Us.prototype,"castBasemap",null),c([d({readOnly:!0})],Us.prototype,"editableLayers",void 0),c([d({type:Mw,nonNullable:!0})],Us.prototype,"ground",void 0),c([We("ground")],Us.prototype,"castGround",null),c([d()],Us.prototype,"undoRedo",void 0),Us=c([C("esri.Map")],Us);const m9=Us;let Gc=class extends Ce{constructor(e){super(e),this.row=0,this.column=0,this.rows=1,this.columns=1}equals(e){return e!=null&&this.row===e.row&&this.rows===e.rows&&this.column===e.column&&this.columns===e.columns}};c([d({type:Number,nonNullable:!0,json:{read:!1,write:!1}})],Gc.prototype,"row",void 0),c([d({type:Number,nonNullable:!0,json:{read:!1,write:!1}})],Gc.prototype,"column",void 0),c([d({type:Number,nonNullable:!0,json:{read:!1,write:!1}})],Gc.prototype,"rows",void 0),c([d({type:Number,nonNullable:!0,json:{read:!1,write:!1}})],Gc.prototype,"columns",void 0),Gc=c([C("esri.CameraLayout")],Gc);const y9=Gc;let Q3=class{constructor(e,r){this.min=e,this.max=r,this.range=r-e}normalize(e,r=0,i=!1){return uO(this.range,this.min,this.max,e,r,i)}clamp(e,r=0){return $i(e-r,this.min,this.max)+r}monotonic(e,r,i){return e<r?r:r+AT(this.range,e-r,i)}minimalMonotonic(e,r,i){return uO(this.range,e,e+this.range,r,i)}center(e,r,i){return r=this.monotonic(e,r,i),this.normalize((e+r)/2,i)}diff(e,r,i){return this.monotonic(e,r,i)-e}shortestSignedDiff(e,r){e=this.normalize(e);const i=(r=this.normalize(r))-e,s=r<e?this.minimalMonotonic(e,r)-e:r-this.minimalMonotonic(r,e);return Math.abs(i)<Math.abs(s)?i:s}contains(e,r,i){return r=this.minimalMonotonic(e,r),(i=this.minimalMonotonic(e,i))>e&&i<r}};function uO(t,e,r,i,s=0,n=!1){return(i-=s)<e?i+=AT(t,e-i):i>r&&(i-=AT(t,i-r)),n&&i===r&&(i=e),i+s}function AT(t,e,r=0){return Math.ceil((e-r)/t)*t+r}const dOe=new Q3(0,2*Math.PI),pOe=new Q3(-Math.PI,Math.PI),jae=new Q3(0,360);let _o=class extends Ce.ClonableMixin(W){constructor(...e){super(...e),this.position=new ge([0,0,0]),this.heading=0,this.tilt=0,this.fov=55,this.layout=new y9}normalizeCtorArgs(e,r,i,s){if(e&&typeof e=="object"&&("x"in e||Array.isArray(e))){const n={position:e};return r!=null&&(n.heading=r),i!=null&&(n.tilt=i),s!=null&&(n.fov=s),n}return e}writePosition(e,r,i,s){const n=e.clone();n.x=Di(e.x||0),n.y=Di(e.y||0),n.z=e.hasZ?Di(e.z||0):e.z,r[i]=n.write({},s)}readPosition(e,r){const i=new ge;return i.read(e,r),i.x=Di(i.x||0),i.y=Di(i.y||0),i.z=i.hasZ?Di(i.z||0):i.z,i}equals(e){return e!=null&&this.tilt===e.tilt&&this.heading===e.heading&&this.fov===e.fov&&this.position.equals(e.position)&&this.layout.equals(e.layout)}};c([d({type:ge,json:{write:{isRequired:!0}}})],_o.prototype,"position",void 0),c([re("position")],_o.prototype,"writePosition",null),c([K("position")],_o.prototype,"readPosition",null),c([d({type:Number,nonNullable:!0,json:{write:{isRequired:!0}}}),We((t=>jae.normalize(Di(t))))],_o.prototype,"heading",void 0),c([d({type:Number,nonNullable:!0,json:{write:{isRequired:!0}}}),We((t=>$i(Di(t),-180,180)))],_o.prototype,"tilt",void 0),c([d({type:Number,nonNullable:!0,json:{default:55,write:!0}}),We((t=>$i(Di(t,55),1,170)))],_o.prototype,"fov",void 0),c([d({type:y9,nonNullable:!0,json:{read:!1,write:!1}})],_o.prototype,"layout",void 0),_o=c([C("esri.Camera")],_o);const Uae=_o;function Ni(t){return t.xmin!==void 0&&t.ymin!==void 0&&t.xmax!==void 0&&t.ymax!==void 0}function Mf(t){return t.points!==void 0}function N0(t){return t.x!==void 0&&t.y!==void 0}function ri(t){return t.paths!==void 0||t.curvePaths!==void 0}function rr(t){return t.rings!==void 0||t.curveRings!==void 0}function hc(t){return t==null?null:t instanceof Gr?t:N0(t)?ge.fromJSON(t):ri(t)?er.fromJSON(t):rr(t)?yt.fromJSON(t):Mf(t)?Bn.fromJSON(t):Ni(t)?Le.fromJSON(t):null}function v2(t){return t?N0(t)?"esriGeometryPoint":ri(t)?"esriGeometryPolyline":rr(t)?"esriGeometryPolygon":Ni(t)?"esriGeometryEnvelope":Mf(t)?"esriGeometryMultipoint":null:null}const Gae={esriGeometryPoint:ge,esriGeometryPolyline:er,esriGeometryPolygon:yt,esriGeometryEnvelope:Le,esriGeometryMultipoint:Bn,esriGeometryMultiPatch:yt};function Bae(t){return t&&Gae[t]||null}const qae=Wr()({esriGeometryPoint:"point",esriGeometryMultipoint:"multipoint",esriGeometryPolyline:"polyline",esriGeometryPolygon:"polygon"}),cO=Wr()({esriGeometryPoint:"point",esriGeometryMultipoint:"multipoint",esriGeometryPolyline:"polyline",esriGeometryPolygon:"polygon",esriGeometryEnvelope:"extent",mesh:"mesh"}),Av={base:Gr,key:"type",typeMap:{extent:Le,multipoint:Bn,point:ge,polyline:er,polygon:yt}};var LT;let hu=LT=class extends W{constructor(t){super(t),this.rotation=0,this.scale=0,this.targetGeometry=null,this.camera=null}castRotation(t){return(t%=360)<0&&(t+=360),t}clone(){return new LT({rotation:this.rotation,scale:this.scale,targetGeometry:this.targetGeometry!=null?this.targetGeometry.clone():null,camera:this.camera!=null?this.camera.clone():null})}};c([d({type:Number,json:{write:!0,origins:{"web-map":{default:0,write:!0},"web-scene":{write:{overridePolicy:zx}}}}})],hu.prototype,"rotation",void 0),c([We("rotation")],hu.prototype,"castRotation",null),c([d({type:Number,json:{write:!0,origins:{"web-map":{default:0,write:!0},"web-scene":{write:{overridePolicy:zx}}}}})],hu.prototype,"scale",void 0),c([d({types:Av,json:{read:hc,write:!0,origins:{"web-scene":{read:hc,write:{overridePolicy:zx}}}}})],hu.prototype,"targetGeometry",void 0),c([d({type:Uae,json:{write:!0,origins:{"web-scene":{write:{isRequired:!0}}}}})],hu.prototype,"camera",void 0),hu=LT=c([C("esri.Viewpoint")],hu);const mn=hu;function zx(){return{enabled:!this.camera}}let F0=class{constructor(e=r=>r.values().next().value){this._peeker=e,this._observable=new Sv,this._items=new Set}get length(){return we(this._observable),this._items.size}clear(){this.length!==0&&(this._items.clear(),this._observable.notify())}last(){if(this.length===0)return;let e;for(e of this._items);return e}peek(){if(this.length!==0)return this._peeker(this._items)}push(e){this.contains(e)||(this._items.add(e),this._observable.notify())}contains(e){return we(this._observable),this._items.has(e)}pop(){if(this.length===0)return;const e=this.peek();return this._items.delete(e),this._observable.notify(),e}popLast(){if(this.length===0)return;const e=this.last();return this._items.delete(e),this._observable.notify(),e}remove(e){this.contains(e)&&(this._items.delete(e),this._observable.notify())}filter(e){const r=this.length;return this._items.forEach((i=>{e(i)||this._items.delete(i)})),r!==this._items.size&&this._observable.notify(),this}*[Symbol.iterator](){we(this._observable),yield*this._items}};const g9=new FinalizationRegistry((t=>{t.close()}));function Hae(t,e){g9.register(t,e,e)}function Wae(t){g9.unregister(t)}function v9(t,e){return new Proxy({},{get:(r,i,s)=>(...n)=>{let o,a;const l=n[n.length-1];return Zae(l)&&(o=l.signal,a=l.transferList,n.pop()),t.apply(e?`${e}.${i.toString()}`:i.toString(),n,{transferList:a,signal:o})}})}function Zae(t){return typeof t=="object"&&!Array.isArray(t)&&t!=null&&("signal"in t||"transferList"in t||Object.keys(t).length===0)}const Jae={statsWorker:()=>J(()=>import("./statsWorker-qbB2PU6i.js"),__vite__mapDeps([15,16,17,18])),geometryEngineWorker:()=>J(()=>import("./geometryEngineWorker-BeElq9cK.js"),__vite__mapDeps([19,20,12,13,21])),arcadeGeometryOperatorsWorker:()=>J(()=>import("./operatorsWorker-BTF7Z8Ps.js"),[]),CSVSourceWorker:()=>J(()=>import("./CSVSourceWorker-D6O0cYRx.js"),__vite__mapDeps([22,23,21,24,25,26,27,28,29,30,31,32,33,16,17,18,34,35,36,37,38,39,40,41])),EdgeProcessingWorker:()=>J(()=>import("./EdgeProcessingWorker--nNGcbrG.js"),__vite__mapDeps([42,43,44,45,46,47,48,49,50,51,52,53])),ElevationSamplerWorker:()=>J(()=>import("./ElevationSamplerWorker-9eC-BDPF.js"),__vite__mapDeps([54,38,55,56,57,58,59,60,61,62,63,45,64])),FeatureServiceSnappingSourceWorker:()=>J(()=>import("./FeatureServiceSnappingSourceWorker-ytDD3ADU.js"),__vite__mapDeps([65,25,26,21,27,28,24,29,30,31,32,33,16,17,18,34,35,36,37,38,39,66,67,68,69,4])),GeoJSONSourceWorker:()=>J(()=>import("./GeoJSONSourceWorker-Cwbf_gOC.js"),__vite__mapDeps([70,28,24,29,25,26,21,27,30,31,32,33,16,17,18,34,35,36,37,38,39,71,23,41,72])),LercWorker:()=>J(()=>import("./LercWorker-DsfvyqqO.js"),[]),MemorySourceWorker:()=>J(()=>import("./MemorySourceWorker-CX-T8u_l.js"),__vite__mapDeps([73,28,24,29,74,25,26,21,27,30,31,32,33,16,17,18,34,35,36,37,38,39,41,72,23])),PBFDecoderWorker:()=>J(()=>import("./PBFDecoderWorker-CJLB6BXK.js"),__vite__mapDeps([75,76,28,24,29,67,68])),FeaturePipelineWorker:()=>J(()=>import("./FeaturePipelineWorker-DMR_O_w7.js"),__vite__mapDeps([77,78,79,52,80,81,26,21,32,28,24,29,82,83,84,85,86,87,88,39,27,30,31,33,16,17,18,34,35,89,90,91,92,69,67,68,93,71,23,41,72,94,95,96])),PointCloudWorker:()=>J(()=>import("./PointCloudWorker-C0__zR_Y.js"),__vite__mapDeps([97,98,57,99,100,101,102,50,103,58,59,60,104,105])),RasterWorker:()=>J(()=>import("./RasterWorker-ZVRVOhRv.js"),__vite__mapDeps([106,107,108,109,13,110,111,112,113])),SceneLayerSnappingSourceWorker:()=>J(()=>import("./SceneLayerSnappingSourceWorker-DO2SeHKH.js"),__vite__mapDeps([114,115,116,57,105,58,99,117,104,45,47,48,49,44,46,50,51,52,53])),SceneLayerWorker:()=>J(()=>import("./SceneLayerWorker-BE2fkfEp.js"),__vite__mapDeps([118,55,63,119,61,116,57,105,58,99,120,102,50,121,122,123,124,125,103,98,59,60,104])),WFSSourceWorker:()=>J(()=>import("./WFSSourceWorker-Ckk26Vi2.js"),__vite__mapDeps([126,28,24,29,25,26,21,27,30,31,32,33,16,17,18,34,35,36,37,38,39,71,23,72,127,128])),WorkerTileHandler:()=>J(()=>import("./WorkerTileHandler-nC5hIpyc.js"),__vite__mapDeps([129,130,131,132,68,86,133,134,52,87])),Lyr3DWorker:()=>J(()=>import("./Lyr3DWorker-DoEfLlhO.js"),[]),Feature3DPipelineWorker:()=>J(()=>import("./Feature3DPipelineWorker-Dc4-te33.js"),__vite__mapDeps([135,27,28,24,29,30,31,32,26,21,33,16,17,18,34,35,58,136,123,62,55,119,61,137,100,138,139,140,141,142,45,49,143,116,57,105,99,115,50,125,124,144,103,98,59,60,104,145,146,147,148,44,46,149,150,151,122,38,69,67,68])),TextureCompressionWorker:()=>J(()=>import("./TextureCompressionWorker-DfVjw9uT.js"),__vite__mapDeps([152,142]))},_9="worker:port-closed";var qr;(function(t){t[t.HANDSHAKE=0]="HANDSHAKE",t[t.OPEN=1]="OPEN",t[t.OPENED=2]="OPENED",t[t.RESPONSE=3]="RESPONSE",t[t.INVOKE=4]="INVOKE",t[t.ABORT=5]="ABORT",t[t.CLOSE=6]="CLOSE",t[t.OPEN_PORT=7]="OPEN_PORT",t[t.ON=8]="ON"})(qr||(qr={}));let Yae=0;function b9(){return Yae++}function Xae(t){return t&&typeof t=="object"&&("result"in t||"transferList"in t)}function D0(t){return t?typeof t=="string"?JSON.stringify({name:"message",message:t}):t.toJSON?JSON.stringify(t):JSON.stringify({name:t.name,message:t.message,details:t.details||{stack:t.stack}}):null}function eA(t,e,r,i){if(e.type===qr.OPEN_PORT)return void t.postMessage(e,[e.port]);if(e.type!==qr.INVOKE&&e.type!==qr.RESPONSE)return void t.postMessage(e);let s;if(Xae(r)?(s=hO(r.transferList),e.data=r.result):(s=hO(i),e.data=r),s){if(z("ff")){for(const n of s)if("byteLength"in n&&n.byteLength>267386880){const o="Worker call with large ArrayBuffer would crash Firefox";switch(e.type){case qr.INVOKE:throw o;case qr.RESPONSE:return void eA(t,{type:qr.RESPONSE,jobId:e.jobId,error:D0(o)})}}}t.postMessage(e,s)}else t.postMessage(e)}function z0(t){if(!t)return null;const e=t.data;return e?typeof e=="string"?JSON.parse(e):e:null}function hO(t){if(!t?.length)return null;if(z("esri-workers-arraybuffer-transfer"))return t;const e=t.filter((r=>!Kae(r)));return e.length?e:null}function Kae(t){return t instanceof ArrayBuffer||t?.constructor?.name==="ArrayBuffer"}async function yOe(t){try{return await t}catch(e){const r=e?.name===_9;if(!(xi(e)||r))throw e;return}}const{CLOSE:dO,ABORT:pO,INVOKE:fO,RESPONSE:hy,OPEN_PORT:mO,ON:Qae}=qr,ele=2;let tle=class{constructor(e){this._invoke=e,this._timer=null,this._cancelledJobIds=new Set,this._invokeMessages=[],this._timer=null,this._process=this._process.bind(this)}push(e){e.type===qr.ABORT?this._cancelledJobIds.add(e.jobId):(this._invokeMessages.push(e),this._timer===null&&(this._timer=setTimeout(this._process,0)))}clear(){this._invokeMessages.length=0,this._cancelledJobIds.clear(),this._timer=null}_process(){this._timer=null;for(const e of this._invokeMessages)this._cancelledJobIds.has(e.jobId)||this._invoke(e);this._cancelledJobIds.clear(),this._invokeMessages.length=0}};var tn;let ym=(tn=class{static connect(e,r){const i=new MessageChannel;let s;s=typeof e=="function"?new e:"default"in e&&typeof e.default=="function"?new e.default:e;const n=new tn(i.port1,{channel:i,client:s,schedule:r});return typeof s=="object"&&"remoteClient"in s&&(s.remoteClient=n),tn.clients.set(n,s),i.port2}static loadWorker(e){const r=Jae[e];return r?r():Promise.resolve(null)}constructor(e,r,i,s){this._port=e,this._jobQueue=i,this._lowPriorityJobQueue=s,this._outJobs=new Map,this._inJobs=new Map,this._invokeQueue=new tle((n=>this._onInvokeMessage(n))),this._client=r.client,this._onMessage=this._onMessage.bind(this),this._channel=r.channel,this._schedule=r.schedule,this._port.addEventListener("message",this._onMessage),this._port.start()}close(){this._post({type:dO}),this._close()}isBusy(){return this._outJobs.size>0}invoke(e,r,i){return this.apply(e,[r],i)}apply(e,r,i){const s=i?.signal,n=i?.transferList;if(!this._port)return Promise.reject(new F(_9,`Cannot call invoke('${e}'), port is closed`,{methodName:e,data:r}));const o=b9();return new Promise(((a,l)=>{if(yn(s))return this._processWork(),void l(St());const u=ao(s,(()=>{const p=this._outJobs.get(o);p&&(this._outJobs.delete(o),this._processWork(),Lt(p.abortHandle),this._post({type:pO,jobId:o}),l(St()))})),h={resolve:a,reject:l,abortHandle:u,debugInfo:e};this._outJobs.set(o,h),this._post({type:fO,jobId:o,methodName:e,abortable:s!=null},r,n)}))}createInvokeProxy(e){return v9(this,e)}on(e,r){const i=new MessageChannel;function s(n){r(n.data)}return this._port.postMessage({type:qr.ON,eventType:e,port:i.port2},[i.port2]),i.port1.addEventListener("message",s),i.port1.start(),He((()=>{i.port1.postMessage({type:qr.CLOSE}),i.port1.close(),i.port1.removeEventListener("message",s)}))}jobAdded(){this._processWork()}openPort(){const e=new MessageChannel;return this._post({type:mO,port:e.port2}),e.port1}_processWork(){if(this._outJobs.size>=ele)return;const e=this._jobQueue?.pop()??this._lowPriorityJobQueue?.pop();if(!e)return;const{methodName:r,data:i,invokeOptions:s,resolver:n}=e;this.apply(r,i,s).then((o=>n.resolve(o))).catch((o=>n.reject(o)))}_close(){this._channel&&(this._channel=void 0),this._port.removeEventListener("message",this._onMessage),this._port.close(),this._outJobs.forEach((e=>{Lt(e.abortHandle),e.reject(St(`Worker closing, aborting job calling '${e.debugInfo}'`))})),this._inJobs.clear(),this._outJobs.clear(),this._invokeQueue.clear(),this._port=null,this._client=null,this._schedule=null}_onMessage(e){this._schedule!=null?this._schedule((()=>this._processMessage(e,!0))):this._processMessage(e,!1)}_processMessage(e,r){const i=z0(e);if(i)switch(i.type){case hy:this._onResponseMessage(i);break;case fO:r?this._onInvokeMessage(i):this._invokeQueue.push(i);break;case pO:this._onAbortMessage(i);break;case dO:this._onCloseMessage();break;case mO:this._onOpenPortMessage(i);break;case Qae:this._onOnMessage(i)}}_onAbortMessage(e){const r=this._inJobs,i=e.jobId,s=r.get(i);this._invokeQueue.push(e),s&&(s.controller&&s.controller.abort(),r.delete(i))}_onCloseMessage(){const e=this._client;this._close(),e&&"destroy"in e&&tn.clients.get(this)===e&&e.destroy(),tn.clients.delete(this),e?.remoteClient&&(e.remoteClient=null)}_onInvokeMessage(e){const{methodName:r,jobId:i,data:s=[],abortable:n}=e,o=n?new AbortController:null,a=this._inJobs;let l,u=this._client,h=u[r];try{if(!h&&r&&r.includes(".")){const p=r.split(".");for(let m=0;m<p.length-1;m++)u=u[p[m]],h=u[p[m+1]]}if(typeof h!="function")throw new TypeError(`${r} is not a function`);s.push({client:this,signal:o?o.signal:null}),l=h.apply(u,s)}catch(p){return void this._post({type:hy,jobId:i,error:D0(p)})}Ia(l)?(a.set(i,{controller:o,promise:l}),l.then((p=>{a.has(i)&&(a.delete(i),this._post({type:hy,jobId:i},p))}),(p=>{a.has(i)&&(a.delete(i),xi(p)||this._post({type:hy,jobId:i,error:D0(p||{message:`Error encountered at method ${r}`})}))}))):this._post({type:hy,jobId:i},l)}_onOpenPortMessage(e){new tn(e.port,{client:this._client})}_onOnMessage(e){const{port:r}=e,i=this._client.on(e.eventType,(n=>{r.postMessage(n)})),s=Lm(e.port,"message",(n=>{z0(n)?.type===qr.CLOSE&&(s.remove(),i.remove(),r.close())}))}_onResponseMessage(e){const{jobId:r,error:i,data:s}=e,n=this._outJobs;if(!n.has(r))return;const o=n.get(r);n.delete(r),this._processWork(),Lt(o.abortHandle),i?o.reject(F.fromJSON(JSON.parse(i))):o.resolve(s)}_post(e,r,i){return eA(this._port,e,r,i)}},tn.kernelInfo={buildDate:Az,fullVersion:YP,revision:Lz},tn.clients=new Map,tn),rle=class{constructor(){this._inUseClients=new Array,this._clients=new Array,this._clientPromises=new Array,this._ongoingJobsQueue=new F0,this._ongoingLowPriorityJobsQueue=new F0}destroy(){this.close()}get closed(){return!this._clients?.length}open(e,r){return new Promise(((i,s)=>{let n=!0;const o=a=>{xt(r.signal),n&&(n=!1,a())};this._clients.length=e.length,this._clientPromises.length=e.length,this._inUseClients.length=e.length;for(let a=0;a<e.length;++a){const l=e[a];Ia(l)?this._clientPromises[a]=l.then((u=>(this._clients[a]=new ym(u,r,this._ongoingJobsQueue,this._ongoingLowPriorityJobsQueue),o(i),this._clients[a])),(()=>(o(s),null))):(this._clients[a]=new ym(l,r,this._ongoingJobsQueue,this._ongoingLowPriorityJobsQueue),this._clientPromises[a]=Promise.resolve(this._clients[a]),o(i))}}))}broadcast(e,r,i){const s=new Array(this._clientPromises.length);for(let n=0;n<this._clientPromises.length;++n){const o=this._clientPromises[n];s[n]=o.then((a=>a?.invoke(e,r,i)))}return s}close(){let e;for(;e=this._ongoingJobsQueue.pop();)e.resolver.reject(St(`Worker closing, aborting job calling '${e.methodName}'`));for(;e=this._ongoingLowPriorityJobsQueue.pop();)e.resolver.reject(St(`Worker closing, aborting job calling '${e.methodName}'`));for(const r of this._clientPromises)r.then((i=>i?.close()));this._clients.length=0,this._clientPromises.length=0,this._inUseClients.length=0,Wae(this)}invoke(e,r,i){return this.apply(e,[r],i)}apply(e,r,i){const s=Ns();(i?.priority==="low"?this._ongoingLowPriorityJobsQueue:this._ongoingJobsQueue).push({methodName:e,data:r,invokeOptions:i,resolver:s});for(let n=0;n<this._clientPromises.length;n++){const o=this._clients[n];o?o.jobAdded():this._clientPromises[n].then((a=>a?.jobAdded()))}return s.promise}createInvokeProxy(e){return v9(this,e)}on(e,r){return Promise.all(this._clientPromises).then((()=>$d(this._clients.map((i=>i.on(e,r))))))}openPorts(){return new Promise((e=>{const r=new Array(this._clientPromises.length);let i=r.length;for(let s=0;s<this._clientPromises.length;++s)this._clientPromises[s].then((n=>{n&&(r[s]=n.openPort()),--i===0&&e(r)}))}))}get test(){}};const ile={async request(t,e){const r=t.options,i=r.responseType;r.signal=e?.signal,r.responseType=i==="native"||i==="native-request-init"?"native-request-init":i&&["blob","json","text"].includes(i)&&pM(t.url)?.after?i:"array-buffer";const s=await et(t.url,r),n={data:s.data,httpStatus:s.httpStatus,ssl:s.ssl};switch(s.requestOptions?.responseType){case"native-request-init":return delete n.data.signal,n;case"blob":n.data=await n.data.arrayBuffer();break;case"json":n.data=new TextEncoder().encode(JSON.stringify(n.data)).buffer;break;case"text":n.data=new TextEncoder().encode(n.data).buffer}return{result:n,transferList:[n.data]}}},yO={};function sle(t){const e={async:t.async,isDebug:t.isDebug,locale:t.locale,baseUrl:t.baseUrl,has:{...t.has},map:{...t.map},packages:t.packages?.slice()||[],paths:{...yO.paths,...t.paths}};return t.hasOwnProperty("async")||(e.async=!0),t.hasOwnProperty("isDebug")||(e.isDebug=!1),t.baseUrl||(e.baseUrl=yO.baseUrl),e}let nle=class{constructor(){const e=document.createDocumentFragment();["addEventListener","dispatchEvent","removeEventListener"].forEach((r=>{this[r]=(...i)=>e[r](...i)}))}},z1=class{constructor(){this._dispatcher=new nle,this._workerPostMessage({type:qr.HANDSHAKE})}terminate(){}get onmessage(){return this._onmessageHandler}set onmessage(e){this._onmessageHandler&&this.removeEventListener("message",this._onmessageHandler),this._onmessageHandler=e,e&&this.addEventListener("message",e)}get onmessageerror(){return this._onmessageerrorHandler}set onmessageerror(e){this._onmessageerrorHandler&&this.removeEventListener("messageerror",this._onmessageerrorHandler),this._onmessageerrorHandler=e,e&&this.addEventListener("messageerror",e)}get onerror(){return this._onerrorHandler}set onerror(e){this._onerrorHandler&&this.removeEventListener("error",this._onerrorHandler),this._onerrorHandler=e,e&&this.addEventListener("error",e)}postMessage(e){Qb((()=>{this._workerMessageHandler(new MessageEvent("message",{data:e}))}))}dispatchEvent(e){return this._dispatcher.dispatchEvent(e)}addEventListener(e,r,i){this._dispatcher.addEventListener(e,r,i)}removeEventListener(e,r,i){this._dispatcher.removeEventListener(e,r,i)}_workerPostMessage(e){Qb((()=>{this.dispatchEvent(new MessageEvent("message",{data:e}))}))}async _workerMessageHandler(e){const r=z0(e);if(r&&r.type===qr.OPEN){const{modulePath:i,jobId:s}=r;let n=await ym.loadWorker(i);n||(n=await import(i));const o=ym.connect(n);this._workerPostMessage({type:qr.OPENED,jobId:s,data:o})}}};const RT=()=>q.getLogger("esri.core.workers.workerFactory"),{HANDSHAKE:ole}=qr,ale='let globalId=0;const outgoing=new Map,configuration={CONFIGURATION};self.esriConfig=configuration.esriConfig;const workerPath=self.esriConfig.workers.workerPath,HANDSHAKE=0,OPEN=1,OPENED=2,RESPONSE=3,INVOKE=4,ABORT=5;function createAbortError(){const e=new Error("Aborted");return e.name="AbortError",e}function receiveMessage(e){return e&&e.data?"string"==typeof e.data?JSON.parse(e.data):e.data:null}function invokeStaticMessage(e,o,r){const t=r&&r.signal,n=globalId++;let s=null;return new Promise(((r,i)=>{if(t){if(t.aborted)return i(createAbortError());s=()=>{outgoing.get(n)&&(outgoing.delete(n),self.postMessage({type:5,jobId:n}),i(createAbortError()))},t.addEventListener("abort",s)}outgoing.set(n,{resolve:r,reject:i}),self.postMessage({type:4,jobId:n,methodName:e,abortable:null!=t,data:o})})).finally((()=>{t&&t.removeEventListener("abort",s)}))}let workerRevisionChecked=!1;function checkWorkerRevision(e){if(!workerRevisionChecked&&e.kernelInfo){workerRevisionChecked=!0;const{revision:o,fullVersion:r}=configuration.kernelInfo,{revision:t,fullVersion:n,version:s}=e.kernelInfo;esriConfig.assetsPath!==esriConfig.defaultAssetsPath&&o!==t&&console.warn(`Version mismatch detected between ArcGIS Maps SDK for JavaScript modules and assets. For more information visit https://bit.ly/3QnsuSo.\nModules version: ${r}\nAssets version: ${n??s}\nAssets path: ${esriConfig.assetsPath}`)}}function messageHandler(e){const o=receiveMessage(e);if(!o)return;const r=o.jobId;switch(o.type){case 1:let n;function t(e){const o=n.connect(e);self.postMessage({type:2,jobId:r,data:o},[o])}"function"==typeof define&&define.amd?require([workerPath],(e=>{n=e.default||e,checkWorkerRevision(n),n.loadWorker(o.modulePath).then((e=>e||new Promise((e=>{require([o.modulePath],e)})))).then(t)})):"System"in self&&"function"==typeof System.import?System.import(workerPath).then((e=>(n=e.default,checkWorkerRevision(n),n.loadWorker(o.modulePath)))).then((e=>e||System.import(o.modulePath))).then(t):esriConfig.workers.useDynamicImport?import(workerPath).then((e=>{n=e.default||e,checkWorkerRevision(n),n.loadWorker(o.modulePath).then((e=>e||import(o.modulePath))).then(t)})):(self.RemoteClient||importScripts(workerPath),n=self.RemoteClient.default||self.RemoteClient,checkWorkerRevision(n),n.loadWorker(o.modulePath).then(t));break;case 3:if(outgoing.has(r)){const s=outgoing.get(r);outgoing.delete(r),o.error?s.reject(JSON.parse(o.error)):s.resolve(o.data)}}}self.dojoConfig=configuration.loaderConfig,esriConfig.workers.loaderUrl&&(self.importScripts(esriConfig.workers.loaderUrl),"function"==typeof require&&"function"==typeof require.config&&require.config(configuration.loaderConfig)),self.addEventListener("message",messageHandler),self.postMessage({type:0});';let y_,g_;const gO="Failed to create Worker. Fallback to execute module in main thread";async function lle(){if(!z("esri-workers"))return vO(new z1);if(!y_&&!g_)try{const e=ale.split("{CONFIGURATION}").join(ule());y_=URL.createObjectURL(new Blob([e],{type:"text/javascript"}))}catch(e){g_=e||{}}let t;if(y_)try{t=new Worker(y_,{name:"esri-worker-"+cle++})}catch{RT().warn(gO,g_),t=new z1}else RT().warn(gO,g_),t=new z1;return vO(t)}async function vO(t){return new Promise((e=>{function r(s){const n=z0(s);n&&n.type===ole&&(t.removeEventListener("message",r),t.removeEventListener("error",i),e(t))}function i(s){s.preventDefault(),t.removeEventListener("message",r),t.removeEventListener("error",i),RT().warn("Failed to create Worker. Fallback to execute module in main thread",s),(t=new z1).addEventListener("message",r),t.addEventListener("error",i)}t.addEventListener("message",r),t.addEventListener("error",i)}))}function ule(){let t;if(Ge.default!=null){const s={...Ge};delete s.default,t=JSON.parse(JSON.stringify(s))}else t=JSON.parse(JSON.stringify(Ge));t.assetsPath=on(t.assetsPath),t.defaultAssetsPath=t.defaultAssetsPath?on(t.defaultAssetsPath):void 0,t.request.interceptors=[],t.log.interceptors=[],t.locale=hs(),t.has={"esri-csp-restrictions":z("esri-csp-restrictions"),"esri-2d-debug":!1,"esri-2d-update-debug":z("esri-2d-update-debug"),"esri-2d-log-updating":z("esri-2d-log-updating"),"featurelayer-pbf":z("featurelayer-pbf"),"featurelayer-fast-triangulation-enabled":z("featurelayer-fast-triangulation-enabled"),"featurelayer-simplify-thresholds":z("featurelayer-simplify-thresholds"),"featurelayer-simplify-payload-size-factors":z("featurelayer-simplify-payload-size-factors"),"featurelayer-simplify-mobile-factor":z("featurelayer-simplify-mobile-factor"),"featurelayer-query-max-depth":z("featurelayer-query-max-depth"),"featurelayer-query-tile-max-features":z("featurelayer-query-tile-max-features"),"featurelayer-query-tile-concurrency":z("featurelayer-query-tile-concurrency"),"featurelayer-query-pausing-enabled":z("featurelayer-query-pausing-enabled"),"featurelayer-snapshot-concurrency":z("featurelayer-snapshot-concurrency"),"featurelayer-snapshot-enabled":z("featurelayer-snapshot-enabled"),"esri-atomics":z("esri-atomics"),"esri-shared-array-buffer":z("esri-shared-array-buffer"),"esri-tiles-debug":z("esri-tiles-debug"),"esri-workers-arraybuffer-transfer":z("esri-workers-arraybuffer-transfer"),"feature-polyline-generalization-factor":z("feature-polyline-generalization-factor"),"host-webworker":1},t.workers.loaderUrl&&(t.workers.loaderUrl=on(t.workers.loaderUrl)),t.workers.workerPath?t.workers.workerPath=on(t.workers.workerPath):t.workers.workerPath=on(Et("esri/core/workers/RemoteClient.js")),t.workers.useDynamicImport=!1;const e=Ge.workers.loaderConfig,r=sle({baseUrl:e?.baseUrl,locale:hs(),has:{"csp-restrictions":1,"dojo-test-sniff":0,"host-webworker":1,...e?.has},map:{...e?.map},paths:{...e?.paths},packages:e?.packages||[]});return JSON.stringify({esriConfig:t,loaderConfig:r,kernelInfo:{buildDate:Az,fullVersion:YP,revision:Lz}})}let cle=0;const{ABORT:_O,INVOKE:hle,OPEN:dle,OPENED:ple,RESPONSE:dy}=qr;let fle=class w9{static async create(e){const r=await lle();return new w9(r,e)}constructor(e,r){this._outJobs=new Map,this._inJobs=new Map,this.worker=e,this.id=r,e.addEventListener("message",this._onMessage.bind(this)),e.addEventListener("error",(i=>{i.preventDefault(),q.getLogger("esri.core.workers.WorkerOwner").error(i)}))}terminate(){this.worker.terminate()}async open(e,r={}){const{signal:i}=r,s=b9();return new Promise(((n,o)=>{const a={resolve:n,reject:o,abortHandle:XP(i,(()=>{this._outJobs.delete(s),this._post({type:_O,jobId:s})}))};this._outJobs.set(s,a),this._post({type:dle,jobId:s,modulePath:e})}))}_onMessage(e){const r=z0(e);if(r)switch(r.type){case ple:this._onOpenedMessage(r);break;case dy:this._onResponseMessage(r);break;case _O:this._onAbortMessage(r);break;case hle:this._onInvokeMessage(r)}}_onAbortMessage(e){const r=this._inJobs,i=e.jobId,s=r.get(i);s&&(s.controller&&s.controller.abort(),r.delete(i))}_onInvokeMessage(e){const{methodName:r,jobId:i,data:s,abortable:n}=e,o=n?new AbortController:null,a=this._inJobs,l=ile[r];let u;try{if(typeof l!="function")throw new TypeError(`${r} is not a function`);u=l.call(null,s,{signal:o?o.signal:null})}catch(h){return void this._post({type:dy,jobId:i,error:D0(h)})}Ia(u)?(a.set(i,{controller:o,promise:u}),u.then((h=>{a.has(i)&&(a.delete(i),this._post({type:dy,jobId:i},h))}),(h=>{a.has(i)&&(a.delete(i),h||(h={message:"Error encountered at method"+r}),xi(h)||this._post({type:dy,jobId:i,error:D0(h||{message:`Error encountered at method ${r}`})}))}))):this._post({type:dy,jobId:i},u)}_onOpenedMessage(e){const{jobId:r,data:i}=e,s=this._outJobs.get(r);s&&(this._outJobs.delete(r),Lt(s.abortHandle),s.resolve(i))}_onResponseMessage(e){const{jobId:r,error:i,data:s}=e,n=this._outJobs.get(r);n&&(this._outJobs.delete(r),Lt(n.abortHandle),i?n.reject(F.fromJSON(JSON.parse(i))):n.resolve(s))}_post(e,r,i){return eA(this.worker,e,r,i)}};const bO=z("host-browser")?Math.min(navigator.hardwareConcurrency-1,z("workers-pool-size")??8):0;let Dh=z("esri-mobile")?Math.min(bO,3):bO;Dh||(Dh=z("safari")&&z("mac")?7:2);let wO=0;const V1=[];function mle(){S9()}async function v_(t,e){const r=new rle,{registryTarget:i,...s}=e;return await r.open(t,s),i&&Hae(i,r),r}async function yle(t,e={}){if(typeof t!="string")throw new F("workers:undefined-module","modulePath is missing");let r=e.strategy||"distributed";if(z("host-webworker")&&!z("esri-workers")&&(r="local"),r==="local"){let i=await ym.loadWorker(t);i||(i=await import(t)),xt(e.signal);const s=e.client||i;return v_([ym.connect(i,e.schedule)],{...e,client:s})}if(await S9(),xt(e.signal),r==="dedicated"){const i=wO++%Dh;return v_([await V1[i].open(t,e)],e)}if(e.maxNumWorkers&&e.maxNumWorkers>0){const i=Math.min(e.maxNumWorkers,Dh);if(i<Dh){const s=new Array(i);for(let n=0;n<i;++n){const o=wO++%Dh;s[n]=V1[o].open(t,e)}return v_(s,e)}}return v_(V1.map((i=>i.open(t,e))),e)}let __=null;async function S9(){if(__)return __;new AbortController;const t=[];for(let e=0;e<Dh;e++){const r=fle.create(e).then((i=>(V1[e]=i,i)));t.push(r)}return __=Promise.all(t),__}var kT,Pf;let ti=(Pf=class extends W{constructor(e){super(e),this.cols=null,this.level=0,this.levelValue=null,this.origin=null,this.resolution=0,this.rows=null,this.scale=0}clone(){return new kT({cols:this.cols,level:this.level,levelValue:this.levelValue,resolution:this.resolution,rows:this.rows,scale:this.scale})}},kT=Pf,Pf);c([d({json:{write:!0,origins:{"web-document":{read:!1,write:!1},"portal-item":{read:!1,write:!1}}}})],ti.prototype,"cols",void 0),c([d({type:qe,json:{write:!0}})],ti.prototype,"level",void 0),c([d({type:String,json:{write:!0}})],ti.prototype,"levelValue",void 0),c([d({json:{write:!0,origins:{"web-document":{read:!1,write:!1},"portal-item":{read:!1,write:!1}}}})],ti.prototype,"origin",void 0),c([d({type:Number,json:{write:!0}})],ti.prototype,"resolution",void 0),c([d({json:{write:!0,origins:{"web-document":{read:!1,write:!1},"portal-item":{read:!1,write:!1}}}})],ti.prototype,"rows",void 0),c([d({type:Number,json:{write:!0}})],ti.prototype,"scale",void 0),ti=kT=c([C("esri.layers.support.LOD")],ti);let gle=class{constructor(e,r,i,s,n=void 0){this.id=e,this.level=r,this.row=i,this.col=s,this.extent=n}};var du;const SO=new De({PNG:"png",PNG8:"png8",PNG24:"png24",PNG32:"png32",JPEG:"jpg",JPG:"jpg",DIB:"dib",TIFF:"tiff",EMF:"emf",PS:"ps",PDF:"pdf",GIF:"gif",SVG:"svg",SVGZ:"svgz",Mixed:"mixed",MIXED:"mixed",LERC:"lerc",LERC2D:"lerc2d",RAW:"raw",pbf:"pbf"});var Af;let Yr=(Af=class extends W{static create(e={}){const{resolutionFactor:r=1,scales:i,size:s=256,spatialReference:n=ne.WebMercator,numLODs:o=24}=e;if(!as(n)){const m=[];if(i)for(let y=0;y<i.length;y++){const g=i[y];m.push(new ti({level:y,scale:g,resolution:g}))}else{let y=5e-4;for(let g=o-1;g>=0;g--)m.unshift(new ti({level:g,scale:y,resolution:y})),y*=2}return new du({dpi:96,lods:m,origin:new ge(0,0,n),size:[s,s],spatialReference:n})}const a=Si(n),l=e.origin?new ge({x:e.origin.x,y:e.origin.y,spatialReference:n}):new ge(a?{x:a.origin[0],y:a.origin[1],spatialReference:n}:{x:0,y:0,spatialReference:n}),u=96,h=1/(vn(n)*39.37*u),p=[];if(i)for(let m=0;m<i.length;m++){const y=i[m],g=y*h;p.push(new ti({level:m,scale:y,resolution:g}))}else{let m=Td(n)?512/s*5916575275917094e-7:256/s*591657527591555e-6;const y=Math.ceil(o/r);p.push(new ti({level:0,scale:m,resolution:m*h}));for(let g=1;g<y;g++){const v=m/2**r,_=v*h;p.push(new ti({level:g,scale:v,resolution:_})),m=v}}return new du({dpi:u,lods:p,origin:l,size:[s,s],spatialReference:n})}constructor(e){super(e),this.dpi=96,this.format=null,this.origin=null,this.size=null,this.spatialReference=null}get isWrappable(){const{spatialReference:e,origin:r}=this;if(e&&r){const i=Si(e);return e.isWrappable&&!!i&&Math.abs(i.origin[0]-r.x)<=i.dx}return!1}readOrigin(e,r){return ge.fromJSON({spatialReference:r.spatialReference,...e})}set lods(e){let r=0,i=0;const s=[],n=this._levelToLOD={};e&&(r=-1/0,i=1/0,e.forEach((o=>{s.push(o.scale),r=o.scale>r?o.scale:r,i=o.scale<i?o.scale:i,n[o.level]=o}))),this._set("scales",s),this._set("lods",e),this._initializeUpsampleLevels()}readSize(e,r){return[r.cols,r.rows]}writeSize(e,r){r.cols=e[0],r.rows=e[1]}zoomToScale(e){const r=this.scales;if(e<=0)return r[0];if(e>=r.length-1)return r[r.length-1];const i=Math.floor(e),s=i+1;return r[i]/(r[i]/r[s])**(e-i)}scaleToZoom(e){const r=this.scales,i=r.length-1;let s=0;for(;s<i;s++){const n=r[s],o=r[s+1];if(n<=e)return s;if(o===e)return s+1;if(n>e&&o<e)return s+Math.log(n/e)/Math.log(n/o)}return s}tileAt(e,r,i,s){const n=this.lodAt(e);if(!n)return null;let o,a;if(typeof r=="number")o=r,a=i;else if(mr(r.spatialReference,this.spatialReference))o=r.x,a=r.y,s=i;else{const h=QS(r,this.spatialReference);if(h==null)return null;o=h.x,a=h.y,s=i}const l=n.resolution*this.size[0],u=n.resolution*this.size[1];return s||(s=new gle(null,0,0,0,nr())),s.level=e,s.row=Math.floor((this.origin.y-a)/u+.001),s.col=Math.floor((o-this.origin.x)/l+.001),this.updateTileInfo(s),s}updateTileInfo(e,r=du.ExtrapolateOptions.NONE){let i=this.lodAt(e.level);if(!i&&r===du.ExtrapolateOptions.POWER_OF_TWO){const a=this.lods[this.lods.length-1];a.level<e.level&&(i=a)}if(!i)return;const s=e.level-i.level,n=i.resolution*this.size[0]/2**s,o=i.resolution*this.size[1]/2**s;e.id=`${e.level}/${e.row}/${e.col}`,e.extent||(e.extent=nr()),e.extent[0]=this.origin.x+e.col*n,e.extent[1]=this.origin.y-(e.row+1)*o,e.extent[2]=e.extent[0]+n,e.extent[3]=e.extent[1]+o}upsampleTile(e){const r=this._upsampleLevels[e.level];return!(!r||r.parentLevel===-1)&&(e.level=r.parentLevel,e.row=Math.floor(e.row/r.factor+.001),e.col=Math.floor(e.col/r.factor+.001),this.updateTileInfo(e),!0)}getTileBounds(e,r){const i=this.lodAt(r.level);if(i==null)return null;const{resolution:s}=i,n=s*this.size[0],o=s*this.size[1];return e[0]=this.origin.x+r.col*n,e[1]=this.origin.y-(r.row+1)*o,e[2]=e[0]+n,e[3]=e[1]+o,e}lodAt(e){return this._levelToLOD?.[e]??null}clone(){return du.fromJSON(this.write({}))}getCompatibleForVTL(e){if(this.size[0]!==this.size[1]||this.size[0]===256&&e===512)return null;const r=(this.size[0]===512&&e===256?-1:0)+(this.spatialReference.isGeographic?1:0);if(this.size[0]===e&&r===0)return this;const i=[],s=this.lods.length-r;for(let n=0;n<s;n++){const o=n+r,{scale:a,resolution:l}=o>=0?this.lods[o]:{scale:2*this.lods[0].scale,resolution:2*this.lods[0].resolution};i.push(new ti({level:n,scale:a,resolution:l}))}return new du({size:[e,e],dpi:this.dpi,format:this.format,compressionQuality:this.compressionQuality,origin:this.origin,spatialReference:this.spatialReference,lods:i})}_initializeUpsampleLevels(){const e=this.lods;this._upsampleLevels=[];let r=null;for(let i=0;i<e.length;i++){const s=e[i];this._upsampleLevels[s.level]={parentLevel:r?r.level:-1,factor:r?r.resolution/s.resolution:0},r=s}}},du=Af,Af);c([d({type:Number,json:{write:!0}})],Yr.prototype,"compressionQuality",void 0),c([d({type:Number,json:{write:!0}})],Yr.prototype,"dpi",void 0),c([d({type:String,json:{read:SO.read,write:SO.write,origins:{"web-scene":{read:!1,write:!1}}}})],Yr.prototype,"format",void 0),c([d({readOnly:!0})],Yr.prototype,"isWrappable",null),c([d({type:ge,json:{write:!0}})],Yr.prototype,"origin",void 0),c([K("origin")],Yr.prototype,"readOrigin",null),c([d({type:[ti],value:null,json:{write:!0}})],Yr.prototype,"lods",null),c([d({readOnly:!0})],Yr.prototype,"scales",void 0),c([d({cast:t=>Array.isArray(t)?t:typeof t=="number"?[t,t]:[256,256]})],Yr.prototype,"size",void 0),c([K("size",["rows","cols"])],Yr.prototype,"readSize",null),c([re("size",{cols:{type:qe},rows:{type:qe}})],Yr.prototype,"writeSize",null),c([d({type:ne,json:{write:!0}})],Yr.prototype,"spatialReference",void 0),Yr=du=c([C("esri.layers.support.TileInfo")],Yr),(function(t){var e;(e=t.ExtrapolateOptions||(t.ExtrapolateOptions={}))[e.NONE=0]="NONE",e[e.POWER_OF_TWO=1]="POWER_OF_TWO"})(Yr||(Yr={}));const j1={widthBreakpoint:{getValue(t){const e=t.viewSize[0],r=t.breakpoints,i=this.values;return e<=r.xsmall?i.xsmall:e<=r.small?i.small:e<=r.medium?i.medium:e<=r.large?i.large:i.xlarge},values:{xsmall:"xsmall",small:"small",medium:"medium",large:"large",xlarge:"xlarge"},valueToClassName:{xsmall:"esri-view-width-xsmall esri-view-width-less-than-small esri-view-width-less-than-medium esri-view-width-less-than-large esri-view-width-less-than-xlarge",small:"esri-view-width-small esri-view-width-greater-than-xsmall esri-view-width-less-than-medium esri-view-width-less-than-large esri-view-width-less-than-xlarge",medium:"esri-view-width-medium esri-view-width-greater-than-xsmall esri-view-width-greater-than-small esri-view-width-less-than-large esri-view-width-less-than-xlarge",large:"esri-view-width-large esri-view-width-greater-than-xsmall esri-view-width-greater-than-small esri-view-width-greater-than-medium esri-view-width-less-than-xlarge",xlarge:"esri-view-width-xlarge esri-view-width-greater-than-xsmall esri-view-width-greater-than-small esri-view-width-greater-than-medium esri-view-width-greater-than-large"}},heightBreakpoint:{getValue(t){const e=t.viewSize[1],r=t.breakpoints,i=this.values;return e<=r.xsmall?i.xsmall:e<=r.small?i.small:e<=r.medium?i.medium:e<=r.large?i.large:i.xlarge},values:{xsmall:"xsmall",small:"small",medium:"medium",large:"large",xlarge:"xlarge"},valueToClassName:{xsmall:"esri-view-height-xsmall esri-view-height-less-than-small esri-view-height-less-than-medium esri-view-height-less-than-large esri-view-height-less-than-xlarge",small:"esri-view-height-small esri-view-height-greater-than-xsmall esri-view-height-less-than-medium esri-view-height-less-than-large esri-view-height-less-than-xlarge",medium:"esri-view-height-medium esri-view-height-greater-than-xsmall esri-view-height-greater-than-small esri-view-height-less-than-large esri-view-height-less-than-xlarge",large:"esri-view-height-large esri-view-height-greater-than-xsmall esri-view-height-greater-than-small esri-view-height-greater-than-medium esri-view-height-less-than-xlarge",xlarge:"esri-view-height-xlarge esri-view-height-greater-than-xsmall esri-view-height-greater-than-small esri-view-height-greater-than-medium esri-view-height-greater-than-large"}},orientation:{getValue(t){const e=t.viewSize,r=e[0],i=e[1],s=this.values;return i>=r?s.portrait:s.landscape},values:{portrait:"portrait",landscape:"landscape"},valueToClassName:{portrait:"esri-view-orientation-portrait",landscape:"esri-view-orientation-landscape"}}},Vx={xsmall:544,small:768,medium:992,large:1200};function vle(t){const e=t;return e&&e.xsmall<e.small&&e.small<e.medium&&e.medium<e.large}function jx(t,e){return e?j1[t].valueToClassName[e].split(" "):[]}const _le=t=>{let e=class extends t{constructor(...r){super(...r),this.orientation=null,this.widthBreakpoint=null,this.heightBreakpoint=null,this.breakpoints=Vx}initialize(){this.addHandles(ie((()=>[this.breakpoints,this.size]),(()=>this._updateClassNames()),Ft))}destroy(){this.destroyed||this._removeActiveClassNames()}set breakpoints(r){if(r!==this._get("breakpoints")){if(!vle(r)){const i=JSON.stringify(Vx,null,2);console.warn("provided breakpoints are not valid, using defaults:"+i),r=Vx}this._set("breakpoints",{...r})}}_updateClassNames(){if(!this.container)return;const r=Fi.acquire(),i=Fi.acquire();let s,n=!1;for(s in j1){const o=this[s],a=j1[s].getValue({viewSize:this.size,breakpoints:this.breakpoints});o!==a&&(n=!0,this[s]=a,jx(s,o).forEach((l=>i.push(l))),jx(s,a).forEach((l=>r.push(l))))}n&&(this._applyClassNameChanges(r,i),Fi.release(r),Fi.release(i))}_applyClassNameChanges(r,i){const s=this.container;s&&(i.forEach((n=>s.classList.remove(n))),r.forEach((n=>s.classList.add(n))))}_removeActiveClassNames(){const r=this.container;if(!r)return;let i;for(i in j1)jx(i,this[i]).forEach((s=>r.classList.remove(s)))}};return c([d()],e.prototype,"breakpoints",null),c([d()],e.prototype,"orientation",void 0),c([d()],e.prototype,"widthBreakpoint",void 0),c([d()],e.prototype,"heightBreakpoint",void 0),e=c([C("esri.views.BreakpointsOwner")],e),e};function tA(t){return typeof t=="string"?document.getElementById(t):t??null}function xO(t,e){for(;;){const r=t.firstChild;if(!r)break;e.appendChild(r)}}let Xh=class extends ce{constructor(){super(...arguments),this.updating=!1,this._handleId=0,this._scheduleHandleId=0,this._pendingPromises=new Set}destroy(){this.removeAll()}add(e,r,i={}){return this._installWatch(e,r,i,ie)}addWhen(e,r,i={}){return this._installWatch(e,r,i,fs)}addOnCollectionChange(e,r,{initial:i=!1,final:s=!1}={}){const n=++this._handleId;return this.addHandles([so(e,"after-changes",this._createSyncUpdatingCallback(),Ma),so(e,"change",r,{onListenerAdd:i?o=>r({added:o.toArray(),removed:[]}):void 0,onListenerRemove:s?o=>r({added:[],removed:o.toArray()}):void 0})],n),He((()=>this.removeHandles(n)))}addPromise(e){if(e==null)return e;const r=++this._handleId;this.addHandles(He((()=>{this._pendingPromises.delete(e)&&(this._pendingPromises.size!==0||this.hasHandles(b_)||this._set("updating",!1))})),r),this._pendingPromises.add(e),this._set("updating",!0);const i=()=>this.removeHandles(r);return e.then(i,i),e}removeAll(){this._pendingPromises.clear(),this.removeAllHandles(),this._set("updating",!1)}_installWatch(e,r,i={},s){const n=++this._handleId;i.sync||this._installSyncUpdatingWatch(e,n);const o=s(e,r,i);return this.addHandles(o,n),He((()=>this.removeHandles(n)))}_installSyncUpdatingWatch(e,r){const i=this._createSyncUpdatingCallback(),s=ie(e,i,{sync:!0,equals:()=>!1});return this.addHandles(s,r),s}_createSyncUpdatingCallback(){return()=>{this.removeHandles(b_),++this._scheduleHandleId;const e=this._scheduleHandleId;this._get("updating")||this._set("updating",!0),this.addHandles(bv((()=>{e===this._scheduleHandleId&&(this._set("updating",this._pendingPromises.size>0),this.removeHandles(b_))})),b_)}}};c([d({readOnly:!0})],Xh.prototype,"updating",void 0),Xh=c([C("esri.core.support.UpdatingHandles")],Xh);const b_=-42;/*!
 * @esri/arcgis-html-sanitizer - v4.1.0 - Tue Dec 03 2024 09:13:28 GMT-0500 (Eastern Standard Time)
 * Copyright (c) 2024 - Environmental Systems Research Institute, Inc.
 * Apache-2.0
 * 
 * js-xss
 * Copyright (c) 2012-2018 Zongmin Lei() <leizongmin@gmail.com>
 * http://ucdok.com
 * MIT License, see https://github.com/leizongmin/js-xss/blob/master/LICENSE for details
 *//*! *****************************************************************************
Copyright (c) Microsoft Corporation.

Permission to use, copy, modify, and/or distribute this software for any
purpose with or without fee is hereby granted.

THE SOFTWARE IS PROVIDED "AS IS" AND THE AUTHOR DISCLAIMS ALL WARRANTIES WITH
REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF MERCHANTABILITY
AND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY SPECIAL, DIRECT,
INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES WHATSOEVER RESULTING FROM
LOSS OF USE, DATA OR PROFITS, WHETHER IN AN ACTION OF CONTRACT, NEGLIGENCE OR
OTHER TORTIOUS ACTION, ARISING OUT OF OR IN CONNECTION WITH THE USE OR
PERFORMANCE OF THIS SOFTWARE.
***************************************************************************** */var Iw=function(){return Iw=Object.assign||function(e){for(var r,i=1,s=arguments.length;i<s;i++){r=arguments[i];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},Iw.apply(this,arguments)},OT={exports:{}},qt={},NT={exports:{}},Pd={};function x9(){var t={};return t["align-content"]=!1,t["align-items"]=!1,t["align-self"]=!1,t["alignment-adjust"]=!1,t["alignment-baseline"]=!1,t.all=!1,t["anchor-point"]=!1,t.animation=!1,t["animation-delay"]=!1,t["animation-direction"]=!1,t["animation-duration"]=!1,t["animation-fill-mode"]=!1,t["animation-iteration-count"]=!1,t["animation-name"]=!1,t["animation-play-state"]=!1,t["animation-timing-function"]=!1,t.azimuth=!1,t["backface-visibility"]=!1,t.background=!0,t["background-attachment"]=!0,t["background-clip"]=!0,t["background-color"]=!0,t["background-image"]=!0,t["background-origin"]=!0,t["background-position"]=!0,t["background-repeat"]=!0,t["background-size"]=!0,t["baseline-shift"]=!1,t.binding=!1,t.bleed=!1,t["bookmark-label"]=!1,t["bookmark-level"]=!1,t["bookmark-state"]=!1,t.border=!0,t["border-bottom"]=!0,t["border-bottom-color"]=!0,t["border-bottom-left-radius"]=!0,t["border-bottom-right-radius"]=!0,t["border-bottom-style"]=!0,t["border-bottom-width"]=!0,t["border-collapse"]=!0,t["border-color"]=!0,t["border-image"]=!0,t["border-image-outset"]=!0,t["border-image-repeat"]=!0,t["border-image-slice"]=!0,t["border-image-source"]=!0,t["border-image-width"]=!0,t["border-left"]=!0,t["border-left-color"]=!0,t["border-left-style"]=!0,t["border-left-width"]=!0,t["border-radius"]=!0,t["border-right"]=!0,t["border-right-color"]=!0,t["border-right-style"]=!0,t["border-right-width"]=!0,t["border-spacing"]=!0,t["border-style"]=!0,t["border-top"]=!0,t["border-top-color"]=!0,t["border-top-left-radius"]=!0,t["border-top-right-radius"]=!0,t["border-top-style"]=!0,t["border-top-width"]=!0,t["border-width"]=!0,t.bottom=!1,t["box-decoration-break"]=!0,t["box-shadow"]=!0,t["box-sizing"]=!0,t["box-snap"]=!0,t["box-suppress"]=!0,t["break-after"]=!0,t["break-before"]=!0,t["break-inside"]=!0,t["caption-side"]=!1,t.chains=!1,t.clear=!0,t.clip=!1,t["clip-path"]=!1,t["clip-rule"]=!1,t.color=!0,t["color-interpolation-filters"]=!0,t["column-count"]=!1,t["column-fill"]=!1,t["column-gap"]=!1,t["column-rule"]=!1,t["column-rule-color"]=!1,t["column-rule-style"]=!1,t["column-rule-width"]=!1,t["column-span"]=!1,t["column-width"]=!1,t.columns=!1,t.contain=!1,t.content=!1,t["counter-increment"]=!1,t["counter-reset"]=!1,t["counter-set"]=!1,t.crop=!1,t.cue=!1,t["cue-after"]=!1,t["cue-before"]=!1,t.cursor=!1,t.direction=!1,t.display=!0,t["display-inside"]=!0,t["display-list"]=!0,t["display-outside"]=!0,t["dominant-baseline"]=!1,t.elevation=!1,t["empty-cells"]=!1,t.filter=!1,t.flex=!1,t["flex-basis"]=!1,t["flex-direction"]=!1,t["flex-flow"]=!1,t["flex-grow"]=!1,t["flex-shrink"]=!1,t["flex-wrap"]=!1,t.float=!1,t["float-offset"]=!1,t["flood-color"]=!1,t["flood-opacity"]=!1,t["flow-from"]=!1,t["flow-into"]=!1,t.font=!0,t["font-family"]=!0,t["font-feature-settings"]=!0,t["font-kerning"]=!0,t["font-language-override"]=!0,t["font-size"]=!0,t["font-size-adjust"]=!0,t["font-stretch"]=!0,t["font-style"]=!0,t["font-synthesis"]=!0,t["font-variant"]=!0,t["font-variant-alternates"]=!0,t["font-variant-caps"]=!0,t["font-variant-east-asian"]=!0,t["font-variant-ligatures"]=!0,t["font-variant-numeric"]=!0,t["font-variant-position"]=!0,t["font-weight"]=!0,t.grid=!1,t["grid-area"]=!1,t["grid-auto-columns"]=!1,t["grid-auto-flow"]=!1,t["grid-auto-rows"]=!1,t["grid-column"]=!1,t["grid-column-end"]=!1,t["grid-column-start"]=!1,t["grid-row"]=!1,t["grid-row-end"]=!1,t["grid-row-start"]=!1,t["grid-template"]=!1,t["grid-template-areas"]=!1,t["grid-template-columns"]=!1,t["grid-template-rows"]=!1,t["hanging-punctuation"]=!1,t.height=!0,t.hyphens=!1,t.icon=!1,t["image-orientation"]=!1,t["image-resolution"]=!1,t["ime-mode"]=!1,t["initial-letters"]=!1,t["inline-box-align"]=!1,t["justify-content"]=!1,t["justify-items"]=!1,t["justify-self"]=!1,t.left=!1,t["letter-spacing"]=!0,t["lighting-color"]=!0,t["line-box-contain"]=!1,t["line-break"]=!1,t["line-grid"]=!1,t["line-height"]=!1,t["line-snap"]=!1,t["line-stacking"]=!1,t["line-stacking-ruby"]=!1,t["line-stacking-shift"]=!1,t["line-stacking-strategy"]=!1,t["list-style"]=!0,t["list-style-image"]=!0,t["list-style-position"]=!0,t["list-style-type"]=!0,t.margin=!0,t["margin-bottom"]=!0,t["margin-left"]=!0,t["margin-right"]=!0,t["margin-top"]=!0,t["marker-offset"]=!1,t["marker-side"]=!1,t.marks=!1,t.mask=!1,t["mask-box"]=!1,t["mask-box-outset"]=!1,t["mask-box-repeat"]=!1,t["mask-box-slice"]=!1,t["mask-box-source"]=!1,t["mask-box-width"]=!1,t["mask-clip"]=!1,t["mask-image"]=!1,t["mask-origin"]=!1,t["mask-position"]=!1,t["mask-repeat"]=!1,t["mask-size"]=!1,t["mask-source-type"]=!1,t["mask-type"]=!1,t["max-height"]=!0,t["max-lines"]=!1,t["max-width"]=!0,t["min-height"]=!0,t["min-width"]=!0,t["move-to"]=!1,t["nav-down"]=!1,t["nav-index"]=!1,t["nav-left"]=!1,t["nav-right"]=!1,t["nav-up"]=!1,t["object-fit"]=!1,t["object-position"]=!1,t.opacity=!1,t.order=!1,t.orphans=!1,t.outline=!1,t["outline-color"]=!1,t["outline-offset"]=!1,t["outline-style"]=!1,t["outline-width"]=!1,t.overflow=!1,t["overflow-wrap"]=!1,t["overflow-x"]=!1,t["overflow-y"]=!1,t.padding=!0,t["padding-bottom"]=!0,t["padding-left"]=!0,t["padding-right"]=!0,t["padding-top"]=!0,t.page=!1,t["page-break-after"]=!1,t["page-break-before"]=!1,t["page-break-inside"]=!1,t["page-policy"]=!1,t.pause=!1,t["pause-after"]=!1,t["pause-before"]=!1,t.perspective=!1,t["perspective-origin"]=!1,t.pitch=!1,t["pitch-range"]=!1,t["play-during"]=!1,t.position=!1,t["presentation-level"]=!1,t.quotes=!1,t["region-fragment"]=!1,t.resize=!1,t.rest=!1,t["rest-after"]=!1,t["rest-before"]=!1,t.richness=!1,t.right=!1,t.rotation=!1,t["rotation-point"]=!1,t["ruby-align"]=!1,t["ruby-merge"]=!1,t["ruby-position"]=!1,t["shape-image-threshold"]=!1,t["shape-outside"]=!1,t["shape-margin"]=!1,t.size=!1,t.speak=!1,t["speak-as"]=!1,t["speak-header"]=!1,t["speak-numeral"]=!1,t["speak-punctuation"]=!1,t["speech-rate"]=!1,t.stress=!1,t["string-set"]=!1,t["tab-size"]=!1,t["table-layout"]=!1,t["text-align"]=!0,t["text-align-last"]=!0,t["text-combine-upright"]=!0,t["text-decoration"]=!0,t["text-decoration-color"]=!0,t["text-decoration-line"]=!0,t["text-decoration-skip"]=!0,t["text-decoration-style"]=!0,t["text-emphasis"]=!0,t["text-emphasis-color"]=!0,t["text-emphasis-position"]=!0,t["text-emphasis-style"]=!0,t["text-height"]=!0,t["text-indent"]=!0,t["text-justify"]=!0,t["text-orientation"]=!0,t["text-overflow"]=!0,t["text-shadow"]=!0,t["text-space-collapse"]=!0,t["text-transform"]=!0,t["text-underline-position"]=!0,t["text-wrap"]=!0,t.top=!1,t.transform=!1,t["transform-origin"]=!1,t["transform-style"]=!1,t.transition=!1,t["transition-delay"]=!1,t["transition-duration"]=!1,t["transition-property"]=!1,t["transition-timing-function"]=!1,t["unicode-bidi"]=!1,t["vertical-align"]=!1,t.visibility=!1,t["voice-balance"]=!1,t["voice-duration"]=!1,t["voice-family"]=!1,t["voice-pitch"]=!1,t["voice-range"]=!1,t["voice-rate"]=!1,t["voice-stress"]=!1,t["voice-volume"]=!1,t.volume=!1,t["white-space"]=!1,t.widows=!1,t.width=!0,t["will-change"]=!1,t["word-break"]=!0,t["word-spacing"]=!0,t["word-wrap"]=!0,t["wrap-flow"]=!1,t["wrap-through"]=!1,t["writing-mode"]=!1,t["z-index"]=!1,t}function ble(t,e,r){}function wle(t,e,r){}var Sle=/javascript\s*\:/img;function xle(t,e){return Sle.test(e)?"":e}Pd.whiteList=x9();Pd.getDefaultWhiteList=x9;Pd.onAttr=ble;Pd.onIgnoreAttr=wle;Pd.safeAttrValue=xle;var $le={indexOf:function(t,e){var r,i;if(Array.prototype.indexOf)return t.indexOf(e);for(r=0,i=t.length;r<i;r++)if(t[r]===e)return r;return-1},forEach:function(t,e,r){var i,s;if(Array.prototype.forEach)return t.forEach(e,r);for(i=0,s=t.length;i<s;i++)e.call(r,t[i],i,t)},trim:function(t){return String.prototype.trim?t.trim():t.replace(/(^\s*)|(\s*$)/g,"")},trimRight:function(t){return String.prototype.trimRight?t.trimRight():t.replace(/(\s*$)/g,"")}},py=$le;function Mle(t,e){t=py.trimRight(t),t[t.length-1]!==";"&&(t+=";");var r=t.length,i=!1,s=0,n=0,o="";function a(){if(!i){var h=py.trim(t.slice(s,n)),p=h.indexOf(":");if(p!==-1){var m=py.trim(h.slice(0,p)),y=py.trim(h.slice(p+1));if(m){var g=e(s,o.length,m,y,h);g&&(o+=g+"; ")}}}s=n+1}for(;n<r;n++){var l=t[n];if(l==="/"&&t[n+1]==="*"){var u=t.indexOf("*/",n+2);if(u===-1)break;n=u+1,s=n+1,i=!1}else l==="("?i=!0:l===")"?i=!1:l===";"?i||a():l===`
`&&a()}return py.trim(o)}var Tle=Mle,w_=Pd,Ele=Tle;function $O(t){return t==null}function Ile(t){var e={};for(var r in t)e[r]=t[r];return e}function $9(t){t=Ile(t||{}),t.whiteList=t.whiteList||w_.whiteList,t.onAttr=t.onAttr||w_.onAttr,t.onIgnoreAttr=t.onIgnoreAttr||w_.onIgnoreAttr,t.safeAttrValue=t.safeAttrValue||w_.safeAttrValue,this.options=t}$9.prototype.process=function(t){if(t=t||"",t=t.toString(),!t)return"";var e=this,r=e.options,i=r.whiteList,s=r.onAttr,n=r.onIgnoreAttr,o=r.safeAttrValue,a=Ele(t,function(l,u,h,p,m){var y=i[h],g=!1;if(y===!0?g=y:typeof y=="function"?g=y(p):y instanceof RegExp&&(g=y.test(p)),g!==!0&&(g=!1),p=o(h,p),!!p){var v={position:u,sourcePosition:l,source:m,isWhite:g};if(g){var _=s(h,p,v);return $O(_)?h+":"+p:_}else{var _=n(h,p,v);if(!$O(_))return _}}});return a};var Cle=$9;(function(t,e){var r=Pd,i=Cle;function s(o,a){var l=new i(a);return l.process(o)}e=t.exports=s,e.FilterCSS=i;for(var n in r)e[n]=r[n]})(NT,NT.exports);var rA=NT.exports,iA={indexOf:function(t,e){var r,i;if(Array.prototype.indexOf)return t.indexOf(e);for(r=0,i=t.length;r<i;r++)if(t[r]===e)return r;return-1},forEach:function(t,e,r){var i,s;if(Array.prototype.forEach)return t.forEach(e,r);for(i=0,s=t.length;i<s;i++)e.call(r,t[i],i,t)},trim:function(t){return String.prototype.trim?t.trim():t.replace(/(^\s*)|(\s*$)/g,"")},spaceIndex:function(t){var e=/\s|\n|\t/,r=e.exec(t);return r?r.index:-1}},Ple=rA.FilterCSS,Ale=rA.getDefaultWhiteList,Cw=iA;function M9(){return{a:["target","href","title"],abbr:["title"],address:[],area:["shape","coords","href","alt"],article:[],aside:[],audio:["autoplay","controls","crossorigin","loop","muted","preload","src"],b:[],bdi:["dir"],bdo:["dir"],big:[],blockquote:["cite"],br:[],caption:[],center:[],cite:[],code:[],col:["align","valign","span","width"],colgroup:["align","valign","span","width"],dd:[],del:["datetime"],details:["open"],div:[],dl:[],dt:[],em:[],figcaption:[],figure:[],font:["color","size","face"],footer:[],h1:[],h2:[],h3:[],h4:[],h5:[],h6:[],header:[],hr:[],i:[],img:["src","alt","title","width","height"],ins:["datetime"],li:[],mark:[],nav:[],ol:[],p:[],pre:[],s:[],section:[],small:[],span:[],sub:[],summary:[],sup:[],strong:[],strike:[],table:["width","border","align","valign"],tbody:["align","valign"],td:["width","rowspan","colspan","align","valign"],tfoot:["align","valign"],th:["width","rowspan","colspan","align","valign"],thead:["align","valign"],tr:["rowspan","align","valign"],tt:[],u:[],ul:[],video:["autoplay","controls","crossorigin","loop","muted","playsinline","poster","preload","src","height","width"]}}var T9=new Ple;function Lle(t,e,r){}function Rle(t,e,r){}function kle(t,e,r){}function Ole(t,e,r){}function E9(t){return t.replace(Fle,"&lt;").replace(Dle,"&gt;")}function Nle(t,e,r,i){if(r=R9(r),e==="href"||e==="src"){if(r=Cw.trim(r),r==="#")return"#";if(!(r.substr(0,7)==="http://"||r.substr(0,8)==="https://"||r.substr(0,7)==="mailto:"||r.substr(0,4)==="tel:"||r.substr(0,11)==="data:image/"||r.substr(0,6)==="ftp://"||r.substr(0,2)==="./"||r.substr(0,3)==="../"||r[0]==="#"||r[0]==="/"))return""}else if(e==="background"){if(S_.lastIndex=0,S_.test(r))return""}else if(e==="style"){if(MO.lastIndex=0,MO.test(r)||(TO.lastIndex=0,TO.test(r)&&(S_.lastIndex=0,S_.test(r))))return"";i!==!1&&(i=i||T9,r=i.process(r))}return r=k9(r),r}var Fle=/</g,Dle=/>/g,zle=/"/g,Vle=/&quot;/g,jle=/&#([a-zA-Z0-9]*);?/gim,Ule=/&colon;?/gim,Gle=/&newline;?/gim,S_=/((j\s*a\s*v\s*a|v\s*b|l\s*i\s*v\s*e)\s*s\s*c\s*r\s*i\s*p\s*t\s*|m\s*o\s*c\s*h\s*a):/gi,MO=/e\s*x\s*p\s*r\s*e\s*s\s*s\s*i\s*o\s*n\s*\(.*/gi,TO=/u\s*r\s*l\s*\(.*/gi;function I9(t){return t.replace(zle,"&quot;")}function C9(t){return t.replace(Vle,'"')}function P9(t){return t.replace(jle,function(r,i){return i[0]==="x"||i[0]==="X"?String.fromCharCode(parseInt(i.substr(1),16)):String.fromCharCode(parseInt(i,10))})}function A9(t){return t.replace(Ule,":").replace(Gle," ")}function L9(t){for(var e="",r=0,i=t.length;r<i;r++)e+=t.charCodeAt(r)<32?" ":t.charAt(r);return Cw.trim(e)}function R9(t){return t=C9(t),t=P9(t),t=A9(t),t=L9(t),t}function k9(t){return t=I9(t),t=E9(t),t}function Ble(){return""}function qle(t,e){typeof e!="function"&&(e=function(){});var r=!Array.isArray(t);function i(o){return r?!0:Cw.indexOf(t,o)!==-1}var s=[],n=!1;return{onIgnoreTag:function(o,a,l){if(i(o))if(l.isClosing){var u="[/removed]",h=l.position+u.length;return s.push([n!==!1?n:l.position,h]),n=!1,u}else return n||(n=l.position),"[removed]";else return e(o,a,l)},remove:function(o){var a="",l=0;return Cw.forEach(s,function(u){a+=o.slice(l,u[0]),l=u[1]}),a+=o.slice(l),a}}}function Hle(t){for(var e="",r=0;r<t.length;){var i=t.indexOf("<!--",r);if(i===-1){e+=t.slice(r);break}e+=t.slice(r,i);var s=t.indexOf("-->",i);if(s===-1)break;r=s+3}return e}function Wle(t){var e=t.split("");return e=e.filter(function(r){var i=r.charCodeAt(0);return i===127?!1:i<=31?i===10||i===13:!0}),e.join("")}qt.whiteList=M9();qt.getDefaultWhiteList=M9;qt.onTag=Lle;qt.onIgnoreTag=Rle;qt.onTagAttr=kle;qt.onIgnoreTagAttr=Ole;qt.safeAttrValue=Nle;qt.escapeHtml=E9;qt.escapeQuote=I9;qt.unescapeQuote=C9;qt.escapeHtmlEntities=P9;qt.escapeDangerHtml5Entities=A9;qt.clearNonPrintableCharacter=L9;qt.friendlyAttrValue=R9;qt.escapeAttrValue=k9;qt.onIgnoreTagStripAll=Ble;qt.StripTagBody=qle;qt.stripCommentTag=Hle;qt.stripBlankChar=Wle;qt.cssFilter=T9;qt.getDefaultCSSWhiteList=Ale;var _2={},Cu=iA;function Zle(t){var e=Cu.spaceIndex(t),r;return e===-1?r=t.slice(1,-1):r=t.slice(1,e+1),r=Cu.trim(r).toLowerCase(),r.slice(0,1)==="/"&&(r=r.slice(1)),r.slice(-1)==="/"&&(r=r.slice(0,-1)),r}function Jle(t){return t.slice(0,2)==="</"}function Yle(t,e,r){var i="",s=0,n=!1,o=!1,a=0,l=t.length,u="",h="";e:for(a=0;a<l;a++){var p=t.charAt(a);if(n===!1){if(p==="<"){n=a;continue}}else if(o===!1){if(p==="<"){i+=r(t.slice(s,a)),n=a,s=a;continue}if(p===">"){i+=r(t.slice(s,n)),h=t.slice(n,a+1),u=Zle(h),i+=e(n,i.length,u,h,Jle(h)),s=a+1,n=!1;continue}if(p==='"'||p==="'")for(var m=1,y=t.charAt(a-m);y.trim()===""||y==="=";){if(y==="="){o=p;continue e}y=t.charAt(a-++m)}}else if(p===o){o=!1;continue}}return s<t.length&&(i+=r(t.substr(s))),i}var Xle=/[^a-zA-Z0-9\\_:.-]/gim;function Kle(t,e){var r=0,i=0,s=[],n=!1,o=t.length;function a(m,y){if(m=Cu.trim(m),m=m.replace(Xle,"").toLowerCase(),!(m.length<1)){var g=e(m,y||"");g&&s.push(g)}}for(var l=0;l<o;l++){var u=t.charAt(l),h,p;if(n===!1&&u==="="){n=t.slice(r,l),r=l+1,i=t.charAt(r)==='"'||t.charAt(r)==="'"?r:eue(t,l+1);continue}if(n!==!1&&l===i){if(p=t.indexOf(u,l+1),p===-1)break;h=Cu.trim(t.slice(i+1,p)),a(n,h),n=!1,l=p,r=l+1;continue}if(/\s|\n|\t/.test(u))if(t=t.replace(/\s|\n|\t/g," "),n===!1)if(p=Qle(t,l),p===-1){h=Cu.trim(t.slice(r,l)),a(h),n=!1,r=l+1;continue}else{l=p-1;continue}else if(p=tue(t,l-1),p===-1){h=Cu.trim(t.slice(r,l)),h=EO(h),a(n,h),n=!1,r=l+1;continue}else continue}return r<t.length&&(n===!1?a(t.slice(r)):a(n,EO(Cu.trim(t.slice(r))))),Cu.trim(s.join(" "))}function Qle(t,e){for(;e<t.length;e++){var r=t[e];if(r!==" ")return r==="="?e:-1}}function eue(t,e){for(;e<t.length;e++){var r=t[e];if(r!==" ")return r==="'"||r==='"'?e:-1}}function tue(t,e){for(;e>0;e--){var r=t[e];if(r!==" ")return r==="="?e:-1}}function rue(t){return t[0]==='"'&&t[t.length-1]==='"'||t[0]==="'"&&t[t.length-1]==="'"}function EO(t){return rue(t)?t.substr(1,t.length-2):t}_2.parseTag=Yle;_2.parseAttr=Kle;var iue=rA.FilterCSS,Gn=qt,O9=_2,sue=O9.parseTag,nue=O9.parseAttr,U1=iA;function x_(t){return t==null}function oue(t){var e=U1.spaceIndex(t);if(e===-1)return{html:"",closing:t[t.length-2]==="/"};t=U1.trim(t.slice(e+1,-1));var r=t[t.length-1]==="/";return r&&(t=U1.trim(t.slice(0,-1))),{html:t,closing:r}}function aue(t){var e={};for(var r in t)e[r]=t[r];return e}function lue(t){var e={};for(var r in t)Array.isArray(t[r])?e[r.toLowerCase()]=t[r].map(function(i){return i.toLowerCase()}):e[r.toLowerCase()]=t[r];return e}function N9(t){t=aue(t||{}),t.stripIgnoreTag&&(t.onIgnoreTag&&console.error('Notes: cannot use these two options "stripIgnoreTag" and "onIgnoreTag" at the same time'),t.onIgnoreTag=Gn.onIgnoreTagStripAll),t.whiteList||t.allowList?t.whiteList=lue(t.whiteList||t.allowList):t.whiteList=Gn.whiteList,t.onTag=t.onTag||Gn.onTag,t.onTagAttr=t.onTagAttr||Gn.onTagAttr,t.onIgnoreTag=t.onIgnoreTag||Gn.onIgnoreTag,t.onIgnoreTagAttr=t.onIgnoreTagAttr||Gn.onIgnoreTagAttr,t.safeAttrValue=t.safeAttrValue||Gn.safeAttrValue,t.escapeHtml=t.escapeHtml||Gn.escapeHtml,this.options=t,t.css===!1?this.cssFilter=!1:(t.css=t.css||{},this.cssFilter=new iue(t.css))}N9.prototype.process=function(t){if(t=t||"",t=t.toString(),!t)return"";var e=this,r=e.options,i=r.whiteList,s=r.onTag,n=r.onIgnoreTag,o=r.onTagAttr,a=r.onIgnoreTagAttr,l=r.safeAttrValue,u=r.escapeHtml,h=e.cssFilter;r.stripBlankChar&&(t=Gn.stripBlankChar(t)),r.allowCommentTag||(t=Gn.stripCommentTag(t));var p=!1;r.stripIgnoreTagBody&&(p=Gn.StripTagBody(r.stripIgnoreTagBody,n),n=p.onIgnoreTag);var m=sue(t,function(y,g,v,_,b){var S={sourcePosition:y,position:g,isClosing:b,isWhite:Object.prototype.hasOwnProperty.call(i,v)},$=s(v,_,S);if(!x_($))return $;if(S.isWhite){if(S.isClosing)return"</"+v+">";var T=oue(_),I=i[v],P=nue(T.html,function(R,D){var V=U1.indexOf(I,R)!==-1,U=o(v,R,D,V);return x_(U)?V?(D=l(v,R,D,h),D?R+'="'+D+'"':R):(U=a(v,R,D,V),x_(U)?void 0:U):U});return _="<"+v,P&&(_+=" "+P),T.closing&&(_+=" /"),_+=">",_}else return $=n(v,_,S),x_($)?u(_):$},u);return p&&(m=p.remove(m)),m};var uue=N9;(function(t,e){var r=qt,i=_2,s=uue;function n(a,l){var u=new s(l);return u.process(a)}e=t.exports=n,e.filterXSS=n,e.FilterXSS=s,(function(){for(var a in r)e[a]=r[a];for(var l in i)e[l]=i[l]})();function o(){return typeof self<"u"&&typeof DedicatedWorkerGlobalScope<"u"&&self instanceof DedicatedWorkerGlobalScope}o()&&(self.filterXSS=t.exports)})(OT,OT.exports);var Gd=OT.exports,cue=function(t){if(typeof t!="object"||t===null||Object.prototype.toString.call(t)!=="[object Object]")return!1;var e=Object.getPrototypeOf(t);if(e===null)return!0;for(;Object.getPrototypeOf(e)!==null;)e=Object.getPrototypeOf(e);return Object.getPrototypeOf(t)===e},hue=(function(){function t(e,r){var i=this;this.arcgisWhiteList={a:["href","style","target"],abbr:["title"],article:["style"],aside:["style"],audio:["autoplay","controls","loop","muted","preload"],b:[],blockquote:["style"],br:[],code:["style"],dd:["style"],del:["style"],details:["open","style"],div:["align","aria-hidden","aria-label","style"],dl:["style"],dt:["style"],em:[],figcaption:["style"],figure:["style"],font:["color","face","size","style"],footer:["style"],h1:["style"],h2:["style"],h3:["style"],h4:["style"],h5:["style"],h6:["style"],header:["style"],hr:[],i:[],img:["alt","border","height","src","style","width"],li:[],main:["style"],mark:["style"],nav:["style"],ol:[],p:["style"],pre:["style"],section:["style"],source:["media","src","type"],span:["aria-hidden","aria-label","style"],strong:[],sub:["style"],summary:["style"],sup:["style"],table:["border","cellpadding","cellspacing","height","style","width"],tbody:[],tr:["align","height","style","valign"],td:["align","colspan","height","nowrap","rowspan","style","valign","width"],th:["align","colspan","height","nowrap","rowspan","style","valign","width"],time:["style"],u:[],ul:[],video:["autoplay","controls","height","loop","muted","poster","preload","width"]},this.arcgisCSSWhiteList=Iw(Iw({},Gd.getDefaultCSSWhiteList()),{"align-items":!0,"align-self":!0,flex:!0,"flex-basis":!0,"flex-direction":!0,"flex-flow":!0,"flex-grow":!0,"flex-shrink":!0,"flex-wrap":!0,float:!0,gap:!0,grid:!0,"grid-area":!0,"grid-auto-columns":!0,"grid-auto-flow":!0,"grid-auto-rows":!0,"grid-column":!0,"grid-column-end":!0,"grid-column-start":!0,"grid-row":!0,"grid-row-end":!0,"grid-row-start":!0,"grid-template":!0,"grid-template-areas":!0,"grid-template-columns":!0,"grid-template-rows":!0,"justify-content":!0,"justify-items":!0,"justify-self":!0,"line-height":!0,overflow:!0}),this.allowedProtocols=["http","https","mailto","iform","tel","flow","lfmobile","arcgis-navigator","arcgis-appstudio-player","arcgis-survey123","arcgis-collector","arcgis-workforce","arcgis-explorer","arcgis-trek2there","arcgis-quickcapture","mspbi","comgooglemaps","pdfefile","pdfehttp","pdfehttps","boxapp","boxemm","awb","awbs","gropen","radarscope"],this.arcgisFilterOptions={allowCommentTag:!0,safeAttrValue:function(n,o,a,l){return n==="a"&&o==="href"||(n==="img"||n==="source")&&o==="src"?i.sanitizeUrl(a):Gd.safeAttrValue(n,o,a,l)}},this._entityMap={"&":"&#x38;","<":"&#x3C;",">":"&#x3E;",'"':"&#x22;","'":"&#x27;","/":"&#x2F;"};var s;e&&!r?s=e:e&&r?(s=Object.create(this.arcgisFilterOptions),s.css={whiteList:this.arcgisCSSWhiteList},Object.keys(e).forEach(function(n){if(n==="whiteList")s.whiteList=i._extendObjectOfArrays([i.arcgisWhiteList,e.whiteList||{}]);else if(n==="css"){var o=e.css.whiteList;o!=null&&e.css instanceof Object&&Object.keys(o).forEach(function(a){return s.css.whiteList[a]=o[a]})}else s[n]=e[n]})):(s=Object.create(this.arcgisFilterOptions),s.whiteList=this.arcgisWhiteList,s.css={whiteList:this.arcgisCSSWhiteList}),this.xssFilterOptions=s,this._xssFilter=new Gd.FilterXSS(s)}return t.prototype.sanitize=function(e,r){switch(r===void 0&&(r={}),typeof e){case"number":return isNaN(e)||!isFinite(e)?null:e;case"boolean":return e;case"string":return this._xssFilter.process(e);case"object":return this._iterateOverObject(e,r);default:return r.allowUndefined&&typeof e>"u"?void 0:null}},t.prototype.sanitizeUrl=function(e,r){var i=(r??{}).isProtocolRequired,s=i===void 0?!0:i,n=this._trim(e.substring(0,e.indexOf(":"))),o=e==="/",a=/^#/.test(e),l=n&&this.allowedProtocols.indexOf(n.toLowerCase())>-1;return o||a||l?Gd.escapeAttrValue(e):!n&&!s?Gd.escapeAttrValue("https://".concat(e)):""},t.prototype.sanitizeHTMLAttribute=function(e,r,i,s){return typeof this.xssFilterOptions.safeAttrValue=="function"?this.xssFilterOptions.safeAttrValue(e,r,i,s):Gd.safeAttrValue(e,r,i,s)},t.prototype.validate=function(e,r){r===void 0&&(r={});var i=this.sanitize(e,r);return{isValid:e===i,sanitized:i}},t.prototype.encodeHTML=function(e){var r=this;return String(e).replace(/[&<>"'\/]/g,function(i){return r._entityMap[i]})},t.prototype.encodeAttrValue=function(e){var r=/^[a-zA-Z0-9]$/;return String(e).replace(/[\x00-\xFF]/g,function(i,s){return r.test(i)?i:"&#x".concat(Number(e.charCodeAt(s)).toString(16),";")})},t.prototype._extendObjectOfArrays=function(e){var r={};return e.forEach(function(i){Object.keys(i).forEach(function(s){Array.isArray(i[s])&&Array.isArray(r[s])?r[s]=r[s].concat(i[s]):r[s]=i[s]})}),r},t.prototype._iterateOverObject=function(e,r){var i=this;r===void 0&&(r={});try{var s=!1,n=void 0;if(Array.isArray(e))n=e.reduce(function(a,l){var u=i.validate(l,r);return u.isValid?a.concat([l]):(s=!0,a.concat([u.sanitized]))},[]);else if(cue(e)){var o=Object.keys(e);n=o.reduce(function(a,l){var u=e[l],h=i.validate(u,r);return h.isValid?a[l]=u:(s=!0,a[l]=h.sanitized),a},{})}else return r.allowUndefined&&typeof e>"u"?void 0:null;return s?n:e}catch{return null}},t.prototype._trim=function(e){return String.prototype.trim?e.trim():e.replace(/(^\s*)|(\s*$)/g,"")},t})();const due=["dd","dl","dt","h1","h2","h3","h4","h5","h6","sub","sup","animate","animatetransform","circle","clippath","defs","ellipse","g","image","line","lineargradient","marker","mask","path","pattern","polygon","polyline","radialgradient","rect","stop","svg","switch","symbol","text","textpath","tspan","use"],pue=due.reduce(((t,e)=>(t[e]=[],t)),{}),fue=["align","alink","alt","bgcolor","border","cellpadding","cellspacing","class","color","cols","colspan","coords","d","dir","face","height","hspace","ismap","lang","marginheight","marginwidth","multiple","nohref","noresize","noshade","nowrap","ref","rel","rev","rows","rowspan","scrolling","shape","span","summary","tabindex","title","usemap","valign","value","vlink","vspace","width"],F9=new hue({whiteList:pue,onTagAttr:(t,e,r)=>{const i=`${e}="${r}"`;if(fue.includes(e))return i},stripIgnoreTag:!0,stripIgnoreTagBody:["script","style"]},!0),D9="http://www.w3.org/",b2=`${D9}2000/svg`,z9=`${D9}1999/xlink`;let IO=[],sA=(t,e)=>{let r={};return Object.keys(t).forEach((i=>{r[i]=t[i]})),e&&Object.keys(e).forEach((i=>{r[i]=e[i]})),r},nA=(t,e)=>t.vnodeSelector===e.vnodeSelector&&(t.properties&&e.properties?t.properties.key===e.properties.key&&t.properties.bind===e.properties.bind:!t.properties&&!e.properties),V9=t=>{if(typeof t!="string")throw new Error("Style values must be strings")},mue=(t,e,r)=>{if(e.vnodeSelector!==""){for(let i=r;i<t.length;i++)if(nA(t[i],e))return i}return-1},Ux=(t,e,r,i)=>{let s=t[e];if(s.vnodeSelector==="")return;let n=s.properties;if(!(n&&(n.key===void 0?n.bind:n.key))){for(let o=0;o<t.length;o++)if(o!==e){let a=t[o];if(nA(a,s))throw new Error(`${r.vnodeSelector} had a ${s.vnodeSelector} child ${i==="added"?i:"removed"}, but there is now more than one. You must add unique key properties to make them distinguishable.`)}}},yue=t=>{if(t.properties){let e=t.properties.enterAnimation;e&&e(t.domNode,t.properties)}},FT=[],DT=!1,j9=t=>{(t.children||[]).forEach(j9),t.properties&&t.properties.afterRemoved&&t.properties.afterRemoved.apply(t.properties.bind||t.properties,[t.domNode])},CO=()=>{DT=!1,FT.forEach(j9),FT.length=0},PO=t=>{FT.push(t),DT||(DT=!0,typeof window<"u"&&"requestIdleCallback"in window?window.requestIdleCallback(CO,{timeout:16}):setTimeout(CO,16))},AO=t=>{let e=t.domNode;if(t.properties){let r=t.properties.exitAnimation;if(r)return e.style.pointerEvents="none",void r(e,()=>{e.parentNode&&(e.parentNode.removeChild(e),PO(t))},t.properties)}e.parentNode&&(e.parentNode.removeChild(e),PO(t))},gue=(t,e,r)=>{if(!e)return;let i=r.eventHandlerInterceptor,s=Object.keys(e),n=s.length;for(let o=0;o<n;o++){let a=s[o],l=e[a];if(a==="className")throw new Error('Property "className" is not supported, use "class".');if(a==="class")VT(t,l,!0);else if(a==="classes"){let u=Object.keys(l),h=u.length;for(let p=0;p<h;p++){let m=u[p];l[m]&&t.classList.add(m)}}else if(a==="styles"){let u=Object.keys(l),h=u.length;for(let p=0;p<h;p++){let m=u[p],y=l[m];y&&(V9(y),r.styleApplyer(t,m,y))}}else if(a!=="key"&&l!=null){let u=typeof l;u==="function"?(a.lastIndexOf("on",0)===0&&(i&&(l=i(a,l,t,e)),a==="oninput"&&(function(){let h=l;l=function(p){h.apply(this,[p]),p.target["oninput-value"]=p.target.value}})()),t[a]=l):r.namespace===b2?a==="href"?t.setAttributeNS(z9,a,l):t.setAttribute(a,l):u==="string"&&a!=="value"?a==="innerHTML"?t[a]=F9.sanitize(l):zT(t)&&a in t?t[a]=l:t.setAttribute(a,l):t[a]=l}}};function zT(t){if(!(t instanceof Element&&t.tagName.includes("-")))return!1;const e=window.customElements.get(t.tagName.toLowerCase());return!!e&&t instanceof e}let Pw,vue=(t,e,r)=>{if(e)for(let i of e)i0(i,t,void 0,r)},U9=(t,e,r)=>{vue(t,e.children,r),e.text&&(t.textContent=e.text),gue(t,e.properties,r),e.properties&&e.properties.afterCreate&&e.properties.afterCreate.apply(e.properties.bind||e.properties,[t,r,e.vnodeSelector,e.properties,e.children])},i0=(t,e,r,i)=>{let s,n=0,o=t.vnodeSelector,a=e.ownerDocument;if(o==="")s=t.domNode=a.createTextNode(t.text),r!==void 0?e.insertBefore(s,r):e.appendChild(s);else{for(let l=0;l<=o.length;++l){let u=o.charAt(l);if(l===o.length||u==="."||u==="#"){let h=o.charAt(n-1),p=o.slice(n,l);h==="."?s.classList.add(p):h==="#"?s.id=p:(p==="svg"&&(i=sA(i,{namespace:b2})),i.namespace!==void 0?s=t.domNode=a.createElementNS(i.namespace,p):(s=t.domNode=t.domNode||a.createElement(p),p==="input"&&t.properties&&t.properties.type!==void 0&&s.setAttribute("type",t.properties.type)),r!==void 0?e.insertBefore(s,r):s.parentNode!==e&&e.appendChild(s)),n=l+1}}U9(s,t,i)}},VT=(t,e,r)=>{e&&e.split(" ").forEach((i=>{i&&t.classList.toggle(i,r)}))},_ue=(t,e,r,i)=>{if(!r)return;let s=!1,n=Object.keys(r),o=n.length;for(let a=0;a<o;a++){let l=n[a],u=r[l],h=e[l];if(l==="class")h!==u&&(VT(t,h,!1),VT(t,u,!0));else if(l==="classes"){let p=t.classList,m=Object.keys(u),y=m.length;for(let g=0;g<y;g++){let v=m[g],_=!!u[v];_!==!!h[v]&&(s=!0,_?p.add(v):p.remove(v))}}else if(l==="styles"){let p=Object.keys(u),m=p.length;for(let y=0;y<m;y++){let g=p[y],v=u[g];v!==h[g]&&(s=!0,v?(V9(v),i.styleApplyer(t,g,v)):i.styleApplyer(t,g,""))}}else if(u||typeof h!="string"||(u=""),l!=="value"||zT(t)){if(u!==h){let p=typeof u;p==="function"&&i.eventHandlerInterceptor||(i.namespace===b2?l==="href"?t.setAttributeNS(z9,l,u):t.setAttribute(l,u):p==="string"?l==="innerHTML"?t[l]=F9.sanitize(u):l==="role"&&u===""?t.removeAttribute(l):zT(t)&&l in t?t[l]=u:t.setAttribute(l,u):t[l]!==u&&(t[l]=u),s=!0)}}else{let p=t[l];p!==u&&(t["oninput-value"]?p===t["oninput-value"]:u!==h)&&(t[l]=u,t["oninput-value"]=void 0),u!==h&&(s=!0)}}return s},bue=(t,e,r,i,s)=>{if(r===i)return!1;i=i||IO;let n,o=(r=r||IO).length,a=i.length,l=0,u=0,h=!1;for(;u<a;){let p=l<o?r[l]:void 0,m=i[u];if(p!==void 0&&nA(p,m))h=Pw(p,m,s)||h,l++;else{let y=mue(r,m,l+1);if(y>=0){for(n=l;n<y;n++)AO(r[n]),Ux(r,n,t,"removed");h=Pw(r[y],m,s)||h,l=y+1}else i0(m,e,l<o?r[l].domNode:void 0,s),yue(m),Ux(i,u,t,"added")}u++}if(o>l)for(n=l;n<o;n++)AO(r[n]),Ux(r,n,t,"removed");return h};Pw=(t,e,r)=>{let i=t.domNode,s=!1;if(t===e)return!1;let n=!1;if(e.vnodeSelector===""){if(e.text!==t.text){let o=i.ownerDocument.createTextNode(e.text);return i.parentNode.replaceChild(o,i),e.domNode=o,s=!0,s}e.domNode=i}else e.vnodeSelector.lastIndexOf("svg",0)===0&&(r=sA(r,{namespace:b2})),t.text!==e.text&&(n=!0,e.text===void 0?i.removeChild(i.firstChild):i.textContent=e.text),e.domNode=i,n=bue(e,i,t.children,e.children,r)||n,n=_ue(i,t.properties,e.properties,r)||n,e.properties&&e.properties.afterUpdate&&e.properties.afterUpdate.apply(e.properties.bind||e.properties,[i,r,e.vnodeSelector,e.properties,e.children]);return n&&e.properties&&e.properties.updateAnimation&&e.properties.updateAnimation(i,e.properties,t.properties),s};let $_=(t,e)=>({getLastRender:()=>t,update:r=>{if(t.vnodeSelector!==r.vnodeSelector)throw new Error("The selector for the root VNode may not be changed. (consider using dom.merge and add one extra level to the virtual DOM)");let i=t;t=r,Pw(i,r,e)},domNode:t.domNode});const wue={namespace:void 0,performanceLogger:()=>{},eventHandlerInterceptor:void 0,styleApplyer:(t,e,r)=>{e.charAt(0)==="-"?t.style.setProperty(e,r):t.style[e]=r}};let Qy=t=>sA(wue,t),Hu={append:(t,e,r)=>(r=Qy(r),i0(e,t,void 0,r),$_(e,r)),insertBefore:(t,e,r)=>(r=Qy(r),i0(e,t.parentNode,t,r),$_(e,r)),merge:(t,e,r)=>(r=Qy(r),e.domNode=t,U9(t,e,r),$_(e,r)),replace:(t,e,r)=>(r=Qy(r),i0(e,t.parentNode,t,r),t.parentNode.removeChild(t),$_(e,r))},G9,Sue=(t,e)=>{let r=[];for(;t&&t!==e;)r.push(t),t=t.parentNode;return r};G9=Array.prototype.find?(t,e)=>t.find(e):(t,e)=>t.filter(e)[0];let xue=(t,e)=>{let r=t;return e.forEach((i=>{r=r&&r.children?G9(r.children,(s=>s.domNode===i)):void 0})),r},$ue=(t,e,r)=>{let i=function(s){r("domEvent",s);let n=e(),o=Sue(s.currentTarget,n.domNode);o.reverse();let a,l=xue(n.getLastRender(),o);return t.scheduleRender(),l&&(a=l.properties[`on${s.type}`].apply(l.properties.bind||this,arguments)),r("domEventProcessed",s),a};return(s,n,o,a)=>i},Aw=t=>{let e,r,i=Qy(t),s=i.performanceLogger,n=!0,o=!1,a=[],l=[],u=(p,m,y)=>{let g,v=()=>g;i.eventHandlerInterceptor=$ue(e,v,s),g=p(m,y(),i),a.push(g),l.push(y)},h=()=>{if(r=void 0,n){n=!1,s("renderStart",void 0);for(let p=0;p<a.length;p++){let m=l[p]();s("rendered",void 0),a[p].update(m),s("patched",void 0)}s("renderDone",void 0),n=!0}};return e={renderNow:h,scheduleRender:()=>{r||o||(r=requestAnimationFrame(h))},stop:()=>{r&&(cancelAnimationFrame(r),r=void 0),o=!0},resume:()=>{o=!1,n=!0,e.scheduleRender()},append:(p,m)=>{u(Hu.append,p,m)},insertBefore:(p,m)=>{u(Hu.insertBefore,p,m)},merge:(p,m)=>{u(Hu.merge,p,m)},replace:(p,m)=>{u(Hu.replace,p,m)},detach:p=>{for(let m=0;m<l.length;m++)if(l[m]===p)return l.splice(m,1),a.splice(m,1)[0];throw new Error("renderFunction was not found")}},e},pu=class extends ce{constructor(){super(...arguments),this.items=new se,this._watchUpdatingTracking=new Xh,this._callbacks=new Map,this._projector=Aw(),this._hiddenProjector=Aw()}get needsRender(){return this.items.length>0}get updating(){return this._watchUpdatingTracking?.updating??!1}initialize(){const e=document.createElement("div");e.className="esri-overlay-surface",this._set("surface",e),this._hiddenSurface=document.createElement("div"),this._hiddenSurface.setAttribute("style","visibility: hidden;"),e.appendChild(this._hiddenSurface),this._watchUpdatingTracking.addOnCollectionChange((()=>this.items),(r=>{for(const i of r.added){const s=()=>i.render();this._callbacks.set(i,s),this._projector.append(this.surface,s)}for(const i of r.removed){const s=this._projector.detach(this._callbacks.get(i));this.surface.removeChild(s.domNode),this._callbacks.delete(i)}}))}addItem(e){this.items.add(e)}removeItem(e){this.items.remove(e)}destroy(){this.items.removeAll(),this._callbacks.forEach((e=>this._projector.detach(e))),this._callbacks=null,this._projector=null,this._watchUpdatingTracking.destroy()}render(){this._projector.renderNow()}computeBoundingRect(e){const r=this._hiddenSurface,i=this._hiddenProjector;let s;const n=()=>(s=e.render(),s);i.append(r,n),i.renderNow();const o={left:0,top:0,right:0,bottom:0};if(s?.domNode){const a=s.domNode.getBoundingClientRect();o.left=a.left,o.top=a.top,o.right=a.right,o.bottom=a.bottom}for(i.detach(n);r.firstChild;)r.removeChild(r.firstChild);return o}overlaps(e,r){const i=this.computeBoundingRect(e),s=this.computeBoundingRect(r);return Math.max(i.left,s.left)<=Math.min(i.right,s.right)&&Math.max(i.top,s.top)<=Math.min(i.bottom,s.bottom)}get hasVisibleItems(){return this.items.some((e=>e.visible))}async prepare(){await document.fonts.load(this._fontString()).catch((()=>{}))}renderCanvas(e,r){const i=!!r?.disableDecorations;if(!this.items.some((n=>n.visible&&!(i&&n.isDecoration))))return;const s=e.getContext("2d");s.save(),s.font=this._fontString(),this.items.forEach((n=>{i&&n.isDecoration||(s.save(),n.renderCanvas(s),s.restore())})),s.restore()}_fontString(){return`10px ${getComputedStyle(this.surface).fontFamily}`}};c([d({readOnly:!0})],pu.prototype,"surface",void 0),c([d({readOnly:!0})],pu.prototype,"items",void 0),c([d({readOnly:!0})],pu.prototype,"needsRender",null),c([d({readOnly:!0})],pu.prototype,"_watchUpdatingTracking",void 0),c([d({readOnly:!0})],pu.prototype,"updating",null),pu=c([C("esri.views.overlay.ViewOverlay")],pu);const LO=pu,Gx=[0,0];function Mue(t){const e=(t.ownerDocument||window.document).defaultView,r=t.getBoundingClientRect();return Gx[0]=r.left+(e?.pageXOffset??0),Gx[1]=r.top+(e?.pageYOffset??0),Gx}function RO(t){t&&(t.textContent="",t.parentNode&&t.parentNode.removeChild(t))}function Tue(t){const e=document.createElement("div");return t.appendChild(e),e}const Bd=16,fy=750,Eue=512,Iue=2,Cue=t=>{let e=class extends t{constructor(...r){super(...r),this._freqInfo={freq:Bd,time:fy},this._overlayRenderTaskHandle=null,this.height=0,this.messagesCommon=null,this.overlay=null,this.position=null,this.resizing=!1,this.root=null,this.surface=null,this.suspended=!0,this.userContent=null,this.width=0,this.widthBreakpoint=null,this.addHandles([ie((()=>this.cursor),(i=>{const{surface:s}=this;s&&s.setAttribute("data-cursor",i)})),ie((()=>this.navigating),(i=>{const{surface:s}=this;s&&s.setAttribute("data-navigating",i.toString())}))])}initialize(){this.addHandles([ie((()=>this.ui),((r,i)=>this._handleUIChange(r,i)),Ft),this.on("focus",(()=>this.notifyChange("focused"))),this.on("blur",(()=>this.notifyChange("focused")))])}destroy(){this.destroyed||(this.ui?.destroy(),this.container=null)}get container(){return this._get("container")??null}set container(r){const i=this._get("container"),s=tA(r);if(s||typeof r!="string"||q.getLogger(this).error("#container",`element with id '${r}' not found`),i===s)return;if(this._stopMeasuring(),i&&(i.classList.remove("esri-view"),this._overlayRenderTaskHandle&&(this._overlayRenderTaskHandle.remove(),this._overlayRenderTaskHandle=null),this.overlay&&(this.overlay.destroy(),this._set("overlay",null)),this.root&&(RO(this.root),this._set("root",null)),this.userContent&&(xO(this.userContent,i),RO(this.userContent),this._set("userContent",null))),!s)return this._set("width",0),this._set("height",0),this._set("position",null),this._set("suspended",!0),this._set("surface",null),void this._set("container",null);s.classList.add("esri-view");const n=document.createElement("div");n.className="esri-view-user-storage",xO(s,n),s.appendChild(n),this._set("userContent",n);const o=document.createElement("div");o.className="esri-view-root",s.insertBefore(o,s.firstChild),this._set("root",o);const a=document.createElement("div");a.className="esri-view-surface",a.setAttribute("role","application"),a.tabIndex=0,o.appendChild(a),this._set("surface",a);const l=new LO;o.appendChild(l.surface),this._set("overlay",l),this.addHandles(ie((()=>l.needsRender),(u=>{u&&!this._overlayRenderTaskHandle?this._overlayRenderTaskHandle=om({render:()=>this.overlay?.render()}):this._overlayRenderTaskHandle=Lt(this._overlayRenderTaskHandle)}))),this.forceDOMReadyCycle(),this._set("container",s),this._startMeasuring()}get focused(){const r=document.activeElement===this.surface;return document.hasFocus()&&r}get size(){return[this.width,this.height]}set ui(r){const i=this._get("ui");i!==r&&i?.destroy(),this._set("ui",r)}blur(){this.surface?.blur()}focus(){this.surface?.focus()}pageToContainer(r,i,s){const n=this.position;return r-=n?n[0]:0,i-=n?n[1]:0,s?(s[0]=r,s[1]=i):s=[r,i],s}containerToPage(r,i,s){const n=this.position;return r+=n?n[0]:0,i+=n?n[1]:0,s?(s[0]=r,s[1]=i):s=[r,i],s}_handleUIChange(r,i){this.removeHandles("ui"),i&&i!==r&&i.destroy(),r&&(r.view=this,this.addHandles(ie((()=>this.root),(s=>{r.container=s?Tue(s):null}),Ft),"ui")),this._set("ui",r)}_stopMeasuring(){this.removeHandles("measuring"),this._get("resizing")&&this._set("resizing",!1)}_startMeasuring(){const r=this._freqInfo;r.freq=Bd,r.time=fy;const i=om({prepare:o=>{const a=this._measure(),l=this._freqInfo;if(l.time+=o.deltaTime,a&&(l.freq=Bd,this._get("resizing")||this._set("resizing",!0)),l.time<l.freq)return;l.time=0;const u=this._position();l.freq=u||a?Bd:Math.min(fy,l.freq*Iue),!a&&l.freq>=Eue&&(i.pause(),this._get("resizing")&&this._set("resizing",!1))}}),s=new ResizeObserver((o=>{r.freq=Bd,r.time=fy,i.resume()}));this.container!=null&&s.observe(this.container);const n=He((()=>s.disconnect()));this.addHandles([Lm(window,"resize",(()=>{r.freq=Bd,r.time=fy,i.resume()})),n,i],"measuring"),this._measure(),this._position()}_measure(){const r=this.container,i=r?r.clientWidth:0,s=r?r.clientHeight:0;if(i===0||s===0)return this.suspended||this._set("suspended",!0),!1;const n=this.width,o=this.height;return i===n&&s===o?(this.suspended&&this._set("suspended",!1),!1):(this._set("width",i),this._set("height",s),this.suspended&&this._set("suspended",!1),this.emit("resize",{oldWidth:n,oldHeight:o,width:i,height:s}),!0)}_position(){const r=this.container,i=this.position,s=r&&Mue(r);return!!s&&(!i||s[0]!==i[0]||s[1]!==i[1])&&(this._set("position",[s[0],s[1]]),!0)}forceDOMReadyCycle(){}};return c([d()],e.prototype,"container",null),c([d({readOnly:!0})],e.prototype,"focused",null),c([d({readOnly:!0})],e.prototype,"height",void 0),c([d()],e.prototype,"messagesCommon",void 0),c([d({type:LO})],e.prototype,"overlay",void 0),c([d({readOnly:!0})],e.prototype,"position",void 0),c([d({readOnly:!0})],e.prototype,"resizing",void 0),c([d({readOnly:!0})],e.prototype,"root",void 0),c([d({value:null,readOnly:!0})],e.prototype,"size",null),c([d({readOnly:!0})],e.prototype,"surface",void 0),c([d({readOnly:!0})],e.prototype,"suspended",void 0),c([d({nonNullable:!0})],e.prototype,"ui",null),c([d({readOnly:!0})],e.prototype,"userContent",void 0),c([d({readOnly:!0})],e.prototype,"width",void 0),c([d()],e.prototype,"widthBreakpoint",void 0),e=c([C("esri.views.DOMContainer")],e),e},B9=z("mac")?"Meta":"Control",Pue=new Set(["Alt","Control","Meta","Shift","Ctrl","Primary"]),Aue=t=>Pue.has(t);let Lue=class{constructor(e,r=[]){this.eventType=e,this.keyModifiers=r}matches(e){if(e.type!==this.eventType)return!1;if(this.keyModifiers.length===0)return!0;const r=e.modifiers;for(const i of this.keyModifiers)if(!r.has(i))return!1;return!0}},Ar=class{constructor(e){this._manager=null,this._incoming={},this._outgoing={},this._incomingEventMatches=null,this._incomingEventTypes=null,this._outgoingEventTypes=null,this._hasSideEffects=e}get incomingEventMatches(){if(!this._incomingEventMatches){this._incomingEventMatches=[];for(const e in this._incoming){const r=this._incoming[e];for(const i of r)this._incomingEventMatches.push(i.match)}}return this._incomingEventMatches}get incomingEventTypes(){return this._incomingEventTypes||(this._incomingEventTypes=this.incomingEventMatches.map((e=>e.eventType))),this._incomingEventTypes}get outgoingEventTypes(){return this._outgoingEventTypes||(this._outgoingEventTypes=Object.keys(this._outgoing)),this._outgoingEventTypes}get hasSideEffects(){return this._hasSideEffects}get hasPendingInputs(){return!1}onInstall(e){this._manager||(e.setEventCallback((r=>this._handleEvent(r))),e.setUninstallCallback((()=>this._onUninstall())),this._manager=e)}onUninstall(){}registerIncoming(e,r,i){let s;typeof r=="function"?(i=r,s=[]):s=r||[];const n=typeof e=="string"?new Lue(e,s):e,o=()=>{this._incomingEventTypes=null,this._incomingEventMatches=null},a=h=>{const p=this._incoming[h.match.eventType];if(p){const m=p.indexOf(h);p.splice(m,1),o(),this._manager&&this._manager.updateDependencies()}},l=new Rue(n,i,{onPause:a,onRemove:a,onResume:h=>{const p=this._incoming[h.match.eventType];p&&!p.includes(h)&&(p.push(h),o(),this._manager&&this._manager.updateDependencies())}});let u=this._incoming[n.eventType];return u||(u=[],this._incoming[n.eventType]=u),u.push(l),o(),this._manager&&this._manager.updateDependencies(),l}registerOutgoing(e){if(this._outgoing[e])throw new Error("There is already a callback registered for this outgoing InputEvent: "+e);const r=new kue(e,{onEmit:(i,s,n,o)=>{this._manager?.emit(i.eventType,s,n,o)},onRemove:i=>{delete this._outgoing[i.eventType],this._manager?.updateDependencies()}});return this._outgoing[e]=r,this._outgoingEventTypes=null,this._manager&&this._manager.updateDependencies(),r}startCapturingPointer(e){this._manager?.setPointerCapture(e,!0)}stopCapturingPointer(e){this._manager?.setPointerCapture(e,!1)}refreshHasPendingInputs(){this._manager?.refreshHasPendingInputs()}_onUninstall(){this._manager&&(this.onUninstall(),this._manager=null)}_handleEvent(e){const r=this._incoming[e.type];if(r){for(const i of r)if(i.match.matches(e)&&(i.callback?.(e),e.shouldStopPropagation()))break}}},Rue=class{constructor(e,r,i){this.match=e,this._callback=r,this._handler=i}pause(){this._handler.onPause(this)}resume(){this._handler.onResume(this)}remove(){this._handler.onRemove(this)}get callback(){return this._callback}},kue=class{constructor(e,r){this.eventType=e,this._removed=!1,this._handler=r}emit(e,r,i){this._removed||this._handler.onEmit(this,e,r,i)}remove(){this._removed=!0,this._handler.onRemove(this)}},Oue=class extends Ar{constructor(e){super(!0),this._onChange=e,this._value="mouse",this._x=null,this._y=null,this.registerIncoming("pointer-move",(r=>this._update(r.data)))}_update(e){const r=e.native.pointerType==="touch"?"touch":"mouse",{x:i,y:s}=e;r===this._value&&this._x===i&&this._y===s||(this._value=r,this._x=i,this._y=s,this._onChange(r,i,s))}},Nue=class{constructor(e,r){this._observable=new Sv,this._value=e,this._equalityFunction=r}get value(){return we(this._observable),this._value}set value(e){this._equalityFunction(e,this._value)||(this._value=e,this._observable.notify())}mutate(e){e(this._value),this._observable.notify()}};function gm(t,e=cz){return new Nue(t,e)}let Fue=class extends Ar{get multiTouchActive(){return this._multiTouchActive.value}constructor(){super(!0),this._activeTouchPointerIds=new Set,this._multiTouchActive=gm(!1),this._onPointerAdd=({data:e})=>{e.pointerType==="touch"&&(this._activeTouchPointerIds.add(e.native.pointerId),this._update())},this._onPointerRemove=({data:e})=>{e.pointerType==="touch"&&(this._activeTouchPointerIds.delete(e.native.pointerId),this._update())},this.registerIncoming("pointer-down",this._onPointerAdd),this.registerIncoming("pointer-up",this._onPointerRemove),this.registerIncoming("pointer-capture-lost",this._onPointerRemove),this.registerIncoming("pointer-cancel",this._onPointerRemove)}_update(){this._multiTouchActive.value=this._activeTouchPointerIds.size>1}},Due=class{constructor(e,r){this._owner=r,this._properties={},this._afterDispatchHandle=null;for(const i in e){const s=e[i],n=new uV(s,void 0,void 0,2,2);this._properties[i]={pool:n,acquired:[]}}this._afterDispatchHandle=QK((()=>this._release()))}destroy(){this._afterDispatchHandle&&(this._afterDispatchHandle.remove(),this._afterDispatchHandle=null);for(const e in this._properties){const r=this._properties[e];for(const i of r.acquired)PR(i)||r.pool.release(i);r.pool.destroy(),r.pool=null,r.acquired=null}this._properties=null,this._owner=null}get(e){const r=this._owner._get(e),i=this._properties[e];let s=i.pool.acquire();for(i.acquired.push(s);s===r;)i.acquired.push(s),s=i.pool.acquire();return s}_release(){for(const e in this._properties){const r=this._properties[e];let i=0;for(const s of r.acquired)PR(s)?r.acquired[i++]=s:r.pool.release(s);r.acquired.length=i}}},Gs=class extends ce{constructor(e){super(e),this._pointerCaptures=new Map,this._nameToGroup={},this._handlers=[],this._handlersPriority=[],this._currentPropagation=null,this._updateDependenciesAfterPropagation=!1,this._sourceEvents=new Set,this._keyModifiers=new Set,this._activeKeyModifiers=new Set,this._stoppedPropagationEventIds=new Set,this.primaryKey=B9,this._latestPointerType="mouse",this._propertiesPool=new Due({latestPointerLocation:jue},this),this.latestPointerLocation=null,this._paused=!1,this.test={timestamp:void 0,hasCurrentPropagation:()=>!!this._currentPropagation}}initialize(){this.eventSource.onEventReceived=this._onEventReceived.bind(this),this._installRecognizers()}destroy(){const e=Object.keys(this._nameToGroup);for(const r of e)this.uninstallHandlers(r);this.eventSource.destroy(),this._currentPropagation=null,this._propertiesPool.destroy()}get hasPendingInputs(){return this._handlers.some((e=>e.handler.hasPendingInputs))}get latestPointerType(){return this._latestPointerType}get multiTouchActive(){return this._multiTouchHandler.multiTouchActive}get updating(){return this.hasPendingInputs||this._paused}installHandlers(e,r,i=kl.INTERNAL){if(this._nameToGroup[e]||r.length===0)return;const s={name:e,handlers:r.map((n=>({handler:n,active:!0,removed:!1,priorityIndex:0,groupPriority:i,eventCallback:null,uninstallCallback:null})))};this._nameToGroup[e]=s;for(let n=s.handlers.length-1;n>=0;n--){const o=s.handlers[n];this._handlers.push(o),o.handler.onInstall({updateDependencies:()=>{this.updateDependencies()},emit:(a,l,u,h,p)=>{this._emitInputEvent(o.priorityIndex+1,a,l,u,p,h)},setPointerCapture:(a,l)=>{this._setPointerCapture(s,o,a,l)},setEventCallback:a=>{o.eventCallback=a},setUninstallCallback:a=>{o.uninstallCallback=a},refreshHasPendingInputs:()=>{this.notifyChange("hasPendingInputs")}})}this.updateDependencies()}uninstallHandlers(e){const r=this._nameToGroup[e];r?(r.handlers.forEach((i=>{i.removed=!0,i.uninstallCallback?.()})),delete this._nameToGroup[e],this._currentPropagation?this._currentPropagation.needsHandlerGarbageCollect=!0:this._garbageCollectRemovedHandlers()):q.getLogger(this).error("There is no InputHandler group registered under the name `"+e+"`")}hasHandlers(e){return this._nameToGroup[e]!==void 0}isModifierKeyDown(e){return this._activeKeyModifiers.has(e)}updateDependencies(){if(this._currentPropagation)return void(this._updateDependenciesAfterPropagation=!0);this._updateDependenciesAfterPropagation=!1;const e=new Set,r=new Set;this._handlersPriority=[];for(let i=this._handlers.length-1;i>=0;i--){const s=this._handlers[i];s.priorityIndex=i,this._handlersPriority.push(s)}this._handlersPriority=this._sortHandlersPriority(this._handlersPriority);for(let i=this._handlersPriority.length-1;i>=0;i--){const s=this._handlersPriority[i];s.priorityIndex=i;let n=s.handler.hasSideEffects;if(!n){for(const o of s.handler.outgoingEventTypes)if(e.has(o)){n=!0;break}}if(n)for(const o of s.handler.incomingEventMatches){e.add(o.eventType);for(const a of o.keyModifiers)Aue(a)||r.add(a)}s.active=n}this._sourceEvents=e,this._keyModifiers=r,this._pointerCaptures.size>0&&this._sourceEvents.add("pointer-capture-lost"),this._keyModifiers.size>0&&(this._sourceEvents.add("key-down"),this._sourceEvents.add("key-up")),this.eventSource&&(this.eventSource.activeEvents=this._sourceEvents)}_setLatestPointer(e,r,i){this._latestPointerType=e;const s=this._get("latestPointerLocation");if(s==null||s.x!==r||s.y!==i){const n=this._propertiesPool.get("latestPointerLocation");n.x=r,n.y=i,this._set("latestPointerLocation",n)}}_onEventReceived(e,r){if(e==="pointer-capture-lost"){const n=r;this._pointerCaptures.delete(n.native.pointerId)}this._updateKeyModifiers(e,r);const i=this.test.timestamp!=null?this.test.timestamp:r.native?r.native.timestamp:void 0,s=r.native?r.native.cancelable:void 0;this._emitInputEventFromSource(e,r,i,s)}_updateKeyModifiers(e,r){if(!r)return;let i=!1;const s=()=>{i||(this._activeKeyModifiers=new Set(this._activeKeyModifiers),i=!0)},n=(a,l)=>{l&&!this._activeKeyModifiers.has(a)?(s(),this._activeKeyModifiers.add(a)):!l&&this._activeKeyModifiers.has(a)&&(s(),this._activeKeyModifiers.delete(a))};if(e==="key-down"||e==="key-up"){const a=r.key;this._keyModifiers.has(a)&&n(a,e==="key-down")}const o=r.native;n("Alt",!!o?.altKey),n("Control",!!o?.ctrlKey),n("Ctrl",!!o?.ctrlKey),n("Shift",!!o?.shiftKey),n("Meta",!!o?.metaKey),n("Primary",this._activeKeyModifiers.has(this.primaryKey))}_installRecognizers(){this._latestPointerHandler=new Oue(((e,r,i)=>this._setLatestPointer(e,r,i))),this._multiTouchHandler=new Fue,this.installHandlers("input-manager-logic",[this._latestPointerHandler,this._multiTouchHandler],kl.ALWAYS),this.recognizers.length>0&&this.installHandlers("default",this.recognizers,kl.INTERNAL)}_setPointerCapture(e,r,i,s){const n=e.name+"-"+r.priorityIndex,o=this._pointerCaptures.get(i.pointerId)||new Set;this._pointerCaptures.set(i.pointerId,o),s?(o.add(n),o.size===1&&this.eventSource&&this.eventSource.setPointerCapture(i,!0)):o.has(n)&&(o.delete(n),o.size===0&&(this._pointerCaptures.delete(i.pointerId),this.eventSource&&this.eventSource.setPointerCapture(i,!1)))}_garbageCollectRemovedHandlers(){this._handlers=this._handlers.filter((e=>!e.removed)),this.updateDependencies()}_emitInputEventFromSource(e,r,i,s){this._emitInputEvent(0,e,r,i,s)}_emitInputEvent(e,r,i,s,n,o){const a=s!==void 0?s:this._currentPropagation?this._currentPropagation.timestamp:performance.now(),l=n!==void 0&&n,u={event:new zue(r,i,a,o||this._activeKeyModifiers,l),priorityIndex:e};this._currentPropagation?this._currentPropagation.events.push(u):this._doNewPropagation(u)}_doNewPropagation(e){this._currentPropagation={events:new F0,currentHandler:null,needsHandlerGarbageCollect:!1,timestamp:e.event.timestamp},this._currentPropagation.events.push(e),this._continuePropagation()}_continuePropagation(){this._paused=!1;const e=this._currentPropagation;if(e){for(;e.events.length>0;){const{event:r,priorityIndex:i}=e.events.pop(),s=r.data?.eventId;if(!(s!=null&&this._stoppedPropagationEventIds.has(s)))for(e.currentHandler=this._handlersPriority[i];e.currentHandler;){if(e.currentHandler.removed)e.needsHandlerGarbageCollect=!0;else{if(e.currentHandler.active&&!r.shouldStopPropagation()&&e.currentHandler.eventCallback?.(r),r.shouldStopPropagation()){s!=null&&this._stoppedPropagationEventIds.add(s);break}if(r.shouldPausePropagation((()=>this._continuePropagation())))return void this._pausePropagation({event:r,priorityIndex:e.currentHandler.priorityIndex+1})}e.currentHandler=this._handlersPriority[e.currentHandler.priorityIndex+1]}}e.needsHandlerGarbageCollect&&this._garbageCollectRemovedHandlers(),this.hasPendingInputs||this._stoppedPropagationEventIds.clear(),this._currentPropagation=null,this._updateDependenciesAfterPropagation&&this.updateDependencies()}}_pausePropagation(e){const r=new F0;r.push(e);const i=this._currentPropagation;if(i){for(;i.events.length;)r.push(i.events.pop());i.events=r,i.currentHandler=null,this._paused=!0}}_compareHandlerPriority(e,r){if(e.handler.hasSideEffects!==r.handler.hasSideEffects)return e.handler.hasSideEffects?1:-1;if(e.groupPriority!==r.groupPriority)return e.groupPriority>r.groupPriority?-1:1;for(const i of e.handler.incomingEventMatches)for(const s of r.handler.incomingEventMatches){if(i.eventType!==s.eventType)continue;const n=i.keyModifiers.filter((o=>s.keyModifiers.includes(o)));if(n.length===i.keyModifiers.length!=(n.length===s.keyModifiers.length))return i.keyModifiers.length>s.keyModifiers.length?-1:1}return e.priorityIndex>r.priorityIndex?-1:1}_sortHandlersPriority(e){const r=[];for(const i of e){let s=0;for(;s<r.length&&this._compareHandlerPriority(i,r[s])>=0;)s++;r.splice(s,0,i)}return r}get debug(){const e=r=>{const i=this._setPointerCapture;this._setPointerCapture=()=>{},r(),this._setPointerCapture=i};return{injectEvent:(r,i)=>{e((()=>this._onEventReceived(r,i)))},disablePointerCapture:e}}};c([d({readOnly:!0})],Gs.prototype,"hasPendingInputs",null),c([d({constructOnly:!0})],Gs.prototype,"eventSource",void 0),c([d({constructOnly:!0})],Gs.prototype,"recognizers",void 0),c([d()],Gs.prototype,"_latestPointerType",void 0),c([d()],Gs.prototype,"latestPointerType",null),c([d()],Gs.prototype,"multiTouchActive",null),c([d({readOnly:!0})],Gs.prototype,"latestPointerLocation",void 0),c([d()],Gs.prototype,"_paused",void 0),c([d({readOnly:!0})],Gs.prototype,"updating",null),Gs=c([C("esri.views.input.InputManager")],Gs);let zue=class{constructor(e,r,i,s,n){this.type=e,this.data=r,this.timestamp=i,this.modifiers=s,this.cancelable=n,this._propagationState=Pu.NONE,this._resumeCallback=null}stopPropagation(){this._propagationState|=Pu.STOPPED}shouldStopPropagation(){return(this._propagationState&Pu.STOPPED)!==0}defer(e){this._propagationState|=Pu.PAUSED;const r=(i,s)=>{this._propagationState&=~Pu.PAUSED;const n=this._resumeCallback;if(this._resumeCallback=null,n&&n(),s)throw i;return i};return(typeof e=="function"?e():e).then((i=>r(i,!1)),(i=>r(i,!0)))}shouldPausePropagation(e){return!!(this._propagationState&Pu.PAUSED)&&(this._resumeCallback=e,!0)}preventDefault(){this.data.native.preventDefault()}};var Pu;(function(t){t[t.NONE=0]="NONE",t[t.STOPPED=1]="STOPPED",t[t.PAUSED=2]="PAUSED"})(Pu||(Pu={}));const kl={ALWAYS:1,DEFAULT:0,TOOL:-1,WIDGET:-2,INTERNAL:-3};let Vue=class{};const jue=Vue;function nu(t){return t!=null&&"open"in t&&"declaredClass"in t}function kO(t){return t!=null&&"declaredClass"in t&&"dockOptions"in t}const Uue=t=>{let e=class extends t{constructor(){super(...arguments),this._popupSetupTask=null,this.popup={},this.popupEnabled=!0}initialize(){this.addHandles([ie((()=>[this.ui,this.popup]),(([r,i],s)=>{const n="popup",o="manual";if(s){const[a,l]=s;a&&nu(l)&&(l.view=null,kO(l)&&(a.remove(l,n),l!==i&&i&&l.destroy()))}r&&nu(i)&&(i.view=this,kO(i)&&r.add(i,{key:n,position:o,internal:!0}))}),Oi),this.on("click",(r=>{this.popup&&this.popupEnabled&&(r.pointerType!=="mouse"||r.button===0)&&(nu(this.popup)?this.popup.viewModel.handleViewClick(r):r.defer((async()=>{await this.setupPopup(),nu(this.popup)&&!this.destroyed&&this.ready&&this.popupEnabled&&this.popup.viewModel.handleViewClick(r)})))}),kl.WIDGET)]),Ev((()=>this.ready&&this.popupEnabled&&!this.updating)).then((()=>{J(()=>import("./Popup-QY14Ao02.js").then(r=>r.P),__vite__mapDeps([153,154,4,155,156,157,158,69,67,68,24,29,159,160,161,162]))}))}destroy(){this.destroyed||this.closePopup()}async openPopup(r){if(nu(this.popup))return this.popup.open(r);try{if(await this.setupPopup(),!this.popup)return void q.getLogger(this).error(new F("view:null-popup","Popup is null and can't be opened"));this.popup.open(r)}catch{}}closePopup(){this._popupSetupTask?.abort(),nu(this.popup)&&this.popup.close()}async fetchPopupFeatures(r,i){return await this.when(),this._popupHitsToFeatures(await this._getPopupHits(r,i),i)}async setupPopup(){if(this._popupSetupTask?.abort(),this.popup&&!nu(this.popup))return this._popupSetupTask=YS((async r=>{const{default:i}=await J(()=>import("./Popup-QY14Ao02.js").then(n=>n.P),__vite__mapDeps([153,154,4,155,156,157,158,69,67,68,24,29,159,160,161,162]));if(xt(r),!this.popup||nu(this.popup))return;const s=this.popup;delete s.open,delete s.close,this.popup=new i(s)})),this._popupSetupTask.promise}async _popupHitsToFeatures({location:r,hits:i},s){const n=[],o=[];let a=!1;const l=IX(s,z("popup-view-fetch-timeout")??Bue),u=m=>{const y=new Gue(m);return o.push(y),n.push(y.promise),y},h=m=>{const y=o.at(-1);return y&&y.layerView===m&&!a?y:u(m)};for(const m of i)"graphic"in m?(h(m.layerView).graphics.push(m.graphic),a=!1):(n.push(m.layerView.fetchPopupFeaturesAtLocation(m.mapPoint,l)),a=!0);o.map((m=>m.resolve(l)));const p=EX(n).then((m=>m.filter((y=>!!y)).flat()));return{pendingFeatures:n,allGraphicsPromise:p,location:r}}async _getPopupHits(r,i){const{hits:s,location:n}=await this.popupHitTest(r);xt(i);const o=[];for(const a of s)if("graphic"in a){if(this._isValidPopupGraphic(a.graphic,i)){const l=this._isValidPopupGraphicsLayerView(a.layerView)?a.layerView:void 0;o.push({graphic:a.graphic,layerView:l})}}else this._isValidPopupLocationLayerView(a.layerView)&&o.push({mapPoint:a.mapPoint,layerView:a.layerView});return{hits:o,location:n}}_isValidPopupGraphic(r,i){return r&&!!r.getEffectivePopupTemplate(i?.defaultPopupTemplateEnabled)}_isValidPopupGraphicsLayerView(r){return!r||(!("layer"in r)||!r.suspended)&&"fetchPopupFeaturesFromGraphics"in r}_isValidPopupLocationLayerView(r){return(!("layer"in r)||!r.suspended)&&"fetchPopupFeaturesAtLocation"in r}};return c([d()],e.prototype,"popup",void 0),c([d()],e.prototype,"popupEnabled",void 0),e=c([C("esri.views.PopupView")],e),e};let Gue=class{constructor(e){this.layerView=e,this._resolver=Ns(),this.graphics=[]}get promise(){return this._resolver.promise}resolve(e){const{layerView:r,graphics:i,_resolver:s}=this;if(!r)return s.resolve(i),s.promise;let n;return r.fetchPopupFeaturesFromGraphics(i,e).catch((o=>(n=o,null))).then((o=>{o?s.resolve(o):s.reject(n)})),s.promise}};const Bue=5e3;let s0=class extends se{constructor(e){super(e),this.addHandles([this.on("before-add",(r=>{r.item==null&&r.preventDefault()})),this.on("after-add",(r=>this._own(r.item))),this.on("after-remove",(r=>this._release(r.item)))])}get owner(){return this._get("owner")}set owner(e){e!==this._get("owner")&&(this._releaseAll(),this._set("owner",e),this._ownAll())}_ownAll(){for(const e of this.items)this._own(e)}_releaseAll(){for(const e of this.items)this._release(e)}_createNewInstance(e){return this.itemType?new(se.ofType(this.itemType.Type))(e):new se(e)}};function OO(t,e){return{type:t,cast:kV,set(r){const i=zl(r,this._get(e),t);i.owner=this,this._set(e,i)}}}c([d()],s0.prototype,"owner",null),s0=c([C("esri.core.support.OwningCollection")],s0);var eg;const Lw=Wr()({orthometric:"gravity-related-height",gravity_related_height:"gravity-related-height",ellipsoidal:"ellipsoidal"}),q9=Lw.jsonValues.slice();PY(q9,"orthometric");const n0=Wr()({meter:"meters",foot:"feet","us-foot":"us-feet","clarke-foot":"clarke-feet","clarke-yard":"clarke-yards","clarke-link":"clarke-links","sears-yard":"sears-yards","sears-foot":"sears-feet","sears-chain":"sears-chains","benoit-1895-b-chain":"benoit-1895-b-chains","indian-yard":"indian-yards","indian-1937-yard":"indian-1937-yards","gold-coast-foot":"gold-coast-feet","sears-1922-truncated-chain":"sears-1922-truncated-chains","50-kilometers":"50-kilometers","150-kilometers":"150-kilometers"});let Ai=eg=class extends W{constructor(t){super(t),this.heightModel="gravity-related-height",this.heightUnit="meters",this.vertCRS=null}writeHeightModel(t,e,r){return Lw.write(t,e,r)}readHeightModel(t,e,r){return Lw.read(t)||(r?.messages&&r.messages.push(que(t,{context:r})),null)}readHeightUnit(t,e,r){return n0.read(t)||(r?.messages&&r.messages.push(NO(t,{context:r})),null)}readHeightUnitService(t,e,r){return w3(t)||n0.read(t)||(r?.messages&&r.messages.push(NO(t,{context:r})),null)}readVertCRS(t,e){return e.vertCRS||e.ellipsoid||e.geoid}clone(){return new eg({heightModel:this.heightModel,heightUnit:this.heightUnit,vertCRS:this.vertCRS})}equals(t){return!!t&&(this===t||this.heightModel===t.heightModel&&this.heightUnit===t.heightUnit&&this.vertCRS===t.vertCRS)}static deriveUnitFromSR(t,e){const r=oj(e);return new eg({heightModel:t.heightModel,heightUnit:r??void 0,vertCRS:t.vertCRS})}write(t,e){return e={origin:"web-scene",...e},super.write(t,e)}static fromJSON(t){if(!t)return null;const e=new eg;return e.read(t,{origin:"web-scene"}),e}};function NO(t,e){return new Fs("height-unit:unsupported",`Height unit of value '${t}' is not supported`,e)}function que(t,e){return new Fs("height-model:unsupported",`Height model of value '${t}' is not supported`,e)}c([d({type:Lw.apiValues,constructOnly:!0,json:{origins:{"web-scene":{type:q9,default:"ellipsoidal",write:{isRequired:!0}}}}})],Ai.prototype,"heightModel",void 0),c([re("web-scene","heightModel")],Ai.prototype,"writeHeightModel",null),c([K(["web-scene","service"],"heightModel")],Ai.prototype,"readHeightModel",null),c([d({type:n0.apiValues,constructOnly:!0,json:{origins:{"web-scene":{type:n0.jsonValues,write:{writer:n0.write,isRequired:!0}}}}})],Ai.prototype,"heightUnit",void 0),c([K("web-scene","heightUnit")],Ai.prototype,"readHeightUnit",null),c([K("service","heightUnit")],Ai.prototype,"readHeightUnitService",null),c([d({type:String,constructOnly:!0,json:{origins:{"web-scene":{write:!0}}}})],Ai.prototype,"vertCRS",void 0),c([K("service","vertCRS",["vertCRS","ellipsoid","geoid"])],Ai.prototype,"readVertCRS",null),Ai=eg=c([C("esri.geometry.HeightModelInfo")],Ai);let Rw=class extends s0{constructor(e){super(e),this.addHandles(this.on("before-add",(r=>{r.item!=null&&r.item.parent===this.owner&&(q.getLogger(this).warn("Analysis inside the collection must be unique. Not adding this element again."),r.preventDefault())})))}_own(e){e.parent=this.owner}_release(e){e.parent=null}};Rw=c([C("esri.support.AnalysesCollection")],Rw);let Bx;async function Hue(){return Bx==null&&(Bx=J(()=>import("./WhereClauseCache-D5cd6bMJ.js"),__vite__mapDeps([30,31])).then((t=>new t.WhereClauseCache(500,500)))),Bx}async function oA(t,e){const r=await Hue(),i=r.get(t,e);if(i==null)throw r.getError(t,e);return i}function H9(t,e){return t||=null,e||=null,t==="1=1"?e??t:e==="1=1"?t??e:t&&e?`(${t}) AND (${e})`:t??e}function Wue(t,e){return t||=null,e||=null,t==="1=1"||e==="1=1"||t===e?t==="1=1"?t:e:t&&e?`(${t}) OR (${e})`:t??e}function DOe(t,e){return e.length===0?null:`${t} IN (${Zue(e)})`}function Zue(t){return t.map((e=>typeof e=="string"?Jue(e):e)).join(",")}function Jue(t){return`'${t.replaceAll("'","''")}'`}function _d(t){return typeof t=="number"}function zOe(t){return typeof t=="number"&&isFinite(t)&&Math.floor(t)===t}function VOe(t){return typeof t=="boolean"}function Lv(t){return typeof t=="string"||t instanceof String}function Yue(t){return t==null||Lv(t)}function jOe(t){return Array.isArray(t)}function UOe(t){return t?.declaredClass==="esri.Graphic"}function GOe(t){return t instanceof Date}const Xue="HH:mm",Kue="HH:mm:ss",Que="HH:mm:ss.SSS",ece=[Que,Kue,Xue,"TT"],tce="yyyy-MM-dd";function FO(t){if(!t||!Lv(t))return null;const e=ue.fromFormat(t,tce);return e.isValid?e:null}function DO(t){return t&&Lv(t)?Nz(ece,(e=>{const r=ue.fromFormat(t,e);return r.isValid?r:null}))??null:null}function zO(t){if(!t||!Lv(t))return null;const e=ue.fromISO(t);return e.isValid?e:null}var kw;(function(t){t.VALUE_OUT_OF_RANGE="domain-validation-error::value-out-of-range",t.INVALID_CODED_VALUE="domain-validation-error::invalid-coded-value"})(kw||(kw={}));const W9=new Set(["integer","small-integer","long","big-integer","esriFieldTypeInteger","esriFieldTypeSmallInteger","esriFieldTypeLong","esriFieldTypeBigInteger"]);function rce(t){return t!=null&&W9.has(t.type)}function Z9(t){return t!=null&&(t.type==="date-only"||t.type==="esriFieldTypeDateOnly")}function J9(t){return t!=null&&(t.type==="timestamp-offset"||t.type==="esriFieldTypeTimestampOffset")}function Y9(t){return t!=null&&(t.type==="time-only"||t.type==="esriFieldTypeTimeOnly")}const ice=new Set(["single","double","esriFieldTypeSingle","esriFieldTypeDouble"]);o3(W9,ice);function BOe(t,e){const r=t?.domain;if(!r||r.type!=="range")return;const i="range"in r?r.range[0]:r.minValue,s="range"in r?r.range[1]:r.maxValue,n=rce(t);return Z9(t)||Y9(t)||J9(t)?{...sce(t,s,i),isInteger:n}:{min:i!=null&&typeof i=="number"?i:null,max:s!=null&&typeof s=="number"?s:null,rawMin:i,rawMax:s,isInteger:n}}function sce(t,e,r){return Z9(t)?{min:FO(r)?.toMillis(),max:FO(e)?.toMillis(),rawMin:r,rawMax:e}:Y9(t)?{min:DO(r)?.toMillis(),max:DO(e)?.toMillis(),rawMin:r,rawMax:e}:J9(t)?{min:zO(r)?.toMillis(),max:zO(e)?.toMillis(),rawMin:r,rawMax:e}:{max:null,min:null}}function nce(t){if(!t)return;const e=t.match(oce);return e?.groups?e.groups.doubleQuoted??e.groups.singleQuoted??e.groups.dotNotation:void 0}const oce=/^(\$feature\[(?:"(?<doubleQuoted>[^"]+)"|'(?<singleQuoted>[^']+)')\]|\$feature\.(?<dotNotation>[a-zA-Z_][a-zA-Z0-9_]*))$/i;function ace(t){return t.match(lce)?.[1]?.replace(/\\'/g,"'")??null}const lce=/^hash\(\$feature\['((\\'|[^'])+)'\]\) \* 8\.381e-8$/;let qx;function jl(){return qx||(qx=(async()=>{const[t,e,r]=await Promise.all([J(()=>import("./arcadeUtils-YoRP2rat.js"),__vite__mapDeps([163,164,165,166,159,40,167,28,24,29,31,168])),J(()=>import("./batchExec-CfRd1Izs.js"),__vite__mapDeps([169,88])),J(()=>import("./aiServices-ChHDnQpT.js").then(i=>i.ag),__vite__mapDeps([165,166,159,40,167]))]);return{arcade:t.arcade,arcadeUtils:t,batchExec:e,aiServices:r,Dictionary:t.Dictionary,Feature:t.arcadeFeature,Voxel:t.Voxel}})()),qx}const uce=/^([0-9_])/,cce=/[^a-z0-9_\u0080-\uffff]+/gi;function hce(t){return t==null?null:t.trim().replaceAll(cce,"_").replace(uce,"F$1")||null}const dce=["field","field2","field3","normalizationField","rotationInfo.field","proportionalSymbolInfo.field","proportionalSymbolInfo.normalizationField","colorInfo.field","colorInfo.normalizationField"],pce=["field","normalizationField"];function VO(t,e){if(t!=null&&e!=null){for(const r of Array.isArray(t)?t:[t])if(jO(dce,r,e),"visualVariables"in r&&r.visualVariables)for(const i of r.visualVariables)jO(pce,i,e)}}function jO(t,e,r){if(t)for(const i of t){const s=fv(i,e),n=s&&typeof s!="function"&&r.get(s);n&&Cr(i,n.name,e)}}function X9(t,e){if(t!=null&&e?.fields?.length)if("startField"in t){const r=e.get(t.startField),i=e.get(t.endField);t.startField=r?.name??null,t.endField=i?.name??null}else{const r=e.get(t.startTimeField),i=e.get(t.endTimeField);t.startTimeField=r?.name??null,t.endTimeField=i?.name??null}}const Hx=new Set;function w2(t,e){return t&&e?(Hx.clear(),dc(Hx,t,e),Array.from(Hx).sort()):[]}function dc(t,e,r){if(r)if(e?.fields?.length)if(r.includes("*"))for(const{name:i}of e.fields)t.add(i);else for(const i of r)Bi(t,e,i);else{if(r.includes("*"))return t.clear(),void t.add("*");for(const i of r)i!=null&&t.add(i)}}function Bi(t,e,r){if(typeof r=="string")if(e){const i=e.get(r);i&&t.add(i.name)}else t.add(r)}function qOe(t,e){return e==null||t==null?[]:e.includes("*")?(t.fields??[]).map((r=>r.name)):e}function HOe(t,e,r=1){if(!e||!t)return[];if(e.includes("*"))return["*"];const i=w2(t,e);return i.length/t.fields.length>=r?["*"]:i}async function si(t,e,r){if(!r)return;let i;const s=nce(r);if(s)i=[s];else{const{arcadeUtils:n}=await jl();i=n.extractFieldNames(r,e?.fields?.map((o=>o.name)))}for(const n of i)Bi(t,e,n)}async function aA(t,e,r){if(r&&r!=="1=1"){const i=await oA(r,e);if(!i.isStandardized)throw new F("fieldUtils:collectFilterFields","Where clause is not standardized",{where:r});dc(t,e,i.fieldNames)}}function fce({displayField:t,fields:e}){return t||(e?.length?Wx(e,"name-or-title")||Wx(e,"unique-identifier")||Wx(e,"type-or-category")||mce(e):null)}function mce(t){for(const e of t){if(!e?.name)continue;const r=e.name.toLowerCase();if(r.includes("name")||r.includes("title"))return e.name}return null}function Wx(t,e){for(const r of t)if(r?.valueType&&r.valueType===e)return r.name;return null}async function WOe(t,e){if(!e)return;const r=e.elevationInfo?.featureExpressionInfo;return r?r.collectRequiredFields(t,e.fieldsIndex):void 0}function yce(t,e,r){r.onStatisticExpression?si(t,e,r.onStatisticExpression.expression):t.add(r.onStatisticField)}async function ZOe(t,e,r){if(!e||!r||!("fields"in r))return;const i=[],s=r.popupTemplate;i.push(K9(t,e,s)),r.fields&&i.push(...r.fields.map((async n=>yce(t,e.fieldsIndex,n)))),await Promise.all(i)}async function JOe(t,e){const{fieldsIndex:r,trackInfo:i}=e;if(!e||!i||!r)return;const s=[i.latestObservations.renderer?.collectRequiredFields(t,r),i.previousObservations.renderer?.collectRequiredFields(t,r),i.trackLines.renderer?.collectRequiredFields(t,r)];i.popupTemplate&&s.push(K9(t,e,i.popupTemplate));for(const n of[i.latestObservations.labelingInfo,i.previousObservations.labelingInfo,i.trackLines.labelingInfo])if(n)for(const o of n)s.push(tG(t,r,o));await Promise.all(s)}async function K9(t,e,r){const i=[];r?.expressionInfos&&i.push(...r.expressionInfos.map((n=>si(t,e.fieldsIndex,n.expression))));const s=r?.content;if(Array.isArray(s))for(const n of s)n.type==="expression"&&n.expressionInfo&&i.push(si(t,e.fieldsIndex,n.expressionInfo.expression));await Promise.all(i)}async function YOe(t,e,r){e&&(e.timeInfo&&r?.timeExtent&&dc(t,e.fieldsIndex,[e.timeInfo.startField,e.timeInfo.endField]),e.floorInfo&&dc(t,e.fieldsIndex,[e.floorInfo.floorField]),r?.where!=null&&await aA(t,e.fieldsIndex,r.where))}async function XOe(t,e,r){e&&r&&await Promise.all(r.map((i=>gce(t,e,i))))}async function gce(t,e,r){e&&r&&(r.valueExpression?await si(t,e.fieldsIndex,r.valueExpression):r.field&&Bi(t,e.fieldsIndex,r.field))}function KOe(t){return t?w2(t.fieldsIndex,Q9(t)):[]}function vce(t){if(!t)return[];const e=t.geometryFieldsInfo;return e?w2(t.fieldsIndex,[e.shapeAreaField,e.shapeLengthField]):[]}async function QOe(t,e,r){if(!e||!r)return;const i=e.fieldsIndex;await Promise.all(r.filters.map((s=>aA(t,i,s.where))))}const _ce=new Set(["oid","global-id","guid"]),bce=new Set(["oid","global-id"]),wce=[/^fnode_$/i,/^tnode_$/i,/^lpoly_$/i,/^rpoly_$/i,/^poly_$/i,/^shape$/i,/^shape_$/i,/^subclass$/i,/^subclass_$/i,/^rings_ok$/i,/^rings_nok$/i,/objectid/i,/^perimeter_/i,/_perimeter$/i,/_i$/i];function Sce(t){const e=new Set;eG(t).forEach((i=>e.add(i))),vce(t).forEach((i=>e.add(i.toLowerCase())));const r=t&&"infoFor3D"in t?t.infoFor3D:void 0;return r&&(Object.values(r.assetMapFieldRoles).forEach((i=>e.add(i.toLowerCase()))),Object.values(r.transformFieldRoles).forEach((i=>e.add(i.toLowerCase())))),Array.from(e)}function Q9(t){if(!t)return[];const e="editFieldsInfo"in t&&t.editFieldsInfo;if(!e)return[];const{creationDateField:r,creatorField:i,editDateField:s,editorField:n}=e;return[r,i,s,n].filter(Boolean)}function eG(t){return Q9(t).map((e=>e.toLowerCase()))}function xce(t,e){return t.editable&&!_ce.has(t.type)&&!eG(e).includes(t.name?.toLowerCase()??"")}function $ce(t,e){const r=t.name?.toLowerCase()??"";return!(e?.objectIdField!=null&&r===e.objectIdField.toLowerCase()||e?.globalIdField!=null&&r===e.globalIdField.toLowerCase()||Sce(e).includes(r)||bce.has(t.type)||wce.some((i=>i.test(r))))}async function eNe(t,e){const{labelingInfo:r,fieldsIndex:i}=e;r?.length&&await Promise.all(r.map((s=>tG(t,i,s))))}async function tG(t,e,r){if(!r)return;const i=r.getLabelExpression(),s=r.where;if(i.type==="arcade")await si(t,e,i.expression);else{const n=i.expression.match(/{[^}]*}/g);n&&n.forEach((o=>{Bi(t,e,o.slice(1,-1))}))}await aA(t,e,s)}function Mce(t){const e=t.defaultValue;return e!==void 0&&iG(t,e)?e:t.nullable?null:void 0}function tNe(t){const e=typeof t=="string"?{type:t}:t;return oG(e)?255:e.type==="esriFieldTypeDate"||e.type==="date"?8:void 0}function rG(t){return typeof t=="number"&&!isNaN(t)&&isFinite(t)}function Tce(t){return t===null||rG(t)}function Ece(t){return t===null||Number.isInteger(t)}function Ice(){return!0}function iG(t,e){let r;switch(t.type){case"date":case"integer":case"long":case"small-integer":case"big-integer":case"esriFieldTypeDate":case"esriFieldTypeInteger":case"esriFieldTypeLong":case"esriFieldTypeSmallInteger":case"esriFieldTypeBigInteger":r=t.nullable?Ece:Number.isInteger;break;case"double":case"single":case"esriFieldTypeSingle":case"esriFieldTypeDouble":r=t.nullable?Tce:rG;break;case"string":case"esriFieldTypeString":r=t.nullable?Yue:Lv;break;default:r=Ice}return arguments.length===1?r:r(e)}const Cce=["integer","small-integer","big-integer","long"],Pce=["single","double"],Ace=["esriFieldTypeInteger","esriFieldTypeSmallInteger","esriFieldTypeLong","esriFieldTypeBigInteger"],Lce=["esriFieldTypeSingle","esriFieldTypeDouble"],sG=new Set([...Cce,...Ace]),Rce=new Set([...Pce,...Lce]),kce=o3(sG,Rce);function Oce(t){return t!=null&&sG.has(t.type)}function nG(t){return t!=null&&kce.has(t.type)}function oG(t){return t!=null&&(t.type==="string"||t.type==="esriFieldTypeString")}function lA(t){return t!=null&&(t.type==="date"||t.type==="esriFieldTypeDate")}function Nce(t){return t!=null&&(t.type==="date-only"||t.type==="esriFieldTypeDateOnly")}function Fce(t){return t!=null&&(t.type==="timestamp-offset"||t.type==="esriFieldTypeTimestampOffset")}function aG(t){return t!=null&&(t.type==="time-only"||t.type==="esriFieldTypeTimeOnly")}function UO(t){return t!=null&&(t.type==="oid"||t.type==="esriFieldTypeOID")}function GO(t){return t!=null&&(t.type==="global-id"||t.type==="esriFieldTypeGlobalID")}function rNe(t,e){return Dce(t,e)===null}var Ow,Nw;function iNe(t){return t==null||typeof t=="number"&&isNaN(t)?null:t}function Dce(t,e){return t==null||t.nullable&&e===null?null:iG(t,e)?nG(t)&&!zce(t.type,Number(e))?Ow.OUT_OF_RANGE:null:Nw.INVALID_TYPE}function zce(t,e){const r=typeof t=="string"?lG(t):t;if(!r)return!1;const i=r.min,s=r.max;return r.isInteger?Number.isInteger(e)&&e>=i&&e<=s:e>=i&&e<=s}function lG(t){switch(t){case"esriFieldTypeSmallInteger":case"small-integer":return Vce;case"esriFieldTypeInteger":case"esriFieldTypeLong":case"integer":case"long":return jce;case"esriFieldTypeBigInteger":case"big-integer":return Uce;case"esriFieldTypeSingle":case"single":return Gce;case"esriFieldTypeDouble":case"double":return Bce}}(function(t){t.OUT_OF_RANGE="numeric-range-validation-error::out-of-range"})(Ow||(Ow={})),(function(t){t.INVALID_TYPE="type-validation-error::invalid-type"})(Nw||(Nw={}));const Vce={min:-32768,max:32767,isInteger:!0,rawMin:-32768,rawMax:32767},jce={min:-2147483648,max:2147483647,isInteger:!0,rawMin:-2147483648,rawMax:2147483647},Uce={min:-Number.MAX_SAFE_INTEGER,max:Number.MAX_SAFE_INTEGER,isInteger:!0,rawMin:-Number.MAX_SAFE_INTEGER,rawMax:Number.MAX_SAFE_INTEGER},Gce={min:-34e37,max:12e37,isInteger:!1,rawMin:-34e37,rawMax:12e37},Bce={min:-Number.MAX_VALUE,max:Number.MAX_VALUE,isInteger:!1,rawMin:-Number.MAX_VALUE,rawMax:Number.MAX_VALUE};function sNe(t,e,r){switch(t){case kw.INVALID_CODED_VALUE:return`Value ${r} is not in the coded domain - field: ${e.name}, domain: ${JSON.stringify(e.domain)}`;case kw.VALUE_OUT_OF_RANGE:return`Value ${r} is out of the range of valid values - field: ${e.name}, domain: ${JSON.stringify(e.domain)}`;case Nw.INVALID_TYPE:return`Value ${r} is not a valid value for the field type - field: ${e.name}, type: ${e.type}, nullable: ${e.nullable}`;case Ow.OUT_OF_RANGE:{const{min:i,max:s}=lG(e.type);return`Value ${r} is out of range for the number type - field: ${e.name}, type: ${e.type}, value range is ${i} to ${s}`}}}function qce(t,e){return!Hce(t,e,null)}function Hce(t,e,r){if(!t?.attributes||!e)return!0;const i=new Set(Object.keys(t.attributes));let s=!1;for(const n of e)if(!i.has(n)&&(s=!0,r==null))break;return s}function Wce(t){return!!t&&["raster.itempixelvalue","raster.servicepixelvalue"].some((e=>t.toLowerCase().startsWith(e)))}function uA(t){const e=t?.match(/{[^}]+}/g);return e?e.map((r=>r.slice(1,-1).split(":")[0].trim())):[]}let G1=class extends W{constructor(e){super(e),this.type=null}};c([d({type:["attachments","custom","fields","media","text","expression","relationship","utility-network-associations"],readOnly:!0,json:{read:!1,write:!0}})],G1.prototype,"type",void 0),G1=c([C("esri.popup.content.Content")],G1);const ql=G1,M_=new De({asc:"ascending",desc:"descending"});let tg=class extends Ce.ClonableMixin(W){constructor(e){super(e),this.field=null,this.order="ascending"}};c([d({type:String,json:{write:!0}})],tg.prototype,"field",void 0),c([d({type:M_.apiValues,json:{type:M_.jsonValues,read:M_.read,write:M_.write}})],tg.prototype,"order",void 0),tg=c([C("esri.popup.support.AttachmentsOrderByInfo")],tg);const Zce=tg;let fu=class extends Ce.ClonableMixin(ql){constructor(e){super(e),this.description=null,this.displayType="auto",this.orderByFields=null,this.title=null,this.type="attachments"}};c([d({type:String,json:{write:!0}})],fu.prototype,"description",void 0),c([d({type:["auto","preview","list"],json:{write:!0}})],fu.prototype,"displayType",void 0),c([d({type:[Zce],json:{write:!0}})],fu.prototype,"orderByFields",void 0),c([d({type:String,json:{write:!0}})],fu.prototype,"title",void 0),c([d({type:["attachments"],readOnly:!0,json:{read:!1,write:{isRequired:!0}}})],fu.prototype,"type",void 0),fu=c([C("esri.popup.content.AttachmentsContent")],fu);const vm=fu;var jT;let Bc=jT=class extends ql{constructor(t){super(t),this.creator=null,this.destroyer=null,this.outFields=null,this.type="custom"}clone(){return new jT({creator:this.creator,destroyer:this.destroyer,outFields:Array.isArray(this.outFields)?k(this.outFields):null})}};c([d()],Bc.prototype,"creator",void 0),c([d()],Bc.prototype,"destroyer",void 0),c([d()],Bc.prototype,"outFields",void 0),c([d({type:["custom"],readOnly:!0})],Bc.prototype,"type",void 0),Bc=jT=c([C("esri.popup.content.CustomContent")],Bc);const Jce=Bc;var UT;let up=UT=class extends W{constructor(t){super(t),this.title=null,this.expression=null,this.returnType="dictionary"}clone(){return new UT({title:this.title,expression:this.expression})}};c([d({type:String,json:{write:!0}})],up.prototype,"title",void 0),c([d({type:String,json:{write:!0}})],up.prototype,"expression",void 0),c([d({type:["dictionary"],readOnly:!0,json:{read:!1,write:!0}})],up.prototype,"returnType",void 0),up=UT=c([C("esri.popup.ElementExpressionInfo")],up);const Yce=up;var GT;let rg=GT=class extends ql{constructor(t){super(t),this.expressionInfo=null,this.type="expression"}clone(){return new GT({expressionInfo:this.expressionInfo?.clone()})}};c([d({type:Yce,json:{write:!0}})],rg.prototype,"expressionInfo",void 0),c([d({type:["expression"],readOnly:!0,json:{read:!1,write:!0}})],rg.prototype,"type",void 0),rg=GT=c([C("esri.popup.content.ExpressionContent")],rg);const S2=rg;let cp=class extends Ce.ClonableMixin(W){constructor(e){super(e),this.dateFormat=null,this.digitSeparator=!1,this.places=null}};c([ye(Nie)],cp.prototype,"dateFormat",void 0),c([d({type:Boolean,json:{write:!0}})],cp.prototype,"digitSeparator",void 0),c([d({type:qe,json:{write:!0}})],cp.prototype,"places",void 0),cp=c([C("esri.popup.support.FieldInfoFormat")],cp);const B1=cp;var BT;let Rn=BT=class extends W{constructor(t){super(t),this.fieldName=null,this.format=void 0,this.isEditable=!0,this.label=null,this.stringFieldOption="text-box",this.statisticType=null,this.tooltip=null,this.visible=!0}clone(){return new BT({fieldName:this.fieldName,format:this.format?.clone(),isEditable:this.isEditable,label:this.label,stringFieldOption:this.stringFieldOption,statisticType:this.statisticType,tooltip:this.tooltip,visible:this.visible})}};c([d({type:String,json:{write:!0}})],Rn.prototype,"fieldName",void 0),c([d({type:B1,json:{write:!0}})],Rn.prototype,"format",void 0),c([d({type:Boolean,json:{write:{alwaysWriteDefaults:!0},default:!0}})],Rn.prototype,"isEditable",void 0),c([d({type:String,json:{write:!0}})],Rn.prototype,"label",void 0),c([ye(new De({richtext:"rich-text",textarea:"text-area",textbox:"text-box"}),{default:"text-box"})],Rn.prototype,"stringFieldOption",void 0),c([d({type:["count","sum","min","max","avg","stddev","var"],json:{write:!0}})],Rn.prototype,"statisticType",void 0),c([d({type:String,json:{write:!0}})],Rn.prototype,"tooltip",void 0),c([d({type:Boolean,json:{write:!0}})],Rn.prototype,"visible",void 0),Rn=BT=c([C("esri.popup.FieldInfo")],Rn);const cA=Rn;var qT;let Ja=qT=class extends ql{constructor(t){super(t),this.attributes=null,this.description=null,this.fieldInfos=null,this.title=null,this.type="fields"}writeFieldInfos(t,e){e.fieldInfos=t&&t.map((r=>r.toJSON()))}clone(){return new qT(k({attributes:this.attributes,description:this.description,fieldInfos:this.fieldInfos,title:this.title}))}};c([d({type:Object,json:{write:!0}})],Ja.prototype,"attributes",void 0),c([d({type:String,json:{write:!0}})],Ja.prototype,"description",void 0),c([d({type:[cA]})],Ja.prototype,"fieldInfos",void 0),c([re("fieldInfos")],Ja.prototype,"writeFieldInfos",null),c([d({type:String,json:{write:!0}})],Ja.prototype,"title",void 0),c([d({type:["fields"],readOnly:!0,json:{read:!1,write:{isRequired:!0}}})],Ja.prototype,"type",void 0),Ja=qT=c([C("esri.popup.content.FieldsContent")],Ja);const _m=Ja;let qc=class extends W{constructor(e){super(e),this.altText=null,this.caption="",this.title="",this.type=null}};c([d({type:String,json:{write:!0}})],qc.prototype,"altText",void 0),c([d({type:String,json:{write:!0}})],qc.prototype,"caption",void 0),c([d({type:String,json:{write:!0}})],qc.prototype,"title",void 0),c([d({type:["image","bar-chart","column-chart","line-chart","pie-chart"],readOnly:!0,json:{read:!1,write:!0}})],qc.prototype,"type",void 0),qc=c([C("esri.popup.content.mixins.MediaInfo")],qc);const hA=qc;var HT;let Hc=HT=class extends ce{constructor(t){super(t),this.color=null,this.fieldName=null,this.tooltip=null,this.value=null}clone(){return new HT({color:this.color?.clone(),fieldName:this.fieldName,tooltip:this.tooltip,value:this.value})}};c([d()],Hc.prototype,"color",void 0),c([d()],Hc.prototype,"fieldName",void 0),c([d()],Hc.prototype,"tooltip",void 0),c([d()],Hc.prototype,"value",void 0),Hc=HT=c([C("esri.popup.content.support.ChartMediaInfoValueSeries")],Hc);const Xce=Hc;var WT;let mu=WT=class extends W{constructor(t){super(t),this.colors=null,this.fields=[],this.normalizeField=null,this.series=[],this.tooltipField=null}clone(){return new WT({colors:k(this.colors),fields:k(this.fields),normalizeField:this.normalizeField,series:k(this.series),tooltipField:this.tooltipField})}};c([d({type:[Q],json:{type:[[qe]],write:!0}})],mu.prototype,"colors",void 0),c([d({type:[String],json:{write:{isRequired:!0}}})],mu.prototype,"fields",void 0),c([d({type:String,json:{write:!0}})],mu.prototype,"normalizeField",void 0),c([d({type:[Xce],json:{read:!1}})],mu.prototype,"series",void 0),c([d({type:String,json:{write:!0}})],mu.prototype,"tooltipField",void 0),mu=WT=c([C("esri.popup.content.support.ChartMediaInfoValue")],mu);const Kce=mu;let ig=class extends hA{constructor(e){super(e),this.type=null,this.value=void 0}};c([d({type:["bar-chart","column-chart","line-chart","pie-chart"],readOnly:!0,json:{read:!1,write:!0}})],ig.prototype,"type",void 0),c([d({type:Kce,json:{write:{isRequired:!0}}})],ig.prototype,"value",void 0),ig=c([C("esri.popup.content.mixins.ChartMediaInfo")],ig);const x2=ig,$2=Wr()({barchart:"bar-chart",columnchart:"column-chart",linechart:"line-chart",piechart:"pie-chart"});var ZT;let q1=ZT=class extends x2{constructor(t){super(t),this.type="bar-chart"}clone(){return new ZT({altText:this.altText,title:this.title,caption:this.caption,value:this.value?.clone()})}};c([d({type:["bar-chart"],readOnly:!0,json:{type:["barchart"],read:!1,write:{writer:$2.write,isRequired:!0}}})],q1.prototype,"type",void 0),q1=ZT=c([C("esri.popup.content.BarChartMediaInfo")],q1);const uG=q1;var JT;let H1=JT=class extends x2{constructor(t){super(t),this.type="column-chart"}clone(){return new JT({altText:this.altText,title:this.title,caption:this.caption,value:this.value?.clone()})}};c([d({type:["column-chart"],readOnly:!0,json:{type:["columnchart"],read:!1,write:{writer:$2.write,isRequired:!0}}})],H1.prototype,"type",void 0),H1=JT=c([C("esri.popup.content.ColumnChartMediaInfo")],H1);const cG=H1;var YT;let sg=YT=class extends W{constructor(t){super(t),this.linkURL=null,this.sourceURL=null}clone(){return new YT({linkURL:this.linkURL,sourceURL:this.sourceURL})}};c([d({type:String,json:{write:!0}})],sg.prototype,"linkURL",void 0),c([d({type:String,json:{write:{isRequired:!0}}})],sg.prototype,"sourceURL",void 0),sg=YT=c([C("esri.popup.content.support.ImageMediaInfoValue")],sg);const Qce=sg;var XT;let hp=XT=class extends hA{constructor(t){super(t),this.refreshInterval=0,this.type="image",this.value=void 0}clone(){return new XT({altText:this.altText,title:this.title,caption:this.caption,refreshInterval:this.refreshInterval,value:this.value?.clone()})}};c([d({type:Number,json:{write:!0}})],hp.prototype,"refreshInterval",void 0),c([d({type:["image"],readOnly:!0,json:{read:!1,write:{isRequired:!0}}})],hp.prototype,"type",void 0),c([d({type:Qce,json:{write:{isRequired:!0}}})],hp.prototype,"value",void 0),hp=XT=c([C("esri.popup.content.ImageMediaInfo")],hp);const hG=hp;var KT;let W1=KT=class extends x2{constructor(t){super(t),this.type="line-chart"}clone(){return new KT({altText:this.altText,title:this.title,caption:this.caption,value:this.value?.clone()})}};c([d({type:["line-chart"],readOnly:!0,json:{type:["linechart"],read:!1,write:{writer:$2.write,isRequired:!0}}})],W1.prototype,"type",void 0),W1=KT=c([C("esri.popup.content.LineChartMediaInfo")],W1);const dG=W1;var QT;let Z1=QT=class extends x2{constructor(t){super(t),this.type="pie-chart"}clone(){return new QT({altText:this.altText,title:this.title,caption:this.caption,value:this.value?.clone()})}};c([d({type:["pie-chart"],readOnly:!0,json:{type:["piechart"],read:!1,write:{writer:$2.write,isRequired:!0}}})],Z1.prototype,"type",void 0),Z1=QT=c([C("esri.popup.content.PieChartMediaInfo")],Z1);const pG=Z1,eE={base:hA,key:"type",defaultKeyValue:"image",typeMap:{"bar-chart":uG,"column-chart":cG,"line-chart":dG,"pie-chart":pG,image:hG}};var tE;let kn=tE=class extends ql{constructor(t){super(t),this.activeMediaInfoIndex=null,this.attributes=null,this.description=null,this.mediaInfos=null,this.title=null,this.type="media"}readMediaInfos(t){return t&&t.map((e=>e.type==="image"?hG.fromJSON(e):e.type==="barchart"?uG.fromJSON(e):e.type==="columnchart"?cG.fromJSON(e):e.type==="linechart"?dG.fromJSON(e):e.type==="piechart"?pG.fromJSON(e):void 0)).filter(Boolean)}writeMediaInfos(t,e){e.mediaInfos=t&&t.map((r=>r.toJSON()))}clone(){return new tE(k({activeMediaInfoIndex:this.activeMediaInfoIndex,attributes:this.attributes,description:this.description,mediaInfos:this.mediaInfos,title:this.title}))}};c([d()],kn.prototype,"activeMediaInfoIndex",void 0),c([d({type:Object,json:{write:!0}})],kn.prototype,"attributes",void 0),c([d({type:String,json:{write:!0}})],kn.prototype,"description",void 0),c([d({types:[eE]})],kn.prototype,"mediaInfos",void 0),c([K("mediaInfos")],kn.prototype,"readMediaInfos",null),c([re("mediaInfos")],kn.prototype,"writeMediaInfos",null),c([d({type:String,json:{write:!0}})],kn.prototype,"title",void 0),c([d({type:["media"],readOnly:!0,json:{read:!1,write:{isRequired:!0}}})],kn.prototype,"type",void 0),kn=tE=c([C("esri.popup.content.MediaContent")],kn);const V0=kn;var rE;let ng=rE=class extends W{constructor(t){super(t),this.field=null,this.order=null}clone(){return new rE({field:this.field,order:this.order})}};c([d({type:String,json:{write:!0}})],ng.prototype,"field",void 0),c([d({type:["asc","desc"],json:{write:!0}})],ng.prototype,"order",void 0),ng=rE=c([C("esri.popup.support.RelatedRecordsInfoFieldOrder")],ng);const dA=ng;let bo=class extends Ce.ClonableMixin(ql){constructor(e){super(e),this.description=null,this.displayCount=null,this.displayType="list",this.orderByFields=null,this.relationshipId=null,this.title=null,this.type="relationship"}};c([d({type:String,json:{write:!0}})],bo.prototype,"description",void 0),c([d({type:Number,json:{type:qe,write:!0}})],bo.prototype,"displayCount",void 0),c([d({type:["list"],json:{write:{isRequired:!0}}})],bo.prototype,"displayType",void 0),c([d({type:[dA],json:{write:!0}})],bo.prototype,"orderByFields",void 0),c([d({type:Number,json:{type:qe,write:{isRequired:!0}}})],bo.prototype,"relationshipId",void 0),c([d({type:String,json:{write:!0}})],bo.prototype,"title",void 0),c([d({type:["relationship"],readOnly:!0,json:{read:!1,write:{isRequired:!0}}})],bo.prototype,"type",void 0),bo=c([C("esri.popup.content.RelationshipContent")],bo);const j0=bo;var iE;let og=iE=class extends ql{constructor(t){super(t),this.text=null,this.type="text"}clone(){return new iE({text:this.text})}};c([d({type:String,json:{write:!0}})],og.prototype,"text",void 0),c([d({type:["text"],readOnly:!0,json:{read:!1,write:{isRequired:!0}}})],og.prototype,"type",void 0),og=iE=c([C("esri.popup.content.TextContent")],og);const U0=og;let Ya=class extends Ce.ClonableMixin(W){constructor(e){super(e),this.title=null,this.description=null,this.type=null,this.associatedNetworkSourceId=null,this.associatedAssetGroup=null,this.associatedAssetType=null}};c([d({type:String,json:{write:!0}})],Ya.prototype,"title",void 0),c([d({type:String,json:{write:!0}})],Ya.prototype,"description",void 0),c([d({type:["attachment","connectivity","container","content","structure"],json:{write:!0}})],Ya.prototype,"type",void 0),c([d({type:Number,json:{type:qe,write:!0}})],Ya.prototype,"associatedNetworkSourceId",void 0),c([d({type:Number,json:{type:qe,write:!0}})],Ya.prototype,"associatedAssetGroup",void 0),c([d({type:Number,json:{type:qe,write:!0}})],Ya.prototype,"associatedAssetType",void 0),Ya=c([C("esri.popup.support.UtilityNetworkAssociationType")],Ya);const fG=Ya;let yu=class extends Ce.ClonableMixin(ql){constructor(e){super(e),this.description=null,this.displayCount=null,this.title=null,this.associationTypes=[],this.type="utility-network-associations"}};c([d({type:String,json:{write:!0}})],yu.prototype,"description",void 0),c([d({type:Number,json:{type:qe,write:!0}})],yu.prototype,"displayCount",void 0),c([d({type:String,json:{write:!0}})],yu.prototype,"title",void 0),c([d({type:[fG],json:{write:!0}})],yu.prototype,"associationTypes",void 0),c([ye({utilityNetworkAssociations:"utility-network-associations"})],yu.prototype,"type",void 0),yu=c([C("esri.popup.content.UtilityNetworkAssociationsContent")],yu);const pA=yu,ehe={base:null,key:"type",typeMap:{attachment:vm,media:V0,text:U0,expression:S2,field:_m,relationship:j0,utilityNetworkAssociations:pA}},the={base:null,key:"type",typeMap:{attachment:vm,media:V0,text:U0,expression:S2,field:_m,relationship:j0}};var sE;let Wc=sE=class extends W{constructor(t){super(t),this.name=null,this.title=null,this.expression=null,this.returnType=null}clone(){return new sE({name:this.name,title:this.title,expression:this.expression,returnType:this.returnType})}};c([d({type:String,json:{write:!0}})],Wc.prototype,"name",void 0),c([d({type:String,json:{write:!0}})],Wc.prototype,"title",void 0),c([d({type:String,json:{write:!0}})],Wc.prototype,"expression",void 0),c([d({type:["string","number"],json:{write:!0}})],Wc.prototype,"returnType",void 0),Wc=sE=c([C("esri.popup.ExpressionInfo")],Wc);const rhe=Wc;var nE;let ag=nE=class extends W{constructor(t){super(t),this.returnTopmostRaster=null,this.showNoDataRecords=null}clone(){return new nE({showNoDataRecords:this.showNoDataRecords,returnTopmostRaster:this.returnTopmostRaster})}};c([d({type:Boolean,json:{write:!0}})],ag.prototype,"returnTopmostRaster",void 0),c([d({type:Boolean,json:{write:!0}})],ag.prototype,"showNoDataRecords",void 0),ag=nE=c([C("esri.popup.LayerOptions")],ag);const ihe=ag;var oE;let lg=oE=class extends W{constructor(t){super(t),this.showRelatedRecords=null,this.orderByFields=null}clone(){return new oE({showRelatedRecords:this.showRelatedRecords,orderByFields:this.orderByFields?k(this.orderByFields):null})}};c([d({type:Boolean,json:{write:!0}})],lg.prototype,"showRelatedRecords",void 0),c([d({type:[dA],json:{write:!0}})],lg.prototype,"orderByFields",void 0),lg=oE=c([C("esri.popup.RelatedRecordsInfo")],lg);const BO=lg;var aE;let Bs=aE=class extends Pv.IdentifiableMixin(ce){constructor(t){super(t),this.active=!1,this.className=null,this.disabled=!1,this.icon=null,this.id=null,this.indicator=!1,this.title=null,this.type=null,this.visible=!0}clone(){return new aE({active:this.active,className:this.className,disabled:this.disabled,icon:this.icon,id:this.id,indicator:this.indicator,title:this.title,visible:this.visible})}};c([d()],Bs.prototype,"active",void 0),c([d()],Bs.prototype,"className",void 0),c([d()],Bs.prototype,"disabled",void 0),c([d()],Bs.prototype,"icon",void 0),c([d()],Bs.prototype,"id",void 0),c([d()],Bs.prototype,"indicator",void 0),c([d()],Bs.prototype,"title",void 0),c([d()],Bs.prototype,"type",void 0),c([d()],Bs.prototype,"visible",void 0),Bs=aE=c([C("esri.support.actions.ActionBase")],Bs);const fA=Bs;var lE;let J1=lE=class extends fA{constructor(t){super(t),this.image=null,this.type="button"}clone(){return new lE({active:this.active,className:this.className,disabled:this.disabled,icon:this.icon,id:this.id,indicator:this.indicator,title:this.title,visible:this.visible,image:this.image})}};c([d()],J1.prototype,"image",void 0),J1=lE=c([C("esri.support.actions.ActionButton")],J1);const she=J1;var uE;let ug=uE=class extends fA{constructor(t){super(t),this.image=null,this.type="toggle",this.value=!1}clone(){return new uE({active:this.active,className:this.className,disabled:this.disabled,icon:this.icon,id:this.id,indicator:this.indicator,title:this.title,visible:this.visible,image:this.image,value:this.value})}};c([d()],ug.prototype,"image",void 0),c([d()],ug.prototype,"value",void 0),ug=uE=c([C("esri.support.actions.ActionToggle")],ug);const nhe=ug,my="relationships/",qO="expression/",ohe=se.ofType({key:"type",defaultKeyValue:"button",base:fA,typeMap:{button:she,toggle:nhe}}),ahe={base:ql,key:"type",typeMap:{media:V0,custom:Jce,text:U0,attachments:vm,fields:_m,expression:S2,relationship:j0,utilityNetworkAssociations:pA}},mG=new Set(["attachments","fields","media","text","expression","relationship"]),lhe=new Set([...mG,"utility-network-associations"]);let yr=class extends Ce.ClonableMixin(W){constructor(){super(...arguments),this.actions=null,this.content="",this.expressionInfos=null,this.fieldInfos=null,this.layerOptions=null,this.lastEditInfoEnabled=!0,this.outFields=null,this.overwriteActions=!1,this.returnGeometry=!1,this.title=""}castContent(e){return Array.isArray(e)?e.map((r=>xa(ahe,r))):typeof e=="string"||typeof e=="function"||e instanceof HTMLElement||Ia(e)?e:(q.getLogger(this).error("content error","unsupported content value",{value:e}),null)}readContent(e,r){const{popupElements:i}=r;return Array.isArray(i)&&i.length>0?this._readPopupInfoElements(r.description,r.mediaInfos,i):this._readPopupInfo(r)}writeWebSceneContent(e,r,i,s){this._writePopupTemplateContent(e,r,s)}writeWebMapContent(e,r,i,s){this._writePopupTemplateContent(e,r,s)}writeFieldInfos(e,r,i,s){const{content:n}=this,o=Array.isArray(n)?n:null;if(e){const a=o?o.filter((u=>u.type==="fields")):[],l=a.length&&a.every((u=>u.fieldInfos?.length));r.fieldInfos=e.filter(Boolean).map((u=>{const h=u.toJSON(s);return l&&(h.visible=!1),h}))}if(o)for(const a of o)a.type==="fields"&&this._writeFieldsContent(a,r)}writeLayerOptions(e,r,i,s){r[i]=!e||e.showNoDataRecords===null&&e.returnTopmostRaster===null?null:e.toJSON(s)}writeTitle(e,r){r.title=e||""}async collectRequiredFields(e,r){const i=this.expressionInfos||[];await this._collectExpressionInfoFields(e,r,[...i,...this._getContentExpressionInfos(this.content,i)]),dc(e,r,[...this.outFields||[],...this._getActionsFields(this.actions),...this._getTitleFields(this.title),...this._getContentFields(this.content)])}async getRequiredFields(e){const r=new Set;return await this.collectRequiredFields(r,e),[...r].sort()}_writePopupTemplateContent(e,r,i){typeof e!="string"?Array.isArray(e)&&(r.popupElements=e.filter((s=>i?.origin==="web-scene"?mG.has(s.type):lhe.has(s.type))).map((s=>s?.toJSON(i))),r.popupElements.forEach((s=>{s.type==="attachments"?this._writeAttachmentContent(r):s.type==="media"?this._writeMediaContent(s,r):s.type==="text"?this._writeTextContent(s,r):s.type==="relationship"&&this._writeRelationshipContent(s,r)}))):r.description=e}_writeFieldsContent(e,r){if(!Array.isArray(e.fieldInfos)||!e.fieldInfos.length)return;const i=k(e.fieldInfos);Array.isArray(r.fieldInfos)?i.forEach((s=>{const n=r.fieldInfos.find((o=>o.fieldName?.toLowerCase()===s.fieldName?.toLowerCase()));n?n.visible=!0:r.fieldInfos.push(s)})):r.fieldInfos=i}_writeAttachmentContent(e){e.showAttachments||(e.showAttachments=!0)}_writeRelationshipContent(e,r){const i=e.orderByFields?.map((n=>this._toFieldOrderJSON(n,e.relationshipId)))||[],s=[...r.relatedRecordsInfo?.orderByFields||[],...i];r.relatedRecordsInfo={showRelatedRecords:!0,...s?.length&&{orderByFields:s}}}_writeTextContent(e,r){!r.description&&e.text&&(r.description=e.text)}_writeMediaContent(e,r){if(!Array.isArray(e.mediaInfos)||!e.mediaInfos.length)return;const i=k(e.mediaInfos);Array.isArray(r.mediaInfos)?r.mediaInfos=[...r.mediaInfos,...i]:r.mediaInfos=i}_readPopupInfoElements(e,r,i){const s={description:!1,mediaInfos:!1};return i.map((n=>n.type==="media"?(n.mediaInfos||!r||s.mediaInfos||(n.mediaInfos=r,s.mediaInfos=!0),V0.fromJSON(n)):n.type==="text"?(n.text||!e||s.description||(n.text=e,s.description=!0),U0.fromJSON(n)):n.type==="attachments"?vm.fromJSON(n):n.type==="fields"?_m.fromJSON(n):n.type==="expression"?S2.fromJSON(n):n.type==="relationship"?j0.fromJSON(n):n.type==="utilityNetworkAssociations"?pA.fromJSON(n):void 0)).filter(Boolean)}_toRelationshipContent(e){const{field:r,order:i}=e;if(!r?.startsWith(my))return null;const s=r.replace(my,"").split("/");if(s.length!==2)return null;const n=parseInt(s[0],10),o=s[1];return!Number.isNaN(n)&&o?j0.fromJSON({relationshipId:n,orderByFields:[{field:o,order:i}]}):null}_toFieldOrderJSON(e,r){const{order:i,field:s}=e;return{field:`${my}${r}/${s}`,order:i}}_readPopupInfo({description:e,mediaInfos:r,showAttachments:i,relatedRecordsInfo:s={showRelatedRecords:!1}}){const n=[];e?n.push(new U0({text:e})):n.push(new _m),Array.isArray(r)&&r.length&&n.push(V0.fromJSON({mediaInfos:r})),i&&n.push(vm.fromJSON({displayType:"auto"}));const{showRelatedRecords:o,orderByFields:a}=s;return o&&a?.length&&a.forEach((l=>{const u=this._toRelationshipContent(l);u&&n.push(u)})),n.length?n:e}_getContentElementFields(e){const r=e?.type;if(r==="attachments")return[...this._extractFieldNames(e.title),...this._extractFieldNames(e.description)];if(r==="custom")return e.outFields||[];if(r==="fields")return[...this._extractFieldNames(e.title),...this._extractFieldNames(e.description),...this._getFieldInfoFields(e.fieldInfos??this.fieldInfos)];if(r==="media"){const i=e.mediaInfos||[];return[...this._extractFieldNames(e.title),...this._extractFieldNames(e.description),...i.reduce(((s,n)=>[...s,...this._getMediaInfoFields(n)]),[])]}return r==="text"?this._extractFieldNames(e.text):r==="relationship"||r==="utility-network-associations"?[...this._extractFieldNames(e.title),...this._extractFieldNames(e.description)]:[]}_getMediaInfoFields(e){const{caption:r,title:i,value:s}=e,n=s||{},{fields:o,normalizeField:a,tooltipField:l,sourceURL:u,linkURL:h}=n,p=[...this._extractFieldNames(i),...this._extractFieldNames(r),...this._extractFieldNames(u),...this._extractFieldNames(h),...o??[]];return a&&p.push(a),l&&p.push(l),p}_getContentExpressionInfos(e,r){return Array.isArray(e)?e.reduce(((i,s)=>[...i,...s.type==="expression"&&s.expressionInfo?[s.expressionInfo]:[]]),r):[]}_getContentFields(e){return typeof e=="string"?this._extractFieldNames(e):Array.isArray(e)?e.reduce(((r,i)=>[...r,...this._getContentElementFields(i)]),[]):[]}async _collectExpressionInfoFields(e,r,i){i&&await Promise.all(i.map((s=>si(e,r,s.expression))))}_getFieldInfoFields(e){return e?e.filter((({fieldName:r,visible:i})=>!(i!==void 0&&!i||!r||r.startsWith(my)||r.startsWith(qO)))).map((r=>r.fieldName)):[]}_getActionsFields(e){return e?e.toArray().reduce(((r,i)=>[...r,...this._getActionFields(i)]),[]):[]}_getActionFields(e){const{className:r,title:i,type:s}=e,n=s==="button"||s==="toggle"?e.image:"";return[...this._extractFieldNames(i),...this._extractFieldNames(r),...this._extractFieldNames(n)]}_getTitleFields(e){return typeof e=="string"?this._extractFieldNames(e):[]}_extractFieldNames(e){return uA(e).filter((r=>!(r.indexOf(my)===0||r.indexOf(qO)===0)))}};c([d({type:ohe})],yr.prototype,"actions",void 0),c([d()],yr.prototype,"content",void 0),c([We("content")],yr.prototype,"castContent",null),c([K("content",["description","fieldInfos","popupElements","mediaInfos","showAttachments","relatedRecordsInfo"])],yr.prototype,"readContent",null),c([re("web-scene","content",{popupElements:{type:se.ofType(the)},showAttachments:{type:Boolean},mediaInfos:{type:se.ofType(eE)},description:{type:String},relatedRecordsInfo:{type:BO}})],yr.prototype,"writeWebSceneContent",null),c([re("content",{popupElements:{type:se.ofType(ehe)},showAttachments:{type:Boolean},mediaInfos:{type:se.ofType(eE)},description:{type:String},relatedRecordsInfo:{type:BO}})],yr.prototype,"writeWebMapContent",null),c([d({type:[rhe],json:{write:!0}})],yr.prototype,"expressionInfos",void 0),c([d({type:[cA]})],yr.prototype,"fieldInfos",void 0),c([re("fieldInfos")],yr.prototype,"writeFieldInfos",null),c([d({type:ihe})],yr.prototype,"layerOptions",void 0),c([re("layerOptions")],yr.prototype,"writeLayerOptions",null),c([d({type:Boolean,json:{read:{source:"showLastEditInfo"},write:{target:"showLastEditInfo"},default:!0}})],yr.prototype,"lastEditInfoEnabled",void 0),c([d()],yr.prototype,"outFields",void 0),c([d()],yr.prototype,"overwriteActions",void 0),c([d()],yr.prototype,"returnGeometry",void 0),c([d({json:{type:String}})],yr.prototype,"title",void 0),c([re("title")],yr.prototype,"writeTitle",null),yr=c([C("esri.PopupTemplate")],yr);const Gm=yr;function mNe(t,e){switch(e.type){case"object-id":case"unique-id-simple":return t.attributes[e.fieldName];case"unique-id-composite":{const r=[];for(const i of e.fieldNames)r.push(t.attributes[i]??null);return JSON.stringify(r)}}}function uhe(t,e){if("uniqueIdFields"in e&&e.uniqueIdFields?.length){if(e.uniqueIdFields.length===1)return t.attributes?.[e.uniqueIdFields[0]];const r=e.uniqueIdFields.map((i=>t.attributes?.[i]));return JSON.stringify(r)}return"objectIdField"in e&&e.objectIdField?t.attributes?.[e.objectIdField]:null}const HO=new De({esriSMS:"simple-marker",esriPMS:"picture-marker",esriSLS:"simple-line",esriSFS:"simple-fill",esriPFS:"picture-fill",esriTS:"text",esriSHD:"shield-label-symbol",PointSymbol3D:"point-3d",LineSymbol3D:"line-3d",PolygonSymbol3D:"polygon-3d",WebStyleSymbol:"web-style",MeshSymbol3D:"mesh-3d",LabelSymbol3D:"label-3d",CIMSymbolReference:"cim"});let che=0,sr=class extends W{constructor(e){super(e),this.id="sym"+che++,this.type=null,this.color=new Q([0,0,0,1])}readColor(e){return e?.[0]!=null?[e[0],e[1],e[2],e[3]/255]:e}async collectRequiredFields(e,r){}hash(){return JSON.stringify(this.toJSON())}clone(){}};c([d({type:HO.apiValues,readOnly:!0,json:{read:!1,write:{ignoreOrigin:!0,writer:HO.write,isRequired:!0}}})],sr.prototype,"type",void 0),c([d({type:Q,json:{write:{allowNull:!0}}})],sr.prototype,"color",void 0),c([K("color")],sr.prototype,"readColor",null),sr=c([C("esri.symbols.Symbol")],sr);var cE;let gi=cE=class extends sr{constructor(t){super(t),this.data=null,this.type="cim"}readData(t,e){return e}writeData(t,e){Object.assign(e,t)}async collectRequiredFields(t,e){if(this.data?.type==="CIMSymbolReference"){const r=this.data.primitiveOverrides;if(r){const i=r.map((s=>{const n=s.valueExpressionInfo;return n?si(t,e,n.expression):null}));await Promise.all(i)}}}clone(){return new cE({data:k(this.data)})}hash(){return pz(JSON.stringify(this.data)).toString()}};c([d({json:{write:!1}})],gi.prototype,"color",void 0),c([d({json:{write:!0}})],gi.prototype,"data",void 0),c([K("data",["symbol"])],gi.prototype,"readData",null),c([re("data",{})],gi.prototype,"writeData",null),c([ye({CIMSymbolReference:"cim"},{readOnly:!0})],gi.prototype,"type",void 0),gi=cE=c([C("esri.symbols.CIMSymbol")],gi);let Ui=class extends W{constructor(e){super(e),this.enabled=!0,this.type=null,this.ignoreDrivers=!1}writeEnabled(e,r,i){e||(r[i]=e)}};c([d({type:Boolean,json:{read:{source:"enable"},write:{target:"enable"}}})],Ui.prototype,"enabled",void 0),c([re("enabled")],Ui.prototype,"writeEnabled",null),c([d({type:["icon","object","line","path","fill","water","extrude","text"],readOnly:!0,json:{write:{isRequired:!0}}})],Ui.prototype,"type",void 0),Ui=c([C("esri.symbols.Symbol3DLayer")],Ui);function hhe(t,e){const r=e.transparency!=null?k0(e.transparency):1,i=e.color;return i&&Array.isArray(i)?new Q([i[0]||0,i[1]||0,i[2]||0,r]):null}function dhe(t,e){e.color=t.toJSON().slice(0,3);const r=l2(t.a);r!==0&&(e.transparency=r)}function xc(t){return{type:Q,nonNullable:t?.nonNullable,json:{type:[qe],default:null,read:{source:["color","transparency"],reader:hhe},write:{target:{color:{type:[qe],isRequired:t?.colorRequiredOnWrite},transparency:{type:qe}},writer:dhe}}}}const Ta={type:Number,cast:Be,json:{write:!0}};var Fw;function vNe(t){return t==="emissive"?Fw.Emissive:Fw.Color}(function(t){t[t.Emissive=0]="Emissive",t[t.Color=1]="Color"})(Fw||(Fw={}));let Zc=class extends W{constructor(e){super(e),this.color=new Q([0,0,0,1]),this.extensionLength=0,this.size=tt(1)}clone(){}cloneProperties(){return{color:k(this.color),size:this.size,extensionLength:this.extensionLength}}};c([d({type:["solid","sketch"],readOnly:!0,json:{read:!0,write:{ignoreOrigin:!0,isRequired:!0}}})],Zc.prototype,"type",void 0),c([d(xc({colorRequiredOnWrite:!0}))],Zc.prototype,"color",void 0),c([d({...Ta,json:{write:{overridePolicy:t=>({enabled:!!t})}}})],Zc.prototype,"extensionLength",void 0),c([d(Ta)],Zc.prototype,"size",void 0),Zc=c([C("esri.symbols.edges.Edges3D")],Zc);const mA=Zc;var hE;let Y1=hE=class extends mA{constructor(t){super(t),this.type="sketch"}clone(){return new hE(this.cloneProperties())}};c([ye({sketch:"sketch"},{readOnly:!0})],Y1.prototype,"type",void 0),Y1=hE=c([C("esri.symbols.edges.SketchEdges3D")],Y1);const phe=Y1;var dE;let X1=dE=class extends mA{constructor(t){super(t),this.type="solid"}clone(){return new dE(this.cloneProperties())}};c([ye({solid:"solid"},{readOnly:!0})],X1.prototype,"type",void 0),X1=dE=c([C("esri.symbols.edges.SolidEdges3D")],X1);const yG=X1,gG={types:{key:"type",base:mA,typeMap:{solid:yG,sketch:phe}},json:{write:!0}};var pE;let Hp=pE=class extends W{constructor(){super(...arguments),this.strength=null,this.source="emissive"}clone(){const t={strength:this.strength,source:this.source};return new pE(t)}};c([d({json:{write:!1}})],Hp.prototype,"strength",void 0),c([d({json:{write:!1}})],Hp.prototype,"source",void 0),Hp=pE=c([C("esri.symbols.support.Symbol3DEmissive")],Hp);var fE;let ls=fE=class extends W{constructor(t){super(t),this.color=null,this.emissive=new Hp({source:"emissive"})}clone(){const t={color:this.color?.clone()??null,emissive:this.emissive?.clone()??null};return new fE(t)}};c([d(xc())],ls.prototype,"color",void 0),c([d({type:Hp,json:{write:!1}})],ls.prototype,"emissive",void 0),ls=fE=c([C("esri.symbols.support.Symbol3DMaterial")],ls);var mE,Lf;let ll=(Lf=class extends Ui{constructor(e){super(e),this.type="extrude",this.size=1,this.material=null,this.castShadows=!0,this.edges=null}clone(){return new mE({edges:this.edges?.clone(),enabled:this.enabled,material:this.material?.clone(),castShadows:this.castShadows,size:this.size})}},mE=Lf,Lf);c([ye({Extrude:"extrude"},{readOnly:!0})],ll.prototype,"type",void 0),c([d({type:Number,json:{write:{enabled:!0,isRequired:!0}},nonNullable:!0})],ll.prototype,"size",void 0),c([d({type:ls,json:{write:!0}})],ll.prototype,"material",void 0),c([d({type:Boolean,nonNullable:!0,json:{write:!0,default:!0}})],ll.prototype,"castShadows",void 0),c([d(gG)],ll.prototype,"edges",void 0),ll=mE=c([C("esri.symbols.ExtrudeSymbol3DLayer")],ll);let o0=class extends W{constructor(e){super(e)}clone(){throw new Error("Subclasses of LinePattern3D should implement their own clone method.")}};c([d({type:["style"],readOnly:!0,json:{read:!0,write:{ignoreOrigin:!0}}})],o0.prototype,"type",void 0),o0=c([C("esri.symbols.patterns.LinePattern3D")],o0);const fhe=["dash","dash-dot","dot","long-dash","long-dash-dot","long-dash-dot-dot","none","short-dash","short-dash-dot","short-dash-dot-dot","short-dot","solid"];var yE;const mhe=Wr()({dash:"dash","dash-dot":"dash-dot","dash-dot-dot":"long-dash-dot-dot",dot:"dot","long-dash":"long-dash","long-dash-dot":"long-dash-dot",null:"none","short-dash":"short-dash","short-dash-dot":"short-dash-dot","short-dash-dot-dot":"short-dash-dot-dot","short-dot":"short-dot",solid:"solid"});let zh=yE=class extends o0{constructor(t){super(t),this.type="style",this.style="solid"}clone(){const t={style:this.style};return new yE(t)}};c([d({type:["style"],json:{write:{isRequired:!0}}})],zh.prototype,"type",void 0),c([ye(mhe),d({type:fhe,json:{write:{isRequired:!0}}})],zh.prototype,"style",void 0),zh=yE=c([C("esri.symbols.patterns.LineStylePattern3D")],zh);let a0=class extends W{constructor(e){super(e),this.type="style"}clone(){throw new Error("Subclasses of Pattern3D should implement their own clone method.")}};c([d({type:["style"],readOnly:!0,json:{read:!0,write:{ignoreOrigin:!0}}})],a0.prototype,"type",void 0),a0=c([C("esri.symbols.patterns.Pattern3D")],a0);const yhe=["backward-diagonal","cross","diagonal-cross","forward-diagonal","horizontal","none","solid","vertical"];var gE;let Wp=gE=class extends a0{constructor(t){super(t),this.type="style",this.style="solid"}clone(){return new gE({style:this.style})}};c([d({type:["style"],json:{write:{isRequired:!0}}})],Wp.prototype,"type",void 0),c([d({type:yhe,json:{read:!0,write:{isRequired:!0}}})],Wp.prototype,"style",void 0),Wp=gE=c([C("esri.symbols.patterns.StylePattern3D")],Wp);const ghe={types:{key:"type",base:a0,typeMap:{style:Wp}},json:{write:!0}},vG={types:{key:"type",base:o0,typeMap:{style:zh}},json:{write:!0}},l0=new Q("white"),vhe=new Q([255,255,255,0]);function _he(t){return t.r===0&&t.g===0&&t.b===0}var vE;let u0=vE=class extends ls{constructor(t){super(t),this.colorMixMode=null}clone(){const t={color:this.color?.clone()??null,colorMixMode:this.colorMixMode,emissive:this.emissive?.clone()??null};return new vE(t)}};c([ye({multiply:"multiply",replace:"replace",tint:"tint"})],u0.prototype,"colorMixMode",void 0),u0=vE=c([C("esri.symbols.support.Symbol3DFillMaterial")],u0);function bhe(t,e=!1){return t<=oz?e?new Array(t).fill(0):new Array(t):new Float64Array(t)}function SNe(t){return(nz(t)?t.byteLength/8:t.length)<=oz?Array.from(t):new Float64Array(t)}function xNe(t,e,r){return Array.isArray(t)?t.slice(e,e+r):t.subarray(e,e+r)}function Rv(t=$he){return[t[0],t[1],t[2],t[3],t[4],t[5]]}function yA(t,e,r,i,s,n,o=Rv()){return o[0]=t,o[1]=e,o[2]=r,o[3]=i,o[4]=s,o[5]=n,o}function $Ne(t,e=Rv()){return whe(t,0,t.length/3,e)}function whe(t,e,r,i=Rv()){return _G(i,_E),She(i,t,e,r),i}function MNe(t,e=bhe(24)){const[r,i,s,n,o,a]=t;return e[0]=r,e[1]=i,e[2]=s,e[3]=r,e[4]=i,e[5]=a,e[6]=r,e[7]=o,e[8]=s,e[9]=r,e[10]=o,e[11]=a,e[12]=n,e[13]=i,e[14]=s,e[15]=n,e[16]=i,e[17]=a,e[18]=n,e[19]=o,e[20]=s,e[21]=n,e[22]=o,e[23]=a,e}function TNe(t,e){const r=isFinite(t[2])||isFinite(t[5]);return new Le(r?{xmin:t[0],xmax:t[3],ymin:t[1],ymax:t[4],zmin:t[2],zmax:t[5],spatialReference:e}:{xmin:t[0],xmax:t[3],ymin:t[1],ymax:t[4],spatialReference:e})}function ENe(t,e){t[0]=Math.min(t[0],e[0]),t[1]=Math.min(t[1],e[1]),t[2]=Math.min(t[2],e[2]),t[3]=Math.max(t[3],e[3]),t[4]=Math.max(t[4],e[4]),t[5]=Math.max(t[5],e[5])}function INe(t,e){t[0]=Math.min(t[0],e[0]),t[1]=Math.min(t[1],e[1]),t[3]=Math.max(t[3],e[2]),t[4]=Math.max(t[4],e[3])}function CNe(t,e){t[0]=Math.min(t[0],e[0]),t[1]=Math.min(t[1],e[1]),t[2]=Math.min(t[2],e[2]),t[3]=Math.max(t[3],e[0]),t[4]=Math.max(t[4],e[1]),t[5]=Math.max(t[5],e[2])}function She(t,e,r=0,i=e.length/3){let s=t[0],n=t[1],o=t[2],a=t[3],l=t[4],u=t[5];for(let h=0;h<i;h++)s=Math.min(s,e[r+3*h]),n=Math.min(n,e[r+3*h+1]),o=Math.min(o,e[r+3*h+2]),a=Math.max(a,e[r+3*h]),l=Math.max(l,e[r+3*h+1]),u=Math.max(u,e[r+3*h+2]);t[0]=s,t[1]=n,t[2]=o,t[3]=a,t[4]=l,t[5]=u}function PNe(t,e,r){const i=e.length;let s=t[0],n=t[1],o=t[2],a=t[3],l=t[4],u=t[5];if(r)for(let h=0;h<i;h++){const p=e[h];s=Math.min(s,p[0]),n=Math.min(n,p[1]),o=Math.min(o,p[2]),a=Math.max(a,p[0]),l=Math.max(l,p[1]),u=Math.max(u,p[2])}else for(let h=0;h<i;h++){const p=e[h];s=Math.min(s,p[0]),n=Math.min(n,p[1]),a=Math.max(a,p[0]),l=Math.max(l,p[1])}t[0]=s,t[1]=n,t[2]=o,t[3]=a,t[4]=l,t[5]=u}function ANe(t){for(let e=0;e<6;e++)if(!isFinite(t[e]))return!1;return!0}function kv(t){return t[0]>=t[3]?0:t[3]-t[0]}function Ov(t){return t[1]>=t[4]?0:t[4]-t[1]}function Nv(t){return t[2]>=t[5]?0:t[5]-t[2]}function LNe(t){const e=kv(t),r=Nv(t),i=Ov(t);return Math.sqrt(e*e+r*r+i*i)}function RNe(t,e=[0,0,0]){return e[0]=t[0]+kv(t)/2,e[1]=t[1]+Ov(t)/2,e[2]=t[2]+Nv(t)/2,e}function kNe(t,e=[0,0,0]){return e[0]=kv(t),e[1]=Ov(t),e[2]=Nv(t),e}function ONe(t,e){return e[0]>=t[0]&&e[1]>=t[1]&&e[2]>=t[2]&&e[0]<=t[3]&&e[1]<=t[4]&&e[2]<=t[5]}function xhe(t,e){return Math.max(e[0],t[0])<=Math.min(e[3],t[3])&&Math.max(e[1],t[1])<=Math.min(e[4],t[4])&&Math.max(e[2],t[2])<=Math.min(e[5],t[5])}function NNe(t,e){return e==null||xhe(t,e)}function FNe(t,e,r,i,s=t){return s[0]=t[0]+e,s[1]=t[1]+r,s[2]=t[2]+i,s[3]=t[3]+e,s[4]=t[4]+r,s[5]=t[5]+i,s}function DNe(t,e,r=t){const i=t[0]+kv(t)/2,s=t[1]+Ov(t)/2,n=t[2]+Nv(t)/2;return r[0]=i+(t[0]-i)*e,r[1]=s+(t[1]-s)*e,r[2]=n+(t[2]-n)*e,r[3]=i+(t[3]-i)*e,r[4]=s+(t[4]-s)*e,r[5]=n+(t[5]-n)*e,r}function zNe(t,e){return e[0]=t[0],e[1]=t[1],e[2]=t[2],e}function VNe(t,e,r=t){return r[0]=e[0],r[1]=e[1],r[2]=e[2],r!==t&&(r[3]=t[3],r[4]=t[4],r[5]=t[5]),r}function jNe(t,e,r=t){return r[3]=e[0],r[4]=e[1],r[5]=e[2],r!==t&&(r[0]=t[0],r[1]=t[1],r[2]=t[2]),t}function _G(t,e){return t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3],t[4]=e[4],t[5]=e[5],t}function UNe(t){return t?_G(t,_E):Rv(_E)}function GNe(t,e){return e||(e=nr()),e[0]=t[0],e[1]=t[1],e[2]=t[3],e[3]=t[4],e}function BNe(t,e){return t[0]=e[0],t[1]=e[1],t[2]=Number.NEGATIVE_INFINITY,t[3]=e[2],t[4]=e[3],t[5]=Number.POSITIVE_INFINITY,t}function qNe(t,e,r,i,s){return t[0]=e,t[1]=r,t[2]=Number.NEGATIVE_INFINITY,t[3]=i,t[4]=s,t[5]=Number.POSITIVE_INFINITY,t}function WO(t){return t.length===6}function HNe(t){return kv(t)===0&&Ov(t)===0&&Nv(t)===0}function WNe(t,e,r){if(t==null||e==null)return t===e;if(!WO(t)||!WO(e))return!1;for(let i=0;i<t.length;i++)if(t[i]!==e[i])return!1;return!0}const _E=[1/0,1/0,1/0,-1/0,-1/0,-1/0],$he=[0,0,0,0,0,0];Rv();function ZNe(t,{isPrimitive:e,width:r,depth:i,height:s}){const n=e?10:1;if(r==null&&s==null&&i==null)return[n*t[0],n*t[1],n*t[2]];const o=Um(r,i,s);let a;for(let l=0;l<3;l++){const u=o[l];if(u!=null){a=u/t[l];break}}for(let l=0;l<3;l++)o[l]==null&&(o[l]=t[l]*a);return o}const Mhe=yA(-.5,-.5,-.5,.5,.5,.5),The=yA(-.5,-.5,0,.5,.5,1),Ehe=yA(-.5,-.5,0,.5,.5,.5);function JNe(t){switch(t){case"sphere":case"cube":case"diamond":return Mhe;case"cylinder":case"cone":case"inverted-cone":return The;case"tetrahedron":return Ehe;default:return}}const gA=["butt","square","round"],Ihe=[...gA,"none"],bG=["miter","bevel","round"];var bE;let Jc=bE=class extends W{constructor(t){super(t),this.color=new Q([0,0,0,1]),this.size=tt(1),this.pattern=null,this.patternCap="butt"}clone(){const t={color:this.color!=null?this.color.clone():null,size:this.size,pattern:this.pattern!=null?this.pattern.clone():null,patternCap:this.patternCap};return new bE(t)}};c([d(xc({colorRequiredOnWrite:!0}))],Jc.prototype,"color",void 0),c([d({...Ta,json:{write:{isRequired:!0}}})],Jc.prototype,"size",void 0),c([d(vG)],Jc.prototype,"pattern",void 0),c([d({type:gA,json:{default:"butt",write:{overridePolicy(){return{enabled:this.pattern!=null}}}}})],Jc.prototype,"patternCap",void 0),Jc=bE=c([C("esri.symbols.support.Symbol3DOutline")],Jc);var K1,Rf;let ki=(Rf=class extends Ui{constructor(e){super(e),this.type="fill",this.material=null,this.pattern=null,this.castShadows=!0,this.outline=null,this.edges=null}clone(){const e={edges:this.edges!=null?this.edges.clone():null,enabled:this.enabled,material:this.material!=null?this.material.clone():null,pattern:this.pattern!=null?this.pattern.clone():null,castShadows:this.castShadows,outline:this.outline!=null?this.outline.clone():null};return new K1(e)}static fromSimpleFillSymbol(e){const r=e.outline&&e.outline.style&&e.outline.style!=="solid"?new zh({style:e.outline.style}):null,i={size:e.outline?.width??0,color:(e.outline?.color??l0).clone(),pattern:r};return r&&e.outline?.cap&&(i.patternCap=e.outline.cap),new K1({material:new u0({color:(e.color??vhe).clone()}),pattern:e.style&&e.style!=="solid"?new Wp({style:e.style}):null,outline:i})}},K1=Rf,Rf);c([ye({Fill:"fill"},{readOnly:!0})],ki.prototype,"type",void 0),c([d({type:u0,json:{write:!0}})],ki.prototype,"material",void 0),c([d(ghe)],ki.prototype,"pattern",void 0),c([d({type:Boolean,nonNullable:!0,json:{write:!0,default:!0}})],ki.prototype,"castShadows",void 0),c([d({type:Jc,json:{write:!0}})],ki.prototype,"outline",void 0),c([d(gG)],ki.prototype,"edges",void 0),ki=K1=c([C("esri.symbols.FillSymbol3DLayer")],ki);var wE;const Che=Wr()({circle:"circle",square:"square",cross:"cross",x:"x",kite:"kite",triangle:"triangle"});let Yc=wE=class extends W{constructor(t){super(t)}readHref(t,e,r){return t?Fl(t,r):e.dataURI}writeHref(t,e,r,i){t&&(xd(t)?e.dataURI=t:(e.href=cd(t,i),cs(e.href)&&(e.href=fn(e.href))))}clone(){return new wE({href:this.href,primitive:this.primitive})}};c([d({type:String,json:{write:!0,read:{source:["href","dataURI"]}}})],Yc.prototype,"href",void 0),c([K("href")],Yc.prototype,"readHref",null),c([re("href",{href:{type:String},dataURI:{type:String}})],Yc.prototype,"writeHref",null),c([ye(Che)],Yc.prototype,"primitive",void 0),Yc=wE=c([C("esri.symbols.support.IconSymbol3DLayerResource")],Yc);const Phe="circle";var SE;let Zp=SE=class extends ce{constructor(){super(...arguments),this.x=0,this.y=0}clone(){return new SE({x:this.x,y:this.y})}};c([d({type:Number})],Zp.prototype,"x",void 0),c([d({type:Number})],Zp.prototype,"y",void 0),Zp=SE=c([C("esri.symbols.support.Symbol3DAnchorPosition2D")],Zp);var xE;let cg=xE=class extends W{constructor(t){super(t),this.color=new Q([0,0,0,1]),this.size=tt(1)}clone(){const t={color:this.color!=null?this.color.clone():null,size:this.size};return new xE(t)}};c([d(xc({colorRequiredOnWrite:!0}))],cg.prototype,"color",void 0),c([d({...Ta,json:{write:{isRequired:!0}}})],cg.prototype,"size",void 0),cg=xE=c([C("esri.symbols.support.Symbol3DIconOutline")],cg);var dp,kf;let ei=(kf=class extends Ui{constructor(e){super(e),this.material=null,this.resource=null,this.type="icon",this.size=12,this.anchor="center",this.anchorPosition=null,this.outline=null,this.angle=0}clone(){return new dp({anchor:this.anchor,anchorPosition:k(this.anchorPosition),enabled:this.enabled,material:k(this.material),outline:k(this.outline),resource:k(this.resource),angle:this.angle,size:this.size})}static fromSimpleMarkerSymbol(e){const r=e.color||l0,i=ZO(e),s=e.outline&&e.outline.width>0?{size:e.outline.width,color:(e.outline.color||l0).clone()}:null;return new dp({size:e.size,angle:e.angle,resource:{primitive:Lhe((()=>q.getLogger(this.prototype)),e.style)},material:{color:r},outline:s,anchor:i?"relative":void 0,anchorPosition:i})}static fromPictureMarkerSymbol(e){const r=!e.color||_he(e.color)?l0:e.color,i=ZO(e);return new dp({size:e.width<=e.height?e.height:e.width,angle:e.angle,resource:{href:e.url},material:{color:r.clone()},anchor:i?"relative":void 0,anchorPosition:i})}static fromCIMSymbol(e){return new dp({resource:{href:Mz({mediaType:"application/json",data:JSON.stringify(e.data)})}})}},dp=kf,kf);function ZO(t){const e="width"in t?t.width:t.size,r="height"in t?t.height:t.size,i=JO(t.xoffset),s=JO(t.yoffset);return(i||s)&&e&&r?{x:-i/e,y:s/r}:null}function JO(t){return isFinite(t)?t:0}c([d({type:ls,json:{write:!0}})],ei.prototype,"material",void 0),c([d({type:Yc,json:{write:!0}})],ei.prototype,"resource",void 0),c([ye({Icon:"icon"},{readOnly:!0})],ei.prototype,"type",void 0),c([d({...Ta,json:{write:{isRequired:!0}}})],ei.prototype,"size",void 0),c([ye({center:"center",left:"left",right:"right",top:"top",bottom:"bottom",topLeft:"top-left",topRight:"top-right",bottomLeft:"bottom-left",bottomRight:"bottom-right",relative:"relative"},{default:"center"})],ei.prototype,"anchor",void 0),c([d({type:Zp,json:{type:[Number],read:{reader:t=>new Zp({x:t[0],y:t[1]})},write:{writer:(t,e)=>{e.anchorPosition=[t.x,t.y]},overridePolicy(){return{enabled:this.anchor==="relative"}}}}})],ei.prototype,"anchorPosition",void 0),c([d({type:cg,json:{write:!0}})],ei.prototype,"outline",void 0),c([d({type:Number,json:{write:!0,default:0}})],ei.prototype,"angle",void 0),ei=dp=c([C("esri.symbols.IconSymbol3DLayer")],ei);const Ahe={circle:"circle",cross:"cross",diamond:"kite",square:"square",x:"x",triangle:"triangle",path:null};function Lhe(t,e){return Ahe[e]||(t().warn(`${e} cannot be mapped to Icon symbol. Fallback to "circle"`),"circle")}const Rhe=["begin","end","begin-end"],wG=["arrow","circle","square","diamond","cross","x"];let _l=class extends Ce.ClonableMixin(W){constructor(e){super(e),this.type="style",this.placement="begin-end",this.style="arrow",this.color=null}equals(e){return e!=null&&e.placement===this.placement&&e.style===this.style&&(this.color==null&&e.color==null||this.color!=null&&e.color!=null&&this.color.toJSON()===e.color.toJSON())}};c([d({type:["style"],readOnly:!0,json:{read:!0,write:{ignoreOrigin:!0,isRequired:!0}}})],_l.prototype,"type",void 0),c([d({type:Rhe,json:{default:"begin-end",write:!0}})],_l.prototype,"placement",void 0),c([d({type:wG,json:{default:"arrow",write:!0}})],_l.prototype,"style",void 0),c([d({type:Q,json:{type:[qe],default:null,write:!0}})],_l.prototype,"color",void 0),_l=c([C("esri.symbols.LineStyleMarker3D")],_l);var Q1,Of;let Ri=(Of=class extends Ui{constructor(e){super(e),this.material=null,this.type="line",this.join="miter",this.cap="butt",this.size=tt(1),this.pattern=null,this.marker=null}clone(){const e={enabled:this.enabled,material:this.material!=null?this.material.clone():null,size:this.size,join:this.join,cap:this.cap,pattern:this.pattern!=null?this.pattern.clone():null,marker:this.marker!=null?this.marker.clone():null};return new Q1(e)}static fromSimpleLineSymbol(e){const r={enabled:!0,size:e.width??tt(1),cap:e.cap||"butt",join:e.join||"miter",pattern:e.style?new zh({style:e.style}):null,material:new ls({color:(e.color||l0).clone()}),marker:e.marker?new _l({placement:e.marker.placement,style:e.marker.style,color:e.marker.color?.clone()??null}):null};return new Q1(r)}},Q1=Of,Of);c([d({type:ls,json:{write:!0}})],Ri.prototype,"material",void 0),c([ye({Line:"line"},{readOnly:!0})],Ri.prototype,"type",void 0),c([d({type:bG,json:{write:!0,default:"miter"}})],Ri.prototype,"join",void 0),c([d({type:gA,json:{write:!0,default:"butt"}})],Ri.prototype,"cap",void 0),c([d({...Ta,json:{write:{isRequired:!0}}})],Ri.prototype,"size",void 0),c([d(vG)],Ri.prototype,"pattern",void 0),c([d({types:{key:"type",base:_l,typeMap:{style:_l}},json:{write:!0}})],Ri.prototype,"marker",void 0),Ri=Q1=c([C("esri.symbols.LineSymbol3DLayer")],Ri);var $E;const khe=Wr()({sphere:"sphere",cylinder:"cylinder",cube:"cube",cone:"cone",diamond:"diamond",tetrahedron:"tetrahedron",invertedCone:"inverted-cone"});let hg=$E=class extends W{clone(){return new $E({href:this.href,primitive:this.primitive})}};c([d({type:String,json:{read:GS,write:hd}})],hg.prototype,"href",void 0),c([ye(khe)],hg.prototype,"primitive",void 0),hg=$E=c([C("esri.symbols.support.ObjectSymbol3DLayerResource")],hg);const Ohe="sphere";var ME;let Mh=ME=class extends ce{constructor(){super(...arguments),this.x=0,this.y=0,this.z=0}clone(){return new ME({x:this.x,y:this.y,z:this.z})}};c([d({type:Number})],Mh.prototype,"x",void 0),c([d({type:Number})],Mh.prototype,"y",void 0),c([d({type:Number})],Mh.prototype,"z",void 0),Mh=ME=c([C("esri.symbols.support.Symbol3DAnchorPosition3D")],Mh);var TE,Nf;let zr=(Nf=class extends Ui{constructor(e){super(e),this.material=null,this.castShadows=!0,this.resource=null,this.type="object",this.width=void 0,this.height=void 0,this.depth=void 0,this.anchor=void 0,this.anchorPosition=void 0,this.heading=void 0,this.tilt=void 0,this.roll=void 0}clone(){return new TE({heading:this.heading,tilt:this.tilt,roll:this.roll,anchor:this.anchor,anchorPosition:this.anchorPosition?.clone(),depth:this.depth,enabled:this.enabled,height:this.height,material:this.material?.clone()??null,castShadows:this.castShadows,resource:this.resource?.clone(),width:this.width})}get isPrimitive(){return!this.resource||typeof this.resource.href!="string"}},TE=Nf,Nf);c([d({type:ls,json:{write:!0}})],zr.prototype,"material",void 0),c([d({type:Boolean,nonNullable:!0,json:{write:!0,default:!0}})],zr.prototype,"castShadows",void 0),c([d({type:hg,json:{write:!0}})],zr.prototype,"resource",void 0),c([ye({Object:"object"},{readOnly:!0})],zr.prototype,"type",void 0),c([d({type:Number,json:{write:!0}})],zr.prototype,"width",void 0),c([d({type:Number,json:{write:!0}})],zr.prototype,"height",void 0),c([d({type:Number,json:{write:!0}})],zr.prototype,"depth",void 0),c([ye({center:"center",top:"top",bottom:"bottom",origin:"origin",relative:"relative"},{default:"origin"})],zr.prototype,"anchor",void 0),c([d({type:Mh,json:{type:[Number],read:{reader:t=>new Mh({x:t[0],y:t[1],z:t[2]})},write:{writer:(t,e)=>{e.anchorPosition=[t.x,t.y,t.z]},overridePolicy(){return{enabled:this.anchor==="relative"}}}}})],zr.prototype,"anchorPosition",void 0),c([d({type:Number,json:{write:!0}})],zr.prototype,"heading",void 0),c([d({type:Number,json:{write:!0}})],zr.prototype,"tilt",void 0),c([d({type:Number,json:{write:!0}})],zr.prototype,"roll",void 0),c([d({readOnly:!0})],zr.prototype,"isPrimitive",null),zr=TE=c([C("esri.symbols.ObjectSymbol3DLayer")],zr);var EE,Ff;let Kr=(Ff=class extends Ui{constructor(e){super(e),this.material=null,this.castShadows=!0,this.type="path",this.profile="circle",this.join="miter",this.cap="butt",this.width=void 0,this.height=void 0,this.anchor="center",this.profileRotation="all"}readWidth(e,r){return e??(r.height==null&&r.size!=null?r.size:void 0)}readHeight(e,r){return e??(r.width==null&&r.size!=null?r.size:void 0)}clone(){return new EE({enabled:this.enabled,material:this.material!=null?this.material.clone():null,castShadows:this.castShadows,profile:this.profile,join:this.join,cap:this.cap,width:this.width,height:this.height,profileRotation:this.profileRotation,anchor:this.anchor})}},EE=Ff,Ff);c([d({type:ls,json:{write:!0}})],Kr.prototype,"material",void 0),c([d({type:Boolean,nonNullable:!0,json:{write:!0,default:!0}})],Kr.prototype,"castShadows",void 0),c([ye({Path:"path"},{readOnly:!0})],Kr.prototype,"type",void 0),c([d({type:["circle","quad"],json:{write:!0,default:"circle"}})],Kr.prototype,"profile",void 0),c([d({type:bG,json:{write:!0,default:"miter"}})],Kr.prototype,"join",void 0),c([d({type:Ihe,json:{write:!0,default:"butt"}})],Kr.prototype,"cap",void 0),c([d({type:Number,json:{write:{enabled:!0,target:{width:{type:Number},size:{type:Number}}}}})],Kr.prototype,"width",void 0),c([K("width",["width","size","height"])],Kr.prototype,"readWidth",null),c([d({type:Number,json:{write:!0}})],Kr.prototype,"height",void 0),c([K("height",["height","size","width"])],Kr.prototype,"readHeight",null),c([d({type:["center","bottom","top"],json:{write:!0,default:"center"}})],Kr.prototype,"anchor",void 0),c([d({type:["heading","all"],json:{write:!0,default:"all"}})],Kr.prototype,"profileRotation",void 0),Kr=EE=c([C("esri.symbols.PathSymbol3DLayer")],Kr);const Nhe=["none","underline","line-through"],Fhe=["normal","italic","oblique"],Dhe=["normal","lighter","bold","bolder"],SG={type:Number,cast:t=>{const e=Di(t);return e===0?1:$i(e,.1,4)},nonNullable:!0},zhe=["left","right","center"],Vhe=["baseline","top","middle","bottom"],xG={type:zhe,nonNullable:!0},$G={type:Vhe,nonNullable:!0},jhe=8;var IE;let Is=IE=class extends W{constructor(t){super(t),this.decoration="none",this.family="sans-serif",this.size=9,this.style="normal",this.weight="normal"}castSize(t){return Be(t)}clone(){return new IE({decoration:this.decoration,family:this.family,size:this.size,style:this.style,weight:this.weight})}hash(){return`${this.decoration}.${this.family}.${this.size}.${this.style}.${this.weight}`}};c([d({type:Nhe,json:{default:"none",write:!0}})],Is.prototype,"decoration",void 0),c([d({type:String,json:{write:!0}})],Is.prototype,"family",void 0),c([d({type:Number,json:{write:{overridePolicy:(t,e,r)=>({enabled:!r||!r.textSymbol3D})}}})],Is.prototype,"size",void 0),c([We("size")],Is.prototype,"castSize",null),c([d({type:Fhe,json:{default:"normal",write:!0}})],Is.prototype,"style",void 0),c([d({type:Dhe,json:{default:"normal",write:!0}})],Is.prototype,"weight",void 0),Is=IE=c([C("esri.symbols.Font")],Is);var CE;let Jp=CE=class extends W{constructor(){super(...arguments),this.color=new Q([0,0,0,1]),this.size=0}clone(){const t={color:k(this.color),size:this.size};return new CE(t)}};c([d(xc())],Jp.prototype,"color",void 0),c([d(Ta)],Jp.prototype,"size",void 0),Jp=CE=c([C("esri.symbols.support.Symbol3DHalo")],Jp);let c0=class extends Ce.ClonableMixin(W){constructor(e){super(e),this.color=null}};c([d(xc())],c0.prototype,"color",void 0),c0=c([C("esri.symbols.support.Symbol3DTextBackground")],c0);var eb,Df;let Er=(Df=class extends Ui{constructor(e){super(e),this._userSize=void 0,this.halo=null,this.horizontalAlignment="center",this.lineHeight=1,this.material=null,this.background=null,this.text=null,this.type="text",this.verticalAlignment="baseline"}get font(){return this._get("font")||null}set font(e){e!=null&&this._userSize!=null&&(e.size=this._userSize),this._set("font",e)}writeFont(e,r,i,s){const n={...s,textSymbol3D:!0};r.font=e.write({},n),delete r.font.size}get size(){return this._userSize!=null?this._userSize:this.font?.size!=null?this.font.size:9}set size(e){this._userSize=e,this.font!=null&&(this.font.size=this._userSize),this.notifyChange("size")}clone(){const e=new eb({enabled:this.enabled,font:this.font&&k(this.font),halo:this.halo&&k(this.halo),horizontalAlignment:this.horizontalAlignment,lineHeight:this.lineHeight,material:this.material!=null?this.material.clone():null,text:this.text,verticalAlignment:this.verticalAlignment,background:k(this.background)});return e._userSize=this._userSize,e}static fromTextSymbol(e){return new eb({font:e.font!=null?e.font.clone():new Is,halo:Uhe(e.haloColor,e.haloSize),horizontalAlignment:e.horizontalAlignment,lineHeight:e.lineHeight,material:e.color?new ls({color:e.color.clone()}):null,text:e.text,verticalAlignment:e.verticalAlignment,background:e.backgroundColor?new c0({color:e.backgroundColor.clone()}):null})}},eb=Df,Df);function Uhe(t,e){return t&&e!=null&&e>0?new Jp({color:k(t),size:e}):null}c([d({type:Is,json:{write:!0}})],Er.prototype,"font",null),c([re("font")],Er.prototype,"writeFont",null),c([d({type:Jp,json:{write:!0}})],Er.prototype,"halo",void 0),c([d({...xG,json:{default:"center",write:!0}})],Er.prototype,"horizontalAlignment",void 0),c([d({...SG,json:{default:1,write:!0}})],Er.prototype,"lineHeight",void 0),c([d({type:ls,json:{write:!0}})],Er.prototype,"material",void 0),c([d({type:c0,json:{write:!0}})],Er.prototype,"background",void 0),c([d(Ta)],Er.prototype,"size",null),c([d({type:String,json:{write:!0}})],Er.prototype,"text",void 0),c([ye({Text:"text"},{readOnly:!0})],Er.prototype,"type",void 0),c([d({...$G,json:{default:"baseline",write:!0}})],Er.prototype,"verticalAlignment",void 0),Er=eb=c([C("esri.symbols.TextSymbol3DLayer")],Er);var PE,zf;let ul=(zf=class extends Ui{constructor(e){super(e),this.color=AE.clone(),this.type="water",this.waterbodySize="medium",this.waveDirection=null,this.waveStrength="moderate"}clone(){return new PE({color:k(this.color),waterbodySize:this.waterbodySize,waveDirection:this.waveDirection,waveStrength:this.waveStrength})}},PE=zf,zf);c([d({type:Q,nonNullable:!0,json:{type:[qe],write:(t,e,r)=>e[r]=t.toArray(Q.AlphaMode.UNLESS_OPAQUE),default:()=>AE.clone(),defaultEquals:t=>t.toCss(!0)===AE.toCss(!0)}})],ul.prototype,"color",void 0),c([ye({Water:"water"},{readOnly:!0})],ul.prototype,"type",void 0),c([d({type:["small","medium","large"],json:{write:!0,default:"medium"}})],ul.prototype,"waterbodySize",void 0),c([d({type:Number,json:{write:!0,default:null}})],ul.prototype,"waveDirection",void 0),c([d({type:["calm","rippled","slight","moderate"],json:{write:!0,default:"moderate"}})],ul.prototype,"waveStrength",void 0),ul=PE=c([C("esri.symbols.WaterSymbol3DLayer")],ul);const AE=new Q([0,119,190]);var LE;let Xn=LE=class extends ce{constructor(t){super(t),this.name=null,this.styleUrl=null,this.styleName=null,this.portal=null}clone(){return new LE({name:this.name,styleUrl:this.styleUrl,styleName:this.styleName,portal:this.portal})}};c([d({type:String})],Xn.prototype,"name",void 0),c([d({type:String})],Xn.prototype,"styleUrl",void 0),c([d({type:String})],Xn.prototype,"styleName",void 0),c([d({type:Y})],Xn.prototype,"portal",void 0),Xn=LE=c([C("esri.symbols.support.StyleOrigin")],Xn);var RE;let Kh=RE=class extends ce{constructor(){super(...arguments),this.url=""}clone(){return new RE({url:this.url})}};c([d({type:String})],Kh.prototype,"url",void 0),Kh=RE=c([C("esri.symbols.support.Thumbnail")],Kh);const MG={icon:ei,object:zr,line:Ri,path:Kr,fill:ki,extrude:ll,text:Er,water:ul},Ghe=se.ofType({base:Ui,key:"type",typeMap:MG,errorContext:"symbol-layer"});let rs=class extends sr{constructor(e){super(e),this.styleOrigin=null,this.thumbnail=null,this.type=null;const r=this.__accessor__&&this.__accessor__.metadata&&this.__accessor__.metadata.symbolLayers,i=r?.type,s=i||se;this._set("symbolLayers",new s)}get color(){return null}set color(e){this.constructed&&q.getLogger(this).error("Symbol3D does not support colors on the symbol level. Colors may be set on individual symbol layer materials instead.")}set symbolLayers(e){zl(e,this._get("symbolLayers"))}readStyleOrigin(e,r,i){if(e.styleUrl&&e.name){const s=Fl(e.styleUrl,i);return new Xn({styleUrl:s,name:e.name})}if(e.styleName&&e.name)return new Xn({portal:i?.portal||Y.getDefault(),styleName:e.styleName,name:e.name});i?.messages&&i.messages.push(new Fs("symbol3d:incomplete-style-origin","Style origin requires either a 'styleUrl' or 'styleName' and a 'name' property",{context:i,definition:e}))}writeStyleOrigin(e,r,i,s){if(e.styleUrl&&e.name){let n=cd(e.styleUrl,s);cs(n)&&(n=fn(n)),r.styleOrigin={styleUrl:n,name:e.name}}else e.styleName&&e.name&&(e.portal&&s?.portal&&!$z(e.portal.restUrl,s.portal.restUrl)?s?.messages&&s.messages.push(new Fs("symbol:cross-portal","The symbol style origin cannot be persisted because it refers to an item on a different portal than the one being saved to.",{symbol:this})):r.styleOrigin={styleName:e.styleName,name:e.name})}normalizeCtorArgs(e){return e instanceof Ui||e&&MG[e.type]?{symbolLayers:[e]}:Array.isArray(e)?{symbolLayers:e}:e}};c([d({json:{read:!1,write:!1}})],rs.prototype,"color",null),c([d({type:Ghe,nonNullable:!0,json:{write:!0}}),We(kV)],rs.prototype,"symbolLayers",null),c([d({type:Xn})],rs.prototype,"styleOrigin",void 0),c([K("styleOrigin")],rs.prototype,"readStyleOrigin",null),c([re("styleOrigin",{"styleOrigin.styleUrl":{type:String},"styleOrigin.styleName":{type:String},"styleOrigin.name":{type:String}})],rs.prototype,"writeStyleOrigin",null),c([d({type:Kh,json:{read:!1}})],rs.prototype,"thumbnail",void 0),c([d({type:["point-3d","line-3d","polygon-3d","mesh-3d","label-3d"],readOnly:!0})],rs.prototype,"type",void 0),rs=c([C("esri.symbols.Symbol3D")],rs);let Yp=class extends W{constructor(e){super(e),this.visible=!0}clone(){throw new Error("Subclasses of Callout3D should implement their own clone method.")}};c([d({type:["line"],constructOnly:!0,json:{read:!1,write:{ignoreOrigin:!0,isRequired:!0}}})],Yp.prototype,"type",void 0),c([d({readOnly:!0})],Yp.prototype,"visible",void 0),Yp=c([C("esri.symbols.callouts.Callout3D")],Yp);var kE;let tb=kE=class extends W{constructor(t){super(t),this.color=new Q("white")}clone(){return new kE({color:k(this.color)})}};c([d(xc({colorRequiredOnWrite:!0}))],tb.prototype,"color",void 0),tb=kE=c([C("esri.symbols.callouts.LineCallout3DBorder")],tb);const Bhe=tb;var OE;let cl=OE=class extends Yp{constructor(t){super(t),this.type="line",this.color=new Q([0,0,0,1]),this.size=tt(1),this.border=null}get visible(){return this.size>0&&this.color!=null&&this.color.a>0}clone(){return new OE({color:k(this.color),size:this.size,border:k(this.border)})}};c([ye({line:"line"})],cl.prototype,"type",void 0),c([d(xc({colorRequiredOnWrite:!0}))],cl.prototype,"color",void 0),c([d({...Ta,json:{write:{isRequired:!0}}})],cl.prototype,"size",void 0),c([d({type:Bhe,json:{write:!0}})],cl.prototype,"border",void 0),c([d({readOnly:!0})],cl.prototype,"visible",null),cl=OE=c([C("esri.symbols.callouts.LineCallout3D")],cl);function vA(t){if(!t)return!1;const e=t.verticalOffset;return!(!e||e.screenLength<=0||e.maxWorldLength!=null&&e.maxWorldLength<=0)}function TG(t){return!t||!t.supportsCallout||!t.supportsCallout()?!1:!!t.callout?.visible&&!!vA(t)}function e5e(t){return t.type==="point-3d"||t.type==="label-3d"}function t5e(t){return t.horizontalAlignment==="center"}const EG={types:{key:"type",base:Yp,typeMap:{line:cl}},json:{write:!0}};var NE;let Du=NE=class extends W{constructor(t){super(t),this.screenLength=0,this.minWorldLength=0,this.maxWorldLength=null}clone(){return new NE({screenLength:this.screenLength,minWorldLength:this.minWorldLength,maxWorldLength:this.maxWorldLength})}};c([d({...Ta,json:{write:{isRequired:!0}}})],Du.prototype,"screenLength",void 0),c([d({type:Number,nonNullable:!0,json:{write:!0,default:0}})],Du.prototype,"minWorldLength",void 0),c([d({type:Number,json:{write:!0}})],Du.prototype,"maxWorldLength",void 0),Du=NE=c([C("esri.symbols.support.Symbol3DVerticalOffset")],Du);var rb;const IG=se.ofType({base:null,key:"type",typeMap:{text:Er}});let qn=rb=class extends rs{constructor(t){super(t),this.verticalOffset=null,this.callout=null,this.styleOrigin=null,this.symbolLayers=new IG,this.type="label-3d"}supportsCallout(){return!0}hasVisibleCallout(){return TG(this)}hasVisibleVerticalOffset(){return vA(this)}clone(){return new rb({styleOrigin:k(this.styleOrigin),symbolLayers:k(this.symbolLayers),thumbnail:k(this.thumbnail),callout:k(this.callout),verticalOffset:k(this.verticalOffset)})}static fromTextSymbol(t){return new rb({symbolLayers:new se([Er.fromTextSymbol(t)])})}};c([d({type:Du,json:{write:!0}})],qn.prototype,"verticalOffset",void 0),c([d(EG)],qn.prototype,"callout",void 0),c([d({json:{read:!1,write:!1}})],qn.prototype,"styleOrigin",void 0),c([d({type:IG})],qn.prototype,"symbolLayers",void 0),c([ye({LabelSymbol3D:"label-3d"},{readOnly:!0})],qn.prototype,"type",void 0),qn=rb=c([C("esri.symbols.LabelSymbol3D")],qn);var ib;const CG=se.ofType({base:null,key:"type",typeMap:{line:Ri,path:Kr}}),qhe=se.ofType({base:null,key:"type",typeMap:{line:Ri,path:Kr}});let ro=ib=class extends rs{constructor(t){super(t),this.symbolLayers=new CG,this.type="line-3d"}clone(){return new ib({styleOrigin:k(this.styleOrigin),symbolLayers:k(this.symbolLayers),thumbnail:k(this.thumbnail)})}static fromSimpleLineSymbol(t){return new ib({symbolLayers:new se([Ri.fromSimpleLineSymbol(t)])})}};c([d({type:CG,json:{type:qhe}})],ro.prototype,"symbolLayers",void 0),c([ye({LineSymbol3D:"line-3d"},{readOnly:!0})],ro.prototype,"type",void 0),ro=ib=c([C("esri.symbols.LineSymbol3D")],ro);var sb;const PG=se.ofType({base:null,key:"type",typeMap:{fill:ki}});let El=sb=class extends rs{constructor(t){super(t),this.symbolLayers=new PG,this.type="mesh-3d"}clone(){return new sb({styleOrigin:k(this.styleOrigin),symbolLayers:k(this.symbolLayers),thumbnail:k(this.thumbnail)})}static fromSimpleFillSymbol(t){return new sb({symbolLayers:new se([ki.fromSimpleFillSymbol(t)])})}};c([d({type:PG})],El.prototype,"symbolLayers",void 0),c([ye({MeshSymbol3D:"mesh-3d"},{readOnly:!0})],El.prototype,"type",void 0),El=sb=c([C("esri.symbols.MeshSymbol3D")],El);let dg=class extends sr{constructor(e){super(e),this.type="simple-line",this.width=.75}hash(){return`${this.type}.${this.width}`}};c([ye({esriSLS:"simple-line"},{readOnly:!0})],dg.prototype,"type",void 0),c([d({type:Number,cast:Be,json:{write:!0}})],dg.prototype,"width",void 0),dg=c([C("esri.symbols.LineSymbol")],dg);var FE;let wo=FE=class extends W{constructor(t){super(t),this.placement="begin-end",this.type="line-marker",this.style="arrow"}writeStyle(t,e,r,i){e[r]=i?.origin==="web-map"?"arrow":t}set color(t){this._set("color",t)}readColor(t){return t?.[0]!=null?[t[0],t[1],t[2],t[3]/255]:t}writeColor(t,e,r,i){i?.origin==="web-map"||(e[r]=t)}clone(){return new FE({color:k(this.color),placement:this.placement,style:this.style})}hash(){return`${this.placement}.${this.color?.hash()}.${this.style}`}};c([d({type:["begin","end","begin-end"],json:{write:!0}})],wo.prototype,"placement",void 0),c([ye({"line-marker":"line-marker"},{readOnly:!0}),d({json:{origins:{"web-map":{write:!1}}}})],wo.prototype,"type",void 0),c([d({type:wG})],wo.prototype,"style",void 0),c([re("style")],wo.prototype,"writeStyle",null),c([d({type:Q,value:null,json:{write:{allowNull:!0}}})],wo.prototype,"color",null),c([K("color")],wo.prototype,"readColor",null),c([re("color")],wo.prototype,"writeColor",null),wo=FE=c([C("esri.symbols.LineSymbolMarker")],wo);const Hhe=wo;var DE;const Zx=new De({esriSLSSolid:"solid",esriSLSDash:"dash",esriSLSDot:"dot",esriSLSDashDot:"dash-dot",esriSLSDashDotDot:"long-dash-dot-dot",esriSLSNull:"none",esriSLSShortDash:"short-dash",esriSLSShortDot:"short-dot",esriSLSShortDashDot:"short-dash-dot",esriSLSShortDashDotDot:"short-dash-dot-dot",esriSLSLongDash:"long-dash",esriSLSLongDashDot:"long-dash-dot"});let jt=DE=class extends dg{constructor(...t){super(...t),this.type="simple-line",this.style="solid",this.cap="round",this.join="round",this.marker=null,this.miterLimit=2}normalizeCtorArgs(t,e,r,i,s,n){if(t&&typeof t!="string")return t;const o={};return t!=null&&(o.style=t),e!=null&&(o.color=e),r!=null&&(o.width=Be(r)),i!=null&&(o.cap=i),s!=null&&(o.join=s),n!=null&&(o.miterLimit=Be(n)),o}clone(){return new DE({color:k(this.color),style:this.style,width:this.width,cap:this.cap,join:this.join,miterLimit:this.miterLimit,marker:this.marker?.clone()})}hash(){return`${super.hash()}.${this.color?.hash()}.${this.style}.${this.cap}.${this.join}.${this.miterLimit}.${this.marker?.hash()}`}};c([ye({esriSLS:"simple-line"},{readOnly:!0})],jt.prototype,"type",void 0),c([d({type:Zx.apiValues,json:{read:Zx.read,write:Zx.write}})],jt.prototype,"style",void 0),c([d({type:["butt","round","square"],json:{write:{overridePolicy:(t,e,r)=>({enabled:t!=="round"&&r?.origin==null})}}})],jt.prototype,"cap",void 0),c([d({type:["miter","round","bevel"],json:{write:{overridePolicy:(t,e,r)=>({enabled:t!=="round"&&r?.origin==null})}}})],jt.prototype,"join",void 0),c([d({types:{key:"type",base:null,defaultKeyValue:"line-marker",typeMap:{"line-marker":Hhe}},json:{write:!0,origins:{"web-scene":{write:!1}}}})],jt.prototype,"marker",void 0),c([d({type:Number,json:{read:!1,write:!1}})],jt.prototype,"miterLimit",void 0),jt=DE=c([C("esri.symbols.SimpleLineSymbol")],jt);let Xp=class extends sr{constructor(e){super(e),this.outline=null,this.type=null}hash(){return`${this.type}.${this.outline?.hash()}`}};c([d({types:{key:"type",base:null,defaultKeyValue:"simple-line",typeMap:{"simple-line":jt}},json:{default:null,write:!0}})],Xp.prototype,"outline",void 0),c([d({type:["simple-fill","picture-fill"],readOnly:!0})],Xp.prototype,"type",void 0),Xp=c([C("esri.symbols.FillSymbol")],Xp);function Whe(t,e,r){return e.imageData?Mz({mediaType:e.contentType||"image/png",isBase64:!0,data:e.imageData}):AG(e.url,r)}function AG(t,e){if(!cs(t)){const r=Jhe(e);if(r)return ud(r,"images",t)}return Fl(t,e)}function Zhe(t,e,r,i){if(xd(t)){const s=rm(t);if(!s)return;e.contentType=s.mediaType,e.imageData=s.data,r&&r.imageData===e.imageData&&r.url&&hd(r.url,e,"url",i)}else hd(t,e,"url",i)}const LG={json:{read:{source:["imageData","url"],reader:Whe},write:{writer(t,e,r,i){Zhe(t,e,this.source,i)}}}},RG={readOnly:!0,json:{read:{source:["imageData","url"],reader(t,e,r){const i={};return e.imageData&&(i.imageData=e.imageData),e.contentType&&(i.contentType=e.contentType),e.url&&(i.url=AG(e.url,r)),i}}}};function Jhe(t){if(!t)return null;const{origin:e,layer:r}=t;if(e!=="service"&&e!=="portal-item")return null;const i=r?.type;return i==="feature"||i==="stream"?r.parsedUrl?.path:i==="map-image"||i==="tile"?t.url?.path:null}var zE;let es=zE=class extends Xp{constructor(...t){super(...t),this.type="picture-fill",this.url=null,this.xscale=1,this.yscale=1,this.width=12,this.height=12,this.xoffset=0,this.yoffset=0,this.source=null}normalizeCtorArgs(t,e,r,i){if(t&&typeof t!="string"&&t.imageData==null)return t;const s={};return t&&(s.url=t),e&&(s.outline=e),r!=null&&(s.width=Be(r)),i!=null&&(s.height=Be(i)),s}clone(){const t=new zE({color:k(this.color),height:this.height,outline:k(this.outline),url:this.url,width:this.width,xoffset:this.xoffset,xscale:this.xscale,yoffset:this.yoffset,yscale:this.yscale});return t._set("source",k(this.source)),t}hash(){return`${super.hash()}.${this.color?.hash()}.${this.height}.${this.url}.${this.width}.${this.xoffset}.${this.xscale}.${this.yoffset}.${this.yscale}`}};c([ye({esriPFS:"picture-fill"},{readOnly:!0})],es.prototype,"type",void 0),c([d(LG)],es.prototype,"url",void 0),c([d({type:Number,json:{write:!0}})],es.prototype,"xscale",void 0),c([d({type:Number,json:{write:!0}})],es.prototype,"yscale",void 0),c([d({type:Number,cast:Be,json:{write:!0}})],es.prototype,"width",void 0),c([d({type:Number,cast:Be,json:{write:!0}})],es.prototype,"height",void 0),c([d({type:Number,cast:Be,json:{write:!0}})],es.prototype,"xoffset",void 0),c([d({type:Number,cast:Be,json:{write:!0}})],es.prototype,"yoffset",void 0),c([d(RG)],es.prototype,"source",void 0),es=zE=c([C("esri.symbols.PictureFillSymbol")],es);let hl=class extends sr{constructor(e){super(e),this.angle=0,this.type=null,this.xoffset=0,this.yoffset=0,this.size=9}hash(){return`${this.type}.${this.angle}.${this.size}.${this.xoffset}.${this.yoffset}`}};c([d({type:Number,json:{read:t=>t&&-1*t,write:(t,e)=>e.angle=t&&-1*t}})],hl.prototype,"angle",void 0),c([d({type:["simple-marker","picture-marker"],readOnly:!0})],hl.prototype,"type",void 0),c([d({type:Number,cast:Be,json:{write:!0}})],hl.prototype,"xoffset",void 0),c([d({type:Number,cast:Be,json:{write:!0}})],hl.prototype,"yoffset",void 0),c([d({cast:t=>t==="auto"?t:Di(Be(t)),json:{write:!0}})],hl.prototype,"size",void 0),hl=c([C("esri.symbols.MarkerSymbol")],hl);var VE;let Li=VE=class extends hl{constructor(...t){super(...t),this.color=null,this.type="picture-marker",this.url=null,this.source=null,this.height=12,this.width=12,this.size=null}normalizeCtorArgs(t,e,r){if(t&&typeof t!="string"&&t.imageData==null)return t;const i={};return t&&(i.url=t),e!=null&&(i.width=Be(e)),r!=null&&(i.height=Be(r)),i}readHeight(t,e){return e.size||t}readWidth(t,e){return e.size||t}clone(){const t=new VE({angle:this.angle,height:this.height,url:this.url,width:this.width,xoffset:this.xoffset,yoffset:this.yoffset});return t._set("source",k(this.source)),t}hash(){return`${super.hash()}.${this.height}.${this.url}.${this.width}`}};c([d({json:{write:!1}})],Li.prototype,"color",void 0),c([ye({esriPMS:"picture-marker"},{readOnly:!0})],Li.prototype,"type",void 0),c([d(LG)],Li.prototype,"url",void 0),c([d(RG)],Li.prototype,"source",void 0),c([d({type:Number,cast:Be,json:{write:!0}})],Li.prototype,"height",void 0),c([K("height",["height","size"])],Li.prototype,"readHeight",null),c([d({type:Number,cast:Be,json:{write:!0}})],Li.prototype,"width",void 0),c([d({json:{write:!1}})],Li.prototype,"size",void 0),Li=VE=c([C("esri.symbols.PictureMarkerSymbol")],Li);var Xc;const kG=se.ofType({base:null,key:"type",typeMap:{icon:ei,object:zr,text:Er}});let zi=Xc=class extends rs{constructor(t){super(t),this.verticalOffset=null,this.callout=null,this.symbolLayers=new kG,this.type="point-3d"}supportsCallout(){if((this.symbolLayers?this.symbolLayers.length:0)<1)return!1;for(const t of this.symbolLayers.items)switch(t.type){case"icon":case"text":case"object":continue;default:return!1}return!0}hasVisibleCallout(){return TG(this)}hasVisibleVerticalOffset(){return vA(this)}clone(){return new Xc({verticalOffset:k(this.verticalOffset),callout:k(this.callout),styleOrigin:k(this.styleOrigin),symbolLayers:k(this.symbolLayers),thumbnail:k(this.thumbnail)})}static fromSimpleMarkerSymbol(t){return new Xc({symbolLayers:new se([ei.fromSimpleMarkerSymbol(t)])})}static fromPictureMarkerSymbol(t){return new Xc({symbolLayers:new se([ei.fromPictureMarkerSymbol(t)])})}static fromCIMSymbol(t){if(t.data?.symbol?.type!=="CIMPointSymbol")return null;const r=t.data.symbol;return new Xc(r?.callout?{symbolLayers:new se([ei.fromCIMSymbol(t)]),callout:new cl({size:.5,color:new Q([0,0,0])}),verticalOffset:new Du({screenLength:40})}:{symbolLayers:new se([ei.fromCIMSymbol(t)])})}static fromTextSymbol(t){return new Xc({symbolLayers:new se([Er.fromTextSymbol(t)])})}};c([d({type:Du,json:{write:!0}})],zi.prototype,"verticalOffset",void 0),c([d(EG)],zi.prototype,"callout",void 0),c([d({type:kG,json:{origins:{"web-scene":{write:!0}}}})],zi.prototype,"symbolLayers",void 0),c([ye({PointSymbol3D:"point-3d"},{readOnly:!0})],zi.prototype,"type",void 0),zi=Xc=c([C("esri.symbols.PointSymbol3D")],zi);var pg;const OG=se.ofType({base:null,key:"type",typeMap:{extrude:ll,fill:ki,icon:ei,line:Ri,object:zr,text:Er,water:ul}});let dn=pg=class extends rs{constructor(t){super(t),this.symbolLayers=new OG,this.type="polygon-3d"}initialize(){const t=e=>{e.type==="line"&&nc(q.getLogger(this),"LineSymbol3DLayer can not be used as a SymbolLayer with a PolygonSymbol3D symbol anymore.",{replacement:"Use FillSymbol3DLayer.outline instead.",version:"4.28"}),e.type==="text"&&nc(q.getLogger(this),"TextSymbol3DLayer can not be used as a SymbolLayer with a PolygonSymbol3D symbol anymore.",{replacement:"Use Labels instead.",version:"4.28"})};for(const e of this.symbolLayers)t(e);this.addHandles(so((()=>this.symbolLayers),"after-add",(({item:e})=>t(e)),Ma))}clone(){return new pg({styleOrigin:k(this.styleOrigin),symbolLayers:k(this.symbolLayers),thumbnail:k(this.thumbnail)})}static fromJSON(t){const e=new pg;if(e.read(t),e.symbolLayers.length===2&&e.symbolLayers.at(0).type==="fill"&&e.symbolLayers.at(1).type==="line"){const r=e.symbolLayers.at(0),i=e.symbolLayers.at(1);!i.enabled||t.symbolLayers?.[1]&&t.symbolLayers[1].enable===!1||(r.outline={size:i.size,color:i.material!=null?i.material.color:null}),e.symbolLayers.removeAt(1)}return e}static fromSimpleFillSymbol(t){return new pg({symbolLayers:new se([ki.fromSimpleFillSymbol(t)])})}};c([d({type:OG,json:{write:!0}})],dn.prototype,"symbolLayers",void 0),c([ye({PolygonSymbol3D:"polygon-3d"},{readOnly:!0})],dn.prototype,"type",void 0),dn=pg=c([C("esri.symbols.PolygonSymbol3D")],dn);var jE;const Jx=new De({esriSFSSolid:"solid",esriSFSNull:"none",esriSFSHorizontal:"horizontal",esriSFSVertical:"vertical",esriSFSForwardDiagonal:"forward-diagonal",esriSFSBackwardDiagonal:"backward-diagonal",esriSFSCross:"cross",esriSFSDiagonalCross:"diagonal-cross"});let Vi=jE=class extends Xp{constructor(...t){super(...t),this.color=new Q([0,0,0,.25]),this.outline=new jt,this.type="simple-fill",this.style="solid"}normalizeCtorArgs(t,e,r){if(t&&typeof t!="string")return t;const i={};return t&&(i.style=t),e&&(i.outline=e),r&&(i.color=r),i}clone(){return new jE({color:k(this.color),outline:this.outline&&this.outline.clone(),style:this.style})}hash(){return`${super.hash()}${this.style}.${this.color&&this.color.hash()}`}};c([d()],Vi.prototype,"color",void 0),c([d()],Vi.prototype,"outline",void 0),c([ye({esriSFS:"simple-fill"},{readOnly:!0})],Vi.prototype,"type",void 0),c([d({type:Jx.apiValues,json:{read:Jx.read,write:Jx.write}})],Vi.prototype,"style",void 0),Vi=jE=c([C("esri.symbols.SimpleFillSymbol")],Vi);var UE;const Yx=new De({esriSMSCircle:"circle",esriSMSSquare:"square",esriSMSCross:"cross",esriSMSX:"x",esriSMSDiamond:"diamond",esriSMSTriangle:"triangle",esriSMSPath:"path"});let Pt=UE=class extends hl{constructor(...t){super(...t),this.color=new Q([255,255,255,.25]),this.type="simple-marker",this.size=12,this.style="circle",this.outline=new jt}normalizeCtorArgs(t,e,r,i){if(t&&typeof t!="string")return t;const s={};return t&&(s.style=t),e!=null&&(s.size=Be(e)),r&&(s.outline=r),i&&(s.color=i),s}writeColor(t,e){t&&this.style!=="x"&&this.style!=="cross"&&(e.color=t.toJSON()),t===null&&(e.color=null)}set path(t){this.style="path",this._set("path",t)}clone(){return new UE({angle:this.angle,color:k(this.color),outline:this.outline&&this.outline.clone(),path:this.path,size:this.size,style:this.style,xoffset:this.xoffset,yoffset:this.yoffset})}hash(){return`${super.hash()}.${this.color&&this.color.hash()}.${this.path}.${this.style}.${this.outline?.hash()}`}};c([d()],Pt.prototype,"color",void 0),c([re("color")],Pt.prototype,"writeColor",null),c([ye({esriSMS:"simple-marker"},{readOnly:!0})],Pt.prototype,"type",void 0),c([d()],Pt.prototype,"size",void 0),c([d({type:Yx.apiValues,json:{read:Yx.read,write:Yx.write}})],Pt.prototype,"style",void 0),c([d({type:String,json:{write:!0}})],Pt.prototype,"path",null),c([d({types:{key:"type",base:null,defaultKeyValue:"simple-line",typeMap:{"simple-line":jt}},json:{default:null,write:!0}})],Pt.prototype,"outline",void 0),Pt=UE=c([C("esri.symbols.SimpleMarkerSymbol")],Pt);var GE;let lt=GE=class extends sr{constructor(...t){super(...t),this.backgroundColor=null,this.borderLineColor=null,this.borderLineSize=null,this.font=new Is,this.horizontalAlignment="center",this.kerning=!0,this.haloColor=null,this.haloSize=null,this.rightToLeft=null,this.rotated=!1,this.text="",this.type="text",this.verticalAlignment="baseline",this.xoffset=0,this.yoffset=0,this.angle=0,this.width=null,this.lineWidth=192,this.lineHeight=1}normalizeCtorArgs(t,e,r){if(t&&typeof t!="string")return t;const i={};return t&&(i.text=t),e&&(i.font=e),r&&(i.color=r),i}writeLineWidth(t,e,r,i){i&&typeof i!="string"?i.origin:e[r]=t}castLineWidth(t){return Be(t)}writeLineHeight(t,e,r,i){i&&typeof i!="string"?i.origin:e[r]=t}clone(){return new GE({angle:this.angle,backgroundColor:k(this.backgroundColor),borderLineColor:k(this.borderLineColor),borderLineSize:this.borderLineSize,color:k(this.color),font:this.font&&this.font.clone(),haloColor:k(this.haloColor),haloSize:this.haloSize,horizontalAlignment:this.horizontalAlignment,kerning:this.kerning,lineHeight:this.lineHeight,lineWidth:this.lineWidth,rightToLeft:this.rightToLeft,rotated:this.rotated,text:this.text,verticalAlignment:this.verticalAlignment,width:this.width,xoffset:this.xoffset,yoffset:this.yoffset})}hash(){return`${this.backgroundColor?.hash()}.${this.borderLineColor}.${this.borderLineSize}.${this.color?.hash()}.${this.font&&this.font.hash()}.${this.haloColor?.hash()}.${this.haloSize}.${this.horizontalAlignment}.${this.kerning}.${this.rightToLeft}.${this.rotated}.${this.text}.${this.verticalAlignment}.${this.width}.${this.xoffset}.${this.yoffset}.${this.lineHeight}.${this.lineWidth}.${this.angle}`}};c([d({type:Q,json:{write:!0}})],lt.prototype,"backgroundColor",void 0),c([d({type:Q,json:{write:!0}})],lt.prototype,"borderLineColor",void 0),c([d({type:Number,json:{write:!0},cast:Be})],lt.prototype,"borderLineSize",void 0),c([d({type:Is,json:{write:!0}})],lt.prototype,"font",void 0),c([d({...xG,json:{write:!0}})],lt.prototype,"horizontalAlignment",void 0),c([d({type:Boolean,json:{write:!0}})],lt.prototype,"kerning",void 0),c([d({type:Q,json:{write:!0}})],lt.prototype,"haloColor",void 0),c([d({type:Number,cast:Be,json:{write:!0}})],lt.prototype,"haloSize",void 0),c([d({type:Boolean,json:{write:!0}})],lt.prototype,"rightToLeft",void 0),c([d({type:Boolean,json:{write:!0}})],lt.prototype,"rotated",void 0),c([d({type:String,json:{write:!0}})],lt.prototype,"text",void 0),c([ye({esriTS:"text"},{readOnly:!0})],lt.prototype,"type",void 0),c([d({...$G,json:{write:!0}})],lt.prototype,"verticalAlignment",void 0),c([d({type:Number,cast:Be,json:{write:!0}})],lt.prototype,"xoffset",void 0),c([d({type:Number,cast:Be,json:{write:!0}})],lt.prototype,"yoffset",void 0),c([d({type:Number,json:{read:t=>t&&-1*t,write:(t,e)=>e.angle=t&&-1*t}})],lt.prototype,"angle",void 0),c([d({type:Number,json:{write:!0}})],lt.prototype,"width",void 0),c([d({type:Number})],lt.prototype,"lineWidth",void 0),c([re("lineWidth")],lt.prototype,"writeLineWidth",null),c([We("lineWidth")],lt.prototype,"castLineWidth",null),c([d(SG)],lt.prototype,"lineHeight",void 0),c([re("lineHeight")],lt.prototype,"writeLineHeight",null),lt=GE=c([C("esri.symbols.TextSymbol")],lt);var BE;let Ur=BE=class extends sr{constructor(t){super(t),this.color=null,this.styleName=null,this.portal=null,this.styleUrl=null,this.thumbnail=null,this.name=null,this.type="web-style"}get _fetchCacheKey(){const t=this.portal!=null?this.portal:Y.getDefault(),e=t.user?t.user.username:null;return`${this.styleName}:${this.styleUrl}:${this.name}:${e}:${t.url}`}read(t,e){this.portal=e?.portal,super.read(t,e)}clone(){return new BE({name:this.name,styleUrl:this.styleUrl,styleName:this.styleName,portal:this.portal})}fetchSymbol(t){return this._fetchSymbol(t)}async fetchCIMSymbol(t){Yz(q.getLogger(this),"WebStyleSymbol.fetchCIMSymbol is deprecated in favour of WebStyleSymbol.fetchSymbol which now supports both web and cim symbology",{version:"4.33",replacement:"WebStyleSymbol.fetchSymbol",see:"https://arcg.is/0CXPTr#fetchSymbol",warnOnce:!0});const e=await this._fetchSymbol({...t,acceptedFormats:["cim"]});if(e?.type!=="cim")throw new F("webstylesymbol:fetchCIMSymbol","Resolved web style symbol is not of type 'cim'");return e}async _fetchSymbol(t){const e=t!=null?t.cache:null,r=e?this._fetchCacheKey:null;if(e!=null){const o=r&&e.get(r);if(o)return o.clone()}const{resolveWebStyleSymbol:i}=await J(()=>Promise.resolve().then(()=>Yxe),void 0);xt(t);const s=i(this,{portal:this.portal},t);s.catch((o=>{q.getLogger(this).error("#fetchSymbol()","Failed to create symbol from style",o)}));const n=await s;return e?.set(r,n.clone()),n}};c([d({json:{write:!1}})],Ur.prototype,"color",void 0),c([d({type:String,json:{write:!0}})],Ur.prototype,"styleName",void 0),c([d({type:Y,json:{write:!1}})],Ur.prototype,"portal",void 0),c([d({type:String,json:{read:GS,write:hd}})],Ur.prototype,"styleUrl",void 0),c([d({type:Kh,json:{read:!1}})],Ur.prototype,"thumbnail",void 0),c([d({type:String,json:{write:!0}})],Ur.prototype,"name",void 0),c([ye({styleSymbolReference:"web-style"},{readOnly:!0})],Ur.prototype,"type",void 0),c([d()],Ur.prototype,"_fetchCacheKey",null),Ur=BE=c([C("esri.symbols.WebStyleSymbol")],Ur);function M2(t){if(!t)return!1;switch(t.type){case"picture-fill":case"picture-marker":case"simple-fill":case"simple-line":case"simple-marker":case"text":case"cim":return!0;default:return!1}}function Pa(t){switch(t?.type){case"label-3d":case"line-3d":case"mesh-3d":case"point-3d":case"polygon-3d":return!0;default:return!1}}const Wu={base:sr,key:"type",typeMap:{"simple-fill":Vi,"picture-fill":es,"picture-marker":Li,"simple-line":jt,"simple-marker":Pt,text:lt,"label-3d":qn,"line-3d":ro,"mesh-3d":El,"point-3d":zi,"polygon-3d":dn,"web-style":Ur,cim:gi},errorContext:"symbol"},n5e={base:sr,key:"type",typeMap:{"picture-marker":Li,"simple-marker":Pt,"point-3d":zi,cim:gi},errorContext:"symbol"},o5e={base:sr,key:"type",typeMap:{"simple-line":jt,"line-3d":ro,cim:gi},errorContext:"symbol"},a5e={base:sr,key:"type",typeMap:{"simple-fill":Vi,"picture-fill":es,"polygon-3d":dn,cim:gi},errorContext:"symbol"},Yhe={base:sr,key:"type",typeMap:{"picture-marker":Li,"simple-marker":Pt,text:lt,"web-style":Ur,cim:gi},errorContext:"symbol"},Xhe=Om({types:Wu}),NG={base:sr,key:"type",typeMap:{"simple-fill":Vi,"picture-fill":es,"picture-marker":Li,"simple-line":jt,"simple-marker":Pt,text:lt,"line-3d":ro,"mesh-3d":El,"point-3d":zi,"polygon-3d":dn,"web-style":Ur,cim:gi},errorContext:"symbol"},Khe={base:sr,key:"type",typeMap:{text:lt,"label-3d":qn},errorContext:"symbol"},YO={base:sr,key:"type",typeMap:{"line-3d":ro,"mesh-3d":El,"point-3d":zi,"polygon-3d":dn,"web-style":Ur,cim:gi},errorContext:"symbol"},Qhe={base:sr,key:"type",typeMap:{"label-3d":qn},errorContext:"symbol"},FG=xa(Wu);var qE;function ede(t){if(!t)return null;const e={};for(const r in t){const i=hc(t[r]);i&&(e[r]=i)}return Object.keys(e).length!==0?e:null}function tde(t){if(t==null)return null;const e={};for(const r in t){const i=t[r];i&&(e[r]=i.toJSON())}return Object.keys(e).length!==0?e:null}var Vf;let dr=(Vf=class extends Ce.ClonableMixin(W){constructor(e){super(e),this.isAggregate=!1,this.layer=null,this.origin=null,this.sourceLayer=null,this._version=0,Object.defineProperty(this,"uid",{value:b1(),configurable:!0}),Object.defineProperty(this,"_lastMeshTransform",{value:{},configurable:!0,writable:!0,enumerable:!1}),arguments.length>1&&uK(q.getLogger(this),"Graphic",{version:"4.30"})}initialize(){this._watchMeshGeometryChanges()}set aggregateGeometries(e){const r=this._get("aggregateGeometries");JSON.stringify(r)!==JSON.stringify(e)&&this._set("aggregateGeometries",e)}set attributes(e){const r=this._get("attributes");r!==e&&(this._set("attributes",e),this._notifyLayer("attributes",r,e))}set geometry(e){const r=this._get("geometry");r!==e&&(this._set("geometry",e),e?.type!=="mesh"&&this._notifyLayer("geometry",r,e))}set popupTemplate(e){const r=this._get("popupTemplate");r!==e&&(this._set("popupTemplate",e),this._notifyLayer("popupTemplate",r,e))}set symbol(e){const r=this._get("symbol");r!==e&&(this._set("symbol",e),this._notifyLayer("symbol",r,e))}get version(){return this._version}set visible(e){const r=this._get("visible");r!==e&&(this._set("visible",e),this._notifyLayer("visible",r,e))}cloneShallow(){return new qE({aggregateGeometries:this.aggregateGeometries,attributes:this.attributes,geometry:this.geometry,isAggregate:this.isAggregate,layer:this.layer,popupTemplate:this.popupTemplate,sourceLayer:this.sourceLayer,symbol:this.symbol,visible:this.visible,origin:this.origin})}getEffectivePopupTemplate(e=!1){if(this.popupTemplate)return this.popupTemplate;const r=this.origin&&"layer"in this.origin?this.origin.layer:null;for(const i of[r,this.sourceLayer,this.layer])if(i){if("popupTemplate"in i&&i.popupTemplate)return i.popupTemplate;if(e&&"defaultPopupTemplate"in i&&i.defaultPopupTemplate!=null)return i.defaultPopupTemplate}return null}getAttribute(e){return this.attributes?.[e]}setAttribute(e,r){if(this.attributes){const i=this.getAttribute(e);this.attributes[e]=r,this._notifyLayer("attributes",i,r,e)}else this.attributes={[e]:r}}getObjectId(){const e=this.sourceLayer??this.layer;return e?uhe(this,e):null}getGlobalId(){const e=this.sourceLayer??this.layer;return e&&"globalIdField"in e&&e.globalIdField?this.getAttribute(e.globalIdField):null}toJSON(){return{aggregateGeometries:tde(this.aggregateGeometries),geometry:this.geometry!=null?this.geometry.toJSON():null,symbol:this.symbol!=null?this.symbol.toJSON():null,attributes:T0(this.attributes)?this.attributes.toJSON():{...this.attributes},popupTemplate:this.popupTemplate?.toJSON()??null}}notifyMeshTransformChanged(e={}){const{geometry:r}=this;if(r?.type==="mesh"){const i={origin:r.origin,transform:r.transform};this._notifyLayer("origin-transform",i,i,e.action)}}_notifyLayer(e,r,i,s){if(this._version++,!this.layer||!("graphicChanged"in this.layer))return;const n={graphic:this,property:e,oldValue:r,newValue:i};e==="origin-transform"&&(n.action=s),e==="attributes"&&(n.attributeName=s),this.layer.graphicChanged(n)}_watchMeshGeometryChanges(){this.addHandles([fs((()=>this.geometry?.type==="mesh"&&this.geometry.vertexSpace.origin?{localMatrix:this.geometry.transform?.localMatrix,origin:this.geometry.vertexSpace.origin}:void 0),(({localMatrix:e,origin:r})=>{this._lastMeshTransform.localMatrix===e&&this._lastMeshTransform.origin===r||(this._lastMeshTransform.localMatrix=e,this._lastMeshTransform.origin=r,this.notifyMeshTransformChanged())})),fs((()=>this.geometry?.type==="mesh"?{vertexAttributes:this.geometry.vertexAttributes}:void 0),(()=>{const e=this.geometry;e?.type==="mesh"&&e.vertexSpace.origin?(this._lastMeshTransform.localMatrix=e.transform?.localMatrix,this._lastMeshTransform.origin=e.vertexSpace.origin):(this._lastMeshTransform.localMatrix=void 0,this._lastMeshTransform.origin=void 0),this._notifyLayer("geometry",this.geometry,this.geometry)}),{equals:(e,r)=>e===r,sync:!0})])}},qE=Vf,Vf);c([d({value:null,json:{read:ede}})],dr.prototype,"aggregateGeometries",null),c([d({value:null})],dr.prototype,"attributes",null),c([d({value:null,types:Av,json:{read:hc}})],dr.prototype,"geometry",null),c([d({type:Boolean})],dr.prototype,"isAggregate",void 0),c([d({clonable:!1})],dr.prototype,"layer",void 0),c([d({clonable:"reference"})],dr.prototype,"origin",void 0),c([d({type:Gm,value:null})],dr.prototype,"popupTemplate",null),c([d({clonable:"reference"})],dr.prototype,"sourceLayer",void 0),c([d({value:null,types:Wu})],dr.prototype,"symbol",null),c([d({clonable:!1,json:{read:!1,write:!1}})],dr.prototype,"_version",void 0),c([d({type:Boolean,value:!0})],dr.prototype,"visible",null),dr=qE=c([C("esri.Graphic")],dr);let h0=class extends s0{_own(e){e.layer&&"remove"in e.layer&&e.layer!==this.owner&&e.layer.remove(e),e.layer=this.owner}_release(e){e.layer===this.owner&&(e.layer=null)}};c([p3({Type:dr,ensureType:br(dr)})],h0.prototype,"itemType",void 0),h0=c([C("esri.support.GraphicsCollection")],h0);let gu=class extends ce{constructor(e){super(e),this.view=null,this.baseLayerViews=new se,this.referenceLayerViews=new se,this._loadingHandle=ie((()=>this.view?.map?.basemap),(r=>{r&&r.load().catch((()=>{}))}),Ft)}destroy(){this._set("view",null),this._loadingHandle&&(this._loadingHandle.remove(),this._loadingHandle=null);for(const e of this.baseLayerViews)e.destroy();this.baseLayerViews.length=0;for(const e of this.referenceLayerViews)e.destroy();this.referenceLayerViews.length=0}get suspended(){return this.view?.suspended??!0}get updating(){return this.view?.suspended?!1:!!this.view?.map?.basemap?.loaded&&(this.baseLayerViews.some((r=>r.updating))||this.referenceLayerViews.some((r=>r.updating)))}};c([d({constructOnly:!0})],gu.prototype,"view",void 0),c([d({readOnly:!0})],gu.prototype,"baseLayerViews",void 0),c([d({readOnly:!0})],gu.prototype,"referenceLayerViews",void 0),c([d({readOnly:!0})],gu.prototype,"suspended",null),c([d({type:Boolean,readOnly:!0})],gu.prototype,"updating",null),gu=c([C("esri.views.BasemapView")],gu);const rde=gu;let vs=class extends ce{constructor(e){super(e),this.factor=1.5,this.offset=or(0,0),this.position=null,this.size=120,this.maskUrl=null,this.maskEnabled=!0,this.overlayUrl=null,this.overlayEnabled=!0,this.visible=!0}get version(){return this.commitProperty("factor"),this.commitProperty("offset"),this.commitProperty("position"),this.commitProperty("visible"),this.commitProperty("size"),this.commitProperty("maskUrl"),this.commitProperty("maskEnabled"),this.commitProperty("overlayUrl"),this.commitProperty("overlayEnabled"),(this._get("version")||0)+1}};c([d({type:Number})],vs.prototype,"factor",void 0),c([d({nonNullable:!0})],vs.prototype,"offset",void 0),c([d()],vs.prototype,"position",void 0),c([d({type:Number,range:{min:0}})],vs.prototype,"size",void 0),c([d()],vs.prototype,"maskUrl",void 0),c([d()],vs.prototype,"maskEnabled",void 0),c([d()],vs.prototype,"overlayUrl",void 0),c([d()],vs.prototype,"overlayEnabled",void 0),c([d({readOnly:!0})],vs.prototype,"version",null),c([d({type:Boolean})],vs.prototype,"visible",void 0),vs=c([C("esri.views.Magnifier")],vs);const DG=vs;let nb=class{constructor(e){this._observable=new Sv,this._map=new Map(e)}get size(){return we(this._observable),this._map.size}clear(){this._map.size>0&&(this._map.clear(),this._observable.notify())}delete(e){const r=this._map.delete(e);return r&&this._observable.notify(),r}entries(){return we(this._observable),this._map.entries()}forEach(e,r){we(this._observable),this._map.forEach(((i,s)=>e.call(r,i,s,this)),r)}get(e){return we(this._observable),this._map.get(e)}has(e){return we(this._observable),this._map.has(e)}keys(){return we(this._observable),this._map.keys()}set(e,r){return this._map.set(e,r),this._observable.notify(),this}values(){return we(this._observable),this._map.values()}[Symbol.iterator](){return we(this._observable),this._map[Symbol.iterator]()}[Symbol.dispose](){this._observable.destroy()}get[Symbol.toStringTag](){return this._map[Symbol.toStringTag]}};var HE;let Vh=HE=class extends W{constructor(t){super(t),this.name=null,this.code=null}clone(){return new HE({name:this.name,code:this.code})}};c([d({type:String,json:{write:{isRequired:!0}}})],Vh.prototype,"name",void 0),c([d({type:[String,Number],json:{write:{isRequired:!0}}})],Vh.prototype,"code",void 0),Vh=HE=c([C("esri.layers.support.CodedValue")],Vh);const ide=new De({inherited:"inherited",codedValue:"coded-value",range:"range"});let Zu=class extends W{constructor(e){super(e),this.name=null,this.type=null}};c([d({type:String,json:{write:!0}})],Zu.prototype,"name",void 0),c([ye(ide),d({json:{write:{isRequired:!0}}})],Zu.prototype,"type",void 0),Zu=c([C("esri.layers.support.Domain")],Zu);var WE,jf;let Ju=(jf=class extends Zu{constructor(e){super(e),this.codedValues=null,this.type="coded-value"}getName(e){let r=null;if(this.codedValues){const i=String(e);this.codedValues.some((s=>(String(s.code)===i&&(r=s.name),!!r)))}return r}clone(){return new WE({codedValues:k(this.codedValues),name:this.name})}},WE=jf,jf);c([d({type:[Vh],json:{write:{isRequired:!0}}})],Ju.prototype,"codedValues",void 0),c([ye({codedValue:"coded-value"})],Ju.prototype,"type",void 0),Ju=WE=c([C("esri.layers.support.CodedValueDomain")],Ju);var ZE,Uf;let d0=(Uf=class extends Zu{constructor(e){super(e),this.type="inherited"}clone(){return new ZE}},ZE=Uf,Uf);c([ye({inherited:"inherited"})],d0.prototype,"type",void 0),d0=ZE=c([C("esri.layers.support.InheritedDomain")],d0);var JE,Gf;let Th=(Gf=class extends Zu{constructor(e){super(e),this.maxValue=null,this.minValue=null,this.type="range"}clone(){return new JE({maxValue:this.maxValue,minValue:this.minValue,name:this.name})}},JE=Gf,Gf);c([d({json:{type:[Number],read:{source:"range",reader:(t,e)=>e.range?.[1]},write:{enabled:!1,overridePolicy(){return{enabled:this.maxValue!=null&&this.minValue==null}},target:"range",writer(t,e,r){e[r]=[this.minValue||0,t]},isRequired:!0}}})],Th.prototype,"maxValue",void 0),c([d({json:{type:[Number],read:{source:"range",reader:(t,e)=>e.range?.[0]},write:{target:"range",writer(t,e,r){e[r]=[t,this.maxValue||0]},isRequired:!0}}})],Th.prototype,"minValue",void 0),c([ye({range:"range"})],Th.prototype,"type",void 0),Th=JE=c([C("esri.layers.support.RangeDomain")],Th);const zG={key:"type",base:Zu,typeMap:{range:Th,"coded-value":Ju,inherited:d0}};function T2(t){if(!t?.type)return null;switch(t.type){case"range":return Th.fromJSON(t);case"codedValue":return Ju.fromJSON(t);case"inherited":return d0.fromJSON(t)}return null}const sde=new De({esriFieldTypeSmallInteger:"small-integer",esriFieldTypeInteger:"integer",esriFieldTypeSingle:"single",esriFieldTypeDouble:"double",esriFieldTypeLong:"long",esriFieldTypeString:"string",esriFieldTypeDate:"date",esriFieldTypeOID:"oid",esriFieldTypeGeometry:"geometry",esriFieldTypeBlob:"blob",esriFieldTypeRaster:"raster",esriFieldTypeGUID:"guid",esriFieldTypeGlobalID:"global-id",esriFieldTypeXML:"xml",esriFieldTypeBigInteger:"big-integer",esriFieldTypeDateOnly:"date-only",esriFieldTypeTimeOnly:"time-only",esriFieldTypeTimestampOffset:"timestamp-offset"});var YE;const nde=new De({binary:"binary",coordinate:"coordinate",countOrAmount:"count-or-amount",dateAndTime:"date-and-time",description:"description",locationOrPlaceName:"location-or-place-name",measurement:"measurement",nameOrTitle:"name-or-title",none:"none",orderedOrRanked:"ordered-or-ranked",percentageOrRatio:"percentage-or-ratio",typeOrCategory:"type-or-category",uniqueIdentifier:"unique-identifier"});var Bf;let Vr=(Bf=class extends W{constructor(e){super(e),this.alias=null,this.defaultValue=void 0,this.description=null,this.domain=null,this.editable=!0,this.length=void 0,this.name=null,this.nullable=!0,this.type=null,this.valueType=null,this.visible=!0}readDescription(e,{description:r}){let i=null;try{i=r?JSON.parse(r):null}catch{}return i?.value??null}readValueType(e,{description:r}){let i=null;try{i=r?JSON.parse(r):null}catch{}return i?nde.fromJSON(i.fieldValueType):null}clone(){return new YE({alias:this.alias,defaultValue:this.defaultValue,description:this.description,domain:this.domain?.clone()??null,editable:this.editable,length:this.length,name:this.name,nullable:this.nullable,type:this.type,valueType:this.valueType,visible:this.visible})}},YE=Bf,Bf);c([d({type:String,json:{write:!0}})],Vr.prototype,"alias",void 0),c([d({type:[String,Number],json:{write:{allowNull:!0}}})],Vr.prototype,"defaultValue",void 0),c([d()],Vr.prototype,"description",void 0),c([K("description")],Vr.prototype,"readDescription",null),c([d({types:zG,json:{read:{reader:T2},write:!0}})],Vr.prototype,"domain",void 0),c([d({type:Boolean,json:{write:!0}})],Vr.prototype,"editable",void 0),c([d({type:qe,json:{write:{overridePolicy:t=>({enabled:Number.isFinite(t)})}}})],Vr.prototype,"length",void 0),c([d({type:String,json:{write:!0}})],Vr.prototype,"name",void 0),c([d({type:Boolean,json:{write:!0}})],Vr.prototype,"nullable",void 0),c([ye(sde)],Vr.prototype,"type",void 0),c([d()],Vr.prototype,"valueType",void 0),c([K("valueType",["description"])],Vr.prototype,"readValueType",null),c([d({type:Boolean,json:{read:!1}})],Vr.prototype,"visible",void 0),Vr=YE=c([C("esri.layers.support.Field")],Vr);var XE;let pp=XE=class extends W{constructor(t){super(t),this.type="map-layer"}clone(){const{mapLayerId:t,gdbVersion:e}=this;return new XE({mapLayerId:t,gdbVersion:e})}};c([ye({mapLayer:"map-layer"}),d({json:{write:{isRequired:!0}}})],pp.prototype,"type",void 0),c([d({type:qe,json:{write:{isRequired:!0}}})],pp.prototype,"mapLayerId",void 0),c([d({type:String,json:{write:!0}})],pp.prototype,"gdbVersion",void 0),pp=XE=c([C("esri.layers.support.source.MapLayerSource")],pp);var KE;let Xa=KE=class extends W{constructor(t){super(t),this.type="query-table"}clone(){const{workspaceId:t,query:e,oidFields:r,spatialReference:i,geometryType:s}=this,n={workspaceId:t,query:e,oidFields:r,spatialReference:i?.clone()??void 0,geometryType:s};return new KE(n)}};c([ye({queryTable:"query-table"}),d({json:{write:{isRequired:!0}}})],Xa.prototype,"type",void 0),c([d({type:String,json:{write:!0}})],Xa.prototype,"workspaceId",void 0),c([d({type:String,json:{write:!0}})],Xa.prototype,"query",void 0),c([d({type:String,json:{write:!0}})],Xa.prototype,"oidFields",void 0),c([d({type:ne,json:{write:!0}})],Xa.prototype,"spatialReference",void 0),c([ye(qae)],Xa.prototype,"geometryType",void 0),Xa=KE=c([C("esri.layers.support.source.QueryTableDataSource")],Xa);var QE;let fp=QE=class extends W{constructor(t){super(t),this.type="raster"}clone(){const{workspaceId:t,dataSourceName:e}=this;return new QE({workspaceId:t,dataSourceName:e})}};c([ye({raster:"raster"}),d({json:{write:{isRequired:!0}}})],fp.prototype,"type",void 0),c([d({type:String,json:{write:!0}})],fp.prototype,"dataSourceName",void 0),c([d({type:String,json:{write:!0}})],fp.prototype,"workspaceId",void 0),fp=QE=c([C("esri.layers.support.source.RasterDataSource")],fp);var eI;let Kc=eI=class extends W{constructor(t){super(t),this.type="table"}clone(){const{workspaceId:t,gdbVersion:e,dataSourceName:r}=this;return new eI({workspaceId:t,gdbVersion:e,dataSourceName:r})}};c([ye({table:"table"}),d({json:{write:{isRequired:!0}}})],Kc.prototype,"type",void 0),c([d({type:String,json:{write:!0}})],Kc.prototype,"workspaceId",void 0),c([d({type:String,json:{write:!0}})],Kc.prototype,"gdbVersion",void 0),c([d({type:String,json:{write:!0}})],Kc.prototype,"dataSourceName",void 0),Kc=eI=c([C("esri.layers.support.source.TableDataSource")],Kc);var tI,rI;const ode=Wr()({esriLeftInnerJoin:"left-inner-join",esriLeftOuterJoin:"left-outer-join"});let _s=tI=class extends W{constructor(t){super(t),this.type="join-table"}readLeftTableSource(t,e,r){return XO()(t,e,r)}castLeftTableSource(t){return xa(iI(),t)}readRightTableSource(t,e,r){return XO()(t,e,r)}castRightTableSource(t){return xa(iI(),t)}clone(){const{leftTableKey:t,rightTableKey:e,leftTableSource:r,rightTableSource:i,joinType:s}=this,n={leftTableKey:t,rightTableKey:e,leftTableSource:r?.clone()??void 0,rightTableSource:i?.clone()??void 0,joinType:s};return new tI(n)}};c([ye({joinTable:"join-table"}),d({json:{write:{isRequired:!0}}})],_s.prototype,"type",void 0),c([d({type:String,json:{write:!0}})],_s.prototype,"leftTableKey",void 0),c([d({type:String,json:{write:!0}})],_s.prototype,"rightTableKey",void 0),c([d({json:{write:!0}})],_s.prototype,"leftTableSource",void 0),c([K("leftTableSource")],_s.prototype,"readLeftTableSource",null),c([We("leftTableSource")],_s.prototype,"castLeftTableSource",null),c([d({json:{write:!0}})],_s.prototype,"rightTableSource",void 0),c([K("rightTableSource")],_s.prototype,"readRightTableSource",null),c([We("rightTableSource")],_s.prototype,"castRightTableSource",null),c([ye(ode)],_s.prototype,"joinType",void 0),_s=tI=c([C("esri.layers.support.source.JoinTableDataSource")],_s);let Xx=null;function XO(){return Xx||(Xx=Om({types:iI()})),Xx}let Kx=null;function iI(){return Kx||(Kx={key:"type",base:null,typeMap:{"data-layer":Hn,"map-layer":pp}}),Kx}const ade={key:"type",base:null,typeMap:{"join-table":_s,"query-table":Xa,raster:fp,table:Kc}};var qf;let Hn=(qf=class extends W{constructor(e){super(e),this.type="data-layer"}clone(){const{fields:e,dataSource:r}=this;return new rI({fields:e,dataSource:r})}},rI=qf,qf);c([ye({dataLayer:"data-layer"}),d({json:{write:{isRequired:!0}}})],Hn.prototype,"type",void 0),c([d({type:[Vr],json:{write:!0}})],Hn.prototype,"fields",void 0),c([d({types:ade,json:{write:!0}})],Hn.prototype,"dataSource",void 0),Hn=rI=c([C("esri.layers.support.source.DataLayerSource")],Hn),Hn.from=br(Hn);let Qc=class extends Ce.ClonableMixin(W){constructor(e){super(e),this.onFields=null,this.operator=null,this.searchTerm=null,this.searchType=null}};c([d({type:[String],json:{write:{enabled:!0,overridePolicy(){return{enabled:this.onFields!=null&&this.onFields.length>0}}}}})],Qc.prototype,"onFields",void 0),c([d({type:String,json:{write:!0}})],Qc.prototype,"operator",void 0),c([d({type:String,json:{write:!0}})],Qc.prototype,"searchTerm",void 0),c([d({type:String,json:{write:!0}})],Qc.prototype,"searchType",void 0),Qc=c([C("esri.rest.support.FullTextSearch")],Qc);const lde=Qc;var sI;const KO=new De({upperLeft:"upper-left",lowerLeft:"lower-left"});let Au=sI=class extends W{constructor(t){super(t),this.extent=null,this.mode="view",this.originPosition="upper-left",this.tolerance=1}clone(){return new sI(k({extent:this.extent,mode:this.mode,originPosition:this.originPosition,tolerance:this.tolerance}))}};c([d({type:Le,json:{write:{overridePolicy(){return{enabled:this.mode==="view"}}}}})],Au.prototype,"extent",void 0),c([d({type:["view","edit"],json:{write:!0}})],Au.prototype,"mode",void 0),c([d({type:String,json:{read:KO.read,write:KO.write}})],Au.prototype,"originPosition",void 0),c([d({type:Number,json:{write:{overridePolicy(){return{enabled:this.mode==="view"}}}}})],Au.prototype,"tolerance",void 0),Au=sI=c([C("esri.rest.support.QuantizationParameters")],Au);const ude=new De({esriSpatialRelIntersects:"intersects",esriSpatialRelContains:"contains",esriSpatialRelCrosses:"crosses",esriSpatialRelDisjoint:"disjoint",esriSpatialRelEnvelopeIntersects:"envelope-intersects",esriSpatialRelIndexIntersects:"index-intersects",esriSpatialRelOverlaps:"overlaps",esriSpatialRelTouches:"touches",esriSpatialRelWithin:"within",esriSpatialRelRelation:"relation"});var nI;const QO=new De({count:"count",sum:"sum",min:"min",max:"max",avg:"avg",stddev:"stddev",var:"var",exceedslimit:"exceedslimit",percentile_cont:"percentile-continuous",percentile_disc:"percentile-discrete",EnvelopeAggregate:"envelope-aggregate",CentroidAggregate:"centroid-aggregate",ConvexHullAggregate:"convex-hull-aggregate"});let On=nI=class extends W{constructor(t){super(t),this.maxPointCount=void 0,this.maxRecordCount=void 0,this.maxVertexCount=void 0,this.onStatisticField=null,this.outStatisticFieldName=null,this.statisticType=null,this.statisticParameters=null}writeStatisticParameters(t,e){this.statisticType!=="percentile-continuous"&&this.statisticType!=="percentile-discrete"||(e.statisticParameters=k(t))}clone(){return new nI({maxPointCount:this.maxPointCount,maxRecordCount:this.maxRecordCount,maxVertexCount:this.maxVertexCount,onStatisticField:this.onStatisticField,outStatisticFieldName:this.outStatisticFieldName,statisticType:this.statisticType,statisticParameters:k(this.statisticParameters)})}};c([d({type:Number,json:{write:!0}})],On.prototype,"maxPointCount",void 0),c([d({type:Number,json:{write:!0}})],On.prototype,"maxRecordCount",void 0),c([d({type:Number,json:{write:!0}})],On.prototype,"maxVertexCount",void 0),c([d({type:String,json:{write:!0}})],On.prototype,"onStatisticField",void 0),c([d({type:String,json:{write:!0}})],On.prototype,"outStatisticFieldName",void 0),c([d({type:String,json:{read:{source:"statisticType",reader:QO.read},write:{target:"statisticType",writer:QO.write}}})],On.prototype,"statisticType",void 0),c([d({type:Object})],On.prototype,"statisticParameters",void 0),c([re("statisticParameters")],On.prototype,"writeStatisticParameters",null),On=nI=c([C("esri.rest.support.StatisticDefinition")],On);var ob;const cde=new De({esriSRUnit_Meter:"meters",esriSRUnit_Kilometer:"kilometers",esriSRUnit_Foot:"feet",esriSRUnit_StatuteMile:"miles",esriSRUnit_NauticalMile:"nautical-miles",esriSRUnit_USNauticalMile:"us-nautical-miles"});var sd;let me=(sd=class extends W{static from(e){return km(ob,e)}constructor(e){super(e),this.aggregateIds=null,this.cacheHint=void 0,this.compactGeometryEnabled=!1,this.datumTransformation=null,this.defaultSpatialReferenceEnabled=!1,this.distance=void 0,this.dynamicDataSource=void 0,this.formatOf3DObjects=null,this.fullText=null,this.gdbVersion=null,this.geometry=null,this.geometryPrecision=void 0,this.groupByFieldsForStatistics=null,this.having=null,this.historicMoment=null,this.maxAllowableOffset=void 0,this.maxRecordCountFactor=1,this.multipatchOption=null,this.num=void 0,this.objectIds=null,this.orderByFields=null,this.outFields=null,this.outSpatialReference=null,this.outStatistics=null,this.parameterValues=null,this.pixelSize=null,this.quantizationParameters=null,this.rangeValues=null,this.relationParameter=null,this.resultType=null,this.returnCentroid=!1,this.returnDistinctValues=!1,this.returnExceededLimitFeatures=!0,this.returnGeometry=!1,this.returnQueryGeometry=!1,this.returnM=void 0,this.returnZ=void 0,this.returnTrueCurves=void 0,this.sourceSpatialReference=null,this.spatialRelationship="intersects",this.start=void 0,this.sqlFormat=null,this.text=null,this.timeExtent=null,this.timeReferenceUnknownClient=!1,this.units=null,this.where=null}castDatumTransformation(e){return typeof e=="number"||typeof e=="object"?e:null}writeHistoricMoment(e,r){r.historicMoment=e&&e.getTime()}writeParameterValues(e,r){if(e){const i={};for(const s in e){const n=e[s];Array.isArray(n)?i[s]=n.map((o=>o instanceof Date?o.getTime():o)):n instanceof Date?i[s]=n.getTime():i[s]=n}r.parameterValues=i}}writeStart(e,r){r.resultOffset=this.start,r.resultRecordCount=this.num||10,r.where="1=1"}writeWhere(e,r){r.where=e||"1=1"}clone(){return new ob(k({aggregateIds:this.aggregateIds,cacheHint:this.cacheHint,compactGeometryEnabled:this.compactGeometryEnabled,datumTransformation:this.datumTransformation,defaultSpatialReferenceEnabled:this.defaultSpatialReferenceEnabled,distance:this.distance,fullText:this.fullText,formatOf3DObjects:this.formatOf3DObjects,gdbVersion:this.gdbVersion,geometry:this.geometry,geometryPrecision:this.geometryPrecision,groupByFieldsForStatistics:this.groupByFieldsForStatistics,having:this.having,historicMoment:this.historicMoment!=null?new Date(this.historicMoment.getTime()):null,maxAllowableOffset:this.maxAllowableOffset,maxRecordCountFactor:this.maxRecordCountFactor,multipatchOption:this.multipatchOption,num:this.num,objectIds:this.objectIds,orderByFields:this.orderByFields,outFields:this.outFields,outSpatialReference:this.outSpatialReference,outStatistics:this.outStatistics,parameterValues:this.parameterValues,pixelSize:this.pixelSize,quantizationParameters:this.quantizationParameters,rangeValues:this.rangeValues,relationParameter:this.relationParameter,resultType:this.resultType,returnDistinctValues:this.returnDistinctValues,returnGeometry:this.returnGeometry,returnCentroid:this.returnCentroid,returnExceededLimitFeatures:this.returnExceededLimitFeatures,returnQueryGeometry:this.returnQueryGeometry,returnM:this.returnM,returnZ:this.returnZ,returnTrueCurves:this.returnTrueCurves,dynamicDataSource:this.dynamicDataSource,sourceSpatialReference:this.sourceSpatialReference,spatialRelationship:this.spatialRelationship,start:this.start,sqlFormat:this.sqlFormat,text:this.text,timeExtent:this.timeExtent,timeReferenceUnknownClient:this.timeReferenceUnknownClient,units:this.units,where:this.where}))}},ob=sd,sd.MAX_MAX_RECORD_COUNT_FACTOR=5,sd);c([d({json:{write:!0}})],me.prototype,"aggregateIds",void 0),c([d({type:Boolean,json:{write:!0}})],me.prototype,"cacheHint",void 0),c([d({type:Boolean,json:{default:!1,write:!0}})],me.prototype,"compactGeometryEnabled",void 0),c([d({json:{write:!0}})],me.prototype,"datumTransformation",void 0),c([We("datumTransformation")],me.prototype,"castDatumTransformation",null),c([d({type:Boolean,json:{default:!1,write:!0}})],me.prototype,"defaultSpatialReferenceEnabled",void 0),c([d({type:Number,json:{write:!0}})],me.prototype,"distance",void 0),c([d({type:Hn,json:{write:!0}})],me.prototype,"dynamicDataSource",void 0),c([d({type:String,json:{write:!0}})],me.prototype,"formatOf3DObjects",void 0),c([d({type:[lde],json:{write:{enabled:!0,overridePolicy(){return{enabled:this.fullText!=null&&this.fullText.length>0}}}}})],me.prototype,"fullText",void 0),c([d({type:String,json:{write:!0}})],me.prototype,"gdbVersion",void 0),c([d({types:Av,json:{read:hc,write:!0}})],me.prototype,"geometry",void 0),c([d({type:Number,json:{write:!0}})],me.prototype,"geometryPrecision",void 0),c([d({type:[String],json:{write:!0}})],me.prototype,"groupByFieldsForStatistics",void 0),c([d({type:String,json:{write:!0}})],me.prototype,"having",void 0),c([d({type:Date})],me.prototype,"historicMoment",void 0),c([re("historicMoment")],me.prototype,"writeHistoricMoment",null),c([d({type:Number,json:{write:!0}})],me.prototype,"maxAllowableOffset",void 0),c([d({type:Number,cast:t=>t<1?1:t>me.MAX_MAX_RECORD_COUNT_FACTOR?me.MAX_MAX_RECORD_COUNT_FACTOR:t,json:{write:{overridePolicy:t=>({enabled:t>1})}}})],me.prototype,"maxRecordCountFactor",void 0),c([d({type:["xyFootprint"],json:{write:!0}})],me.prototype,"multipatchOption",void 0),c([d({type:Number,json:{read:{source:"resultRecordCount"}}})],me.prototype,"num",void 0),c([d({json:{write:!0}})],me.prototype,"objectIds",void 0),c([d({type:[String],json:{write:!0}})],me.prototype,"orderByFields",void 0),c([d({type:[String],json:{write:!0}})],me.prototype,"outFields",void 0),c([d({type:ne,json:{name:"outSR",write:!0}})],me.prototype,"outSpatialReference",void 0),c([d({type:[On],json:{write:{enabled:!0,overridePolicy(){return{enabled:this.outStatistics!=null&&this.outStatistics.length>0}}}}})],me.prototype,"outStatistics",void 0),c([d({json:{write:!0}})],me.prototype,"parameterValues",void 0),c([re("parameterValues")],me.prototype,"writeParameterValues",null),c([d({type:ge,json:{write:!0}})],me.prototype,"pixelSize",void 0),c([d({type:Au,json:{write:!0}})],me.prototype,"quantizationParameters",void 0),c([d({type:[Object],json:{write:!0}})],me.prototype,"rangeValues",void 0),c([d({type:String,json:{read:{source:"relationParam"},write:{target:"relationParam",overridePolicy(){return{enabled:this.spatialRelationship==="relation"}}}}})],me.prototype,"relationParameter",void 0),c([d({type:String,json:{write:!0}})],me.prototype,"resultType",void 0),c([d({type:Boolean,json:{default:!1,write:!0}})],me.prototype,"returnCentroid",void 0),c([d({type:Boolean,json:{default:!1,write:!0}})],me.prototype,"returnDistinctValues",void 0),c([d({type:Boolean,json:{default:!0,write:!0}})],me.prototype,"returnExceededLimitFeatures",void 0),c([d({type:Boolean,json:{write:!0}})],me.prototype,"returnGeometry",void 0),c([d({type:Boolean,json:{default:!1,write:!0}})],me.prototype,"returnQueryGeometry",void 0),c([d({type:Boolean,json:{default:!1,write:!0}})],me.prototype,"returnM",void 0),c([d({type:Boolean,json:{write:{overridePolicy:t=>({enabled:t})}}})],me.prototype,"returnZ",void 0),c([d({type:Boolean,json:{write:!0}})],me.prototype,"returnTrueCurves",void 0),c([d({type:ne,json:{write:!0}})],me.prototype,"sourceSpatialReference",void 0),c([ye(ude,{ignoreUnknown:!1,name:"spatialRel"})],me.prototype,"spatialRelationship",void 0),c([d({type:Number,json:{read:{source:"resultOffset"}}})],me.prototype,"start",void 0),c([re("start"),re("num")],me.prototype,"writeStart",null),c([d({type:String,json:{write:!0}})],me.prototype,"sqlFormat",void 0),c([d({type:String,json:{write:!0}})],me.prototype,"text",void 0),c([d({type:fr,json:{write:!0}})],me.prototype,"timeExtent",void 0),c([d({type:Boolean,json:{default:!1,write:!0}})],me.prototype,"timeReferenceUnknownClient",void 0),c([ye(cde,{ignoreUnknown:!1}),d({json:{write:{overridePolicy(t){return{enabled:!!t&&this.distance!=null}}}}})],me.prototype,"units",void 0),c([d({type:String,json:{write:{overridePolicy(t){return{enabled:t!=null||this.start!=null&&this.start>0}}}}})],me.prototype,"where",void 0),c([re("where")],me.prototype,"writeWhere",null),me=ob=c([C("esri.rest.support.Query")],me);function ou(t){return!(t==null||typeof t!="object"||!("createQuery"in t)||!t.createQuery)}let qs=class extends Ca.EventedAccessor{constructor(e){super(e),this._selectionMap=new nb,this._sources=new se,this._trashCan=[],this._layerEditHandles=new se,this._vizTaskId=0,this.view=null,this.showHighlight=!0,this.highlightName="default"}initialize(){this.addHandles([ie((()=>[this.view,this.showHighlight]),(()=>this._refreshVisualization())),ie((()=>this.view),(e=>{e?.when().then((()=>this.syncSources()))}),Ft),so((()=>this.sources),"change",(e=>{const r=this._selectionMap,i=[];for(const s of e.removed){const n=r.get(s);n&&(r.delete(s),n.highlightHandle?.remove(),i.push({layer:s,selection:[],added:[],removed:[...n.selection]}))}this._refreshListeners(),i.length&&this._onSelectionChange(i)}),{onListenerAdd:()=>this._refreshListeners()})])}destroy(){this.clear(),this._layerEditHandles.drain(Lt)}get selections(){return Array.from(this._selectionMap.entries()).map((e=>{const[r,i]=e;return{layer:r,selection:[...i.selection]}}))}get count(){let e=0;for(const r of this._selectionMap.values())e+=r.selection.length;return e}get hasSelection(){return this.count>0}get sources(){return this._sources}set sources(e){zl(e,this._sources)}syncSources(){const e=new Set,r=this.view?.map;if(!r)return;const i=s=>{ese(s)?(s.layers?.forEach(i),s.tables?.forEach(i)):Qie(s)?(s.sublayers?.forEach(i),s.subtables?.forEach(i)):Nk(s)?s.sublayers?.forEach(i):ou(s)&&e.add(s)};r.allLayers.forEach(i),r.allTables.forEach(i),this.sources=[...e]}async getSelectedFeatures(e,r={},i="layerView"){const{view:s,selections:n}=this;if(!s&&i==="layerView")return q.getLogger(this).warn("Cannot query layer views without a view."),[];const o=(e?.length?n.filter((a=>e.includes(a.layer))):n).map((async a=>{const{layer:l,selection:u}=a;if(!u.length)return;const h=lp(l)?l.parent:l;if(h!=null){if(s&&i==="layerView"&&!eN(h)&&tN(h)){const p=await s.whenLayerView(h).catch((()=>null));if(p)return rN(p,u,r)}return rN(h,u,r)}})).filter(ii);return(await Promise.all(o)).filter(ii)}updateSelection(e){const r=new Map;for(const[n,o]of this._selectionMap)r.set(n,[...o.selection]);let i=!1;const s=e.current.concat(e.added);for(const n of s){const o=n.sourceLayer,a=n.getObjectId();if(this.sources.includes(o)&&(ou(o)||lp(o))&&a!==null){const l=Pm(r,o,(()=>[]));l.includes(a)||(l.push(a),i=!0)}}for(const n of e.removed){const o=n.sourceLayer,a=n.getObjectId();if(this.sources.includes(o)&&(ou(o)||lp(o))&&a!==null){const l=r.get(o),u=l?.indexOf(a);u!==void 0&&u>=0&&(l?.splice(u,1),i=!0)}}if(i){const{_selectionMap:n,_trashCan:o}=this,a=[];for(const[l,u]of r){const h=n.get(l);h!==void 0&&o.push(h),n.set(l,{selection:u}),a.push({layer:l,selection:u,...QL(h!==void 0?h.selection:[],u)})}this._onSelectionChange(a)}}setSelection(e,r){this._setSelection(e,r)}getSelection(e){return this._selectionMap.get(e)?.selection}appendToSelection(e,r){const i=this._selectionMap.get(e),s=i!==void 0?[...i.selection]:[];for(const n of r)s.includes(n)||s.push(n);this._setSelection(e,s)}removeFromSelection(e,r){const i=this._selectionMap.get(e);if(!i)return;const s=[];for(const n of i.selection)r.includes(n)||s.push(n);this._setSelection(e,s)}toggleInSelection(e,r){const i=this._selectionMap.get(e);if(!i||i.selection.length===0)return void this._setSelection(e,r);const s=new Set(i.selection),n=new Set(r),o=qK(s,n);this._setSelection(e,Array.from(o))}clear(){const e=this._selectionMap.values();this._trashCan.push(...e);const r=[];for(const[i,s]of this._selectionMap.entries())r.push({layer:i,added:[],removed:[...s.selection],selection:[]});this._selectionMap.clear(),this._onSelectionChange(r)}_onSelectionChange(e){this._refreshVisualization(),this.emit("selection-change",{view:this.view,changes:e})}_refreshVisualization(){for(this._vizTaskId++;this._trashCan.length>0;)this._trashCan.pop()?.highlightHandle?.remove();if(this.view==null)return;const{sources:e,view:r,_selectionMap:i,showHighlight:s}=this,n=this._vizTaskId;for(const o of e){const a=i.get(o),l=lp(o)?o.parent:o;if(l!=null&&tN(l)){if(eN(l))continue;r.whenLayerView(l).then((u=>{a?.highlightHandle?.remove(),a!=null&&s&&n===this._vizTaskId&&"highlight"in u&&typeof u.highlight=="function"&&a.selection.length>0&&(a.highlightHandle=u.highlight(a.selection,this.highlightName))})).catch((()=>{a?.highlightHandle?.remove()}))}}}_refreshListeners(){this._layerEditHandles.drain(Lt);const e=new Set(this.sources.map((r=>lp(r)?r.parent:r)));for(const r of e)ou(r)&&"on"in r&&r.on&&this._layerEditHandles.push(r.on("edits",(i=>this._onLayerEdit(i,r))))}_onLayerEdit(e,r){if(Nk(r))this._onParentLayerEdit(e,r);else if(e.deletedFeatures.length&&this._selectionMap.has(r)){const i=[];e.deletedFeatures.forEach((({error:s,objectId:n})=>{n!=null&&s==null&&i.push(n)})),this.removeFromSelection(r,i)}}_onParentLayerEdit(e,r){const{deletedFeatures:i,edits:s,updatedFeatures:n}=e;if(s?.updateFeatures?.forEach((o=>{const a=o.getObjectId()??o.attributes[r.objectIdField];if(a==null||n.find((h=>h.objectId===a))?.error)return;const l=r.findSublayerForFeature(o);if(!ou(l))return;const u=r.sublayers.find((h=>!(!ou(h)||!this.getSelection(h)?.includes(a))));ou(u)&&u!==l&&(this.removeFromSelection(u,[a]),this.appendToSelection(l,[a]))})),i.length){const o=[];i.forEach((({error:a,objectId:l})=>{l!=null&&a==null&&o.push(l)})),r.sublayers.forEach((a=>{ou(a)&&this._selectionMap.has(a)&&this.removeFromSelection(a,o)}))}}_setSelection(e,r){if(!this.sources.includes(e))throw new Error(`Cannot set selection on layer ${e.title} because it is not in 'sources'`);const i=this._selectionMap.get(e);if(i===void 0||!dde(i,{selection:r})){i!==void 0&&this._trashCan.push(i),this._selectionMap.set(e,{selection:[...r]});const s={layer:e,selection:[...r],...QL(i!==void 0?i.selection:[],r)};this._onSelectionChange([s])}}};c([d()],qs.prototype,"_selectionMap",void 0),c([d()],qs.prototype,"_sources",void 0),c([d({readOnly:!0,nonNullable:!0})],qs.prototype,"selections",null),c([d({readOnly:!0,nonNullable:!0})],qs.prototype,"count",null),c([d()],qs.prototype,"view",void 0),c([d({readOnly:!0,nonNullable:!0})],qs.prototype,"hasSelection",null),c([d()],qs.prototype,"showHighlight",void 0),c([d()],qs.prototype,"sources",null),c([d()],qs.prototype,"highlightName",void 0),qs=c([C("esri.views.SelectionManager")],qs);const eN=t=>lp(t)?t.parent?.isTable===!0:t.isTable,hde=t=>t.layer!==void 0,tN=t=>t?.when!==void 0,dde=(t,e)=>{if(t==null&&e==null)return!0;if(t!=null&&e==null||t==null&&e!=null)return!1;if(t!=null&&e!=null&&t.selection!=null&&e.selection!=null){const r=[...t.selection],i=[...e.selection];if(r.length!==i.length)return!1;r.sort(),i.sort();for(let s=0;s<r.length;s++)if(r[s]!==i[s])return!1}return!0},rN=async(t,e,r={})=>{let i;if(hde(t)){const s=t;i=s===void 0?null:await s.queryFeatures(new me({...r,objectIds:e})).then((n=>({data:n,layer:t.layer})))}else{const s=t;i=s===void 0?null:await s.queryFeatures(new me({...r,objectIds:e})).then((n=>({data:n,layer:s})))}return i},pde=qs;let fg=class extends Ce.ClonableMixin(ce){constructor(e){super(e),this.accentColor=new Q([255,127,0]),this.textColor=new Q([255,255,255])}};c([d({type:Q,nonNullable:!0})],fg.prototype,"accentColor",void 0),c([d({type:Q,nonNullable:!0})],fg.prototype,"textColor",void 0),fg=c([C("esri.views.Theme")],fg);const oI=fg;var iN;(function(t){t[t.Left=0]="Left",t[t.Middle=1]="Middle",t[t.Right=2]="Right"})(iN||(iN={}));const VG=["click","double-click","immediate-click","immediate-double-click","hold","drag","key-down","key-up","pointer-down","pointer-move","pointer-up","pointer-drag","mouse-wheel","pointer-enter","pointer-leave","gamepad","focus","blur"],jG={};function UG(t){return!!jG[t]}function fde(t){for(const e of t)if(!UG(e))return!1;return!0}VG.forEach((t=>{jG[t]=!0}));let GG=class{constructor(e){this._handlers=new Map,this._counter=0,this._handlerCounts=new Map,this.view=e,this.inputManager=null}connect(e){e&&this.disconnect(),this.inputManager=e,this._handlers.forEach((({handler:r,priority:i},s)=>this.inputManager?.installHandlers(s,[r],i)))}disconnect(){this.inputManager&&this._handlers.forEach(((e,r)=>this.inputManager?.uninstallHandlers(r))),this.inputManager=null}destroy(){this.disconnect(),this._handlers.clear(),this.view=null}on(e,r,i,s){const n=Array.isArray(e)?e:e.split(",");if(!fde(n))return n.some(UG)&&console.error("Error: registering input events and other events on the view at the same time is not supported."),null;let o,a;Array.isArray(r)?a=r:(o=r,a=[]),typeof i=="function"?o=i:s=i,s=s??kl.DEFAULT;const l=this._createUniqueGroupName(),u=new mde(this.view,n,a,o);this._handlers.set(l,{handler:u,priority:s});for(const h of n){const p=this._handlerCounts.get(h)||0;this._handlerCounts.set(h,p+1)}return this.inputManager&&this.inputManager.installHandlers(l,[u],s),He((()=>this._removeHandler(l,n)))}hasHandler(e){return!!this._handlerCounts.get(e)}_removeHandler(e,r){if(this._handlers.has(e)){this._handlers.delete(e);for(const i of r){const s=this._handlerCounts.get(i);s===void 0||(s===1?this._handlerCounts.delete(i):this._handlerCounts.set(i,s-1))}}this.inputManager&&this.inputManager.uninstallHandlers(e)}_createUniqueGroupName(){return this._counter+=1,`viewEvents_${this._counter}`}},mde=class extends Ar{constructor(e,r,i,s){super(!0),this._latestDragStart=void 0,this.view=e;for(const n of r)switch(n){case"click":this.registerIncoming("click",i,(o=>s(vde(e,o))));break;case"double-click":this.registerIncoming("double-click",i,(o=>s(_de(e,o))));break;case"immediate-click":this.registerIncoming("immediate-click",i,(o=>s(bde(e,o))));break;case"immediate-double-click":this.registerIncoming("immediate-double-click",i,(o=>s(wde(e,o))));break;case"hold":this.registerIncoming("hold",i,(o=>s(Sde(e,o))));break;case"drag":this.registerIncoming("drag",i,(o=>{const a=this._wrapDrag(o);a&&s(a)}));break;case"key-down":this.registerIncoming("key-down",i,(o=>s(xde(o))));break;case"key-up":this.registerIncoming("key-up",i,(o=>s($de(o))));break;case"pointer-down":this.registerIncoming("pointer-down",i,(o=>s(yy(o,"pointer-down"))));break;case"pointer-move":this.registerIncoming("pointer-move",i,(o=>s(yy(o,"pointer-move"))));break;case"pointer-up":this.registerIncoming("pointer-up",i,(o=>s(yy(o,"pointer-up"))));break;case"pointer-drag":this.registerIncoming("pointer-drag",i,(o=>s(Mde(o))));break;case"mouse-wheel":this.registerIncoming("mouse-wheel",i,(o=>s(Tde(o))));break;case"pointer-enter":this.registerIncoming("pointer-enter",i,(o=>s(yy(o,"pointer-enter"))));break;case"pointer-leave":this.registerIncoming("pointer-leave",i,(o=>s(yy(o,"pointer-leave"))));break;case"gamepad":this.registerIncoming("gamepad",i,(o=>{s(Ede(o))}));break;case"focus":this.registerIncoming("focus",i,(o=>{s(yde(o))}));break;case"blur":this.registerIncoming("blur",i,(o=>{s(gde(o))}))}}_wrapDrag(e){const r=e.data,{x:i,y:s}=r.center,{action:n,pointerType:o,button:a}=r;if(n==="start"&&(this._latestDragStart=r),!this._latestDragStart)return;const l=r.pointer.native,u=r.buttons,{cancelable:h,timestamp:p}=e,m={x:this._latestDragStart.center.x,y:this._latestDragStart.center.y};return n==="end"&&(this._latestDragStart=void 0),{type:"drag",action:n,x:i,y:s,origin:m,pointerType:o,button:a,buttons:u,radius:r.radius,angle:U8(r.angle),native:l,timestamp:p,cancelable:h,stopPropagation:()=>e.stopPropagation(),defer:y=>e.defer(y),preventDefault:()=>e.preventDefault()}}};function yde(t){return{type:"focus",timestamp:t.timestamp,native:t.data.native,cancelable:t.cancelable,stopPropagation:()=>t.stopPropagation(),defer:e=>t.defer(e),preventDefault:()=>t.preventDefault()}}function gde(t){return{type:"blur",timestamp:t.timestamp,native:t.data.native,cancelable:t.cancelable,stopPropagation:()=>t.stopPropagation(),defer:e=>t.defer(e),preventDefault:()=>t.preventDefault()}}function vde(t,e){const{pointerType:r,button:i,buttons:s,x:n,y:o,native:a,eventId:l}=e.data,{cancelable:u,timestamp:h}=e;return{type:"click",pointerType:r,button:i,buttons:s,x:n,y:o,native:a,timestamp:h,screenPoint:or(n,o),mapPoint:Fv(t,n,o),eventId:l,cancelable:u,stopPropagation:()=>e.stopPropagation(),defer:p=>e.defer(p),preventDefault:()=>e.preventDefault()}}function _de(t,e){const{pointerType:r,button:i,buttons:s,x:n,y:o,native:a,eventId:l}=e.data,{cancelable:u,timestamp:h}=e;return{type:"double-click",pointerType:r,button:i,buttons:s,x:n,y:o,native:a,timestamp:h,mapPoint:Fv(t,n,o),eventId:l,cancelable:u,stopPropagation:()=>e.stopPropagation(),defer:p=>e.defer(p),preventDefault:()=>e.preventDefault()}}function bde(t,e){const{pointerType:r,button:i,buttons:s,x:n,y:o,native:a,eventId:l}=e.data,u=a.pointerId,{cancelable:h,timestamp:p}=e;return{type:"immediate-click",pointerId:u,pointerType:r,button:i,buttons:s,x:n,y:o,native:a,timestamp:p,mapPoint:Fv(t,n,o),eventId:l,cancelable:h,stopPropagation:()=>e.stopPropagation(),defer:m=>e.defer(m),preventDefault:()=>e.preventDefault()}}function wde(t,e){const{pointerType:r,button:i,buttons:s,x:n,y:o,native:a,eventId:l}=e.data,u=a.pointerId,{cancelable:h,timestamp:p}=e;return{type:"immediate-double-click",pointerId:u,pointerType:r,button:i,buttons:s,x:n,y:o,native:a,timestamp:p,mapPoint:Fv(t,n,o),eventId:l,cancelable:h,stopPropagation:()=>e.stopPropagation(),defer:m=>e.defer(m),preventDefault:()=>e.preventDefault()}}function Sde(t,e){const{pointerType:r,button:i,buttons:s,x:n,y:o,native:a}=e.data,{cancelable:l,timestamp:u}=e;return{type:"hold",pointerType:r,button:i,buttons:s,x:n,y:o,native:a,timestamp:u,mapPoint:Fv(t,n,o),cancelable:l,stopPropagation:()=>e.stopPropagation(),defer:h=>e.defer(h),preventDefault:()=>e.preventDefault()}}function Fv(t,e,r){return t.toMap(or(e,r),{exclude:[]})}function xde(t){const{key:e,repeat:r,native:i}=t.data,{cancelable:s,timestamp:n}=t;return{type:"key-down",key:e,repeat:r,native:i,timestamp:n,cancelable:s,stopPropagation:()=>t.stopPropagation(),defer:o=>t.defer(o),preventDefault:()=>t.preventDefault()}}function $de(t){const{key:e,native:r}=t.data,{cancelable:i,timestamp:s}=t;return{type:"key-up",key:e,native:r,timestamp:s,cancelable:i,stopPropagation:()=>t.stopPropagation(),defer:n=>t.defer(n),preventDefault:()=>t.preventDefault()}}function yy(t,e){const{x:r,y:i,button:s,buttons:n,native:o,eventId:a}=t.data,l=o.pointerId,u=o.pointerType,{cancelable:h,timestamp:p}=t;return{type:e,x:r,y:i,pointerId:l,pointerType:u,button:s,buttons:n,native:o,timestamp:p,eventId:a,cancelable:h,stopPropagation:()=>t.stopPropagation(),defer:m=>t.defer(m),preventDefault:()=>t.preventDefault()}}function Mde(t){const{x:e,y:r,buttons:i,native:s,eventId:n}=t.data.currentEvent,{button:o}=t.data.startEvent,a=t.data.startEvent.native.pointerId,l=t.data.startEvent.native.pointerType,u=t.data.action,h={x:t.data.startEvent.x,y:t.data.startEvent.y},{cancelable:p,timestamp:m}=t;return{type:"pointer-drag",x:e,y:r,pointerId:a,pointerType:l,button:o,buttons:i,action:u,origin:h,native:s,timestamp:m,eventId:n,cancelable:p,stopPropagation:()=>t.stopPropagation(),defer:y=>t.defer(y),preventDefault:()=>t.preventDefault()}}function Tde(t){const{cancelable:e,data:r,timestamp:i}=t,{x:s,y:n,deltaY:o,native:a}=r;return{type:"mouse-wheel",x:s,y:n,deltaY:o,native:a,timestamp:i,cancelable:e,stopPropagation:()=>t.stopPropagation(),defer:l=>t.defer(l),preventDefault:()=>t.preventDefault()}}function Ede(t){const{action:e,state:r,device:i}=t.data,{cancelable:s,timestamp:n}=t,{buttons:o,axes:a}=r;return{type:"gamepad",device:i,timestamp:n,action:e,buttons:o,axes:a,cancelable:s,stopPropagation:()=>t.stopPropagation(),defer:l=>t.defer(l),preventDefault:()=>t.preventDefault()}}var G0,sN,nN;(function(t){t[t.USER=0]="USER",t[t.MANAGER=1]="MANAGER"})(G0||(G0={})),(function(t){t[t.None=0]="None",t[t.Unfocused=1]="Unfocused",t[t.Focused=2]="Focused",t[t.Unselected=4]="Unselected",t[t.Selected=8]="Selected",t[t.All=15]="All"})(sN||(sN={})),(function(t){t[t.None=0]="None",t[t.Custom1=16]="Custom1",t[t.Custom2=32]="Custom2",t[t.Custom3=64]="Custom3",t[t.Custom4=128]="Custom4",t[t.Custom5=256]="Custom5",t[t.Custom6=512]="Custom6",t[t.Custom7=1024]="Custom7",t[t.Custom8=2048]="Custom8",t[t.Custom9=4096]="Custom9",t[t.Custom10=8192]="Custom10",t[t.Custom11=16384]="Custom11",t[t.Custom12=32768]="Custom12",t[t.All=65520]="All"})(nN||(nN={}));const Ide="z",Cde="r",BG={cancel:"Escape",complete:"Enter"},v5e={...BG,redo:Cde,undo:Ide,center:"Alt",constraint:"Shift",delete:["Backspace","Delete"],vertexAdd:"f",pan:" "},_5e={toggle:"Control"},b5e={enterInputMode:"Tab",commit:"Enter",discard:"Escape",next:"Tab"},w5e={moveUp:{key:"ArrowUp",modifier:"Shift",repeats:!0},moveDown:{key:"ArrowDown",modifier:"Shift",repeats:!0},moveLeft:{key:"ArrowLeft",modifier:"Shift",repeats:!0},moveRight:{key:"ArrowRight",modifier:"Shift",repeats:!0},scaleUp:{key:"+",modifier:"Shift"},scaleDown:{key:"-",modifier:"Shift"},factorModifier:{key:B9,continuePropagation:!0},toggleOpacity:"t",preserveAspectRatio:{key:"Shift",continuePropagation:!0},rotateIncrements:{key:"Shift",continuePropagation:!0}};let S5e=class{constructor(){this._bindings=new Map}add(e,r){return this.addToggle(e,(i=>{i.type==="key-down"&&r(i)}))}addToggle(e,r){const i=Pde.fromDefinition(e,r),s=Pm(this._bindings,i.key,(()=>[]));return s.push(i),He((()=>OP(s,i)))}register(e,r=kl.WIDGET){return $d([e.on("key-down",(i=>this.dispatch(e.inputManager,i)),r),e.on("key-up",(i=>this.dispatch(e.inputManager,i)),r)])}dispatch(e,r){const i=r.key,s=this._bindings.get(i);if(s)for(const n of s)n.process(e,r)}},Pde=class aI{constructor(e,r,i,s,n){this.key=e,this.modifiers=r,this.repeats=i,this.continuePropagation=s,this.callback=n}process(e,r){if(!(r.key!==this.key||"repeat"in r&&r.repeat&&!this.repeats)){for(const i of this.modifiers)if(!e.isModifierKeyDown(i))return;this.continuePropagation||r.stopPropagation(),this.callback(r)}}static fromDefinition(e,r){if(typeof e=="string")return new aI(e,[],!1,!1,r);const{key:i,modifier:s,repeats:n,continuePropagation:o}=e;return new aI(i,s?Array.isArray(s)?s:[s]:[],!!n,!!o,r)}};function Ade(t){return[t.on("before-add",(e=>{const r=e.item;if(r==null||t.includes(r))return q.getLogger("esri.views.interactive.interactiveToolUtils").warn("Tool is either already in the list of tools or tool is `null`. Not adding tool."),void e.preventDefault();r.onAdd()})),t.on("after-remove",(e=>{const r=e.item;r.active&&(r.view.activeTool=null),r.destroy()}))]}function lI(t){return t.visible&&t.getEditableFlag!=null&&t.getEditableFlag(G0.USER)&&t.getEditableFlag(G0.MANAGER)}function Lde(t){return t.type==="key-down"&&t.key===BG.cancel}function So(t){return or(t.x,t.y)}function qG(t,e){const r=(t instanceof HTMLElement?t:t.surface)?.getBoundingClientRect();return r?or(e.clientX-r.left,e.clientY-r.top):or(0,0)}function HG(t,e){return e instanceof Event?qG(t,e):So(e)}function WG(t){if(t instanceof Event)return!0;if(typeof t=="object"&&"type"in t)switch(t.type){case"click":case"double-click":case"pointer-down":case"pointer-drag":case"pointer-enter":case"pointer-leave":case"pointer-up":case"pointer-move":case"immediate-click":case"immediate-double-click":case"hold":case"drag":case"mouse-wheel":return!0;default:return!1}return!1}let Rde=class{constructor(){this._pointerLocations=new Map,this._hoveredManipulators=new Map,this._grabbedManipulators=new Map,this._draggedManipulators=new Map,this._stopDrag=!1,this._externallyDragging=!1,this._revertToNullActiveTool=!1,this._cursor=null}get cursor(){return this._cursor}hasFocusedManipulators(){return this._grabbedManipulators.size>0||this._draggedManipulators.size>0}handleInputEvent(e,r){const i=()=>e.stopPropagation();switch(e.type){case"pointer-move":aN(e.pointerType)&&this._pointerLocations.set(e.pointerId,{x:e.x,y:e.y,pointerType:e.pointerType});break;case"drag":this._grabbedManipulators.size>0?this._stopDrag=!0:e.action==="start"?this._externallyDragging=!0:e.action==="end"&&(this._externallyDragging=!1),this._stopDrag&&(i(),e.action==="end"&&(this._stopDrag=!1));break;case"pointer-down":{if(!lN(e))break;const s=So(e),n=qd(s,e.pointerType,r.forEachTool);if(n==null)break;const o=n.manipulator,a=n.tool;o==null||a==null||!o.interactive||o.grabbable&&o.grabbableForEvent(e)||!o.grabbing||o.dragging||this._releaseManipulatorBeforeDragging(o,e,r),o!=null&&a!=null&&o.interactive&&o.grabbable&&o.grabbableForEvent(e)&&!o.grabbing&&(this._grabbedManipulators.set(e.pointerId,{manipulator:o,tool:a,start:s,pointerType:e.pointerType}),this._grabbedManipulators.size===1&&r.activeTool==null&&(this._revertToNullActiveTool=!0,r.setActiveTool(n.tool)),o.grabbing=!0,o.events.emit("grab-changed",{action:"start",pointerType:e.pointerType,screenPoint:s}),i());break}case"pointer-up":this._draggedManipulators.has(e.pointerId)||this._handlePointerEnd(e,r);break;case"pointer-drag":{if(!lN(e))break;const s=this._grabbedManipulators.get(e.pointerId),n=s?.manipulator,o=s?.tool;if(n==null||o==null)break;const a=So(e);a.x=$i(a.x,0,r.view.width),a.y=$i(a.y,0,r.view.height);const l=s.start,u=this._draggedManipulators.get(e.pointerId);switch(e.action){case"start":case"update":e.action!=="update"&&this._grabbedManipulators.size!==1||(n.dragging=!0,u?n.events.emit("drag",{action:"update",start:l,screenPoint:a}):n.events.emit("drag",{action:"start",start:l,screenPoint:a,pointerType:e.pointerType}),this._draggedManipulators.set(e.pointerId,{tool:o,manipulator:n,start:l}));break;case"end":n.dragging=!1,u&&n.events.emit("drag",{action:"end",start:l,screenPoint:a}),this._draggedManipulators.delete(e.pointerId),this._handlePointerEnd(e,r)}i();break}case"immediate-click":{const s=So(e),n=qd(s,e.pointerType,r.forEachTool);if(kde(e)||r.forEachTool((u=>{if((n==null||n.tool!==u||u.automaticManipulatorSelection)&&u.manipulators){let h=!1;u.manipulators.forEach((({manipulator:p})=>{p.selected&&(p.selected=!1,h=!0)})),h&&u.onManipulatorSelectionChanged&&u.onManipulatorSelectionChanged()}})),n==null)break;const{manipulator:o,tool:a}=n;if(!o.interactive)break;o.selectable&&a.automaticManipulatorSelection&&(o.selected=!o.selected,a.onManipulatorSelectionChanged&&a.onManipulatorSelectionChanged());const l=e.native.shiftKey;o.events.emit("immediate-click",{screenPoint:s,button:e.button,pointerType:e.pointerType,shiftKey:l,stopPropagation:i}),Qx(o,i);break}case"click":{const s=So(e),n=qd(s,e.pointerType,r.forEachTool),o=n?.manipulator;if(o==null||!o.interactive)break;const a=e.native.shiftKey;o.events.emit(e.type,{screenPoint:s,button:e.button,pointerType:e.pointerType,shiftKey:a}),i();break}case"double-click":{const s=So(e),n=qd(s,e.pointerType,r.forEachTool),o=n!=null?n.manipulator:null;if(o==null||!o.interactive)break;const a=e.native.shiftKey;o.events.emit("double-click",{screenPoint:s,button:e.button,pointerType:e.pointerType,shiftKey:a,stopPropagation:i}),Qx(o,i);break}case"immediate-double-click":{const s=So(e),n=qd(s,e.pointerType,r.forEachTool),o=n!=null?n.manipulator:null;if(o==null||!o.interactive)break;const a=e.native.shiftKey;o.events.emit("immediate-double-click",{screenPoint:s,button:e.button,pointerType:e.pointerType,shiftKey:a,stopPropagation:i}),e.pointerType==="mouse"&&Qx(o,i);break}}this._onFocusChange(r.forEachTool)}_releaseManipulatorBeforeDragging(e,r,i){e.grabbing=!1,e.events.emit("grab-changed",{action:"end",pointerType:r.pointerType,screenPoint:So(r)}),this._grabbedManipulators.forEach((({manipulator:s},n)=>{s===e&&this._grabbedManipulators.delete(n)})),this._afterManipulatorRelease(i.setActiveTool)}_handlePointerEnd(e,r){const i=this._grabbedManipulators.get(e.pointerId)?.manipulator;i!=null&&i.grabbing&&(i.grabbing=!1,i.events.emit("grab-changed",{action:"end",pointerType:e.pointerType,screenPoint:So(e)}),this._grabbedManipulators.delete(e.pointerId),this._afterManipulatorRelease(r.setActiveTool))}_onFocusChange(e){this._updateCursor(),this._updateFocusedManipulatorTools(e)}_updateCursor(){this._grabbedManipulators.size>0?this._cursor=oN(this._grabbedManipulators)||"grabbing":this._hoveredManipulators.size>0?this._cursor=oN(this._hoveredManipulators)||"pointer":this._cursor=null}_updateFocusedManipulatorTools(e){const r=new Set,i=new Set;this._grabbedManipulators.forEach((({tool:s})=>{r.add(s)})),this._hoveredManipulators.forEach((({tool:s})=>{i.add(s)})),e((s=>{s.hasGrabbedManipulators=r.has(s),s.hasHoveredManipulators=i.has(s);const n=this._grabbedManipulators.values(),o=cK(n,(({tool:a})=>a===s));s.firstGrabbedManipulator=o!=null?o.manipulator:null}))}clearPointers(e,{forEachTool:r,setActiveTool:i},s=!0,n){const o=(a,l)=>a===e&&(n==null||n===l);this._grabbedManipulators.forEach((({tool:a,manipulator:l,pointerType:u},h)=>{o(a,l)&&(this._grabbedManipulators.delete(h),l.grabbing=!1,l.events.emit("grab-changed",{action:"end",screenPoint:null,pointerType:u}))})),this._draggedManipulators.forEach((({tool:a,manipulator:l},u)=>{o(a,l)&&(this._draggedManipulators.delete(u),l.dragging=!1,l.events.emit("drag",{action:"cancel"}))})),s&&this._hoveredManipulators.forEach((({tool:a,manipulator:l},u)=>{o(a,l)&&(this._hoveredManipulators.delete(u),l.hovering=!1)})),this._afterManipulatorRelease(i),this._onFocusChange(r)}updateHoveredStateFromKnownPointers(e){this._pointerLocations.forEach(((r,i)=>{this._updateHoveredStateForPointerAtScreenPosition(or(r.x,r.y),i,r.pointerType,e)}))}handleHoverEvent(e,r){const i=e.type;i!=="pointer-up"&&i!=="immediate-click"&&i!=="pointer-move"||!aN(e.pointerType)||(i!=="pointer-up"&&this._externallyDragging?this._clearHoveredManipulatorStates(e.pointerId):this._updateHoveredStateForPointerAtScreenPosition(So(e),e.pointerId,e.pointerType,r))}_updateHoveredStateForPointerAtScreenPosition(e,r,i,s){let n=qd(e,i,s);const o=this._hoveredManipulators.get(r)?.manipulator;n==null||n.manipulator.interactive||(n=null),n!=null&&o===n.manipulator||(o!=null&&(o.hovering=!1),n!=null?(n.manipulator.hovering=!0,this._hoveredManipulators.set(r,n)):this._hoveredManipulators.delete(r),this._onFocusChange(s))}_afterManipulatorRelease(e){this._grabbedManipulators.size===0&&this._revertToNullActiveTool&&(e(null),this._revertToNullActiveTool=!1)}_clearHoveredManipulatorStates(e){this._hoveredManipulators.forEach((({manipulator:r},i)=>{e===i&&(this._hoveredManipulators.delete(e),r.hovering=!1)}))}};function oN(t){for(const{manipulator:e}of t.values())if(e!=null&&e.interactive){if(e.grabbing&&e.grabCursor)return e.grabCursor;if(e.cursor)return e.cursor}return null}function qd(t,e,r){let i=null;return r((s=>{if(s.manipulators==null||!lI(s))return!1;const n=s.manipulators.intersect(t,e);return n!=null&&(i={tool:s,manipulator:n},!0)})),i}function aN(t){return t==="mouse"}function lN(t){return t.pointerType!=="mouse"||t.button===0}function kde(t){return!!t.native.shiftKey}function Qx(t,e){t?.consumesClicks&&e()}const uN="attached",e$="tools",Ode=1e3;let xo=class extends ce{constructor(e){super(e),this._updatingHandles=new Xh,this._clock=Am,this._manipulatorState=new Rde,this.tools=new se,this.cursor=null,this._interacting=!1,this._interactingTimeout=Ode,this._interactingTimeoutHandle=null,this._forEachTool=r=>{for(const i of this.tools.items)if(r(i))return}}initialize(){this.addHandles([this.view.on(VG,(e=>{this._handleInputEvent(e)}),kl.TOOL),...Ade(this.tools),this.tools.on("before-add",(({item:e})=>{this._updateToolEditableFlag(e)})),this.tools.on("before-remove",(({item:e})=>{this._manipulatorState.clearPointers(e,this._manipulatorStateEventArgs),this._updateCursor()})),this.tools.on("change",(()=>{this._refreshToolWatchers()}))])}destroy(){this.activeTool=null,this.tools.drain((e=>e.destroy())),this._clearInteractingTimeout(),this._interacting=!1,this._updatingHandles.destroy()}get _manipulatorStateEventArgs(){return{forEachTool:this._forEachTool,activeTool:this.activeTool,setActiveTool:e=>{this.activeTool=e},view:this.view}}set activeTool(e){if(e!=null&&!this.view.ready)return void q.getLogger(this).error("Cannot set active tool while view is not ready.");if(e===this.activeTool)return;const r=this.activeTool;this._set("activeTool",e),r?.deactivate(),e?.activate(),this._removeIncompleteTools(e);for(const i of this.tools){this._updateToolEditableFlag(i);const s=lI(i);this.activeTool!=null&&s||this._manipulatorState.clearPointers(i,this._manipulatorStateEventArgs,!s)}this._updateCursor()}get updating(){return this._updatingHandles.updating||this.tools.some((e=>e.updating))}get interacting(){return this._interacting}_clearInteractingTimeout(){this._interactingTimeoutHandle=Lt(this._interactingTimeoutHandle)}_startInteractingTimeout(){this._clearInteractingTimeout(),this._interactingTimeoutHandle=this._clock.setTimeout((()=>this._interacting=!1),this._interactingTimeout)}attach(){this.view.type==="3d"?this.addHandles([ie((()=>{const{state:e}=this.view;return"camera"in e&&e.camera}),(()=>this._forEachManipulator((e=>e.onViewChange())))),this.view.elevationProvider?.on("elevation-change",(e=>this._forEachManipulator((r=>r.onElevationChange(e)))))],uN):this.addHandles(ie((()=>this.view.extent),(()=>this._forEachManipulator((e=>e.onViewChange())))))}detach(){this.activeTool=null,this.tools.removeAll(),this.removeHandles(uN),this._clearInteractingTimeout(),this._interacting=!1}_forEachManipulator(e){this._forEachTool((r=>{r.manipulators&&r.manipulators.forEach((({manipulator:i})=>e(i,r)))}))}_handleInputEvent(e){let r=!1;const i={...e,stopPropagation:()=>{r=!0,e.stopPropagation()}};this.activeTool!=null?this.activeTool.handleInputEvent&&this.activeTool.handleInputEvent(i):this._forEachTool((s=>{!r&&s.visible&&s.handleInputEvent(i)})),!r&&Lde(e)&&this.activeTool&&(e.stopPropagation(),e.preventDefault(),this.activeTool.cancel(),this.activeTool=null),this._manipulatorState.handleInputEvent(i,this._manipulatorStateEventArgs),r||this.activeTool==null||this.activeTool.handleInputEventAfter(i),this._manipulatorState.handleHoverEvent(i,this._forEachTool),this._updateCursor(),e.type==="pointer-move"&&(this._manipulatorState.hasFocusedManipulators()||this.activeTool)&&(this._interacting=!0,this._startInteractingTimeout())}_refreshToolWatchers(){this.removeHandles(e$),this._forEachTool((e=>{if(e instanceof ce){const r=ie((()=>[e.cursor,e.visible,e.editable]),(()=>{lI(e)||this._manipulatorState.clearPointers(e,this._manipulatorStateEventArgs),this._updateCursor()}));this.addHandles(r,e$)}e.manipulators&&this.addHandles([e.manipulators.on("after-remove",(r=>{this._manipulatorState.clearPointers(e,this._manipulatorStateEventArgs,!0,r.item.manipulator)})),e.manipulators.on("change",(()=>{this._manipulatorState.updateHoveredStateFromKnownPointers(this._forEachTool),this._updateCursor()}))],e$)})),this._manipulatorState.updateHoveredStateFromKnownPointers(this._forEachTool),this._updateCursor()}_updateToolEditableFlag(e){e.setEditableFlag?.(G0.MANAGER,this.activeTool==null||e===this.activeTool)}_updateCursor(){let e=this._manipulatorState.cursor;e==null&&this._forEachTool((r=>!(r.cursor==null||!r.visible)&&(e=r.cursor,!0))),this._get("cursor")!==e&&this._set("cursor",e)}_removeIncompleteTools(e){this.tools.filter((r=>(e==null||r!==e)&&!r.created&&r.removeIncompleteOnCancel)).forEach((r=>{this.tools.remove(r)}))}get test(){}};c([d({constructOnly:!0,nonNullable:!0})],xo.prototype,"view",void 0),c([d({value:null})],xo.prototype,"activeTool",null),c([d({readOnly:!0,type:se})],xo.prototype,"tools",void 0),c([d({readOnly:!0})],xo.prototype,"cursor",void 0),c([d({readOnly:!0})],xo.prototype,"updating",null),c([d()],xo.prototype,"_interacting",void 0),c([d({readOnly:!0})],xo.prototype,"interacting",null),xo=c([C("esri.views.ToolViewManager")],xo);const Nde=new Q("cyan"),Fde=1,Dde=.25,zde=new Q("black"),Vde=.4,jde=.2,T5e=.25,ZG="default",Ude="temporary",Gde=new Q("yellow");var uI;let bs=uI=class extends ce{constructor(t){super(t),this.name=ZG,this.color=Nde.clone(),this.haloColor=null,this.haloOpacity=Fde,this.fillOpacity=Dde,this.shadowColor=zde.clone(),this.shadowOpacity=Vde,this.shadowDifference=jde,this.haloWidth=2.1,this.haloBlur=.8/this.haloWidth}equals(t){return this.color.equals(t.color)&&(this.haloColor||this.color).equals(t.haloColor||t.color)&&this.haloOpacity===t.haloOpacity&&this.fillOpacity===t.fillOpacity&&this.haloWidth===t.haloWidth&&this.haloBlur===t.haloBlur&&this.shadowColor.equals(t.shadowColor)&&this.shadowOpacity===t.shadowOpacity&&this.shadowDifference===t.shadowDifference}clone(){return new uI({...this,color:this.color.clone(),haloColor:this.haloColor?.clone(),shadowColor:this.shadowColor?.clone()})}assignFrom(t){this.color=t.color.clone(),this.haloColor=t.haloColor?.clone(),this.haloOpacity=t.haloOpacity,this.fillOpacity=t.fillOpacity,this.shadowColor=t.shadowColor.clone(),this.shadowDifference=t.shadowDifference,this.shadowOpacity=t.shadowOpacity,this.haloBlur=t.haloBlur,this.haloWidth=t.haloWidth}};c([d({type:String,constructOnly:!0,nonNullable:!0})],bs.prototype,"name",void 0),c([d({type:Q,nonNullable:!0})],bs.prototype,"color",void 0),c([d({type:Q})],bs.prototype,"haloColor",void 0),c([d({nonNullable:!0})],bs.prototype,"haloOpacity",void 0),c([d({nonNullable:!0})],bs.prototype,"fillOpacity",void 0),c([d({type:Q,nonNullable:!0})],bs.prototype,"shadowColor",void 0),c([d({nonNullable:!0})],bs.prototype,"shadowOpacity",void 0),c([d({nonNullable:!0})],bs.prototype,"shadowDifference",void 0),c([d({nonNullable:!0})],bs.prototype,"haloWidth",void 0),c([d({nonNullable:!0})],bs.prototype,"haloBlur",void 0),bs=uI=c([C("esri.views.support.HighlightOptions")],bs);const ec=bs;function Bde(){return new(se.ofType(ec))([new ec({name:ZG}),new ec({name:Ude,color:Gde})])}let mp=class extends ce{constructor(e){super(),this.nativeIndex=null,this._detectedDeviceType="unknown",e.mapping==="standard"?this._detectedDeviceType="standard":qde.test(e.id)?this._detectedDeviceType="spacemouse":this._detectedDeviceType="unknown",this.nativeIndex=e.index}get native(){const e=navigator.getGamepads?navigator.getGamepads():[];return this.nativeIndex!=null&&this.nativeIndex<e.length?e[this.nativeIndex]:null}get deviceType(){return this._detectedDeviceType}get axisThreshold(){return Hde[this.deviceType]}};c([d({nonNullable:!0,readOnly:!0})],mp.prototype,"nativeIndex",void 0),c([d({type:String,readOnly:!0})],mp.prototype,"deviceType",null),c([d({type:Number,readOnly:!0})],mp.prototype,"axisThreshold",null),mp=c([C("esri.views.input.gamepad.GamepadInputDevice")],mp);const _A=mp,qde=new RegExp("^(3dconnexion|space(mouse|navigator|pilot|explorer))","i"),Hde={standard:.15,spacemouse:.025,unknown:0};let mg=class extends ce{constructor(...e){super(...e),this.devices=new se,this.enabledFocusMode="document"}};c([d({type:se.ofType(_A),readOnly:!0})],mg.prototype,"devices",void 0),c([d({type:["document","view","none"]})],mg.prototype,"enabledFocusMode",void 0),mg=c([C("esri.views.input.gamepad.GamepadSettings")],mg);const Wde=mg;let ab=class extends ce{constructor(){super(...arguments),this.gamepad=new Wde}};c([d({readOnly:!0})],ab.prototype,"gamepad",void 0),ab=c([C("esri.views.input.Input")],ab);const Zde=ab,JG=()=>Ge.respectPrefersReducedMotion&&window.matchMedia("(prefers-reduced-motion: reduce)").matches,t$=()=>d({type:["pan","rotate","zoom","none"],nonNullable:!0});let eh=class extends ce{constructor(e){super(e),this.dragPrimary="pan",this.dragSecondary="rotate",this.dragTertiary="zoom",this.mouseWheel="zoom"}};c([t$()],eh.prototype,"dragPrimary",void 0),c([t$()],eh.prototype,"dragSecondary",void 0),c([t$()],eh.prototype,"dragTertiary",void 0),c([d({type:["zoom","none"],nonNullable:!0})],eh.prototype,"mouseWheel",void 0),eh=c([C("esri.views.navigation.NavigationActionMap")],eh);const bA=eh;let vu=class extends ce{constructor(e){super(e),this.enabled=!0,this.device=null,this.mode="pan",this.tiltDirection="forward-down",this.velocityFactor=1}};c([d({type:Boolean,nonNullable:!0})],vu.prototype,"enabled",void 0),c([d({type:_A})],vu.prototype,"device",void 0),c([d({type:["pan","zoom"],nonNullable:!0})],vu.prototype,"mode",void 0),c([d({type:["forward-down","forward-up"],nonNullable:!0})],vu.prototype,"tiltDirection",void 0),c([d({type:Number,nonNullable:!0})],vu.prototype,"velocityFactor",void 0),vu=c([C("esri.views.navigation.gamepad.GamepadSettings")],vu);const YG=vu;let _u=class extends ce{constructor(e){super(e),this.actionMap=new bA,this.browserTouchPanEnabled=!0,this.gamepad=new YG,this.momentumEnabled=!0}get effectiveMomentumEnabled(){return this.momentumEnabled&&!JG()}get mouseWheelZoomEnabled(){return this.actionMap.mouseWheel==="zoom"}set mouseWheelZoomEnabled(e){Xz(q.getLogger(this),"mouseWheelZoomEnabled",{replacement:"actionMap.mouseWheel",version:"4.32",warnOnce:!0}),this.actionMap.mouseWheel=e?"zoom":"none"}};c([d({type:bA,nonNullable:!0})],_u.prototype,"actionMap",void 0),c([d({type:Boolean})],_u.prototype,"browserTouchPanEnabled",void 0),c([d({type:YG,nonNullable:!0})],_u.prototype,"gamepad",void 0),c([d({type:Boolean})],_u.prototype,"momentumEnabled",void 0),c([d({type:Boolean})],_u.prototype,"mouseWheelZoomEnabled",null),_u=c([C("esri.views.navigation.Navigation")],_u);const E2=_u;function R5e(t,e,r){const i=XG(t),s=e,n=Jde(i,s,r);if(i){const o=Ai.deriveUnitFromSR(i,t.spatialReference).heightUnit;if(!r&&o!==i.heightUnit){const a=new F("layerview:unmatched-height-unit",`The vertical units of the layer must match the horizontal units (${o})`,{horizontalUnit:o});return new F("layerview:unsupported-height-model-info","The vertical coordinate system of the layer is not supported",{heightModelInfo:i,error:a})}}if(!Yde(t)||n===ss.Unsupported)return new F("layerview:unsupported-height-model-info","The vertical coordinate system of the layer is not supported",{heightModelInfo:i});switch(n){case ss.Units:{const o=i?.heightUnit||"unknown",a=s?.heightUnit||"unknown",l=new F("layerview:incompatible-height-unit",`The vertical units of the layer (${o}) must match the vertical units of the scene (${a})`,{layerUnit:o,sceneUnit:a});return new F("layerview:incompatible-height-model-info","The vertical coordinate system of the layer is incompatible with the scene",{layerHeightModelInfo:i,sceneHeightModelInfo:s,error:l})}case ss.HeightModel:{const o=i?.heightModel||"unknown",a=s?.heightModel||"unknown",l=new F("layerview:incompatible-height-model",`The height model of the layer (${o}) must match the height model of the scene (${a})`,{layerHeightModel:o,sceneHeightModel:a});return new F("layerview:incompatible-height-model-info","The vertical coordinate system of the layer is incompatible with the scene",{layerHeightModelInfo:i,sceneHeightModelInfo:s,error:l})}case ss.CRS:{const o=i?.vertCRS||"unknown",a=s?.vertCRS||"unknown",l=new F("layerview:incompatible-vertical-datum",`The vertical datum of the layer (${o}) must match the vertical datum of the scene (${a})`,{layerDatum:o,sceneDatum:a});return new F("layerview:incompatible-height-model-info","The vertical coordinate system of the layer is incompatible with the scene",{layerHeightModelInfo:i,sceneHeightModelInfo:s,error:l})}}return null}function Jde(t,e,r){if(!cN(t)||!cN(e))return ss.Unsupported;if(t==null||e==null)return ss.Ok;if(!r&&t.heightUnit!==e.heightUnit)return ss.Units;if(t.heightModel!==e.heightModel)return ss.HeightModel;switch(t.heightModel){case"gravity-related-height":return ss.Ok;case"ellipsoidal":return t.vertCRS===e.vertCRS?ss.Ok:ss.CRS;default:return ss.Unsupported}}var ss;function cN(t){return t==null||t.heightModel!=null&&t.heightUnit!=null}function Yde(t){return"heightModelInfo"in t&&t.heightModelInfo!=null||t.spatialReference!=null||!e7(t)}function XG(t){if(t.type==="integrated-mesh-3dtiles")return null;const e=t.url?vc(t.url):void 0;return!(t.spatialReference?.vcsWkid==null&&e!=null&&e.serverType==="ImageServer")&&KG(t)&&t.heightModelInfo?t.heightModelInfo:e7(t)?Ai.deriveUnitFromSR(Kde,t.spatialReference):null}function KG(t){return"heightModelInfo"in t}function QG(t){if(t.type==="unknown"||!("capabilities"in t))return!1;switch(t.type){case"catalog":case"catalog-footprint":case"csv":case"feature":case"geojson":case"subtype-group":case"ogc-feature":case"oriented-imagery":case"wfs":case"knowledge-graph-sublayer":return!0;default:return!1}}function e7(t){return QG(t)?!!(t.capabilities&&t.capabilities.data&&t.capabilities.data.supportsZ):t7(t)}function Xde(t){return t.layers!=null||t7(t)||QG(t)||KG(t)}function t7(t){switch(t.type){case"building-scene":case"elevation":case"integrated-mesh":case"integrated-mesh-3dtiles":case"point-cloud":case"scene":case"voxel":return!0;case"base-dynamic":case"base-elevation":case"base-tile":case"bing-maps":case"catalog":case"catalog-footprint":case"catalog-dynamic-group":case"csv":case"dimension":case"geojson":case"feature":case"subtype-group":case"geo-rss":case"graphics":case"group":case"imagery":case"imagery-tile":case"kml":case"knowledge-graph":case"link-chart":case"knowledge-graph-sublayer":case"line-of-sight":case"map-image":case"map-notes":case"media":case"ogc-feature":case"open-street-map":case"oriented-imagery":case"parquet":case"route":case"stream":case"tile":case"unknown":case"unsupported":case"vector-tile":case"video":case"viewshed":case"wcs":case"web-tile":case"wfs":case"wms":case"wmts":case null:return!1}return!1}(function(t){t[t.Ok=0]="Ok",t[t.Units=1]="Units",t[t.HeightModel=2]="HeightModel",t[t.CRS=3]="CRS",t[t.Unsupported=4]="Unsupported"})(ss||(ss={}));const Kde=new Ai({heightModel:"gravity-related-height"});var Dw;(function(t){t[t.Global=1]="Global",t[t.Local=2]="Local"})(Dw||(Dw={}));let cI,r$=null;async function Qde(t){r$||(r$=J(()=>import("./geometryServiceUtils-BFZpQDam.js"),__vite__mapDeps([170,171])).then((e=>cI=e))),await r$,xt(t)}async function r7(t,e,r,i){if(!t)return null;const s=t.spatialReference;return Bl()||gn(s,e)?bc(t,e):cI?cI.projectGeometry(t,e,r,i):(await Promise.race([Qde(i),Vl(i)]),r7(t,e,r,i))}async function k5e(t,e){try{return t?.spatialReference?await RU(t,e):null}catch{return null}}let dt=class extends ce{constructor(e){super(e),this.required={extent:!1,heightModelInfo:!1,tileInfo:!1},this.defaultSpatialReference=null,this.userSpatialReference=null,this.sourcePreloadCount=10,this.priorityCollection=null,this.requiresExtentInSpatialReference=!0,this.suspended=!1,this._projectExtentTask={task:null,input:null,output:null,spatialReference:null}}destroy(){this._projectExtentTask.task&&(this._projectExtentTask.task=im(this._projectExtentTask.task)),this._set("map",null)}get ready(){return!this._spatialReferenceTask.updating&&!this._tileInfoTask.updating&&!this._extentTask.updating}get heightModelInfoReady(){return!this._heightModelInfoTask.updating}get spatialReference(){return this.userSpatialReference??this._spatialReferenceTask.spatialReference}get extent(){return this._extentTask.extent}get heightModelInfo(){return this._heightModelInfoTask.heightModelInfo}get vcsWkid(){return this._heightModelInfoTask.vcsWkid}get latestVcsWkid(){return this._heightModelInfoTask.latestVcsWkid}get viewingMode(){return this.userSpatialReference==null||this.userSpatialReference.equals(this._spatialReferenceTask.spatialReference)?this._spatialReferenceTask.viewingMode:null}get tileInfo(){return this._tileInfoTask.tileInfo}get mapCollections(){const e=this.map?.(),r=[];return this.priorityCollection!=null&&r.push(this.priorityCollection),r.push({parent:e?.basemap,layers:e?.basemap?.baseLayers},{layers:e?.layers},{parent:e?.ground,layers:e?.ground?.layers},{parent:e?.basemap,layers:e?.basemap?.referenceLayers}),r}get _spatialReferenceTask(){if(this.suspended)return this._get("_spatialReferenceTask")??{updating:!1};let e;if(this._collectLayers(this.mapCollections,(i=>{const s=this._getSupportedSpatialReferences(i);if(s.length>0){const n=this._narrowDownSpatialReferenceCandidates(e,s);n!=null&&(e=n)}return e?.length===1}))&&e?.length!==1)return{updating:!0};const r=this._pickSpatialReferenceCandidate(e);return{spatialReference:r?.spatialReference??null,viewingMode:r?.viewingMode??null,updating:!1}}get _tileInfoTask(){if(!this.required.tileInfo)return this._get("_tileInfoTask")??{updating:!1};const e=this.map?.(),r=this.spatialReference;if(!r)return{updating:this._spatialReferenceTask.updating};let i;const s=this._collectLayers([{parent:e?.basemap,layers:e?.basemap?.baseLayers},{layers:e?.layers}],(n=>!(!("tileInfo"in n)||!n.tileInfo?.spatialReference.equals(r))&&(i=n,!0)),(n=>"tileInfo"in n));return i?{tileInfo:i.tileInfo,updating:!1}:{updating:s}}get _heightModelInfoTask(){if(!this.required.heightModelInfo||this.suspended&&this._get("_heightModelInfoTask")?.heightModelInfo)return this._get("_heightModelInfoTask")??{updating:!1};let e={};const r=this._collectLayers(this.mapCollections,(i=>{const s=XG(i);return!!s&&(e={heightModelInfo:s,vcsWkid:i.spatialReference?.vcsWkid,latestVcsWkid:i.spatialReference?.latestVcsWkid},!0)}),(i=>Xde(i)));return{...e,updating:r}}get _extentCandidatesTask(){if(this.suspended||!this.required.extent)return this._get("_extentCandidatesTask")??{updating:!1};if(!this.spatialReference)return{updating:this._spatialReferenceTask.updating};const e=[],r=this._collectLayers(this.mapCollections,(i=>{const s="fullExtents"in i&&i.fullExtents||(i.fullExtent!=null?[i.fullExtent]:[]),n=this.requiresExtentInSpatialReference?null:s[0],o=s.find((a=>a.spatialReference.equals(this.spatialReference)))??n;if(o)return e.push({extent:o,layer:i}),!0;if(this._getSupportedSpatialReferences(i).length>0)for(const a of s)e.push({extent:a,layer:i});return!1}));return{candidates:e,updating:r}}get _extentTask(){const{candidates:e,updating:r}=this._extentCandidatesTask;if(r)return{updating:r};if(e==null||e.length===0)return{updating:!1};if(!this.spatialReference)return{updating:this._spatialReferenceTask.updating};const i=this._pickExtentCandidate(e),s=this.spatialReference;return i.extent.equals(this._projectExtentTask.input)&&s.equals(this._projectExtentTask.spatialReference)?{extent:this._projectExtentTask.output,updating:this._projectExtentTask.task!=null&&!this._projectExtentTask.task.finished}:(this._projectExtentTask.task!=null&&(this._projectExtentTask.task=im(this._projectExtentTask.task)),this._projectExtentTask={input:i.extent.clone(),output:null,spatialReference:s.clone(),task:YS((async n=>{try{const o=await r7(i.extent,s,"portalItem"in i.layer?i.layer.portalItem:void 0,n);this._projectExtentTask={...this._projectExtentTask,task:null,output:o}}catch{if(yn(n))return;this._projectExtentTask={...this._projectExtentTask,task:null}}}))},{updating:!0})}_narrowDownSpatialReferenceCandidates(e,r){if(e==null)return r;const i=new Array;for(const s of e)for(const n of r){if(!s.spatialReference.equals(n.spatialReference))continue;const o=tpe(s.viewingMode,n.viewingMode);if(o!==!1){i.push({spatialReference:s.spatialReference,viewingMode:o});break}}return i.length>0?i:null}_pickSpatialReferenceCandidate(e){const r=this.defaultSpatialReference;return e==null||e.length<1?r?{spatialReference:r,viewingMode:null}:null:(r!=null&&e.length>1&&e.some((({spatialReference:i})=>i.equals(r)))&&(e=e.filter((({spatialReference:i})=>i.equals(r)))),e.length>1&&e.some((({viewingMode:i})=>i!==Dw.Local))&&(e=e.filter((({viewingMode:i})=>i!==Dw.Local))),e[0])}_getSupportedSpatialReferences(e){const r="supportedSpatialReferences"in e&&e.supportedSpatialReferences||(e.spatialReference?[e.spatialReference]:[]);if(r.length===0)return[];const i=[];for(const s of r){const n=this.getSpatialReferenceSupport(s,e);if(n!=null){const o=n.constraints??[{spatialReference:s,viewingMode:null}];for(const{spatialReference:a,viewingMode:l}of o)this.requiresExtentInSpatialReference&&this.userSpatialReference!=null&&!a.equals(this.userSpatialReference)||i.push({spatialReference:a,viewingMode:l})}}return i}_pickExtentCandidate(e){const r=this.spatialReference;return e.find((({extent:i})=>r.equals(i.spatialReference)))||e[0]}_collectLayers(e,r,i=()=>!0){switch(this._loadMaybe(this.map?.())){case"loading":return!0;case"failed":return!1}const s=new epe(i,r);for(const n of e)if(this._collectCollection(n,s),s.done||s.preloading===this.sourcePreloadCount)break;return s.updating}_collectCollection(e,r){if(e.layers){switch(this._loadMaybe(e.parent)){case"loading":return r.updating=!0,void++r.preloading;case"failed":return}for(const i of e.layers)if(r.layerFilter(i)){switch(this._loadMaybe(i)){case"failed":continue;case"loading":r.updating=!0,++r.preloading;break;case"loaded":if(r.updating||(r.done=r.pushLayer(i)),r.done||r.preloading===this.sourcePreloadCount)break;"layers"in i&&this._collectCollection({layers:i.layers},r)}if(r.done||r.preloading===this.sourcePreloadCount)break}}}_loadMaybe(e){return e&&"loadStatus"in e&&e.loadStatus!=null?e.loadStatus==="not-loaded"?(e.load().catch((r=>{xi(r)})),"loading"):e.loadStatus:"loaded"}};c([d()],dt.prototype,"required",void 0),c([d({constructOnly:!0})],dt.prototype,"map",void 0),c([d({constructOnly:!0})],dt.prototype,"getSpatialReferenceSupport",void 0),c([d()],dt.prototype,"defaultSpatialReference",void 0),c([d()],dt.prototype,"userSpatialReference",void 0),c([d()],dt.prototype,"sourcePreloadCount",void 0),c([d()],dt.prototype,"priorityCollection",void 0),c([d()],dt.prototype,"requiresExtentInSpatialReference",void 0),c([d()],dt.prototype,"suspended",void 0),c([d({readOnly:!0})],dt.prototype,"ready",null),c([d({readOnly:!0})],dt.prototype,"heightModelInfoReady",null),c([d({readOnly:!0})],dt.prototype,"spatialReference",null),c([d({readOnly:!0})],dt.prototype,"extent",null),c([d({readOnly:!0})],dt.prototype,"heightModelInfo",null),c([d({readOnly:!0})],dt.prototype,"vcsWkid",null),c([d({readOnly:!0})],dt.prototype,"latestVcsWkid",null),c([d({readOnly:!0})],dt.prototype,"viewingMode",null),c([d({readOnly:!0})],dt.prototype,"tileInfo",null),c([d({readOnly:!0})],dt.prototype,"mapCollections",null),c([d({readOnly:!0})],dt.prototype,"_spatialReferenceTask",null),c([d({readOnly:!0})],dt.prototype,"_tileInfoTask",null),c([d({readOnly:!0})],dt.prototype,"_heightModelInfoTask",null),c([d({readOnly:!0})],dt.prototype,"_extentCandidatesTask",null),c([d()],dt.prototype,"_extentTask",null),c([d()],dt.prototype,"_projectExtentTask",void 0),dt=c([C("esri.views.support.DefaultsFromMap")],dt);let epe=class{constructor(e,r){this.layerFilter=e,this.pushLayer=r,this.preloading=-1,this.updating=!1,this.done=!1}};function tpe(t,e){return t!=null?e!=null?t===e&&t:t:e}function rpe(t){return"tryRecycleWith"in t}let ipe=class{constructor(e,r,i){this.layer=e,this.view=r,this.layerViewImporter=i,this._controller=new AbortController,this._deferred=Ns(),this._started=!1,this.done=!1,this.promise=this._deferred.promise,ao(this._controller.signal,(()=>{this._recycleController?.abort();const s=new F("cancelled:layerview-create","layerview creation cancelled",{layer:e});this._deferred.reject(s)}))}tryRecycle(e){if(!this.done||!this.layerView||!rpe(this.layerView))return null;this._recycleController?.abort(),this._recycleController=new AbortController;const r=this.layer.type,i=this._recycleController.signal;for(let s=0;s<e.length;s++){const n=e[s];if(n.type!==r)continue;const o=this.layerView.tryRecycleWith(n,{signal:i});if(o){e.splice(s,1),this.layer=n;const a=this.layerView,l=a.view;return this.promise=o.then((()=>(xt(i),n.emit("layerview-destroy",{view:l,layerView:a}),l.emit("layerview-destroy",{view:l,layerView:a}),n.emit("layerview-create",{view:l,layerView:a}),l.emit("layerview-create",{view:l,layerView:a}),a))),this.promise}}return null}destroy(){this._controller.abort();const{layerView:e}=this;if(e){const{layer:r,view:i}=this;r.emit("layerview-destroy",{view:i,layerView:e}),i.emit("layerview-destroy",{layer:r,layerView:e})}this.done=!0,this.layer=null,this.layerView=null,this.view=null,this.layerViewImporter=null,this._map=null,this.promise=null,this._deferred=null}async start(){const{view:e}=this;if(this._started||!e.map)return;this._started=!0;const{_controller:{signal:r},layer:i}=this;this._map=e.map;try{let s,n;if(await i.load({signal:r}),i.prefetchResources&&await i.prefetchResources({signal:r}),spe(i))s=await i.createLayerView(e,{signal:r});else{if(!this.layerViewImporter.hasLayerViewModule(i))throw new F("layer:view-not-supported","No layerview implementation was found");const l=await this.layerViewImporter.importLayerView(i);xt(r),s="default"in l?new l.default({layer:i,view:e}):new l({layer:i,view:e})}const o=()=>{n=Lt(n),s.destroyed||s.destroy(),s.layer=null,s.parent=null,s.view=null,this.done=!0};n=ao(r,o),xt(r);try{await s.when()}catch(l){throw o(),l}if(!this._map?.allLayers?.includes(i))return o(),void this._deferred.reject(new F("view:no-layerview-for-layer","The layer has been removed from the map",{layer:i}));this.layerView=s,i.emit("layerview-create",{view:e,layerView:s}),e.emit("layerview-create",{layer:i,layerView:s}),this.done=!0,this._deferred.resolve(s)}catch(s){i.emit("layerview-create-error",{view:e,error:s}),e.emit("layerview-create-error",{layer:i,error:s}),this.done=!0,this._deferred.reject(new F("layerview:create-error","layerview creation failed",{layer:i,error:s}))}}};function spe(t){return t.createLayerView!==kt.prototype.createLayerView}function npe(t){return t!=null&&typeof t=="object"&&"layerViews"in t}let ws=class extends ce{constructor(e){super(e),this._layerLayerViewInfoMap=new Map,this._recyclingInfoMap=new Map,this._watchUpdatingTracking=new Xh,this.supportsGround=!0,this._preloadLayerViewModules=()=>{const r=this.view.map?.allLayers;if(r)for(const i of r)this.layerViewFilter?.(i)!==!1&&this.layerViewImporter.hasLayerViewModule(i)&&this.layerViewImporter.importLayerView(i)},this._reschedule=()=>this.destroyed?Promise.reject():(this._workPromise==null&&(this._workPromise=Ns(),this._workPromise.promise.catch((()=>{}))),this.removeHandles("reschedule"),this.addHandles(bv(this._doWork),"reschedule"),this._workPromise.promise),this._doWork=()=>{const r=this.view.map;if(this.destroyed||!r)return void this.clear();if(this._map!==r&&(this.clear(),this._map=r),this._workPromise==null)return void this.notifyChange("updating");this.removeHandles("reschedule"),this.removeHandles("collection-change");const i=new Set,s=[],n=this.view.ready,o=h=>{if(h!=null){for(const p of h)if(p){if(this.layerViewFilter?.(p)===!1)continue;i.add(p);const m=this._layerLayerViewInfoMap.get(p);m&&n?m.start():m||this._recyclingInfoMap.has(p)||s.push(p),"layers"in p&&p.layers&&o(p.layers)}}};for(const h of this._rootCollectionNames)o(un(this,h));const a=new Array,l=h=>{const p=h.tryRecycle(s);p?(this._recyclingInfoMap.set(h.layer,h),this.notifyChange("updating"),p.then((()=>{this._recyclingInfoMap.delete(h.layer),this._layerLayerViewInfoMap.set(h.layer,h),this._reschedule(),this.notifyChange("updating")})).catch((m=>{xi(m)||(this._recyclingInfoMap.delete(h.layer),h.destroy(),this._reschedule(),this.notifyChange("updating"))}))):a.push(h)};for(const h of this._layerLayerViewInfoMap.values())i.has(h.layer)||(this._layerLayerViewInfoMap.delete(h.layer),l(h));for(const h of this._recyclingInfoMap.values())i.has(h.layer)||(this._recyclingInfoMap.delete(h.layer),l(h));for(const h of s)this._createLayerView(h);this._refreshCollections(),a.forEach((h=>h.destroy()));const u=[r?.ground?.layers,r?.basemap?.baseLayers,r?.basemap?.referenceLayers,r?.layers].filter((h=>!!h));i.forEach((h=>"layers"in h&&u.push(h.layers))),this.addHandles(u.map((h=>this._watchUpdatingTracking.addOnCollectionChange((()=>h),this._reschedule))),"collection-change"),this._workPromise.resolve(),this._workPromise=null}}initialize(){this.addHandles([so((()=>this.view?.map?.allLayers),"change",this._preloadLayerViewModules,{onListenerAdd:this._preloadLayerViewModules}),ie((()=>{const e=this.view,r=e?.map;return[r?.basemap,r?.ground,r?.layers,e?.ready]}),(()=>this._reschedule()),Oi)]),this._preloadLayerViewModules(),this._reschedule()}destroy(){this.clear(),Fx(this._recyclingInfoMap),Fx(this._layerLayerViewInfoMap),this._watchUpdatingTracking.destroy(),this._map=null,this._workPromise!=null&&(this._workPromise.reject(St()),this._workPromise=null)}get _layersToLayerViews(){const e=[["view.map.basemap.baseLayers","view.basemapView.baseLayerViews"],["view.map.layers","view.layerViews"],["view.map.basemap.referenceLayers","view.basemapView.referenceLayerViews"]];return this.supportsGround&&e.push(["view.map.ground.layers","view.groundView.layerViews"]),new Map(e)}get _rootCollectionNames(){return Array.from(this._layersToLayerViews.keys())}get updating(){return this._workPromise!=null||this._watchUpdatingTracking.updating||bX(this._layerLayerViewInfoMap,(e=>!e.done))||this._recyclingInfoMap.size>0}get updatingRemaining(){let e=0;for(const r of this._layerLayerViewInfoMap.values())r.done||++e;return e}clear(){this.destroyed||(this._clearCollections(),Fx(this._layerLayerViewInfoMap))}async whenLayerView(e){if(await this._reschedule(),!this._layerLayerViewInfoMap.has(e)){if(this._recyclingInfoMap.has(e))return this._recyclingInfoMap.get(e).promise;throw new F("view:no-layerview-for-layer","No layerview has been found for the layer",{layer:e})}return this._layerLayerViewInfoMap.get(e).promise}isCreatingLayerViewsForLayer(e,r){this.commitProperty("updatingRemaining");const i=this._layerLayerViewInfoMap.get(e);if(!i?.done)return!0;const s=i.layerView;return!(!s||!r||s.parent===r)||!!(i.done&&s&&"layers"in e&&e.layers?.length)&&e.layers.some((n=>this.isCreatingLayerViewsForLayer(n,s)))}_refreshCollections(){for(const[e,r]of this._layersToLayerViews)this._populateLayerViewsOwners(un(this,e),un(this,r),this.view);this.notifyChange("updating"),this.notifyChange("updatingRemaining")}_clearCollections(){for(const e of this._layersToLayerViews.values())un(this,e)?.removeAll()}_populateLayerViewsOwners(e,r,i){if(!e||!r)return void r?.removeAll();let s=0;for(const n of e){const o=this._layerLayerViewInfoMap.get(n);if(!o?.layerView)continue;const a=o.layerView;a.layer=n,a.parent=i,r.at(s)!==a&&r.splice(s,0,a),"layers"in n&&npe(a)&&this._populateLayerViewsOwners(n.layers,a.layerViews,a),s+=1}s<r.length&&r.splice(s)}_createLayerView(e){e.load().catch((()=>{})),this.layerViewImporter.hasLayerViewModule(e)&&this.layerViewImporter.importLayerView(e);const r=new ipe(e,this.view,this.layerViewImporter);r.promise.then((()=>this._refreshCollections()),(i=>{i&&(xi(i)||i.name==="cancelled:layerview-create")||q.getLogger(this).error(`Failed to create layerview for layer title:'${e.title??"no title"}', id:'${e.id??"no id"}' of type '${e.type}'.`,{layer:e,error:i}),this._refreshCollections()})),this._layerLayerViewInfoMap.set(e,r),this.view.ready&&r.start(),this.notifyChange("updating"),this.notifyChange("updatingRemaining")}};c([d()],ws.prototype,"_workPromise",void 0),c([d({readOnly:!0})],ws.prototype,"_watchUpdatingTracking",void 0),c([d({readOnly:!0})],ws.prototype,"_layersToLayerViews",null),c([d({readOnly:!0})],ws.prototype,"_rootCollectionNames",null),c([d({constructOnly:!0})],ws.prototype,"layerViewFilter",void 0),c([d()],ws.prototype,"layerViewImporter",void 0),c([d()],ws.prototype,"supportsGround",void 0),c([d({readOnly:!0})],ws.prototype,"updating",null),c([d({readOnly:!0})],ws.prototype,"updatingRemaining",null),c([d({constructOnly:!0})],ws.prototype,"view",void 0),ws=c([C("esri.views.support.LayerViewManager")],ws);const ope=ws;let yp=class extends ce{constructor(e){super(e),this.featureTitleFields=!1,this.utilityNetworkFields=!1,this.globalIdField=!1}};c([d()],yp.prototype,"featureTitleFields",void 0),c([d()],yp.prototype,"utilityNetworkFields",void 0),c([d()],yp.prototype,"globalIdField",void 0),yp=c([C("esri.views.support.RequiredFieldsOptions")],yp);const ape=yp;var yg,nd;let pe=(nd=class extends Ca.EventedMixin(Tl.EsriPromiseMixin(ce)){constructor(e){super(e),this._userSpatialReference=null,this._cursor=null,this.handles=new Rm,this.updatingHandles=new Xh,this.allLayerViews=new Vo({getCollections:()=>[this.basemapView?.baseLayerViews,this.groundView?.layerViews,this.layerViews,this.basemapView?.referenceLayerViews],getChildrenFunction:upe}),this.analyses=new Rw,this.basemapView=null,this.displayFilterEnabled=!0,this.fatalError=null,this.graphics=new h0,this.groundView=null,this.typeSpecificPreconditionsReady=!0,this.layerViews=new se,this.magnifier=new DG,this.padding={left:0,top:0,right:0,bottom:0},this.ready=!1,this._readyStateWaitingTask=null,this.supportsGround=!0,this.type=null,this.scale=null,this.updating=!1,this.initialExtentRequired=!0,this.input=new Zde,this.navigation=new E2,this.layerViewManager=null,this.analysisViewManager=null,this.isHeightModelInfoRequired=!1,this.width=null,this.height=null,this.resizing=!1,this.suspended=!1,this.viewEvents=new GG(this),this.persistableViewModels=new se,this.requiredFieldsOptions=new ape,this._isValid=!1,this._readyCycleForced=!1,this._lockedSpatialReference=null,this._userTimeZone=null,this._lockedTimeZone=null,this._userTimeExtent=null,this._lockedTimeExtent=null,this.theme=null,this.handles.add(ie((()=>this.preconditionsReady),(r=>{const i=this.ready;if(r?(this._lockedSpatialReference=this.spatialReference,this._lockedTimeZone=this.timeZone,this._lockedTimeExtent=this.timeExtent,yg.views.add(this)):(this._lockedSpatialReference=null,yg.views.remove(this)),this.notifyChange("spatialReference"),!r&&i)this.toolViewManager?.detach(),this.analysisViewManager!=null&&this.analysisViewManager.detach(),this.layerViewManager?.clear(),this._teardown();else if(r&&!i){try{this._startup()}catch(s){return void queueMicrotask((()=>{this.fatalError=new F("view:startup-error","View._startup failed",s)}))}this.analysisViewManager!=null&&this.analysisViewManager.attach(),this.toolViewManager.attach()}}),Ma))}initialize(){this.addResolvingPromise(Promise.all([this.loadAsyncDependencies(),this.validate()]).then((()=>(this._isValid=!0,Ev((()=>this.ready)))))),this.basemapView=new rde({view:this}),this.layerViewManager=new ope({view:this,layerViewFilter:e=>this.layerViewFilter?.(e)??!0,layerViewImporter:{importLayerView:e=>this.importLayerView(e),hasLayerViewModule:e=>this.hasLayerViewModule(e)},supportsGround:this.supportsGround}),this.toolViewManager=new xo({view:this}),this.selectionManager=new pde({view:this}),this.addHandles([fs((()=>this.readyState==="map-content-error"&&!this.spatialReference),(()=>{q.getLogger(this).warn("#spatialReference","no spatial reference could be derived from the currently added map layers")})),ie((()=>this.initialExtentRequired),(e=>this.defaultsFromMap.required={...this.defaultsFromMap.required,extent:e}),Oi),ie((()=>this.ready),(e=>{this.defaultsFromMap&&(this.defaultsFromMap.suspended=e,this.defaultsFromMap.userSpatialReference=e?this.spatialReference:this._userSpatialReference)}),Ma),ie((()=>this._userSpatialReference),(e=>{this.defaultsFromMap&&(this.defaultsFromMap.userSpatialReference=e)}),Oi)])}destroy(){this.destroyed||(yg.views.remove(this),this.viewEvents.destroy(),this.allLayerViews.destroy(),this.navigation&&(this.navigation.destroy(),this._set("navigation",null)),this.graphics=At(this.graphics),this.analyses=At(this.analyses),this.defaultsFromMap.destroy(),this._set("defaultsFromMap",null),At(this.analysisViewManager),this.toolViewManager=At(this.toolViewManager),this.layerViewManager=At(this.layerViewManager),this.selectionManager=At(this.selectionManager),this.basemapView=At(this.basemapView),this.groundView?.destroy(),this.layerViews?.forEach((e=>e.destroy())),this.layerViews.length=0,this.invalidate(),this._emitter.clear(),this.handles.destroy(),this.map=At(this.map),this.updatingHandles.destroy())}_startup(){this._set("ready",!0)}_teardown(){this._set("ready",!1)}whenReady(){return Promise.resolve(this)}toMap(){return q.getLogger(this).error("#toMap()","Not implemented on this instance of View"),null}get activeTool(){return this.toolViewManager?.activeTool}set activeTool(e){this.toolViewManager&&(this.toolViewManager.activeTool=e)}get animation(){return this._get("animation")}set animation(e){this._set("animation",e)}get center(){return null}get defaultsFromMapSettings(){return{}}get defaultsFromMap(){return new dt({required:{tileInfo:!1,heightModelInfo:!1,extent:!1},map:()=>this.map,getSpatialReferenceSupport:(e,r)=>this.getSpatialReferenceSupport(e,r),...this.defaultsFromMapSettings})}get extent(){return this._get("extent")}set extent(e){this._set("extent",e)}get heightModelInfo(){return this.getDefaultHeightModelInfo()}get highlights(){return this._get("highlights")??Bde()}set highlights(e){this._set("highlights",zl(e,this._get("highlights"),se.ofType(ec)))}get interacting(){return this.navigating}get navigating(){return!1}get preconditionsReady(){return!this.destroying&&!this.destroyed&&!(this.fatalError||!this._isValid||this._readyCycleForced||!this.map||Ls.isLoadable(this.map)&&!this.map.loaded||this.width===0||this.height===0||!this.spatialReference||!this._validateSpatialReference(this.spatialReference)||!this._lockedSpatialReference&&!this.defaultsFromMap?.ready||!this.typeSpecificPreconditionsReady)}get resolution(){return 0}set map(e){e!==this._get("map")&&(e?.destroyed&&(q.getLogger(this).warn("#map","The provided map is already destroyed",{map:e}),e=null),Ls.isLoadable(e)&&e.load().catch((()=>{})),this.constructed&&!this.destroyed&&(this.forceReadyCycle(),this._lockedSpatialReference=null),this._set("map",e))}get readyState(){if(this.destroyed)return this._get("readyState");if(!this.map)return"missing-map";if("container"in this&&!this.container)return"missing-container";if(this.fatalError)return"rendering-error";if((this.defaultsFromMap?.ready??!1)&&!this.spatialReference){const e=!("loaded"in this.map)||this.map.loaded,r=this.map.ground.loaded,i=this.map.basemap?.loaded??!0;return e&&i&&r&&!this.map?.allLayers.length?"empty-map":(this._readyStateWaitingTask||(this._readyStateWaitingTask=YS((s=>Dz(z("view-readyState-waiting-delay"),null,s))),this.addHandles(this._readyStateWaitingTask),this.addHandles(this._readyStateWaitingTask,"ready-state-task")),this._readyStateWaitingTask?.finished?"map-content-error":"loading")}return this._readyStateWaitingTask=im(this._readyStateWaitingTask),this.removeHandles("ready-state-task"),this.ready?"ready":"loading"}get spatialReference(){const e=this._userSpatialReference||this._lockedSpatialReference||this.getDefaultSpatialReference()||null;if(e&&this.defaultsFromMap?.required?.heightModelInfo){const r=e.clone();return r.vcsWkid=this.defaultsFromMap.vcsWkid,r.latestVcsWkid=this.defaultsFromMap.latestVcsWkid,r}return e}set spatialReference(e){const r=!mr(e,this._get("spatialReference"));this._set("_userSpatialReference",e),r&&(this._set("spatialReference",e),this._spatialReferenceChanged(e))}_spatialReferenceChanged(e){}get stationary(){return!this.animation&&!this.navigating&&!this.resizing}get timeExtent(){return this._userTimeExtent??this._lockedTimeExtent??this.getDefaultTimeExtent()??null}set timeExtent(e){this._userTimeExtent=e}get timeZone(){return this._userTimeZone??this._lockedTimeZone??this.getDefaultTimeZone()??uo}set timeZone(e){this._userTimeZone=e,Rie(e)||q.getLogger(this).warn("#timeZone",`the parsed value '${e}' may not be a valid IANA time zone`)}get tools(){return this.toolViewManager?.tools}get initialExtent(){return this.defaultsFromMap?.extent}get cursor(){return this.toolViewManager?.cursor??this._cursor??"default"}set cursor(e){this._cursor=e,this.notifyChange("cursor")}get size(){return[this.width,this.height]}get effectiveTheme(){return this.theme??new oI}whenLayerView(e){return this.layerViewManager?.whenLayerView(e)??Promise.reject()}getDefaultSpatialReference(){return this.defaultsFromMap?.spatialReference}getDefaultHeightModelInfo(){return(this.map&&"heightModelInfo"in this.map?this.map.heightModelInfo:void 0)??this.defaultsFromMap?.heightModelInfo??null}getDefaultTimeZone(){return null}getDefaultTimeExtent(){return null}importLayerView(e){throw new F("view:importLayerView-missing","importLayerView() not implemented")}hasLayerViewModule(e){return!1}async validate(){}async loadAsyncDependencies(){}invalidate(){this._isValid=!1}getSpatialReferenceSupport(){return{constraints:null}}_validateSpatialReference(e){return this.getSpatialReferenceSupport(e)!=null}when(e,r){return this.isResolved()&&!this.ready&&q.getLogger(this).warn("#when()","Calling view.when() while the view is no longer ready but was already resolved once will resolve immediately. Use reactiveUtils.whenOnce(() => view.ready).then(...) instead."),super.when(e,r)}forceReadyCycle(){this.ready&&(fs((()=>this.destroyed||this.preconditionsReady===!1),(()=>this._readyCycleForced=!1),{once:!0}),this._readyCycleForced=!0)}addAndActivateTool(e){this.toolViewManager.tools.add(e),this.activeTool=e}tryFatalErrorRecovery(){this.fatalError=null}},yg=nd,nd.views=new se,nd);c([d()],pe.prototype,"_userSpatialReference",void 0),c([d()],pe.prototype,"activeTool",null),c([d({readOnly:!0})],pe.prototype,"allLayerViews",void 0),c([d(OO(Rw,"analyses"))],pe.prototype,"analyses",void 0),c([d()],pe.prototype,"animation",null),c([d()],pe.prototype,"basemapView",void 0),c([d()],pe.prototype,"center",null),c([d()],pe.prototype,"defaultsFromMapSettings",null),c([d()],pe.prototype,"defaultsFromMap",null),c([d()],pe.prototype,"displayFilterEnabled",void 0),c([d({type:Le})],pe.prototype,"extent",null),c([d()],pe.prototype,"fatalError",void 0),c([d(OO(h0,"graphics"))],pe.prototype,"graphics",void 0),c([d()],pe.prototype,"groundView",void 0),c([d({readOnly:!0,type:Ai})],pe.prototype,"heightModelInfo",null),c([d({type:se.ofType(ec)})],pe.prototype,"highlights",null),c([d({readOnly:!0})],pe.prototype,"interacting",null),c([d({constructOnly:!0})],pe.prototype,"layerViewFilter",void 0),c([d({readOnly:!0})],pe.prototype,"navigating",null),c([d({readOnly:!0,dependsOn:["fatalError","_isValid","_readyCycleForced","map","map.loaded?","width","height","spatialReference","_lockedSpatialReference","defaultsFromMap.ready","typeSpecificPreconditionsReady"]})],pe.prototype,"preconditionsReady",null),c([d({readOnly:!0})],pe.prototype,"typeSpecificPreconditionsReady",void 0),c([d({type:se,readOnly:!0})],pe.prototype,"layerViews",void 0),c([d()],pe.prototype,"resolution",null),c([d({type:DG})],pe.prototype,"magnifier",void 0),c([d({value:null,type:m9})],pe.prototype,"map",null),c([d()],pe.prototype,"padding",void 0),c([d({readOnly:!0})],pe.prototype,"ready",void 0),c([d()],pe.prototype,"_readyStateWaitingTask",void 0),c([d({readOnly:!0})],pe.prototype,"readyState",null),c([d({type:ne})],pe.prototype,"spatialReference",null),c([d()],pe.prototype,"stationary",null),c([d({readOnly:!0})],pe.prototype,"supportsGround",void 0),c([d({type:fr})],pe.prototype,"timeExtent",null),c([d({type:String,nonNullable:!0})],pe.prototype,"timeZone",null),c([d()],pe.prototype,"tools",null),c([d()],pe.prototype,"toolViewManager",void 0),c([d({readOnly:!0})],pe.prototype,"type",void 0),c([d({type:Number})],pe.prototype,"scale",void 0),c([d({readOnly:!0})],pe.prototype,"updating",void 0),c([d({readOnly:!0})],pe.prototype,"initialExtentRequired",void 0),c([d({readOnly:!0})],pe.prototype,"initialExtent",null),c([d()],pe.prototype,"cursor",null),c([d({readOnly:!0})],pe.prototype,"input",void 0),c([d({type:E2,nonNullable:!0})],pe.prototype,"navigation",void 0),c([d()],pe.prototype,"layerViewManager",void 0),c([d()],pe.prototype,"analysisViewManager",void 0),c([d()],pe.prototype,"selectionManager",void 0),c([d()],pe.prototype,"width",void 0),c([d()],pe.prototype,"height",void 0),c([d({readOnly:!0})],pe.prototype,"resizing",void 0),c([d({value:null,readOnly:!0})],pe.prototype,"size",null),c([d({readOnly:!0})],pe.prototype,"suspended",void 0),c([d({readOnly:!0})],pe.prototype,"viewEvents",void 0),c([d({readOnly:!0})],pe.prototype,"persistableViewModels",void 0),c([d()],pe.prototype,"_isValid",void 0),c([d()],pe.prototype,"_readyCycleForced",void 0),c([d()],pe.prototype,"_lockedSpatialReference",void 0),c([d()],pe.prototype,"_userTimeZone",void 0),c([d()],pe.prototype,"_lockedTimeZone",void 0),c([d()],pe.prototype,"_userTimeExtent",void 0),c([d()],pe.prototype,"_lockedTimeExtent",void 0),c([d({type:oI})],pe.prototype,"theme",void 0),c([d({readOnly:!0,type:oI})],pe.prototype,"effectiveTheme",null),pe=yg=c([C("esri.views.View")],pe);const i$=globalThis.$arcgis;i$&&!i$.views&&Object.defineProperty(i$,"views",{configurable:!1,enumerable:!0,writable:!1,value:pe.views});const lpe=pe;function upe(t){return t.layerViews}function Tf(t,e){return t[0]=e[0],t[1]=e[1],t}function tr(t,e,r){return t[0]=e,t[1]=r,t}function i7(t,e,r){return t[0]=e[0]+r[0],t[1]=e[1]+r[1],t}function B0(t,e,r){return t[0]=e[0]-r[0],t[1]=e[1]-r[1],t}function s7(t,e,r){return t[0]=e[0]*r[0],t[1]=e[1]*r[1],t}function n7(t,e,r){return t[0]=e[0]/r[0],t[1]=e[1]/r[1],t}function cpe(t,e){return t[0]=Math.ceil(e[0]),t[1]=Math.ceil(e[1]),t}function hpe(t,e){return t[0]=Math.floor(e[0]),t[1]=Math.floor(e[1]),t}function dpe(t,e,r){return t[0]=Math.min(e[0],r[0]),t[1]=Math.min(e[1],r[1]),t}function ppe(t,e,r){return t[0]=Math.max(e[0],r[0]),t[1]=Math.max(e[1],r[1]),t}function fpe(t,e){return t[0]=Math.round(e[0]),t[1]=Math.round(e[1]),t}function Dv(t,e,r){return t[0]=e[0]*r,t[1]=e[1]*r,t}function mpe(t,e,r,i){return t[0]=e[0]+r[0]*i,t[1]=e[1]+r[1]*i,t}function I2(t,e){const r=e[0]-t[0],i=e[1]-t[1];return Math.sqrt(r*r+i*i)}function zw(t,e){const r=e[0]-t[0],i=e[1]-t[1];return r*r+i*i}function Vw(t){const e=t[0],r=t[1];return Math.sqrt(e*e+r*r)}function o7(t){const e=t[0],r=t[1];return e*e+r*r}function a7(t,e){return t[0]=-e[0],t[1]=-e[1],t}function ype(t,e){return t[0]=1/e[0],t[1]=1/e[1],t}function hI(t,e){const r=e[0],i=e[1];let s=r*r+i*i;return s>0&&(s=1/Math.sqrt(s),t[0]=e[0]*s,t[1]=e[1]*s),t}function l7(t,e){return t[0]*e[0]+t[1]*e[1]}function u7(t,e,r){const i=e[0]*r[1]-e[1]*r[0];return t[0]=t[1]=0,t[2]=i,t}function gpe(t,e,r,i){const s=e[0],n=e[1];return t[0]=s+i*(r[0]-s),t[1]=n+i*(r[1]-n),t}function vpe(t,e=1){const r=2*y2()*Math.PI;return t[0]=Math.cos(r)*e,t[1]=Math.sin(r)*e,t}function _pe(t,e,r){const i=e[0],s=e[1];return t[0]=r[0]*i+r[2]*s,t[1]=r[1]*i+r[3]*s,t}function vi(t,e,r){const i=e[0],s=e[1];return t[0]=r[0]*i+r[2]*s+r[4],t[1]=r[1]*i+r[3]*s+r[5],t}function bpe(t,e,r){const i=e[0],s=e[1];return t[0]=r[0]*i+r[3]*s+r[6],t[1]=r[1]*i+r[4]*s+r[7],t}function wpe(t,e,r){const i=e[0],s=e[1];return t[0]=r[0]*i+r[4]*s+r[12],t[1]=r[1]*i+r[5]*s+r[13],t}function Spe(t,e,r,i){const s=e[0]-r[0],n=e[1]-r[1],o=Math.sin(i),a=Math.cos(i);return t[0]=s*a-n*o+r[0],t[1]=s*o+n*a+r[1],t}function xpe(t,e){const r=t[0],i=t[1],s=e[0],n=e[1];let o=r*r+i*i;o>0&&(o=1/Math.sqrt(o));let a=s*s+n*n;a>0&&(a=1/Math.sqrt(a));const l=(r*s+i*n)*o*a;return l>1?0:l<-1?Math.PI:Math.acos(l)}function $pe(t){return"vec2("+t[0]+", "+t[1]+")"}function Mpe(t,e){return t[0]===e[0]&&t[1]===e[1]}function Tpe(t,e){const r=t[0],i=t[1],s=e[0],n=e[1],o=Gi();return Math.abs(r-s)<=o*Math.max(1,Math.abs(r),Math.abs(s))&&Math.abs(i-n)<=o*Math.max(1,Math.abs(i),Math.abs(n))}function Epe(t,e,r,i,s){let n=e[0]-r[0],o=e[1]-r[1];const a=(i[0]*n+i[1]*o)*(s-1);return n=i[0]*a,o=i[1]*a,t[0]=e[0]+n,t[1]=e[1]+o,t}const Ipe=Vw,wA=B0,Cpe=s7,Ppe=n7,Ape=I2,Lpe=zw,Rpe=o7;Object.freeze(Object.defineProperty({__proto__:null,add:i7,angle:xpe,ceil:cpe,copy:Tf,cross:u7,dist:Ape,distance:I2,div:Ppe,divide:n7,dot:l7,equals:Tpe,exactEquals:Mpe,floor:hpe,inverse:ype,len:Ipe,length:Vw,lerp:gpe,max:ppe,min:dpe,mul:Cpe,multiply:s7,negate:a7,normalize:hI,projectAndScale:Epe,random:vpe,rotate:Spe,round:fpe,scale:Dv,scaleAndAdd:mpe,set:tr,sqrDist:Lpe,sqrLen:Rpe,squaredDistance:zw,squaredLength:o7,str:$pe,sub:wA,subtract:B0,transformMat2:_pe,transformMat2d:vi,transformMat3:bpe,transformMat4:wpe},Symbol.toStringTag,{value:"Module"}));function Ut(){return[0,0]}function kpe(t){return[t[0],t[1]]}function zv(t,e){return[t,e]}function Ope(t,e){return[t,e]}function Npe(t,e=Ut()){const r=Math.min(2,t.length);for(let i=0;i<r;++i)e[i]=t[i];return e}function c7(){return Ut()}function h7(){return zv(1,1)}function d7(){return zv(1,0)}function p7(){return zv(0,1)}const Fpe=c7(),Dpe=h7(),zpe=d7(),Vpe=p7();Object.freeze(Object.defineProperty({__proto__:null,ONES:Dpe,UNIT_X:zpe,UNIT_Y:Vpe,ZEROS:Fpe,clone:kpe,create:Ut,freeze:Ope,fromArray:Npe,fromValues:zv,ones:h7,unitX:d7,unitY:p7,zeros:c7},Symbol.toStringTag,{value:"Module"}));function jpe(t,e){return t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3],t[4]=e[4],t[5]=e[5],t}function Vv(t){return t[0]=1,t[1]=0,t[2]=0,t[3]=1,t[4]=0,t[5]=0,t}function Upe(t,e,r,i,s,n,o){return t[0]=e,t[1]=r,t[2]=i,t[3]=s,t[4]=n,t[5]=o,t}function SA(t,e){const r=e[0],i=e[1],s=e[2],n=e[3],o=e[4],a=e[5];let l=r*n-i*s;return l?(l=1/l,t[0]=n*l,t[1]=-i*l,t[2]=-s*l,t[3]=r*l,t[4]=(s*a-n*o)*l,t[5]=(i*o-r*a)*l,t):null}function Gpe(t){return t[0]*t[3]-t[1]*t[2]}function jo(t,e,r){const i=e[0],s=e[1],n=e[2],o=e[3],a=e[4],l=e[5],u=r[0],h=r[1],p=r[2],m=r[3],y=r[4],g=r[5];return t[0]=i*u+n*h,t[1]=s*u+o*h,t[2]=i*p+n*m,t[3]=s*p+o*m,t[4]=i*y+n*g+a,t[5]=s*y+o*g+l,t}function pc(t,e,r){const i=e[0],s=e[1],n=e[2],o=e[3],a=e[4],l=e[5],u=Math.sin(r),h=Math.cos(r);return t[0]=i*h+n*u,t[1]=s*h+o*u,t[2]=i*-u+n*h,t[3]=s*-u+o*h,t[4]=a,t[5]=l,t}function jv(t,e,r){const i=e[0],s=e[1],n=e[2],o=e[3],a=e[4],l=e[5],u=r[0],h=r[1];return t[0]=i*u,t[1]=s*u,t[2]=n*h,t[3]=o*h,t[4]=a,t[5]=l,t}function ba(t,e,r){const i=e[0],s=e[1],n=e[2],o=e[3],a=e[4],l=e[5],u=r[0],h=r[1];return t[0]=i,t[1]=s,t[2]=n,t[3]=o,t[4]=i*u+n*h+a,t[5]=s*u+o*h+l,t}function C2(t,e){const r=Math.sin(e),i=Math.cos(e);return t[0]=i,t[1]=r,t[2]=-r,t[3]=i,t[4]=0,t[5]=0,t}function f7(t,e){return t[0]=e[0],t[1]=0,t[2]=0,t[3]=e[1],t[4]=0,t[5]=0,t}function xA(t,e){return t[0]=1,t[1]=0,t[2]=0,t[3]=1,t[4]=e[0],t[5]=e[1],t}function Bpe(t){return"mat2d("+t[0]+", "+t[1]+", "+t[2]+", "+t[3]+", "+t[4]+", "+t[5]+")"}function qpe(t){return Math.sqrt(t[0]**2+t[1]**2+t[2]**2+t[3]**2+t[4]**2+t[5]**2+1)}function Hpe(t,e,r){return t[0]=e[0]+r[0],t[1]=e[1]+r[1],t[2]=e[2]+r[2],t[3]=e[3]+r[3],t[4]=e[4]+r[4],t[5]=e[5]+r[5],t}function m7(t,e,r){return t[0]=e[0]-r[0],t[1]=e[1]-r[1],t[2]=e[2]-r[2],t[3]=e[3]-r[3],t[4]=e[4]-r[4],t[5]=e[5]-r[5],t}function Wpe(t,e,r){return t[0]=e[0]*r,t[1]=e[1]*r,t[2]=e[2]*r,t[3]=e[3]*r,t[4]=e[4]*r,t[5]=e[5]*r,t}function Zpe(t,e,r,i){return t[0]=e[0]+r[0]*i,t[1]=e[1]+r[1]*i,t[2]=e[2]+r[2]*i,t[3]=e[3]+r[3]*i,t[4]=e[4]+r[4]*i,t[5]=e[5]+r[5]*i,t}function Jpe(t,e){return t[0]===e[0]&&t[1]===e[1]&&t[2]===e[2]&&t[3]===e[3]&&t[4]===e[4]&&t[5]===e[5]}function Ype(t,e){const r=t[0],i=t[1],s=t[2],n=t[3],o=t[4],a=t[5],l=e[0],u=e[1],h=e[2],p=e[3],m=e[4],y=e[5],g=Gi();return Math.abs(r-l)<=g*Math.max(1,Math.abs(r),Math.abs(l))&&Math.abs(i-u)<=g*Math.max(1,Math.abs(i),Math.abs(u))&&Math.abs(s-h)<=g*Math.max(1,Math.abs(s),Math.abs(h))&&Math.abs(n-p)<=g*Math.max(1,Math.abs(n),Math.abs(p))&&Math.abs(o-m)<=g*Math.max(1,Math.abs(o),Math.abs(m))&&Math.abs(a-y)<=g*Math.max(1,Math.abs(a),Math.abs(y))}const Xpe=jo,Kpe=m7;Object.freeze(Object.defineProperty({__proto__:null,add:Hpe,copy:jpe,determinant:Gpe,equals:Ype,exactEquals:Jpe,frob:qpe,fromRotation:C2,fromScaling:f7,fromTranslation:xA,identity:Vv,invert:SA,mul:Xpe,multiply:jo,multiplyScalar:Wpe,multiplyScalarAndAdd:Zpe,rotate:pc,scale:jv,set:Upe,str:Bpe,sub:Kpe,subtract:m7,translate:ba},Symbol.toStringTag,{value:"Module"}));function wa(){return[1,0,0,1,0,0]}function Qpe(t){return[t[0],t[1],t[2],t[3],t[4],t[5]]}function efe(t,e,r,i,s,n){return[t,e,r,i,s,n]}const tfe=wa();Object.freeze(Object.defineProperty({__proto__:null,IDENTITY:tfe,clone:Qpe,create:wa,fromValues:efe},Symbol.toStringTag,{value:"Module"}));const T_={102100:{maxX:20037508342788905e-9,minX:-20037508342788905e-9,plus180Line:new er({paths:[[[20037508342788905e-9,-20037508342788905e-9],[20037508342788905e-9,20037508342788905e-9]]],spatialReference:ne.WebMercator}),minus180Line:new er({paths:[[[-20037508342788905e-9,-20037508342788905e-9],[-20037508342788905e-9,20037508342788905e-9]]],spatialReference:ne.WebMercator})},4326:{maxX:180,minX:-180,plus180Line:new er({paths:[[[180,-180],[180,180]]],spatialReference:ne.WGS84}),minus180Line:new er({paths:[[[-180,-180],[-180,180]]],spatialReference:ne.WGS84})}};function jh(t,e){return Math.ceil((t-e)/(2*e))}function y7(t,e){const r=p0(t);for(const i of r)for(const s of i)s[0]+=e;return t}function p0(t){return rr(t)?t.rings:t.paths}function V5e(t,e){return e?{...e,query:{...t??{},...e.query}}:{query:t}}function rfe(t){return typeof t=="string"?Pr(t):k(t)}function ife(t,e,r){const i={};for(const s in t){if(s==="declaredClass")continue;const n=t[s];if(n!=null&&typeof n!="function")if(Array.isArray(n))i[s]=n.map((o=>ife(o)));else if(typeof n=="object")if(n.toJSON){const o=n.toJSON(r?.[s]);i[s]=e?o:JSON.stringify(o)}else i[s]=e?n:JSON.stringify(n);else i[s]=n}return i}function sfe(t,e){return t?e&&r3(t)?e:t3(t)??Ve?.findCredential(t)?.token:null}async function j5e(t,e,r){const i=sfe(t,e);return i||(!Ve&&Ge.request.useIdentity&&await J(()=>import("./IdentityManager-DTnbKN5B.js"),[]),(await Ve.getCredential(t,r))?.token)}async function nfe(t,e,r,i){const s=rfe(t),n=e[0].spatialReference,o={...i,responseType:"json",query:{...s.query,f:"json",sr:XV(n),target:JSON.stringify({geometryType:v2(e[0]),geometries:e}),cutter:JSON.stringify(r)}},a=await et(s.path+"/cut",o),{cutIndexes:l,geometries:u=[]}=a.data;return{cutIndexes:l,geometries:u.map((h=>{const p=hc(h);return p.spatialReference=n,p}))}}function ofe(t){return{geometryType:v2(t[0]),geometries:t.map((e=>e.toJSON()))}}function afe(t,e,r){const i=Bae(e);return t.map((s=>{const n=i.fromJSON(s);return n.spatialReference=r,n}))}async function lfe(t,e,r){const i=typeof t=="string"?Pr(t):t,s=e[0].spatialReference,n=v2(e[0]),o={...r,query:{...i.query,f:"json",sr:XV(s),geometries:JSON.stringify(ofe(e))}},{data:a}=await et(i.path+"/simplify",o);return afe(a.geometries,n,s)}const g7=()=>q.getLogger("esri.geometry.support.normalizeUtils");function ufe(t){return t.type==="polygon"}function cfe(t){return t[0].type==="polygon"}function hfe(t){return t[0].type==="polyline"}function hN(t){const e=[];let r=0,i=0;for(let s=0;s<t.length;s++){const n=t[s];let o=null;for(let a=0;a<n.length;a++)o=n[a],e.push(o),a===0?(r=o[0],i=r):(r=Math.min(r,o[0]),i=Math.max(i,o[0]));o&&e.push([(r+i)/2,0])}return e}function v7(t,e){if(!(t instanceof er||t instanceof yt)){const s="straightLineDensify: the input geometry is neither polyline nor polygon";throw g7().error(s),new F("internal:geometry",s)}const r=p0(t),i=[];for(const s of r){const n=[];i.push(n),n.push([s[0][0],s[0][1]]);for(let o=0;o<s.length-1;o++){const a=s[o][0],l=s[o][1],u=s[o+1][0],h=s[o+1][1],p=Math.sqrt((u-a)*(u-a)+(h-l)*(h-l)),m=(h-l)/p,y=(u-a)/p,g=p/e;if(g>1){for(let S=1;S<=g-1;S++){const $=S*e,T=y*$+a,I=m*$+l;n.push([T,I])}const v=(p+Math.floor(g-1)*e)/2,_=y*v+a,b=m*v+l;n.push([_,b])}n.push([u,h])}}return ufe(t)?new yt({rings:i,spatialReference:t.spatialReference}):new er({paths:i,spatialReference:t.spatialReference})}function dN(t,e,r){if(e){const i=v7(t,1e6);t=Oh(i,!0)}return r&&(t=y7(t,r)),t}function pN(t,e,r){if(Array.isArray(t)){const i=t[0];if(i>e){const s=jh(i,e);t[0]=i+s*(-2*e)}else if(i<r){const s=jh(i,r);t[0]=i+s*(-2*r)}}else{const i=t.x;if(i>e){const s=jh(i,e);t=t.clone().offset(s*(-2*e),0)}else if(i<r){const s=jh(i,r);t=t.clone().offset(s*(-2*r),0)}}return t}function dfe(t,e){let r=-1;for(let i=0;i<e.cutIndexes.length;i++){const s=e.cutIndexes[i],n=e.geometries[i],o=p0(n);for(let a=0;a<o.length;a++){const l=o[a];l.some((u=>{if(u[0]<180)return!0;{let h=0;for(let m=0;m<l.length;m++){const y=l[m][0];h=y>h?y:h}h=Number(h.toFixed(9));const p=-360*jh(h,180);for(let m=0;m<l.length;m++){const y=n.getPoint(a,m);n.setPoint(a,m,y.clone().offset(p,0))}return!0}}))}if(s===r){if(cfe(t))for(const a of p0(n))t[s]=t[s].addRing(a);else if(hfe(t))for(const a of p0(n))t[s]=t[s].addPath(a)}else r=s,t[s]=n}return t}async function pfe(t,e,r){if(!Array.isArray(t))return pfe([t],e);e&&typeof e!="string"&&g7().warn("normalizeCentralMeridian()","The url object is deprecated, use the url string instead");const i=typeof e=="string"?e:e?.url??Ge.geometryServiceUrl;let s,n,o,a,l,u,h,p,m=0;const y=[],g=[];for(const T of t)if(T!=null)if(s||(s=T.spatialReference,n=Si(s),o=s.isWebMercator,u=o?102100:4326,a=T_[u].maxX,l=T_[u].minX,h=T_[u].plus180Line,p=T_[u].minus180Line),n)if(T.type==="mesh")g.push(T);else if(T.type==="point")g.push(pN(T.clone(),a,l));else if(T.type==="multipoint"){const I=T.clone();I.points=I.points.map((P=>pN(P,a,l))),g.push(I)}else if(T.type==="extent"){const I=T.clone()._normalize(!1,!1,n);g.push(I.rings?new yt(I):I)}else if(T.extent){const I=T.extent,P=jh(I.xmin,l)*(2*a);let R=P===0?T.clone():y7(T.clone(),P);I.offset(P,0);let{xmin:D,xmax:V}=I;D=Number(D.toFixed(9)),V=Number(V.toFixed(9)),I.intersects(h)&&V!==a?(m=V>m?V:m,R=dN(R,o),y.push(R),g.push("cut")):I.intersects(p)&&D!==l?(m=V*(2*a)>m?V*(2*a):m,R=dN(R,o,360),y.push(R),g.push("cut")):g.push(R)}else g.push(T.clone());else g.push(T);else g.push(T);let v=jh(m,a),_=-90;const b=v,S=new er;for(;v>0;){const T=360*v-180;S.addPath([[T,_],[T,-1*_]]),_*=-1,v--}if(y.length>0&&b>0){const T=dfe(y,await nfe(i,y,S,r)),I=[],P=[];for(let V=0;V<g.length;V++){const U=g[V];if(U!=="cut")P.push(U);else{const Z=T.shift(),X=t[V];X!=null&&X.type==="polygon"&&X.rings&&X.rings.length>1&&Z.rings.length>=X.rings.length?(I.push(Z),P.push("simplify")):P.push(o?Jh(Z):Z)}}if(!I.length)return P;const R=await lfe(i,I,r),D=[];for(let V=0;V<P.length;V++){const U=P[V];U!=="simplify"?D.push(U):D.push(o?Jh(R.shift()):R.shift())}return D}const $=[];for(let T=0;T<g.length;T++){const I=g[T];if(I!=="cut")$.push(I);else{const P=y.shift();$.push(o===!0?Jh(P):P)}}return $}function ffe(t){if(!t)return null;const e=t.extent;if(!e)return null;const r=t.spatialReference&&Si(t.spatialReference);if(!r)return e;const[i,s]=r.valid,n=2*s,{width:o}=e;let a,{xmin:l,xmax:u}=e;if([l,u]=[u,l],t.type==="extent"||o===0||o<=s||o>n||l<i||u>s)return e;switch(t.type){case"polygon":if(!(t.rings.length>1))return e;a=hN(t.rings);break;case"polyline":if(!(t.paths.length>1))return e;a=hN(t.paths);break;case"multipoint":a=t.points}const h=e.clone();for(let p=0;p<a.length;p++){let m=a[p][0];m<0?(m+=s,u=Math.max(m,u)):(m-=s,l=Math.min(m,l))}return h.xmin=l,h.xmax=u,h.width<o?(h.xmin-=s,h.xmax-=s,h):e}function $A(t,e,r){const i=Si(r);if(i==null)return t;const[s,n]=i.valid,o=2*n;let a=0,l=0;e>n?a=Math.ceil(Math.abs(e-n)/o):e<s&&(a=-Math.ceil(Math.abs(e-s)/o)),t>n?l=Math.ceil(Math.abs(t-n)/o):t<s&&(l=-Math.ceil(Math.abs(t-s)/o));let u=t+(a-l)*o;const h=u-e;return h>n?u-=o:h<s&&(u+=o),u}function U5e(t,e){const r=Si(e);if(r){const[i,s]=r.valid,n=s-i;if(t<i)for(;t<i;)t+=n;if(t>s)for(;t>s;)t-=n}return t}const _7=96,b7=39.37,mfe=180/Math.PI;function w7(t){return t.wkid?t:t.spatialReference||ne.WGS84}function MA(t,e){return e.type?tr(t,e.x,e.y):Tf(t,e)}function S7(t){return vn(t)}function P2(t,e,r=0){let i=t.width,s=t.height;if(r!==0){const a=Vm(r),l=Math.abs(Math.cos(a)),u=Math.abs(Math.sin(a));i=t.width*l+t.height*u,s=t.width*u+t.height*l}const n=Math.max(1,e[0]),o=Math.max(1,e[1]);return Math.max(i/n,s/o)*xfe(t.spatialReference)}async function gg(t,e,r,i){let s,n;if(!t||Array.isArray(t)&&!t.length)return null;if(se.isCollection(t)&&(t=t.toArray()),Array.isArray(t)&&t.length&&typeof t[0]=="object"){const a=t.every((h=>"attributes"in h)),l=t.some((h=>!h.geometry));let u=t;if(a&&l&&e&&e.allLayerViews){const h=new Map;for(const g of t){const v=g.layer,_=h.get(v)||[],b=g.attributes[v.objectIdField];b!=null&&_.push(b),h.set(v,_)}const p=[];h.forEach(((g,v)=>{const _=e.allLayerViews?.find((b=>b.layer.id===v.id));if(_&&"queryFeatures"in _){const b=v.createQuery();b.objectIds=g,b.returnGeometry=!0,p.push(_.queryFeatures(b))}}));const m=await Promise.all(p),y=[];for(const g of m)if(g&&g.features&&g.features.length)for(const v of g.features)v.geometry!=null&&y.push(v.geometry);u=y}for(const h of u)i=await gg(h,e,r,i);return i}if(Array.isArray(t)&&t.length===2&&typeof t[0]=="number"&&typeof t[1]=="number")s=new ge(t);else if(t instanceof Gr)s=t;else if("geometry"in t){if(t.geometry)s=t.geometry;else if(t.layer){const a=t.layer,l=e.allLayerViews?.find((u=>u.layer.id===a.id));if(l&&"queryFeatures"in l){const u=a.createQuery();u.objectIds=[t.attributes[a.objectIdField]],u.returnGeometry=!0,s=(await l.queryFeatures(u))?.features?.[0]?.geometry}}}if(s==null)return null;switch(s.type){case"point":n=new Le({xmin:s.x,ymin:s.y,xmax:s.x,ymax:s.y,spatialReference:s.spatialReference});break;case"extent":case"multipoint":case"polygon":case"polyline":n=ffe(s);break;default:n=s.extent}if(!n)return null;Bl()||gn(n.spatialReference,r)||await Vl();const o=bc(n,r);if(!o)return null;if(i){const a=o.center,l=a.clone();l.x=$A(a.x,i.center.x,r),l.x!==a.x&&o.centerAt(l),i=i.union(o)}else i=o;return i}function yfe(t){if(t&&(!Array.isArray(t)||typeof t[0]!="number")&&(typeof t=="object"||Array.isArray(t)&&typeof t[0]=="object")){if("layer"in t&&t.layer?.minScale!=null&&t.layer.maxScale!=null){const e=t.layer;return{min:e.minScale,max:e.maxScale}}if(Array.isArray(t)&&t.length&&t.every((e=>"layer"in e))){let e=0,r=0;for(const i of t){const s=i.layer;s?.minScale&&s.maxScale&&(e=s.minScale<e?s.minScale:e,r=s.maxScale>r?s.maxScale:r)}return e&&r?{min:e,max:r}:null}}}function fN(t,e){const r=w7(t);return mr(r,e)||r.imageCoordinateSystem||e.imageCoordinateSystem?t:bc(t,e)}async function gfe(t,e){if(!t||!e)return new mn({targetGeometry:new ge,scale:0,rotation:0});let r=e.spatialReference;const{constraints:i,padding:s,viewpoint:n,size:o}=e,a=[s?o[0]-s.left-s.right:o[0],s?o[1]-s.top-s.bottom:o[1]];let l=null;t instanceof mn?l=t:t.viewpoint?l=t.viewpoint:t.target&&t.target.declaredClass==="esri.Viewpoint"&&(l=t.target);let u=null;l?.targetGeometry?u=l.targetGeometry:t instanceof Le?u=t:t instanceof Gr?u=await gg(t,e,r):t&&(u=await gg(t.center,e,r)||await gg(t.target,e,r)||await gg(t,e,r)),!u&&n?.targetGeometry?u=n.targetGeometry:!u&&e.extent&&(u=e.extent),r||(r=w7(e.spatialReference||e.extent||u)),Bl()||mr(u.spatialReference,r)||gn(u.spatialReference,r)||await Vl();const h=fN(u,r),p="center"in h?h.center:h;e.pickClosestTarget!==!1&&p.type==="point"&&n.targetGeometry?.type==="point"&&(p.x=$A(p.x,n.targetGeometry.x,p.spatialReference));let m=0;l?m=l.rotation:t.hasOwnProperty("rotation")?m=t.rotation:n&&(m=n.rotation);let y=0;y=l?.targetGeometry!=null&&l.targetGeometry.type==="point"?l.scale:"scale"in t&&t.scale?t.scale:"zoom"in t&&t.zoom!==-1&&i&&i.effectiveLODs?i.zoomToScale(t.zoom):Array.isArray(u)||u.type==="point"||u.type==="extent"&&u.width===0&&u.height===0?n.scale:P2(fN(u.extent,r),a,m);const g=yfe(t.target??t);g&&(g.min&&g.min<y?y=g.min:g.max&&g.max>y&&(y=g.max));let v=new mn({targetGeometry:p,scale:y,rotation:m});return i&&(v=i.fit(v),i.constrainByGeometry(v),i.rotationEnabled||(v.rotation=n.rotation)),v}function wi(t,e){const r=t.targetGeometry,i=e.targetGeometry;return r.x=i.x,r.y=i.y,r.spatialReference=i.spatialReference,t.scale=e.scale,t.rotation=e.rotation,t}function vfe(t,e,r){return r?tr(t,.5*(e[0]-r.right+r.left),.5*(e[1]-r.bottom+r.top)):Dv(t,e,.5)}const _fe=(function(){const t=Ut();return function(e,r,i){const s=r.targetGeometry;MA(t,s);const n=.5*Bm(r);return e.xmin=t[0]-n*i[0],e.ymin=t[1]-n*i[1],e.xmax=t[0]+n*i[0],e.ymax=t[1]+n*i[1],e.spatialReference=s.spatialReference,e}})();function bfe(t,e,r,i,s){return dI(t,e,r.center),t.scale=P2(r,i),s?.constraints?.constrain(t),t}function wfe(t,e,r,i){return IA(t,e,r,i),SA(t,t)}const x7=(function(){const t=Ut();return function(e,r,i){return wA(e,$fe(e,r),vfe(t,r,i))}})(),Sfe=(function(){const t=wa(),e=Ut();return function(r,i,s,n){const o=Bm(i),a=TA(i);return tr(e,o,o),f7(t,e),pc(t,t,a),ba(t,t,x7(e,s,n)),ba(t,t,[0,n.top-n.bottom]),tr(r,t[4],t[5])}})();function Bm(t){return t.scale*$7(t.targetGeometry?.spatialReference)}function $7(t){return as(t)?1/(S7(t)*b7*_7):1}function TA(t){return K3(t.rotation)||0}function xfe(t){return as(t)?S7(t)*b7*_7:1}function $fe(t,e){return Dv(t,e,.5)}const EA=(function(){const t=Ut(),e=Ut(),r=Ut();return function(i,s,n,o,a,l){return a7(t,s),Dv(e,n,.5*l),tr(r,1/o*l,-1/o*l),xA(i,e),a&&pc(i,i,a),jv(i,i,r),ba(i,i,t),i}})(),IA=(function(){const t=Ut();return function(e,r,i,s){const n=Bm(r),o=TA(r);return MA(t,r.targetGeometry),EA(e,t,i,n,o,s)}})(),Mfe=(function(){const t=Ut();return function(e,r,i,s){const n=Bm(r);return MA(t,r.targetGeometry),EA(e,t,i,n,0,s)}})();function M7(t){const e=Si(t);return e?e.valid[1]-e.valid[0]:0}function Tfe(t,e){return Math.round(M7(t)/e)}const Efe=(function(){const t=Ut(),e=Ut(),r=[0,0,0];return function(i,s,n){B0(t,i,s),hI(t,t),B0(e,i,n),hI(e,e),u7(r,t,e);let o=Math.acos(l7(t,e)/(Vw(t)*Vw(e)))*mfe;return r[2]<0&&(o=-o),isNaN(o)&&(o=0),o}})(),Ife=(function(){const t=Ut();return function(e,r,i,s){const n=e.targetGeometry;return wi(e,r),Sfe(t,r,i,s),n.x+=t[0],n.y+=t[1],e}})(),dI=function(t,e,r){wi(t,e);const i=t.targetGeometry;return i.x=r.x,i.y=r.y,i.spatialReference=r.spatialReference,t},Cfe=(function(){const t=Ut();return function(e,r,i,s,n){n||(n="center"),wA(t,i,s),Dv(t,t,.5);const o=t[0],a=t[1];switch(n){case"center":tr(t,0,0);break;case"left":tr(t,-o,0);break;case"top":tr(t,0,a);break;case"right":tr(t,o,0);break;case"bottom":tr(t,0,-a);break;case"top-left":tr(t,-o,a);break;case"bottom-left":tr(t,-o,-a);break;case"top-right":tr(t,o,a);break;case"bottom-right":tr(t,o,-a)}return A2(e,r,t),e}})();function G5e(t,e,r){return wi(t,e),t.rotation+=r,t}function Pfe(t,e,r){return wi(t,e),t.rotation=r,t}const Afe=(function(){const t=Ut();return function(e,r,i,s,n){return wi(e,r),isNaN(i)||i===0||(E7(t,s,r,n),e.scale=r.scale*i,I7(t,t,e,n),A2(e,e,tr(t,t[0]-s[0],s[1]-t[1]))),e}})();function mN(t,e,r){return wi(t,e),t.scale=r,t}const T7=(function(){const t=Ut();return function(e,r,i,s,n,o){return wi(e,r),isNaN(i)||i===0||(E7(t,n,r,o),e.scale=r.scale*i,e.rotation+=s,I7(t,t,e,o),A2(e,e,tr(t,t[0]-n[0],n[1]-t[1]))),e}})(),B5e=(function(){const t=Ut(),e=Ut();return function(r,i,s,n,o,a,l){return x7(e,a,l),i7(t,o,e),n?T7(r,i,s,n,t,a):Afe(r,i,s,t,a)}})(),E7=(function(){const t=wa();return function(e,r,i,s){return vi(e,r,wfe(t,i,s,1))}})(),I7=(function(){const t=wa();return function(e,r,i,s){return vi(e,r,IA(t,i,s,1))}})(),A2=(function(){const t=Ut(),e=wa();return function(r,i,s){wi(r,i);const n=Bm(i),o=r.targetGeometry;return C2(e,TA(i)),jv(e,e,zv(n,n)),vi(t,s,e),o.x+=t[0],o.y+=t[1],r}})();function Ol(){const t=new Float32Array(6);return t[0]=1,t[3]=1,t}function Lfe(t){const e=new Float32Array(6);return e[0]=t[0],e[1]=t[1],e[2]=t[2],e[3]=t[3],e[4]=t[4],e[5]=t[5],e}function Rfe(t,e,r,i,s,n){const o=new Float32Array(6);return o[0]=t,o[1]=e,o[2]=r,o[3]=i,o[4]=s,o[5]=n,o}function C7(t,e,r,i){const s=e[i],n=e[i+1];t[i]=r[0]*s+r[2]*n+r[4],t[i+1]=r[1]*s+r[3]*n+r[5]}function P7(t,e,r,i=0,s=0,n=2){const o=s||e.length/n;for(let a=i;a<o;a++)C7(t,e,r,a*n)}Object.freeze(Object.defineProperty({__proto__:null,clone:Lfe,create:Ol,fromValues:Rfe,transform:C7,transformMany:P7},Symbol.toStringTag,{value:"Module"}));function kfe(t,e){return t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[4],t[4]=e[5],t[5]=e[6],t[6]=e[8],t[7]=e[9],t[8]=e[10],t}function Ofe(t,e){return t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3],t[4]=e[4],t[5]=e[5],t[6]=e[6],t[7]=e[7],t[8]=e[8],t}function A7(t,e,r,i,s,n,o,a,l,u){return t[0]=e,t[1]=r,t[2]=i,t[3]=s,t[4]=n,t[5]=o,t[6]=a,t[7]=l,t[8]=u,t}function L7(t){return t[0]=1,t[1]=0,t[2]=0,t[3]=0,t[4]=1,t[5]=0,t[6]=0,t[7]=0,t[8]=1,t}function Nfe(t,e){if(t===e){const r=e[1],i=e[2],s=e[5];t[1]=e[3],t[2]=e[6],t[3]=r,t[5]=e[7],t[6]=i,t[7]=s}else t[0]=e[0],t[1]=e[3],t[2]=e[6],t[3]=e[1],t[4]=e[4],t[5]=e[7],t[6]=e[2],t[7]=e[5],t[8]=e[8];return t}function Ffe(t,e){const r=e[0],i=e[1],s=e[2],n=e[3],o=e[4],a=e[5],l=e[6],u=e[7],h=e[8],p=h*o-a*u,m=-h*n+a*l,y=u*n-o*l;let g=r*p+i*m+s*y;return g?(g=1/g,t[0]=p*g,t[1]=(-h*i+s*u)*g,t[2]=(a*i-s*o)*g,t[3]=m*g,t[4]=(h*r-s*l)*g,t[5]=(-a*r+s*n)*g,t[6]=y*g,t[7]=(-u*r+i*l)*g,t[8]=(o*r-i*n)*g,t):null}function Dfe(t,e){const r=e[0],i=e[1],s=e[2],n=e[3],o=e[4],a=e[5],l=e[6],u=e[7],h=e[8];return t[0]=o*h-a*u,t[1]=s*u-i*h,t[2]=i*a-s*o,t[3]=a*l-n*h,t[4]=r*h-s*l,t[5]=s*n-r*a,t[6]=n*u-o*l,t[7]=i*l-r*u,t[8]=r*o-i*n,t}function zfe(t){const e=t[0],r=t[1],i=t[2],s=t[3],n=t[4],o=t[5],a=t[6],l=t[7],u=t[8];return e*(u*n-o*l)+r*(-u*s+o*a)+i*(l*s-n*a)}function CA(t,e,r){const i=e[0],s=e[1],n=e[2],o=e[3],a=e[4],l=e[5],u=e[6],h=e[7],p=e[8],m=r[0],y=r[1],g=r[2],v=r[3],_=r[4],b=r[5],S=r[6],$=r[7],T=r[8];return t[0]=m*i+y*o+g*u,t[1]=m*s+y*a+g*h,t[2]=m*n+y*l+g*p,t[3]=v*i+_*o+b*u,t[4]=v*s+_*a+b*h,t[5]=v*n+_*l+b*p,t[6]=S*i+$*o+T*u,t[7]=S*s+$*a+T*h,t[8]=S*n+$*l+T*p,t}function pI(t,e,r){const i=e[0],s=e[1],n=e[2],o=e[3],a=e[4],l=e[5],u=e[6],h=e[7],p=e[8],m=r[0],y=r[1];return t[0]=i,t[1]=s,t[2]=n,t[3]=o,t[4]=a,t[5]=l,t[6]=m*i+y*o+u,t[7]=m*s+y*a+h,t[8]=m*n+y*l+p,t}function R7(t,e,r){const i=e[0],s=e[1],n=e[2],o=e[3],a=e[4],l=e[5],u=e[6],h=e[7],p=e[8],m=Math.sin(r),y=Math.cos(r);return t[0]=y*i+m*o,t[1]=y*s+m*a,t[2]=y*n+m*l,t[3]=y*o-m*i,t[4]=y*a-m*s,t[5]=y*l-m*n,t[6]=u,t[7]=h,t[8]=p,t}function Vfe(t,e,r){const i=r[0],s=r[1],n=r[2];return t[0]=i*e[0],t[1]=i*e[1],t[2]=i*e[2],t[3]=s*e[3],t[4]=s*e[4],t[5]=s*e[5],t[6]=n*e[6],t[7]=n*e[7],t[8]=n*e[8],t}function jfe(t,e,r){const i=r[0],s=r[1];return t[0]=i*e[0],t[1]=i*e[1],t[2]=i*e[2],t[3]=s*e[3],t[4]=s*e[4],t[5]=s*e[5],t}function Ufe(t,e){return t[0]=1,t[1]=0,t[2]=0,t[3]=0,t[4]=1,t[5]=0,t[6]=e[0],t[7]=e[1],t[8]=1,t}function Gfe(t,e){const r=Math.sin(e),i=Math.cos(e);return t[0]=i,t[1]=r,t[2]=0,t[3]=-r,t[4]=i,t[5]=0,t[6]=0,t[7]=0,t[8]=1,t}function Bfe(t,e){return t[0]=e[0],t[1]=0,t[2]=0,t[3]=0,t[4]=e[1],t[5]=0,t[6]=0,t[7]=0,t[8]=1,t}function qfe(t,e){return t[0]=e[0],t[1]=e[1],t[2]=0,t[3]=e[2],t[4]=e[3],t[5]=0,t[6]=e[4],t[7]=e[5],t[8]=1,t}function Hfe(t,e){const r=e[0],i=e[1],s=e[2],n=e[3],o=r+r,a=i+i,l=s+s,u=r*o,h=i*o,p=i*a,m=s*o,y=s*a,g=s*l,v=n*o,_=n*a,b=n*l;return t[0]=1-p-g,t[3]=h-b,t[6]=m+_,t[1]=h+b,t[4]=1-u-g,t[7]=y-v,t[2]=m-_,t[5]=y+v,t[8]=1-u-p,t}function Wfe(t,e){const r=e[0],i=e[1],s=e[2],n=e[4],o=e[5],a=e[6],l=e[8],u=e[9],h=e[10],p=h*o-a*u,m=-h*n+a*l,y=u*n-o*l,g=r*p+i*m+s*y;if(!g)return null;const v=1/g;return t[0]=p*v,t[1]=(-h*i+s*u)*v,t[2]=(a*i-s*o)*v,t[3]=m*v,t[4]=(h*r-s*l)*v,t[5]=(-a*r+s*n)*v,t[6]=y*v,t[7]=(-u*r+i*l)*v,t[8]=(o*r-i*n)*v,t}function Zfe(t,e){const r=e[0],i=e[1],s=e[2],n=e[3],o=e[4],a=e[5],l=e[6],u=e[7],h=e[8],p=e[9],m=e[10],y=e[11],g=e[12],v=e[13],_=e[14],b=e[15],S=r*a-i*o,$=r*l-s*o,T=r*u-n*o,I=i*l-s*a,P=i*u-n*a,R=s*u-n*l,D=h*v-p*g,V=h*_-m*g,U=h*b-y*g,Z=p*_-m*v,X=p*b-y*v,le=m*b-y*_;let ee=S*le-$*X+T*Z+I*U-P*V+R*D;return ee?(ee=1/ee,t[0]=(a*le-l*X+u*Z)*ee,t[1]=(l*U-o*le-u*V)*ee,t[2]=(o*X-a*U+u*D)*ee,t[3]=(s*X-i*le-n*Z)*ee,t[4]=(r*le-s*U+n*V)*ee,t[5]=(i*U-r*X-n*D)*ee,t[6]=(v*R-_*P+b*I)*ee,t[7]=(_*T-g*R-b*$)*ee,t[8]=(g*P-v*T+b*S)*ee,t):null}function Jfe(t,e,r){return t[0]=2/e,t[1]=0,t[2]=0,t[3]=0,t[4]=-2/r,t[5]=0,t[6]=-1,t[7]=1,t[8]=1,t}function Yfe(t){return"mat3("+t[0]+", "+t[1]+", "+t[2]+", "+t[3]+", "+t[4]+", "+t[5]+", "+t[6]+", "+t[7]+", "+t[8]+")"}function Xfe(t){return Math.sqrt(t[0]**2+t[1]**2+t[2]**2+t[3]**2+t[4]**2+t[5]**2+t[6]**2+t[7]**2+t[8]**2)}function Kfe(t,e,r){return t[0]=e[0]+r[0],t[1]=e[1]+r[1],t[2]=e[2]+r[2],t[3]=e[3]+r[3],t[4]=e[4]+r[4],t[5]=e[5]+r[5],t[6]=e[6]+r[6],t[7]=e[7]+r[7],t[8]=e[8]+r[8],t}function k7(t,e,r){return t[0]=e[0]-r[0],t[1]=e[1]-r[1],t[2]=e[2]-r[2],t[3]=e[3]-r[3],t[4]=e[4]-r[4],t[5]=e[5]-r[5],t[6]=e[6]-r[6],t[7]=e[7]-r[7],t[8]=e[8]-r[8],t}function Qfe(t,e,r){return t[0]=e[0]*r,t[1]=e[1]*r,t[2]=e[2]*r,t[3]=e[3]*r,t[4]=e[4]*r,t[5]=e[5]*r,t[6]=e[6]*r,t[7]=e[7]*r,t[8]=e[8]*r,t}function eme(t,e,r,i){return t[0]=e[0]+r[0]*i,t[1]=e[1]+r[1]*i,t[2]=e[2]+r[2]*i,t[3]=e[3]+r[3]*i,t[4]=e[4]+r[4]*i,t[5]=e[5]+r[5]*i,t[6]=e[6]+r[6]*i,t[7]=e[7]+r[7]*i,t[8]=e[8]+r[8]*i,t}function tme(t,e){return t[0]===e[0]&&t[1]===e[1]&&t[2]===e[2]&&t[3]===e[3]&&t[4]===e[4]&&t[5]===e[5]&&t[6]===e[6]&&t[7]===e[7]&&t[8]===e[8]}function rme(t,e){const r=t[0],i=t[1],s=t[2],n=t[3],o=t[4],a=t[5],l=t[6],u=t[7],h=t[8],p=e[0],m=e[1],y=e[2],g=e[3],v=e[4],_=e[5],b=e[6],S=e[7],$=e[8],T=Gi();return Math.abs(r-p)<=T*Math.max(1,Math.abs(r),Math.abs(p))&&Math.abs(i-m)<=T*Math.max(1,Math.abs(i),Math.abs(m))&&Math.abs(s-y)<=T*Math.max(1,Math.abs(s),Math.abs(y))&&Math.abs(n-g)<=T*Math.max(1,Math.abs(n),Math.abs(g))&&Math.abs(o-v)<=T*Math.max(1,Math.abs(o),Math.abs(v))&&Math.abs(a-_)<=T*Math.max(1,Math.abs(a),Math.abs(_))&&Math.abs(l-b)<=T*Math.max(1,Math.abs(l),Math.abs(b))&&Math.abs(u-S)<=T*Math.max(1,Math.abs(u),Math.abs(S))&&Math.abs(h-$)<=T*Math.max(1,Math.abs(h),Math.abs($))}function ime(t){const e=Gi(),r=t[0],i=t[1],s=t[2],n=t[3],o=t[4],a=t[5],l=t[6],u=t[7],h=t[8];return Math.abs(1-(r*r+n*n+l*l))<=e&&Math.abs(1-(i*i+o*o+u*u))<=e&&Math.abs(1-(s*s+a*a+h*h))<=e}const sme=CA,nme=k7;Object.freeze(Object.defineProperty({__proto__:null,add:Kfe,adjoint:Dfe,copy:Ofe,determinant:zfe,equals:rme,exactEquals:tme,frob:Xfe,fromMat2d:qfe,fromMat4:kfe,fromQuat:Hfe,fromRotation:Gfe,fromScaling:Bfe,fromTranslation:Ufe,identity:L7,invert:Ffe,isOrthoNormal:ime,mul:sme,multiply:CA,multiplyScalar:Qfe,multiplyScalarAndAdd:eme,normalFromMat4:Zfe,normalFromMat4Legacy:Wfe,projection:Jfe,rotate:R7,scale:Vfe,scaleByVec2:jfe,set:A7,str:Yfe,sub:nme,subtract:k7,translate:pI,transpose:Nfe},Symbol.toStringTag,{value:"Module"}));function lb(){const t=new Float32Array(9);return t[0]=1,t[4]=1,t[8]=1,t}function ome(t){const e=new Float32Array(9);return e[0]=t[0],e[1]=t[1],e[2]=t[2],e[3]=t[3],e[4]=t[4],e[5]=t[5],e[6]=t[6],e[7]=t[7],e[8]=t[8],e}function ame(t,e,r,i,s,n,o,a,l){const u=new Float32Array(9);return u[0]=t,u[1]=e,u[2]=r,u[3]=i,u[4]=s,u[5]=n,u[6]=o,u[7]=a,u[8]=l,u}Object.freeze(Object.defineProperty({__proto__:null,clone:ome,create:lb,fromValues:ame},Symbol.toStringTag,{value:"Module"}));function q0(){return new Float32Array(2)}function lme(t){const e=new Float32Array(2);return e[0]=t[0],e[1]=t[1],e}function bd(t,e){const r=new Float32Array(2);return r[0]=t,r[1]=e,r}function O7(){return q0()}function N7(){return bd(1,1)}function F7(){return bd(1,0)}function D7(){return bd(0,1)}const ume=O7(),cme=N7(),hme=F7(),dme=D7();Object.freeze(Object.defineProperty({__proto__:null,ONES:cme,UNIT_X:hme,UNIT_Y:dme,ZEROS:ume,clone:lme,create:q0,fromValues:bd,ones:N7,unitX:F7,unitY:D7,zeros:O7},Symbol.toStringTag,{value:"Module"}));function pme(t){return t instanceof Float32Array&&t.length>=2}function fme(t){return Array.isArray(t)&&t.length>=2}function s$(t){return pme(t)||fme(t)}var fI;const ka=[0,0];let Ka=fI=class extends W{constructor(t){super(t),this._viewpoint2D={center:Ut(),rotation:0,scale:0,spatialReference:void 0},this.center=[0,0],this.extent=new Le,this.id=0,this.inverseTransform=wa(),this.resolution=0,this.rotation=0,this.scale=0,this.transform=wa(),this.transformNoRotation=wa(),this.displayMat3=lb(),this.displayViewMat3=lb(),this.viewMat3=lb(),this.viewMat2d=Ol(),this.worldScreenWidth=0,this.size=[0,0]}set pixelRatio(t){this._set("pixelRatio",t),this._update()}set size(t){this._set("size",t),this._update()}set viewpoint(t){if(t){const e=this._viewpoint2D,r=t.targetGeometry;e.center[0]=r.x,e.center[1]=r.y,e.rotation=t.rotation,e.scale=t.scale,e.spatialReference=r.spatialReference}this._update()}get visibleArea(){const[t,e]=this.size;return[this.toMap([0,0],0,0),this.toMap([0,0],0,e),this.toMap([0,0],t,e),this.toMap([0,0],t,0)]}copy(t){const e=this.size,r=this.viewpoint;return r&&e?(this.viewpoint=wi(r,t.viewpoint),this._set("size",Tf(e,t.size))):(this.viewpoint=t.viewpoint.clone(),this._set("size",[t.size[0],t.size[1]])),this._set("pixelRatio",t.pixelRatio),this}clone(){return new fI({size:this.size,viewpoint:this.viewpoint.clone(),pixelRatio:this.pixelRatio})}toMap(t,e,r){return s$(e)?vi(t,e,this.inverseTransform):(ka[0]=e,ka[1]=r,vi(t,ka,this.inverseTransform))}toScreen(t,e,r){return s$(e)?vi(t,e,this.transform):(ka[0]=e,ka[1]=r,vi(t,ka,this.transform))}toScreenNoRotation(t,e,r){return s$(e)?vi(t,e,this.transformNoRotation):(ka[0]=e,ka[1]=r,vi(t,ka,this.transformNoRotation))}wrapMapCoordinate(t,e){Tf(t,e);const[r]=e,[i]=this.center,{extent:s,spatialReference:n}=this;let{xmin:o,xmax:a}=s;if(n.isWrappable){const l=M7(n)/2;o=Math.max(o,i-l),a=Math.min(a,i+l)}return(r<o||r>a)&&(t[0]=$A(r,i,n)),t}getScreenTransform(t,e){const{center:r}=this._viewpoint2D,i=this._get("pixelRatio")||1,s=this._get("size");return EA(t,r,s,e,0,i),t}_update(){const{center:t,spatialReference:e,scale:r,rotation:i}=this._viewpoint2D,s=this._get("pixelRatio")||1,n=this._get("size"),o=new mn({targetGeometry:new ge(t[0],t[1],e),scale:r,rotation:i});if(this._set("viewpoint",o),!n||!e||!r)return;this.resolution=Bm(o),this.rotation=i,this.scale=r,this.spatialReference=e,Tf(this.center,t);const a=n[0]!==0?2/n[0]:0,l=n[1]!==0?-2/n[1]:0;A7(this.displayMat3,a,0,0,0,l,0,-1,1,1);const u=L7(this.viewMat3),h=bd(n[0]/2,n[1]/2),p=bd(-n[0]/2,-n[1]/2),m=K3(i);pI(u,u,h),R7(u,u,m),pI(u,u,p),CA(this.displayViewMat3,this.displayMat3,u);const y=xA(this.viewMat2d,h);return pc(y,y,m),ba(y,y,p),_fe(this.extent,o,n),IA(this.transform,o,n,s),SA(this.inverseTransform,this.transform),Mfe(this.transformNoRotation,o,n,s),this.worldScreenWidth=Tfe(this.spatialReference,this.resolution),this._set("id",this.id+1),this.notifyChange("visibleArea"),this}};c([d({readOnly:!0})],Ka.prototype,"id",void 0),c([d({value:1,json:{write:!0}})],Ka.prototype,"pixelRatio",null),c([d({json:{write:!0}})],Ka.prototype,"size",null),c([d()],Ka.prototype,"spatialReference",void 0),c([d({type:mn,json:{write:!0}})],Ka.prototype,"viewpoint",null),c([d({readOnly:!0})],Ka.prototype,"visibleArea",null),Ka=fI=c([C("esri.views.2d.ViewState")],Ka);const yN=Ka;var mI,yI;let bl=mI=class extends ce{constructor(){super(...arguments),this.left=0,this.top=0,this.right=0,this.bottom=0}clone(){return new mI({left:this.left,top:this.top,right:this.right,bottom:this.bottom})}};c([d()],bl.prototype,"left",void 0),c([d()],bl.prototype,"top",void 0),c([d()],bl.prototype,"right",void 0),c([d()],bl.prototype,"bottom",void 0),bl=mI=c([C("esri.views.2d.PaddedViewState.Padding")],bl);let gp=yI=class extends yN{constructor(...t){super(...t),this.paddedViewState=new yN,this._updateContent=(()=>{const e=Ut();return()=>{const r=this._get("size"),i=this._get("padding");if(!r||!i)return;const s=this.paddedViewState;tr(e,i.left+i.right,i.top+i.bottom),B0(e,r,e),Tf(s.size,e);const n=s.viewpoint;n&&(this.viewpoint=n)}})(),this.addHandles(ie((()=>[this.size,this.padding]),(()=>this._updateContent()),Ma)),this.padding=new bl,this.size=[0,0]}set padding(t){this._set("padding",t||new bl)}set viewpoint(t){if(t){this.paddedViewState.viewpoint=t;let e=t;const r=this._get("padding");r&&(e=Ife(t.clone(),t,this._get("size"),r));const{targetGeometry:i,rotation:s,scale:n}=e,{x:o,y:a,spatialReference:l}=i,u=this._viewpoint2D;u.center[0]=o,u.center[1]=a,u.rotation=s,u.scale=n,u.spatialReference=l,this._update()}}clone(){return new yI({padding:this.padding.clone(),size:this.size.slice(),viewpoint:this.paddedViewState.viewpoint.clone(),pixelRatio:this.pixelRatio})}};c([d()],gp.prototype,"paddedViewState",void 0),c([d({type:bl})],gp.prototype,"padding",null),c([d()],gp.prototype,"viewpoint",null),gp=yI=c([C("esri.views.2d.PaddedViewState")],gp);const PA=gp;var di;(function(t){t[t.ANIMATING=0]="ANIMATING",t[t.INTERACTING=1]="INTERACTING",t[t.IDLE=2]="IDLE"})(di||(di={}));const z7=Symbol("Yield");let mme=class{constructor(){this._tasks=new Array,this._numPendingTasks=gm(0),this._running=gm(!1)}get length(){return this._tasks.length}get updating(){return this._numPendingTasks.value>0}get running(){return this._running.value}_updateRunning(){this._running.value=this._tasks.length>0}destroy(){this.cancelAll()}runTask(e){if(this.length===0)return z7;for(;!e.done&&this._process(e);)e.madeProgress()}push(e,r,i){return new Promise(((s,n)=>{this._tasks.push(new gN(s,n,e,r,i)),++this._numPendingTasks.value,this._updateRunning()})).finally((()=>--this._numPendingTasks.value))}unshift(e,r,i){return new Promise(((s,n)=>{this._tasks.unshift(new gN(s,n,e,r,i)),++this._numPendingTasks.value,this._updateRunning()})).finally((()=>--this._numPendingTasks.value))}_process(e){if(this._tasks.length===0)return!1;const r=this._tasks.shift();this._updateRunning();try{const i=yn(r.signal);if(i&&!r.abortCallback)r.reject(St());else{const s=i?r.abortCallback?.(St()):r.callback(e);Ia(s)?s.then(r.resolve,r.reject):r.resolve(s)}}catch(i){r.reject(i)}return!0}cancelAll(){const e=St();for(const r of this._tasks)if(r.abortCallback){const i=r.abortCallback(e);r.resolve(i)}else r.reject(e);this._tasks.length=0,this._updateRunning()}},gN=class{constructor(e,r,i,s=void 0,n=void 0){this.resolve=e,this.reject=r,this.callback=i,this.signal=s,this.abortCallback=n}},vg=class extends ce{constructor(){super(...arguments),this.SCHEDULER_LOG_SLOW_TASKS=!1,this.FEATURE_SERVICE_SNAPPING_SOURCE_TILE_TREE_SHOW_TILES=!1}};c([d()],vg.prototype,"SCHEDULER_LOG_SLOW_TASKS",void 0),c([d()],vg.prototype,"FEATURE_SERVICE_SNAPPING_SOURCE_TILE_TREE_SHOW_TILES",void 0),vg=c([C("esri.views.support.debugFlags")],vg);const yme=new vg;function gme(){return new jw.Scheduler}var Re;(function(t){t.RESOURCE_CONTROLLER_IMMEDIATE="immediate",t.RESOURCE_CONTROLLER="schedule",t.SLIDE="slide",t.STREAM_DATA_LOADER="stream loader",t.ELEVATION_QUERY="elevation query",t.TERRAIN_SURFACE="terrain",t.SURFACE_GEOMETRY_UPDATES="surface geometry updates",t.LOD_RENDERER="LoD renderer",t.GRAPHICS_CORE="Graphics3D",t.I3S_CONTROLLER="I3S",t.POINT_CLOUD_LAYER="point cloud",t.FEATURE_TILE_FETCHER="feature fetcher",t.OVERLAY="overlay",t.OVERLAY_RENDERER="overlay renderer",t.STAGE="stage",t.GRAPHICS_DECONFLICTOR="graphics deconflictor",t.FILTER_VISIBILITY="Graphics3D filter visibility",t.SCALE_VISIBILITY="Graphics3D scale visibility",t.FRUSTUM_VISIBILITY="Graphics3D frustum visibility",t.POINT_OF_INTEREST_FREQUENT="POI frequent",t.POINT_OF_INTEREST_INFREQUENT="POI infrequent",t.LABELER="labeler",t.FEATURE_QUERY_ENGINE="feature query",t.FEATURE_TILE_TREE="feature tile tree",t.FEATURE_TILE_TREE_ACTIVE="fast feature tile tree",t.ELEVATION_ALIGNMENT="elevation alignment",t.ELEVATION_ALIGNMENT_SCENE="elevation alignment scene",t.TEXT_TEXTURE_ATLAS="text texture atlas",t.TEXTURE_UNLOAD="texture unload",t.LINE_OF_SIGHT_TOOL="line of sight tool",t.LINE_OF_SIGHT_TOOL_INTERACTIVE="interactive line of sight tool",t.ELEVATION_PROFILE="elevation profile",t.SNAPPING="snapping",t.SHADOW_ACCUMULATOR="shadow accumulator",t.CLOUDS_GENERATOR="clouds generator",t.MAPVIEW_FETCH_QUEUE="mapview fetch queue",t.MAPVIEW_LAYERVIEW_UPDATE="mapview layerview update",t.MAPVIEW_VECTOR_TILE_PARSING_QUEUE="mapview vector tile parsing queue",t[t.NONE=0]="NONE",t[t.TEST_PRIO=1]="TEST_PRIO"})(Re||(Re={}));const Xs=0,vN=new Map([[Re.RESOURCE_CONTROLLER_IMMEDIATE,Xs],[Re.RESOURCE_CONTROLLER,4],[Re.SLIDE,Xs],[Re.STREAM_DATA_LOADER,Xs],[Re.ELEVATION_QUERY,Xs],[Re.TERRAIN_SURFACE,1],[Re.SURFACE_GEOMETRY_UPDATES,1],[Re.LOD_RENDERER,2],[Re.GRAPHICS_CORE,2],[Re.I3S_CONTROLLER,2],[Re.POINT_CLOUD_LAYER,2],[Re.FEATURE_TILE_FETCHER,2],[Re.CLOUDS_GENERATOR,2],[Re.OVERLAY,4],[Re.OVERLAY_RENDERER,4],[Re.STAGE,4],[Re.GRAPHICS_DECONFLICTOR,4],[Re.FILTER_VISIBILITY,4],[Re.SCALE_VISIBILITY,4],[Re.FRUSTUM_VISIBILITY,4],[Re.POINT_OF_INTEREST_FREQUENT,6],[Re.POINT_OF_INTEREST_INFREQUENT,30],[Re.LABELER,8],[Re.FEATURE_QUERY_ENGINE,8],[Re.FEATURE_TILE_TREE,16],[Re.FEATURE_TILE_TREE_ACTIVE,Xs],[Re.ELEVATION_ALIGNMENT,12],[Re.ELEVATION_ALIGNMENT_SCENE,14],[Re.TEXT_TEXTURE_ATLAS,12],[Re.TEXTURE_UNLOAD,12],[Re.LINE_OF_SIGHT_TOOL,16],[Re.LINE_OF_SIGHT_TOOL_INTERACTIVE,Xs],[Re.SNAPPING,Xs],[Re.SHADOW_ACCUMULATOR,30],[Re.MAPVIEW_FETCH_QUEUE,Xs],[Re.MAPVIEW_LAYERVIEW_UPDATE,2],[Re.MAPVIEW_VECTOR_TILE_PARSING_QUEUE,Xs]]);function _N(t){return vN.has(t)?vN.get(t):typeof t=="number"?t:1}const vme=6.5,bN=1,_me=30,bme=1e3/30,wme=100,wN=.9;var jw,Ec;(function(t){class e{get updating(){return this._updating.value}_updatingChanged(){this._updating.value=this._tasks.some((n=>n.needsUpdate))}constructor(){this._updating=gm(!0),this._microTaskQueued=!1,this._frameNumber=0,this.performanceInfo={total:new Hg("total"),tasks:new Map},this._frameTaskTimes=new Map,this._budget=new i,this._state=di.INTERACTING,this._tasks=new Wg,this._runQueue=new Wg,this._load=0,this._idleStateCallbacks=new Wg,this._idleUpdatesStartFired=!1,this._forceTask=!1,this._debug=!1,this._debugHandle=ie((()=>yme.SCHEDULER_LOG_SLOW_TASKS),(n=>this._debug=n),Ft);for(const n of Object.keys(Re))this.performanceInfo.tasks.set(Re[n],new Hg(Re[n]))}destroy(){this._tasks.toArray().forEach((n=>n.remove())),this._tasks.clear(),Lt(this._debugHandle),this._microTaskQueued=!1,this._updatingChanged()}taskRunningChanged(n){this._updatingChanged(),n&&this._budget.remaining>0&&!this._microTaskQueued&&(this._microTaskQueued=!0,queueMicrotask((()=>{this._microTaskQueued&&(this._microTaskQueued=!1,this._budget.remaining>0&&this._schedule()&&this._runFrame())})))}registerTask(n,o){const a=new r(this,n,o);return this._tasks.push(a),this._updatingChanged(),this.performanceInfo.tasks.has(n)||this.performanceInfo.tasks.set(n,new Hg(n)),a}registerIdleStateCallbacks(n,o){const a={idleBegin:n,idleEnd:o};this._idleStateCallbacks.push(a),this.state===di.IDLE&&this._idleUpdatesStartFired&&a.idleBegin();const l=this;return{remove:()=>this._removeIdleStateCallbacks(a),set idleBegin(u){l._idleUpdatesStartFired&&(a.idleEnd(),l._state===di.IDLE&&u()),a.idleBegin=u},set idleEnd(u){a.idleEnd=u}}}get load(){return this._load}set state(n){this._state!==n&&(this._state=n,this.state!==di.IDLE&&this._idleUpdatesStartFired&&(this._idleUpdatesStartFired=!1,this._idleStateCallbacks.forAll((o=>o.idleEnd()))))}get state(){return this._state}frame(n){this._startFrameTaskTimes();const o=this._updateBudget(n);if(o){const a=this._budget.now();this._runFrame(),this._recordFrameTaskTimes(this._budget.now()-a)}else this._recordFrameTaskTimes(0);return o}_updateBudget(n){this._test&&(this._test.usedBudget=0),++this._frameNumber;let o=vme,a=n.frameDuration,l=bN;switch(this.state){case di.IDLE:o=0,a=Math.max(wme,n.frameDuration),l=_me;break;case di.INTERACTING:a=Math.max(bme,n.frameDuration);case di.ANIMATING:}return a=a-n.elapsedFrameTime-o,this.state!==di.IDLE&&a<bN&&!this._forceTask?(this._forceTask=!0,!1):(a=Math.max(a,l),this._budget.reset(a),this._updateLoad(),this._schedule())}_runFrame(){switch(this._forceTask=!1,this._microTaskQueued=!1,this.state){case di.IDLE:this._idleUpdatesStartFired||(this._idleUpdatesStartFired=!0,this._idleStateCallbacks.forAll((n=>n.idleBegin()))),this._runIdle();break;case di.INTERACTING:this._runInteracting();break;default:this._runAnimating()}this._test&&(this._test.usedBudget=this._budget.elapsed)}stopFrame(){this._budget.reset(0),this._budget.madeProgress()}_removeIdleStateCallbacks(n){this._idleUpdatesStartFired&&n.idleEnd(),this._idleStateCallbacks.removeUnordered(n)}removeTask(n){this._tasks.removeUnordered(n),this._runQueue.removeUnordered(n),this._updatingChanged()}_updateTask(n){this._tasks.forAll((o=>{o.name===n&&o.setPriority(n)}))}_getState(n){if(this._runQueue.some((a=>a.name===n)))return Ec.SCHEDULED;let o=Ec.IDLE;return this._tasks.forAll((a=>{a.name===n&&a.needsUpdate&&(a.schedulePriority<=1?o=Ec.READY:o!==Ec.READY&&(o=Ec.WAITING))})),o}_getRuntime(n){let o=0;return this._tasks.forAll((a=>{a.name===n&&(o+=a.runtime)})),o}_resetRuntimes(){this._tasks.forAll((n=>n.runtime=0))}_getRunning(){const n=new Map;if(this._tasks.forAll((a=>{a.needsUpdate&&n.set(a.name,(n.get(a.name)||0)+1)})),n.size===0)return null;let o="";return n.forEach(((a,l)=>{o+=a>1?` ${a}x ${l}`:` ${l}`})),o}_runIdle(){this._run()}_runInteracting(){this._run()}_runAnimating(){this._run()}_updateLoad(){const n=this._tasks.reduce(((o,a)=>a.needsUpdate?++o:o),0);this._load=this._load*wN+n*(1-wN)}_schedule(){for(this._runQueue.filterInPlace((n=>!!n.needsUpdate||(n.schedulePriority=n.basePriority,!1))),this._tasks.forAll((n=>{n.basePriority===Xs&&n.needsUpdate&&!this._runQueue.includes(n)&&n.blockFrame!==this._frameNumber&&this._runQueue.unshift(n)}));this._runQueue.length===0;){let n=!1,o=0;if(this._tasks.forAll((a=>{a.needsUpdate&&a.schedulePriority!==0&&a.basePriority!==Xs&&a.blockFrame!==this._frameNumber&&(n=!0,o=Math.max(o,a.basePriority),a.schedulePriority===1?(a.schedulePriority=0,this._runQueue.push(a)):--a.schedulePriority)})),!n)return this._updatingChanged(),!1}return this._updatingChanged(),!0}_run(){do for(;this._runQueue.length>0;){const n=this._budget.now(),o=this._runQueue.pop();this._budget.resetProgress();try{o.task.runTask(this._budget)===z7&&(o.blockFrame=this._frameNumber)}catch(l){q.getLogger("esri.views.support.Scheduler").error(`Exception in task "${o.name}"`,l),o.blockFrame=this._frameNumber}!this._budget.hasProgressed&&o.blockFrame!==this._frameNumber&&o.needsUpdate&&(o.name,Re.I3S_CONTROLLER,o.blockFrame=this._frameNumber),o.schedulePriority=o.basePriority;const a=this._budget.now()-n;if(o.runtime+=a,this._frameTaskTimes.set(o.priority,this._frameTaskTimes.get(o.priority)+a),this._budget.remaining<=0)return void this._updatingChanged()}while(this._schedule());this._updatingChanged()}_startFrameTaskTimes(){for(const n of Object.keys(Re))this._frameTaskTimes.set(Re[n],0)}_recordFrameTaskTimes(n){this._frameTaskTimes.forEach(((o,a)=>this.performanceInfo.tasks.get(a).push(o))),this.performanceInfo.total.push(n)}get test(){return this._test}}t.Scheduler=e;class r{get task(){return this._task.value}get updating(){return this._queue.running}constructor(n,o,a){this._scheduler=n,this.name=o,this.blockFrame=0,this.runtime=0,this._queue=new mme,this._handles=new Rm,this._basePriority=_N(o),this.schedulePriority=this._basePriority,this._task=gm(a??this._queue),this._handles.add(fs((()=>this.task.running),(l=>n.taskRunningChanged(l))))}remove(){this.processQueue(AA),this._scheduler.removeTask(this),this.schedule=SN.schedule,this.reschedule=SN.reschedule,this._handles.destroy()}get basePriority(){return this._basePriority}setPriority(n){if(this.name===n)return;this.name=n;const o=_N(n);this._basePriority!==Xs&&this.schedulePriority===0||(this.schedulePriority=o),this._basePriority=o}get priority(){return this.name}set priority(n){this.setPriority(n)}get needsUpdate(){return this.updating||this.task.running}schedule(n,o,a){return this._queue.push(n,o,a)}reschedule(n,o,a){return this._queue.unshift(n,o,a)}processQueue(n){return this._queue.runTask(n)}}class i{constructor(){this._begin=performance?.now()??0,this._budget=0,this._done=!1,this._progressed=!1,this._enabled=!0}run(n){return!this.done&&(n()===!0&&this.madeProgress(),!0)}get done(){return this._done}get budget(){return this._budget}madeProgress(){return this._progressed=!0,this._done=this.elapsed>=this._budget&&this._enabled,this._done}get enabled(){return this._enabled}set enabled(n){this._enabled=n}reset(n){this._begin=this.now(),this._budget=n,this.resetProgress()}get remaining(){return Math.max(this._budget-this.elapsed,0)}now(){return performance.now()}get elapsed(){return this.now()-this._begin}resetProgress(){this._progressed=!1,this._done=!1}get hasProgressed(){return this._progressed}}t.Budget=i})(jw||(jw={})),(function(t){t.SCHEDULED="s",t.READY="r",t.WAITING="w",t.IDLE="i"})(Ec||(Ec={}));const AA=new jw.Budget;AA.enabled=!1;let Sme=class{remove(){}processQueue(){}schedule(e,r,i){try{if(yn(r)){const s=St();return i?Promise.resolve(i(s)):Promise.reject(s)}return vM(e(AA))}catch(s){return Promise.reject(s)}}reschedule(e,r,i){return this.schedule(e,r,i)}};const SN=new Sme;let xme=class{constructor(e){this.view=e,this._stationaryHandle=null,this._frameTaskHandle=null,this._updateParameters=null,this._updateRequested=!1,this._scheduler=gme(),this._schedulerHandle=fs((()=>this._scheduler.updating),(()=>this.requestFrame())),this.stationary=!0,this.prepare=()=>{this._updateParameters&&(this._updateParameters.state=this.view.state,this._updateParameters.stationary=this.view.stationary,this._updateParameters.pixelRatio=window.devicePixelRatio,this._updateParameters.renderingOptions=this.view.renderingOptions,this._updateParameters.targetState.copy(this.view.state),this.view.animation?.target==null||Ia(this.view.animation.target)||(this._updateParameters.targetState.viewpoint=this.view.animation.target))},this.update=r=>{if(this._updateRequested=!1,this.view?.destroyed)return;const{allLayerViews:i,graphicsView:s,labelManager:n,state:{id:o}}=this.view;i?.forEach(this._updateLayerView,this),n!=null&&(n.lastUpdateId!==o&&(n.viewChange(),n.lastUpdateId=o),n.updateRequested&&n.processUpdate(this._updateParameters)),s!=null&&(s.lastUpdateId!==o&&(s.viewChange(),s.lastUpdateId=o),s.updateRequested&&s.processUpdate(this._updateParameters)),this.view.graphicsTileStore?.setViewState(this._updateParameters.state),this.view.animation?this._scheduler.state=di.ANIMATING:this.view.interacting?this._scheduler.state=di.INTERACTING:this._scheduler.state=di.IDLE,this._scheduler.frame(r)||this._updateRequested||this._scheduler.state!==di.IDLE||this._frameTaskHandle?.pause()}}destroy(){this.stop(),this._schedulerHandle.remove(),this._scheduler.destroy()}get scheduler(){return this._scheduler}start(){if(this._frameTaskHandle)return;const e=this.view;this.stationary=e.stationary,this._updateParameters={state:e.state,targetState:new PA,pixelRatio:window.devicePixelRatio,stationary:this.stationary,renderingOptions:e.renderingOptions},this._stationaryHandle=ie((()=>e.stationary),(r=>{this.stationary=r,this.requestFrame()})),this._frameTaskHandle=om(this),this.requestUpdate()}stop(){this._frameTaskHandle&&(this._updateRequested=!1,this._stationaryHandle?.remove(),this._frameTaskHandle.remove(),this._updateParameters=this._stationaryHandle=this._frameTaskHandle=null,this.stationary=!0)}requestUpdate(){this._updateRequested||(this._updateRequested=!0,this.requestFrame())}requestFrame(){this._frameTaskHandle&&this._frameTaskHandle.resume()}_updateLayerView(e){if(!e.attached)return void this.requestUpdate();const r=this.view.state,i=e.lastUpdateId;i!=null&&(this.stationary||e.moving)||(e.moving=!0),i!==r.id&&e.viewChange(),this.stationary&&e.moving&&(e.moving=!1,e.moveEnd()),e.lastUpdateId=r.id,e.updateRequested&&e.processUpdate(this._updateParameters),"layerViews"in e&&e.layerViews?.forEach(this._updateLayerView,this)}};function $me(t,e){const{spatialReference:r}=e,i=[e.x,e.y];let s,n,o,a;const l=[0,0],u=Mme(t);for(let m=0;m<u.length;m++){const y=u[m];for(let g=0;g<y.length-1;g++){qse(l,i,y,g);const v=I2(i,l);(s==null||v<s)&&(s=v,n=[...l],o=m,a=g)}}if(s==null||!n||o==null||a==null)throw new F("nearest-coordinate:failed","Failed to find the nearest coordinate");const[h,p]=n;return{coordinate:new ge({x:h,y:p,spatialReference:r}),distance:s}}function Mme(t){switch(t.type){case"extent":return[[[t.xmin,t.ymin],[t.xmin,t.ymax],[t.xmax,t.ymax],[t.xmax,t.ymin],[t.xmin,t.ymin]]];case"polygon":return t.rings;case"polyline":return t.paths}}var gI;let Eh=gI=class extends Pv.NumericIdentifiableMixin(ce){constructor(t){super(t),this.geometry=null,this.spatialReference=null}get normalizedGeometry(){if(this.geometry==null||!this.spatialReference)return null;if(!this.spatialReference.equals(this.geometry.spatialReference))try{return bc(this.geometry,this.spatialReference)}catch(t){return q.getLogger(this).error("#constraints.geometry","could not project the geometry to the view's spatial reference",{geometry:this.geometry,spatialReference:this.spatialReference,error:t}),null}return this.geometry}constrain(t,e){if(this.normalizedGeometry==null)return t;const r=t.targetGeometry;if(this.normalizedGeometry.type==="extent"?xv(this.normalizedGeometry,r):S3(this.normalizedGeometry,r))return t;const{coordinate:i}=$me(this.normalizedGeometry,r);return i&&(t.targetGeometry=i),t}clone(){return new gI({geometry:this.geometry?.clone(),spatialReference:this.spatialReference?.clone()})}};c([d({constructOnly:!0})],Eh.prototype,"geometry",void 0),c([d({readOnly:!0})],Eh.prototype,"normalizedGeometry",null),c([d({constructOnly:!0})],Eh.prototype,"spatialReference",void 0),Eh=gI=c([C("esri.views.2d.constraints.GeometryConstraint")],Eh);var vI;let _g=vI=class extends Pv.NumericIdentifiableMixin(ce){constructor(){super(...arguments),this.enabled=!0,this.rotationEnabled=!0}constrain(t,e){return this.enabled&&e&&(this.rotationEnabled||(t.rotation=e.rotation)),t}clone(){return new vI({enabled:this.enabled,rotationEnabled:this.rotationEnabled})}};c([d()],_g.prototype,"enabled",void 0),c([d()],_g.prototype,"rotationEnabled",void 0),_g=vI=c([C("esri.views.2d.constraints.RotationConstraint")],_g);const V7=_g;var _I;let Ji=_I=class extends Pv.NumericIdentifiableMixin(ce){constructor(t){super(t),this._lodByScale={},this._scales=[],this.effectiveLODs=null,this.effectiveMinZoom=-1,this.effectiveMaxZoom=-1,this.effectiveMinScale=0,this.effectiveMaxScale=0,this.lods=null,this.minZoom=-1,this.maxZoom=-1,this.minScale=0,this.maxScale=0,this.snapToZoom=!0}initialize(){let t,{lods:e,minScale:r,maxScale:i,minZoom:s,maxZoom:n}=this,o=-1,a=-1,l=!1,u=!1;if(r!==0&&i!==0&&r<i&&([r,i]=[i,r]),!e?.length)return this._set("effectiveMinScale",r),void this._set("effectiveMaxScale",i);e=e.map((h=>h.clone())),e.sort(((h,p)=>p.scale-h.scale)),e.forEach(((h,p)=>h.level=p));for(const h of e)!l&&r>0&&r>=h.scale&&(o=h.level,l=!0),!u&&i>0&&i>=h.scale&&(a=t?t.level:-1,u=!0),t=h;s===-1&&(s=r===0?0:o),n===-1&&(n=i===0?e.length-1:a),s=Math.max(s,0),s=Math.min(s,e.length-1),n=Math.max(n,0),n=Math.min(n,e.length-1),s>n&&([s,n]=[n,s]),r=e[s].scale,i=e[n].scale,e.splice(0,s),e.splice(n-s+1),e.forEach(((h,p)=>{this._lodByScale[h.scale]=h,this._scales[p]=h.scale})),this._set("effectiveLODs",e),this._set("effectiveMinZoom",s),this._set("effectiveMaxZoom",n),this._set("effectiveMinScale",r),this._set("effectiveMaxScale",i)}constrain(t,e){if(e&&t.scale===e.scale)return t;const r=this.effectiveMinScale,i=this.effectiveMaxScale,s=t.targetGeometry,n=e&&e.targetGeometry,o=i!==0&&t.scale<i,a=r!==0&&t.scale>r;if(o||a){const l=a?r:i;if(e&&n){const u=(l-e.scale)/(t.scale-e.scale);s.x=n.x+(s.x-n.x)*u,s.y=n.y+(s.y-n.y)*u}t.scale=l}return this.snapToZoom&&this.effectiveLODs&&(t.scale=this._getClosestScale(t.scale)),t}fit(t){if(!this.effectiveLODs||!this.snapToZoom)return this.constrain(t,null);const e=this.scaleToZoom(t.scale),r=Math.abs(e-Math.floor(e));return t.scale=this.zoomToScale(r>.99?Math.round(e):Math.floor(e)),t}zoomToScale(t){if(!this.effectiveLODs)return 0;t-=this.effectiveMinZoom,t=Math.max(0,t);const e=this._scales;if(t<=0)return e[0];if(t>=e.length)return e[e.length-1];const r=Math.floor(t),i=Math.ceil(t);return e[r]+(t-r)*(e[i]-e[r])}scaleToZoom(t){if(!this.effectiveLODs)return-1;const e=this._scales;let r,i;if(t>=e[0])return this.effectiveMinZoom;if(t<=e[e.length-1])return this.effectiveMaxZoom;for(let s=0;s<e.length-1;s++){if(r=e[s],i=e[s+1],i===t)return s+this.effectiveMinZoom+1;if(r>t&&i<t)return s+this.effectiveMinZoom+1-(t-i)/(r-i)}return-1}snapToClosestScale(t){if(!this.effectiveLODs)return t;const e=this.scaleToZoom(t);return this.zoomToScale(Math.round(e))}snapToNextScale(t,e=.5){if(!this.effectiveLODs)return t*e;const r=Math.round(this.scaleToZoom(t));return this.zoomToScale(r+1)}snapToPreviousScale(t,e=2){if(!this.effectiveLODs)return t*e;const r=Math.round(this.scaleToZoom(t));return this.zoomToScale(r-1)}clone(){return new _I({lods:this.lods,minZoom:this.minZoom,maxZoom:this.maxZoom,minScale:this.minScale,maxScale:this.maxScale})}_getClosestScale(t){return this._lodByScale[t]||(t=this._scales.reduce(((e,r)=>Math.abs(r-t)<=Math.abs(e-t)?r:e),this._scales[0])),this._lodByScale[t].scale}};c([d({readOnly:!0})],Ji.prototype,"effectiveLODs",void 0),c([d({readOnly:!0})],Ji.prototype,"effectiveMinZoom",void 0),c([d({readOnly:!0})],Ji.prototype,"effectiveMaxZoom",void 0),c([d({readOnly:!0})],Ji.prototype,"effectiveMinScale",void 0),c([d({readOnly:!0})],Ji.prototype,"effectiveMaxScale",void 0),c([d()],Ji.prototype,"lods",void 0),c([d()],Ji.prototype,"minZoom",void 0),c([d()],Ji.prototype,"maxZoom",void 0),c([d()],Ji.prototype,"minScale",void 0),c([d()],Ji.prototype,"maxScale",void 0),c([d()],Ji.prototype,"snapToZoom",void 0),Ji=_I=c([C("esri.views.2d.constraints.ZoomConstraint")],Ji);const j7=Ji,Tme={base:null,key:"type",typeMap:{extent:Le,polygon:yt}};let Wt=class extends ce{constructor(e){super(e),this.lods=null,this.minScale=0,this.maxScale=0,this.minZoom=-1,this.maxZoom=-1,this.rotationEnabled=!0,this.snapToZoom=!0,this.customConstraints=new se}destroy(){this.view=null}get effectiveLODs(){return this._zoom.effectiveLODs}get effectiveMinScale(){return this._zoom.effectiveMinScale}get effectiveMaxScale(){return this._zoom.effectiveMaxScale}get effectiveMinZoom(){return this._zoom.effectiveMinZoom}get effectiveMaxZoom(){return this._zoom.effectiveMaxZoom}set geometry(e){e?this._set("geometry",e):this._set("geometry",null)}get version(){return`${this._zoom?.uid}/${this._rotation?.uid}/${this._geometry?.uid}`}get _geometry(){const e=this._get("_geometry");return e&&this.geometry===e.geometry&&this.view?.constraintsInfo.spatialReference===e.spatialReference?e:new Eh({geometry:this.geometry,spatialReference:this.view?.constraintsInfo.spatialReference})}get _rotation(){return new V7({rotationEnabled:this.rotationEnabled})}get _zoom(){const e=this._get("_zoom"),r=this.lods||this.view?.constraintsInfo.lods,i=this.minZoom,s=this.maxZoom,n=this.minScale,o=this.maxScale,a=this.snapToZoom;return e&&e.lods===r&&e.minZoom===i&&e.maxZoom===s&&e.minScale===n&&e.maxScale===o&&e.snapToZoom===a?e:new j7({lods:r,minZoom:i,maxZoom:s,minScale:n,maxScale:o,snapToZoom:a})}canZoomInTo(e){const r=this.effectiveMaxScale;return r===0||e>=r}canZoomOutTo(e){const r=this.effectiveMinScale;return r===0||e<=r}constrain(e,r){return this._zoom.constrain(e,r),this._rotation.constrain(e,r),this._geometry.constrain(e,r),this.customConstraints.forEach((i=>i.constrain(e,r))),e}constrainByGeometry(e){return this._geometry.constrain(e),this.customConstraints.forEach((r=>r.applyPanConstraint?.(e))),e}fit(e){return this._zoom.fit(e)}zoomToScale(e){return this._zoom.zoomToScale(e)}scaleToZoom(e){return this._zoom.scaleToZoom(e)}snapScale(e){return this._zoom.snapToClosestScale(e)}snapToNextScale(e){return this._zoom.snapToNextScale(e)}snapToPreviousScale(e){return this._zoom.snapToPreviousScale(e)}};c([d({readOnly:!0})],Wt.prototype,"effectiveLODs",null),c([d({readOnly:!0})],Wt.prototype,"effectiveMinScale",null),c([d({readOnly:!0})],Wt.prototype,"effectiveMaxScale",null),c([d({readOnly:!0})],Wt.prototype,"effectiveMinZoom",null),c([d({readOnly:!0})],Wt.prototype,"effectiveMaxZoom",null),c([d({types:Tme,value:null})],Wt.prototype,"geometry",null),c([d({type:[ti]})],Wt.prototype,"lods",void 0),c([d()],Wt.prototype,"minScale",void 0),c([d()],Wt.prototype,"maxScale",void 0),c([d()],Wt.prototype,"minZoom",void 0),c([d()],Wt.prototype,"maxZoom",void 0),c([d()],Wt.prototype,"rotationEnabled",void 0),c([d()],Wt.prototype,"snapToZoom",void 0),c([d({type:se})],Wt.prototype,"customConstraints",void 0),c([d()],Wt.prototype,"view",void 0),c([d({readOnly:!0})],Wt.prototype,"version",null),c([d({type:Eh,readOnly:!0})],Wt.prototype,"_geometry",null),c([d({type:V7})],Wt.prototype,"_rotation",null),c([d({readOnly:!0,type:j7})],Wt.prototype,"_zoom",null),Wt=c([C("esri.views.2d.MapViewConstraints")],Wt);const xN=Wt;let ci=class extends ce{constructor(e){super(e),this.constraints=null,this.ready=!1,this.resizeAlign="center",this.addHandles([ie((()=>this.constraints?.version),(r=>{this.constraints&&r&&this.ready&&(this.state.viewpoint=this.constraints.fit(this.state.paddedViewState.viewpoint))}),Ma)])}get center(){if(!this.ready)return this._get("center");const{center:e,spatialReference:r}=this.state.paddedViewState;return this.state.commitProperty("id"),new ge({x:e[0],y:e[1],spatialReference:r})}set center(e){if(e==null)return;if(!this.ready)return void this._set("center",e);let r;try{r=this._project(e,this.state.spatialReference)}catch(s){return void q.getLogger(this).error(new F("mapview:invalid-center","could not project the value in the view's spatial reference",{input:e,error:s}))}const i=this.viewpoint;dI(i,i,r),this.viewpoint=i}get extent(){return this.ready?(this.state.commitProperty("id"),this.state.paddedViewState.extent.clone()):this._get("extent")}set extent(e){if(e==null)return;if(!e.width||!e.height)return void q.getLogger(this).error(new F("mapview:invalid-extent","invalid extent size"));if(!this.ready)return this._set("extent",e),this._set("center",void 0),this._set("viewpoint",void 0),this._set("scale",void 0),void this._set("zoom",void 0);let r;try{r=this._project(e,this.state.spatialReference)}catch(s){return void q.getLogger(this).error(new F("mapview:invalid-extent","could not project the value in the view's spatial reference",{error:s}))}const i=this.viewpoint;bfe(i,i,r,this.state.size,{constraints:this.constraints}),this.viewpoint=i}get padding(){return this.ready?this.state.padding:this._get("padding")}set padding(e){this.ready?(this.state.padding=e,this._set("padding",this.state.padding)):this._set("padding",e)}get resolution(){return this.ready?(this.state.commitProperty("id"),this.state.resolution):0}get rotation(){return this.ready?(this.state.commitProperty("id"),this.state.rotation):this._get("rotation")}set rotation(e){if(isNaN(e))return;if(!this.ready)return void this._set("rotation",e);const r=this.viewpoint;Pfe(r,r,e),this.viewpoint=r}get scale(){return this.ready?(this.state.commitProperty("id"),this.state.scale):this._get("scale")}set scale(e){if(!e||isNaN(e))return;if(!this.ready){this._set("scale",e),this._set("zoom",void 0);const i=this._get("extent");return void(i&&(this._set("extent",void 0),this._set("center",i.center)))}const r=this.viewpoint;mN(r,r,e),this.viewpoint=r}get viewpoint(){return this.ready?this.state.paddedViewState.viewpoint.clone():this._get("viewpoint")}set viewpoint(e){if(e==null)return;if(!this.ready)return this._set("viewpoint",e),this._set("extent",void 0),this._set("center",void 0),this._set("zoom",void 0),void this._set("scale",void 0);let r,i;try{r=this._project(e,this.state.spatialReference),!e.scale||isNaN(e.scale)?i=new F("mapview:invalid-viewpoint",`invalid scale value of ${e.scale}`):e.targetGeometry==null&&(i=new F("mapview:invalid-viewpoint","geometry not defined"))}catch(n){i=new F("mapview:invalid-viewpoint","could not project the value in the view's spatial reference",{error:n})}if(i)return void q.getLogger(this).error(i);this._scaleBeforeChangingSpatialReference=null;const s=new mn({targetGeometry:new ge,scale:0,rotation:0});wi(s,r),this.constraints?.constrain(s,this.state.paddedViewState.viewpoint),this.state.viewpoint=s,this._set("viewpoint",s)}get visibleArea(){return this.ready?this.state.visibleArea:null}get zoom(){return this.ready?this.constraints?.scaleToZoom(this.scale)??-1:this._get("zoom")}set zoom(e){if(!(e>=0))return;if(!this.ready){this._set("zoom",e),this._set("scale",void 0);const s=this._get("extent");return void(s&&(this._set("extent",void 0),this._set("center",s.center)))}const r=this.constraints?.zoomToScale(e)??0;if(!r)return void this._set("zoom",-1);const i=this.viewpoint;mN(i,i,r),this.viewpoint=i,this._set("zoom",this.constraints?.scaleToZoom(this.scale)??-1)}getUserStartupOptions(e){if(!e[0]&&!e[1])return{center:void 0,rotation:void 0,scale:void 0};const{padding:r,constraints:i}=this,s=this._get("center"),n=this._get("extent"),o=this._get("scale"),a=this._get("rotation"),l=this._get("viewpoint"),u=this._get("zoom"),h=u!=null&&i!=null&&i.zoomToScale(u)||void 0;let p,m,y;const g=l?.rotation,v=l?.targetGeometry;v?.type==="extent"?p=v:v?.type==="point"&&(m=v,y=l?.scale);const _=n??p;return{center:s??m??_?.center,rotation:a??g,scale:(o??h??y??(_&&P2(_,[e[0]-r.left-r.right,e[1]-r.top-r.bottom])))||void 0}}startup(e,r,i,s){const n=e.targetGeometry;try{this._project(e,i)}catch(o){q.getLogger(this).warn(new Fs("mapview:startup-projection-error","projection of initial viewpoint to the view's spatial reference, defaulting to the initial viewpoint.",{center:n.toJSON(),spatialReference:i,error:o})),e.targetGeometry=s||new ge({x:0,y:0,spatialReference:i})}this.constraints?.fit(e),this._set("state",new PA({padding:this.padding,size:r,viewpoint:e})),this._set("ready",!0)}teardown(){this._set("ready",!1);const{center:[e,r],spatialReference:i,rotation:s,scale:n}=this.state.paddedViewState,o=new ge({x:e,y:r,spatialReference:i});this._set("viewpoint",null),this._set("extent",null),this._set("center",o),this._set("zoom",-1),this._set("rotation",s),this._set("scale",n),this._set("state",null)}changeSpatialReference(e){const r=this.state.paddedViewState.clone();if(this._scaleBeforeChangingSpatialReference==null)this._scaleBeforeChangingSpatialReference=r.scale;else{const l=r.viewpoint.clone();l.scale=this._scaleBeforeChangingSpatialReference,r.viewpoint=l}const i=r.clone(),[s,n]=r.center;let o=null;try{o=this._project(new ge({x:s,y:n,spatialReference:r.spatialReference}),e)}catch(l){g3()||q.getLogger(this).warn(new Fs("mapview:spatial-reference-change","could not project the view's center to the new spatial reference",{center:o?.toJSON(),spatialReference:e,error:l}))}o||(o=new ge({x:0,y:0,spatialReference:e}));const a=dI(new mn({targetGeometry:new ge,scale:0,rotation:0}),r.viewpoint,o);i.viewpoint=a;try{const u=[r.size[0]/2,r.size[1]/2],h=[u[0]+20,u[1]],p=r.toMap([0,0],h),{x:m,y}=this._project(new ge({x:p[0],y:p[1],spatialReference:r.spatialReference}),e);p[0]=m,p[1]=y,i.toScreen(p,p);const g=Efe(u,p,h),v=Math.hypot(p[0]-u[0],p[1]-u[1])/20;!Number.isFinite(v)||Math.abs(v)>4?(a.rotation=0,a.targetGeometry=new ge({x:0,y:0,spatialReference:e})):(a.scale*=v,a.scale>z("mapview-srswitch-adjust-rotation-scale-threshold")?a.rotation=0:a.rotation+=Number.isFinite(g)?g:0)}catch{}this._get("constraints")?.constrain(a,void 0),this._get("state").viewpoint=a}resize(e,r){if(!this.ready)return;const i=this.state;let s=this.state.paddedViewState.viewpoint;const n=this.state.paddedViewState.size.slice();i.size=[e,r],Cfe(s,s,n,this.state.paddedViewState.size,this.resizeAlign),s=this.constraints?.constrain(s,void 0)??s,this.state.viewpoint=s}toMap(e){if(!this.ready)return null;const r=[0,0],[i,s]=this.state.toMap(r,[e.x,e.y]),n=this.state.spatialReference;return new ge({x:i,y:s,spatialReference:n})}toScreen(e,r){if(!this.ready)return null;const i=this._project(e,this.state.spatialReference),s=[i.x,i.y];return r?.pickClosestTarget===!1||this.state.paddedViewState.wrapMapCoordinate(s,s),this.state.toScreen(s,s),or(s[0],s[1])}_project(e,r){const i=e?.targetGeometry||e;if(!r)return e;if(!i)return null;if(r.imageCoordinateSystem||i.spatialReference?.imageCoordinateSystem||mr(r,i.spatialReference))return e;const s=bc(i,r);if(!s)throw new F("mapview:projection-not-possible","projecting input geometry to target spatial reference returned a null value",{geometry:i,spatialReference:r});return Eme(e)?(e.targetGeometry=s,e):s}};function Eme(t){return t?.declaredClass==="esri.Viewpoint"}c([d({type:ge})],ci.prototype,"center",null),c([d()],ci.prototype,"constraints",void 0),c([d({type:Le})],ci.prototype,"extent",null),c([d({value:{top:0,right:0,bottom:0,left:0},cast:t=>({top:0,right:0,bottom:0,left:0,...t})})],ci.prototype,"padding",null),c([d()],ci.prototype,"ready",void 0),c([d()],ci.prototype,"resizeAlign",void 0),c([d({readOnly:!0})],ci.prototype,"resolution",null),c([d({type:Number})],ci.prototype,"rotation",null),c([d({type:Number})],ci.prototype,"scale",null),c([d({readOnly:!0})],ci.prototype,"state",void 0),c([d({type:mn})],ci.prototype,"viewpoint",null),c([d({readOnly:!0})],ci.prototype,"visibleArea",null),c([d()],ci.prototype,"zoom",null),ci=c([C("esri.views.2d.ViewStateManager")],ci);const $N=160;let bg=class extends ce{constructor(){super(...arguments),this._timer=void 0}get stationary(){return!this._timer}flip(){this._timestamp=performance.now(),this._timer==null&&(this._timer=setInterval((()=>{performance.now()-this._timestamp>=$N&&this.clear()}),$N))}clear(){this._timer&&(clearInterval(this._timer),this._timer=void 0)}};c([d()],bg.prototype,"_timer",void 0),c([d()],bg.prototype,"stationary",null),bg=c([C("esri.views.2d.support.StationaryManager")],bg);const Ime=t=>{let e=class extends t{constructor(...r){super(...r),this.fullOpacity=1,this.stateManager=new ci({constraints:new xN({view:this})}),this.stationaryManager=new bg,this.mapViewNavigation=null,this.renderingOptions={samplingMode:"dynamic",edgeLabelsVisible:!1,labelsAnimationTime:0,labelCollisionsEnabled:!1},this.frameTask=new xme(this),this.viewEvents=new GG(this),this.padding={top:0,right:0,bottom:0,left:0},this.addHandles([ie((()=>this.viewpoint),(()=>this.stationaryManager.flip()),Ma)])}get constraintsInfo(){return{lods:null,spatialReference:null}}get extent(){return this.stateManager?.extent??null}set extent(r){this.stateManager.extent=r}get state(){return this.stateManager.state}get interacting(){return!1}get stationary(){return!this.animation&&this.stationaryManager.stationary}set animation(r){const i=this._get("animation");if(r===i)return;if(i&&i.stop(),r!==this.animationManager.animation&&this.animationManager.stop(),!r||r.isFulfilled())return void this._set("animation",null);this._set("animation",r);const s=()=>{this.destroyed||r===this._get("animation")&&(this._set("animation",null),this.frameTask?.requestFrame())};r.when(s,s)}get constraints(){return this.stateManager?.constraints}set constraints(r){r.view=this;const i=this.stateManager.constraints;this.stateManager.constraints=r,i?.destroy()}get padding(){return this.stateManager?.padding}set padding(r){this.stateManager&&(this.stateManager.padding=r)}get resizeAlign(){return this.stateManager.resizeAlign}set resizeAlign(r){this.stateManager.resizeAlign=r}get rotation(){return this.stateManager.rotation??0}set rotation(r){const{rotationEnabled:i}=this.constraints;this.constraints.rotationEnabled=!0,this.stateManager.rotation=r,this.constraints.rotationEnabled=i}get viewpoint(){return this.stateManager.viewpoint??null}set viewpoint(r){this.stateManager.viewpoint=r,this.frameTask.requestFrame()}};return c([d({readOnly:!0})],e.prototype,"animationManager",void 0),c([d({readOnly:!0})],e.prototype,"fullOpacity",void 0),c([d()],e.prototype,"stateManager",void 0),c([d()],e.prototype,"constraintsInfo",null),c([d()],e.prototype,"extent",null),c([d({readOnly:!0})],e.prototype,"state",null),c([d({readOnly:!0})],e.prototype,"mapViewNavigation",void 0),c([d()],e.prototype,"renderingOptions",void 0),c([d({readOnly:!0})],e.prototype,"interacting",null),c([d()],e.prototype,"stationary",null),c([d()],e.prototype,"animation",null),c([d({type:xN})],e.prototype,"constraints",null),c([d()],e.prototype,"padding",null),c([d()],e.prototype,"resizeAlign",null),c([d()],e.prototype,"rotation",null),c([d({readOnly:!0})],e.prototype,"viewEvents",void 0),c([d({type:mn})],e.prototype,"viewpoint",null),e=c([C("esri.views.Viewport2DBaseMixin")],e),e};let bu=class extends Tl{constructor(e){super(e),this.state="running",this.target=null,this._resolver=null}initialize(){this._resolver=Ns(),this.addResolvingPromise(this._resolver.promise)}get done(){return this.state==="finished"||this.state==="stopped"}stop(){this.state!=="stopped"&&this.state!=="finished"&&(this._set("state","stopped"),this._resolver?.reject(new F("view:animation-stopped","ViewAnimation stopped")))}finish(){this.state!=="stopped"&&this.state!=="finished"&&(this._set("state","finished"),this._resolver?.resolve())}update(e,r){r||(r=Ia(e)?"waiting-for-target":"running"),this._set("target",e),this._set("state",r)}};c([d({readOnly:!0})],bu.prototype,"done",null),c([d({readOnly:!0,type:String})],bu.prototype,"state",void 0),c([d()],bu.prototype,"target",void 0),bu=c([C("esri.views.ViewAnimation")],bu),(function(t){t.State={RUNNING:"running",STOPPED:"stopped",FINISHED:"finished",WAITING_FOR_TARGET:"waiting-for-target"}})(bu||(bu={}));const bI=bu;let ub=class extends ce{constructor(e){super(e),this._gotoTask=null}destroy(){this._gotoTask=null}async goTo(e,r){if(!e)return void q.getLogger(this).error("#goTo()","target cannot be null or undefined");const i=new bI;this.view.animation=i,await Ev((()=>this.view.ready),r);const s={...r,animate:r?.animate??!JG(),animationMode:r?.animationMode??"auto"},{extent:n,spatialReference:o,size:a,viewpoint:l,constraints:u,padding:h,allLayerViews:p}=this.view,m=gfe(e,{extent:n,spatialReference:o,size:a,viewpoint:l,constraints:u,padding:h,allLayerViews:p,pickClosestTarget:r?.pickClosestTarget??!0});return i?.update(m),this._gotoTask={},s.animate?this._gotoAnimated(m,s):this._gotoImmediate(m,s)}_gotoImmediate(e,r){const i=this._gotoTask,s=this.view.animation,n=e.then((o=>{if(xt(r),i!==this._gotoTask)throw new F("view:goto-interrupted","Goto was interrupted");this.view.viewpoint=s.target=o,s.finish()}));return this._cancellableGoTo(i,s,n,r)}_gotoAnimated(e,r){const i=this._gotoTask,s=this.view.animation;if(!s)return Promise.resolve();const n=e.then((o=>{if(xt(r),i!==this._gotoTask)throw new F("view:goto-interrupted","Goto was interrupted");return s.update(o),this.view.animationManager.animate(s,this.view.viewpoint,r),s.when().then((()=>{}),(()=>{}))}));return this._cancellableGoTo(i,s,n,r)}_cancellableGoTo(e,r,i,s){const n=()=>e===this._gotoTask;return Fz(i,s).finally((()=>{n()&&(r.done||r.stop())}))}};c([d({constructOnly:!0})],ub.prototype,"view",void 0),ub=c([C("esri.views.2d.GoToManager")],ub);function U7(t,e){switch(e){case"primary":return t.pointerType==="touch"||t.button===0;case"secondary":return t.pointerType!=="touch"&&t.button===2;case"tertiary":return t.pointerType!=="touch"&&t.button===1}}function G7(t,e){return e.some((r=>U7(t,r)))}function MN(t,{dragPrimary:e,dragSecondary:r,dragTertiary:i}){return[{key:"primary",value:e},{key:"secondary",value:r},{key:"tertiary",value:i}].filter((s=>s.value===t)).map((s=>s.key))}let TN=class extends Ar{constructor(e,r){super(!0),this._view=e,this.registerIncoming("double-click",r,(i=>this._handleDoubleClick(i,r)))}_handleDoubleClick(e,r){U7(e.data,"primary")&&(e.stopPropagation(),r?this._view.mapViewNavigation.zoomOut([e.data.x,e.data.y]):this._view.mapViewNavigation.zoomIn([e.data.x,e.data.y]))}},Cme=class extends Ar{constructor(e,r,i){super(!0),this.view=e,this.pointerType=r,this.registerIncoming("double-tap-drag",i,(s=>this._handleDoubleTapDrag(s)))}_handleDoubleTapDrag(e){const{data:r}=e,{pointerType:i}=r;if(i!==this.pointerType)return;e.stopPropagation();const{action:s,delta:n}=r,{view:o}=this,{mapViewNavigation:a}=o;switch(s){case"begin":{const{scale:l}=o;this._startScale=l,this._currentScale=l,this._previousDelta=n,a.begin();break}case"update":{if(this._previousDelta.y===n.y)return;this._previousDelta=n;const l=1.015**n.y,u=this._startScale*l,h=u/this._currentScale;a.setViewpointImmediate(h),this._currentScale=u;break}case"end":{const{constraints:l}=o,{effectiveLODs:u,snapToZoom:h}=l;if(!h||!u)return void a.end();const p=l.snapScale(this._currentScale),m=(n.y>0?Math.max(p,l.snapToPreviousScale(this._startScale)):Math.min(p,l.snapToNextScale(this._startScale)))/this._currentScale;a.zoom(m).then((()=>{a.end()}));break}}}},L2=class{constructor(e){this._callbacks=e,this._currentCount=0,this._callbacks.condition||(this._callbacks.condition=()=>!0)}handle(e){const r=e.data,i=r.pointers.size;switch(r.action){case"start":this._currentCount=i,this._emitStart(e);break;case"added":this._emitEnd(this._previousEvent),this._currentCount=i,this._emitStart(e);break;case"update":this._emitUpdate(e);break;case"removed":this._startEvent&&this._emitEnd(this._previousEvent),this._currentCount=i,this._emitStart(e);break;case"end":this._emitEnd(e),this._currentCount=0}this._previousEvent=e}_emitStart(e){this._startEvent=e,this._callbacks.condition?.(this._currentCount,e)&&this._callbacks.start(this._currentCount,e,this._startEvent)}_emitUpdate(e){this._callbacks.condition?.(this._currentCount,e)&&this._callbacks.update(this._currentCount,e,this._startEvent)}_emitEnd(e){this._callbacks.condition?.(this._currentCount,e)&&this._callbacks.end(this._currentCount,e,this._startEvent),this._startEvent=null}},Pme=class extends Ar{constructor(e,r,i){super(!0),this.view=e,this.pointerActions=r,this.registerIncoming("drag",i,(s=>this._handleDrag(s))),this.registerIncoming("pointer-down",(()=>this.stopMomentumNavigation()))}onInstall(e){super.onInstall(e),this._dragEventSeparator=new L2({start:(r,i)=>{this.view.mapViewNavigation.pan.begin(this.view,i.data),i.stopPropagation()},update:(r,i)=>{this.view.mapViewNavigation.pan.update(this.view,i.data),i.stopPropagation()},end:(r,i)=>{this.view.mapViewNavigation.pan.end(this.view,i.data),i.stopPropagation()},condition:(r,i)=>r===1&&G7(i.data,this.pointerActions)})}_handleDrag(e){const r=this.view.mapViewNavigation;r.pinch.zoomMomentum||r.pinch.rotateMomentum?this.stopMomentumNavigation():this._dragEventSeparator.handle(e)}stopMomentumNavigation(){this.view.mapViewNavigation.pan.stopMomentumNavigation()}},Ame=class extends Ar{constructor(e,r,i){super(!0),this._view=e,this.pointerActions=r;const s=this._view.mapViewNavigation;this._dragEventSeparator=new L2({start:(n,o)=>{s.rotate.begin(this._view,o.data),o.stopPropagation()},update:(n,o)=>{s.rotate.update(this._view,o.data),o.stopPropagation()},end:(n,o)=>{s.rotate.end(),o.stopPropagation()},condition:(n,o)=>n===1&&G7(o.data,this.pointerActions)}),this.registerIncoming("drag",i,(n=>this._dragEventSeparator.handle(n)))}};function B7(t){const e=t[0],r=t[1],i=t[2];return Math.sqrt(e*e+r*r+i*i)}function Lme(t,e){return t[0]=e[0],t[1]=e[1],t[2]=e[2],t}function Rme(t,e,r,i){return t[0]=e,t[1]=r,t[2]=i,t}function kme(t,e,r){return t[0]=e[0]+r[0],t[1]=e[1]+r[1],t[2]=e[2]+r[2],t}function q7(t,e,r){return t[0]=e[0]-r[0],t[1]=e[1]-r[1],t[2]=e[2]-r[2],t}function H7(t,e,r){return t[0]=e[0]*r[0],t[1]=e[1]*r[1],t[2]=e[2]*r[2],t}function W7(t,e,r){return t[0]=e[0]/r[0],t[1]=e[1]/r[1],t[2]=e[2]/r[2],t}function Ome(t,e){return t[0]=Math.ceil(e[0]),t[1]=Math.ceil(e[1]),t[2]=Math.ceil(e[2]),t}function Nme(t,e){return t[0]=Math.floor(e[0]),t[1]=Math.floor(e[1]),t[2]=Math.floor(e[2]),t}function Fme(t,e){return t[0]=Math.abs(e[0]),t[1]=Math.abs(e[1]),t[2]=Math.abs(e[2]),t}function Dme(t,e){return t[0]=Math.sign(e[0]),t[1]=Math.sign(e[1]),t[2]=Math.sign(e[2]),t}function zme(t,e,r){return t[0]=Math.min(e[0],r[0]),t[1]=Math.min(e[1],r[1]),t[2]=Math.min(e[2],r[2]),t}function Vme(t,e,r){return t[0]=Math.max(e[0],r[0]),t[1]=Math.max(e[1],r[1]),t[2]=Math.max(e[2],r[2]),t}function jme(t,e=0,r=1){return t[0]=Math.min(Math.max(t[0],e),r),t[1]=Math.min(Math.max(t[1],e),r),t[2]=Math.min(Math.max(t[2],e),r),t}function Ume(t,e){return t[0]=Math.round(e[0]),t[1]=Math.round(e[1]),t[2]=Math.round(e[2]),t}function Z7(t,e,r){return t[0]=e[0]*r,t[1]=e[1]*r,t[2]=e[2]*r,t}function Gme(t,e,r,i){return t[0]=e[0]+r[0]*i,t[1]=e[1]+r[1]*i,t[2]=e[2]+r[2]*i,t}function J7(t,e){const r=e[0]-t[0],i=e[1]-t[1],s=e[2]-t[2];return Math.sqrt(r*r+i*i+s*s)}function Y7(t,e){const r=e[0]-t[0],i=e[1]-t[1],s=e[2]-t[2];return r*r+i*i+s*s}function X7(t){const e=t[0],r=t[1],i=t[2];return e*e+r*r+i*i}function Bme(t,e){return t[0]=-e[0],t[1]=-e[1],t[2]=-e[2],t}function qme(t,e){return t[0]=1/e[0],t[1]=1/e[1],t[2]=1/e[2],t}function wI(t,e){const r=e[0],i=e[1],s=e[2];let n=r*r+i*i+s*s;return n>0&&(n=1/Math.sqrt(n),t[0]=e[0]*n,t[1]=e[1]*n,t[2]=e[2]*n),t}function K7(t,e){return t[0]*e[0]+t[1]*e[1]+t[2]*e[2]}function Hme(t,e,r){const i=e[0],s=e[1],n=e[2],o=r[0],a=r[1],l=r[2];return t[0]=s*l-n*a,t[1]=n*o-i*l,t[2]=i*a-s*o,t}function Wme(t,e,r){const i=e[0],s=e[1],n=e[2],o=r[0],a=r[1],l=r[2],u=s*l-n*a,h=n*o-i*l,p=i*a-s*o,m=Math.sqrt(u*u+h*h+p*p);return t[0]=u/m,t[1]=h/m,t[2]=p/m,t}function Zme(t,e,r,i){const s=e[0],n=e[1],o=e[2];return t[0]=s+i*(r[0]-s),t[1]=n+i*(r[1]-n),t[2]=o+i*(r[2]-o),t}function Jme(t,e,r,i,s,n){const o=n*n,a=o*(2*n-3)+1,l=o*(n-2)+n,u=o*(n-1),h=o*(3-2*n);return t[0]=e[0]*a+r[0]*l+i[0]*u+s[0]*h,t[1]=e[1]*a+r[1]*l+i[1]*u+s[1]*h,t[2]=e[2]*a+r[2]*l+i[2]*u+s[2]*h,t}function Yme(t,e,r,i,s,n){const o=1-n,a=o*o,l=n*n,u=a*o,h=3*n*a,p=3*l*o,m=l*n;return t[0]=e[0]*u+r[0]*h+i[0]*p+s[0]*m,t[1]=e[1]*u+r[1]*h+i[1]*p+s[1]*m,t[2]=e[2]*u+r[2]*h+i[2]*p+s[2]*m,t}function Xme(t,e=1){const r=y2,i=2*r()*Math.PI,s=2*r()-1,n=Math.sqrt(1-s*s)*e;return t[0]=Math.cos(i)*n,t[1]=Math.sin(i)*n,t[2]=s*e,t}function Kme(t,e,r){const i=e[0],s=e[1],n=e[2];return t[0]=r[0]*i+r[4]*s+r[8]*n+r[12],t[1]=r[1]*i+r[5]*s+r[9]*n+r[13],t[2]=r[2]*i+r[6]*s+r[10]*n+r[14],t}function Qme(t,e,r){const i=e[0],s=e[1],n=e[2];return t[0]=i*r[0]+s*r[3]+n*r[6],t[1]=i*r[1]+s*r[4]+n*r[7],t[2]=i*r[2]+s*r[5]+n*r[8],t}function eye(t,e,r){const i=r[0],s=r[1],n=r[2],o=r[3],a=e[0],l=e[1],u=e[2],h=s*u-n*l,p=n*a-i*u,m=i*l-s*a,y=s*m-n*p,g=n*h-i*m,v=i*p-s*h,_=2*o;return t[0]=a+h*_+2*y,t[1]=l+p*_+2*g,t[2]=u+m*_+2*v,t}function tye(t,e,r,i){const s=[],n=[];return s[0]=e[0]-r[0],s[1]=e[1]-r[1],s[2]=e[2]-r[2],n[0]=s[0],n[1]=s[1]*Math.cos(i)-s[2]*Math.sin(i),n[2]=s[1]*Math.sin(i)+s[2]*Math.cos(i),t[0]=n[0]+r[0],t[1]=n[1]+r[1],t[2]=n[2]+r[2],t}function rye(t,e,r,i){const s=[],n=[];return s[0]=e[0]-r[0],s[1]=e[1]-r[1],s[2]=e[2]-r[2],n[0]=s[2]*Math.sin(i)+s[0]*Math.cos(i),n[1]=s[1],n[2]=s[2]*Math.cos(i)-s[0]*Math.sin(i),t[0]=n[0]+r[0],t[1]=n[1]+r[1],t[2]=n[2]+r[2],t}function iye(t,e,r,i){const s=[],n=[];return s[0]=e[0]-r[0],s[1]=e[1]-r[1],s[2]=e[2]-r[2],n[0]=s[0]*Math.cos(i)-s[1]*Math.sin(i),n[1]=s[0]*Math.sin(i)+s[1]*Math.cos(i),n[2]=s[2],t[0]=n[0]+r[0],t[1]=n[1]+r[1],t[2]=n[2]+r[2],t}function sye(t,e){wI(EN,t),wI(IN,e);const r=K7(EN,IN);return r>1?0:r<-1?Math.PI:Math.acos(r)}const EN=_c(),IN=_c();function nye(t){return"vec3("+t[0]+", "+t[1]+", "+t[2]+")"}function oye(t,e){return t[0]===e[0]&&t[1]===e[1]&&t[2]===e[2]}function aye(t,e){if(t===e)return!0;const r=t[0],i=t[1],s=t[2],n=e[0],o=e[1],a=e[2],l=Gi();return Math.abs(r-n)<=l*Math.max(1,Math.abs(r),Math.abs(n))&&Math.abs(i-o)<=l*Math.max(1,Math.abs(i),Math.abs(o))&&Math.abs(s-a)<=l*Math.max(1,Math.abs(s),Math.abs(a))}function lye(t,e,r){const i=r[0]-e[0],s=r[1]-e[1],n=r[2]-e[2];let o=i*i+s*s+n*n;return o>0?(o=1/Math.sqrt(o),t[0]=i*o,t[1]=s*o,t[2]=n*o,t):(t[0]=0,t[1]=0,t[2]=0,t)}const uye=q7,cye=H7,hye=W7,dye=J7,pye=Y7,fye=B7,mye=X7;Object.freeze(Object.defineProperty({__proto__:null,abs:Fme,add:kme,angle:sye,bezier:Yme,ceil:Ome,clamp:jme,copy:Lme,cross:Hme,crossAndNormalize:Wme,direction:lye,dist:dye,distance:J7,div:hye,divide:W7,dot:K7,equals:aye,exactEquals:oye,floor:Nme,hermite:Jme,inverse:qme,len:fye,length:B7,lerp:Zme,max:Vme,min:zme,mul:cye,multiply:H7,negate:Bme,normalize:wI,random:Xme,rotateX:tye,rotateY:rye,rotateZ:iye,round:Ume,scale:Z7,scaleAndAdd:Gme,set:Rme,sign:Dme,sqrDist:pye,sqrLen:mye,squaredDistance:Y7,squaredLength:X7,str:nye,sub:uye,subtract:q7,transformMat3:Qme,transformMat4:Kme,transformQuat:eye},Symbol.toStringTag,{value:"Module"}));function Cn(t){let e=t*t;return t<0&&(e*=-1),e}function yye(t){return t.translation[0]=0,t.translation[1]=0,t.translation[2]=0,t.heading=0,t.tilt=0,t}function gye(t,e,r){const i=r,s=t.state,n=t.device,o=e.tiltDirection==="forward-down"?1:-1,a=1;return n.deviceType==="standard"?(i.translation[0]=Cn(s.axes[0]),i.translation[1]=Cn(s.axes[1]),i.translation[2]=Cn(s.buttons[7])-Cn(s.buttons[6]),i.heading=Cn(s.axes[2]),i.tilt=Cn(s.axes[3])):n.deviceType==="spacemouse"&&(i.translation[0]=1.2*Cn(s.axes[0]),i.translation[1]=1.2*Cn(s.axes[1]),i.translation[2]=2*-Cn(s.axes[2]),i.heading=1.2*Cn(s.axes[5]),i.tilt=1.2*Cn(s.axes[3])),i.tilt*=o,Z7(i.translation,i.translation,a),i}function vye(t){return t.translation[0]===0&&t.translation[1]===0&&t.translation[2]===0&&t.heading===0&&t.tilt===0&&t.zoom===0}let _ye=class extends Ar{constructor(e){super(!0),this._view=e,this._frameTask=null,this._watchHandles=new Rm,this._currentDevice=null,this._transformation={translation:[0,0,0],heading:0,tilt:0,zoom:0},this._handle=this.registerIncoming("gamepad",(r=>this._handleGamePadEvent(r))),this._handle.pause()}onInstall(e){super.onInstall(e),this._watchHandles.add([ie((()=>this._view.navigation.gamepad?.enabled),(r=>{r?(this._handle.resume(),this._frameTask||(this._frameTask=om({update:i=>this._frameUpdate(i.deltaTime)}))):(this._handle.pause(),this._frameTask&&(this._frameTask.remove(),this._frameTask=null))}),Ft)])}onUninstall(){this._watchHandles.removeAll(),this._frameTask&&(this._frameTask.remove(),this._frameTask=null),super.onUninstall()}_handleGamePadEvent(e){const r=this._view.navigation.gamepad.device;r&&e.data.device!==r||this._currentDevice&&this._currentDevice!==e.data.device||(e.data.action==="end"?(this._currentDevice=null,yye(this._transformation)):(this._currentDevice=e.data.device,gye(e.data,this._view.navigation.gamepad,this._transformation)),this._frameTask?.resume())}_frameUpdate(e){const r=this._transformation;if(vye(r))return void this._frameTask?.pause();const i=this._view.viewpoint.clone(),s=this._view.navigation.gamepad.velocityFactor,n=wye*s*e;A2(i,i,[r.translation[0]*n,-r.translation[1]*n]);const o=1+r.translation[2]*Sye*e,a=this._view.constraints.rotationEnabled?-r.heading*bye*e:0,l=this._view.size,u=[l[0]/2,l[1]];T7(i,i,o,a,u,l);const h=this._view.constraints.constrain(i,this._view.viewpoint);this._view.viewpoint=h}};const bye=.06,wye=.7,Sye=6e-4;function Q7(t){const e=()=>t(document.visibilityState==="visible");return document.addEventListener("visibilitychange",e),He((()=>document.removeEventListener("visibilitychange",e)))}let xye=class extends Ar{constructor(e,r,i){super(!0),this.view=e,this.keys=r,this._isSticky=!1,this._pressedKeys=new Set,this._timeout=void 0,this._currentDirection=void 0,this._stickyKeyDuration=200,this._handleKey=s=>{const n=this._keyMap[s.data.key];if(s.modifiers.has("Meta")||s.modifiers.has("Control"))return void this._stopMovement();if(n==null)return;s.stopPropagation(),s.preventDefault();const o=s.type==="key-down";if(this._pressedKeys[o?"add":"delete"](n),o){if(this._direction===n)return;this._direction=n,this._isSticky=!1,this._setTimeout((()=>{this._isSticky&&this._handlePopKey()}))}else{const a=this._timeout===void 0,l=this._pressedKeys.size>0;a||l?this._handlePopKey():this._isSticky=!0}},this._handlePopKey=()=>{this._direction=Array.from(this._pressedKeys).pop(),this._direction==null&&this._stopMovement()},this._stopMovement=()=>{this._isSticky=!1,this._direction=void 0,this._pressedKeys.clear(),this._setTimeout(void 0)},this._keyMap={[r.left]:"left",[r.right]:"right",[r.up]:"up",[r.down]:"down"},this.registerIncoming("key-down",i,this._handleKey),this.registerIncoming("key-up",i,this._handleKey),this.registerIncoming("blur",i,this._stopMovement),this._visibilityHandle=Q7((s=>s?null:this._stopMovement()))}onUninstall(){this._stopMovement(),this._visibilityHandle?.remove()}get _direction(){return this._currentDirection}set _direction(e){const r=this._currentDirection!=null;if(e!=null){if(r||this.view.mapViewNavigation.begin(),this._currentDirection!==e)switch(e){case"left":this.view.mapViewNavigation.continuousPanLeft();break;case"right":this.view.mapViewNavigation.continuousPanRight();break;case"up":this.view.mapViewNavigation.continuousPanUp();break;case"down":this.view.mapViewNavigation.continuousPanDown()}}else r&&this.view.mapViewNavigation.stop();this._currentDirection=e}_setTimeout(e){clearTimeout(this._timeout),this._timeout=e===void 0?void 0:setTimeout((()=>{this._timeout=void 0,e()}),this._stickyKeyDuration)}},$ye=class extends Ar{constructor(e,r,i){super(!0),this.view=e,this.keys=r,this._keyToDirection=new Map,this._pressed=!1,this._addKeysMapping(r),this.registerIncoming("key-down",i,(s=>this._handleKeyDown(s))),this.registerIncoming("key-up",i,(s=>this._handleKeyUp(s))),this.registerIncoming("blur",i,(()=>this._handleStop())),this._visibilityHandle=Q7((s=>s?null:this._handleStop()))}onUninstall(){this._visibilityHandle?.remove(),this._handleStop()}_addKeysMapping(e){this._addKeyMapping(e.clockwise,"clockwise"),this._addKeyMapping(e.counterClockwise,"counterClockwise"),this._addKeyMapping(e.reset,"reset")}_addKeyMapping(e,r){for(const i of e)this._keyToDirection.set(i,r)}_handleKeyDown(e){e.data.repeat||this._handleKey(e,!0)}_handleKeyUp(e){this._handleKey(e,!1)}_handleStop(){this._pressed&&(this._pressed=!1,this.view.mapViewNavigation.stop())}_handleKey(e,r){const i=e.modifiers;if(i.size>0&&!i.has("Shift")||!this.view.constraints.rotationEnabled)return;const s=this._keyToDirection.get(e.data.key);if(this._pressed=s!=null,this._pressed){if(e.preventDefault(),r)switch(this.view.mapViewNavigation.begin(),s){case"clockwise":this.view.mapViewNavigation.continuousRotateClockwise();break;case"counterClockwise":this.view.mapViewNavigation.continuousRotateCounterclockwise();break;case"reset":this.view.mapViewNavigation.resetRotation()}else this._pressed=!1,this.view.mapViewNavigation.stop();e.stopPropagation()}}};var Kp;(function(t){t[t.IN=0]="IN",t[t.OUT=1]="OUT"})(Kp||(Kp={}));let Mye=class extends Ar{constructor(e,r,i){super(!0),this.view=e,this.keys=r,this._keysToZoomAction={},this.registerIncoming("key-down",i,(s=>this._handleKeyDown(s))),r.zoomIn.forEach((s=>this._keysToZoomAction[s]=Kp.IN)),r.zoomOut.forEach((s=>this._keysToZoomAction[s]=Kp.OUT))}_handleKeyDown(e){this._handleKey(e)}_handleKey(e){const r=e.modifiers;if(r.size>0&&!r.has("Shift"))return;const{key:i}=e.data;if(!(i in this._keysToZoomAction))return;const s=this._keysToZoomAction[i],{mapViewNavigation:n}=this.view;let o=null;switch(s){case Kp.IN:o=n.zoomIn();break;case Kp.OUT:o=n.zoomOut();break;default:return}n.begin(),o.then((()=>n.end())),e.stopPropagation()}};const Tye=.6;let Eye=class extends Ar{constructor(e,r){super(!0),this._view=e,this._canZoom=!0,this.registerIncoming("mouse-wheel",r,(i=>this._handleMouseWheel(i)))}_handleMouseWheel(e){if(this._view.navigation.actionMap.mouseWheel!=="zoom"||(e.preventDefault(),e.stopPropagation(),!this._canZoom))return;const r=this._view.mapViewNavigation,{x:i,y:s,deltaY:n}=e.data,o=1/Tye**(1/60*n),a=r.zoom(o,[i,s]);a&&(this._canZoom=!1,a.catch((()=>{})).then((()=>{this._canZoom=!0,r.end()})))}},Iye=class extends Ar{constructor(e){super(!0),this.view=e,this.registerIncoming("drag",(i=>this._handleDrag(i))),this.registerIncoming("pointer-down",(()=>this._stopMomentumNavigation()));const r=this.view.mapViewNavigation;this._dragEventSeparator=new L2({start:(i,s)=>{r.pinch.begin(this.view,s.data),s.stopPropagation()},update:(i,s)=>{r.pinch.update(this.view,s.data),s.stopPropagation()},end:(i,s)=>{r.pinch.end(this.view),s.stopPropagation()},condition:i=>i>=2})}_handleDrag(e){this._dragEventSeparator.handle(e)}_stopMomentumNavigation(){this.view.mapViewNavigation.pinch.stopMomentumNavigation()}};function CN(t){const e=t.native;return e?{buttons:e.buttons.map((r=>r.pressed?r.value||1:0)),axes:e.axes.map((r=>Aye(r,t.axisThreshold)))}:{buttons:[],axes:[]}}function Cye(t,e){if(t.axes.length!==e.axes.length||t.buttons.length!==e.buttons.length)return!1;for(let r=0;r<t.axes.length;r++)if(t.axes[r]!==e.axes[r])return!1;for(let r=0;r<t.buttons.length;r++)if(t.buttons[r]!==e.buttons[r])return!1;return!0}function Pye(t){for(let e=0;e<t.axes.length;e++)if(t.axes[e]!==0)return!1;for(let e=0;e<t.buttons.length;e++)if(t.buttons[e]!==0)return!1;return!0}function Aye(t,e){const r=Math.abs(t);return r<e?0:Math.sign(t)*(r-e)/(1-e)}let Lye=class{constructor(e,r){this._element=e,this._input=r,this._hasEventListeners=!1,this._onConnectGamepad=n=>{this._connectGamepad(n.gamepad)},this._onDisconnectGamepad=n=>{const o=n.gamepad,a=o.index,l=this._inputDevices[a];l&&(this._emitGamepadEvent(o,CN(l),!1),this._inputDevices.splice(a,1),this._latestUpdate.splice(a,1),this._input.gamepad.devices.remove(l),this.ensurePollingState())},this._frameTask=null,this._latestUpdate=new Array,this._inputDevices=new Array,this._callback=null;const i="getGamepads"in window.navigator,s=window.isSecureContext;this.supported=i&&s,this.supported&&(PN((n=>this._connectGamepad(n))),window.addEventListener("gamepadconnected",this._onConnectGamepad),window.addEventListener("gamepaddisconnected",this._onDisconnectGamepad),this.ensurePollingState())}destroy(){this.hasEventListeners=!1,this.supported&&(window.removeEventListener("gamepadconnected",this._onConnectGamepad),window.removeEventListener("gamepaddisconnected",this._onDisconnectGamepad))}set hasEventListeners(e){this._hasEventListeners!==e&&(this._hasEventListeners=e,this.ensurePollingState())}get _eventsEnabled(){return this.supported&&this._inputDevices.length>0&&this._hasEventListeners}set onEvent(e){this._callback=e}_connectGamepad(e){const r=new _A(e);r.deviceType!=="unknown"&&(this._inputDevices[e.index]=r,this._input.gamepad.devices.add(r)),this.ensurePollingState()}ensurePollingState(){this._eventsEnabled?this._startPolling():this._stopPolling()}_startPolling(){this._frameTask==null&&(this._frameTask=om({update:()=>this._readGamepadState()}))}_stopPolling(){this._frameTask!=null&&(this._frameTask.remove(),this._frameTask=null,this._latestUpdate=new Array)}_readGamepadState(){const e=document.hasFocus(),r=this._element.contains(document.activeElement),i=this._input.gamepad.enabledFocusMode==="document"&&!e||this._input.gamepad.enabledFocusMode==="view"&&!r;PN((s=>{const n=this._inputDevices[s.index];if(!n)return;const o=this._latestUpdate[s.index],a=CN(n),l=i||Pye(a);o&&(o.timestamp===s.timestamp||!o.active&&l||Cye(o.state,a))||this._emitGamepadEvent(s,a,!l)}))}_emitGamepadEvent(e,r,i){const s=this._latestUpdate[e.index],n=s&&s.active;if(!n&&!i)return;const o=!n&&i?"start":n&&i?"update":"end";this._latestUpdate[e.index]={timestamp:e.timestamp,state:r,active:i},this._callback&&this._callback({device:this._inputDevices[e.index],state:r,action:o})}};function Rye(t){if(!t||!t.connected)return!1;for(let e=0;e<t.axes.length;e++)if(isNaN(t.axes[e]))return!1;return!0}function PN(t){for(const e of navigator.getGamepads())Rye(e)&&t(e)}const AN=z("edge"),kye=z("chrome"),Oye=z("ff"),Nye=z("safari"),LN="esri-view-surface",Hd={touchNone:`${LN}--touch-none`,touchPan:`${LN}--touch-pan`};var od;let Fye=(od=class{constructor(e,r){this._active={},this._callback=()=>{},this._activePointerCaptures=new Set,this._keyDownState=new Set,this._eventId=1,this._browserTouchPanningEnabled=!1,this._element=e,e.getAttribute("tabindex")||e.setAttribute("tabindex","0"),this._eventHandlers={"key-down":this._handleKey,"key-up":this._handleKey,"pointer-down":this._handlePointer,"pointer-move":this._handlePointerPreventDefault,"pointer-up":this._handlePointerPreventDefault,"pointer-enter":this._handlePointer,"pointer-leave":this._handlePointer,"pointer-cancel":this._handlePointer,"mouse-wheel":this._handleMouseWheel,"pointer-capture-lost":this._handlePointerCaptureLost},this._updateTouchAction(),this._element.addEventListener("keydown",this._preventAltKeyDefault),this._gamepadSource=new Lye(e,r),this._gamepadSource.onEvent=i=>this._callback("gamepad",i)}destroy(){this._callback=()=>{},this.activeEvents=null,this._activePointerCaptures.forEach((e=>this._releasePointerCaptureSafe(e))),this._activePointerCaptures.clear(),this._gamepadSource=At(this._gamepadSource),this._removeTouchAction(),this._element.removeEventListener("keydown",this._preventAltKeyDefault)}get browserTouchPanningEnabled(){return this._browserTouchPanningEnabled}set browserTouchPanningEnabled(e){this._browserTouchPanningEnabled=e,this._updateTouchAction(),this._updateTouchEventHandling()}set onEventReceived(e){this._callback=e}set activeEvents(e){for(const r in this._active)if(!e||!e.has(r)){const i=this._active[r];this._element.removeEventListener(n$[r],i),delete this._active[r]}e&&e.forEach((r=>{if(!this._active[r]&&n$[r]){const i=(this._eventHandlers[r]||this._handleDefault).bind(this,r);this._element.addEventListener(n$[r],i),this._active[r]=i}})),this._gamepadSource&&(this._gamepadSource.hasEventListeners=e?.has("gamepad")??!1)}setPointerCapture(e,r){r?this._setPointerCaptureSafe(e.pointerId):(this._releasePointerCaptureSafe(e.pointerId),this._activePointerCaptures.delete(e.pointerId))}_updateTouchAction(){this._element.classList.remove(this._browserTouchPanningEnabled?Hd.touchNone:Hd.touchPan),this._element.classList.add(this._browserTouchPanningEnabled?Hd.touchPan:Hd.touchNone)}_updateTouchEventHandling(){this._browserTouchPanningEnabled?this._element.addEventListener("touchmove",this._preventMultiTouchPanning):this._element.removeEventListener("touchmove",this._preventMultiTouchPanning)}_removeTouchAction(){this._element.classList.remove(Hd.touchNone),this._element.classList.remove(Hd.touchPan),this._element.removeEventListener("touchmove",this._preventMultiTouchPanning)}_setPointerCaptureSafe(e){try{this._element.setPointerCapture(e),this._activePointerCaptures.add(e)}catch{}}_releasePointerCaptureSafe(e){try{if(this._element.hasPointerCapture&&!this._element.hasPointerCapture(e))return;this._element.releasePointerCapture(e)}catch{}}_updateNormalizedPointerLikeEvent(e,r){const i=qG(this._element,e);return od.test.disableSubpixelCoordinates&&(i.x=Math.round(i.x),i.y=Math.round(i.y)),r.x=i.x,r.y=i.y,r}_handleKey(e,r){const{key:i}=r;i&&e==="key-up"&&this._keyDownState.delete(i);const s={native:r,key:i,repeat:!!i&&this._keyDownState.has(i)};i&&e==="key-down"&&this._keyDownState.add(s.key),this._callback(e,s)}_handlePointer(e,r){const i=this._updateNormalizedPointerLikeEvent(r,{native:r,x:0,y:0,pointerType:r.pointerType,button:r.button,buttons:r.buttons,eventId:this._eventId++});this._callback(e,i)}_handlePointerPreventDefault(e,r){const i=this._updateNormalizedPointerLikeEvent(r,{native:r,x:0,y:0,pointerType:r.pointerType,button:r.button,buttons:r.buttons,eventId:this._eventId++});r.preventDefault(),this._callback(e,i)}_getDeltaFromTrackpadOrMouseWheel(e){return e.shiftKey&&z("mac")&&e.deltaY===0?e.deltaX:e.deltaY}_handleMouseWheel(e,r){let i=this._getDeltaFromTrackpadOrMouseWheel(r);switch(r.deltaMode){case 0:AN&&(i=i/document.documentElement.clientHeight*600);break;case 1:i*=30;break;case 2:i*=900}AN?i*=.7:kye||Nye?i*=.6:Oye&&(i*=1.375);const s=100,n=Math.abs(i);n>s&&(i=i/n*200/(1+Math.exp(-.02*(n-s))));const o=this._updateNormalizedPointerLikeEvent(r,{native:r,x:0,y:0,deltaY:i});this._callback(e,o)}_handlePointerCaptureLost(e,r){this._activePointerCaptures.delete(r.pointerId),this._handleDefault(e,r)}_handleDefault(e,r){const i={native:r};r.preventDefault(),this._callback(e,i)}_preventAltKeyDefault(e){e.key==="Alt"&&e.preventDefault()}_preventMultiTouchPanning(e){e.touches.length>1&&e.preventDefault()}},od.test={disableSubpixelCoordinates:!1},od);const n$={"key-down":"keydown","key-up":"keyup","pointer-down":"pointerdown","pointer-up":"pointerup","pointer-move":"pointermove","mouse-wheel":"wheel","pointer-capture-got":"gotpointercapture","pointer-capture-lost":"lostpointercapture","context-menu":"contextmenu","pointer-enter":"pointerenter","pointer-leave":"pointerleave","pointer-cancel":"pointercancel",focus:"focus",blur:"blur"};let Dye=class extends Ar{constructor(){super(!0),this.registerIncoming("context-menu",(e=>e.data.native.preventDefault()))}};const eB=()=>({maximumClickDelay:300}),zye=(t={})=>({...eB(),movementUntilMouseDrag:1.5,movementUntilPenDrag:6,movementUntilTouchDrag:6,holdDelay:500,...t}),LA=(t={})=>({...eB(),maximumDoubleClickDistance:10,maximumDoubleTouchDistance:35,maximumDoubleClickDelay:250,maximumDoubleTouchDelay:350,...t});function Uw(t,e){return Math.abs(e.x-t.x)+Math.abs(e.y-t.y)}function Vye(t,e){const r=e.x-t.x,i=e.y-t.y;return Math.sqrt(r*r+i*i)}function jye(t,e){if(e?(e.radius=0,e.center.x=0,e.center.y=0):e={radius:0,center:or()},t.length===0)return e;if(t.length===1)return e.center.x=t[0].x,e.center.y=t[0].y,e;if(t.length===2){const[$,T]=t,[I,P]=[T.x-$.x,T.y-$.y];return e.radius=Math.sqrt(I*I+P*P)/2,e.center.x=($.x+T.x)/2,e.center.y=($.y+T.y)/2,e}let r=0,i=0;for(let $=0;$<t.length;$++)r+=t[$].x,i+=t[$].y;r/=t.length,i/=t.length;const s=t.map(($=>$.x-r)),n=t.map(($=>$.y-i));let o=0,a=0,l=0,u=0,h=0,p=0,m=0;for(let $=0;$<s.length;$++){const T=s[$],I=n[$],P=T*T,R=I*I;o+=P,a+=R,l+=T*I,u+=P*T,h+=R*I,p+=T*R,m+=I*P}const y=.5*(u+p),g=.5*(h+m),v=o*a-l*l,_=(y*a-g*l)/v,b=(o*g-l*y)/v,S=or(_+r,b+i);return{radius:Math.sqrt(_*_+b*b+(o+a)/t.length),center:S}}function Qh(t){const{native:e}=t,{pointerId:r,button:i,pointerType:s}=e;return s==="mouse"?`${r}:${i}`:`${s}`}let Uye=class extends Ar{constructor(e={},r=Am){super(!1),this._clock=r,this._doubleTapDragReady=!1,this._doubleTapDragActive=!1,this._dragStartCenter=or(0,0),this._pointerState=new Map,this._parameters=LA(e),this._doubleTapDrag=this.registerOutgoing("double-tap-drag"),this._dragEventSeparator=new L2({start:(i,s)=>this._dragStart(i,s),update:(i,s)=>this._dragUpdate(s),end:(i,s)=>this._dragEnd(s)}),this.registerIncoming("drag",(i=>this._dragEventSeparator.handle(i))),this.registerIncoming("pointer-down",(i=>this._handlePointerDown(i))),this.registerIncoming("pointer-up",(()=>this._handlePointerUp()))}onUninstall(){this._pointerState.forEach((e=>{e.doubleTapTimeout=Lt(e.doubleTapTimeout)}))}get hasPendingInputs(){for(const e of this._pointerState.values())if(e.doubleTapTimeout!=null)return!0;return!1}_clearPointerDown(e){const r=this._pointerState.get(e);r&&(r.doubleTapTimeout=Lt(r.doubleTapTimeout),this._pointerState.delete(e),this.refreshHasPendingInputs())}_dragStart(e,r){if(!this._doubleTapDragReady||e!==1)return;this._doubleTapDragReady=!1,this._doubleTapDragActive=!0;const{data:i,modifiers:s}=r,{center:n}=i;this._dragStartCenter=n;const o=o$("begin",or(0,0),i);this._doubleTapDrag.emit(o,void 0,s),r.stopPropagation()}_dragUpdate(e){if(!this._doubleTapDragActive)return;const{data:r,modifiers:i}=e,{center:s}=r,n=o$("update",or(s.x-this._dragStartCenter.x,s.y-this._dragStartCenter.y),r);this._doubleTapDrag.emit(n,void 0,i),e.stopPropagation()}_dragEnd(e){if(!this._doubleTapDragActive)return;const{data:r,modifiers:i}=e,{center:s}=r,n=o$("end",or(s.x-this._dragStartCenter.x,s.y-this._dragStartCenter.y),r);this._doubleTapDrag.emit(n,void 0,i),this._doubleTapDragActive=!1,e.stopPropagation()}_handlePointerDown(e){const{data:r}=e,i=Qh(r),s=this._pointerState.get(i),{pointerType:n}=r.native;if(s){const o=n==="touch"?this._parameters.maximumDoubleTouchDistance:this._parameters.maximumDoubleClickDistance;this._clearPointerDown(i),Uw(s.event.data,r)>o?this._storePointerDown(e):this._doubleTapDragReady=!0}else this._storePointerDown(e)}_handlePointerUp(){this._doubleTapDragReady=!1}_storePointerDown(e){const{data:r}=e,{pointerType:i}=r.native,s=Qh(r),n=i==="touch"?this._parameters.maximumDoubleTouchDelay:this._parameters.maximumDoubleClickDelay,o=this._clock.setTimeout((()=>this._clearPointerDown(s)),n);this._pointerState.set(s,{event:e,doubleTapTimeout:o}),this.refreshHasPendingInputs()}};function o$(t,e,r){const{button:i,buttons:s,pointer:n,pointers:o,pointerType:a,timestamp:l}=r;return{action:t,delta:e,button:i,buttons:s,pointer:n,pointers:o,pointerType:a,timestamp:l}}let Gye=class extends Ar{constructor(e){super(!1),this._navigationTouch=e,this._startStateModifiers=new Set,this._activePointerMap=new Map,this._isDragging=!1,this._isCurrentDragSuppressed=!1,this._drag=this.registerOutgoing("drag"),this.registerIncoming("pointer-drag",this._handlePointerDrag.bind(this)),this.registerIncoming("pointer-up",this._handlePointerUpAndPointerLost.bind(this)),this.registerIncoming("pointer-capture-lost",this._handlePointerUpAndPointerLost.bind(this)),this.registerIncoming("pointer-cancel",this._handlePointerUpAndPointerLost.bind(this))}_createPayload(e,r,i,s){return{action:e,pointerType:this._pointerType,button:this._mouseButton,buttons:r.buttons,timestamp:s,pointers:Bye(this._activePointerMap),pointer:r,angle:i.angle,radius:i.radius,center:i.center}}_addPointer(e){const r=e.native.pointerId,i=E_(this._activePointerMap).angle,s={event:e,initialAngle:0,lastAngle:0};this._activePointerMap.set(r,s);const n=cb(s,tB(this._activePointerMap));s.initialAngle=n,s.lastAngle=n,this._updatePointerAngles(i)}_updatePointer(e){if(e&&e.x==null&&e.y==null)return;const r=e.native.pointerId,i=this._activePointerMap.get(r);i?i.event=e:this._addPointer(e)}_removePointer(e){const r=E_(this._activePointerMap).angle;this._activePointerMap.delete(e),this._updatePointerAngles(r)}_updatePointerAngles(e){const r=E_(this._activePointerMap);this._activePointerMap.forEach((i=>{i.initialAngle=cb(i,r)-e,i.lastAngle=cb(i,r)-e}))}_emitEvent(e,r,i){const s=E_(this._activePointerMap);this._drag.emit(this._createPayload(e,r,s,i),void 0,this._startStateModifiers)}_handlePointerUpAndPointerLost(e){const r=e.data.native.pointerId,i=e.timestamp;this._activePointerMap.get(r)&&(this._activePointerMap.size===1?(this._updatePointer(e.data),!this._isCurrentDragSuppressed&&this._emitEvent("end",e.data,i),this._isDragging=!1,this._isCurrentDragSuppressed=!1,this._removePointer(r)):(this._removePointer(r),this._emitEvent("removed",e.data,e.timestamp)))}_handlePointerDrag(e){const r=e.data,i=r.currentEvent,s=e.timestamp;switch(r.action){case"start":case"update":this._isDragging?this._activePointerMap.has(i.native.pointerId)?(this._updatePointer(i),!this._isCurrentDragSuppressed&&this._emitEvent("update",i,s)):(this._addPointer(i),this._emitEvent("added",i,s),this._isCurrentDragSuppressed=this._isSuppressed):(this._updatePointer(i),this._pointerType=e.data.startEvent.pointerType,this._mouseButton=e.data.startEvent.button,this._startStateModifiers=e.modifiers,this._isDragging=!0,this._isCurrentDragSuppressed=this._isSuppressed,!this._isCurrentDragSuppressed&&this._emitEvent("start",i,s))}}get _isSuppressed(){return!!this._navigationTouch&&!this._navigationTouch.browserTouchPanEnabled&&this._pointerType==="touch"&&this._activePointerMap.size===1}};function tB(t){const e=[];return t.forEach((r=>{e.push(or(r.event.x,r.event.y))})),jye(e)}function E_(t){const e=tB(t);let r=0;return t.forEach((i=>{let s=cb(i,e),n=s-i.lastAngle;for(;n>Math.PI;)n-=2*Math.PI;for(;n<-Math.PI;)n+=2*Math.PI;s=i.lastAngle+n,i.lastAngle=s;const o=s-i.initialAngle;r+=o})),r/=t.size||1,{angle:r,radius:e.radius,center:e.center}}function Bye(t){const e=new Map;return t.forEach(((r,i)=>e.set(i,r.event))),e}function cb(t,e){const r=t.event,i=r.x-e.center.x,s=r.y-e.center.y;return Math.atan2(s,i)}var RN;(function(t){t[t.Left=0]="Left",t[t.Middle=1]="Middle",t[t.Right=2]="Right",t[t.Back=3]="Back",t[t.Forward=4]="Forward",t[t.Undefined=-1]="Undefined"})(RN||(RN={}));let qye=class extends Ar{constructor(e={},r=Am){super(!1),this._clock=r,this._pointerState=new Map,this._parameters=LA(e),this._immediateDoubleClick=this.registerOutgoing("immediate-double-click"),this.registerIncoming("pointer-down",this._handlePointerDown.bind(this)),this.registerIncoming("pointer-up",this._handlePointerUp.bind(this))}onUninstall(){this._pointerState.forEach((e=>{e.immediateDoubleClick&&e.immediateDoubleClick.timeoutHandle.remove()})),super.onUninstall()}_handlePointerDown(e){const r=e.data,i=Qh(r);if(!this._pointerState.has(i)){const s={downButton:r.native.button,x:r.x,y:r.y,immediateDoubleClick:null};this._pointerState.set(i,s),this.startCapturingPointer(r.native)}}_handlePointerUp(e){const r=e.data,i=Qh(r),s=this._pointerState.get(i);if(s&&s.downButton===r.native.button){const n=s.immediateDoubleClick,o=e.data.native.pointerType==="touch"?this._parameters.maximumDoubleTouchDistance:this._parameters.maximumDoubleClickDistance;n?(n.timeoutHandle.remove(),Uw(n,e.data)>o?this._startImmediateDoubleClick(e,s):(this._immediateDoubleClick.emit(e.data,void 0,n.modifiers),this._removeState(r))):Uw(s,e.data)>o?this._removeState(r):this._startImmediateDoubleClick(e,s)}}_startImmediateDoubleClick(e,r){const i=e.data.native.pointerType==="touch"?this._parameters.maximumDoubleTouchDelay:this._parameters.maximumDoubleClickDelay;r.immediateDoubleClick={x:e.data.x,y:e.data.y,modifiers:e.modifiers,timeoutHandle:this._clock.setTimeout((()=>this._removeState(e.data)),i)}}_removeState(e){const r=Qh(e);this._pointerState.delete(r),this.stopCapturingPointer(e.native),this.refreshHasPendingInputs()}},Hye=class extends Ar{constructor(e={},r=Am){super(!1),this._clock=r,this._pointerState=new Map,this._parameters=zye(e),this._pointerDrag=this.registerOutgoing("pointer-drag"),this._immediateClick=this.registerOutgoing("immediate-click"),this._pointerHold=this.registerOutgoing("hold"),this.registerIncoming("pointer-down",(i=>this._handlePointerDown(i))),this.registerIncoming("pointer-up",(i=>this._handlePointerLoss(i,"pointer-up"))),this.registerIncoming("pointer-capture-lost",(i=>this._handlePointerLoss(i,"pointer-capture-lost"))),this.registerIncoming("pointer-cancel",(i=>this._handlePointerLoss(i,"pointer-cancel"))),this._moveHandle=this.registerIncoming("pointer-move",(i=>this._handlePointerMove(i))),this._moveHandle.pause()}onUninstall(){this._pointerState.forEach((e=>{e.holdTimeout=Lt(e.holdTimeout)})),super.onUninstall()}_handlePointerDown(e){const r=e.data,i=r.native.pointerId;let s=null;this._pointerState.size===0&&(s=this._clock.setTimeout((()=>{const o=this._pointerState.get(i);if(o){if(!o.isDragging){const a=o.previousEvent;this._pointerHold.emit(a,void 0,e.modifiers),o.holdEmitted=!0}o.holdTimeout=null}}),this._parameters.holdDelay));const n={startEvent:r,previousEvent:r,startTimestamp:e.timestamp,isDragging:!1,downButton:r.native.button,holdTimeout:s,modifiers:new Set};this._pointerState.set(i,n),this.startCapturingPointer(r.native),this._moveHandle.resume(),this._pointerState.size>1&&this._startDragging(e)}_handlePointerMove(e){const r=e.data,i=r.native.pointerId,s=this._pointerState.get(i);s&&(s.isDragging?this._pointerDrag.emit(I_("update",s,r),void 0,s.modifiers):Vye(r,s.startEvent)>this._getDragThreshold(r.native.pointerType)&&this._startDragging(e),s.previousEvent=r)}_getDragThreshold(e){switch(e){case"touch":return this._parameters.movementUntilTouchDrag;case"pen":return this._parameters.movementUntilPenDrag;default:return this._parameters.movementUntilMouseDrag}}_startDragging(e){const r=e.data,i=r.native.pointerId;this._pointerState.forEach((s=>{s.holdTimeout!=null&&(s.holdTimeout.remove(),s.holdTimeout=null),s.isDragging||(s.modifiers=e.modifiers,s.isDragging=!0,i===s.startEvent.native.pointerId?this._pointerDrag.emit(I_("start",s,r)):this._pointerDrag.emit(I_("start",s,s.previousEvent),e.timestamp))}))}_handlePointerLoss(e,r){const i=e.data,s=i.native.pointerId,n=this._pointerState.get(s);n&&(n.holdTimeout!=null&&(n.holdTimeout.remove(),n.holdTimeout=null),n.isDragging?this._pointerDrag.emit(I_("end",n,r==="pointer-up"?i:n.previousEvent),void 0,n.modifiers):r==="pointer-up"&&n.downButton===i.native.button&&e.timestamp-n.startTimestamp<=this._parameters.maximumClickDelay&&!n.holdEmitted&&this._immediateClick.emit(i),this._pointerState.delete(s),this.stopCapturingPointer(i.native),this._pointerState.size===0&&this._moveHandle.pause())}};function I_(t,e,r){return{action:t,startEvent:e.startEvent,previousEvent:e.previousEvent,currentEvent:r}}let Wye=class extends Ar{constructor(e={},r=Am){super(!1),this._clock=r,this._pointerState=new Map,this._parameters=LA(e),this._click=this.registerOutgoing("click"),this._doubleClick=this.registerOutgoing("double-click"),this.registerIncoming("immediate-click",(i=>this._handleImmediateClick(i))),this.registerIncoming("pointer-down",(i=>this._handlePointerDown(i)))}onUninstall(){this._pointerState.forEach((e=>e.doubleClickTimer=Lt(e.doubleClickTimer)))}get hasPendingInputs(){for(const e of this._pointerState.values())if(e.doubleClickTimer!=null)return!0;return!1}_clearDoubleClickTimer(e,r){const i=this._pointerState.get(e);i&&(i.doubleClickTimer=Lt(i.doubleClickTimer),r&&this._click.emit(i.event.data,void 0,i.event.modifiers),this._pointerState.delete(e),this.refreshHasPendingInputs())}_doubleClickTimeoutExceeded(e){const r=this._pointerState.get(e);r.pointerDownCount===1&&this._click.emit(r.event.data,void 0,r.event.modifiers),r.doubleClickTimer=null,this._pointerState.delete(e),this.refreshHasPendingInputs()}_handleImmediateClick(e){const r=e.data,{pointerType:i}=r.native,s=Zye(r);if(!this._pointerState.has(s))return void this._startClick(e);const n=this._pointerState.get(s),{data:o,modifiers:a}=n.event,l=i==="touch"?this._parameters.maximumDoubleTouchDistance:this._parameters.maximumDoubleClickDistance;Uw(o,r)>l?(this._clearDoubleClickTimer(s,!0),this._startClick(e)):(this._clearDoubleClickTimer(s,!1),n.pointerDownCount===2&&this._doubleClick.emit(o,void 0,a))}_handlePointerDown(e){const r=Qh(e.data),i=this._pointerState.get(r);i&&(i.pointerDownCount+=1)}_startClick(e){const{data:r}=e,{native:{pointerType:i}}=r,s=Qh(r),n=i==="touch"?this._parameters.maximumDoubleTouchDelay:this._parameters.maximumDoubleClickDelay,o=this._clock.setTimeout((()=>this._doubleClickTimeoutExceeded(s)),n);this._pointerState.set(s,{event:e,doubleClickTimer:o,pointerDownCount:1}),this.refreshHasPendingInputs()}};function Zye(t){const{pointerId:e,pointerType:r,button:i}=t.native;return r==="mouse"?`${e}:${i}`:`${r}`}const C_={counter:"Control",pan:{left:"ArrowLeft",right:"ArrowRight",up:"ArrowUp",down:"ArrowDown"},zoom:{zoomIn:["=","+"],zoomOut:["-","_"]},rotate:{clockwise:["a","A"],counterClockwise:["d","D"],reset:["n","N"]}},kN=Symbol("handles");let th=class extends ce{initialize(){const e=()=>this.view?.ready;this.addHandles([fs((()=>!e()),(()=>this._disconnect())),fs(e,(()=>this._connect()))])}destroy(){this._disconnect()}get latestPointerType(){return this._inputManager?.latestPointerType}get latestPointerLocation(){return this._inputManager?.latestPointerLocation}get multiTouchActive(){return this._inputManager?.multiTouchActive??!1}isModifierKeyDown(e){return this._inputManager?.isModifierKeyDown(e)??!1}_disconnect(){this.view.viewEvents.disconnect(),this.removeHandles(kN),this._inputManager=At(this._inputManager)}_connect(){const e=this.view.surface,r=new Fye(e,this.view.input),i=[new qye,new Hye,new Wye,new Gye(this.view.navigation),new Uye],s=new Gs({eventSource:r,recognizers:i}),n=new Pme(this.view,["primary"]),o=new Ame(this.view,["secondary"]);s.installHandlers("prevent-context-menu",[new Dye],kl.INTERNAL),s.installHandlers("navigation",[new Iye(this.view),new _ye(this.view),new Eye(this.view),new TN(this.view),new TN(this.view,[C_.counter]),n,new xye(this.view,C_.pan),new Mye(this.view,C_.zoom),new $ye(this.view,C_.rotate),o,new Cme(this.view,"touch")],kl.INTERNAL),this.view.viewEvents.connect(s),this._source=r,this._inputManager=s,this.addHandles([ie((()=>this.view?.navigation?.browserTouchPanEnabled),(a=>{this._source&&(this._source.browserTouchPanningEnabled=!a)}),Ft),ie((()=>{const{actionMap:a}=this.view.navigation;return{panActions:MN("pan",a),rotateActions:MN("rotate",a)}}),(({panActions:a,rotateActions:l})=>{n.pointerActions=a,o.pointerActions=l}),Oi)],kN)}get test(){}};c([d()],th.prototype,"view",void 0),c([d()],th.prototype,"latestPointerType",null),c([d()],th.prototype,"latestPointerLocation",null),c([d()],th.prototype,"multiTouchActive",null),th=c([C("esri.views.2d.input.MapViewInputManager")],th);const Jye=th,Yye=t=>{let e=class extends t{constructor(...r){super(...r),this.goToManager=new ub({view:this}),this.inputManager=new Jye({view:this}),this.addHandles([this.on("resize",(i=>this.stateManager.resize(i.width,i.height)))])}get interacting(){return this.navigating}get stationary(){return!this.animation&&!this.navigating&&!this.resizing&&this.stationaryManager.stationary}on(r,i,s,n){return this.inputManager&&this.viewEvents.on(r,i,s,n)||super.on(r,i)}hasEventListener(r){return super.hasEventListener(r)||this.viewEvents.hasHandler(r)}goTo(r,i){return this.goToManager.goTo(r,i)}toMap(r){if(!this.ready)return null;const i=WG(r)?HG(this,r):r;return this.stateManager.toMap(i)}};return c([d()],e.prototype,"goToManager",void 0),c([d({readOnly:!0})],e.prototype,"interacting",null),c([d()],e.prototype,"stationary",null),c([d({readOnly:!0})],e.prototype,"inputManager",void 0),e=c([C("esri.views.Viewport2DMixin")],e),e};let ON=class{constructor(e){this._view=e,this.viewpoint=new mn({targetGeometry:new ge,scale:0,rotation:0})}get view(){return this._view}get size(){const[e,r]=this._view.size;return Math.sqrt(e*e+r*r)}get scale(){return this.viewpoint.scale}get rotation(){return this.viewpoint.rotation}get center(){return this.viewpoint.targetGeometry}get scaleToResolutionFactor(){return $7(this.center.spatialReference)}pixelsPerPanAtZoom(e){return 1/(e*this.scaleToResolutionFactor)}zoomAtPixelsPerPan(e){return 1/(e*this.scaleToResolutionFactor)}pixelsPerRotate(){return this.size/2}compareTo(e,r){r.pan=hj(this.center,e.center);let i=Math.abs(e.rotation-this.rotation);i=i>=180?360-i:i,r.rotate=Vm(i),r.sourceZoom=this.scale,r.targetZoom=e.scale}interpolate(e,r,i){const{pan:s,rotate:n,zoom:o,zoomOffset:a}=i,{center:l}=this;l.spatialReference=e.center.spatialReference,l.x=Wy(e.center.x,r.center.x,s),l.y=Wy(e.center.y,r.center.y,s),this.viewpoint.scale=Wy(e.scale,r.scale+a,o);let u=e.rotation;const h=r.rotation;Math.abs(h-u)>=180&&(u+=360*(u<h?1:-1)),this.viewpoint.rotation=Wy(u,h,n)}copyFrom(e){wi(this.viewpoint,e.viewpoint),this._view=e.view}};function gy(t,e,r,i){const s=3*t,n=3*(r-t)-s,o=1-s-n,a=3*e,l=3*(i-e)-a,u=1-a-l;function h(g){return((o*g+n)*g+s)*g}function p(g){return((u*g+l)*g+a)*g}function m(g){return(3*o*g+2*n)*g+s}function y(g,v){let _,b,S,$,T,I;for(S=g,I=0;I<8;I++){if($=h(S)-g,Math.abs($)<v)return S;if(T=m(S),Math.abs(T)<1e-6)break;S-=$/T}if(_=0,b=1,S=g,S<_)return _;if(S>b)return b;for(;_<b;){if($=h(S),Math.abs($-g)<v)return S;g>$?_=S:b=S,S=.5*(b-_)+_}return S}return function(g,v=1e-6){return p(y(g,v))}}const Qs={};Qs.ease=gy(.25,.1,.25,1),Qs.linear=gy(0,0,1,1),Qs.easeIn=Qs["ease-in"]=gy(.42,0,1,1),Qs.easeOut=Qs["ease-out"]=gy(0,0,.58,1),Qs.easeInOut=Qs["ease-in-out"]=gy(.42,0,.58,1);const Xye=t=>t,H0=t=>t*t,Gw=t=>1-H0(1-t),NN=t=>t<.5?H0(2*t)/2:(Gw(2*(t-.5))+1)/2,Bw=t=>t*t*t,SI=t=>1-Bw(1-t),FN=t=>t<.5?Bw(2*t)/2:(SI(2*(t-.5))+1)/2,qw=t=>t*t*t*t,xI=t=>1-qw(1-t),DN=t=>t<.5?qw(2*t)/2:(xI(2*(t-.5))+1)/2,Hw=t=>t*t*t*t*t,$I=t=>1-Hw(1-t),zN=t=>t<.5?Hw(2*t)/2:($I(2*(t-.5))+1)/2,Ww=t=>1-Math.cos(t*Math.PI/2),MI=t=>1-Ww(1-t),VN=t=>t<.5?Ww(2*t)/2:(MI(2*(t-.5))+1)/2,Zw=t=>2**(10*(t-1)),Jw=t=>1-Zw(1-t),jN=t=>t<.5?Zw(2*t)/2:(Jw(2*(t-.5))+1)/2,Yw=t=>-(Math.sqrt(1-t*t)-1),TI=t=>1-Yw(1-t),UN=t=>t<.5?Yw(2*t)/2:(TI(2*(t-.5))+1)/2;function _n(t){const e=2*(t-Math.sqrt((t-1)*t)),r=e/2/t;return i=>i<r?t*i*i:e*i-e+1}function bn(t,e){return(r,i)=>r<e?e*t(r/e,i):1-t((1-r)/(1-e),i)*(1-e)}const GN=bn(_n(1),1),BN=bn(_n(1),0),Xw=bn(_n(1),.5),qN=bn(_n(2),1),HN=bn(_n(2),0),WN=bn(_n(2),.5),ZN=bn(_n(3),1),JN=bn(_n(3),0),YN=bn(_n(3),.5),XN=bn(_n(4),1),KN=bn(_n(4),0),QN=bn(_n(4),.5),e5={linear:Xye,"in-quad":H0,"out-quad":Gw,"in-out-quad":NN,"in-coast-quad":GN,"out-coast-quad":BN,"in-out-coast-quad":Xw,"in-cubic":Bw,"out-cubic":SI,"in-out-cubic":FN,"in-coast-cubic":qN,"out-coast-cubic":HN,"in-out-coast-cubic":WN,"in-quart":qw,"out-quart":xI,"in-out-quart":DN,"in-coast-quart":ZN,"out-coast-quart":JN,"in-out-coast-quart":YN,"in-quint":Hw,"out-quint":$I,"in-out-quint":zN,"in-coast-quint":XN,"out-coast-quint":KN,"in-out-coast-quint":QN,"in-sine":Ww,"out-sine":MI,"in-out-sine":VN,"in-expo":Zw,"out-expo":Jw,"in-out-expo":jN,"in-circ":Yw,"out-circ":TI,"in-out-circ":UN,"quad-in":H0,"quad-out":Gw,"quad-in-out":NN,"quad-in-coast":GN,"quad-out-coast":BN,"quad-in-out-coast":Xw,"cubic-in":Bw,"cubic-out":SI,"cubic-in-out":FN,"cubic-in-coast":qN,"cubic-out-coast":HN,"cubic-in-out-coast":WN,"quart-in":qw,"quart-out":xI,"quart-in-out":DN,"quart-in-coast":ZN,"quart-out-coast":JN,"quart-in-out-coast":YN,"quint-in":Hw,"quint-out":$I,"quint-in-out":zN,"quint-in-coast":XN,"quint-out-coast":KN,"quint-in-out-coast":QN,"sine-in":Ww,"sine-out":MI,"sine-in-out":VN,"expo-in":Zw,"expo-out":Jw,"expo-in-out":jN,"circ-in":Yw,"circ-out":TI,"circ-in-out":UN,ease:t=>Qs.ease(t),"ease-in":t=>Qs.easeIn(t),"ease-out":t=>Qs.easeOut(t),"ease-in-out":t=>Qs.easeInOut(t)};let Kye=class{constructor(){this.pan=0,this.rotate=0,this.fov=0,this.sourceZoom=0,this.targetZoom=0}};const Kw={desiredScreenFlow:2,minDuration:500,maxDuration:8e3},rB={maxDuration:4e3};let Qye=class iB{constructor(e){this._createCamera=e,this.compared=new Kye,this.segmentStart=0,this.segmentEnd=1,this.settings={desiredScreenFlow:Kw.desiredScreenFlow},this.source=e(),this.target=e()}clone(){const e=new iB(this._createCamera);return e.copyFrom(this),e}copyFrom(e){this.update(e.source,e.target,e.settings)}update(e,r,i){this.source!==e&&this.source.copyFrom(e),this.target!==r&&this.target.copyFrom(r),this.source.compareTo(this.target,this.compared),this.settings.desiredScreenFlow=i.desiredScreenFlow??Kw.desiredScreenFlow,this.desiredPixelFlow=this.settings.desiredScreenFlow*this.target.size,this.halfWindowSize=this.target.size/2}halfWindowPanAtZoom(e){const r=this.target.pixelsPerPanAtZoom(e);return this.halfWindowSize/r}get hasZoom(){return Math.abs(this.compared.sourceZoom-this.compared.targetZoom)>1e-5}get hasPan(){return this.compared.pan>Gi()}get hasFov(){return Math.abs(this.compared.fov)>Gi()}get hasRotate(){return this.compared.rotate>Gi()}},ege=class{constructor(){this.pan=0,this.rotate=0,this.zoom=0,this.fov=0,this.zoomOffset=0}},tge=class{constructor(){this.segments=new Array}get time(){return this.segments.reduce(((e,r)=>e+r.time),0)}interpolateComponentsAt(e,r){e=Math.min(Math.max(e,0),1),e*=this.time;let i=0,s=0;const n=this.definition,o=this.segments.reduce(((a,l)=>a||l.definition.hasZoom),!1);for(let a=0;a<this.segments.length;a++){const l=this.segments[a],u=l.definition;if(e<=l.time||a===this.segments.length-1){if(this.segmentInterpolateComponentsAt(l,l.time===0?0:e/l.time,r),n.hasPan&&!isNaN(r.pan)&&isFinite(n.compared.pan)?r.pan=(i+u.compared.pan*r.pan)/n.compared.pan:r.pan=1,n.hasRotate&&!isNaN(r.rotate)&&isFinite(n.compared.rotate)?r.rotate=(s+u.compared.rotate*r.rotate)/n.compared.rotate:r.rotate=1,o&&!isNaN(r.zoom)&&isFinite(u.compared.targetZoom)){const{sourceZoom:h,targetZoom:p}=u.compared,m=r.zoom*(p-h)+h,y=this.segments[0].definition.compared.sourceZoom,g=this.segments[this.segments.length-1].definition.compared.targetZoom,v=Math.abs(p-y)>Math.abs(h-y)?p:h;r.zoomOffset=v-g,r.zoom=(m-y)/(v-y)}else r.zoom=1;return r}e-=l.time,i+=u.compared.pan,s+=u.compared.rotate}}segmentInterpolateComponentsAt(e,r,i){e.interpolateComponentsAt(r,i)}},a$=class{get time(){return this._time}constructor(e){e&&this.update(e)}update(e){e&&(this.definition?this.definition.copyFrom(e):this.definition=e.clone()),this._updatePrecomputedVariables(),this._updatePixelFlow()}_updatePrecomputedVariables(){const e=this.definition,r=e.compared,i=r.sourceZoom,s=r.targetZoom;this._zoomSign=i>s?1:-1,this._panPixelsAtSource=r.pan*e.source.pixelsPerPanAtZoom(i);const n=(e.source.pixelsPerRotate()+e.target.pixelsPerRotate())/2;this._rotatePixels=r.rotate*n}_updatePixelFlow(){const e=this.definition.compared.sourceZoom,r=this.definition.compared.targetZoom,{hasZoom:i,hasPan:s,hasRotate:n}=this.definition;let o=0,a=0;i&&(s&&(o=(r/e-1)/(-1/(this._zoomSign*this.definition.halfWindowSize)*Math.LN2*this._panPixelsAtSource)),n&&(a=this._zoomSign*(Math.log(e/r)/Math.LN2)*this.definition.halfWindowSize/this._rotatePixels)),this._zoomPixelFlow=0,this._panPixelFlow=0,this._rotatePixelFlow=0;const l=this.definition.desiredPixelFlow;if(i&&s&&n){const u=o+a+o*a;this._zoomPixelFlow=o*a/u*l,this._panPixelFlow=a/u*l,this._rotatePixelFlow=o/u*l}else if(i&&s){const u=1+o;this._zoomPixelFlow=o/u*l,this._panPixelFlow=1/u*l}else if(i&&n){const u=1+a;this._zoomPixelFlow=a/u*l,this._rotatePixelFlow=1/u*l}else if(s&&n){const u=this._panPixelsAtSource/this._rotatePixels,h=1+u;this._panPixelFlow=u/h*l,this._rotatePixelFlow=1/h*l}else s?this._panPixelFlow=l:i?this._zoomPixelFlow=l:n&&(this._rotatePixelFlow=l);if(this._time=Math.max(this.rotateTime,this.zoomTime,this.panTime),this.fovTime>this._time){const u=this.fovTime/this._time;this._time=this.fovTime,this._zoomPixelFlow/=u,this._panPixelFlow/=u,this._rotatePixelFlow/=u}}get rotateTime(){return this.definition.hasRotate?this._rotatePixels/this._rotatePixelFlow:0}get zoomTime(){return this.definition.hasZoom?this._zoomSign*(Math.log(this.definition.compared.sourceZoom/this.definition.compared.targetZoom)/Math.LN2)*this.definition.halfWindowSize/this._zoomPixelFlow:0}get fovTime(){return this.definition.hasFov?Math.abs(this.definition.compared.fov)/rge:0}get panTime(){if(!this.definition.hasPan)return 0;if(this.definition.hasZoom){const e=-1/(this._zoomSign*this.definition.halfWindowSize)*Math.LN2,r=e*this._panPixelsAtSource;return Math.log(r*(this._zoomPixelFlow/this._panPixelFlow)+1)/(e*this._zoomPixelFlow)}return this._panPixelsAtSource/this._panPixelFlow}_interpolateComponentsZoom(e){if(e===0||e===1)return e;if(this.definition.hasZoom){const r=this.definition.compared.sourceZoom,i=this.definition.compared.targetZoom;return(r*(r/i)**-e-r)/(i-r)}return e}_interpolateComponentsFov(e){if(e===0)return this.definition.segmentStart;if(e===1)return this.definition.segmentEnd;if(this.definition.hasFov){const{segmentStart:r,segmentEnd:i}=this.definition;return r+e*(i-r)}return this.definition.segmentStart}_interpolateComponentsPan(e){if(e===0||e===1)return e;if(this.definition.hasPan&&this.definition.hasZoom){const r=-1/(this._zoomSign*this.definition.halfWindowSize)*this._zoomPixelFlow;return 1/this._panPixelsAtSource*(this._panPixelFlow*(2**(r*e*this._time)-1))/(r*Math.LN2)}return e}_interpolateComponentsRotate(e){return e}interpolateComponentsAt(e,r){e=Math.min(Math.max(e,0),1),r.zoom=this._interpolateComponentsZoom(e),r.pan=this._interpolateComponentsPan(e),r.rotate=this._interpolateComponentsRotate(e),r.zoomOffset=0,r.fov=this._interpolateComponentsFov(e)}};const rge=Vm(45);function ige(t,e,r){const i=e-t.compared.sourceZoom,s=t.halfWindowPanAtZoom(i);return-t.halfWindowSize*(r.ascensionFactor*Math.LN2*t.compared.pan+s)*Math.log(t.compared.sourceZoom/e)/(t.desiredPixelFlow*Math.LN2*s)}function sge(t,e,r){const i=1/e,s=Math.log(t.compared.sourceZoom*i),n=1/t.desiredPixelFlow,o=1/Math.LN2,a=e-t.compared.sourceZoom,l=1/a,u=(r.ascensionFactor*Math.LN2*t.compared.pan+t.halfWindowPanAtZoom(a))/t.halfWindowPanAtZoom(1);return t.halfWindowSize*i*n*o*l*u-t.halfWindowSize*s*n*o*l+t.halfWindowSize*s*n*o*u/(a*a)}function nge(t,e,r){const i=e-t.compared.sourceZoom,s=1/i,n=1/e,o=Math.log(t.compared.sourceZoom*n),a=(r.ascensionFactor*Math.LN2*t.compared.pan+t.halfWindowPanAtZoom(i))/t.halfWindowPanAtZoom(1);return t.halfWindowSize*s*(-2*s*n*a+2*s*o+2*n-2*o*a/(i*i)-a/(e*e))/(t.desiredPixelFlow*Math.LN2)}function oge(t,e){return-t.halfWindowSize*Math.log(t.compared.sourceZoom/e)/(t.desiredPixelFlow*Math.LN2)}function age(t,e){return t.halfWindowSize/(e*t.desiredPixelFlow*Math.LN2)}function lge(t,e){return-t.halfWindowSize/(e*e*t.desiredPixelFlow*Math.LN2)}function uge(t,e,r){return-t.compared.pan*t.halfWindowSize*(r.ascensionFactor+r.descensionFactor-1)/(t.desiredPixelFlow*t.halfWindowPanAtZoom(e))}function cge(t,e,r){return t.compared.pan*t.halfWindowSize*(r.ascensionFactor+r.descensionFactor-1)/(t.desiredPixelFlow*t.halfWindowPanAtZoom(e*e))}function hge(t,e,r){return-2*t.compared.pan*t.halfWindowSize*(r.ascensionFactor+r.descensionFactor-1)/(t.desiredPixelFlow*t.halfWindowPanAtZoom(e*e*e))}function dge(t,e,r){return t.halfWindowSize*(-t.halfWindowPanAtZoom(e)-r.descensionFactor*Math.LN2*t.compared.pan+t.halfWindowPanAtZoom(t.compared.targetZoom))*Math.log(e/t.compared.targetZoom)/(t.desiredPixelFlow*Math.LN2*t.halfWindowPanAtZoom(-e+t.compared.targetZoom))}function pge(t,e,r){const i=Math.log(e/t.compared.targetZoom),s=1/t.desiredPixelFlow,n=1/Math.LN2,o=-e+t.compared.targetZoom,a=1/o,l=(-t.halfWindowPanAtZoom(e)-r.descensionFactor*Math.LN2*t.compared.pan+t.halfWindowPanAtZoom(t.compared.targetZoom))/t.halfWindowPanAtZoom(1);return-t.halfWindowSize*i*s*n*a+t.halfWindowSize*i*s*n*l/(o*o)+t.halfWindowSize*s*n*a*l/e}function fge(t,e,r){const i=e-t.compared.targetZoom,s=1/i,n=1/e,o=Math.log(e/t.compared.targetZoom),a=(t.halfWindowPanAtZoom(e)+r.descensionFactor*Math.LN2*t.compared.pan-t.halfWindowPanAtZoom(t.compared.targetZoom))/t.halfWindowPanAtZoom(1);return t.halfWindowSize*s*(-2*s*n*a-2*s*o+2*n+2*o*a/(i*i)-a/(e*e))/(t.desiredPixelFlow*Math.LN2)}function mge(t,e){return t.halfWindowSize*Math.log(e/t.compared.targetZoom)/(t.desiredPixelFlow*Math.LN2)}function yge(t,e){return t.halfWindowSize/(e*t.desiredPixelFlow*Math.LN2)}function gge(t,e){return-t.halfWindowSize/(e*e*t.desiredPixelFlow*Math.LN2)}function vge(t){const e=t.compared.sourceZoom-t.compared.targetZoom;if(e===0)return t.compared.pan*t.halfWindowSize/(t.desiredPixelFlow*t.halfWindowPanAtZoom(t.compared.sourceZoom));const r=Math.LN2*t.compared.pan,i=e,s=t.halfWindowPanAtZoom(i),n=t.halfWindowSize*Math.log(t.compared.sourceZoom/t.compared.targetZoom)/(t.desiredPixelFlow*Math.LN2*s);return t.compared.sourceZoom<=t.compared.targetZoom?n*(r-s):n*(r+s)}function _ge(t,e){let r=bge(t,e);const i={ascensionFactor:e.ascensionFactor!=null?e.ascensionFactor:.5,descensionFactor:e.descensionFactor!=null?e.descensionFactor:.5},s=i.ascensionFactor===0,n=i.descensionFactor===0,o=s?oge:ige,a=s?age:sge,l=s?lge:nge,u=n?mge:dge,h=n?yge:pge,p=n?gge:fge,m=I=>o(t,I,i)+uge(t,I,i)+u(t,I,i),y=I=>a(t,I,i)+cge(t,I,i)+h(t,I,i),g=I=>l(t,I,i)+hge(t,I,i)+p(t,I,i);let v=m(r);const _=vge(t);let b;const S=e.maximumIterations||20,$=e.maximumDistance!=null?e.maximumDistance:1/0;for(b=0;b<S;b++){const I=e.desiredSlope??1e-6;let P=y(r);Math.abs(P)>I&&(P+=I);const R=P/g(r);if(isNaN(R)||r>=$&&R<0){if(!isFinite($))return null;r=$,v=m(r);break}if(r-=R,r<=t.compared.sourceZoom||r<=t.compared.targetZoom)return null;const D=m(r);if(Math.abs(D-v)/v<=.005)break;v=D}return isNaN(v)||v>_*(1-.3)||r<=t.compared.sourceZoom||r<=t.compared.targetZoom?null:r}function bge(t,e){const r=Math.max(t.compared.sourceZoom,t.compared.targetZoom),i=t.source.zoomAtPixelsPerPan(t.desiredPixelFlow/t.compared.pan)/2;return i<r?e.maximumDistance!=null?r+(e.maximumDistance-r)/2:1.5*r:e.maximumDistance?Math.min(e.maximumDistance,i):i}let wge=class extends tge{constructor(e,r){super(),this._preallocSegments=[new a$,new a$,new a$],this._ascensionSegment=null,this._descensionSegment=null,this.update(e,r)}update(e,r){if(!e)return;this.definition?this.definition.copyFrom(e):this.definition=e.clone();const i=r?.apex?_ge(e,r.apex):null;this.segments.length=0,this._ascensionSegment=null,this._descensionSegment=null,i?this._updateWithApex(i,r?.apex):this._updateWithoutApex()}segmentInterpolateComponentsAt(e,r,i){e.interpolateComponentsAt(r,i),e===this._ascensionSegment?i.zoom=Gw(i.zoom):e===this._descensionSegment&&(i.zoom=H0(i.zoom))}_updateWithApex(e,r){const[i,s,n]=this._preallocSegments,o=r?.ascensionFactor??.5,a=Math.min(1-o,r?.ascensionFactor!=null&&r.descensionFactor!=null?r.descensionFactor:.5),l=1-o-a;i.definition?i.definition.copyFrom(this.definition):i.definition=this.definition.clone(),i.definition.compared.targetZoom=e,i.definition.compared.pan=this.definition.compared.pan*o,i.definition.compared.rotate=this.definition.compared.rotate*o,i.definition.segmentEnd=o,i.update(),this._ascensionSegment=i,this.segments.push(i),l>0&&(s.definition?s.definition.copyFrom(this.definition):s.definition=this.definition.clone(),s.definition.copyFrom(this.definition),s.definition.compared.sourceZoom=e,s.definition.compared.targetZoom=e,s.definition.compared.pan=this.definition.compared.pan*l,s.definition.compared.rotate=this.definition.compared.rotate*l,s.definition.segmentStart=i.definition.segmentEnd,s.definition.segmentEnd=i.definition.segmentEnd+l,s.update(),this.segments.push(s)),n.definition?n.definition.copyFrom(this.definition):n.definition=this.definition.clone(),n.definition.compared.sourceZoom=e,n.definition.compared.pan=this.definition.compared.pan*a,n.definition.compared.rotate=this.definition.compared.rotate*a,n.definition.segmentStart=o+l,n.update(),this._descensionSegment=n,this.segments.push(n)}_updateWithoutApex(){const[e]=this._preallocSegments;e.update(this.definition),this.segments.push(e)}};const Sge=new ege;let xge=class{get time(){return this._time}get isLinear(){return this.path.segments.length===1}constructor(e){this._time=0,this._easing=Xw,this.definition=new Qye(e),this.path=new wge}update(e,r,i){this.definition.update(e,r,i),this.path.update(this.definition,i),this._time=this._applyTimeSettings(AK(isFinite(this.path.time)?this.path.time:0),i),this._easing=i.easing??(this._time>=1e3?Xw:Jw)}cameraAt(e,r){e=Math.min(Math.max(0,e),1),e=this._normalizedEasing(e);const i=this.path.interpolateComponentsAt(e,Sge);r.interpolate(this.definition.source,this.definition.target,i)}_normalizedEasing(e){const r=this._easing(0,this._time),i=this._easing(1,this._time);return(this._easing(e,this._time)-r)/(i-r)}_applyTimeSettings(e,r){const i=r.speedFactor!=null?r.speedFactor:1,s=r.minDuration??Kw.minDuration/i,n=r.maxDuration??Kw.maxDuration/i;return e=r.duration!=null?r.duration:Math.min(Math.max(e/i,s),n)}};const $ge=2e3,Mge=64;let Tge=class{constructor(e){this._view=e,this._animation=new xge((()=>new ON(this._view))),this._current=new ON(this._view)}get _source(){return this._animation.definition.source}get _target(){return this._animation.definition.target}get duration(){return this._animation.time}get animation(){return this._animation}update(e,r,i={}){wi(this._current.viewpoint,e),wi(this._source.viewpoint,e),wi(this._target.viewpoint,r),this._animation.update(this._source,this._target,i)}applyRatio(e,r){this._animation.cameraAt(r,this._current),wi(e,this._current.viewpoint)}},vp=class extends ce{constructor(e){super(e),this._animation=null,this._destinationViewState=new PA,this.updateFunction=null,this.easing=e5.ease,this.viewpoint=new mn({targetGeometry:new ge,scale:0,rotation:0}),this._updateTask=om({postRender:this._postRender.bind(this)}),this._updateTask.pause(),this._transition=new Tge(e.view)}destroy(){this._updateTask=Lt(this._updateTask)}get animation(){return this._animation}set animation(e){this._animation=e,this.view.animation=e}animate(e,r,i){this.stop();const s=this.viewpoint;wi(s,r);const n=e.target;this._transition.update(this.viewpoint,n,{apex:{maximumDistance:Math.min(Math.min(r.scale,n.scale)*Mge,this.view.constraints.effectiveMinScale),desiredSlope:5e-8},duration:i?.duration,maxDuration:i?.animationMode==="auto"?1/0:i?.maxDuration??rB.maxDuration,speedFactor:i?.speedFactor,easing:(typeof i?.easing=="string"?e5[i.easing]:i?.easing)||this.easing}),i?.animationMode==="auto"&&(this._destinationViewState.copy(this.view.state),this._destinationViewState.viewpoint=n,Ege(this._transition.animation,i,this.view.state,this._destinationViewState)||this._transition.update(this.viewpoint,n,{duration:0}));const o=()=>{this.animation===e&&this._updateTask&&(e.state==="finished"&&(this._transition.applyRatio(this.viewpoint,1),this.view.state&&(this.view.state.viewpoint=this.viewpoint.clone())),this.animation=null,this.updateFunction=null)};return e.when(o,o),this._startTime=performance.now(),this._updateTask.resume(),this.animation=e,e}animateContinuous(e,r){this.stop(),this.updateFunction=r,this.viewpoint=e;const i=new bI({target:e.clone()}),s=()=>{this.animation===i&&this._updateTask&&(this.animation=null,this.updateFunction=null)};return i.when(s,s),this._startTime=performance.now(),this._updateTask.resume(),this.animation=i,i}stop(){this.animation&&(this.animation.stop(),this.animation=null,this.updateFunction=null)}_postRender(e){const r=this.animation;if(r&&r.state!==bI.State.STOPPED){if(this.updateFunction)this.updateFunction(this.viewpoint,e.deltaTime),this.animation?.update(this.viewpoint);else{const i=performance.now()-this._startTime,s=this._transition.duration,n=s>0?i/s:1,o=n>=1;this._transition.applyRatio(this.viewpoint,n),o&&this.animation?.finish()}this.view.state&&(this.view.state.viewpoint=this.viewpoint.clone())}else this._updateTask.pause()}};function Ege(t,e,r,i){if(e?.duration!=null)return!0;const{time:s,isLinear:n}=t,o=e?.speedFactor||1;if(s>(e?.maxDuration??rB.maxDuration/o))return!1;if(n){const l=Ut(),u=or(...i.toScreen(l,...r.center)),h=or(...r.toScreen(l,...i.center)),p=h!=null&&h.x>-1*r.size[0]&&h.x<(1.5+.5)*r.size[0]&&h.y>-1*r.size[1]&&h.y<(1.5+.5)*r.size[1],m=u!=null&&u.x>-1*i.size[0]&&u.x<(1.5+.5)*i.size[0]&&u.y>-1*i.size[1]&&u.y<(1.5+.5)*i.size[1];if(s>$ge/o&&!p&&!m)return!1}return!0}c([d()],vp.prototype,"easing",void 0),c([d()],vp.prototype,"view",void 0),c([d()],vp.prototype,"viewpoint",void 0),vp=c([C("esri.views.2d.AnimationManager")],vp);const Ige=vp;function _t(){return Promise.all([J(()=>import("./webglDeps-DWJWwPVg.js"),__vite__mapDeps([172,173,174,175])),J(()=>import("./mapViewDeps-BG3K5zX5.js"),__vite__mapDeps([176,177,84,178,174,173,147,125,80,179,81,52,180,79,100,181,132,131,87,28,24,29,82,88,182,85,86,130,172,175,183,95,184,185,186,144,141,123,68,78,26,21,32,187,188,83,189,90,190,92,57,76,191,192,193,194,140,195]))])}const vy=()=>_t().then((()=>J(()=>import("./TileLayerView2D-Ptkpbdzr.js"),__vite__mapDeps([196,80,181,180,79,52,173,100,132,131,87,28,24,29,130,183,178,174,147,125,179,81,95,184,185,68,84,177,82,88,85,86,144,141,123,190,78,26,21,32,92,57,76,197,198,199,194,200,162,201,192,193,202,203,204,205])))),Ic=()=>_t().then((()=>J(()=>import("./FeatureLayerView2D-C2fVO2VI.js").then(t=>t.F),__vite__mapDeps([206,28,24,29,207,208,209,26,21,35,200,181,162,193,80,79,52,174,173,194,180,100,132,131,87,177,84,178,147,125,179,81,82,88,95,182,210,94,205,202])))),t5={"base-dynamic":()=>_t().then((()=>J(()=>import("./BaseDynamicLayerView2D-BqRtisVk.js"),__vite__mapDeps([211,212,180,79,52,173,100,181,132,131,87,28,24,29,198,178,174,147,125,84,199,200,162,213,202])))),"base-tile":vy,"bing-maps":vy,catalog:()=>_t().then((()=>J(()=>import("./CatalogLayerView2D-CJPOpgnw.js"),__vite__mapDeps([214,200,181,162])))),"catalog-dynamic-group":()=>_t().then((()=>J(()=>import("./CatalogDynamicGroupLayerView2D-BEXvBIW1.js"),__vite__mapDeps([215,200,181,162])))),"catalog-footprint":()=>_t().then((()=>J(()=>import("./CatalogFootprintLayerView2D-CgdOBDd1.js"),__vite__mapDeps([216,206,28,24,29,207,208,209,26,21,35,200,181,162,193,80,79,52,174,173,194,180,100,132,131,87,177,84,178,147,125,179,81,82,88,95,182,210,94,205,202])))),csv:Ic,"geo-rss":()=>_t().then((()=>J(()=>import("./GeoRSSLayerView2D-YOL94o05.js"),__vite__mapDeps([217,200,181,162,191,192,193,80,79,52,174,173,194,180,100,132,131,87,28,24,29,177,84,178,147,125,179,81,82,88,190,78,26,21,32,92,57,76])))),feature:Ic,geojson:Ic,parquet:Ic,graphics:()=>_t().then((()=>J(()=>import("./GraphicsLayerView2D-DQVA4h7c.js"),__vite__mapDeps([218,200,181,162,191,192,193,80,79,52,174,173,194,180,100,132,131,87,28,24,29,177,84,178,147,125,179,81,82,88,190,78,26,21,32,92,57,76])))),group:()=>_t().then((()=>J(()=>import("./GroupLayerView2D-CKZYZkGp.js"),__vite__mapDeps([219,200,181,162])))),imagery:()=>_t().then((()=>J(()=>import("./ImageryLayerView2D-CldsVw7C.js"),__vite__mapDeps([220,221,173,52,108,180,79,100,181,132,131,87,28,24,29,200,162,190,78,80,81,26,21,32,177,84,178,174,147,125,179,82,88,92,57,76,201,192,193,194,212,198,199,213,112,207,205,202])))),"imagery-tile":()=>_t().then((()=>J(()=>import("./ImageryTileLayerView2D-BzMkHW7e.js"),__vite__mapDeps([222,223,221,173,52,108,180,79,100,181,132,131,87,28,24,29,200,162,111,224,194,178,174,147,125,84,199,179,81,225,112,207,205,202])))),kml:()=>_t().then((()=>J(()=>import("./KMLLayerView2D-CNidZHvA.js"),__vite__mapDeps([226,227,198,181,178,174,173,147,125,84,199,212,180,79,52,100,132,131,87,28,24,29,200,162,191,192,193,80,194,177,179,81,82,88,190,78,26,21,32,92,57,76,189,90,112,186,172,175,144,141,123,184,224])))),"knowledge-graph":()=>_t().then((()=>J(()=>import("./KnowledgeGraphLayerView2D-Cvid4tsf.js"),__vite__mapDeps([228,200,181,162])))),"link-chart":()=>_t().then((()=>J(()=>import("./KnowledgeGraphLayerView2D-Cvid4tsf.js"),__vite__mapDeps([228,200,181,162])))),"knowledge-graph-sublayer":Ic,"map-image":()=>_t().then((()=>J(()=>import("./MapImageLayerView2D-DgPlyA4k.js"),__vite__mapDeps([229,212,180,79,52,173,100,181,132,131,87,28,24,29,198,178,174,147,125,84,199,200,162,190,78,80,81,26,21,32,177,179,82,88,92,57,76,201,192,193,194,213,207,202,203,204,205])))),"map-notes":()=>_t().then((()=>J(()=>import("./MapNotesLayerView2D-CbXxBwer.js"),__vite__mapDeps([230,200,181,162,191,192,193,80,79,52,174,173,194,180,100,132,131,87,28,24,29,177,84,178,147,125,179,81,82,88,190,78,26,21,32,92,57,76])))),media:()=>_t().then((()=>J(()=>import("./MediaLayerView2D-BnycMmqP.js"),__vite__mapDeps([231,232,92,57,80,181,180,79,52,173,100,132,131,87,28,24,29,130,183,178,174,147,125,179,81,95,184,185,68,84,177,82,88,85,86,144,141,123,190,78,26,21,32,76,187,233,188,200,162])))),"ogc-feature":()=>_t().then((()=>J(()=>import("./OGCFeatureLayerView2D-DTNQJuTz.js"),__vite__mapDeps([234,206,28,24,29,207,208,209,26,21,35,200,181,162,193,80,79,52,174,173,194,180,100,132,131,87,177,84,178,147,125,179,81,82,88,95,182,210,94,205,202])))),"open-street-map":vy,"oriented-imagery":Ic,route:()=>_t().then((()=>J(()=>import("./RouteLayerView2D-CpByvJ2N.js"),__vite__mapDeps([235,236,237,200,181,162,191,192,193,80,79,52,174,173,194,180,100,132,131,87,28,24,29,177,84,178,147,125,179,81,82,88,190,78,26,21,32,92,57,76])))),stream:()=>_t().then((()=>J(()=>import("./StreamLayerView2D-ZKlT1qTs.js"),__vite__mapDeps([238,206,28,24,29,207,208,209,26,21,35,200,181,162,193,80,79,52,174,173,194,180,100,132,131,87,177,84,178,147,125,179,81,82,88,95,182,210,94,205,202])))),"subtype-group":()=>_t().then((()=>J(()=>import("./SubtypeGroupLayerView2D-DCFCVj5T.js"),__vite__mapDeps([239,206,28,24,29,207,208,209,26,21,35,200,181,162,193,80,79,52,174,173,194,180,100,132,131,87,177,84,178,147,125,179,81,82,88,95,182,210,94,205,202])))),tile:vy,"vector-tile":()=>_t().then((()=>J(()=>import("./VectorTileLayerView2D-DvncI6Q_.js"),__vite__mapDeps([240,130,68,185,131,132,173,180,79,52,100,181,87,28,24,29,194,38,133,134,200,162,202])))),video:()=>_t().then((()=>J(()=>import("./VideoLayerView2D-CBI6x4FO.js"),__vite__mapDeps([241,242,243,233,100,180,79,52,173,181,132,131,87,28,24,29,177,84,178,174,147,125,80,179,81,82,88,188,200,162,191,192,193,194,190,78,26,21,32,92,57,76])))),wcs:()=>_t().then((()=>J(()=>import("./ImageryTileLayerView2D-BzMkHW7e.js"),__vite__mapDeps([222,223,221,173,52,108,180,79,100,181,132,131,87,28,24,29,200,162,111,224,194,178,174,147,125,84,199,179,81,225,112,207,205,202])))),"web-tile":vy,wfs:Ic,wms:()=>_t().then((()=>J(()=>import("./WMSLayerView2D-DXUbXXrU.js"),__vite__mapDeps([244,212,180,79,52,173,100,181,132,131,87,28,24,29,198,178,174,147,125,84,199,200,162,213,202,245,207])))),wmts:()=>_t().then((()=>J(()=>import("./WMTSLayerView2D-Biu_ci01.js"),__vite__mapDeps([246,197,198,181,178,174,173,147,125,84,199,180,79,52,100,132,131,87,28,24,29,194,200,162,202])))),"line-of-sight":null,"base-elevation":null,"building-scene":null,dimension:null,elevation:null,"integrated-mesh":null,"integrated-mesh-3dtiles":null,"point-cloud":null,viewshed:null,voxel:null,scene:null,unknown:null,unsupported:null};function Cge(t){const e=t.declaredClass?t.declaredClass.slice(t.declaredClass.lastIndexOf(".")+1):"Unknown",r=e.replaceAll(/([a-z])([A-Z])/g,"$1-$2").toLowerCase();return new F(`${r}:view-not-supported`,`${e} is not supported in 2D`)}const r5={hasLayerViewModule:t=>t5[t.type]!=null,importLayerView:t=>{const e=t5[t.type];if(e==null)throw Cge(t);return e(t)}};var Cs;let qm=(Cs=class{static getId(e,r,i,s){return typeof e=="object"?`${e.level}/${e.row}/${e.col}/${e.world}`:`${e}/${r}/${i}/${s}`}constructor(e,r,i,s){this.set(e,r,i,s)}get key(){return this}get id(){return this.toString()}get normalizedId(){return`${this.level}/${this.row}/${this.col}`}set id(e){this.set(e)}get hash(){const e=4095&this.row,r=4095&this.col,i=63&this.level;return(3&this.world)<<30|r<<22|e<<8|i}acquire(e,r,i,s){this.set(e,r,i,s)}contains(e){const r=e.level-this.level;return r>=0&&this.row===e.row>>r&&this.col===e.col>>r&&this.world===e.world}containsChild(e){const r=e.level-this.level;return r>0&&this.row===e.row>>r&&this.col===e.col>>r&&this.world===e.world}equals(e){return this.level===e.level&&this.row===e.row&&this.col===e.col&&this.world===e.world}clone(){return new Cs(this)}release(){this.level=0,this.row=0,this.col=0,this.world=0}set(e,r,i,s){if(e==null)this.level=0,this.row=0,this.col=0,this.world=0;else if(typeof e=="object")this.level=e.level||0,this.row=e.row||0,this.col=e.col||0,this.world=e.world||0;else if(typeof e=="string"){const[n,o,a,l]=e.split("/");this.level=parseFloat(n),this.row=parseFloat(o),this.col=parseFloat(a),this.world=parseFloat(l)}else this.level=+e,this.row=+r,this.col=+i,this.world=+s||0;return this}toString(){return`${this.level}/${this.row}/${this.col}/${this.world}`}getParentKey(){return this.level<=0?null:new Cs(this.level-1,this.row>>1,this.col>>1,this.world)}getNormalizedNeighbor(e,r,i){const s=this.clone();return s.col+=e,s.row+=r,i.normalizeKey(s),s}getChildKeys(){const e=this.level+1,r=this.row<<1,i=this.col<<1,s=this.world;return[new Cs(e,r,i,s),new Cs(e,r,i+1,s),new Cs(e,r+1,i,s),new Cs(e,r+1,i+1,s)]}compareRowMajor(e){return this.row<e.row?-1:this.row>e.row?1:this.col<e.col?-1:this.col>e.col?1:0}},Cs.pool=new Md(Cs,null,null,25,50),Cs);function Wd(t,e){return[t,e]}function Cc(t,e,r){return t[0]=e,t[1]=r,t}function Pge(t,e,r,i,s){return t[0]=e,t[1]=r,t[2]=i,t[3]=s,t}const Pn=new qm("0/0/0/0");let Age=class sB{static create(e,r,i=null){const s=Si(e.spatialReference),n=r.origin||Wd(e.origin.x,e.origin.y),o=Wd(e.size[0]*r.resolution,e.size[1]*r.resolution),a=Wd(-1/0,-1/0),l=Wd(1/0,1/0),u=Wd(1/0,1/0);i!=null&&(Cc(a,Math.max(0,Math.floor((i.xmin-n[0])/o[0])),Math.max(0,Math.floor((n[1]-i.ymax)/o[1]))),Cc(l,Math.max(0,Math.floor((i.xmax-n[0])/o[0])),Math.max(0,Math.floor((n[1]-i.ymin)/o[1]))),Cc(u,l[0]-a[0]+1,l[1]-a[1]+1));const{cols:h,rows:p}=r;let m,y,g,v;return!i&&h&&p&&(Cc(a,h[0],p[0]),Cc(l,h[1],p[1]),Cc(u,h[1]-h[0]+1,p[1]-p[0]+1)),e.isWrappable?(m=Wd(Math.ceil(Math.round((s.valid[1]-s.valid[0])/r.resolution)/e.size[0]),u[1]),y=!0,g=s.origin,v=s.valid):(m=u,y=!1),new sB(r.level,r.resolution,r.scale,n,a,l,u,o,m,y,g,v)}constructor(e,r,i,s,n,o,a,l,u,h,p,m){this.level=e,this.resolution=r,this.scale=i,this.origin=s,this.first=n,this.last=o,this.size=a,this.norm=l,this.worldSize=u,this.wrap=h,this._spatialReferenceOrigin=p,this._spatialReferenceValid=m}normalizeCol(e){if(!this.wrap)return e;const r=this.worldSize[0];return e<0?r-1-Math.abs((e+1)%r):e%r}normalizeKey(e){if(!this.wrap)return;const r=this.worldSize[0],i=e.col;i<0?(e.col=i+r,e.world-=1):i>=r&&(e.col=i-r,e.world+=1)}denormalizeCol(e,r){return this.wrap?this.worldSize[0]*r+e:e}getWorldForColumn(e){return this.wrap?Math.floor(e/this.worldSize[0]):0}getFirstColumnForWorld(e){return e*this.worldSize[0]+this.first[0]}getLastColumnForWorld(e){return e*this.worldSize[0]+this.first[0]+this.size[0]-1}getColumnForX(e){return(e-this.origin[0])/this.norm[0]}getXForColumn(e){const r=this.origin[0]+e*this.norm[0],i=this._spatialReferenceOrigin,s=this._spatialReferenceValid;return this.wrap&&i&&s?r===i[0]?s[0]:this.origin[0]===i[0]&&e===this.worldSize[0]?s[1]:r:r}getRowForY(e){return(this.origin[1]-e)/this.norm[1]}getYForRow(e){return this.origin[1]-e*this.norm[1]}getTileBounds(e,r,i=!1){Pn.set(r);const s=i?Pn.col:this.denormalizeCol(Pn.col,Pn.world),n=Pn.row;return Pge(e,this.getXForColumn(s),this.getYForRow(n+1),this.getXForColumn(s+1),this.getYForRow(n)),e}getTileCoords(e,r,i=!1){Pn.set(r);const s=i?Pn.col:this.denormalizeCol(Pn.col,Pn.world);return Array.isArray(e)?Cc(e,this.getXForColumn(s),this.getYForRow(Pn.row)):(e.x=this.getXForColumn(s),e.y=this.getYForRow(Pn.row)),e}};var ad;let RA=(ad=class{constructor(){this.spans=[]}acquire(e){this.lodInfo=e}release(){this.lodInfo=null,this.spans.length=0}*keys(){const e=this.lodInfo;for(const{row:r,colFrom:i,colTo:s}of this.spans)for(let n=i;n<=s;n++){const o=e.getWorldForColumn(n);yield new qm(e.level,r,e.normalizeCol(n),o)}}forEach(e,r){const{spans:i,lodInfo:s}=this,{level:n}=s;if(i.length!==0)for(const{row:o,colFrom:a,colTo:l}of i)for(let u=a;u<=l;u++)e.call(r,n,o,s.normalizeCol(u),s.getWorldForColumn(u))}},ad.pool=new Md(ad),ad),l$=class{constructor(e,r,i){this.row=e,this.colFrom=r,this.colTo=i}};const $t=new qm("0/0/0/0");let Lge=class nB{static create(e,r){e[1]>r[1]&&([e,r]=[r,e]);const[i,s]=e,[n,o]=r,a=n-i,l=o-s,u=l!==0?a/l:0,h=(Math.ceil(s)-s)*u,p=(Math.floor(s)-s)*u;return new nB(i,Math.floor(s),Math.ceil(o),u,a<0?h:p,a<0?p:h,a<0?n:i,a<0?i:n)}constructor(e,r,i,s,n,o,a,l){this.x=e,this.ymin=r,this.ymax=i,this.invM=s,this.leftAdjust=n,this.rightAdjust=o,this.leftBound=a,this.rightBound=l}incrRow(){this.x+=this.invM}getLeftCol(){return Math.max(this.x+this.leftAdjust,this.leftBound)}getRightCol(){return Math.min(this.x+this.rightAdjust,this.rightBound)}};const ms=[[0,0],[0,0],[0,0],[0,0]],Rge=1e-6;let kge=class{constructor(e,r=null,i=e.lods[0].level,s=e.lods[e.lods.length-1].level){this.tileInfo=e,this.fullExtent=r,this.scales=[],this._infoByScale={},this._infoByLevel={};const n=e.lods.filter((a=>a.level>=i&&a.level<=s));this.minScale=n[0].scale,this.maxScale=n[n.length-1].scale;const o=this._lodInfos=n.map((a=>Age.create(e,a,r)));n.forEach(((a,l)=>{this._infoByLevel[a.level]=o[l],this._infoByScale[a.scale]=o[l],this.scales[l]=a.scale}),this),this._wrap=e.isWrappable}get spatialReference(){return this.tileInfo.spatialReference}getLODInfoAt(e){return this._infoByLevel[typeof e=="number"?e:e.level]}getTileBounds(e,r,i=!1){$t.set(r);const s=this._infoByLevel[$t.level];return s?s.getTileBounds(e,$t,i):e}getTileCoords(e,r,i=!1){$t.set(r);const s=this._infoByLevel[$t.level];return s?s.getTileCoords(e,$t,i):e}getTileCoverage(e,r=192,i=!0,s="closest"){if(!i&&(e.scale>this.minScale||e.scale<this.maxScale))return null;const n=s==="closest"?this.getClosestInfoForScale(e.scale):this.getSmallestInfoForScale(e.scale),o=RA.pool.acquire(n),a=this._wrap;let l,u,h,p=1/0,m=-1/0;const y=o.spans;ms[0][0]=ms[0][1]=ms[1][1]=ms[3][0]=-r,ms[1][0]=ms[2][0]=e.size[0]+r,ms[2][1]=ms[3][1]=e.size[1]+r;for(const b of ms)e.toMap(b,b),b[0]=n.getColumnForX(b[0]),b[1]=n.getRowForY(b[1]);const g=[];let v=3;for(let b=0;b<4;b++){if(ms[b][1]===ms[v][1]){v=b;continue}const S=Lge.create(ms[b],ms[v]);p=Math.min(S.ymin,p),m=Math.max(S.ymax,m),g[S.ymin]===void 0&&(g[S.ymin]=[]),g[S.ymin].push(S),v=b}if(p==null||m==null||m-p>100)return null;let _=[];for(l=p;l<m;){g[l]!=null&&(_=_.concat(g[l])),u=1/0,h=-1/0;for(let b=_.length-1;b>=0;b--){const S=_[b];u=Math.min(u,S.getLeftCol()),h=Math.max(h,S.getRightCol())}if(u=Math.floor(u),h=Math.floor(h),l>=n.first[1]&&l<=n.last[1])if(a)if(n.size[0]<n.worldSize[0]){const b=Math.floor(h/n.worldSize[0]);for(let S=Math.floor(u/n.worldSize[0]);S<=b;S++)y.push(new l$(l,Math.max(n.getFirstColumnForWorld(S),u),Math.min(n.getLastColumnForWorld(S),h)))}else y.push(new l$(l,u,h));else u>n.last[0]||h<n.first[0]||(u=Math.max(u,n.first[0]),h=Math.min(h,n.last[0]),y.push(new l$(l,u,h)));l+=1;for(let b=_.length-1;b>=0;b--){const S=_[b];S.ymax>=l?S.incrRow():_.splice(b,1)}}return o}getTileParentId(e){$t.set(e);const r=this._infoByLevel[$t.level],i=this._lodInfos.indexOf(r)-1;return i<0?null:(this._getTileIdAtLOD($t,this._lodInfos[i],$t),$t.id)}getTileResolution(e){const r=this._infoByLevel[typeof e=="object"?e.level:e];return r?r.resolution:-1}getTileScale(e){const r=this._infoByLevel[e.level];return r?r.scale:-1}intersects(e,r){$t.set(r);const i=this._infoByLevel[$t.level],s=e.lodInfo;if(s.resolution>i.resolution){this._getTileIdAtLOD($t,s,$t);const o=s.denormalizeCol($t.col,$t.world);for(const a of e.spans)if(a.row===$t.row&&a.colFrom<=o&&a.colTo>=o)return!0}if(s.resolution<i.resolution){const[o,a,l,u]=e.spans.reduce(((v,_)=>(v[0]=Math.min(v[0],_.row),v[1]=Math.max(v[1],_.row),v[2]=Math.min(v[2],_.colFrom),v[3]=Math.max(v[3],_.colTo),v)),[1/0,-1/0,1/0,-1/0]),h=i.denormalizeCol($t.col,$t.world),p=s.getColumnForX(i.getXForColumn(h)),m=s.getRowForY(i.getYForRow($t.row)),y=s.getColumnForX(i.getXForColumn(h+1))-1,g=s.getRowForY(i.getYForRow($t.row+1))-1;return!(p>u||y<l||m>a||g<o)}const n=s.denormalizeCol($t.col,$t.world);return e.spans.some((o=>o.row===$t.row&&o.colFrom<=n&&o.colTo>=n))}normalizeBounds(e,r,i){if(e[0]=r[0],e[1]=r[1],e[2]=r[2],e[3]=r[3],this._wrap){const s=Si(this.tileInfo.spatialReference),n=-i*(s.valid[1]-s.valid[0]);e[0]+=n,e[2]+=n}return e}getSmallestInfoForScale(e){const r=this.scales;if(this._infoByScale[e])return this._infoByScale[e];if(e>r[0])return this._infoByScale[r[0]];for(let i=1;i<r.length-1;i++)if(e>r[i]+Rge)return this._infoByScale[r[i-1]];return this._infoByScale[r[r.length-1]]}getClosestInfoForScale(e){const r=this.scales;return this._infoByScale[e]||(e=r.reduce(((i,s)=>Math.abs(s-e)<Math.abs(i-e)?s:i),r[0])),this._infoByScale[e]}scaleToLevel(e){const r=this.scales;if(this._infoByScale[e])return this._infoByScale[e].level;for(let i=r.length-1;i>=0;i--)if(e<r[i])return i===r.length-1?this._infoByScale[r[r.length-1]].level:this._infoByScale[r[i]].level+(r[i]-e)/(r[i]-r[i+1]);return this._infoByScale[r[0]].level}scaleToZoom(e){return this.tileInfo.scaleToZoom(e)}zoomToScale(e){return this.tileInfo.zoomToScale(e)}_getTileIdAtLOD(e,r,i){const s=this._infoByLevel[i.level];return e.set(i),r.resolution<s.resolution?null:(r.resolution===s.resolution||(e.level=r.level,e.col=Math.floor(i.col*s.resolution/r.resolution+.01),e.row=Math.floor(i.row*s.resolution/r.resolution+.01)),e)}},Oge=class{constructor(e,r){this.item=e,this.controller=r,this.promise=null}},Nge=class{constructor(e){this._schedule=null,this._task=null,this._deferreds=new nb,this._controllers=new nb,this._processingItems=new nb,this._pausedSignal=gm(!1),this.concurrency=1,e.concurrency&&(this.concurrency=e.concurrency),this._queue=new F0(e.peeker),this.process=e.process;const r=e.scheduler;e.priority&&r&&(this._task=r.registerTask(e.priority,this))}destroy(){this.clear(),this._schedule=Lt(this._schedule),this._task=Lt(this._task)}get updating(){return!!this._task?.updating||this.running}get length(){return this._processingItems.size+this._queue.length}abort(e){const r=this._controllers.get(e);r&&r.abort()}clear(){this._queue.clear();const e=[];this._controllers.forEach((r=>e.push(r))),this._controllers.clear(),e.forEach((r=>r.abort())),this._processingItems.clear(),this._cancelNext()}forEach(e){this._deferreds.forEach(((r,i)=>e(i)))}get(e){const r=this._deferreds.get(e);return r?r.promise:void 0}isOngoing(e){return this._processingItems.has(e)}has(e){return this._deferreds.has(e)}pause(){this._pausedSignal.value||(this._pausedSignal.value=!0,this._cancelNext())}push(e,r){const i=this.get(e);if(i)return i;const s=new AbortController;let n=null;r&&(n=ao(r,(()=>s.abort())));const o=()=>{const h=this._processingItems.get(e);h&&h.controller.abort(),a(),u.reject(St())},a=()=>{l.remove(),n?.remove(),this._removeItem(e),this._queue.remove(e),this._scheduleNext()},l=XP(s.signal,o),u=Ns();return this._deferreds.set(e,u),this._controllers.set(e,s),u.promise.then(a,a),this._queue.push(e),this._scheduleNext(),u.promise}last(){return this._queue.last()}lastPromise(){const e=this.last();return e?this.get(e):null}peek(){return this._queue.peek()}popLast(){const e=this._queue.popLast();return e&&(this._deferreds.get(e)?.reject(St()),this._removeItem(e)),e}reset(){const e=Array.from(this._processingItems.values());this._processingItems.clear();for(const r of e)this._queue.push(r.item),r.controller.abort();this._scheduleNext()}resume(){this._pausedSignal.value&&(this._pausedSignal.value=!1,this._scheduleNext())}takeAll(){const e=[];for(;this._queue.length;)e.push(this._queue.pop());return this.clear(),e}get running(){return!this._pausedSignal.value&&this._queue.length>0&&this._processingItems.size<this.concurrency}runTask(e){for(;!e.done&&this._queue.length>0&&this._processingItems.size<this.concurrency;)this._process(this._queue.pop()),e.madeProgress()}_removeItem(e){this._deferreds.delete(e),this._controllers.delete(e),this._processingItems.delete(e)}_scheduleNext(){this._task||this._pausedSignal.value||this._schedule||(this._schedule=bv((()=>{this._schedule=null,this._next()})))}_next(){for(;this._queue.length>0&&this._processingItems.size<this.concurrency;)this._process(this._queue.pop())}_cancelNext(){this._schedule&&(this._schedule.remove(),this._schedule=null)}_processResult(e,r){this._canProcessFulfillment(e)&&(this._scheduleNext(),this._deferreds.get(e.item).resolve(r))}_processError(e,r){this._canProcessFulfillment(e)&&(this._scheduleNext(),this._deferreds.get(e.item).reject(r))}_canProcessFulfillment(e){return!!this._deferreds.get(e.item)&&this._processingItems.get(e.item)===e}_process(e){if(e==null)return;let r;const i=new AbortController,s=new Oge(e,i);this._processingItems.set(e,s);try{r=this.process(e,i.signal)}catch(n){this._processError(s,n)}Ia(r)?(s.promise=r,r.then((n=>this._processResult(s,n)),(n=>this._processError(s,n)))):this._processResult(s,r)}get test(){}};const i5=[0,0];let Qa=class extends ce{constructor(e){super(e),this._keyToItem=new Map,this._tilesByScale=new Map,this.concurrency=6}initialize(){const{concurrency:e,process:r,scheduler:i,priority:s}=this;this._queue=new Nge({concurrency:e,scheduler:i,priority:s,process:(n,o)=>{const a=this._keyToItem.get(n);return r(a,{signal:o})},peeker:n=>this._peek(n)})}destroy(){this.clear(),this._queue=At(this._queue)}get length(){return this._queue?this._queue.length:0}abort(e){const r=typeof e=="string"?e:e.id;this._queue.abort(r)}clear(){this._queue.clear(),this._keyToItem.clear(),this._tilesByScale.clear()}has(e){return typeof e=="string"?this._keyToItem.has(e):this._keyToItem.has(e.id)}pause(){this._queue.pause()}push(e){const r=e.key.id;if(this._queue.has(r))return this._queue.get(r);const i=this._queue.push(r),s=this.tileInfoView.getTileScale(e.key),n=Pm(this._tilesByScale,s,(()=>new Set)),o=()=>{n.delete(e.key),n.size===0&&this._tilesByScale.delete(s),this._keyToItem.delete(r)};return n.add(e.key),this._keyToItem.set(r,e),i.then(o,o),i}reset(){this._queue.reset()}resume(){this._queue.resume()}_peek(e){if(!this.state)return e.values().next().value;const r=new Set;for(const o of e)r.add(this._keyToItem.get(o).key);const i=this.state.scale;let s,n=Number.POSITIVE_INFINITY;for(const[o,a]of this._tilesByScale)if(pV(a,(l=>r.has(l)))){const l=Math.abs(o-i);l<n&&(s=a,n=l)}return this._getClosestTileKey(s,e).id}_getClosestTileKey(e,r){const i=this.tileInfoView,s=this.state.center;let n,o=Number.POSITIVE_INFINITY;for(const a of e)if(r.has(a.id)){i.getTileCoords(i5,a);const l=I2(i5,s);l<o&&(o=l,n=a)}return n}};c([d({constructOnly:!0})],Qa.prototype,"concurrency",void 0),c([d({constructOnly:!0})],Qa.prototype,"priority",void 0),c([d({constructOnly:!0})],Qa.prototype,"process",void 0),c([d({constructOnly:!0})],Qa.prototype,"scheduler",void 0),c([d()],Qa.prototype,"state",void 0),c([d({constructOnly:!0})],Qa.prototype,"tileInfoView",void 0),Qa=c([C("esri.views.2d.tiling.TileQueue")],Qa);const kFe=Qa;let Fge=class{constructor(e,r,i){this.maxSize=e,this._tileInfoView=r,this._removedFunc=i,this._tilePerId=new Map,this._tileKeysPerLevel=[]}clear(){this._tilePerId.clear(),this._tileKeysPerLevel=[]}has(e){return this._tilePerId.has(e)}get(e){return this._tilePerId.get(e)}pop(e){const r=this._tilePerId.get(e);if(!r)return;const i=r.key.level,s=this._tileKeysPerLevel[i];s5(this._tilePerId,e);for(let n=0;n<s.length;n++)if(s[n].id===e){s.splice(n,1);break}return r.visible=!0,r}add(e){e.visible=!1;const r=e.key,i=r.id;if(this._tilePerId.has(i))return;this._tilePerId.set(i,e);const s=r.level;this._tileKeysPerLevel[s]||(this._tileKeysPerLevel[s]=[]),this._tileKeysPerLevel[s].push(r)}prune(e,r,i){let s=this._tilePerId.size;if(s<=this.maxSize)return;let n=this._tileKeysPerLevel.length-1;for(;s>this.maxSize&&n>=0;)n!==e&&(s=this._pruneAroundCenterTile(s,r,i,n)),n--;s>this.maxSize&&(s=this._pruneAroundCenterTile(s,r,i,e))}_pruneAroundCenterTile(e,r,i,s){const n=this._tileKeysPerLevel[s];if(!n||n.length===0)return e;const{size:o,origin:a}=this._tileInfoView.tileInfo,l=i*o[0],u=i*o[1],h=[0,0],p=[0,0];for(n.sort(((m,y)=>(h[0]=a.x+l*(m.col+.5),h[1]=a.y-u*(m.row+.5),p[0]=a.x+l*(y.col+.5),p[1]=a.y-u*(y.row+.5),zw(h,r)-zw(p,r))));n.length>0;){const m=n.pop();if(this._removeTile(m.id),--e===this.maxSize)break}return e}_removeTile(e){const r=this._tilePerId.get(e);this._removedFunc&&r&&this._removedFunc(r),s5(this._tilePerId,e)}};function s5(t,e){t.delete(e)}const Pc=new qm(0,0,0,0),Oa=new Map,_y=[],u$=[];let NFe=class{constructor(e){this._previousScale=Number.POSITIVE_INFINITY,this.cachePolicy="keep",this.coveragePolicy="closest",this.resampling=!0,this.tileIndex=new Map,this.tiles=[],this.buffer=192,this.acquireTile=e.acquireTile,this.releaseTile=e.releaseTile,this.tileInfoView=e.tileInfoView,e.resampling!=null&&(this.resampling=e.resampling),e.cachePolicy&&(this.cachePolicy=e.cachePolicy),e.coveragePolicy&&(this.coveragePolicy=e.coveragePolicy),e.buffer!=null&&(this.buffer=e.buffer),e.cacheSize&&(this._tileCache=new Fge(e.cacheSize,this.tileInfoView,(r=>{this.releaseTile(r)})))}destroy(){this.tileIndex.clear()}update(e){const{resampling:r,tileIndex:i}=this,{scale:s,center:n,resolution:o}=e.state,{minScale:a,maxScale:l}=this.tileInfoView,u=!e.stationary&&s>this._previousScale;if(this._previousScale=s,!r&&(s>a||s<l))return this.tiles.length=0,void this.clear();const h=this.tileInfoView.getTileCoverage(e.state,this.buffer,this.resampling,this.coveragePolicy);if(!h)return this.tiles.length=0,void this.clear();const{spans:p,lodInfo:m}=h,{level:y}=m;this.tiles.length=0,i.forEach((b=>b.visible=!0));let g=0,v=0;if(p.length>0)for(const{row:b,colFrom:S,colTo:$}of p)for(let T=S;T<=$;T++){g++;const I=Pc.set(y,b,m.normalizeCol(T),m.getWorldForColumn(T)).id;let P=i.get(I);if(P)P.isReady?(Oa.set(I,P),v++):u||this._addParentTile(I,Oa);else{if(this._tileCache?.has(I)){if(P=this._tileCache.pop(I),this.tileIndex.set(I,P),P.isReady){Oa.set(I,P),v++;continue}}else P=this.acquireTile(Pc),this.tileIndex.set(I,P);u||this._addParentTile(I,Oa)}}const _=v===g;for(const[b,S]of i){if(Oa.has(b))continue;Pc.set(b);const $=this.tileInfoView.intersects(h,Pc),T=this.cachePolicy==="purge"?Pc.level!==y:Pc.level>y;!$||!u&&_?!T&&$||_y.push(S):S.isReady?T&&this.cachePolicy==="purge"&&this._hasReadyAncestor(Pc,y)?_y.push(S):u$.push(S):T&&_y.push(S)}for(const b of u$)b.isReady&&Oa.set(b.key.id,b);for(const b of _y)this._tileCache?this._tileCache.add(b):this.releaseTile(b),i.delete(b.key.id);for(const b of Oa.values())this.tiles.push(b);for(const b of i.values())Oa.has(b.key.id)||(b.visible=!1);this._tileCache?.prune(y,n,o),RA.pool.release(h),u$.length=0,_y.length=0,Oa.clear()}clear(){const{tileIndex:e}=this;for(const r of e.values())this.releaseTile(r);e.clear()}refresh(e){for(const r of this.tileIndex.values())e(r);this._tileCache?.clear()}updateCacheSize(e){this._tileCache&&(this._tileCache.maxSize=e)}_addParentTile(e,r){let i=e,s=null;for(;i=this.tileInfoView.getTileParentId(i),i;)if(this.tileIndex.has(i)){if(s=this.tileIndex.get(i),s?.isReady){r.has(s.key.id)||r.set(s.key.id,s);break}}else if(this._tileCache?.has(i)&&(s=this._tileCache.pop(i),this.tileIndex.set(i,s),s?.isReady)){r.has(s.key.id)||r.set(s.key.id,s);break}}_hasReadyAncestor(e,r){const i=nr();this.tileInfoView.getTileBounds(i,e,!0);for(const s of this.tileIndex.values())if(s.isReady&&s.key.level>=r&&s.key.level<e.level){const n=nr();if(this.tileInfoView.getTileBounds(n,s.key,!0),hne(n,i))return!0}return!1}},Dge=class{constructor(e,r={}){this.events=new Ca,this._hasMajorPerformanceCaveat=!1,this._lastRenderFrameCounter=0,e!=null?(this._canvas=document.createElement("canvas"),this._canvas.setAttribute("style","width: 100%; height:100%; display:block; willChange:transform"),e.contains(this._canvas)||e.appendChild(this._canvas)):r.canvas!=null&&(this._canvas=r.canvas);const i={failIfMajorPerformanceCaveat:!0,alpha:!0,antialias:!1,depth:!0,stencil:!0,powerPreference:"high-performance"};let s=this._canvas.getContext("webgl2",i);s||(s=this._canvas.getContext("webgl2",{...i,failIfMajorPerformanceCaveat:!1}),this._hasMajorPerformanceCaveat=!0),this._gl=s,this._handles=$d([Lm(this._canvas,"webglcontextlost",(n=>this.events.emit("webgl-context-lost",n)))])}destroy(){this._canvas.remove(),this._canvas=null,this._handles.remove(),this._gl=null}get gl(){return this._gl}get canvas(){return this._canvas}render(e,r){if(this._hasMajorPerformanceCaveat||z("esri-force-performance-mode")){if(++this._lastRenderFrameCounter>=z("esri-performance-mode-frames-between-render")&&(r(),this._lastRenderViewState=e.state.clone(),this._lastRenderFrameCounter=0),this._lastRenderViewState){const[i,s,n,o,a,l]=this._computeViewTransform(this._lastRenderViewState,e.state);this._canvas.style.transform=`matrix(${i}, ${s}, ${n}, ${o}, ${a}, ${l})`}}else r()}resize(e){const r=this._canvas,i=r.style,{state:{size:s},pixelRatio:n}=e,o=s[0],a=s[1],l=Math.round(o*n),u=Math.round(a*n);r.width===l&&r.height===u||(r.width=l,r.height=u),i.width=o+"px",i.height=a+"px"}_computeViewTransform(e,r){const[i,s]=e.center,[n,o]=r.center,[a,l]=e.toScreen([0,0],n,o),[u,h]=e.toScreen([0,0],i,s),p=u-a,m=h-l,y=e.scale/r.scale,g=r.rotation-e.rotation,v=wa();return Vv(v),jv(v,v,[y,y]),pc(v,v,Vm(g)),ba(v,v,[p,m]),v}};function zge(t,e,r,i,s){oB(t,e,r||0,i||t.length-1,s||Vge)}function oB(t,e,r,i,s){for(;i>r;){if(i-r>600){var n=i-r+1,o=e-r+1,a=Math.log(n),l=.5*Math.exp(2*a/3),u=.5*Math.sqrt(a*l*(n-l)/n)*(o-n/2<0?-1:1);oB(t,e,Math.max(r,Math.floor(e-o*l/n+u)),Math.min(i,Math.floor(e+(n-o)*l/n+u)),s)}var h=t[e],p=r,m=i;for(by(t,r,e),s(t[i],h)>0&&by(t,r,i);p<m;){for(by(t,p,m),p++,m--;s(t[p],h)<0;)p++;for(;s(t[m],h)>0;)m--}s(t[r],h)===0?by(t,r,m):by(t,++m,i),m<=e&&(r=m+1),e<=m&&(i=m-1)}}function by(t,e,r){var i=t[e];t[e]=t[r],t[r]=i}function Vge(t,e){return t<e?-1:t>e?1:0}function Qw(t,e){if(!(this instanceof Qw))return new Qw(t,e);this._maxEntries=Math.max(4,t||9),this._minEntries=Math.max(2,Math.ceil(.4*this._maxEntries)),e&&(typeof e=="function"?this.toBBox=e:this._initFormat(e)),this.clear()}function jge(t,e,r){if(!r)return e.indexOf(t);for(var i=0;i<e.length;i++)if(r(t,e[i]))return i;return-1}function Zd(t,e){wg(t,0,t.children.length,e,t)}function wg(t,e,r,i,s){s||(s=_p(null)),s.minX=1/0,s.minY=1/0,s.maxX=-1/0,s.maxY=-1/0;for(var n,o=e;o<r;o++)n=t.children[o],Sg(s,t.leaf?i(n):n);return s}function Sg(t,e){return t.minX=Math.min(t.minX,e.minX),t.minY=Math.min(t.minY,e.minY),t.maxX=Math.max(t.maxX,e.maxX),t.maxY=Math.max(t.maxY,e.maxY),t}function n5(t,e){return t.minX-e.minX}function o5(t,e){return t.minY-e.minY}function c$(t){return(t.maxX-t.minX)*(t.maxY-t.minY)}function P_(t){return t.maxX-t.minX+(t.maxY-t.minY)}function Uge(t,e){return(Math.max(e.maxX,t.maxX)-Math.min(e.minX,t.minX))*(Math.max(e.maxY,t.maxY)-Math.min(e.minY,t.minY))}function Gge(t,e){var r=Math.max(t.minX,e.minX),i=Math.max(t.minY,e.minY),s=Math.min(t.maxX,e.maxX),n=Math.min(t.maxY,e.maxY);return Math.max(0,s-r)*Math.max(0,n-i)}function h$(t,e){return t.minX<=e.minX&&t.minY<=e.minY&&e.maxX<=t.maxX&&e.maxY<=t.maxY}function A_(t,e){return e.minX<=t.maxX&&e.minY<=t.maxY&&e.maxX>=t.minX&&e.maxY>=t.minY}function _p(t){return{children:t,height:1,leaf:!0,minX:1/0,minY:1/0,maxX:-1/0,maxY:-1/0}}function a5(t,e,r,i,s){for(var n,o=[e,r];o.length;)(r=o.pop())-(e=o.pop())<=i||(n=e+Math.ceil((r-e)/i/2)*i,zge(t,n,e,r,s),o.push(e,n,n,r))}Qw.prototype={all:function(){return this._all(this.data,[])},search:function(t){var e=this.data,r=[],i=this.toBBox;if(!A_(t,e))return r;for(var s,n,o,a,l=[];e;){for(s=0,n=e.children.length;s<n;s++)o=e.children[s],A_(t,a=e.leaf?i(o):o)&&(e.leaf?r.push(o):h$(t,a)?this._all(o,r):l.push(o));e=l.pop()}return r},collides:function(t){var e=this.data,r=this.toBBox;if(!A_(t,e))return!1;for(var i,s,n,o,a=[];e;){for(i=0,s=e.children.length;i<s;i++)if(n=e.children[i],A_(t,o=e.leaf?r(n):n)){if(e.leaf||h$(t,o))return!0;a.push(n)}e=a.pop()}return!1},load:function(t){if(!t||!t.length)return this;if(t.length<this._minEntries){for(var e=0,r=t.length;e<r;e++)this.insert(t[e]);return this}var i=this._build(t.slice(),0,t.length-1,0);if(this.data.children.length)if(this.data.height===i.height)this._splitRoot(this.data,i);else{if(this.data.height<i.height){var s=this.data;this.data=i,i=s}this._insert(i,this.data.height-i.height-1,!0)}else this.data=i;return this},insert:function(t){return t!=null&&this._insert(t,this.data.height-1),this},clear:function(){return this.data=_p([]),this},remove:function(t,e){if(t==null)return this;for(var r,i,s,n,o=this.data,a=this.toBBox(t),l=[],u=[];o||l.length;){if(o||(o=l.pop(),i=l[l.length-1],r=u.pop(),n=!0),o.leaf&&(s=jge(t,o.children,e))!==-1)return o.children.splice(s,1),l.push(o),this._condense(l),this;n||o.leaf||!h$(o,a)?i?(r++,o=i.children[r],n=!1):o=null:(l.push(o),u.push(r),r=0,i=o,o=o.children[0])}return this},toBBox:function(t){return t},compareMinX:n5,compareMinY:o5,toJSON:function(){return this.data},fromJSON:function(t){return this.data=t,this},_all:function(t,e){for(var r=[];t;)t.leaf?e.push.apply(e,t.children):r.push.apply(r,t.children),t=r.pop();return e},_build:function(t,e,r,i){var s,n=r-e+1,o=this._maxEntries;if(n<=o)return Zd(s=_p(t.slice(e,r+1)),this.toBBox),s;i||(i=Math.ceil(Math.log(n)/Math.log(o)),o=Math.ceil(n/Math.pow(o,i-1))),(s=_p([])).leaf=!1,s.height=i;var a,l,u,h,p=Math.ceil(n/o),m=p*Math.ceil(Math.sqrt(o));for(a5(t,e,r,m,this.compareMinX),a=e;a<=r;a+=m)for(a5(t,a,u=Math.min(a+m-1,r),p,this.compareMinY),l=a;l<=u;l+=p)h=Math.min(l+p-1,u),s.children.push(this._build(t,l,h,i-1));return Zd(s,this.toBBox),s},_chooseSubtree:function(t,e,r,i){for(var s,n,o,a,l,u,h,p;i.push(e),!e.leaf&&i.length-1!==r;){for(h=p=1/0,s=0,n=e.children.length;s<n;s++)l=c$(o=e.children[s]),(u=Uge(t,o)-l)<p?(p=u,h=l<h?l:h,a=o):u===p&&l<h&&(h=l,a=o);e=a||e.children[0]}return e},_insert:function(t,e,r){var i=this.toBBox,s=r?t:i(t),n=[],o=this._chooseSubtree(s,this.data,e,n);for(o.children.push(t),Sg(o,s);e>=0&&n[e].children.length>this._maxEntries;)this._split(n,e),e--;this._adjustParentBBoxes(s,n,e)},_split:function(t,e){var r=t[e],i=r.children.length,s=this._minEntries;this._chooseSplitAxis(r,s,i);var n=this._chooseSplitIndex(r,s,i),o=_p(r.children.splice(n,r.children.length-n));o.height=r.height,o.leaf=r.leaf,Zd(r,this.toBBox),Zd(o,this.toBBox),e?t[e-1].children.push(o):this._splitRoot(r,o)},_splitRoot:function(t,e){this.data=_p([t,e]),this.data.height=t.height+1,this.data.leaf=!1,Zd(this.data,this.toBBox)},_chooseSplitIndex:function(t,e,r){var i,s,n,o,a,l,u,h;for(l=u=1/0,i=e;i<=r-e;i++)o=Gge(s=wg(t,0,i,this.toBBox),n=wg(t,i,r,this.toBBox)),a=c$(s)+c$(n),o<l?(l=o,h=i,u=a<u?a:u):o===l&&a<u&&(u=a,h=i);return h},_chooseSplitAxis:function(t,e,r){var i=t.leaf?this.compareMinX:n5,s=t.leaf?this.compareMinY:o5;this._allDistMargin(t,e,r,i)<this._allDistMargin(t,e,r,s)&&t.children.sort(i)},_allDistMargin:function(t,e,r,i){t.children.sort(i);var s,n,o=this.toBBox,a=wg(t,0,e,o),l=wg(t,r-e,r,o),u=P_(a)+P_(l);for(s=e;s<r-e;s++)n=t.children[s],Sg(a,t.leaf?o(n):n),u+=P_(a);for(s=r-e-1;s>=e;s--)n=t.children[s],Sg(l,t.leaf?o(n):n),u+=P_(l);return u},_adjustParentBBoxes:function(t,e,r){for(var i=r;i>=0;i--)Sg(e[i],t)},_condense:function(t){for(var e,r=t.length-1;r>=0;r--)t[r].children.length===0?r>0?(e=t[r-1].children).splice(e.indexOf(t[r]),1):this.clear():Zd(t[r],this.toBBox)},_initFormat:function(t){var e=["return a"," - b",";"];this.compareMinX=new Function("a","b",e.join(t[0])),this.compareMinY=new Function("a","b",e.join(t[1])),this.toBBox=new Function("a","return {minX: a"+t[0]+", minY: a"+t[1]+", maxX: a"+t[2]+", maxY: a"+t[3]+"};")}};function Bge(t,{timeZone:e,timeExtent:r}){return{$view:{scale:t,timeZone:e,timeProperties:{currentStart:r?.start,currentEnd:r?.end}}}}let l5=class aB{constructor(e,r){this.key=new qm(0,0,0,0),this.bounds=nr(),this.objectIds=new Set,this.key.set(r);const i=e.getLODInfoAt(this.key);this.tileInfoView=e,this.tileInfoView.getTileBounds(this.bounds,this.key,!0),this.resolution=i.resolution,this.level=i.level,this.scale=i.scale,this.minScale=e.zoomToScale(i.level-1),this.maxScale=e.zoomToScale(i.level+1)}get lod(){return this.tileInfoView.getLODInfoAt(this.key)}get id(){return this.key.id}get extent(){return lne(this.bounds,this.tileInfoView.tileInfo.spatialReference)}get transform(){return{originPosition:"upperLeft",scale:[this.resolution,this.resolution],translate:[this.bounds[0],this.bounds[3]]}}createArcadeEvaluationOptions(e){return Bge(this.scale,e)}createChildTiles(){const e=this.key.getChildKeys(),r=Fi.acquire();for(let i=0;i<e.length;i++)r[i]=new aB(this.tileInfoView,e[i]);return r}getQuantizationParameters(){return Au.fromJSON({mode:"view",originPosition:"upperLeft",tolerance:this.resolution,extent:{xmin:this.bounds[0],ymin:this.bounds[1],xmax:this.bounds[2],ymax:this.bounds[3],spatialReference:this.tileInfoView.tileInfo.spatialReference}})}};const Ac={added:[],removed:[]},d$=new Set,qge=new qm(0,0,0,0);function Hge(t,e){const r=Si(e);if(!r)return null;const[i,s]=r.valid;return t[2]>s?[nr([t[0],t[1],s,t[3]]),nr([i,t[1],i+t[2]-s,t[3]])]:t[0]<i?[nr([i,t[1],t[2],t[3]]),nr([s-(i-t[0]),t[1],s,t[3]])]:null}let Wge=class extends Ca{constructor(e){super(),this._tiles=new Map,this._index=Qw(9,z("esri-csp-restrictions")?r=>({minX:r.bounds[0],minY:r.bounds[1],maxX:r.bounds[2],maxY:r.bounds[3]}):[".bounds[0]",".bounds[1]",".bounds[2]",".bounds[3]"]),this.tiles=[],this.tileScheme=e}destroy(){this.clear()}clear(){this.tiles.length=0,this._tiles.clear(),this._index.clear()}has(e){return this._tiles.has(e)}get(e){return this._tiles.get(e)}getIntersectingTiles(e){if(!e||d2(e)===0||p2(e)===0)return[];const r=Hge(e,this.tileScheme.spatialReference);return r!=null?[...new Set([...this.boundsIntersections(r[0]),...this.boundsIntersections(r[1])])]:this.boundsIntersections(e)}boundsIntersections(e){return this._index.search({minX:e[0],minY:e[1],maxX:e[2],maxY:e[3]})}updateTiles(e){const r={added:[],removed:[]};for(const i of e.added)if(!this.has(i)){const s=new l5(this.tileScheme,i);this._tiles.set(i,s),this._index.insert(s),r.added.push(s)}for(const i of e.removed)if(this.has(i)){const s=this.get(i);this._tiles.delete(i),this._index.remove(s),r.removed.push(s)}this.tiles.length=0,this._tiles.forEach((i=>this.tiles.push(i))),(r.added.length||r.removed.length)&&this.emit("update",r)}setViewState(e){const r=this.tileScheme.getTileCoverage(e,0);if(!r)return;const{spans:i,lodInfo:s}=r,{level:n}=s;if(i.length>0)for(const{row:o,colFrom:a,colTo:l}of i)for(let u=a;u<=l;u++){const h=qge.set(n,o,s.normalizeCol(u),s.getWorldForColumn(u)).id;if(d$.add(h),!this.has(h)){const p=new l5(this.tileScheme,h);this._tiles.set(h,p),this._index.insert(p),this.tiles.push(p),Ac.added.push(p)}}for(let o=this.tiles.length-1;o>=0;o--){const a=this.tiles[o];d$.has(a.id)||(this._tiles.delete(a.id),this.tiles.splice(o,1),this._index.remove(a),Ac.removed.push(a))}(Ac.added.length||Ac.removed.length)&&this.emit("update",Ac),RA.pool.release(r),d$.clear(),Ac.added.length=0,Ac.removed.length=0}};const VFe=1e-30,Qp=512,L_=16777216,jFe=8,lB=29,uB=24,UFe=4,GFe=0,BFe=0,qFe=0,HFe=1,WFe=2,ZFe=3,JFe=4,YFe=5,XFe=6,KFe=12,QFe=13,eDe=5,Zge=6,tDe=5,rDe=6;var u5;(function(t){t[t.FilterFlags=0]="FilterFlags",t[t.Animation=1]="Animation",t[t.GPGPU=2]="GPGPU",t[t.VV=3]="VV",t[t.DD0=4]="DD0",t[t.DD1=5]="DD1",t[t.DD2=6]="DD2",t[t.LocalTimeOrigin=7]="LocalTimeOrigin"})(u5||(u5={}));const cB=6,Jge=1<<cB,iDe=Jge<<1,sDe=1.05,nDe=3,oDe=1,Yge=3,Xge=3,aDe=5,lDe=6,uDe=1.15,Kge=4,cDe=128,Qge=256,hDe=Qge-2*Kge,dDe=2,pDe=128,hB=1,fDe=10,e0e=1024,mDe=128,yDe=4,gDe=1,vDe=1<<20,_De=.75,bDe=10,wDe=.75,SDe=256,t0e=32,r0e=512,xDe=0,$De=1,i0e=1,MDe=[0,0,0,0,0,0,0,0,0,0,0,0,1,1,1,1],TDe=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1],wy=256;var c5,h5,d5,p5,f5,EI,m5,y5,Io,II,f0,Ot,eS,an,CI,pr,fe,tS,bm,ed,PI,W0,g5,v5,_5;(function(t){t[t.DEPTH=256]="DEPTH",t[t.STENCIL=1024]="STENCIL",t[t.COLOR=16384]="COLOR"})(c5||(c5={})),(function(t){t[t.COLOR=6144]="COLOR",t[t.DEPTH=6145]="DEPTH",t[t.STENCIL=6146]="STENCIL",t[t.DEPTH_STENCIL=34041]="DEPTH_STENCIL"})(h5||(h5={})),(function(t){t[t.POINTS=0]="POINTS",t[t.LINES=1]="LINES",t[t.LINE_LOOP=2]="LINE_LOOP",t[t.LINE_STRIP=3]="LINE_STRIP",t[t.TRIANGLES=4]="TRIANGLES",t[t.TRIANGLE_STRIP=5]="TRIANGLE_STRIP",t[t.TRIANGLE_FAN=6]="TRIANGLE_FAN"})(d5||(d5={})),(function(t){t[t.ZERO=0]="ZERO",t[t.ONE=1]="ONE",t[t.SRC_COLOR=768]="SRC_COLOR",t[t.ONE_MINUS_SRC_COLOR=769]="ONE_MINUS_SRC_COLOR",t[t.SRC_ALPHA=770]="SRC_ALPHA",t[t.ONE_MINUS_SRC_ALPHA=771]="ONE_MINUS_SRC_ALPHA",t[t.DST_ALPHA=772]="DST_ALPHA",t[t.ONE_MINUS_DST_ALPHA=773]="ONE_MINUS_DST_ALPHA",t[t.DST_COLOR=774]="DST_COLOR",t[t.ONE_MINUS_DST_COLOR=775]="ONE_MINUS_DST_COLOR",t[t.SRC_ALPHA_SATURATE=776]="SRC_ALPHA_SATURATE",t[t.CONSTANT_COLOR=32769]="CONSTANT_COLOR",t[t.ONE_MINUS_CONSTANT_COLOR=32770]="ONE_MINUS_CONSTANT_COLOR",t[t.CONSTANT_ALPHA=32771]="CONSTANT_ALPHA",t[t.ONE_MINUS_CONSTANT_ALPHA=32772]="ONE_MINUS_CONSTANT_ALPHA"})(p5||(p5={})),(function(t){t[t.ADD=32774]="ADD",t[t.MIN=32775]="MIN",t[t.MAX=32776]="MAX",t[t.SUBTRACT=32778]="SUBTRACT",t[t.REVERSE_SUBTRACT=32779]="REVERSE_SUBTRACT"})(f5||(f5={})),(function(t){t[t.ARRAY_BUFFER=34962]="ARRAY_BUFFER",t[t.ELEMENT_ARRAY_BUFFER=34963]="ELEMENT_ARRAY_BUFFER",t[t.UNIFORM_BUFFER=35345]="UNIFORM_BUFFER",t[t.PIXEL_PACK_BUFFER=35051]="PIXEL_PACK_BUFFER",t[t.PIXEL_UNPACK_BUFFER=35052]="PIXEL_UNPACK_BUFFER",t[t.COPY_READ_BUFFER=36662]="COPY_READ_BUFFER",t[t.COPY_WRITE_BUFFER=36663]="COPY_WRITE_BUFFER",t[t.TRANSFORM_FEEDBACK_BUFFER=35982]="TRANSFORM_FEEDBACK_BUFFER"})(EI||(EI={})),(function(t){t[t.FRONT=1028]="FRONT",t[t.BACK=1029]="BACK",t[t.FRONT_AND_BACK=1032]="FRONT_AND_BACK"})(m5||(m5={})),(function(t){t[t.CW=2304]="CW",t[t.CCW=2305]="CCW"})(y5||(y5={})),(function(t){t[t.BYTE=5120]="BYTE",t[t.UNSIGNED_BYTE=5121]="UNSIGNED_BYTE",t[t.SHORT=5122]="SHORT",t[t.UNSIGNED_SHORT=5123]="UNSIGNED_SHORT",t[t.INT=5124]="INT",t[t.UNSIGNED_INT=5125]="UNSIGNED_INT",t[t.FLOAT=5126]="FLOAT",t[t.HALF_FLOAT=5131]="HALF_FLOAT"})(Io||(Io={})),(function(t){t[t.NEVER=512]="NEVER",t[t.LESS=513]="LESS",t[t.EQUAL=514]="EQUAL",t[t.LEQUAL=515]="LEQUAL",t[t.GREATER=516]="GREATER",t[t.NOTEQUAL=517]="NOTEQUAL",t[t.GEQUAL=518]="GEQUAL",t[t.ALWAYS=519]="ALWAYS"})(II||(II={})),(function(t){t[t.ZERO=0]="ZERO",t[t.KEEP=7680]="KEEP",t[t.REPLACE=7681]="REPLACE",t[t.INCR=7682]="INCR",t[t.DECR=7683]="DECR",t[t.INVERT=5386]="INVERT",t[t.INCR_WRAP=34055]="INCR_WRAP",t[t.DECR_WRAP=34056]="DECR_WRAP"})(f0||(f0={})),(function(t){t[t.NEAREST=9728]="NEAREST",t[t.LINEAR=9729]="LINEAR",t[t.NEAREST_MIPMAP_NEAREST=9984]="NEAREST_MIPMAP_NEAREST",t[t.LINEAR_MIPMAP_NEAREST=9985]="LINEAR_MIPMAP_NEAREST",t[t.NEAREST_MIPMAP_LINEAR=9986]="NEAREST_MIPMAP_LINEAR",t[t.LINEAR_MIPMAP_LINEAR=9987]="LINEAR_MIPMAP_LINEAR"})(Ot||(Ot={})),(function(t){t[t.CLAMP_TO_EDGE=33071]="CLAMP_TO_EDGE",t[t.REPEAT=10497]="REPEAT",t[t.MIRRORED_REPEAT=33648]="MIRRORED_REPEAT"})(eS||(eS={})),(function(t){t[t.TEXTURE_2D=3553]="TEXTURE_2D",t[t.TEXTURE_CUBE_MAP=34067]="TEXTURE_CUBE_MAP",t[t.TEXTURE_3D=32879]="TEXTURE_3D",t[t.TEXTURE_CUBE_MAP_POSITIVE_X=34069]="TEXTURE_CUBE_MAP_POSITIVE_X",t[t.TEXTURE_CUBE_MAP_NEGATIVE_X=34070]="TEXTURE_CUBE_MAP_NEGATIVE_X",t[t.TEXTURE_CUBE_MAP_POSITIVE_Y=34071]="TEXTURE_CUBE_MAP_POSITIVE_Y",t[t.TEXTURE_CUBE_MAP_NEGATIVE_Y=34072]="TEXTURE_CUBE_MAP_NEGATIVE_Y",t[t.TEXTURE_CUBE_MAP_POSITIVE_Z=34073]="TEXTURE_CUBE_MAP_POSITIVE_Z",t[t.TEXTURE_CUBE_MAP_NEGATIVE_Z=34074]="TEXTURE_CUBE_MAP_NEGATIVE_Z",t[t.TEXTURE_2D_ARRAY=35866]="TEXTURE_2D_ARRAY"})(an||(an={})),(function(t){t[t.MIN_LOD=33082]="MIN_LOD",t[t.MAX_LOD=33083]="MAX_LOD",t[t.BASE_LEVEL=33084]="BASE_LEVEL",t[t.MAX_LEVEL=33085]="MAX_LEVEL",t[t.MAX_TEXTURE_SIZE=3379]="MAX_TEXTURE_SIZE"})(CI||(CI={})),(function(t){t[t.ALPHA=6406]="ALPHA",t[t.RGB=6407]="RGB",t[t.RGBA=6408]="RGBA",t[t.LUMINANCE=6409]="LUMINANCE",t[t.LUMINANCE_ALPHA=6410]="LUMINANCE_ALPHA",t[t.RED=6403]="RED",t[t.RG=33319]="RG",t[t.RED_INTEGER=36244]="RED_INTEGER",t[t.RG_INTEGER=33320]="RG_INTEGER",t[t.RGB_INTEGER=36248]="RGB_INTEGER",t[t.RGBA_INTEGER=36249]="RGBA_INTEGER"})(pr||(pr={})),(function(t){t[t.RGBA4=32854]="RGBA4",t[t.R16F=33325]="R16F",t[t.RG16F=33327]="RG16F",t[t.RGB32F=34837]="RGB32F",t[t.RGBA16F=34842]="RGBA16F",t[t.R32F=33326]="R32F",t[t.RG32F=33328]="RG32F",t[t.RGBA32F=34836]="RGBA32F",t[t.R11F_G11F_B10F=35898]="R11F_G11F_B10F",t[t.RGB8=32849]="RGB8",t[t.RGBA8=32856]="RGBA8",t[t.RGB5_A1=32855]="RGB5_A1",t[t.R8=33321]="R8",t[t.RG8=33323]="RG8",t[t.R8I=33329]="R8I",t[t.R8UI=33330]="R8UI",t[t.R16I=33331]="R16I",t[t.R16UI=33332]="R16UI",t[t.R32I=33333]="R32I",t[t.R32UI=33334]="R32UI",t[t.RG8I=33335]="RG8I",t[t.RG8UI=33336]="RG8UI",t[t.RG16I=33337]="RG16I",t[t.RG16UI=33338]="RG16UI",t[t.RG32I=33339]="RG32I",t[t.RG32UI=33340]="RG32UI",t[t.RGB16F=34843]="RGB16F",t[t.RGB9_E5=35901]="RGB9_E5",t[t.SRGB8=35905]="SRGB8",t[t.SRGB8_ALPHA8=35907]="SRGB8_ALPHA8",t[t.RGB565=36194]="RGB565",t[t.RGBA32UI=36208]="RGBA32UI",t[t.RGB32UI=36209]="RGB32UI",t[t.RGBA16UI=36214]="RGBA16UI",t[t.RGB16UI=36215]="RGB16UI",t[t.RGBA8UI=36220]="RGBA8UI",t[t.RGB8UI=36221]="RGB8UI",t[t.RGBA32I=36226]="RGBA32I",t[t.RGB32I=36227]="RGB32I",t[t.RGBA16I=36232]="RGBA16I",t[t.RGB16I=36233]="RGB16I",t[t.RGBA8I=36238]="RGBA8I",t[t.RGB8I=36239]="RGB8I",t[t.R8_SNORM=36756]="R8_SNORM",t[t.RG8_SNORM=36757]="RG8_SNORM",t[t.RGB8_SNORM=36758]="RGB8_SNORM",t[t.RGBA8_SNORM=36759]="RGBA8_SNORM",t[t.RGB10_A2=32857]="RGB10_A2",t[t.RGB10_A2UI=36975]="RGB10_A2UI"})(fe||(fe={})),(function(t){t[t.DEPTH_COMPONENT=6402]="DEPTH_COMPONENT",t[t.DEPTH_STENCIL=34041]="DEPTH_STENCIL"})(tS||(tS={})),(function(t){t[t.DEPTH24_STENCIL8=35056]="DEPTH24_STENCIL8",t[t.DEPTH32F_STENCIL8=36013]="DEPTH32F_STENCIL8"})(bm||(bm={})),(function(t){t[t.DEPTH_COMPONENT16=33189]="DEPTH_COMPONENT16",t[t.DEPTH_COMPONENT24=33190]="DEPTH_COMPONENT24",t[t.DEPTH_COMPONENT32F=36012]="DEPTH_COMPONENT32F"})(ed||(ed={})),(function(t){t[t.STENCIL_INDEX8=36168]="STENCIL_INDEX8"})(PI||(PI={})),(function(t){t[t.FLOAT=5126]="FLOAT",t[t.UNSIGNED_BYTE=5121]="UNSIGNED_BYTE",t[t.UNSIGNED_INT_24_8=34042]="UNSIGNED_INT_24_8",t[t.UNSIGNED_SHORT_4_4_4_4=32819]="UNSIGNED_SHORT_4_4_4_4",t[t.UNSIGNED_SHORT_5_5_5_1=32820]="UNSIGNED_SHORT_5_5_5_1",t[t.UNSIGNED_SHORT_5_6_5=33635]="UNSIGNED_SHORT_5_6_5",t[t.BYTE=5120]="BYTE",t[t.UNSIGNED_SHORT=5123]="UNSIGNED_SHORT",t[t.SHORT=5122]="SHORT",t[t.UNSIGNED_INT=5125]="UNSIGNED_INT",t[t.INT=5124]="INT",t[t.HALF_FLOAT=5131]="HALF_FLOAT",t[t.UNSIGNED_INT_2_10_10_10_REV=33640]="UNSIGNED_INT_2_10_10_10_REV",t[t.UNSIGNED_INT_10F_11F_11F_REV=35899]="UNSIGNED_INT_10F_11F_11F_REV",t[t.UNSIGNED_INT_5_9_9_9_REV=35902]="UNSIGNED_INT_5_9_9_9_REV",t[t.FLOAT_32_UNSIGNED_INT_24_8_REV=36269]="FLOAT_32_UNSIGNED_INT_24_8_REV"})(W0||(W0={})),(function(t){t[t.STATIC_DRAW=35044]="STATIC_DRAW",t[t.DYNAMIC_DRAW=35048]="DYNAMIC_DRAW",t[t.STREAM_DRAW=35040]="STREAM_DRAW",t[t.STATIC_READ=35045]="STATIC_READ",t[t.DYNAMIC_READ=35049]="DYNAMIC_READ",t[t.STREAM_READ=35041]="STREAM_READ",t[t.STATIC_COPY=35046]="STATIC_COPY",t[t.DYNAMIC_COPY=35050]="DYNAMIC_COPY",t[t.STREAM_COPY=35042]="STREAM_COPY"})(g5||(g5={})),(function(t){t[t.FRAGMENT_SHADER=35632]="FRAGMENT_SHADER",t[t.VERTEX_SHADER=35633]="VERTEX_SHADER"})(v5||(v5={})),(function(t){t[t.FRAMEBUFFER=36160]="FRAMEBUFFER",t[t.READ_FRAMEBUFFER=36008]="READ_FRAMEBUFFER",t[t.DRAW_FRAMEBUFFER=36009]="DRAW_FRAMEBUFFER"})(_5||(_5={}));const EDe=33984;var rS,b5;(function(t){t[t.Texture=0]="Texture",t[t.TileTexture=1]="TileTexture",t[t.BufferObject=2]="BufferObject",t[t.VertexArrayObject=3]="VertexArrayObject",t[t.Shader=4]="Shader",t[t.Program=5]="Program",t[t.FramebufferObject=6]="FramebufferObject",t[t.Renderbuffer=7]="Renderbuffer",t[t.TransformFeedback=8]="TransformFeedback",t[t.Sync=9]="Sync",t[t.UNCOUNTED=10]="UNCOUNTED",t[t.LinesOfCode=10]="LinesOfCode",t[t.Uniform=11]="Uniform",t[t.COUNT=12]="COUNT"})(rS||(rS={})),(function(t){t[t.NONE=0]="NONE",t[t.BACK=1029]="BACK"})(b5||(b5={}));const IDe=36064,CDe=36065,PDe=36066,ADe=33306,LDe=36096,RDe=36128;var jr,w5,S5,x5,$5,M5,T5,Lu,E5;(function(t){t[t.COMPRESSED_RGB_S3TC_DXT1_EXT=33776]="COMPRESSED_RGB_S3TC_DXT1_EXT",t[t.COMPRESSED_RGBA_S3TC_DXT1_EXT=33777]="COMPRESSED_RGBA_S3TC_DXT1_EXT",t[t.COMPRESSED_RGBA_S3TC_DXT3_EXT=33778]="COMPRESSED_RGBA_S3TC_DXT3_EXT",t[t.COMPRESSED_RGBA_S3TC_DXT5_EXT=33779]="COMPRESSED_RGBA_S3TC_DXT5_EXT",t[t.COMPRESSED_R11_EAC=37488]="COMPRESSED_R11_EAC",t[t.COMPRESSED_SIGNED_R11_EAC=37489]="COMPRESSED_SIGNED_R11_EAC",t[t.COMPRESSED_RG11_EAC=37490]="COMPRESSED_RG11_EAC",t[t.COMPRESSED_SIGNED_RG11_EAC=37491]="COMPRESSED_SIGNED_RG11_EAC",t[t.COMPRESSED_RGB8_ETC2=37492]="COMPRESSED_RGB8_ETC2",t[t.COMPRESSED_SRGB8_ETC2=37493]="COMPRESSED_SRGB8_ETC2",t[t.COMPRESSED_RGB8_PUNCHTHROUGH_ALPHA1_ETC2=37494]="COMPRESSED_RGB8_PUNCHTHROUGH_ALPHA1_ETC2",t[t.COMPRESSED_SRGB8_PUNCHTHROUGH_ALPHA1_ETC2=37495]="COMPRESSED_SRGB8_PUNCHTHROUGH_ALPHA1_ETC2",t[t.COMPRESSED_RGBA8_ETC2_EAC=37496]="COMPRESSED_RGBA8_ETC2_EAC",t[t.COMPRESSED_SRGB8_ALPHA8_ETC2_EAC=37497]="COMPRESSED_SRGB8_ALPHA8_ETC2_EAC"})(jr||(jr={})),(function(t){t[t.FLOAT=5126]="FLOAT",t[t.FLOAT_VEC2=35664]="FLOAT_VEC2",t[t.FLOAT_VEC3=35665]="FLOAT_VEC3",t[t.FLOAT_VEC4=35666]="FLOAT_VEC4",t[t.INT=5124]="INT",t[t.INT_VEC2=35667]="INT_VEC2",t[t.INT_VEC3=35668]="INT_VEC3",t[t.INT_VEC4=35669]="INT_VEC4",t[t.BOOL=35670]="BOOL",t[t.BOOL_VEC2=35671]="BOOL_VEC2",t[t.BOOL_VEC3=35672]="BOOL_VEC3",t[t.BOOL_VEC4=35673]="BOOL_VEC4",t[t.FLOAT_MAT2=35674]="FLOAT_MAT2",t[t.FLOAT_MAT3=35675]="FLOAT_MAT3",t[t.FLOAT_MAT4=35676]="FLOAT_MAT4",t[t.SAMPLER_2D=35678]="SAMPLER_2D",t[t.SAMPLER_CUBE=35680]="SAMPLER_CUBE",t[t.UNSIGNED_INT=5125]="UNSIGNED_INT",t[t.UNSIGNED_INT_VEC2=36294]="UNSIGNED_INT_VEC2",t[t.UNSIGNED_INT_VEC3=36295]="UNSIGNED_INT_VEC3",t[t.UNSIGNED_INT_VEC4=36296]="UNSIGNED_INT_VEC4",t[t.FLOAT_MAT2x3=35685]="FLOAT_MAT2x3",t[t.FLOAT_MAT2x4=35686]="FLOAT_MAT2x4",t[t.FLOAT_MAT3x2=35687]="FLOAT_MAT3x2",t[t.FLOAT_MAT3x4=35688]="FLOAT_MAT3x4",t[t.FLOAT_MAT4x2=35689]="FLOAT_MAT4x2",t[t.FLOAT_MAT4x3=35690]="FLOAT_MAT4x3",t[t.SAMPLER_3D=35679]="SAMPLER_3D",t[t.SAMPLER_2D_SHADOW=35682]="SAMPLER_2D_SHADOW",t[t.SAMPLER_2D_ARRAY=36289]="SAMPLER_2D_ARRAY",t[t.SAMPLER_2D_ARRAY_SHADOW=36292]="SAMPLER_2D_ARRAY_SHADOW",t[t.SAMPLER_CUBE_SHADOW=36293]="SAMPLER_CUBE_SHADOW",t[t.INT_SAMPLER_2D=36298]="INT_SAMPLER_2D",t[t.INT_SAMPLER_3D=36299]="INT_SAMPLER_3D",t[t.INT_SAMPLER_CUBE=36300]="INT_SAMPLER_CUBE",t[t.INT_SAMPLER_2D_ARRAY=36303]="INT_SAMPLER_2D_ARRAY",t[t.UNSIGNED_INT_SAMPLER_2D=36306]="UNSIGNED_INT_SAMPLER_2D",t[t.UNSIGNED_INT_SAMPLER_3D=36307]="UNSIGNED_INT_SAMPLER_3D",t[t.UNSIGNED_INT_SAMPLER_CUBE=36308]="UNSIGNED_INT_SAMPLER_CUBE",t[t.UNSIGNED_INT_SAMPLER_2D_ARRAY=36311]="UNSIGNED_INT_SAMPLER_2D_ARRAY"})(w5||(w5={})),(function(t){t[t.OBJECT_TYPE=37138]="OBJECT_TYPE",t[t.SYNC_CONDITION=37139]="SYNC_CONDITION",t[t.SYNC_STATUS=37140]="SYNC_STATUS",t[t.SYNC_FLAGS=37141]="SYNC_FLAGS"})(S5||(S5={})),(function(t){t[t.UNSIGNALED=37144]="UNSIGNALED",t[t.SIGNALED=37145]="SIGNALED"})(x5||(x5={})),(function(t){t[t.ALREADY_SIGNALED=37146]="ALREADY_SIGNALED",t[t.TIMEOUT_EXPIRED=37147]="TIMEOUT_EXPIRED",t[t.CONDITION_SATISFIED=37148]="CONDITION_SATISFIED",t[t.WAIT_FAILED=37149]="WAIT_FAILED"})($5||($5={})),(function(t){t[t.SYNC_GPU_COMMANDS_COMPLETE=37143]="SYNC_GPU_COMMANDS_COMPLETE"})(M5||(M5={})),(function(t){t[t.SYNC_FLUSH_COMMANDS_BIT=1]="SYNC_FLUSH_COMMANDS_BIT"})(T5||(T5={})),(function(t){t[t.INVALID_ENUM=1280]="INVALID_ENUM",t[t.INVALID_VALUE=1281]="INVALID_VALUE",t[t.INVALID_OPERATION=1282]="INVALID_OPERATION",t[t.OUT_OF_MEMORY=1285]="OUT_OF_MEMORY",t[t.INVALID_FRAMEBUFFER_OPERATION=1286]="INVALID_FRAMEBUFFER_OPERATION",t[t.CONTEXT_LOST_WEBGL=37442]="CONTEXT_LOST_WEBGL"})(Lu||(Lu={})),(function(t){t[t.COMPLETION_STATUS_KHR=37297]="COMPLETION_STATUS_KHR"})(E5||(E5={}));const s0e=()=>q.getLogger("esri.views.webgl.checkWebGLError");function n0e(t){switch(t){case Lu.INVALID_ENUM:return"Invalid Enum. An unacceptable value has been specified for an enumerated argument.";case Lu.INVALID_VALUE:return"Invalid Value. A numeric argument is out of range.";case Lu.INVALID_OPERATION:return"Invalid Operation. The specified command is not allowed for the current state.";case Lu.INVALID_FRAMEBUFFER_OPERATION:return"Invalid Framebuffer operation. The currently bound framebuffer is not framebuffer complete when trying to render to or to read from it.";case Lu.OUT_OF_MEMORY:return"Out of memory. Not enough memory is left to execute the command.";case Lu.CONTEXT_LOST_WEBGL:return"WebGL context has been lost";default:return"Unknown error"}}const dB=!!z("enable-feature:webgl-debug");function pB(){return dB}function kDe(){return dB}function Lc(t,e=pB()){if(e){const r=t.getError();if(r){const i=n0e(r),s=new Error().stack;s0e().error(new F("webgl-error","WebGL error occurred",{message:i,stack:s}))}}}var iS;(function(t){t[t.TextureDescriptor=0]="TextureDescriptor",t[t.Texture=1]="Texture",t[t.Renderbuffer=2]="Renderbuffer"})(iS||(iS={}));function o0e(t){switch(t){case Io.BYTE:case Io.UNSIGNED_BYTE:return 1;case Io.SHORT:case Io.UNSIGNED_SHORT:case Io.HALF_FLOAT:return 2;case Io.FLOAT:case Io.INT:case Io.UNSIGNED_INT:return 4}}function a0e(t){const e=t.gl;switch(e.getError()){case e.NO_ERROR:return null;case e.INVALID_ENUM:return"An unacceptable value has been specified for an enumerated argument";case e.INVALID_VALUE:return"An unacceptable value has been specified for an argument";case e.INVALID_OPERATION:return"The specified command is not allowed for the current state";case e.INVALID_FRAMEBUFFER_OPERATION:return"The currently bound framebuffer is not framebuffer complete";case e.OUT_OF_MEMORY:return"Not enough memory is left to execute the command";case e.CONTEXT_LOST_WEBGL:return"WebGL context is lost"}return"Unknown error"}function ODe(t,e,r,i,s=0){const n=t.gl;t.bindBuffer(r);for(const o of i){const a=e.get(o.name);if(a==null){console.warn(`There is no location for vertex attribute '${o.name}' defined.`);continue}const l=s*o.stride;if(o.count<=4)n.vertexAttribPointer(a,o.count,o.type,o.normalized,o.stride,o.offset+l),n.enableVertexAttribArray(a),o.divisor>0&&t.gl.vertexAttribDivisor(a,o.divisor);else if(o.count===9)for(let u=0;u<3;u++)n.vertexAttribPointer(a+u,3,o.type,o.normalized,o.stride,o.offset+12*u+l),n.enableVertexAttribArray(a+u),o.divisor>0&&t.gl.vertexAttribDivisor(a+u,o.divisor);else if(o.count===16)for(let u=0;u<4;u++)n.vertexAttribPointer(a+u,4,o.type,o.normalized,o.stride,o.offset+16*u+l),n.enableVertexAttribArray(a+u),o.divisor>0&&t.gl?.vertexAttribDivisor(a+u,o.divisor);else console.error("Unsupported vertex attribute element count: "+o.count);if(pB()){const u=a0e(t),h=o0e(o.type),p=o.offset,m=Math.round(h/p)!==h/p?`. Offset not a multiple of stride. DataType requires ${h} bytes, but descriptor has an offset of ${p}`:"";u&&console.error(`Unable to bind vertex attribute "${o.name}" with baseInstanceOffset ${l}${m}:`,u,o)}}}function NDe(t,e,r,i){const s=t.gl;t.bindBuffer(r);for(const n of i){const o=e.get(n.name);if(n.count<=4)s.disableVertexAttribArray(o),n.divisor&&n.divisor>0&&t.gl?.vertexAttribDivisor(o,0);else if(n.count===9)for(let a=0;a<3;a++)s.disableVertexAttribArray(o+a),n.divisor&&n.divisor>0&&t.gl?.vertexAttribDivisor(o+a,0);else if(n.count===16)for(let a=0;a<4;a++)s.disableVertexAttribArray(o+a),n.divisor&&n.divisor>0&&t.gl?.vertexAttribDivisor(o+a,0);else console.error("Unsupported vertex attribute element count: "+n.count)}t.unbindBuffer(EI.ARRAY_BUFFER)}function l0e(t){switch(t){case pr.ALPHA:case pr.LUMINANCE:case pr.RED:case pr.RED_INTEGER:case fe.R8:case fe.R8I:case fe.R8UI:case fe.R8_SNORM:case PI.STENCIL_INDEX8:return 1;case pr.LUMINANCE_ALPHA:case pr.RG:case pr.RG_INTEGER:case fe.RGBA4:case fe.R16F:case fe.R16I:case fe.R16UI:case fe.RG8:case fe.RG8I:case fe.RG8UI:case fe.RG8_SNORM:case fe.RGB565:case fe.RGB5_A1:case ed.DEPTH_COMPONENT16:return 2;case pr.RGB:case pr.RGB_INTEGER:case fe.RGB8:case fe.RGB8I:case fe.RGB8UI:case fe.RGB8_SNORM:case fe.SRGB8:case ed.DEPTH_COMPONENT24:return 3;case pr.RGBA:case pr.RGBA_INTEGER:case fe.RGBA8:case fe.R32F:case fe.R11F_G11F_B10F:case fe.RG16F:case fe.R32I:case fe.R32UI:case fe.RG16I:case fe.RG16UI:case fe.RGBA8I:case fe.RGBA8UI:case fe.RGBA8_SNORM:case fe.SRGB8_ALPHA8:case fe.RGB9_E5:case fe.RGB10_A2UI:case fe.RGB10_A2:case ed.DEPTH_COMPONENT32F:case bm.DEPTH24_STENCIL8:return 4;case bm.DEPTH32F_STENCIL8:return 5;case fe.RGB16F:case fe.RGB16I:case fe.RGB16UI:return 6;case fe.RG32F:case fe.RG32I:case fe.RG32UI:case fe.RGBA16F:case fe.RGBA16I:case fe.RGBA16UI:return 8;case fe.RGB32F:case fe.RGB32I:case fe.RGB32UI:return 12;case fe.RGBA32F:case fe.RGBA32I:case fe.RGBA32UI:return 16;case jr.COMPRESSED_RGB_S3TC_DXT1_EXT:case jr.COMPRESSED_RGBA_S3TC_DXT1_EXT:return .5;case jr.COMPRESSED_RGBA_S3TC_DXT3_EXT:case jr.COMPRESSED_RGBA_S3TC_DXT5_EXT:return 1;case jr.COMPRESSED_R11_EAC:case jr.COMPRESSED_SIGNED_R11_EAC:case jr.COMPRESSED_RGB8_ETC2:case jr.COMPRESSED_SRGB8_ETC2:case jr.COMPRESSED_RGB8_PUNCHTHROUGH_ALPHA1_ETC2:case jr.COMPRESSED_SRGB8_PUNCHTHROUGH_ALPHA1_ETC2:return .5;case jr.COMPRESSED_RG11_EAC:case jr.COMPRESSED_SIGNED_RG11_EAC:case jr.COMPRESSED_RGBA8_ETC2_EAC:case jr.COMPRESSED_SRGB8_ALPHA8_ETC2_EAC:return 1}return 0}let fB=class{constructor(e=0,r=e){this.width=e,this.height=r,this.type=iS.TextureDescriptor,this.target=an.TEXTURE_2D,this.pixelFormat=pr.RGBA,this.dataType=W0.UNSIGNED_BYTE,this.samplingMode=Ot.LINEAR,this.wrapMode=eS.REPEAT,this.maxAnisotropy=1,this.flipped=!1,this.hasMipmap=!1,this.isOpaque=!1,this.unpackAlignment=4,this.preMultiplyAlpha=!1,this.compareEnabled=!1,this.linearFilterDepth=!1,this.depth=1,this.isImmutable=!1}};function u0e(t){return t.width<=0||t.height<=0||t.depth<=0?0:Math.round(t.width*t.height*t.depth*(t.hasMipmap?4/3:1)*(t.internalFormat==null?4:l0e(t.internalFormat))*(t.target===an.TEXTURE_CUBE_MAP?6:1))}const Sy=()=>q.getLogger("esri/views/webgl/textureUtils");function xy(t){const{width:e,height:r,depth:i}=t;(e!=null&&e<0||r!=null&&r<0||i!=null&&i<0)&&Sy().error("Negative dimension parameters are not allowed!");const{internalFormat:s}=t;if(s&&(mB(s)||yB(s))){const{linearFilterDepth:n,compareEnabled:o,samplingMode:a,hasMipmap:l}=t;l&&Sy().error("Depth textures cannot have mipmaps"),n?a!==Ot.LINEAR&&a!==Ot.NEAREST&&Sy().error("Depth textures cannot sample mipmaps"):(a!==Ot.NEAREST&&Sy().error("Depth textures without filtering must use NEAREST filtering"),o&&Sy().error("Depth textures without filtering cannot use compare function"))}}function c0e(t){return t in fe}function mB(t){return t in ed}function yB(t){return t in bm}function h0e(t){return t!=null&&t in jr}function bp(t){return t!=null&&"type"in t&&t.type==="compressed"}function d0e(t){return t!=null&&"byteLength"in t}function I5(t){return t!=null&&!bp(t)&&!d0e(t)}function Jd(t){return t===an.TEXTURE_3D||t===an.TEXTURE_2D_ARRAY}function C5(t,e,r,i=1){let s=Math.max(e,r);return t===an.TEXTURE_3D&&(s=Math.max(s,i)),Math.floor(Math.log2(s))+1}function R_(t){if(t.internalFormat!=null)return t.internalFormat;switch(t.dataType){case W0.FLOAT:switch(t.pixelFormat){case pr.RGBA:return fe.RGBA32F;case pr.RGB:return fe.RGB32F;default:throw new F("texture:unknown-format","Unable to derive format")}case W0.UNSIGNED_BYTE:switch(t.pixelFormat){case pr.RGBA:return fe.RGBA8;case pr.RGB:return fe.RGB8}}const{pixelFormat:e}=t;return t.internalFormat=e===tS.DEPTH_STENCIL?bm.DEPTH24_STENCIL8:e===tS.DEPTH_COMPONENT?ed.DEPTH_COMPONENT24:e,t.internalFormat}function p0e(t){let e="width"in t?t.width:t.codedWidth,r="height"in t?t.height:t.codedHeight;return t instanceof HTMLVideoElement&&(e=t.videoWidth,r=t.videoHeight),{width:e,height:r,depth:1}}let f0e=class gB extends fB{constructor(e,r){switch(super(),this.context=e,Object.assign(this,r),this.internalFormat){case fe.R16F:case fe.R32F:case fe.R8_SNORM:case fe.R8:this.pixelFormat=pr.RED;break;case fe.R8I:case fe.R8UI:case fe.R16I:case fe.R16UI:case fe.R32I:case fe.R32UI:this.pixelFormat=pr.RED_INTEGER}}static validate(e,r){return new gB(e,r)}};const Na=()=>q.getLogger("esri/views/webgl/Texture");var gr;let m0e=(gr=class{constructor(e,r=null,i=null){if(this.type=iS.Texture,this._glName=null,this._samplingModeDirty=!1,this._wrapModeDirty=!1,this._shadowFilterDirty=!1,this._wasImmutablyAllocated=!1,"context"in e)this._descriptor=e,i=r;else{const s=f0e.validate(e,r);if(!s)throw new F("texture:invalid-descriptor","Texture descriptor invalid");this._descriptor=s}this._descriptor.target===an.TEXTURE_CUBE_MAP?this._setDataCubeMap(i):this.setData(i)}get glName(){return this._glName}get descriptor(){return this._descriptor}get usedMemory(){return u0e(this._descriptor)}get cachedMemory(){return this.usedMemory}get isDirty(){return this._samplingModeDirty||this._wrapModeDirty||this._shadowFilterDirty}get hasWebGLTextureObject(){return!!this._glName}dispose(){this.abortCompression(),this._descriptor.context.gl&&this.hasWebGLTextureObject&&(this._descriptor.context.instanceCounter.decrement(rS.Texture,this),this._descriptor.context.unbindTexture(this),this._descriptor.context.gl.deleteTexture(this._glName),this._glName=null)}release(){this.dispose()}resize(e,r){const i=this._descriptor;if(i.width!==e||i.height!==r){if(this._wasImmutablyAllocated)throw new F("texture:immutable-resize","Immutable textures can't be resized!");i.width=e,i.height=r,this._descriptor.target===an.TEXTURE_CUBE_MAP?this._setDataCubeMap(null):this.setData(null)}}enableCompression(e){this._descriptor.compress=e}disableCompression(){this._descriptor.compress=void 0}setData(e){this.abortCompression(),!bp(e)&&this._descriptor.internalFormat&&this._descriptor.internalFormat in jr&&(this._descriptor.internalFormat=void 0),this._setData(e),!bp(e)&&this._descriptor.compress&&this._compressOnWorker(e)}updateData(e,r,i,s,n,o,a=0){o||Na().error("An attempt to use uninitialized data!"),this.hasWebGLTextureObject||Na().error("An attempt to update uninitialized texture!");const l=this._descriptor;l.internalFormat=R_(l);const{context:u,pixelFormat:h,dataType:p,target:m,isImmutable:y}=l;if(y&&!this._wasImmutablyAllocated)throw new F("texture:uninitialized","Cannot update immutable texture before allocation!");const g=u.bindTexture(this,gr.TEXTURE_UNIT_FOR_UPDATES,!0);(r<0||i<0||r+s>l.width||i+n>l.height)&&Na().error("An attempt to update out of bounds of the texture!"),this._configurePixelStorage();const{gl:v}=u;a&&(s&&n||Na().warn("Must pass width and height if `UNPACK_SKIP_ROWS` is used"),v.pixelStorei(v.UNPACK_SKIP_ROWS,a)),I5(o)?v.texSubImage2D(m,e,r,i,s,n,h,p,o):bp(o)?v.compressedTexSubImage2D(m,e,r,i,s,n,l.internalFormat,o.levels[e]):v.texSubImage2D(m,e,r,i,s,n,h,p,o),a&&v.pixelStorei(v.UNPACK_SKIP_ROWS,0),u.bindTexture(g,gr.TEXTURE_UNIT_FOR_UPDATES)}updateData3D(e,r,i,s,n,o,a,l){l||Na().error("An attempt to use uninitialized data!"),this.hasWebGLTextureObject||Na().error("An attempt to update an uninitialized texture!");const u=this._descriptor;u.internalFormat=R_(u);const{context:h,pixelFormat:p,dataType:m,isImmutable:y,target:g}=u;if(y&&!this._wasImmutablyAllocated)throw new F("texture:uninitialized","Cannot update immutable texture before allocation!");Jd(g)||Na().warn("Attempting to set 3D texture data on a non-3D texture");const v=h.bindTexture(this,gr.TEXTURE_UNIT_FOR_UPDATES);h.setActiveTexture(gr.TEXTURE_UNIT_FOR_UPDATES),(r<0||i<0||s<0||r+n>u.width||i+o>u.height||s+a>u.depth)&&Na().error("An attempt to update out of bounds of the texture!"),this._configurePixelStorage();const{gl:_}=h;if(bp(l))l=l.levels[e],_.compressedTexSubImage3D(g,e,r,i,s,n,o,a,u.internalFormat,l);else{const b=l;_.texSubImage3D(g,e,r,i,s,n,o,a,p,m,b)}h.bindTexture(v,gr.TEXTURE_UNIT_FOR_UPDATES)}generateMipmap(){const e=this._descriptor;if(e.width===0||e.height===0)return;if(!e.hasMipmap){if(this._wasImmutablyAllocated)throw new F("texture:immutable-change","Cannot add mipmaps to immutable texture after allocation");e.hasMipmap=!0,this._samplingModeDirty=!0,xy(e)}e.samplingMode===Ot.LINEAR?(this._samplingModeDirty=!0,e.samplingMode=Ot.LINEAR_MIPMAP_NEAREST):e.samplingMode===Ot.NEAREST&&(this._samplingModeDirty=!0,e.samplingMode=Ot.NEAREST_MIPMAP_NEAREST);const r=this._descriptor.context.bindTexture(this,gr.TEXTURE_UNIT_FOR_UPDATES);this._descriptor.context.setActiveTexture(gr.TEXTURE_UNIT_FOR_UPDATES),this._descriptor.context.gl.generateMipmap(e.target),this._descriptor.context.bindTexture(r,gr.TEXTURE_UNIT_FOR_UPDATES)}clearMipmap(){const e=this._descriptor;if(e.hasMipmap){if(this._wasImmutablyAllocated)throw new F("texture:immutable-change","Cannot delete mipmaps to immutable texture after allocation");e.hasMipmap=!1,this._samplingModeDirty=!0,xy(e)}e.samplingMode===Ot.LINEAR_MIPMAP_NEAREST?(this._samplingModeDirty=!0,e.samplingMode=Ot.LINEAR):e.samplingMode===Ot.NEAREST_MIPMAP_NEAREST&&(this._samplingModeDirty=!0,e.samplingMode=Ot.NEAREST)}setSamplingMode(e){e!==this._descriptor.samplingMode&&(this._descriptor.samplingMode=e,this._samplingModeDirty=!0)}setWrapMode(e){e!==this._descriptor.wrapMode&&(this._descriptor.wrapMode=e,xy(this._descriptor),this._wrapModeDirty=!0)}setShadowFiltering(e){e!==this._descriptor.linearFilterDepth&&(this._descriptor.linearFilterDepth=this._descriptor.compareEnabled=e,this.setSamplingMode(e?Ot.LINEAR:Ot.NEAREST),xy(this._descriptor),this._shadowFilterDirty=!0)}applyChanges(){this._samplingModeDirty&&(this._applySamplingMode(),this._samplingModeDirty=!1),this._wrapModeDirty&&(this._applyWrapMode(),this._wrapModeDirty=!1),this._shadowFilterDirty&&(this._applyShadowMode(),this._shadowFilterDirty=!1)}abortCompression(){this._compressionAbortController=im(this._compressionAbortController)}_setData(e,r){const i=this._descriptor,s=i.context?.gl;if(!s)return;Lc(s),this.hasWebGLTextureObject||(this._glName=s.createTexture(),i.context.instanceCounter.increment(rS.Texture,this)),xy(i);const n=i.context.bindTexture(this,gr.TEXTURE_UNIT_FOR_UPDATES);i.context.setActiveTexture(gr.TEXTURE_UNIT_FOR_UPDATES),this._configurePixelStorage(),Lc(s);const o=r??i.target,a=Jd(o);if(I5(e))this._setDataFromTexImageSource(e,o);else{const{width:l,height:u,depth:h}=i;if(l==null||u==null)throw new F("texture:missing-size","Width and height must be specified!");if(a&&h==null)throw new F("texture:missing-depth","Depth must be specified!");if(i.internalFormat=R_(i),i.isImmutable&&!this._wasImmutablyAllocated&&this._texStorage(o,i.internalFormat,i.hasMipmap,l,u,h),bp(e)){if(!h0e(i.internalFormat))throw new F("texture:format-mismatch","Attempting to use compressed data with an uncompressed format!");this._setDataFromCompressedSource(e,i.internalFormat,o)}else this._texImage(o,0,i.internalFormat,l,u,h,e),Lc(s),i.hasMipmap&&this.generateMipmap()}this._applySamplingMode(),this._applyWrapMode(),this._applyAnisotropicFilteringParameters(),this._applyShadowMode(),Lc(s),i.context.bindTexture(n,gr.TEXTURE_UNIT_FOR_UPDATES)}_setDataCubeMap(e=null){for(let r=an.TEXTURE_CUBE_MAP_POSITIVE_X;r<=an.TEXTURE_CUBE_MAP_NEGATIVE_Z;r++)this._setData(e,r)}_configurePixelStorage(){const e=this._descriptor.context.gl,{unpackAlignment:r,flipped:i,preMultiplyAlpha:s}=this._descriptor;e.pixelStorei(e.UNPACK_ALIGNMENT,r),e.pixelStorei(e.UNPACK_FLIP_Y_WEBGL,i?1:0),e.pixelStorei(e.UNPACK_PREMULTIPLY_ALPHA_WEBGL,s?1:0)}_setDataFromTexImageSource(e,r){const{gl:i}=this._descriptor.context,s=this._descriptor;s.internalFormat=R_(s);const n=Jd(r),{width:o,height:a,depth:l}=p0e(e);s.width&&s.height,s.width||(s.width=o),s.height||(s.height=a),n&&s.depth,n&&(s.depth=l),s.isImmutable&&!this._wasImmutablyAllocated&&this._texStorage(r,s.internalFormat,s.hasMipmap,o,a,l),this._texImage(r,0,s.internalFormat,o,a,l,e),Lc(i),s.hasMipmap&&(this.generateMipmap(),Lc(i))}_setDataFromCompressedSource(e,r,i){const s=this._descriptor,{width:n,height:o,depth:a}=s,l=e.levels,u=C5(i,n,o,a),h=Math.min(u,l.length)-1;this._descriptor.context.gl.texParameteri(s.target,CI.MAX_LEVEL,h),this._forEachMipmapLevel(((p,m,y,g)=>{const v=l[Math.min(p,l.length-1)];this._compressedTexImage(i,p,r,m,y,g,v)}),h)}_texStorage(e,r,i,s,n,o){const{gl:a}=this._descriptor.context;if(!c0e(r)&&!mB(r)&&!yB(r))throw new F("texture:missing-format","Immutable textures must have a sized internal format");if(!this._descriptor.isImmutable)return;const l=i?C5(e,s,n,o):1;if(Jd(e)){if(o==null)throw new F("texture:missing-depth","Missing depth dimension for 3D texture upload");a.texStorage3D(e,l,r,s,n,o)}else a.texStorage2D(e,l,r,s,n);this._wasImmutablyAllocated=!0}_texImage(e,r,i,s,n,o,a){const l=this._descriptor.context.gl,u=Jd(e),{isImmutable:h,pixelFormat:p,dataType:m}=this._descriptor;if(h){if(a!=null){const y=a;if(u){if(o==null)throw new F("texture:missing-depth","Missing depth dimension for 3D texture upload");l.texSubImage3D(e,r,0,0,0,s,n,o,p,m,y)}else l.texSubImage2D(e,r,0,0,s,n,p,m,y)}}else{const y=a;if(u){if(o==null)throw new F("texture:missing-depth","Missing depth dimension for 3D texture upload");l.texImage3D(e,r,i,s,n,o,0,p,m,y)}else l.texImage2D(e,r,i,s,n,0,p,m,y)}}_compressedTexImage(e,r,i,s,n,o,a){const l=this._descriptor.context.gl,u=Jd(e);if(this._descriptor.isImmutable){if(a!=null)if(u){if(o==null)throw new F("texture:missing-depth","Missing depth dimension for 3D texture upload");l.compressedTexSubImage3D(e,r,0,0,0,s,n,o,i,a)}else l.compressedTexSubImage2D(e,r,0,0,s,n,i,a)}else if(u){if(o==null)throw new F("texture:missing-depth","Missing depth dimension for 3D texture upload");l.compressedTexImage3D(e,r,i,s,n,o,0,a)}else l.compressedTexImage2D(e,r,i,s,n,0,a)}async _compressOnWorker(e){const{width:r,height:i,context:s,flipped:n,preMultiplyAlpha:o,hasMipmap:a}=this._descriptor,l=this._descriptor.compress?.compressionTracker,u=this._descriptor.compress?.compressionCallback,{compressedTextureETC:h,compressedTextureS3TC:p}=s.capabilities;if(!gr.compressionWorkerHandle?.isCompressible(e,this._descriptor)||!h&&!p)return;this.abortCompression();const m=new AbortController;this._compressionAbortController=m,l?.increment();try{let y;e instanceof Uint8Array?y=e.buffer:(y=await createImageBitmap(e,{imageOrientation:n?"flipY":"none"}),xt(m));const g={data:y,width:r,height:i,needsFlip:e instanceof Uint8Array&&this.descriptor.flipped,components:this._descriptor.pixelFormat===pr.RGBA?4:3,preMultiplyAlpha:o,hasMipmap:a,hasETC:!!h,hasS3TC:!!p},v=await gr.compressionWorkerHandle.invoke(g,m.signal,"low");if(xt(m),v.compressedTexture&&this.hasWebGLTextureObject){const _=this.usedMemory;this._descriptor.internalFormat=v.internalFormat,this._setData(v.compressedTexture),u?.(_-this.usedMemory)}}catch(y){xi(y)||Na().error("Texture compression failed!")}finally{l?.decrement(),this._compressionAbortController?.signal.aborted&&(this._compressionAbortController=null)}}_forEachMipmapLevel(e,r=1/0){let{width:i,height:s,depth:n,hasMipmap:o,target:a}=this._descriptor;const l=a===an.TEXTURE_3D;if(i==null||s==null||l&&n==null)throw new F("texture:missing-size","Missing texture dimensions for mipmap calculation");for(let u=0;e(u,i,s,n),o&&(i!==1||s!==1||l&&n!==1)&&!(u>=r);++u)i=Math.max(1,i>>1),s=Math.max(1,s>>1),l&&(n=Math.max(1,n>>1))}_applySamplingMode(){const e=this._descriptor,r=e.context?.gl;let i=e.samplingMode,s=e.samplingMode;i===Ot.LINEAR_MIPMAP_NEAREST||i===Ot.LINEAR_MIPMAP_LINEAR?(i=Ot.LINEAR,e.hasMipmap||(s=Ot.LINEAR)):i!==Ot.NEAREST_MIPMAP_NEAREST&&i!==Ot.NEAREST_MIPMAP_LINEAR||(i=Ot.NEAREST,e.hasMipmap||(s=Ot.NEAREST)),r.texParameteri(e.target,r.TEXTURE_MAG_FILTER,i),r.texParameteri(e.target,r.TEXTURE_MIN_FILTER,s)}_applyWrapMode(){const e=this._descriptor,r=e.context?.gl;typeof e.wrapMode=="number"?(r.texParameteri(e.target,r.TEXTURE_WRAP_S,e.wrapMode),r.texParameteri(e.target,r.TEXTURE_WRAP_T,e.wrapMode)):(r.texParameteri(e.target,r.TEXTURE_WRAP_S,e.wrapMode.s),r.texParameteri(e.target,r.TEXTURE_WRAP_T,e.wrapMode.t))}_applyShadowMode(){const e=this._descriptor,r=e.context?.gl,i=e.compareEnabled?r.COMPARE_REF_TO_TEXTURE:r.NONE;r.texParameteri(e.target,r.TEXTURE_COMPARE_MODE,i),e.compareEnabled&&r.texParameteri(e.target,r.TEXTURE_COMPARE_FUNC,r.GREATER),Lc(r)}_applyAnisotropicFilteringParameters(){const e=this._descriptor,r=e.context.capabilities.textureFilterAnisotropic;r&&e.context.gl.texParameterf(e.target,r.TEXTURE_MAX_ANISOTROPY,e.maxAnisotropy??1)}},gr.TEXTURE_UNIT_FOR_UPDATES=0,gr.compressionWorkerHandle=null,gr);const p$=()=>q.getLogger("esri.views.2d.engine.webgl.painter.highlight.HighlightGradient");function y0e(t,e){e.fillColor[0]=t.color.r/255,e.fillColor[1]=t.color.g/255,e.fillColor[2]=t.color.b/255,e.fillColor[3]=t.color.a,t.haloColor?(e.outlineColor[0]=t.haloColor.r/255,e.outlineColor[1]=t.haloColor.g/255,e.outlineColor[2]=t.haloColor.b/255,e.outlineColor[3]=t.haloColor.a):(e.outlineColor[0]=e.fillColor[0],e.outlineColor[1]=e.fillColor[1],e.outlineColor[2]=e.fillColor[2],e.outlineColor[3]=e.fillColor[3]),e.fillColor[3]*=t.fillOpacity,e.outlineColor[3]*=t.haloOpacity,e.fillColor[0]*=e.fillColor[3],e.fillColor[1]*=e.fillColor[3],e.fillColor[2]*=e.fillColor[3],e.outlineColor[0]*=e.outlineColor[3],e.outlineColor[1]*=e.outlineColor[3],e.outlineColor[2]*=e.outlineColor[3],e.outlineWidth=(1-t.haloBlur)*t.haloWidth,e.outerHaloWidth=t.haloBlur*t.haloWidth/2,e.innerHaloWidth=t.haloBlur*t.haloWidth/2,e.outlinePosition=0}const g0e=[0,0,0,0];let vB=class{constructor(){this.type="single",this._highlightOptions=new ec,this._convertedHighlightOptions={fillColor:[0,0,0,0],outlineColor:[0,0,0,0],outlinePosition:0,outlineWidth:0,innerHaloWidth:0,outerHaloWidth:0},this._optionsShadeTexKey="",this._texelData=new Uint8Array(4*wy),this._minMaxDistance=[0,0]}setHighlightOptions(e){this._highlightOptions=e}applyHighlightOptions(e,r){this._updateGradientTexture(e),e.bindTexture(this._shadeTex,Zge),r.setUniform2fv("u_minMaxDistance",this._minMaxDistance)}destroy(){this._shadeTex?.dispose(),this._shadeTex=null}getReasonsWithGradients(){return[{activeReasons:(1<<cB)-1,activeGradient:this}]}_updateGradientTexture(e){const r=v0e(this._highlightOptions);if(r===this._optionsShadeTexKey)return;this._optionsShadeTexKey=r,y0e(this._highlightOptions,this._convertedHighlightOptions);const i=this._convertedHighlightOptions,s=i.outlinePosition-i.outlineWidth/2-i.outerHaloWidth,n=i.outlinePosition-i.outlineWidth/2,o=i.outlinePosition+i.outlineWidth/2,a=i.outlinePosition+i.outlineWidth/2+i.innerHaloWidth,l=Math.sqrt(Math.PI/2)*i0e,u=Math.abs(s)>l?Math.round(10*(Math.abs(s)-l))/10:0,h=Math.abs(a)>l?Math.round(10*(Math.abs(a)-l))/10:0;let p;u&&!h?p$().error("The outer rim of the highlight is "+u+"px away from the edge of the feature; consider reducing some width values or shifting the outline position towards positive values (inwards)."):!u&&h?p$().error("The inner rim of the highlight is "+h+"px away from the edge of the feature; consider reducing some width values or shifting the outline position towards negative values (outwards)."):u&&h&&p$().error("The highlight is "+Math.max(u,h)+"px away from the edge of the feature; consider reducing some width values.");const m=[void 0,void 0,void 0,void 0];function y(v,_,b){m[0]=(1-b)*v[0]+b*_[0],m[1]=(1-b)*v[1]+b*_[1],m[2]=(1-b)*v[2]+b*_[2],m[3]=(1-b)*v[3]+b*_[3]}const{_texelData:g}=this;for(let v=0;v<wy;++v)p=s+v/(wy-1)*(a-s),p<s?(m[0]=0,m[1]=0,m[2]=0,m[3]=0):p<n?y(g0e,i.outlineColor,(p-s)/(n-s)):p<o?[m[0],m[1],m[2],m[3]]=i.outlineColor:p<a?y(i.outlineColor,i.fillColor,(p-o)/(a-o)):[m[0],m[1],m[2],m[3]]=i.fillColor,g[4*v]=255*m[0],g[4*v+1]=255*m[1],g[4*v+2]=255*m[2],g[4*v+3]=255*m[3];if(this._minMaxDistance[0]=s,this._minMaxDistance[1]=a,!this._shadeTex){const v=new fB;v.wrapMode=eS.CLAMP_TO_EDGE,v.width=wy,v.height=1,this._shadeTex=new m0e(e,v)}this._shadeTex.updateData(0,0,0,wy,1,this._texelData)}};function v0e(t){return`${t.color};${t.haloColor};${t.haloOpacity};${t.fillOpacity};${t.haloWidth};${t.haloBlur}`}let _0e=class{constructor(){this.type="multi",this.gradients=[]}setHighlightOptions(e){for(let r=0;r<e.length;r++)this.gradients[r]||(this.gradients[r]=new vB),this.gradients[r].setHighlightOptions(e[r]);for(let r=e.length+1;r<this.gradients.length;r++)this.gradients[r].destroy();this.gradients.length=e.length}destroy(){for(const e of this.gradients)e.destroy()}getReasonsWithGradients(){let e=1;const r=[];for(let i=0;i<this.gradients.length;i++){const s=this.gradients[i];r.push({activeReasons:e,activeGradient:s}),e<<=1}return r}};var P5,A5,L5,R5,k5,O5,sS,N5,F5;(function(t){t[t.FILL=0]="FILL",t[t.LINE=1]="LINE",t[t.MARKER=2]="MARKER",t[t.TEXT=3]="TEXT",t[t.LABEL=4]="LABEL"})(P5||(P5={})),(function(t){t[t.NONE=0]="NONE",t[t.MAP=1]="MAP",t[t.LABEL=2]="LABEL",t[t.LABEL_ALPHA=4]="LABEL_ALPHA",t[t.HITTEST=8]="HITTEST",t[t.HIGHLIGHT=16]="HIGHLIGHT",t[t.CLIP=32]="CLIP",t[t.DEBUG=64]="DEBUG",t[t.NUM_DRAW_PHASES=9]="NUM_DRAW_PHASES"})(A5||(A5={})),(function(t){t[t.SIZE=0]="SIZE",t[t.COLOR=1]="COLOR",t[t.OPACITY=2]="OPACITY",t[t.ROTATION=3]="ROTATION"})(L5||(L5={})),(function(t){t[t.MINMAX_TARGETS_OUTLINE=128]="MINMAX_TARGETS_OUTLINE",t[t.SCALE_TARGETS_OUTLINE=256]="SCALE_TARGETS_OUTLINE",t[t.FIELD_TARGETS_OUTLINE=512]="FIELD_TARGETS_OUTLINE",t[t.UNIT_TARGETS_OUTLINE=1024]="UNIT_TARGETS_OUTLINE"})(R5||(R5={})),(function(t){t[t.SPRITE=0]="SPRITE",t[t.GLYPH=1]="GLYPH"})(k5||(k5={})),(function(t){t[t.DEFAULT=0]="DEFAULT",t[t.SIMPLE=1]="SIMPLE",t[t.DOT_DENSITY=2]="DOT_DENSITY",t[t.OUTLINE_FILL=3]="OUTLINE_FILL",t[t.OUTLINE_FILL_SIMPLE=4]="OUTLINE_FILL_SIMPLE",t[t.HEATMAP=5]="HEATMAP",t[t.PIE_CHART=6]="PIE_CHART"})(O5||(O5={})),(function(t){t[t.All=0]="All",t[t.Highlight=1]="Highlight",t[t.InsideEffect=2]="InsideEffect",t[t.OutsideEffect=3]="OutsideEffect"})(sS||(sS={})),(function(t){t[t.BATCHING=0]="BATCHING",t[t.STRICT_ORDER=1]="STRICT_ORDER",t[t.STRICT_MARKERS_AND_TEXT=2]="STRICT_MARKERS_AND_TEXT"})(N5||(N5={})),(function(t){t[t.FILL=0]="FILL",t[t.LINE=1]="LINE",t[t.MARKER=2]="MARKER",t[t.TEXT=3]="TEXT"})(F5||(F5={}));const _B={color:{write:[!0,!0,!0,!0],blendMode:"composite"},depth:!1,stencil:{write:!1,test:{ref:t=>t.stencilRef,compare:II.EQUAL,mask:255,op:{fail:f0.KEEP,zFail:f0.KEEP,zPass:f0.REPLACE}}}},b0e={color:{write:[!0,!0,!0,!0],blendMode:"additive"},depth:!1,stencil:!1},w0e={..._B,color:{write:[!0,!0,!0,!0],blendMode:"delete"}};function S0e({pixelRatio:t,state:e,displayLevel:r,requiredLevel:i},s){const n=1/2**(r-s.key.level),o=1/2**(i-s.key.level);return{displayMat3:e.displayMat3,displayViewMat3:e.displayViewMat3,displayViewScreenMat3:s.transforms.displayViewScreenMat3,viewMat3:e.viewMat3,tileMat3:s.transforms.tileMat3,displayZoomFactor:n,requiredZoomFactor:o,tileOffset:[s.x,s.y],currentScale:e.scale,currentZoom:r,metersPerSRUnit:vn(e.spatialReference),rotation:e.rotation,pixelRatio:t}}function bB(t){return t.passOptions?.type==="highlight"}function wB(t){return t.passOptions?.type==="hittest"}function x0e(t){if(!wB(t))return null;const{position:e,distance:r,smallSymbolDistance:i,smallSymbolSizeThreshold:s}=t.passOptions;return{position:e,distance:r,smallSymbolDistance:i,smallSymbolSizeThreshold:s}}function $0e(t){if(!bB(t))return null;const{activeReasons:e,highlightAll:r}=t.passOptions;return{activeReasons:e,highlightAll:r?1:0}}function VDe(t,e,r){const i={};for(const s in r)typeof r[s]!="function"?i[s]=r[s]:i[s]=r[s](t,e);return i}function jDe(t,e){const{attributeView:r,context:i}=t;return{storage:r.getUniforms(i),view:S0e(t,e),hittestRequest:x0e(t),highlight:$0e(t)}}function UDe(t){return{inside:t.selection===sS.InsideEffect,outside:t.selection===sS.OutsideEffect}}function M0e(t){return wB(t)?b0e:bB(t)&&t.passOptions.stepType==="clear"?w0e:_B}function GDe(t){const{row:e,col:r}=t.key,i=r*Qp,s=e*Qp;return{tileOffsetFromLocalOrigin:[i%L_,s%L_],maxIntsToLocalOrigin:[Math.floor(i/L_),Math.floor(s/L_)]}}const T0e=new De({esriGeometryPoint:"point",esriGeometryMultipoint:"multipoint",esriGeometryPolyline:"polyline",esriGeometryPolygon:"polygon",esriGeometryMultiPatch:"multipatch",mesh:"mesh"});function BDe(t){return T0e.toJSON(t)}function qDe(t){const{bandCount:e,attributeTable:r,colormap:i,pixelType:s}=t.raster.rasterInfo;return e===1&&(r!=null||i!=null||s==="u8"||s==="s8")}function E0e(t,e){return e==null?(t?.destroy(),null):(t?.type==="single"&&Array.isArray(e)&&(t.destroy(),t=null),t?.type!=="multi"||Array.isArray(e)||(t.destroy(),t=null),t||(t=Array.isArray(e)?new _0e:new vB),Array.isArray(e)?t.type==="multi"&&t.setHighlightOptions(e):t.type==="single"&&t.setHighlightOptions(e),t)}function HDe(t,e,r,i){const{painter:s,highlightGradient:n}=t,{highlight:o}=s.effects;if(!n)return;const a=t.passOptions,l=n.getReasonsWithGradients();for(let u=0;u<l.length;u++){const h={...t,passOptions:{type:"highlight",activeGradient:l[u].activeGradient,activeReasons:l[u].activeReasons,stepType:"burn",highlightAll:e}};if(o.bind(h),r(h),u<l.length-1){let m=0;for(let y=u+1;y<l.length;y++)m|=l[y].activeReasons;r({...t,passOptions:{type:"highlight",activeGradient:l[u].activeGradient,activeReasons:m,stepType:"clear",highlightAll:e}})}const p={...t,passOptions:{type:"highlight",activeGradient:l[u].activeGradient,activeReasons:l[u].activeReasons,stepType:"draw",highlightAll:e}};s.setPipelineState(M0e(t)),s.updatePipelineState(t.context),o.draw(p),o.unbind()}t.passOptions=a}const k_=t=>parseFloat(t)/100;function I0e(t,e,r){const i=typeof t.left=="string"?k_(t.left)*e:t.left,s=typeof t.right=="string"?k_(t.right)*e:t.right,n=typeof t.top=="string"?k_(t.top)*r:t.top,o=typeof t.bottom=="string"?k_(t.bottom)*r:t.bottom,a=n;return{xmin:i,xmax:Math.max(e-s,i),ymin:a,ymax:Math.max(r-o,n)}}function SB(t,e,r,i){switch(e.type){case"rect":{const{width:s,height:n}=t,{xmin:o,xmax:a,ymin:l,ymax:u}=I0e(e,s,n),{x:h,y:p}=r;return h>o&&h<a&&p>l&&p<u}case"path":return e.path.length===0||!Array.isArray(e.path[0][0])||x3(e.path,[r.x,r.y]);case"geometry":return e.geometry==null||(e.geometry.type==="polygon"?S3(e.geometry,i):xv(e.geometry,i))}}function C0e(t){if(!t.highlights)return null;const e=t.highlights.findIndex((r=>r.name==="default"));return e===-1?null:t.highlights.items[e]}function P0e(t,e){if(!t.highlights){if(!e)return;t.highlights=new se([new ec])}const r=t.highlights.findIndex((i=>i.name==="default"));e?t.highlights.items[r].assignFrom(e):(t.highlights.removeAt(r),t.highlights.length===0&&(t.highlights=null))}async function A0e(t,e,r){const i=WG(e)?HG(t,e):e;if(!t.ready||isNaN(i.x)||isNaN(i.y))return{screenPoint:i,results:[]};let s=new Set;const n=new Set;let o=!1,a=null,l=null;r?.include?z5(r.include,D5(t,(m=>{s.add(m),f$(m,(y=>n.add(y)))}),((m,y)=>{n.add(m),s.add(y)}),(m=>{a||(a=new Set),a.add(m)}),(m=>s.add(m)),(()=>o=!0))):(o=!0,s=new Set(t.allLayerViews),s.forEach((m=>{f$(m,(y=>n.add(y)))}))),r?.exclude&&z5(r.exclude,D5(t,(m=>{s.delete(m),f$(m,(y=>n.delete(y)))}),(m=>n.delete(m)),(m=>{l||(l=new Set),l.add(m)})));const u=t.toMap(i),h=t.allLayerViews.filter((m=>!m.suspended&&s.has(m)&&m.clips.every((y=>SB(t,y,i,u))))).reverse();let p=[...o?t.graphicsView.hitTest(u).map((m=>({type:"graphic",graphic:m,layer:null,mapPoint:u}))):[],...await Promise.all(h.map((m=>m.hitTest(u,i))).toArray())].filter(ii).flat().filter(ii);return p=p.filter((m=>m.type!=="graphic"||m.layer?.type!=="subtype-group"||n.has(m.graphic.layer))),a&&(p=p.filter((m=>!("graphic"in m)||!m.graphic||a?.has(AI(m.graphic))))),l&&(p=p.filter((m=>!("graphic"in m)||!m.graphic||!l?.has(AI(m.graphic))))),{screenPoint:i,results:p}}function D5(t,e,r,i,s,n){return o=>{if(o instanceof dr){if(o.layer===t)n?.();else{const a=t.allLayerViews.find((l=>l.layer===o.layer));a&&s?.(a)}i(AI(o))}else if(!("layer"in o&&"element"in o))if(o.type==="subtype-sublayer"){const a=t.allLayerViews.find((l=>l.layer===o.parent));a&&r(o,a)}else{const a=t.allLayerViews.find((l=>l.layer===o));a&&e(a)}}}function z5(t,e){if(t)if(Jb(t))for(const r of t)if(Jb(r))for(const i of r)e(i);else e(r);else e(t)}function AI(t){const e=t.getObjectId();return e?`${t.layer?.uid??t.sourceLayer?.uid??"MapView"}/${e}`:`"MapView/${t.uid}`}function f$({layer:t},e){t?.type==="subtype-group"&&t.sublayers.forEach((r=>{e(r)}))}let $y=null,nS=!0;function L0e(t,e,r){if(!t||!e)throw new Error("Cannot construct image data without dimensions");if(nS)try{return new ImageData(t,e)}catch{nS=!1}return xB(t,e,r)}function WDe(t,e,r,i){if(!e||!r)throw new Error("Cannot construct image data without dimensions");if(nS)try{return new ImageData(t,e,r)}catch{nS=!1}const s=xB(e,r,i);return s.data.set(t,0),s}function R0e(){return $y||($y=document.createElement("canvas"),$y.width=1,$y.height=1),$y}function xB(t,e,r){return r||(r=R0e()),r.getContext("2d").createImageData(t,e)}async function k0e(t,e){const r=window.URL.createObjectURL(t);try{const{data:i}=await et(r,{...e,responseType:"image"});return i}catch(i){throw xi(i)?i:new F("invalid-image",`Could not fetch requested image at ${r}`)}finally{window.URL.revokeObjectURL(r)}}async function O0e(t,e){const{arrayBuffer:r,mediaType:i}=await N0e(t,e),s=i==="image/png";if(i==="image/gif"){const{isAnimatedGIF:n,parseGif:o}=await J(()=>import("./gif-tPTWV_wG.js"),[]);if(n(r))return o(r,e)}if(s){const{isAnimatedPNG:n,parseApng:o}=await J(()=>import("./apng-BxXEKkq7.js"),__vite__mapDeps([247,13]));if(n(r))return o(r,e)}return k0e(new Blob([r],{type:i}),e)}async function N0e(t,e){const r=rm(t);if(r?.isBase64)return{arrayBuffer:vz(r.data),mediaType:r.mediaType};const i=await et(t,{responseType:"array-buffer",...e});return{arrayBuffer:i.data,mediaType:i.getHeader?.("Content-Type")??""}}function $B(t,e,r){const{ctx:i,canvas:s}=TB(t,r),n=i.getImageData(0,0,t.width,t.height),o=IB(s,e);return EB(s),{dataUrl:o,data:n}}function MB(t,e){const{ctx:r,canvas:i}=TB(t,e),s=r.getImageData(0,0,t.width,t.height);return EB(i),s}function TB(t,e){const r=F0e();e.premultipliedAlpha&&j0e(t),r.width=t.width,r.height=t.height;const i=r.getContext("2d",{willReadFrequently:!0});return i.putImageData(t,0,0),e.flipY&&V0e(i),{ctx:i,canvas:r}}function EB(t){t.width=0,t.height=0}function F0e(){return m$==null&&(m$=document.createElement("canvas")),m$}let m$=null;function IB(t,e){const r=U0e[e.format],i=e.quality/100;return t.toDataURL(r,i)}function CB(t,e){const r=z0e(t),i=B0e[r];return{format:r,quality:$i(e??i,0,100)}}function PB(t,e){return e/Math.max(t[0],t[1])}function D0e(t,e,r,i=0,s=0,n=t.width-i,o=t.height-s,a=!1){const{data:l}=t,{width:u,height:h,data:p}=e,m=n/u,y=o/h,g=Math.ceil(m/2),v=Math.ceil(y/2),_=t.width;for(let b=0;b<h;b++)for(let S=0;S<u;S++){const $=4*(S+(a?h-b-1:b)*u);let T=0,I=0,P=0,R=0,D=0,V=0;const U=(b+.5)*y;for(let Z=Math.floor(b*y);Z<(b+1)*y;Z++){const X=Math.abs(U-(Z+.5))/v,le=(S+.5)*m,ee=X*X;for(let ke=Math.floor(S*m);ke<(S+1)*m;ke++){const Ze=Math.abs(le-(ke+.5))/g,it=Math.sqrt(ee+Ze*Ze);if(it>=1)continue;let ze=2*it*it*it-3*it*it+1;const zt=4*(i+ke+(s+Z)*_);V+=ze*l[zt+3],I+=ze,!r&&l[zt+3]<255&&(ze=ze*l[zt+3]/255),P+=ze*l[zt],R+=ze*l[zt+1],D+=ze*l[zt+2],T+=ze}}p[$]=P/T,p[$+1]=R/T,p[$+2]=D/T,p[$+3]=V/I}return e}function z0e(t){switch(t){case"png":case"jpg":case"jpeg":return t;default:return G0e}}function V0e(t){t.save(),t.globalCompositeOperation="copy",t.scale(1,-1),t.translate(0,-t.canvas.height),t.drawImage(t.canvas,0,0),t.restore()}function j0e(t){const e=t.data,r=e.length;for(let i=0;i<r;i+=4){const s=e[i+3];if(s!==255&&s>0){const n=255/s;e[i]=e[i]*n,e[i+1]=e[i+1]*n,e[i+2]=e[i+2]*n}}}const U0e={png:"image/png",jpg:"image/jpeg",jpeg:"image/jpeg"},V5=98,G0e="png",B0e={png:100,jpg:V5,jpeg:V5},ZDe=Object.freeze(Object.defineProperty({__proto__:null,createEmptyImageData:L0e,encode:$B,encodeData:MB,getFormatAndQuality:CB,getMaximumResolutionScale:PB,resampleHermite:D0e,toDataUrl:IB},Symbol.toStringTag,{value:"Module"})),AB={flipY:!0,premultipliedAlpha:!0};async function q0e(t,e){const r=await LB(t,e),{format:i,quality:s}=CB(e?.format,e?.quality);return $B(r,{format:i,quality:s},AB)}async function H0e(t,e){const r=await LB(t,e);return MB(r,AB)}function LB(t,e){const r=J0e(e||{},Z0e(t.stage,t.size),t.size,t.padding),i=W0e(e,t.allLayerViews);return t.stage.takeScreenshot(r,i,t.backgroundColor,e?.rotation)}function W0e(t={},e){if(!t.layers)return;const r=[];return t.layers.forEach((i=>{const s=e.find((n=>n.layer.id===i.id));s?.container&&r.push(s.container)})),r}function Z0e(t,e){return Math.min(4,PB(e,Math.min(4096,t.context.parameters.maxTextureSize)))}function J0e(t,e,r,i){t.ignorePadding&&(i={left:0,right:0,top:0,bottom:0});let s=null;t.width!=null&&t.height!=null?s=[t.width,t.height]:t.width==null&&t.height!=null?s=[t.height,t.height]:t.width!=null&&t.height==null?s=[t.width,t.width]:t.width==null&&t.height==null&&(s=null);const n=r[0]-(i.left+i.right),o=r[1]-(i.top+i.bottom);let a,l,u=t.area||{x:0,y:0,width:n,height:o};if(s){const h=n/o,p=s[0]/s[1];if(p>h){const m=u.width/p;u={x:u.x,y:Math.round(u.y+(u.height-m)/2),width:u.width,height:Math.round(m)}}else{const m=u.height*p;u={x:Math.round(u.x+(u.width-m)/2),y:u.y,width:Math.round(m),height:u.height}}}else s=[u.width,u.height];return s[0]>u.width?(a=Math.min(s[0]/u.width,e),l=s[0]/u.width/a):(a=1,l=s[0]/u.width),{cropArea:{x:Math.round((u.x+i.left)*a),y:Math.round((u.y+i.top)*a),width:Math.round(u.width*a),height:Math.round(u.height*a)},outputScale:l,resolutionScale:a}}const Y0e=t=>t.includes("Brush");let RB=class{constructor(){this._names=new Map}begin(e){this._names.has(e)||(this._names.set(e,!1),Y0e(e)&&this.record("Esri.FirstDraw"),performance.mark(`Esri.${e}.Start`))}end(e){this._names.has(e)&&!this._names.get(e)&&(this._names.set(e,!0),performance.mark(`Esri.${e}.End`))}record(e){this._names.has(e)||(this._names.set(e,!0),performance.mark(`Esri.${e}`))}},X0e=class{constructor(e){this.getUnmaskedRenderer=e}};function K0e(t){const e=t.getExtension("WEBGL_debug_renderer_info");return e?new X0e((()=>t.getParameter(e.UNMASKED_RENDERER_WEBGL))):null}let j5;function Q0e(){return j5??=rve(),j5}let eve=class{constructor(){this.available=!1,this.majorPerformanceCaveat=!1,this.maxTextureSize=0,this.supportsVertexShaderSamplers=!1,this.supportsHighPrecisionFragment=!1,this.supportsColorBufferFloat=!1,this.supportsColorBufferFloatBlend=!1,this.supportsColorBufferHalfFloat=!1,this.unmaskedRenderer="unloaded"}};function tve(t){if(typeof WebGL2RenderingContext>"u")return null;const e=document.createElement("canvas");if(!e)return null;let r=e.getContext("webgl2",{failIfMajorPerformanceCaveat:!0});if(r==null&&(r=e.getContext("webgl2"),r!=null&&(t.majorPerformanceCaveat=!0,t.unmaskedRenderer=K0e(r)?.getUnmaskedRenderer()??"unknown")),r==null)return r;t.available=!0,t.maxTextureSize=r.getParameter(r.MAX_TEXTURE_SIZE),t.supportsVertexShaderSamplers=r.getParameter(r.MAX_VERTEX_TEXTURE_IMAGE_UNITS)>0;const i=r.getShaderPrecisionFormat(r.FRAGMENT_SHADER,r.HIGH_FLOAT);return i&&(t.supportsHighPrecisionFragment=i.precision>0),r}function rve(){const t=new eve,e=tve(t);return e==null||(t.supportsColorBufferFloat=e.getExtension("EXT_color_buffer_float")!==null,t.supportsColorBufferFloatBlend=e.getExtension("EXT_float_blend")!==null,t.supportsColorBufferHalfFloat=t.supportsColorBufferFloat||e.getExtension("EXT_color_buffer_half_float")!==null),t}function ive(t){const e=Q0e();return e.available?t==="3d"&&e.majorPerformanceCaveat?new F("webgl:major-performance-caveat-detected",`Your WebGL implementation (${e.unmaskedRenderer}) doesn't seem to support hardware accelerated rendering. Check your browser settings or if your GPU is in a blocklist.`):e.supportsHighPrecisionFragment?e.supportsVertexShaderSamplers?null:new F("webgl:vertex-shader-samplers-required","WebGL support for vertex shader samplers is required but not supported."):new F("webgl:high-precision-fragment-required","WebGL support for high precision fragment shaders is required but not supported."):new F("webgl:required","WebGL2 is required but not supported.",new Error().stack)}function sve(t){return t&&"nodeType"in t}function nve(t){return t&&typeof t.render=="function"}const U5={component:"esri-component"};let rh=class extends ce{constructor(){super(...arguments),this.widget=null}destroy(){this.node=null,this.widget?.destroy()}get id(){return this._get("id")??this.widget?.id??this.node?.id}set id(e){this._set("id",e)}set node(e){const r=this._get("node");e!==r&&(e&&e.classList.add(U5.component),r&&r.classList.remove(U5.component),this._set("node",e))}castNode(e){return this.widget?.destroy(),e?typeof e=="string"||sve(e)?(this._set("widget",null),tA(e)):(nve(e)&&!e.domNode&&(e.domNode=document.createElement("div")),this._set("widget",e),e.domNode):(this._set("widget",null),null)}};c([d()],rh.prototype,"id",null),c([d()],rh.prototype,"node",null),c([We("node")],rh.prototype,"castNode",null),c([d({readOnly:!0})],rh.prototype,"widget",void 0),rh=c([C("esri.views.ui.Component")],rh);const hb=rh,kB="calcite-mode-",OB="dark",ove="light",ave=/\W/g,lve="--esri-calcite-mode-name";function NB(){return getComputedStyle(document.body).getPropertyValue(lve).replaceAll(ave,"").toLowerCase()}function FB(){return NB()===OB}function uve(){const t=NB();switch(t){case OB:case ove:return`${kB}${t}`;default:return null}}function cve(t){const e=uve();e&&(hve(t),t.classList.add(e))}function hve(t){Array.from(t.classList).forEach((e=>{e.startsWith(kB)&&t.classList.remove(e)}))}const R2=new Map;function DB(){R2.clear()}function dve(t){return R2.get(t)}function pve(t,e){R2.set(t,e)}function y$(t){R2.delete(t)}function ef(...t){const e=Fi.acquire();for(let i=0;i<t.length;i++){const s=t[i],n=typeof s;if(n==="string")e.push(s);else if(Array.isArray(s))e.push.apply(e,s);else if(n==="object")for(const o in s)s[o]&&e.push(o)}const r=e.join(" ");return Fi.release(e),r}(()=>{const t=new Map,e=new ResizeObserver((i=>{DB();for(const s of i)t.get(s.target)?.(s)})),r=(i,s,n)=>(t.set(i,s),e.observe(i,n),He((()=>{e.unobserve(i),t.delete(i)})));return(i,s,n)=>{let o=null;return $d([ie((()=>typeof i=="function"?i():i),(a=>{o?.remove(),a&&(o=r(a,s,n))}),Oi),He((()=>o?.remove()))])}})();function k2(t){const e=t?.closest("[dir]");return e!==null&&e instanceof HTMLElement&&e.dir==="rtl"||document.dir==="rtl"}function QDe(t){const e="data-node-ref";this[t.getAttribute(e)]=null}function e4e(t){const e="data-node-ref";this[t.getAttribute(e)]=t}function fve(t){return t==="Enter"||t===" "}async function mve(t,e){await VK(yv(e));const r=typeof t=="function"?t():t;r&&("setFocus"in r&&typeof r.setFocus=="function"?await r.setFocus():r instanceof HTMLElement&&r.focus())}const yve={left:0,top:0,bottom:0,right:0},zB={bottom:30,top:15,right:15,left:15},Fa="esri-ui",Wi={ui:Fa,corner:`${Fa}-corner`,innerContainer:`${Fa}-inner-container`,manualContainer:`${Fa}-manual-container`,cornerContainer:`${Fa}-corner-container`,topLeft:`${Fa}-top-left`,topRight:`${Fa}-top-right`,bottomLeft:`${Fa}-bottom-left`,bottomRight:`${Fa}-bottom-right`};function gve(t){return t&&!t._started&&typeof t.postMixInProperties=="function"&&typeof t.buildRendering=="function"&&typeof t.postCreate=="function"&&typeof t.startup=="function"}function O_(t){return t===0?"0":`${t}px`}function g$(t){const e=typeof t=="object"&&t!==null&&Object.getPrototypeOf(t);return(e===null||e===Object.prototype)&&("component"in t||"index"in t||"position"in t)?t:null}function v$(t,{top:e,bottom:r,left:i,right:s}){t.style.top=e,t.style.bottom=r,t.style.left=i,t.style.right=s}let $o=class extends Ca.EventedAccessor{constructor(e){super(e),this._cornerNameToContainerLookup={},this._positionNameToContainerLookup={},this._components=new Array,this._componentMap=new Map,this._removeWidgetHandleKey=Symbol("componentOnRemoveSymbol"),this._locale=hs(),this.view=null,this._applyViewPadding=()=>{const r=this.container;r&&v$(r,this._toPixelPosition(this._getViewPadding()))},this._applyUIPadding=()=>{const r=this._innerContainer;r&&v$(r,this._toPixelPosition(this.padding))},this._initContainers()}initialize(){this.addHandles([ie((()=>[this.view?.padding,this.container]),this._applyViewPadding,Ft),ie((()=>this.padding),this._applyUIPadding,Ft),ie((()=>[this.container,this._locale]),(([e,r])=>{e&&e.setAttribute("lang",r)}),Ft),M3((e=>{this._locale=e}))])}destroy(){this.container=null;for(const e of this._components)e.destroy();this._components.length=0,this._componentMap.clear()}set container(e){const r=this._get("container");e!==r&&(e&&(e.classList.add(Wi.ui),cve(e),this._attachContainers(e)),r&&(r.classList.remove(Wi.ui),v$(r,{top:"",bottom:"",left:"",right:""}),r.textContent=""),this._set("container",e))}get height(){const e=this.view?.height??0;if(e===0)return e;const r=this._getViewPadding(),{top:i,bottom:s}=r;return Math.max(e-i-s,0)}get padding(){return this._get("padding")}set padding(e){this._overrideIfSome("padding",e)}castPadding(e){return typeof e=="number"?{bottom:e,top:e,right:e,left:e}:{...zB,...e}}get width(){const e=this.view?.width??0;if(e===0)return e;const r=this._getViewPadding(),{left:i,right:s}=r;return Math.max(e-i-s,0)}add(e,r){let i,s,n;if(Array.isArray(e))return void e.forEach((a=>this.add(a,r)));const o=g$(e);o&&({index:i,position:r,component:e,key:s}=o),r&&typeof r=="object"&&({index:i,key:s,position:r,internal:n}=r),!e||r&&!this._isValidPosition(r)||this._add(e,r,i??this._getNumComponentsAtPosition(r),s,n)}remove(e,r){if(!e)return;if(Array.isArray(e))return e.map((s=>this.remove(s,r)));const i=this._find(e);if(i){const s=this._componentMap.get(i);if(!s||s.key!==r)return;const n=this._components.indexOf(i);return i.node.parentNode?.removeChild(i.node),this._componentMap.delete(i),i.widget?.removeHandlesReference(this._removeWidgetHandleKey),this._components.forEach((a=>{const l=this._componentMap.get(a);l&&l.position===s.position&&l.index>s.index&&l.index--})),this._components.splice(n,1)[0]}}empty(e,r={removeInternal:!1}){if(Array.isArray(e)){for(const n of e)this.empty(n,r);return}const i=this._positionNameToContainerLookup[e??"manual"],s=Array.prototype.slice.call(i.children).map((n=>this._findByNode(n))).filter((n=>n==null?!1:!(this._componentMap.get(n)?.internal??!1)||r.removeInternal));for(const n of s)this.remove(n)}move(e,r){if(Array.isArray(e)&&e.forEach((o=>this.move(o,r))),!e)return;let i;const s=g$(e)||g$(r);if(s&&(i=s.index,r=s.position,e=s.component||e),r&&!this._isValidPosition(r))return;const n=this.remove(e);n&&this.add(n,{position:r,index:i})}find(e){if(!e)return null;const r=this._findById(e);return r&&(r.widget||r.node)}getComponents(e,r={includeInternal:!1}){return e?Array.isArray(e)?e.flatMap((i=>this._getComponentsAtPosition(i,r))):this._getComponentsAtPosition(e,r):this._components.filter((i=>r.includeInternal||!this._componentMap.get(i)?.internal)).map((({widget:i,node:s})=>i??s))}getPosition(e){for(const r in this._positionNameToContainerLookup)if(this._positionNameToContainerLookup[r].contains(e))return r;return null}_add(e,r,i,s,n){e instanceof hb||(e=new hb({node:e}));const{widget:o}=e;o!=null&&o instanceof ce&&o.addHandles(He((()=>{queueMicrotask((()=>this.remove(e)))})),this._removeWidgetHandleKey),this._components.some((a=>this._componentMap.get(a)?.position===r&&this._componentMap.get(a)?.index===i))&&this._components.forEach((a=>{const l=this._componentMap.get(a);l&&l.position===r&&l.index>=i&&l.index++})),this._place({component:e,position:r,index:i}),this._components.push(e),this._componentMap.set(e,{key:s,position:r,internal:n,index:i})}_find(e){return e?e instanceof hb?this._findByComponent(e):typeof e=="string"?this._findById(e):"domNode"in e?this._findByNode(e.domNode):this._findByNode(e):null}_getViewPadding(){return this.view?.padding??yve}_attachContainers(e){e.appendChild(this._innerContainer),e.appendChild(this._manualContainer)}_initContainers(){const e=document.createElement("div");e.classList.add(Wi.innerContainer,Wi.cornerContainer);const r=document.createElement("div");r.classList.add(Wi.innerContainer,Wi.manualContainer);const i=document.createElement("div");i.classList.add(Wi.topLeft,Wi.corner),e.appendChild(i);const s=document.createElement("div");s.classList.add(Wi.topRight,Wi.corner),e.appendChild(s);const n=document.createElement("div");n.classList.add(Wi.bottomLeft,Wi.corner),e.appendChild(n);const o=document.createElement("div");o.classList.add(Wi.bottomRight,Wi.corner),e.appendChild(o),this._innerContainer=e,this._manualContainer=r;const a=k2();this._cornerNameToContainerLookup={"top-left":i,"top-right":s,"bottom-left":n,"bottom-right":o,"top-leading":a?s:i,"top-trailing":a?i:s,"bottom-leading":a?o:n,"bottom-trailing":a?n:o},this._positionNameToContainerLookup={manual:r,...this._cornerNameToContainerLookup}}_isValidPosition(e){return!!this._positionNameToContainerLookup[e]}_place(e){const r=e.position??"manual",{component:i,index:s}=e,n=this._positionNameToContainerLookup[r],o=s!=null&&s>-1;if(gve(i.widget)&&i.widget.startup(),!o)return void n.appendChild(i.node);const a=Array.from(n.children);if(a.length!==0){for(const l of a){const u=this._findByNode(l);if(u&&s<(this._componentMap.get(u)?.index??0))return void l.parentNode?.insertBefore(i.node,l)}n.appendChild(i.node)}else n.appendChild(i.node)}_toPixelPosition(e){return{top:O_(e.top),left:O_(e.left),right:O_(e.right),bottom:O_(e.bottom)}}_findByComponent(e){return this._components.find((r=>r===e))??null}_findById(e){return this._components.find((({id:r})=>r===e))??null}_findByNode(e){return e?this._components.find((({node:r})=>r===e)):null}_getComponentsAtPosition(e,r){const i=this._positionNameToContainerLookup[e];return Array.prototype.slice.call(i.children).map((s=>this._findByNode(s))).filter(ii).filter((s=>r.includeInternal||!this._componentMap.get(s)?.internal)).map((({widget:s,node:n})=>s??n))}_getNumComponentsAtPosition(e){return this._positionNameToContainerLookup[e]?.children.length??0}};c([d()],$o.prototype,"_locale",void 0),c([d()],$o.prototype,"container",null),c([d()],$o.prototype,"height",null),c([d({value:zB})],$o.prototype,"padding",null),c([We("padding")],$o.prototype,"castPadding",null),c([d()],$o.prototype,"view",void 0),c([d()],$o.prototype,"width",null),$o=c([C("esri.views.ui.UI")],$o);const vve=$o,_ve={handleInterceptedEvent:(t,e,r,i)=>(t.scheduleRender(),e.properties[`on${i.type}`].apply(e.properties.bind||r,[i]))},bve={namespace:void 0,performanceLogger:()=>{},eventHandlerInterceptor:void 0,styleApplyer:(t,e,r)=>{e.charAt(0)==="-"?t.style.setProperty(e,r):t.style[e]=r}},wve=t=>({...bve,...t}),Sve=(t,e)=>{const r=[];for(;t&&t!==e;)r.push(t),t=t.parentNode;return r},xve=(t,e)=>t.find(e),G5=(t,e,r=!1)=>{let i=t;return e.forEach(((s,n)=>{const o=i?.children?xve(i.children,(a=>a.domNode===s)):void 0;r&&!o&&n!==e.length-1||(i=o)})),i},$ve=t=>{let e;const r={..._ve,...t},i=wve(r),s=i.performanceLogger;let n,o=!0,a=!1;const l=[],u=[],h=(m,y,g)=>{let v;i.eventHandlerInterceptor=(b,S,$,T)=>function(I){let P;s("domEvent",I);const R=Sve(I.currentTarget,v.domNode),D=R.some((U=>customElements.get(U?.tagName?.toLowerCase())));if(I.eventPhase===Event.CAPTURING_PHASE||!D)R.reverse(),P=G5(v.getLastRender(),R);else{const U=I.composedPath(),Z=U.slice(U.indexOf(I.currentTarget),U.indexOf(v.domNode)).reverse();P=G5(v.getLastRender(),Z,!0)}let V;return P&&(V=r.handleInterceptedEvent(e,P,this,I)),s("domEventProcessed",I),V},r.postProcessProjectionOptions?.(i);const _=g();v=m(y,_,i),i.eventHandlerInterceptor=void 0,l.push(v),u.push(g),r.afterFirstVNodeRendered&&r.afterFirstVNodeRendered(v,_)};let p=()=>{if(n=void 0,o){o=!1,s("renderStart",void 0);for(let m=0;m<l.length;m++){const y=u[m]();s("rendered",void 0);try{l[m].update(y)}catch(g){console.error(g)}s("patched",void 0)}s("renderDone",void 0),o=!0}};return r.modifyDoRenderImplementation&&(p=r.modifyDoRenderImplementation(p,l,u)),e={renderNow:p,scheduleRender:()=>{n||a||(n=requestAnimationFrame(p))},stop:()=>{n&&(cancelAnimationFrame(n),n=void 0),a=!0},resume:()=>{a=!1,o=!0,e.scheduleRender()},append:(m,y)=>{h(Hu.append,m,y)},insertBefore:(m,y)=>{h(Hu.insertBefore,m,y)},merge:(m,y)=>{h(Hu.merge,m,y)},replace:(m,y)=>{h(Hu.replace,m,y)},detach:m=>{for(let y=0;y<u.length;y++)if(u[y]===m)return u.splice(y,1),l.splice(y,1)[0];throw new Error("renderFunction was not found")}},e};class Z0{constructor(){this.promise=new Promise((e,r)=>{this.resolve=e,this.reject=r})}}const Mve=(t,e)=>{let r=t;for(;r;){if(r===e)return!0;if(!r.parentNode)return!1;r.parentNode instanceof ShadowRoot?r=r.parentNode.host:r=r.parentNode}return!1},Tve=(t,e,r)=>{const i=Eve(e).subscribe;return i(s=>{s.some(o=>Mve(t,o.target))&&r()})},_$={},Eve=t=>{const e=t.join(","),r=_$[e];if(r!==void 0)return r;const i=new Set,s=new MutationObserver(o=>i.forEach(a=>a(o)));globalThis.document&&s.observe(document.documentElement,{attributes:!0,attributeFilter:t,subtree:!0});const n={subscribe:o=>(i.add(o),()=>{i.delete(o),i.size===0&&(s.disconnect(),_$[e]=void 0)})};return _$[e]=n,n},Ive=(t,e)=>{let r=t;for(;r;){const i=r.closest?.(e);if(i)return i;const s=r.getRootNode?.();if(s===globalThis.document)return null;r=s.host}return null},Cve=(t,e,r)=>Ive(t,`[${e}]`)?.getAttribute(e)??r,Vt=(t,e,...r)=>{try{return t?.call(e,...r)}catch(i){console.error(i,t)}},LI=async(t,e,...r)=>{try{return await t?.call(e,...r)}catch(i){console.error(i,t)}},Pve="ar,bg,bs,ca,cs,da,de,el,en,es,et,fi,fr,he,hr,hu,id,it,ja,ko,lt,lv,nl,nb,no,pl,pt-BR,pt-PT,ro,ru,sk,sl,sr,sv,th,tr,uk,vi,zh-CN,zh-HK,zh-TW".split(","),Ave=new Set(Pve),oS="en",Lve={pt:"pt-PT",nb:"no",nn:"no",zh:"zh-CN"},Rve=async(t,e,r="")=>{const i=`${e}/${r}`,s=`${i}${t}.json`;return b$[s]??(b$[s]=VB(t,i)),await b$[s]},b$={},VB=async(t,e)=>{const r=`${e}${t}.json`;try{const i=await fetch(r);if(i.ok)return await i.json()}catch(i){return console.error(i),{}}return t===oS?{}:await VB(oS,e)},kve=t=>{const e=Cve(t,"lang",globalThis.navigator?.language||oS);return{lang:e,t9nLocale:jB(e)}},jB=t=>{const[e,r]=t.split("-"),i=e.toLowerCase();let s=i;return r&&(s=`${i}-${r.toUpperCase()}`),s=Lve[s]??s,Ave.has(s)?s:r?jB(i):oS},r4e=(t,e,r,i)=>{let s;const n=()=>Ove(t,e(),i).then(o=>{(s?.lang!==o.lang||s.t9nLocale!==o.t9nLocale||s.t9nStrings!==o.t9nStrings)&&r(o),s=o}).catch(console.error);return queueMicrotask(n),Tve(t,["lang"],n)},Ove=async(t,e,r=t.localName.split("-").slice(1).join("-"))=>{const{lang:i,t9nLocale:s}=kve(t),n=`${e}/${r}/t9n`,a=r===null?{}:await Rve(s,n,"messages.");return{lang:i,t9nLocale:s,t9nStrings:a}},Nve=t=>t.replace(Fve,(e,r)=>`${r===0?"":"-"}${e.toLowerCase()}`),Fve=/[A-Z]+(?![a-z])|[A-Z]/gu,Dve=(t,e)=>{const r=e/zve;let i=0;const s=setInterval(()=>{i+=r,i>=e&&(clearInterval(s),t())},r);return s},zve=4;/**
 * @license
 * Copyright 2019 Google LLC
 * SPDX-License-Identifier: BSD-3-Clause
 */const db=globalThis,kA=db.ShadowRoot&&(db.ShadyCSS===void 0||db.ShadyCSS.nativeShadow)&&"adoptedStyleSheets"in Document.prototype&&"replace"in CSSStyleSheet.prototype,OA=Symbol(),B5=new WeakMap;let UB=class{constructor(e,r,i){if(this._$cssResult$=!0,i!==OA)throw Error("CSSResult is not constructable. Use `unsafeCSS` or `css` instead.");this.cssText=e,this.t=r}get styleSheet(){let e=this.o;const r=this.t;if(kA&&e===void 0){const i=r!==void 0&&r.length===1;i&&(e=B5.get(r)),e===void 0&&((this.o=e=new CSSStyleSheet).replaceSync(this.cssText),i&&B5.set(r,e))}return e}toString(){return this.cssText}};const Vve=t=>new UB(typeof t=="string"?t:t+"",void 0,OA),s4e=(t,...e)=>{const r=t.length===1?t[0]:e.reduce(((i,s,n)=>i+(o=>{if(o._$cssResult$===!0)return o.cssText;if(typeof o=="number")return o;throw Error("Value passed to 'css' function must be a 'css' function result: "+o+". Use 'unsafeCSS' to pass non-literal values, but take care to ensure page security.")})(s)+t[n+1]),t[0]);return new UB(r,t,OA)},jve=(t,e)=>{if(kA)t.adoptedStyleSheets=e.map((r=>r instanceof CSSStyleSheet?r:r.styleSheet));else for(const r of e){const i=document.createElement("style"),s=db.litNonce;s!==void 0&&i.setAttribute("nonce",s),i.textContent=r.cssText,t.appendChild(i)}},q5=kA?t=>t:t=>t instanceof CSSStyleSheet?(e=>{let r="";for(const i of e.cssRules)r+=i.cssText;return Vve(r)})(t):t;/**
 * @license
 * Copyright 2017 Google LLC
 * SPDX-License-Identifier: BSD-3-Clause
 */const{is:Uve,defineProperty:Gve,getOwnPropertyDescriptor:Bve,getOwnPropertyNames:qve,getOwnPropertySymbols:Hve,getPrototypeOf:Wve}=Object,O2=globalThis,H5=O2.trustedTypes,Zve=H5?H5.emptyScript:"",Jve=O2.reactiveElementPolyfillSupport,m0=(t,e)=>t,RI={toAttribute(t,e){switch(e){case Boolean:t=t?Zve:null;break;case Object:case Array:t=t==null?t:JSON.stringify(t)}return t},fromAttribute(t,e){let r=t;switch(e){case Boolean:r=t!==null;break;case Number:r=t===null?null:Number(t);break;case Object:case Array:try{r=JSON.parse(t)}catch{r=null}}return r}},NA=(t,e)=>!Uve(t,e),W5={attribute:!0,type:String,converter:RI,reflect:!1,useDefault:!1,hasChanged:NA};Symbol.metadata??=Symbol("metadata"),O2.litPropertyMetadata??=new WeakMap;let wp=class extends HTMLElement{static addInitializer(e){this._$Ei(),(this.l??=[]).push(e)}static get observedAttributes(){return this.finalize(),this._$Eh&&[...this._$Eh.keys()]}static createProperty(e,r=W5){if(r.state&&(r.attribute=!1),this._$Ei(),this.prototype.hasOwnProperty(e)&&((r=Object.create(r)).wrapped=!0),this.elementProperties.set(e,r),!r.noAccessor){const i=Symbol(),s=this.getPropertyDescriptor(e,i,r);s!==void 0&&Gve(this.prototype,e,s)}}static getPropertyDescriptor(e,r,i){const{get:s,set:n}=Bve(this.prototype,e)??{get(){return this[r]},set(o){this[r]=o}};return{get:s,set(o){const a=s?.call(this);n?.call(this,o),this.requestUpdate(e,a,i)},configurable:!0,enumerable:!0}}static getPropertyOptions(e){return this.elementProperties.get(e)??W5}static _$Ei(){if(this.hasOwnProperty(m0("elementProperties")))return;const e=Wve(this);e.finalize(),e.l!==void 0&&(this.l=[...e.l]),this.elementProperties=new Map(e.elementProperties)}static finalize(){if(this.hasOwnProperty(m0("finalized")))return;if(this.finalized=!0,this._$Ei(),this.hasOwnProperty(m0("properties"))){const r=this.properties,i=[...qve(r),...Hve(r)];for(const s of i)this.createProperty(s,r[s])}const e=this[Symbol.metadata];if(e!==null){const r=litPropertyMetadata.get(e);if(r!==void 0)for(const[i,s]of r)this.elementProperties.set(i,s)}this._$Eh=new Map;for(const[r,i]of this.elementProperties){const s=this._$Eu(r,i);s!==void 0&&this._$Eh.set(s,r)}this.elementStyles=this.finalizeStyles(this.styles)}static finalizeStyles(e){const r=[];if(Array.isArray(e)){const i=new Set(e.flat(1/0).reverse());for(const s of i)r.unshift(q5(s))}else e!==void 0&&r.push(q5(e));return r}static _$Eu(e,r){const i=r.attribute;return i===!1?void 0:typeof i=="string"?i:typeof e=="string"?e.toLowerCase():void 0}constructor(){super(),this._$Ep=void 0,this.isUpdatePending=!1,this.hasUpdated=!1,this._$Em=null,this._$Ev()}_$Ev(){this._$ES=new Promise((e=>this.enableUpdating=e)),this._$AL=new Map,this._$E_(),this.requestUpdate(),this.constructor.l?.forEach((e=>e(this)))}addController(e){(this._$EO??=new Set).add(e),this.renderRoot!==void 0&&this.isConnected&&e.hostConnected?.()}removeController(e){this._$EO?.delete(e)}_$E_(){const e=new Map,r=this.constructor.elementProperties;for(const i of r.keys())this.hasOwnProperty(i)&&(e.set(i,this[i]),delete this[i]);e.size>0&&(this._$Ep=e)}createRenderRoot(){const e=this.shadowRoot??this.attachShadow(this.constructor.shadowRootOptions);return jve(e,this.constructor.elementStyles),e}connectedCallback(){this.renderRoot??=this.createRenderRoot(),this.enableUpdating(!0),this._$EO?.forEach((e=>e.hostConnected?.()))}enableUpdating(e){}disconnectedCallback(){this._$EO?.forEach((e=>e.hostDisconnected?.()))}attributeChangedCallback(e,r,i){this._$AK(e,i)}_$ET(e,r){const i=this.constructor.elementProperties.get(e),s=this.constructor._$Eu(e,i);if(s!==void 0&&i.reflect===!0){const n=(i.converter?.toAttribute!==void 0?i.converter:RI).toAttribute(r,i.type);this._$Em=e,n==null?this.removeAttribute(s):this.setAttribute(s,n),this._$Em=null}}_$AK(e,r){const i=this.constructor,s=i._$Eh.get(e);if(s!==void 0&&this._$Em!==s){const n=i.getPropertyOptions(s),o=typeof n.converter=="function"?{fromAttribute:n.converter}:n.converter?.fromAttribute!==void 0?n.converter:RI;this._$Em=s;const a=o.fromAttribute(r,n.type);this[s]=a??this._$Ej?.get(s)??a,this._$Em=null}}requestUpdate(e,r,i){if(e!==void 0){const s=this.constructor,n=this[e];if(i??=s.getPropertyOptions(e),!((i.hasChanged??NA)(n,r)||i.useDefault&&i.reflect&&n===this._$Ej?.get(e)&&!this.hasAttribute(s._$Eu(e,i))))return;this.C(e,r,i)}this.isUpdatePending===!1&&(this._$ES=this._$EP())}C(e,r,{useDefault:i,reflect:s,wrapped:n},o){i&&!(this._$Ej??=new Map).has(e)&&(this._$Ej.set(e,o??r??this[e]),n!==!0||o!==void 0)||(this._$AL.has(e)||(this.hasUpdated||i||(r=void 0),this._$AL.set(e,r)),s===!0&&this._$Em!==e&&(this._$Eq??=new Set).add(e))}async _$EP(){this.isUpdatePending=!0;try{await this._$ES}catch(r){Promise.reject(r)}const e=this.scheduleUpdate();return e!=null&&await e,!this.isUpdatePending}scheduleUpdate(){return this.performUpdate()}performUpdate(){if(!this.isUpdatePending)return;if(!this.hasUpdated){if(this.renderRoot??=this.createRenderRoot(),this._$Ep){for(const[s,n]of this._$Ep)this[s]=n;this._$Ep=void 0}const i=this.constructor.elementProperties;if(i.size>0)for(const[s,n]of i){const{wrapped:o}=n,a=this[s];o!==!0||this._$AL.has(s)||a===void 0||this.C(s,void 0,n,a)}}let e=!1;const r=this._$AL;try{e=this.shouldUpdate(r),e?(this.willUpdate(r),this._$EO?.forEach((i=>i.hostUpdate?.())),this.update(r)):this._$EM()}catch(i){throw e=!1,this._$EM(),i}e&&this._$AE(r)}willUpdate(e){}_$AE(e){this._$EO?.forEach((r=>r.hostUpdated?.())),this.hasUpdated||(this.hasUpdated=!0,this.firstUpdated(e)),this.updated(e)}_$EM(){this._$AL=new Map,this.isUpdatePending=!1}get updateComplete(){return this.getUpdateComplete()}getUpdateComplete(){return this._$ES}shouldUpdate(e){return!0}update(e){this._$Eq&&=this._$Eq.forEach((r=>this._$ET(r,this[r]))),this._$EM()}updated(e){}firstUpdated(e){}};wp.elementStyles=[],wp.shadowRootOptions={mode:"open"},wp[m0("elementProperties")]=new Map,wp[m0("finalized")]=new Map,Jve?.({ReactiveElement:wp}),(O2.reactiveElementVersions??=[]).push("2.1.1");/**
 * @license
 * Copyright 2017 Google LLC
 * SPDX-License-Identifier: BSD-3-Clause
 */const FA=globalThis,aS=FA.trustedTypes,Z5=aS?aS.createPolicy("lit-html",{createHTML:t=>t}):void 0,GB="$lit$",zu=`lit$${Math.random().toFixed(9).slice(2)}$`,BB="?"+zu,Yve=`<${BB}>`,wd=document,J0=()=>wd.createComment(""),Y0=t=>t===null||typeof t!="object"&&typeof t!="function",DA=Array.isArray,Xve=t=>DA(t)||typeof t?.[Symbol.iterator]=="function",w$=`[ 	
\f\r]`,My=/<(?:(!--|\/[^a-zA-Z])|(\/?[a-zA-Z][^>\s]*)|(\/?$))/g,J5=/-->/g,Y5=/>/g,Rc=RegExp(`>|${w$}(?:([^\\s"'>=/]+)(${w$}*=${w$}*(?:[^ 	
\f\r"'\`<>=]|("|')|))|$)`,"g"),X5=/'/g,K5=/"/g,qB=/^(?:script|style|textarea|title)$/i,HB=t=>(e,...r)=>({_$litType$:t,strings:e,values:r}),o4e=HB(1),a4e=HB(2),fc=Symbol.for("lit-noChange"),ir=Symbol.for("lit-nothing"),Q5=new WeakMap,Uh=wd.createTreeWalker(wd,129);function WB(t,e){if(!DA(t)||!t.hasOwnProperty("raw"))throw Error("invalid template strings array");return Z5!==void 0?Z5.createHTML(e):e}const Kve=(t,e)=>{const r=t.length-1,i=[];let s,n=e===2?"<svg>":e===3?"<math>":"",o=My;for(let a=0;a<r;a++){const l=t[a];let u,h,p=-1,m=0;for(;m<l.length&&(o.lastIndex=m,h=o.exec(l),h!==null);)m=o.lastIndex,o===My?h[1]==="!--"?o=J5:h[1]!==void 0?o=Y5:h[2]!==void 0?(qB.test(h[2])&&(s=RegExp("</"+h[2],"g")),o=Rc):h[3]!==void 0&&(o=Rc):o===Rc?h[0]===">"?(o=s??My,p=-1):h[1]===void 0?p=-2:(p=o.lastIndex-h[2].length,u=h[1],o=h[3]===void 0?Rc:h[3]==='"'?K5:X5):o===K5||o===X5?o=Rc:o===J5||o===Y5?o=My:(o=Rc,s=void 0);const y=o===Rc&&t[a+1].startsWith("/>")?" ":"";n+=o===My?l+Yve:p>=0?(i.push(u),l.slice(0,p)+GB+l.slice(p)+zu+y):l+zu+(p===-2?a:y)}return[WB(t,n+(t[r]||"<?>")+(e===2?"</svg>":e===3?"</math>":"")),i]};let kI=class ZB{constructor({strings:e,_$litType$:r},i){let s;this.parts=[];let n=0,o=0;const a=e.length-1,l=this.parts,[u,h]=Kve(e,r);if(this.el=ZB.createElement(u,i),Uh.currentNode=this.el.content,r===2||r===3){const p=this.el.content.firstChild;p.replaceWith(...p.childNodes)}for(;(s=Uh.nextNode())!==null&&l.length<a;){if(s.nodeType===1){if(s.hasAttributes())for(const p of s.getAttributeNames())if(p.endsWith(GB)){const m=h[o++],y=s.getAttribute(p).split(zu),g=/([.?@])?(.*)/.exec(m);l.push({type:1,index:n,name:g[2],strings:y,ctor:g[1]==="."?e_e:g[1]==="?"?t_e:g[1]==="@"?r_e:F2}),s.removeAttribute(p)}else p.startsWith(zu)&&(l.push({type:6,index:n}),s.removeAttribute(p));if(qB.test(s.tagName)){const p=s.textContent.split(zu),m=p.length-1;if(m>0){s.textContent=aS?aS.emptyScript:"";for(let y=0;y<m;y++)s.append(p[y],J0()),Uh.nextNode(),l.push({type:2,index:++n});s.append(p[m],J0())}}}else if(s.nodeType===8)if(s.data===BB)l.push({type:2,index:n});else{let p=-1;for(;(p=s.data.indexOf(zu,p+1))!==-1;)l.push({type:7,index:n}),p+=zu.length-1}n++}}static createElement(e,r){const i=wd.createElement("template");return i.innerHTML=e,i}};function wm(t,e,r=t,i){if(e===fc)return e;let s=i!==void 0?r._$Co?.[i]:r._$Cl;const n=Y0(e)?void 0:e._$litDirective$;return s?.constructor!==n&&(s?._$AO?.(!1),n===void 0?s=void 0:(s=new n(t),s._$AT(t,r,i)),i!==void 0?(r._$Co??=[])[i]=s:r._$Cl=s),s!==void 0&&(e=wm(t,s._$AS(t,e.values),s,i)),e}let Qve=class{constructor(e,r){this._$AV=[],this._$AN=void 0,this._$AD=e,this._$AM=r}get parentNode(){return this._$AM.parentNode}get _$AU(){return this._$AM._$AU}u(e){const{el:{content:r},parts:i}=this._$AD,s=(e?.creationScope??wd).importNode(r,!0);Uh.currentNode=s;let n=Uh.nextNode(),o=0,a=0,l=i[0];for(;l!==void 0;){if(o===l.index){let u;l.type===2?u=new N2(n,n.nextSibling,this,e):l.type===1?u=new l.ctor(n,l.name,l.strings,this,e):l.type===6&&(u=new i_e(n,this,e)),this._$AV.push(u),l=i[++a]}o!==l?.index&&(n=Uh.nextNode(),o++)}return Uh.currentNode=wd,s}p(e){let r=0;for(const i of this._$AV)i!==void 0&&(i.strings!==void 0?(i._$AI(e,i,r),r+=i.strings.length-2):i._$AI(e[r])),r++}},N2=class JB{get _$AU(){return this._$AM?._$AU??this._$Cv}constructor(e,r,i,s){this.type=2,this._$AH=ir,this._$AN=void 0,this._$AA=e,this._$AB=r,this._$AM=i,this.options=s,this._$Cv=s?.isConnected??!0}get parentNode(){let e=this._$AA.parentNode;const r=this._$AM;return r!==void 0&&e?.nodeType===11&&(e=r.parentNode),e}get startNode(){return this._$AA}get endNode(){return this._$AB}_$AI(e,r=this){e=wm(this,e,r),Y0(e)?e===ir||e==null||e===""?(this._$AH!==ir&&this._$AR(),this._$AH=ir):e!==this._$AH&&e!==fc&&this._(e):e._$litType$!==void 0?this.$(e):e.nodeType!==void 0?this.T(e):Xve(e)?this.k(e):this._(e)}O(e){return this._$AA.parentNode.insertBefore(e,this._$AB)}T(e){this._$AH!==e&&(this._$AR(),this._$AH=this.O(e))}_(e){this._$AH!==ir&&Y0(this._$AH)?this._$AA.nextSibling.data=e:this.T(wd.createTextNode(e)),this._$AH=e}$(e){const{values:r,_$litType$:i}=e,s=typeof i=="number"?this._$AC(e):(i.el===void 0&&(i.el=kI.createElement(WB(i.h,i.h[0]),this.options)),i);if(this._$AH?._$AD===s)this._$AH.p(r);else{const n=new Qve(s,this),o=n.u(this.options);n.p(r),this.T(o),this._$AH=n}}_$AC(e){let r=Q5.get(e.strings);return r===void 0&&Q5.set(e.strings,r=new kI(e)),r}k(e){DA(this._$AH)||(this._$AH=[],this._$AR());const r=this._$AH;let i,s=0;for(const n of e)s===r.length?r.push(i=new JB(this.O(J0()),this.O(J0()),this,this.options)):i=r[s],i._$AI(n),s++;s<r.length&&(this._$AR(i&&i._$AB.nextSibling,s),r.length=s)}_$AR(e=this._$AA.nextSibling,r){for(this._$AP?.(!1,!0,r);e!==this._$AB;){const i=e.nextSibling;e.remove(),e=i}}setConnected(e){this._$AM===void 0&&(this._$Cv=e,this._$AP?.(e))}},F2=class{get tagName(){return this.element.tagName}get _$AU(){return this._$AM._$AU}constructor(e,r,i,s,n){this.type=1,this._$AH=ir,this._$AN=void 0,this.element=e,this.name=r,this._$AM=s,this.options=n,i.length>2||i[0]!==""||i[1]!==""?(this._$AH=Array(i.length-1).fill(new String),this.strings=i):this._$AH=ir}_$AI(e,r=this,i,s){const n=this.strings;let o=!1;if(n===void 0)e=wm(this,e,r,0),o=!Y0(e)||e!==this._$AH&&e!==fc,o&&(this._$AH=e);else{const a=e;let l,u;for(e=n[0],l=0;l<n.length-1;l++)u=wm(this,a[i+l],r,l),u===fc&&(u=this._$AH[l]),o||=!Y0(u)||u!==this._$AH[l],u===ir?e=ir:e!==ir&&(e+=(u??"")+n[l+1]),this._$AH[l]=u}o&&!s&&this.j(e)}j(e){e===ir?this.element.removeAttribute(this.name):this.element.setAttribute(this.name,e??"")}},e_e=class extends F2{constructor(){super(...arguments),this.type=3}j(e){this.element[this.name]=e===ir?void 0:e}},t_e=class extends F2{constructor(){super(...arguments),this.type=4}j(e){this.element.toggleAttribute(this.name,!!e&&e!==ir)}},r_e=class extends F2{constructor(e,r,i,s,n){super(e,r,i,s,n),this.type=5}_$AI(e,r=this){if((e=wm(this,e,r,0)??ir)===fc)return;const i=this._$AH,s=e===ir&&i!==ir||e.capture!==i.capture||e.once!==i.once||e.passive!==i.passive,n=e!==ir&&(i===ir||s);s&&this.element.removeEventListener(this.name,this,i),n&&this.element.addEventListener(this.name,this,e),this._$AH=e}handleEvent(e){typeof this._$AH=="function"?this._$AH.call(this.options?.host??this.element,e):this._$AH.handleEvent(e)}},i_e=class{constructor(e,r,i){this.element=e,this.type=6,this._$AN=void 0,this._$AM=r,this.options=i}get _$AU(){return this._$AM._$AU}_$AI(e){wm(this,e)}};const f4e={I:N2},s_e=FA.litHtmlPolyfillSupport;s_e?.(kI,N2),(FA.litHtmlVersions??=[]).push("3.3.1");const n_e=(t,e,r)=>{const i=r?.renderBefore??e;let s=i._$litPart$;if(s===void 0){const n=r?.renderBefore??null;i._$litPart$=s=new N2(e.insertBefore(J0(),n),n,void 0,r??{})}return s._$AI(t),s};/**
 * @license
 * Copyright 2017 Google LLC
 * SPDX-License-Identifier: BSD-3-Clause
 */const zA=globalThis;let td=class extends wp{constructor(){super(...arguments),this.renderOptions={host:this},this._$Do=void 0}createRenderRoot(){const e=super.createRenderRoot();return this.renderOptions.renderBefore??=e.firstChild,e}update(e){const r=this.render();this.hasUpdated||(this.renderOptions.isConnected=this.isConnected),super.update(e),this._$Do=n_e(r,this.renderRoot,this.renderOptions)}connectedCallback(){super.connectedCallback(),this._$Do?.setConnected(!0)}disconnectedCallback(){super.disconnectedCallback(),this._$Do?.setConnected(!1)}render(){return fc}};td._$litElement$=!0,td.finalized=!0,zA.litElementHydrateSupport?.({LitElement:td});const o_e=zA.litElementPolyfillSupport;o_e?.({LitElement:td});(zA.litElementVersions??=[]).push("4.2.1");const VA=Symbol.for("controller"),a_e=t=>typeof t=="object"&&t!==null&&(VA in t||"hostConnected"in t||"hostDisconnected"in t||"hostUpdate"in t||"hostUpdated"in t),y4e=t=>typeof t?.then=="function";let xg;const $g=t=>{xg!==t&&(xg=t,queueMicrotask(()=>xg===t?xg=void 0:0))},D2=t=>xg;let ih=[];const l_e=t=>{if(t===void 0){ih=[];return}const e=ih.indexOf(t);ih=e===-1?[...ih,t]:ih.slice(0,e+1),queueMicrotask(()=>ih=[])},u_e=()=>ih;let tf;const g4e=t=>{tf!==t&&(tf=t,queueMicrotask(()=>tf===t?tf=void 0:0))},c_e=()=>{const t=tf;return tf=void 0,t},h_e=async(t,e)=>{const r=jA(t);if(r===void 0)return t;if(await r.ready,typeof e=="function"){const i=r.watchExports(s=>e(s,i))}return r.exports},d_e=async t=>{const e=jA(t);return await e.ready,e},jA=t=>{const r=D2().manager.X(t);if(r!==void 0)return r;if(a_e(t))return t;const i=c_e();if(i!==void 0)return i};let OI=!1;const v4e=t=>{OI=!0;try{return t()}finally{OI=!1}},p_e=(t,e,r)=>{const i=Object.keys(t),s=i.length;rf===void 0&&queueMicrotask(UA),rf??=new Map;let n=rf.get(t);return n===void 0&&(n={callbacks:[],keyCount:s},rf.set(t,n)),n.keyCount!==s&&(n.callbacks.forEach(o=>o(i)),n.callbacks=[],n.keyCount=s),n.callbacks.push(o=>{const a=u=>Vt(e,null,u),l=o[s];l===void 0?a(void 0):t[l]===r?a(l):a(void 0)}),r};let rf;const UA=()=>{rf?.forEach(({callbacks:t},e)=>{const r=Object.keys(e);t.forEach(i=>i(r))}),rf=void 0},f_e=(t,e,r)=>{const i=t.manager;return i.V!==ir&&i.V!==r&&i.S(void 0,void 0),i.T.length===0&&queueMicrotask(()=>i.S(void 0,void 0)),i.V=r,i.T.push((s,n)=>Vt(e,void 0,r===n?s:void 0)),r},m_e=(t=[D2(),...u_e()],e,r)=>{const i=Array.isArray(t)?t:[t];let s=i.length+1;const n=o=>{s-=1,o!==void 0&&(s=Math.min(s,0)),s===0&&e(o)};i.forEach(o=>p_e(o,a=>n(a===void 0?void 0:{key:a,host:o,isReactive:!1}),r));for(const o of i)if("manager"in o&&o.manager.component===o){f_e(o,a=>n(a===void 0?void 0:{key:a,host:o,isReactive:!0}),r);break}return r},y_e=(t="",e={},r=D2())=>{const i={emit:s=>{t===""&&UA();const n=new CustomEvent(t,{detail:s,cancelable:!0,bubbles:!0,composed:!0,...e});return r.el.dispatchEvent(n),n}};return t===""&&m_e(void 0,s=>t=s.key,i),i},_4e=y_e.bind(null,"");var YB;YB=VA;class g_e{constructor(e){this.#r=[],this.#e=[],this.#i=[],this.#l=[],this.#u=[],this.#c=[],this.#h=[],this.#d=[],this.#o=[],this.#a=!1,this.P=new Z0,this.connectedCalled=!1,this.loadedCalled=!1,this[YB]=!0,this.#n=[];const r=this,i=e??D2();r.#t=i,r.ready=r.P.promise,r.#s=tF(r),r.component=i,r.#t.addController(r),r.#t.manager===void 0||(l_e(r),queueMicrotask(()=>r.catchUpLifecycle()))}#r;#e;#i;#l;#u;#c;#h;#d;#o;#a;#t;catchUpLifecycle(){const{manager:e}=this.#t;e.connectedCalled&&!this.connectedCalled&&this.triggerConnected(),e.#a&&this.triggerLoad().then(()=>e.loadedCalled&&this.triggerLoaded()).catch(console.error)}#s;get exports(){return this.#s}set exports(e){const r=this.#s;r!==e&&(this.#s=e,this.#n.forEach(Vt),this.connectedCalled&&this.O!==!1&&this.#t.requestUpdate(this.O,r)),this.P.resolve(e)}setProvisionalExports(e,r=!0){this.#s=r?tF(e):e,this.#n.forEach(Vt)}#n;watchExports(e){const r=()=>e(this.#s);return this.#n.push(r),()=>void this.#n.splice(this.#n.indexOf(r),1)}get use(){return $g(this.#t),h_e}get useRef(){return $g(this.#t),d_e}get useRefSync(){return $g(this.#t),jA}controllerRemoved(){this.#t.el.isConnected&&this.triggerDisconnected(),this.triggerDestroy()}onConnected(e){this.#r.push(e)}onDisconnected(e){this.#e.push(e)}onLoad(e){this.#i.push(e)}onLoaded(e){this.#l.push(e)}onUpdate(e){this.#u.push(e)}onUpdated(e){this.#c.push(e)}onDestroy(e){this.#h.push(e)}onLifecycle(e){this.#d.push(e),this.connectedCalled&&this.#t.el.isConnected&&this.#p(e)}triggerConnected(){const e=this;e.hostConnected&&Vt(e.hostConnected,e),e.#r.forEach(Vt),e.triggerLifecycle(),e.connectedCalled=!0}triggerDisconnected(){const e=this;e.hostDisconnected&&Vt(e.hostDisconnected,e),e.#e.forEach(Vt),e.#o.forEach(Vt),e.#o=[]}async triggerLoad(){if(this.#a)return;this.#a=!0;const e=this;e.hostLoad&&await LI(e.hostLoad,e),this.#i.length>0&&await Promise.allSettled(this.#i.map(LI)),this.P.resolve(this.#s)}triggerLoaded(){this.loadedCalled||(this.hostLoaded&&Vt(this.hostLoaded,this),this.#l.forEach(Vt),this.loadedCalled=!0)}triggerUpdate(e){this.hostUpdate&&Vt(this.hostUpdate,this,e),this.#u.forEach(eF,e)}triggerUpdated(e){this.hostUpdated&&Vt(this.hostUpdated,this,e),this.#c.forEach(eF,e)}triggerDestroy(){this.hostDestroy&&Vt(this.hostDestroy,this),this.#h.forEach(Vt)}triggerLifecycle(){this.hostLifecycle&&this.#p(()=>this.hostLifecycle()),this.#d.forEach(this.#p,this)}#p(e){$g(this.#t);const r=Vt(e);(Array.isArray(r)?r:[r]).forEach(s=>{typeof s=="function"?this.#o.push(s):typeof s=="object"&&typeof s.remove=="function"&&this.#o.push(s.remove)})}}function eF(t){Vt(t,void 0,this)}const v_e=g_e,tF=t=>{if(typeof t!="object"&&typeof t!="function"||t===null)return t;const e={get(i,s,n){if(!((s==="exports"||s==="_exports")&&s in i&&i[s]===r)&&(s in i||s in Promise.prototype||typeof s=="symbol"))return typeof i=="function"?i[s]:Reflect.get(i,s,n)}},r=new Proxy(t,e);return r},__e=1,b_e=2,w_e=4,S_e=8,x_e=16,$_e=32,M_e=64,XB=t=>{let e=t;for(;e=e.parentNode??e.host;)if(e?.constructor?.lumina){const r=e;return r.manager?.loadedCalled||(r.J??r._offspring).push(t),(r.I??r._postLoad).promise}return!1},rF={};function KB(){}const pb=Object.defineProperty,T_e=globalThis.HTMLElement??KB;var ts,$l,Hf,hv,NI;const UL=class UL extends T_e{constructor(){var s;super();Sn(this,hv);Sn(this,ts);Sn(this,$l);Sn(this,Hf);xn(this,$l,{}),xn(this,Hf,[]),this.I=new Z0,this.H=new Z0,this.J=[];const r=this,i=r.constructor;r._offspring=r.J,r._postLoad=r.I,i.C?.forEach(n=>{Object.hasOwn(r,n)&&(ot(r,$l)[n]=r[n],delete r[n])}),i.A?ey(s=r,hv,NI).call(s,{a:i.A}):i.B.then(async n=>{var o;await i.K.p,ey(o=r,hv,NI).call(o,await(n.default?.then(a=>typeof a=="function"?{a}:a)??n))}).catch(n=>{r.H.reject(n),setTimeout(()=>{throw n})})}static F(){for(const r of this.C??[])pb(this.prototype,r,{configurable:!0,enumerable:!0,get(){return ot(this,$l)[r]},set(i){ot(this,$l)[r]=i}});for(const r of this.E??[])pb(this.prototype,r,{async value(...i){return ot(this,ts)||await this.H.promise,await ot(this,ts)[r](...i)},configurable:!0});for(const r of this.D??[])pb(this.prototype,r,{value(...i){return ot(this,ts)[r](...i)},configurable:!0})}get manager(){return ot(this,ts)?.manager}attributeChangedCallback(r,i,s){ot(this,ts)?.attributeChangedCallback(r,i,s),ot(this,ts)||ot(this,Hf).push(r)}connectedCallback(){ot(this,ts)?ot(this,ts).connectedCallback?.():queueMicrotask(()=>this.G=XB(this))}disconnectedCallback(){ot(this,ts)?.disconnectedCallback?.()}async componentOnReady(){return await this.H.promise,this}addController(){}requestUpdate(){ot(this,ts)?.requestUpdate()}};ts=new WeakMap,$l=new WeakMap,Hf=new WeakMap,hv=new WeakSet,NI=function(r){const i=this.constructor,s=i.L,n=ot(this,$l),o=Object.values(r).find(m=>m.L===s),a=`${s}--lazy`;let l=o;for(;l&&!Object.hasOwn(l,"lumina");)l=Object.getPrototypeOf(l);I_e(l),!i.A&&(i.A=o,customElements.define(a,o)),o.N=this;const h=document.createElement(a);o.N=void 0,xn(this,ts,h),xn(this,$l,h),ot(this,Hf).forEach(m=>h.attributeChangedCallback(m,null,this.getAttribute(m))),Object.entries(n).forEach(E_e,h);const p=this.isConnected;(p||this.G)&&(h.connectedCallback?.(),p||h.disconnectedCallback())},UL.lumina=!0;let iF=UL;function E_e([t,e]){this[t]=e}const I_e=t=>{const e=t.prototype,r=Element.prototype;Object.hasOwn(e,"isConnected")||(e.setAttribute=function(s,n){r.setAttribute.call(this.el,s,n)},e.removeAttribute=function(s){r.removeAttribute.call(this.el,s)},pb(e,"isConnected",{get(){return Reflect.get(r,"isConnected",this.el)}}))};/**
 * @license
 * Copyright 2017 Google LLC
 * SPDX-License-Identifier: BSD-3-Clause
 */const QB={ATTRIBUTE:1,CHILD:2,PROPERTY:3,BOOLEAN_ATTRIBUTE:4},eq=t=>(...e)=>({_$litDirective$:t,values:e});let tq=class{constructor(e){}get _$AU(){return this._$AM._$AU}_$AT(e,r,i){this._$Ct=e,this._$AM=r,this._$Ci=i}_$AS(e,r){return this.update(e,r)}update(e,r){return this.render(...r)}};/**
 * @license
 * Copyright 2018 Google LLC
 * SPDX-License-Identifier: BSD-3-Clause
 */const C_e=eq(class extends tq{constructor(t){if(super(t),t.type!==QB.ATTRIBUTE||t.name!=="class"||t.strings?.length>2)throw Error("`classMap()` can only be used in the `class` attribute and must be the only part in the attribute.")}render(t){return" "+Object.keys(t).filter((e=>t[e])).join(" ")+" "}update(t,[e]){if(this.st===void 0){this.st=new Set,t.strings!==void 0&&(this.nt=new Set(t.strings.join(" ").split(/\s/).filter((i=>i!==""))));for(const i in e)e[i]&&!this.nt?.has(i)&&this.st.add(i);return this.render(e)}const r=t.element.classList;for(const i of this.st)i in e||(r.remove(i),this.st.delete(i));for(const i in e){const s=!!e[i];s===this.st.has(i)||this.nt?.has(i)||(s?(r.add(i),this.st.add(i)):(r.remove(i),this.st.delete(i)))}return fc}});/**
 * @license
 * Copyright 2018 Google LLC
 * SPDX-License-Identifier: BSD-3-Clause
 */const rq="important",P_e=" !"+rq,A_e=eq(class extends tq{constructor(t){if(super(t),t.type!==QB.ATTRIBUTE||t.name!=="style"||t.strings?.length>2)throw Error("The `styleMap` directive must be used in the `style` attribute and must be the only part in the attribute.")}render(t){return Object.keys(t).reduce(((e,r)=>{const i=t[r];return i==null?e:e+`${r=r.includes("-")?r:r.replace(/(?:^(webkit|moz|ms|o)|)(?=[A-Z])/g,"-$&").toLowerCase()}:${i};`}),"")}update(t,[e]){const{style:r}=t.element;if(this.ft===void 0)return this.ft=new Set(Object.keys(e)),this.render(e);for(const i of this.ft)e[i]==null&&(this.ft.delete(i),i.includes("-")?r.removeProperty(i):r[i]=null);for(const i in e){const s=e[i];if(s!=null){this.ft.add(i);const n=typeof s=="string"&&s.endsWith(P_e);i.includes("-")||n?r.setProperty(i,n?s.slice(0,-11):s,n?rq:""):r[i]=s}}return fc}});class L_e extends v_e{constructor(e){super(e),this.destroyed=!1,this.R=!1,this.V=ir,this.T=[],this.#i=new WeakMap,this.#e=e,this.exports=void 0,this.hasDestroy=FI in e&&typeof e.destroy=="function",td.prototype.addController.call(e,{hostConnected:()=>{if(this.destroyed){const r=e.el.localName;throw e.el.remove(),new Error(`The ${r} component has already been destroyed. It cannot be used again. If you meant to disconnect and reconnect a component without automatic destroy, set the ${FI} prop.`)}this.#r!==void 0&&clearTimeout(this.#r),UA();for(const r of e.M)"triggerConnected"in r?r.triggerConnected():Vt(r.hostConnected,r)},hostDisconnected:()=>{for(const r of e.M)"triggerDisconnected"in r?r.triggerDisconnected():Vt(r.hostDisconnected,r);this.hasDestroy&&!this.destroyed&&this.U()},hostUpdate:()=>{for(const r of e.M)"triggerUpdate"in r?r.triggerUpdate(this.Q):Vt(r.hostUpdate,r,this.Q)},hostUpdated:()=>{for(const r of e.M)"triggerUpdated"in r?r.triggerUpdated(this.Q):Vt(r.hostUpdated,r,this.Q);this.Q=void 0}}),queueMicrotask(()=>this.R=!0),$g(e)}#r;#e;async destroy(){if(!this.destroyed){this.#e.el.isConnected&&(this.hasDestroy=!1,this.#e.el.remove()),this.#r=void 0,this.destroyed=!0;for(const e of this.#e.M)"triggerDestroy"in e?e.triggerDestroy():Vt(e.hostDestroy,e);this.#e.M.splice(0)}}U(){if(this.#r!==void 0&&clearTimeout(this.#r),!this.#e.el.isConnected&&!this.#e.autoDestroyDisabled){const e=()=>void this.#e.destroy();this.#r=Dve(e,R_e)}}S(e,r){const i=this.T;this.V=ir,this.T=[],i.forEach(s=>s(e,r))}#i;W(e,r){(typeof r=="object"&&r!==null||typeof r=="function")&&this.#i.set(r,e)}X(e){if(typeof e=="object"&&e!==null||typeof e=="function")return this.#i.get(e)}}let R_e=1e3;const FI="autoDestroyDisabled";var qh,dv,pv,Hh,Fo,Em,iq,sq;const M0=class M0 extends td{constructor(){super();Sn(this,Em);Sn(this,qh);Sn(this,dv);Sn(this,pv);Sn(this,Hh);Sn(this,Fo);this.M=[],this.manager=new L_e(this);const r=this,i=r.constructor,s=i.N,n=i.K.o,o=M0.prototype.shouldUpdate;xn(r,Hh,s?.H??new Z0),r.I=s?.I??new Z0,r.J=s?.J??[],r._offspring=r.J,r._postLoad=r.I,r.el=s??r,xn(r,pv,r.enableUpdating),r.enableUpdating=KB,r.shouldUpdate!==o&&(xn(r,dv,r.shouldUpdate),r.shouldUpdate=o),n&&(xn(r,qh,new Map),i.elementProperties.forEach((a,l)=>ot(r,qh).set(l,n())))}static finalizeStyles(r){const i=super.finalizeStyles(r),s=this.shadowRootOptions===rF;return this.K?.commonStyles===void 0||s?i:[this.K.commonStyles,...i]}static createProperty(r,i){const s=typeof i=="number"?i:Array.isArray(i)?i[0]:0,n=Array.isArray(i)?i[1]:void 0,o=n?.hasChanged??NA,a={attribute:s&__e&&typeof r=="string"?Nve(r):!1,reflect:!!(s&b_e),type:s&w_e?Boolean:s&S_e?Number:void 0,state:!!(s&x_e),readOnly:!!(s&$_e),noAccessor:!!(s&M_e),c:!1,...n,hasChanged(l,u){const h=o(l,u);return a.c=h,h}};super.createProperty(r,a)}static getPropertyDescriptor(r,i,s){const n=this.K,o=super.getPropertyDescriptor(r,i,s);return s.d=o,{...o,get(){return n.t?.(ot(this,qh).get(r)),o.get?.call(this)},set(a){const l=this.manager;if(s.readOnly&&!OI&&(l.R||l.connectedCalled))throw Error(`Cannot assign to read-only property "${r}" of ${this.el.localName}. Trying to assign "${a}"`);o.set.call(this,a??void 0),s.c&&ot(this,qh)?.get(r)?.notify(),l.T.length>0&&l?.S(r,a)}}}connectedCallback(){if(this.el.hasAttribute("defer-hydration"))return;const r=this.constructor.K.c?.(()=>this.requestUpdate());xn(this,Fo,r);const i=!this.manager.connectedCalled;super.connectedCallback(),i?queueMicrotask(()=>ey(this,Em,sq).call(this).catch(s=>{ot(this,Hh).reject(s),setTimeout(()=>{throw s})})):r&&this.requestUpdate()}disconnectedCallback(){super.disconnectedCallback(),ot(this,Fo)?.destroy(),xn(this,Fo,void 0)}createRenderRoot(){const r=this.el.shadowRoot,i=this.constructor,s=i.shadowRootOptions,o=r??(s===rF?this.el:this.el.attachShadow(s));if(r)return td.prototype.createRenderRoot.call(this),r;if(this.isConnected){const a=o.getRootNode();a.adoptedStyleSheets=[...a.adoptedStyleSheets,...i.elementStyles.map(l=>"styleSheet"in l?l.styleSheet:l)]}return o}shouldUpdate(r){var i;return this.manager.Q=r,((i=ot(this,dv))==null?void 0:i.call(this,r))??!0}update(r){ot(this,Fo)?ey(this,Em,iq).call(this,r):super.update(r)}listen(r,i,s){const n=i?.bind(this)??i;this.manager.onLifecycle(()=>(this.el.addEventListener(r,n,s),()=>this.el.removeEventListener(r,n,s)))}listenOn(r,i,s,n){const o=s?.bind(this)??s;this.manager.onLifecycle(()=>(r.addEventListener(i,o,n),()=>r.removeEventListener(i,o,n)))}async componentOnReady(){return await ot(this,Hh).promise,this}addController(r){this.M.push(r),!(VA in r)&&this.renderRoot&&this.el.isConnected&&r.hostConnected?.()}removeController(r){this.M.splice(this.M.indexOf(r),1),r.controllerRemoved?.()}};qh=new WeakMap,dv=new WeakMap,pv=new WeakMap,Hh=new WeakMap,Fo=new WeakMap,Em=new WeakSet,iq=function(r){try{ot(this,Fo).clear(),this.constructor.K.r(ot(this,Fo),()=>XL(M0.prototype,this,"update").call(this,r))}catch(i){throw ot(this,Fo).clear(),i}},sq=async function(){const r=this.el.G??XB(this.el);r&&await r;const i=[];for(const n of this.M)"triggerLoad"in n?i.push(n.triggerLoad()):i.push(LI(n.hostLoad,n));await Promise.all(i),await this.load?.(),this.manager.hasDestroy&&this.manager.onUpdate(n=>n.has(FI)&&this.manager.U()),ot(this,pv).call(this,!0),this.performUpdate(),this.I.resolve(),await Promise.resolve();const s=this.J.filter(n=>!n.manager?.loadedCalled);s.length&&await Promise.allSettled(s.map(async n=>await n.componentOnReady())),this.J.length=0,this.el.setAttribute(this.constructor.K.hydratedAttribute,"");for(const n of this.M)"triggerLoaded"in n?n.triggerLoaded():Vt(n.hostLoaded,n);this.loaded?.(),ot(this,Hh).resolve()},M0.lumina=!0;let sF=M0;const k_e=t=>{let e;const r=s=>{e=new URL(s,globalThis.location?.href||void 0).href},i={...t,getAssetPath(s){const n=new URL(s,e);return n.origin!==globalThis.location?.origin?n.href:n.pathname},setAssetPath:r,customElement(s,n){n.K=i,n.L=s,customElements.get(s)||customElements.define(s,n)}};return r(t.defaultAssetPath),i},w4e=t=>typeof t=="object"&&t!=null?C_e(t):t,S4e=t=>typeof t=="object"&&t!=null?A_e(t):t,x4e=ir;function $4e(t,e,r){r==null?t.removeAttribute(e):t.setAttribute(e,r)}const M4e={toAttribute:t=>t===!0?"":t===!1?null:t};/*! All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://github.com/Esri/calcite-design-system/blob/dev/LICENSE.md for details.
v3.2.1 */const O_e="calcite-mode-auto",N_e="calcite-mode-dark",T4e={rtl:"calcite--rtl"},E4e={filter:250,nextTick:0,resize:150,reposition:100},I4e=25;function nF(){const{classList:t}=document.body,e=window.matchMedia("(prefers-color-scheme: dark)").matches,r=()=>t.contains(N_e)||t.contains(O_e)&&e?"dark":"light",i=o=>document.body.dispatchEvent(new CustomEvent("calciteModeChange",{bubbles:!0,detail:{mode:o}})),s=o=>{n!==o&&i(o),n=o};let n=r();i(n),window.matchMedia("(prefers-color-scheme: dark)").addEventListener("change",o=>s(o.matches?"dark":"light")),new MutationObserver(()=>s(r())).observe(document.body,{attributes:!0,attributeFilter:["class"]})}const y0=globalThis.calciteConfig,C4e=y0?.focusTrapStack||[],P4e=y0?.logLevel||"info",oF="3.2.1",F_e="2025-05-29",D_e="618973fec";function z_e(){if(y0&&y0.version)return;console.info(`Using Calcite Components ${oF} [Date: ${F_e}, Revision: ${D_e}]`);const t=y0||globalThis.calciteConfig||{};Object.defineProperty(t,"version",{value:oF,writable:!1}),globalThis.calciteConfig=t}function V_e(){document.readyState==="interactive"?nF():document.addEventListener("DOMContentLoaded",()=>nF(),{once:!0}),z_e()}V_e();const j_e=k_e({defaultAssetPath:"https://js.arcgis.com/calcite-components/3.2.1/",hydratedAttribute:"calcite-hydrated"}),{customElement:A4e,getAssetPath:L4e,setAssetPath:U_e}=j_e;/*! All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://github.com/Esri/calcite-design-system/blob/dev/LICENSE.md for details.
v3.2.1 */let nq=!1;const G_e=t=>{nq=!0,U_e(t)};let oq;function B_e(){nq||G_e(on(Et(oq)))}function Uv(t){const e=[];for(const r of Object.keys(t))customElements.get(`calcite-${r}`)||e.push(t[r]?.());return e.length>0?Promise.all(e):null}oq="components/assets";const aq=Symbol("widget"),lq=Symbol("widget-test-data"),q_e=[],H_e={},lS=new WeakMap;function uq(t,e){let r=e.children;if(r?.length)for(let s=0;s<r.length;++s)r[s]=uq(t,r[s]);else r=q_e;const i=e.vnodeSelector;if(uS(i)){const s=e.properties||H_e,n=s.key||i,o={key:n,afterCreate:W_e,afterUpdate:Z_e,afterRemoved:cq,parentWidget:t,widgetConstructor:i,widgetProperties:{...s,key:n,children:r}};return{vnodeSelector:i.vnodeSelector,properties:o,children:void 0,text:void 0,domNode:null}}return e}function W_e(t,e,r,{parentWidget:i,widgetConstructor:s,widgetProperties:n}){const o=new s(n);o.container=t,lS.set(t,o),o.afterCreate?.(o,t),i.addHandles(He((()=>cq(t)))),queueMicrotask((()=>{o[lq].projector.renderNow()}))}function Z_e(t,e,r,{widgetProperties:i}){const s=lS.get(t);s&&(s.set(i),s.afterUpdate?.(s,t))}function cq(t){const e=lS.get(t);e&&(e.afterRemoved?.(e,t),e.destroy(),lS.delete(t))}function uS(t){return typeof t=="function"&&t[aq]}const aF=new Set;function J_e(t){aF.add(t),t.finally((()=>aF.delete(t)))}function Y_e(t){return He()}var lF;let X_e=0;function hq(t,e){const r=Object.prototype.hasOwnProperty;for(const i in e)r.call(e,i)&&r.call(t,i)&&(t[i]!=null&&e[i]!=null&&typeof t[i]=="object"&&typeof e[i]=="object"?hq(t[i],e[i]):t[i]=e[i]);return t}const K_e=$ve({postProcessProjectionOptions(t){const e=t.eventHandlerInterceptor,r=/capture$/i;t.eventHandlerInterceptor=(i,s,n,o)=>{const a=e?.(i,s,n,o),l=r.test(i);if(!((i=i.replace(r,"")).toLowerCase()in n)||l){const u=i[2].toLowerCase()+i.slice(3),h=y=>a?.call(n,y);n.addEventListener(u,h,l);const p=()=>n.removeEventListener(u,h,l),m=o.afterRemoved;o.afterRemoved=y=>{m?.(y),p()}}return a}},handleInterceptedEvent(t,e,r,i){const{eventPhase:s,type:n}=i,o=s===Event.CAPTURING_PHASE;let a=`on${n}${o?"capture":""}`;const l=e.properties;(l&&a in l||(a=`on${n[0].toUpperCase()}${n.slice(1)}${o?"Capture":""}`,l&&a in l))&&(DB(),t.scheduleRender(),l[a].call(l.bind||r,i))}});let S$=!1;var ld;let Nr=(ld=class extends Tl.EsriPromiseMixin(Ca.EventedAccessor){constructor(e,r){super(e,r),this._attached=!1,this._projector=K_e,this._readyForTrueRender=!1,this.key=this,this.autoRenderingEnabled=!0,this._loadLocale=US((async()=>{if(this._messageBundleProps?.length){const l=await Promise.allSettled(this._messageBundleProps.map((async({bundlePath:u,propertyName:h})=>{if(this.destroyed)return;let p=await E3(u);this.uiStrings&&Object.keys(this.uiStrings)&&(p=hq(k(p),this.uiStrings)),this[h]=p})));if(this.destroyed)return;for(const u of l)u.status==="rejected"&&q.getLogger(this).error("widget-intl:locale-error",this.declaredClass,u.reason)}await this.loadLocale()})),this.addHandles(Y_e()),B_e();const i="esri-widget-uid-"+jm(),s=this.render.bind(this);this._trackingTarget=new HS((()=>{this.autoRenderingEnabled&&this.scheduleRender()}));const n=()=>({vnodeSelector:"div",properties:{key:`${i}-hidden`,class:"",styles:{display:"none"}},domNode:null,children:void 0,text:void 0}),o=()=>{if(!this._readyForTrueRender||this.destroyed)return null;const l=s()??n(),u=l.properties??={};if(u.key??=i,uS(l.vnodeSelector)){if(!this.visible)return n()}else this.visible?u.styles||(u.styles={}):(u.class="",u.styles={display:"none"}),u.styles.display??="";let h=0;return l.children?.forEach((p=>{uS(p.vnodeSelector)||(p.properties??={},p.properties.key??=`${this.id}--${h++}`)})),uq(this,l)};this.render=()=>{if(S$)return o();let l=dve(this)??null;if(l)return l;this._trackingTarget.clear(),S$=!0;try{l=Dl(this._trackingTarget,o)}catch(u){throw q.getLogger(this).error(u),u}finally{S$=!1}return l&&pve(this,l),l};const a=this.beforeFirstRender();a?this._resourcesFetch=a.then((()=>{this._readyForTrueRender=!0,this._postInitialize()})):(this._resourcesFetch=Promise.resolve().then((()=>{this._postInitialize()})),this._readyForTrueRender=!0),this.addResolvingPromise(this._resourcesFetch),J_e(this._resourcesFetch)}normalizeCtorArgs(e,r){const i={...e};return r&&(i.container=r),i}postInitialize(){}beforeFirstRender(){const e=this.loadDependencies();return this._messageBundleProps?.length||e?Promise.all([e,this._loadLocale()]).then((()=>{})).catch(uR):null}loadDependencies(){return null}loadLocale(){return null}destroy(){this.destroyed||(At(this._trackingTarget),At(this.viewModel),this._detach(this.container),this._set("container",null),this._emitter.clear(),this.render=()=>null,this._projector=null,y$(this))}set container(e){this._get("container")||this._set("container",e)}castContainer(e){return tA(e)}get domNode(){return this.container}set domNode(e){this.container=e}get icon(){return null}set icon(e){this._overrideIfSome("icon",e)}get id(){return this._get("id")||this.container?.id||Date.now().toString(16)+"-widget-"+X_e++}set id(e){e&&this._set("id",e)}get label(){return this.declaredClass.split(".").pop()}set label(e){this._overrideIfSome("label",e)}get renderable(){return this._resourcesFetch}get visible(){return this._get("visible")}set visible(e){this._set("visible",e)}get[(lF=aq,lq)](){return{projector:this._projector}}render(){throw new Error("not implemented")}scheduleRender(){this.destroyed||(y$(this),this._projector.scheduleRender())}classes(...e){return ef.apply(this,e)}renderNow(){y$(this),this._projector.renderNow()}_postInitialize(){if(this.destroyed)return;this.scheduleRender(),this._delegatedEventNames?.length&&this.addHandles(ie((()=>this.viewModel),((r,i)=>{i&&this.removeHandles("delegated-events"),r&&jS(r)&&this.addHandles(this._delegatedEventNames.map((s=>Lm(r,s,(n=>{this.emit(s,n)})))),"delegated-events")}),Oi)),this.postInitialize();const e=async()=>{await this._loadLocale().catch(uR),this.scheduleRender()};this.addHandles([M3(e),ie((()=>this.uiStrings),e)]),this.addHandles(fs((()=>this.container),(r=>{this.destroyed||this._attach(r)}),{initial:!0,once:!0}))}_attach(e){e&&(this._projector.merge(e,this.render),this._attached=!0)}_detach(e){this._attached&&(this._projector.detach(this.render),this._attached=!1),e?.parentNode?.removeChild(e)}},ld[lF]=!0,ld.vnodeSelector="div",ld);c([d()],Nr.prototype,"_readyForTrueRender",void 0),c([d({value:null})],Nr.prototype,"container",null),c([We("container")],Nr.prototype,"castContainer",null),c([d()],Nr.prototype,"icon",null),c([d()],Nr.prototype,"id",null),c([d()],Nr.prototype,"label",null),c([d()],Nr.prototype,"renderable",null),c([d()],Nr.prototype,"uiStrings",void 0),c([d()],Nr.prototype,"viewModel",void 0),c([d({value:!0})],Nr.prototype,"visible",null),c([d()],Nr.prototype,"key",void 0),c([d()],Nr.prototype,"children",void 0),c([d()],Nr.prototype,"afterCreate",void 0),c([d()],Nr.prototype,"afterUpdate",void 0),c([d()],Nr.prototype,"afterRemoved",void 0),Nr=c([C("esri.widgets.Widget")],Nr);const Lr=Nr;var uF,cF,hF,dF,pF,fF,mF,yF,gF,vF,_F,bF,wF,SF,xF;(function(t){t.U8="U8",t.I8="I8",t.U16="U16",t.I16="I16",t.U32="U32",t.I32="I32",t.F32="F32",t.F64="F64",t.Utf8String="Utf8String",t.NotSet="NotSet"})(uF||(uF={})),(function(t){t.Png="Png",t.Jpeg="Jpeg",t.Dds="Dds",t.Raw="Raw",t.Dxt1="Dxt1",t.Dxt5="Dxt5",t.Bc7="Bc7",t.Basis="Basis",t.Etc1="Etc1",t.Etc2="Etc2",t.Astc="Astc",t.Pvrtc="Pvrtc",t.NotSet="NotSet"})(cF||(cF={})),(function(t){t.Position="Position",t.Normal="Normal",t.TexCoord="TexCoord",t.Color="Color",t.Tangent="Tangent",t.FeatureIndex="FeatureIndex",t.UvRegion="UvRegion",t.FeatureVariable="FeatureVariable",t.NotSet="NotSet"})(hF||(hF={})),(function(t){t.Opaque="Opaque",t.Mask="Mask",t.Blend="Blend"})(dF||(dF={})),(function(t){t.None="None",t.Mask="Mask",t.Alpha="Alpha",t.PreMultAlpha="PreMultAlpha",t.NotSet="NotSet"})(pF||(pF={})),(function(t){t.Points="Points",t.Lines="Lines",t.LineStrip="LineStrip",t.Triangles="Triangles",t.TriangleStrip="TriangleStrip",t.NotSet="NotSet"})(fF||(fF={})),(function(t){t.None="None",t.WrapXBit="WrapXBit",t.WrapYBit="WrapYBit",t.WrapXy="WrapXy",t.NotSet="NotSet"})(mF||(mF={})),(function(t){t.Linear="Linear",t.Nearest="Nearest",t.NotSet="NotSet"})(yF||(yF={})),(function(t){t.Linear="Linear",t.Nearest="Nearest",t.NearestMipmapNearest="NearestMipmapNearest",t.LinearMipmapNearest="LinearMipmapNearest",t.NearestMipmapLinear="NearestMipmapLinear",t.LinearMipmapLinear="LinearMipmapLinear",t.NotSet="NotSet"})(gF||(gF={})),(function(t){t.FeatureId="FeatureId",t.GlobalUid="GlobalUid",t.UnspecifiedDateTime="UnspecifiedDateTime",t.EcmaIso8601DateTime="EcmaIso8601DateTime",t.EcmaIso8601DateOnly="EcmaIso8601DateOnly",t.TimeOnly="TimeOnly",t.TimeStamp="TimeStamp",t.ColorRgb="ColorRgb",t.ColorRgba="ColorRgba",t.Unrecognized="Unrecognized",t.NotSet="NotSet"})(vF||(vF={})),(function(t){t.Texture="Texture",t.VertexAtrb="VertexAtrb",t.Implicit="Implicit",t.NotSet="NotSet"})(_F||(_F={})),(function(t){t.Front="Front",t.Back="Back",t.None="None",t.NotSet="NotSet"})(bF||(bF={})),(function(t){t.Pbr="Pbr",t.Unlit="Unlit"})(wF||(wF={})),(function(t){t.Rgb8="Rgb8",t.Rgba8="Rgba8",t.R8="R8",t.Bgr8="Bgr8",t.Bgra8="Bgra8",t.Rg8="Rg8",t.Ga8="Ga8",t.Etc1="Etc1",t.Etc2="Etc2",t.Dxt1="Dxt1",t.Dxt5="Dxt5",t.Bc7="Bc7",t.NotSet="NotSet"})(SF||(SF={})),(function(t){t[t.Succeeded=0]="Succeeded",t[t.Failed=1]="Failed",t[t.MissingInputs=2]="MissingInputs"})(xF||(xF={}));const Q_e=new Map;function e1e(t){return Q_e.get(t)}function $F(t,e){return t&&"copyright"in t&&(!e||typeof t.originOf=="function"&&t.originOf("copyright")==="user")}function t1e(t,e){return t.length!==e.length||t.some(((r,i)=>r.text!==e[i].text))}function Ty(t,e,r){!r||!e||t.find((i=>i.layerView===e&&i.text===r))||t.push({text:r,layerView:e})}function r1e(t){return t.type==="bing-maps"}const Da=[];let Sp=class extends ce{constructor(e){super(e),this._clear=()=>{this._fetchedAttributionData.clear(),this._pendingAttributions.clear(),this.removeHandles("suspension"),this.notifyChange("state")},this._pendingAttributions=new Set,this._fetchedAttributionData=new Map,this.items=new se,this.view=null,this._allLayerViewsChange=r=>{this.removeHandles("suspension"),this.removeHandles("visible-geometry-changed");const i=this.view?.allLayerViews;i&&(this.addHandles(i.map((s=>ie((()=>[s.suspended,s.layer?.attributionVisible]),(()=>this._updateAttributionItems())))).toArray(),"suspension"),i.forEach((s=>{s.declaredClass==="esri.views.3d.layers.Tiles3DLayerView3D"&&this.addHandles(s.on("visible-geometry-changed",(()=>this._updateAttributionItems())),"visible-geometry-changed")}))),r?.removed&&r.removed.forEach((s=>{this._pendingAttributions.delete(s),this._fetchedAttributionData.delete(s)})),this._updateAttributionItems()},this.addHandles([so((()=>this.view?.allLayerViews),"change",(r=>this._allLayerViewsChange(r)),{onListenerAdd:()=>this._allLayerViewsChange(),onListenerRemove:this._clear}),fs((()=>this.view?.stationary===!0),(()=>this._updateAttributionItems()))])}destroy(){this.view=null,this._fetchedAttributionData.clear(),this._pendingAttributions.clear(),this.items.removeAll()}get state(){return this.view?.ready?this._pendingAttributions.size>0?"loading":"ready":"disabled"}_updateAttributionItems(){const e=this.view,r=e?.allLayerViews;if(Da.length=0,!e||!r)return void this._clear();r.forEach((s=>{if(s.suspended||!s.layer?.attributionVisible)return;const n=s.layer;if($F(n,"user"))return void Ty(Da,s,n.copyright);if(n.hasAttributionData){if(this._fetchedAttributionData.has(s)){const a=this._fetchedAttributionData.get(s);return void(a?Ty(Da,s,this._getDynamicAttribution(a,e,n)):$F(n)&&Ty(Da,s,n.copyright))}return void this._fetchAttributionData(s)}const o="portalItem"in n?n.portalItem?.accessInformation:void 0;Ty(Da,s,o||n.copyright)}));const i=r.find((s=>s.layer?.type==="integrated-mesh-3dtiles"));if(this.view&&i){const s=e1e(this.view);if(s){const n=s.getAttributionText();for(let o=0;o<n.length;++o)Ty(Da,i,n[o])}}t1e(this.items,Da)&&(this.items.removeAll(),this.items.addMany(Da)),Da.length=0,this.notifyChange("state")}async _fetchAttributionData(e){if(this._pendingAttributions.has(e))return;this._pendingAttributions.add(e);const r=await JS(e.layer.fetchAttributionData());if(this._pendingAttributions.has(e)){const i=r.ok?this._createContributionIndex(r.value,r1e(e.layer)):null;this._pendingAttributions.delete(e),this._fetchedAttributionData.set(e,i)}this._updateAttributionItems()}_createContributionIndex(e,r){const i=e.contributors,s={};if(!i)return s;for(let n=0;n<i.length;n++){const o=i[n],a=o.coverageAreas;if(!a)return;for(const l of a){const u=l.bbox,h=l.zoomMin-(r&&l.zoomMin?1:0),p=l.zoomMax-(r&&l.zoomMax?1:0),m=new Le({xmin:u[1],ymin:u[0],xmax:u[3],ymax:u[2],spatialReference:ne.WGS84}),y={extent:Jh(m),attribution:o.attribution||"",score:l.score!=null?l.score:100,id:n};for(let g=h;g<=p;g++)s[g]??=[],s[g].push(y)}}return s.maxKey=Math.max.apply(null,Object.keys(s)),s}_getDynamicAttribution(e,r,i){const{extent:s,scale:n}=r;let o=i.tileInfo?.scaleToZoom(n)??0;if(o=Math.min(e.maxKey??0,Math.round(o)),!s||o==null||o<=-1)return"";const a=e[o],l=QS(s.center.clone().normalize(),ne.WebMercator),u=new Set;return a?a.filter((h=>{const p=h.id,m=!u.has(p)&&l&&h.extent&&xv(h.extent,l);return m&&u.add(p),m})).sort(((h,p)=>p.score-h.score||h.objectId-p.objectId)).map((h=>h.attribution)).join(", "):""}};c([d({readOnly:!0,type:se})],Sp.prototype,"items",void 0),c([d({readOnly:!0})],Sp.prototype,"state",null),c([d()],Sp.prototype,"view",void 0),Sp=c([C("esri.widgets.Attribution.AttributionViewModel")],Sp);const dq=Sp,Hr={button:"esri-button",buttonDisabled:"esri-button--disabled",buttonHalf:"esri-button--half",buttonSecondary:"esri-button--secondary",buttonSmall:"esri-button--small",buttonTertiary:"esri-button--tertiary",buttonThird:"esri-button--third",disabled:"esri-disabled",empty:"esri-widget__content--empty",heading:"esri-widget__heading",interactive:"esri-interactive",loaderAnimation:"esri-widget__loader-animation",panel:"esri-widget--panel",table:"esri-widget__table",widget:"esri-widget",widgetButton:"esri-widget--button"};function i1e(){return function(t,e){if(!t[e])throw new TypeError(`Cannot auto bind undefined function '${String(e)}'`);return{value:n1e(t[e])}}}function s1e(t){const e=t?.type;return t instanceof KeyboardEvent||e==="keyup"||e==="keydown"||e==="keypress"}function n1e(t){return function(e,...r){s1e(e)?fve(e.key)&&(e.preventDefault(),e.stopPropagation(),e.target.click()):t.call(this,e,...r)}}function Ea(t){return(e,r)=>{e.hasOwnProperty("_messageBundleProps")||(e._messageBundleProps=e._messageBundleProps?e._messageBundleProps.slice():[]),e._messageBundleProps.push({bundlePath:t,propertyName:r})}}var o1e=function(t){return{vnodeSelector:"",properties:void 0,children:void 0,text:t.toString(),domNode:null}},pq=function(t,e){for(var r=0,i=t.length;r<i;r++){var s=t[r];Array.isArray(s)?pq(s,e):s!=null&&s!==!1&&(s.hasOwnProperty("vnodeSelector")||(s=o1e(s)),e.push(s))}},a1e=function(t,e){for(var r=[],i=2;i<arguments.length;i++)r[i-2]=arguments[i];if(r.length===1&&typeof r[0]=="string")return{vnodeSelector:t,properties:e||void 0,children:void 0,text:r[0],domNode:null};var s=[];return pq(r,s),{vnodeSelector:t,properties:e||void 0,children:s,text:void 0,domNode:null}};function L(t,e,...r){return typeof t!="function"||uS(t)?a1e(t,e??null,...r):t(e,...r)}function k4e(...t){return t}const Yd="esri-attribution",Xd={base:Yd,poweredBy:`${Yd}__powered-by`,sources:`${Yd}__sources`,open:`${Yd}--open`,sourcesOpen:`${Yd}__sources--open`,link:`${Yd}__link`};let Ii=class extends Lr{constructor(e,r){super(e,r),this._isOpen=!1,this._attributionTextOverflowed=!1,this._prevSourceNodeHeight=0,this._resizeObserver=new ResizeObserver((i=>i.forEach((({target:s})=>this._checkSourceTextOverflow(s))))),this.itemDelimiter=" | ",this.messages=null,this.viewModel=new dq}initialize(){this.addHandles(so((()=>this.viewModel?.items),"change",(()=>this.scheduleRender())))}destroy(){this._resizeObserver?.disconnect()}get _isInteractive(){return this._isOpen||this._attributionTextOverflowed}get attributionText(){return this.viewModel.items.reduce(((e,r)=>(e.includes(r.text)||e.push(r.text),e)),[]).join(this.itemDelimiter)}get icon(){return"description"}set icon(e){this._overrideIfSome("icon",e)}get label(){return this.messages?.widgetLabel??""}set label(e){this._overrideIfSome("label",e)}get view(){return this.viewModel.view}set view(e){this.viewModel.view=e}render(){const e={[Xd.open]:this._isOpen};return L("div",{bind:this,class:this.classes(Xd.base,Hr.widget,e),dir:"ltr",onclick:this._toggleState,onkeydown:this._toggleState},this._renderSourcesNode(),this._renderPoweredBy())}_renderPoweredBy(){return L("div",{class:Xd.poweredBy},"Powered by"," ",L("a",{class:Xd.link,href:"https://www.esri.com/",rel:"noreferrer",target:"_blank"},"Esri"))}_renderSourcesNode(){const e=this._isOpen,r=this._isInteractive,i=r?0:void 0,{attributionText:s}=this,n={[Xd.sourcesOpen]:e,[Hr.interactive]:r};return L("div",{afterCreate:this._afterSourcesNodeCreate,bind:this,class:this.classes(Xd.sources,n),innerHTML:s,tabIndex:i})}_afterSourcesNodeCreate(e){this._prevSourceNodeHeight=e.clientWidth,this._resizeObserver.observe(e)}_checkSourceTextOverflow(e){let r=!1;const{clientHeight:i,clientWidth:s,scrollWidth:n}=e,o=n>s,a=this._attributionTextOverflowed!==o;if(this._attributionTextOverflowed=o,a&&(r=!0),this._isOpen){const l=i<this._prevSourceNodeHeight;this._prevSourceNodeHeight=i,l&&(this._isOpen=!1,r=!0)}r&&this.scheduleRender()}_toggleState(){this._isInteractive&&(this._isOpen=!this._isOpen)}};c([d()],Ii.prototype,"_isOpen",void 0),c([d()],Ii.prototype,"_isInteractive",null),c([d()],Ii.prototype,"_attributionTextOverflowed",void 0),c([d()],Ii.prototype,"_prevSourceNodeHeight",void 0),c([d({readOnly:!0,dependsOn:["viewModel.items.length","itemDelimiter"]})],Ii.prototype,"attributionText",null),c([d()],Ii.prototype,"icon",null),c([d()],Ii.prototype,"itemDelimiter",void 0),c([d()],Ii.prototype,"label",null),c([d(),Ea("esri/widgets/Attribution/t9n/Attribution")],Ii.prototype,"messages",void 0),c([d()],Ii.prototype,"view",null),c([d({type:dq})],Ii.prototype,"viewModel",void 0),c([i1e()],Ii.prototype,"_toggleState",null),Ii=c([C("esri.widgets.Attribution")],Ii);const l1e=Ii;function u1e(){const t=z("mapview-essential-goto-duration");return t==null?t:t}function c1e(t){return t?.spatialReference?.isWebMercator||t?.spatialReference?.isGeographic||!1}function h1e(t,e,r){return t.goTo(e,r)}const d1e=t=>{let e=class extends t{constructor(...r){super(...r),this.goToOverride=null,this.view=null}callGoTo(r){const{view:i}=this;return mv(i),this.goToOverride?this.goToOverride(i,r):h1e(i,r.target,r.options)}};return c([d()],e.prototype,"goToOverride",void 0),c([d()],e.prototype,"view",void 0),e=c([C("esri.widgets.support.GoTo")],e),e};let sh=class extends d1e(ce){constructor(e){super(e),this.orientation={x:0,y:0,z:0},this.view=null,this._updateForCamera=this._updateForCamera.bind(this),this._updateForRotation=this._updateForRotation.bind(this),this._updateRotationWatcher=this._updateRotationWatcher.bind(this)}initialize(){this._watchForView(Ft)}destroy(){this.view=null}get canShowNorth(){return c1e(this.view)}get state(){return!this.view?.ready||this.view.type==="2d"&&!this.view.constraints.rotationEnabled?"disabled":this.canShowNorth?"compass":"rotation"}reset(){this.view?.ready&&(this.view?.type==="2d"?this.callGoTo({target:{rotation:0},options:{animationMode:"always",duration:u1e()}}):this.callGoTo({target:{heading:0}}))}_updateForRotation(e){e!=null&&this._set("orientation",{z:e})}_updateForCamera(e){if(!e)return;const r=-e.heading;this._set("orientation",{x:0,y:0,z:r})}_updateRotationWatcher(e){this.removeAllHandles(),this._watchForView(),e&&this.addHandles(e.type==="2d"?ie((()=>e?.rotation),this._updateForRotation,Ft):ie((()=>e?.camera),this._updateForCamera,Ft))}_watchForView(e){this.addHandles(ie((()=>this.view),this._updateRotationWatcher,e))}};c([d({readOnly:!0})],sh.prototype,"canShowNorth",null),c([d({readOnly:!0})],sh.prototype,"orientation",void 0),c([d({readOnly:!0})],sh.prototype,"state",null),c([d()],sh.prototype,"view",void 0),sh=c([C("esri.widgets.Compass.CompassViewModel")],sh);const fq=sh,MF="esri-compass",TF={base:MF,iconContainer:`${MF}__icon-container`};let el=class extends Lr{constructor(e,r){super(e,r),this.messages=null,this.viewModel=new fq,this._reset=()=>{this.viewModel.reset()},this._toRotationTransform=i=>({transform:`rotateZ(${i.z}deg)`})}loadDependencies(){return Uv({button:()=>J(()=>import("./index-DUj_Tbgt.js"),__vite__mapDeps([248,249,250,251,252,253,254,255,256,257,258,259,260])),icon:()=>J(()=>import("./index-O6rR6W0e.js").then(e=>e.i),__vite__mapDeps([252,253,254]))})}get goToOverride(){return this.viewModel.goToOverride}set goToOverride(e){this.viewModel.goToOverride=e}get icon(){return this.viewModel.state==="rotation"?"arrow-up":"compass-needle"}set icon(e){this._overrideIfSome("icon",e)}get label(){return this.messages?.widgetLabel??""}set label(e){this._overrideIfSome("label",e)}get view(){return this.viewModel.view}set view(e){this.viewModel.view=e}reset(){return this.viewModel.reset()}render(){const{orientation:e,state:r}=this.viewModel,{messages:i}=this;return L("div",{class:this.classes(TF.base,Hr.widget)},L("calcite-button",{class:Hr.widgetButton,disabled:r==="disabled",kind:"neutral",label:i.reset,onclick:this._reset,round:!0,scale:"s",title:i.reset},L("div",{"aria-hidden":"true",class:TF.iconContainer,title:i.reset},L("calcite-icon",{icon:this.icon,styles:this._toRotationTransform(e)}))))}};c([d()],el.prototype,"goToOverride",null),c([d()],el.prototype,"icon",null),c([d()],el.prototype,"label",null),c([d(),Ea("esri/widgets/Compass/t9n/Compass")],el.prototype,"messages",void 0),c([d()],el.prototype,"view",null),c([d({type:fq})],el.prototype,"viewModel",void 0),el=c([C("esri.widgets.Compass")],el);const p1e=el,EF="esri-navigation-toggle",IF={base:EF,isLayoutHorizontal:`${EF}--horizontal`};let xp=class extends ce{constructor(e){super(e),this._navigationMode="pan",this.view=null,e?.isDefaultViewModel||lK(q.getLogger(this),"Navigation Toggle","arcgis-navigation-toggle",{version:"4.33"})}normalizeCtorArgs(e={}){const{isDefaultViewModel:r,...i}=e;return i}initialize(){this.addHandles(fs((()=>this.view?.navigation?.actionMap),(()=>this._updateNavigationActionMap())))}destroy(){this.view=null}get state(){return this.view?.ready&&this.view?.type==="3d"?"ready":"disabled"}get navigationMode(){return this._navigationMode}set navigationMode(e){this._navigationMode=e,this._updateNavigationActionMap()}toggle(){this.state!=="disabled"&&(this.navigationMode=this.navigationMode!=="pan"?"pan":"rotate")}_updateNavigationActionMap(){const e=this.view?.navigation?.actionMap;if(!e)return;const r=this._navigationMode==="pan";e.dragPrimary=r?"pan":"rotate",e.dragSecondary=r?"rotate":"pan"}};c([d({readOnly:!0})],xp.prototype,"state",null),c([d()],xp.prototype,"_navigationMode",void 0),c([d()],xp.prototype,"view",void 0),xp=c([C("esri.widgets.NavigationToggle.NavigationToggleViewModel")],xp);const mq=xp;let tl=class extends Lr{constructor(e,r){super(e,r),this.messages=null,this.viewModel=new mq({isDefaultViewModel:!0}),this.toggle=()=>this.viewModel.toggle(),this._panButton=null,this._rotateButton=null,this._toggle=()=>{const i=this.viewModel?.navigationMode==="pan"?this._rotateButton:this._panButton;mve(i),this.toggle()},e?.isDefaultUI||i3(q.getLogger(this),"Navigation Toggle","arcgis-navigation-toggle",{version:"4.32"})}normalizeCtorArgs(e={}){const{isDefaultUI:r,...i}=e;return i}loadDependencies(){return Uv({button:()=>J(()=>import("./index-DUj_Tbgt.js"),__vite__mapDeps([248,249,250,251,252,253,254,255,256,257,258,259,260]))})}get icon(){return"move"}set icon(e){this._overrideIfSome("icon",e)}get label(){return this.messages?.widgetLabel??""}set label(e){this._overrideIfSome("label",e)}set layout(e){e!=="horizontal"&&(e="vertical"),this._set("layout",e)}get view(){return this.viewModel.view}set view(e){this.viewModel.view=e}render(){const e=this.viewModel?.state==="disabled",r=this.viewModel?.navigationMode==="pan",i=this.messages.toggle;return L("div",{class:this.classes(IF.base,Hr.widget,{[IF.isLayoutHorizontal]:this.layout==="horizontal"})},L("calcite-button",{afterCreate:s=>{this._panButton=s},appearance:r?"outline-fill":"solid",class:Hr.widgetButton,disabled:e,iconStart:"move",kind:"neutral",label:i,onclick:this._toggle,tabIndex:r?void 0:-1,title:i}),L("calcite-button",{afterCreate:s=>{this._rotateButton=s},appearance:r?"solid":"outline-fill",class:Hr.widgetButton,disabled:e,iconStart:"rotate",kind:"neutral",label:i,onclick:this._toggle,tabIndex:r?-1:void 0,title:i}))}};c([d()],tl.prototype,"icon",null),c([d()],tl.prototype,"label",null),c([d({value:"vertical"})],tl.prototype,"layout",null),c([d(),Ea("esri/widgets/NavigationToggle/t9n/NavigationToggle")],tl.prototype,"messages",void 0),c([d()],tl.prototype,"view",null),c([d({type:mq})],tl.prototype,"viewModel",void 0),tl=c([C("esri.widgets.NavigationToggle")],tl);const f1e=tl;let nh=class extends ce{get canZoomIn(){if(!this.view?.ready)return!1;const r=this.view?.constraints?.effectiveMaxScale;return r===0||this._scale>r}get canZoomOut(){const{view:e}=this;if(!e?.ready)return!1;const i=e.constraints?.effectiveMinScale;return i===0||this._scale<i}get _scale(){const e=this.view?.animation?.target;return(e&&"then"in e?void 0:e?.scale)??this.view?.scale??0}};c([d({readOnly:!0})],nh.prototype,"canZoomIn",null),c([d({readOnly:!0})],nh.prototype,"canZoomOut",null),c([d()],nh.prototype,"view",void 0),c([d()],nh.prototype,"_scale",null),nh=c([C("esri.widgets.Zoom.ZoomConditions2D")],nh);const m1e=nh;let $p=class extends ce{get canZoomIn(){return!!this.view.ready}get canZoomOut(){return!!this.view.ready}};c([d({readOnly:!0})],$p.prototype,"canZoomIn",null),c([d({readOnly:!0})],$p.prototype,"canZoomOut",null),c([d()],$p.prototype,"view",void 0),$p=c([C("esri.widgets.Zoom.ZoomConditions3D")],$p);const y1e=$p;let wu=class extends ce{constructor(e){super(e)}destroy(){this.view=null}get canZoomIn(){return this._zoomConditions!=null&&this._zoomConditions.canZoomIn}get canZoomOut(){return this._zoomConditions!=null&&this._zoomConditions?.canZoomOut}get state(){return this.view?.ready?"ready":"disabled"}set view(e){e?e.type==="2d"?this._zoomConditions=new m1e({view:e}):e.type==="3d"&&(this._zoomConditions=new y1e({view:e})):this._zoomConditions=null,this._set("view",e)}zoomIn(){const e=this.view;this.canZoomIn&&e&&(e.type==="2d"?e.mapViewNavigation.zoomIn():gM(e.goTo({zoomFactor:2})))}zoomOut(){const e=this.view;this.canZoomOut&&e&&(e.type==="2d"?e.mapViewNavigation.zoomOut():gM(e.goTo({zoomFactor:.5})))}};c([d()],wu.prototype,"_zoomConditions",void 0),c([d()],wu.prototype,"canZoomIn",null),c([d()],wu.prototype,"canZoomOut",null),c([d({readOnly:!0})],wu.prototype,"state",null),c([d()],wu.prototype,"view",null),wu=c([C("esri.widgets.Zoom.ZoomViewModel")],wu);const yq=wu,CF={base:"esri-zoom",horizontalLayout:"esri-zoom--horizontal"};let rl=class extends Lr{constructor(e,r){super(e,r),this.messages=null,this.viewModel=new yq,this.zoomIn=()=>this.viewModel.zoomIn(),this.zoomOut=()=>this.viewModel.zoomOut()}loadDependencies(){return Uv({button:()=>J(()=>import("./index-DUj_Tbgt.js"),__vite__mapDeps([248,249,250,251,252,253,254,255,256,257,258,259,260]))})}get icon(){return"magnifying-glass-plus"}set icon(e){this._overrideIfSome("icon",e)}get label(){return this.messages?.widgetLabel??""}set label(e){this._overrideIfSome("label",e)}set layout(e){e!=="horizontal"&&(e="vertical"),this._set("layout",e)}set view(e){this.viewModel.view=e}get view(){return this.viewModel.view}render(){const e={[CF.horizontalLayout]:this.layout==="horizontal"},{canZoomIn:r,canZoomOut:i}=this.viewModel,{zoomIn:s,zoomOut:n}=this.messages;return L("div",{class:this.classes(CF.base,Hr.widget,e)},L("calcite-button",{class:Hr.widgetButton,disabled:!r,iconStart:"plus",kind:"neutral",label:s,onclick:this.zoomIn,title:s}),L("calcite-button",{class:Hr.widgetButton,disabled:!i,iconStart:"minus",kind:"neutral",label:n,onclick:this.zoomOut,title:n}))}};c([d()],rl.prototype,"icon",null),c([d()],rl.prototype,"label",null),c([d({value:"vertical"})],rl.prototype,"layout",null),c([d(),Ea("esri/widgets/Zoom/t9n/Zoom")],rl.prototype,"messages",void 0),c([d()],rl.prototype,"view",null),c([d({type:yq})],rl.prototype,"viewModel",void 0),rl=c([C("esri.widgets.Zoom")],rl);const g1e=rl;function v1e(t){return t?.view!==void 0}let fb=class extends vve{constructor(e){super(e),this._defaultPositionLookup={attribution:"manual",compass:"top-left","navigation-toggle":"top-left",zoom:"top-left"},this.components=[],this._updateViewAwareWidgets=r=>{this.components.forEach((i=>{const s=this._find(i),n=s?.widget;v1e(n)&&(n.view=r)}))},this._componentsWatcher=(r,i)=>{this._removeComponents(i),this._addComponents(r),this._adjustPadding(r)}}initialize(){this.addHandles([ie((()=>this.components),this._componentsWatcher,Ft),ie((()=>this.view),this._updateViewAwareWidgets,Ft)])}_add(e,r,i,s,n){let o=e;if(typeof e=="string"&&this._defaultPositionLookup[e]){if(this._find(e))return;o=this._createComponent(e)}super._add(o,r,i,s,n)}_removeComponents(e){e.forEach((r=>{const i=this._find(r);i&&(this.remove(i),i.destroy())}))}_adjustPadding(e){if(!e.includes("attribution")&&!this._isOverridden("padding")){const{top:r}=this.padding;this.padding=r}}_addComponents(e){this.constructed&&e.forEach((r=>this.add(this._createComponent(r),this._defaultPositionLookup[r])))}_createComponent(e){const r=this._createWidget(e);return new hb({id:e,node:r})}_createWidget(e){const r=this.view;switch(e){case"attribution":return new l1e({view:r});case"compass":return new p1e({view:r});case"navigation-toggle":return new f1e({view:r,isDefaultUI:!0});case"zoom":return new g1e({view:r})}}};c([d()],fb.prototype,"components",void 0),fb=c([C("esri.views.ui.DefaultUI")],fb);const gq=fb;let mb=class extends gq{constructor(e){super(e),this.components=["attribution","zoom"]}};c([d()],mb.prototype,"components",void 0),mb=c([C("esri.views.ui.2d.DefaultUI2D")],mb);const vq=mb;let _q=class DI{constructor(e,r,i=""){this.major=e,this.minor=r,this._context=i}lessThan(e,r){return this.major<e||e===this.major&&this.minor<r}greaterEqual(e,r){return!this.lessThan(e,r)}validate(e){if(this.major!==e.major){const r=this._context&&this._context+":",i=this._context&&this._context+" ";throw new F(r+"unsupported-version",`Required major ${i}version is '${this.major}', but got '\${version.major}.\${version.minor}'`,{version:e})}}clone(){return new DI(this.major,this.minor,this._context)}static parse(e,r=""){const[i,s]=e.split("."),n=/^\s*\d+\s*$/;if(!i?.match||!n.test(i))throw new F((r&&r+":")+"invalid-version","Expected major version to be a number, but got '${version}'",{version:e});if(!s?.match||!n.test(s))throw new F((r&&r+":")+"invalid-version","Expected minor version to be a number, but got '${version}'",{version:e});const o=parseInt(i,10),a=parseInt(s,10);return new DI(o,a,r)}},_1e=class extends _q{constructor(e,r){super(e,r,"webmap")}};function x$(t){return t!=null&&typeof t=="object"&&"declaredClass"in t&&t.declaredClass==="esri.WebMap"}new _1e(2,34);var zI;let yb=zI=class extends W{constructor(t){super(t),this.color=new Q([0,0,0,1])}clone(){return new zI(k({color:this.color}))}};c([d({type:Q,json:{write:!0}})],yb.prototype,"color",void 0),yb=zI=c([C("esri.webmap.background.ColorBackground")],yb);const b1e=yb;let bq,wq,Sq,xq,$q,Mq,Tq;async function w1e(){const[,{GraphicsView2D:t,GraphicContainer:e,LabelManager:r,MapViewNavigation:i,MagnifierView2D:s,GridView2D:n,Stage:o}]=await Promise.all([J(()=>import("./webglDeps-DWJWwPVg.js"),__vite__mapDeps([172,173,174,175])),J(()=>import("./mapViewDeps-BG3K5zX5.js"),__vite__mapDeps([176,177,84,178,174,173,147,125,80,179,81,52,180,79,100,181,132,131,87,28,24,29,82,88,182,85,86,130,172,175,183,95,184,185,186,144,141,123,68,78,26,21,32,187,188,83,189,90,190,92,57,76,191,192,193,194,140,195]))]);wq=t,Sq=e,xq=r,$q=i,Mq=s,Tq=n,bq=o}var Wf;let je=(Wf=class extends Yye(Ime(_le(Uue(Cue(lpe))))){constructor(e){super(e),this._magnifierView=null,this._gridView=null,this.stage=null,this._resolveWhenReady=[],this.rootLayerViews=new Vo({getCollections:()=>[this.basemapView?.baseLayerViews,this.layerViews,this.basemapView?.referenceLayerViews],getChildrenFunction:()=>null}),this.featuresTilingScheme=null,this.graphicsView=null,this.labelManager=null,this.navigation=new E2({actionMap:new bA({dragTertiary:"none"})}),this.renderingOptions={samplingMode:"dynamic",edgeLabelsVisible:!0,labelsAnimationTime:125,labelCollisionsEnabled:!0},this.supersampleScreenshotsEnabled=!0,this.supportsGround=!1,this.floors=new se,this.grid=null,this.map=null,this.spatialReferenceLocked=!1,this.timeline=new RB,this.type="2d",this.view2dType=null,this.ui=new vq,this.test={takeScreenshot:async r=>H0e(this._getScreenshotView(r),r)},this.padding={top:0,right:0,bottom:0,left:0},mle()}destroy(){this.layerViewManager.clear(),this._set("preconditionsReady",!1),this.frameTask=At(this.frameTask),this.goToManager.destroy(),this.rootLayerViews.destroy(),this.inputManager.destroy(),this._set("inputManager",null)}get graphicsTileStore(){return new Wge(this.featuresTilingScheme)}get constraintsInfo(){const e=this.defaultsFromMap?.tileInfo,r=this.spatialReference;return{lods:e?.spatialReference?.equals(r)?e.lods:null,spatialReference:r}}get initialExtentRequired(){if(!this.stateManager)return!1;const{scale:e,constraints:r,center:i,viewpoint:s,extent:n}=this;let o=this.zoom;return!(this.map&&"initialViewProperties"in this.map&&this.map.initialViewProperties?.viewpoint)&&!n&&(r?.effectiveLODs||(o=-1),(!i||e===0&&o===-1)&&(s?.targetGeometry==null||s.targetGeometry.type!=="extent"&&!s.scale))}get defaultsFromMapSettings(){return{required:{extent:!1,heightModelInfo:!1,tileInfo:!0},requiresExtentInSpatialReference:this.spatialReferenceLocked}}get scheduler(){return this.frameTask.scheduler}get typeSpecificPreconditionsReady(){const e=this._getDefaultViewpoint();if(!e)return!1;const r=e.targetGeometry,i=this.spatialReference;return PU(r.spatialReference,i)}get background(){return x$(this.map)?this.map.initialViewProperties.background:null}set background(e){this._override("background",e)}get center(){return this.stateManager?.center??null}set center(e){this.stateManager.center=e}get highlightOptions(){return C0e(this)}set highlightOptions(e){P0e(this,e)}get padding(){return this.stateManager?.padding}set padding(e){this.stateManager&&(this.stateManager.padding=e)}get rendering(){return this.stage?.renderRequested??!1}get resolution(){return this.stateManager.resolution??0}get scale(){return this.stateManager?.scale??0}set scale(e){this.stateManager&&(this.stateManager.scale=e)}get tileInfo(){return this.featuresTilingScheme?.tileInfo}get updating(){const e=!(!this.magnifier.visible||this.magnifier.position===null||!this._magnifierView?.updatingHandles.updating),r=!this.destroyed&&(!this.layerViewManager||!this.labelManager||!this.graphicsView||this.layerViewManager.updating===!0||this.labelManager.updating===!0||this.graphicsView.updating===!0||this.allLayerViews.some((i=>!i.destroyed&&!("layerViews"in i)&&i.updating===!0))||e);if(z("esri-2d-log-updating")){const i=this.allLayerViews.reduce(((s,n)=>({...s,[`${n.layer.id}(${n.layer.type})`]:!n.destroyed&&!("layerViews"in n)&&n.updating})),{});console.log(`Updating MapView: ${r}
-> Null LayerViewManager: ${!this.layerViewManager}
-> Null LabelManager: ${!this.labelManager}
-> Null GraphicsView: ${!this.graphicsView}
-> layerViewManager.updating: ${this.layerViewManager?.updating}
-> labelManager.updating: ${this.labelManager?.updating}
-> graphicsView.updating: ${this.graphicsView?.updating}
-> allLayerViews: ${JSON.stringify(i)}
-> updatingMagnifier: ${e}
`)}return r}get visibleArea(){const e=this.stateManager.visibleArea;return e&&new yt({rings:[e.map((r=>[r[0],r[1]]))],spatialReference:this.spatialReference})}get zoom(){return this.stateManager.zoom??-1}set zoom(e){this.stateManager.zoom=e}get navigating(){return this.mapViewNavigation?.interacting??!1}async hitTest(e,r){return A0e(this,e,r)}async takeScreenshot(e){return q0e(this._getScreenshotView(e),e)}toScreen(e,r){return this.stateManager.toScreen(e,r)}whenLayerView(e){return super.whenLayerView(e)}graphicChanged(e){this.graphicsView&&this.graphicsView.graphicUpdateHandler(e)}whenReady(){return new Promise((e=>{this.ready?e(this):this._resolveWhenReady.push(e)}))}forceDOMReadyCycle(){this.forceReadyCycle()}getDefaultSpatialReference(){return this.map&&"initialViewProperties"in this.map&&this.map.initialViewProperties.spatialReference||this.defaultsFromMap?.spatialReference||null}getDefaultTimeZone(){return x$(this.map)?this.map.initialViewProperties.timeZone:null}getDefaultTimeExtent(){return x$(this.map)?this.map.initialViewProperties.timeExtent:null}hasLayerViewModule(e){return r5.hasLayerViewModule(e)}importLayerView(e){return r5.importLayerView(e)}pixelSizeAt(){return this.ready?this.resolution:(q.getLogger(this).error("#pixelSizeAt()","Map view cannot be used before it is ready"),null)}async popupHitTest(e){const r=this.toMap(e),i=await this.hitTest(e),s=this.allLayerViews.toArray().filter((u=>u.clips.every((h=>SB(this,h,e,r))))).reverse(),n=new globalThis.Map(s.map((u=>[u.layer.uid,u]))),o=[];let a=0,l=0;for(;a<i.results.length||l<s.length;){const u=i.results.at(a);if(u&&u.type!=="graphic"){++a;continue}const h=n.get((u?.layer??u?.graphic.layer)?.uid);if((!u||h)&&l<s.length&&s.at(l)!==h){const p=s.at(l);"fetchPopupFeaturesAtLocation"in p&&o.push({mapPoint:r,layerView:p}),++l}else u&&(o.push({graphic:u.graphic,layerView:h}),++a)}return{hits:o,location:r}}requestUpdate(){this.ready&&this.frameTask.requestUpdate()}async validate(){let e=ive(this.type);if(z("safari")&&z("safari")<9&&(e=new F("mapview:browser-not-supported","This browser is not supported by MapView (Safari < 9)",{type:"safari",requiredVersion:9,detectedVersion:z("safari")})),e!=null){q.getLogger(this).warn("#validate()",e.message);const r=document.createElement("div");r.setAttribute("style","display: flex; flex-direction: column; gap: 8px; padding: 20px; height: 100%; justify-content: center; color: black; background: white; font-family: sans-serif;");const i=document.createElement("div");i.innerHTML="Unable to display map. WebGL2 support is required.",i.setAttribute("style","font-size: 24px; font-weight: bold;");const s=document.createElement("div");s.innerHTML="Ensure that your browser and hardware meet the minimum requirements.",s.setAttribute("style","font-size: 18px;");const n=document.createElement("a");throw n.innerHTML="https://esriurl.com/systemRequirements",n.target="_blank",n.setAttribute("style","font-size: 18px;"),n.href="https://esriurl.com/systemRequirements",r.appendChild(i),r.appendChild(s),r.appendChild(n),this.surface.appendChild(r),e}}loadAsyncDependencies(){return w1e()}_getDefaultViewpoint(){const{constraints:e,initialExtent:r,map:i,padding:s,size:n}=this;if(!e)return null;const o=i&&"initialViewProperties"in i?i.initialViewProperties:void 0,a=this.stateManager.getUserStartupOptions(this.size),l=o?.viewpoint,u=l?.targetGeometry?.extent??r,h=u?.center,p=l?.rotation??0,m=l?.scale||u&&P2(u,[n[0]-s.left-s.right,n[1]-s.top-s.bottom]),y=a.center??h,g=a.rotation??p,v=a.scale??m;return y&&v?new mn({targetGeometry:y,scale:v,rotation:g}):null}_startup(){this.timeline.begin("MapView Startup");const e=this._getDefaultViewpoint();this.stateManager.startup(e,this.size,this.spatialReference,this.defaultsFromMap.extent?.center),this.graphics.owner=this;const r=new Dge(this.surface),i=new bq(this.surface,{canvas:this.renderCanvas,contextOptions:{disabledExtensions:this.deactivatedWebGLExtensions,debugWebGLExtensions:this.debugWebGLExtensions},renderingOptions:this.renderingOptions,timeline:this.timeline},r);this.stage=i,this._magnifierView=new Mq,this._magnifierView.magnifier=this.magnifier,this._gridView=new Tq;const s=new xq({view:this});this._set("labelManager",s);const n=new Ige({view:this});this._set("animationManager",n);const o=new $q({view:this,animationManager:n});this._set("mapViewNavigation",o),this._setupSpatialReferenceDependentProperties(),this.addHandles([this.rootLayerViews.on("change",(()=>this._updateStageChildren())),i.on("webgl-error",(l=>this.fatalError=l.error)),ie((()=>this.stationary),(l=>i.stationary=l),Oi),ie((()=>this.background),(l=>{i.backgroundColor=l?.color,this._magnifierView.backgroundColor=l?.color}),Oi),ie((()=>this.magnifier),(l=>this._magnifierView.magnifier=l),Oi),ie((()=>this.grid),(l=>this._gridView.grid=l),Oi),ie((()=>this.renderingOptions),(l=>i.renderingOptions=l),Oi),ie((()=>this.highlights.items.map((l=>({name:l.name,options:{fillColor:l.color,haloColor:l.haloColor,fillOpacity:l.fillOpacity,haloOpacity:l.haloOpacity,haloWidth:l.haloWidth,haloBlur:l.haloBlur}})))),(()=>{i.highlightGradient=E0e(i.highlightGradient,this.highlights.items)}),Oi),ie((()=>this.state.id),(()=>i.state=this.state),Oi)],"map-view"),this._updateStageChildren();const a=this._resolveWhenReady;this._resolveWhenReady=[],a.forEach((l=>l(this))),this.timeline.end("MapView Startup"),this.frameTask.start(),this._set("ready",!0)}_teardown(){this._destroySpatialReferenceDependentProperties(),this.removeHandles("map-view"),this.mapViewNavigation.destroy(),this._set("mapViewNavigation",null),this.animation=null,this.animationManager.destroy(),this._set("animationManager",null),this.layerViewManager.clear(),this.labelManager.destroy(),this._magnifierView.destroy(),this._gridView.destroy(),this.stage.destroy(),this.stage=null,this._set("graphicsView",null),this._magnifierView=null,this._gridView=null,this._set("labelManager",null),this._set("mapViewNavigation",null),this.graphics.owner=null,this.frameTask.stop(),this.stationaryManager.clear(),this._set("ready",!1),this.stateManager.teardown()}_updateStageChildren(){this.stage.removeAllChildren(),this.rootLayerViews.forEach((r=>{this.stage.addChild(r.container)}));const e=this.graphicsView;this.stage.addChild(e.container),this.stage.addChild(this._magnifierView),this.stage.addChild(this._gridView)}_setupSpatialReferenceDependentProperties(){const e=new kge(Yr.create({spatialReference:this.spatialReference,size:512,numLODs:36}));this._set("featuresTilingScheme",e);const r=new wq({view:this,graphics:this.graphics,requestUpdateCallback:()=>this.requestUpdate(),container:new Sq(e)});this._set("graphicsView",r)}_destroySpatialReferenceDependentProperties(){const e=this.graphicsView;this._set("graphicsView",null),e.destroy(),this._set("featuresTilingScheme",null)}_getScreenshotView(e){const{allLayerViews:r,padding:i,size:s,stage:n}=this;return{allLayerViews:r,backgroundColor:e?.ignoreBackground?null:this.background?.color,padding:i,size:s,stage:n}}_spatialReferenceChanged(e){if(this.ready){this.frameTask.stop();for(const r of this.allLayerViews)r.processDetach();this._destroySpatialReferenceDependentProperties(),this.stateManager.changeSpatialReference(e),this.stage.state=this.state,this._setupSpatialReferenceDependentProperties();for(const r of this.allLayerViews)r.processAttach();this.frameTask.requestFrame(),this.frameTask.start(),this._updateStageChildren()}}},Wf.type="2d",Wf);c([d({constructOnly:!0})],je.prototype,"deactivatedWebGLExtensions",void 0),c([d({constructOnly:!0})],je.prototype,"debugWebGLExtensions",void 0),c([d({readOnly:!0})],je.prototype,"featuresTilingScheme",void 0),c([d({readOnly:!0})],je.prototype,"graphicsTileStore",null),c([d()],je.prototype,"graphicsView",void 0),c([d()],je.prototype,"constraintsInfo",null),c([d()],je.prototype,"initialExtentRequired",null),c([d()],je.prototype,"labelManager",void 0),c([d({type:E2,nonNullable:!0})],je.prototype,"navigation",void 0),c([d({constructOnly:!0})],je.prototype,"renderCanvas",void 0),c([d()],je.prototype,"renderingOptions",void 0),c([d({constructOnly:!0})],je.prototype,"supersampleScreenshotsEnabled",void 0),c([d({readOnly:!0})],je.prototype,"supportsGround",void 0),c([d()],je.prototype,"defaultsFromMapSettings",null),c([d({readOnly:!0})],je.prototype,"typeSpecificPreconditionsReady",null),c([d({type:b1e})],je.prototype,"background",null),c([d()],je.prototype,"center",null),c([d({type:se})],je.prototype,"floors",void 0),c([d()],je.prototype,"grid",void 0),c([d({type:ec})],je.prototype,"highlightOptions",null),c([d()],je.prototype,"map",void 0),c([d()],je.prototype,"padding",null),c([d({readOnly:!0})],je.prototype,"rendering",null),c([d({readOnly:!0})],je.prototype,"resolution",null),c([d()],je.prototype,"scale",null),c([d({constructOnly:!0})],je.prototype,"spatialReferenceLocked",void 0),c([d({readOnly:!0})],je.prototype,"tileInfo",null),c([d({type:RB,readOnly:!0})],je.prototype,"timeline",void 0),c([d({readOnly:!0})],je.prototype,"type",void 0),c([d({readOnly:!0})],je.prototype,"updating",null),c([d({readOnly:!0})],je.prototype,"view2dType",void 0),c([d({readOnly:!0})],je.prototype,"visibleArea",null),c([d()],je.prototype,"zoom",null),c([d({readOnly:!0})],je.prototype,"navigating",null),c([d(),We((t=>t instanceof gq?t:km(vq,t)))],je.prototype,"ui",void 0),je=c([C("esri.views.View2D")],je);const S1e=je;let gb=class extends S1e{constructor(e){super(e),this.view2dType="map"}};c([d({readOnly:!0})],gb.prototype,"view2dType",void 0),gb=c([C("esri.views.MapView")],gb);const x1e=gb;let Hs=class extends ce{constructor(e){super(e),this._basemapCache={},this._loadingProjectionEngine=!1,this.nextBasemap=D1("hybrid",this._basemapCache),this.view=null}initialize(){ie((()=>this.nextBasemap),(e=>{e&&!e.loaded&&e.load().catch((()=>{}))}),Ft)}destroy(){this.view=null,c9(this._basemapCache),this._basemapCache=null}get _nextBasemapSpatialReferenceTask(){return $ae(this.view,this.nextBasemap)}get _viewSpatialReferenceLocked(){const{view:e}=this;return!e||!("spatialReferenceLocked"in e)||e.spatialReferenceLocked}get activeBasemap(){return D1(this.view?.map?.basemap??"topo-vector",this._basemapCache)}castNextBasemap(e){return D1(e,this._basemapCache)}get state(){const{view:e}=this;if(!e?.ready||this._nextBasemapSpatialReferenceTask.updating)return"disabled";const{spatialReference:r}=this._nextBasemapSpatialReferenceTask;return this._viewSpatialReferenceLocked&&r!=null&&!e.spatialReference.equals(r)?"incompatible-next-basemap":this._loadingProjectionEngine?"loading":"ready"}async toggle(){const{activeBasemap:e,nextBasemap:r,state:i,view:s}=this;if(!s||i==="disabled"||i==="incompatible-next-basemap")return;const n=this._viewSpatialReferenceLocked;if(!n){if(await Ev((()=>!this._nextBasemapSpatialReferenceTask.updating)),r!==this.nextBasemap||e!==this.activeBasemap)return;const{spatialReference:o}=this._nextBasemapSpatialReferenceTask;if(o==null||mr(s.spatialReference,o)||Bl()||gn(s.spatialReference,o)||(this._loadingProjectionEngine=!0,await Vl(),this._loadingProjectionEngine=!1),r!==this.nextBasemap||e!==this.activeBasemap)return}s.map.basemap=r,n||this._nextBasemapSpatialReferenceTask.spatialReference==null||mr(s.spatialReference,this._nextBasemapSpatialReferenceTask.spatialReference)||(s.spatialReference=this._nextBasemapSpatialReferenceTask.spatialReference),this.nextBasemap=e}static getThumbnailUrl(e){return u9(e)}};c([d()],Hs.prototype,"_loadingProjectionEngine",void 0),c([d({readOnly:!0})],Hs.prototype,"_nextBasemapSpatialReferenceTask",null),c([d({readOnly:!0})],Hs.prototype,"_viewSpatialReferenceLocked",null),c([d({readOnly:!0})],Hs.prototype,"activeBasemap",null),c([d()],Hs.prototype,"nextBasemap",void 0),c([We("nextBasemap")],Hs.prototype,"castNextBasemap",null),c([d({readOnly:!0})],Hs.prototype,"state",null),c([d()],Hs.prototype,"view",void 0),c([d()],Hs.prototype,"toggle",null),Hs=c([C("esri.widgets.BasemapToggle.BasemapToggleViewModel")],Hs);const Eq=Hs,kc="esri-basemap-toggle",Ey="esri-basemap-thumbnail",mo={base:kc,secondaryBasemapImage:`${kc}__image--secondary`,container:`${Ey} ${kc}__container`,image:`${Ey}__image ${kc}__image`,imageLoading:`${kc}__image--loading`,overlay:`${Ey}__overlay ${kc}__image-overlay`,title:`${Ey}__title ${kc}__title`,overlayScrim:`${Ey}__overlay-scrim`};function PF(t){const e=u9(t);return e?{backgroundImage:"url("+e+")"}:{backgroundImage:""}}const AF={title:!1};let Ws=class extends Lr{constructor(e,r){super(e,r),this.messages=null,this.viewModel=new Eq,this.visibleElements={...AF},this.toggle=()=>this.viewModel.toggle(),i3(q.getLogger(this),"Basemap Toggle","arcgis-basemap-toggle",{version:"4.32"})}loadDependencies(){return Uv({button:()=>J(()=>import("./index-DUj_Tbgt.js"),__vite__mapDeps([248,249,250,251,252,253,254,255,256,257,258,259,260])),icon:()=>J(()=>import("./index-O6rR6W0e.js").then(e=>e.i),__vite__mapDeps([252,253,254])),scrim:()=>J(()=>import("./index-C1XTlK1w.js"),__vite__mapDeps([261,249,250,251,255,254,253]))})}get activeBasemap(){return this.viewModel.activeBasemap}get icon(){return"layer-basemap"}set icon(e){this._overrideIfSome("icon",e)}get label(){return this.messages?.widgetLabel??""}set label(e){this._overrideIfSome("label",e)}get nextBasemap(){return this.viewModel.nextBasemap}set nextBasemap(e){this.viewModel.nextBasemap=e}get view(){return this.viewModel.view}set view(e){this.viewModel.view=e}castVisibleElements(e){return{...AF,...e}}render(){const e=this.viewModel,r=e.state==="disabled"?null:e.activeBasemap,i=e.state==="disabled"?null:e.nextBasemap,s=e.state==="loading",n=e.state==="incompatible-next-basemap",o=i?.title??"",a=i&&i.loadStatus!=="loaded";let l;const u=this.visibleElements.title&&o,h=n;return(u||h)&&(l=L("div",{class:mo.overlay,key:"overlay"},u?L("span",{class:mo.title,title:o},o):null,h?L("calcite-scrim",{class:mo.overlayScrim,title:this.messages.incompatibleSpatialReference},L("calcite-icon",{icon:"exclamation-mark-triangle"})):null)),L("div",{class:this.classes(mo.base,Hr.widget)},L("calcite-button",{appearance:"transparent","data-basemap-id":i?i.id:"",disabled:n,kind:"neutral",label:this.label,onclick:()=>{this.toggle()},title:this.label},L("div",{class:this.classes(mo.container,mo.secondaryBasemapImage)},L("div",{class:mo.image,styles:PF(r)})),L("div",{class:mo.container},L("div",{class:this.classes(mo.image,a?mo.imageLoading:null),styles:PF(i)},a||s?L("calcite-scrim",null,L("span",{"aria-hidden":"true",class:Hr.loaderAnimation,role:"presentation"})):null),l)))}};c([d({readOnly:!0})],Ws.prototype,"activeBasemap",null),c([d()],Ws.prototype,"icon",null),c([d()],Ws.prototype,"label",null),c([d(),Ea("esri/widgets/BasemapToggle/t9n/BasemapToggle")],Ws.prototype,"messages",void 0),c([d()],Ws.prototype,"nextBasemap",null),c([d()],Ws.prototype,"view",null),c([d({type:Eq})],Ws.prototype,"viewModel",void 0),c([d()],Ws.prototype,"visibleElements",void 0),c([We("visibleElements")],Ws.prototype,"castVisibleElements",null),Ws=c([C("esri.widgets.BasemapToggle")],Ws);const $1e=Ws;function M1e(t){const e="metric";if(t==null)return e;const r=t.map,i=(r&&"portalItem"in r?r.portalItem?.portal:null)??Y.getDefault();switch(i.user?.units??i.units){case e:return e;case"english":return"imperial"}return Dee(t.spatialReference)??e}const T1e={readOnly:!0,get(){return M1e(this.view)}},Mi="esri-scale-bar",gt={base:Mi,labelContainer:`${Mi}__label-container`,rulerLabelContainer:`${Mi}__label-container--ruler`,lineLabelContainer:`${Mi}__label-container--line`,topLabelContainer:`${Mi}__label-container--top`,bottomLabelContainer:`${Mi}__label-container--bottom`,label:`${Mi}__label`,line:`${Mi}__line`,topLine:`${Mi}__line--top`,bottomLine:`${Mi}__line--bottom`,ruler:`${Mi}__ruler`,rulerBlock:`${Mi}__ruler-block`,barContainer:`${Mi}__bar-container`,rulerBarContainer:`${Mi}__bar-container--ruler`,lineBarContainer:`${Mi}__bar-container--line`};function Iq(t){if(!t)return null;const e=t.wkid;if(e)return Nne[e];const r=t.wkt2??t.wkt;return r?E1e(r):null}function E1e(t){const e=kne.exec(t);if(!e||e.length!==2)return null;const r=e[1].split(",");if(!r||r.length<3)return null;const i=parseFloat(r[1]),s=parseFloat(r[2]);return isNaN(i)||isNaN(s)?null:{a:i,f:s===0?0:1/s}}function z2(t){const e=Iq(t);if(I1e(e))return e;const r=e.a*(1-e.f);return Object.assign(e,{b:r,eSq:1-(r/e.a)**2,radius:(2*e.a+r)/3,densificationRatio:1e4/((2*e.a+r)/3)})}function I1e(t){return t!=null&&"b"in t&&"eSq"in t&&"radius"in t}function N_(t,e,r){const{a:i,eSq:s}=z2(r),n=Math.sqrt(s),o=Math.sin(e[1]*ns),a=i*e[0]*ns;let l;return s>0?l=i*((1-s)*(o/(1-s*(o*o))-1/(2*n)*Math.log((1-n*o)/(1+n*o))))*.5:l=i*o,t[0]=a,t[1]=l,t}function Gv(t){return Td(t)&&!!Iq(t)}function Y4e(t,e="square-meters"){if(t.some((o=>!Gv(o.spatialReference))))throw new F("geodesic-areas:invalid-spatial-reference","the input geometries spatial reference is not supported");const r=[];for(let o=0;o<t.length;o++){const a=t[o],l=a.spatialReference,{radius:u,densificationRatio:h}=z2(l),p=u*h;r.push(P1e(a,p))}const i=[],s=[0,0],n=[0,0];for(let o=0;o<r.length;o++){const{rings:a,spatialReference:l}=r[o];let u=0;for(let h=0;h<a.length;h++){const p=a[h];N_(s,p[0],l),N_(n,p[p.length-1],l);let m=n[0]*s[1]-s[0]*n[1];for(let y=0;y<p.length-1;y++)N_(s,p[y+1],l),N_(n,p[y],l),m+=n[0]*s[1]-s[0]*n[1];u+=m}u=ut(u,"square-meters",e),i.push(u/-2)}return i}function C1e(t,e="meters"){if(!t)throw new F("geodesic-lengths:invalid-geometries","the input geometries type is not supported");if(t.some((i=>!Gv(i.spatialReference))))throw new F("geodesic-lengths:invalid-spatial-reference","the input geometries spatial reference is not supported");const r=[];for(let i=0;i<t.length;i++){const s=t[i],{spatialReference:n}=s,o=s.type==="polyline"?s.paths:s.rings;let a=0;for(let l=0;l<o.length;l++){const u=o[l];let h=0;for(let p=1;p<u.length;p++){const m=u[p-1][0],y=u[p][0],g=u[p-1][1],v=u[p][1];if(g!==v||m!==y){const _=new Cq;Pq(_,[m,g],[y,v],n),h+=_.distance}}a+=h}a=ut(a,"meters",e),r.push(a)}return r}function P1e(t,e){if(t.type!=="polyline"&&t.type!=="polygon")throw new F("geodesic-densify:invalid-geometry","the input geometry is neither polyline nor polygon");const{spatialReference:r}=t;if(!Gv(r))throw new F("geodesic-densify:invalid-spatial-reference","the input geometry spatial reference is not supported");const i=t.type==="polyline"?t.paths:t.rings,s=[],n=[0,0],o=new Cq;for(const l of i){const u=[];s.push(u),u.push([l[0][0],l[0][1]]);let h,p,m=l[0][0],y=l[0][1];for(let g=0;g<l.length-1;g++){if(h=l[g+1][0],p=l[g+1][1],m===h&&y===p)continue;const v=[m,y];Pq(o,[m,y],[h,p],r);const{azimuth:_,distance:b}=o,S=b/e;if(S>1){for(let $=1;$<=S-1;$++)$$(n,v,_,$*e,r),u.push(n.slice());$$(n,v,_,(b+Math.floor(S-1)*e)/2,r),u.push(n.slice())}$$(n,v,_,b,r),u.push(n.slice()),m=n[0],y=n[1]}}const a=km(ne,r);return t.type==="polyline"?new er({paths:s,spatialReference:a}):new yt({rings:s,spatialReference:a})}let Cq=class{constructor(e=0,r=void 0,i=void 0){this.distance=e,this.azimuth=r,this.reverseAzimuth=i}};function $$(t,e,r,i,s){const n=e[0],o=e[1],a=n*ns,l=o*ns,u=(r??0)*ns,{a:h,b:p,f:m}=z2(s),y=Math.sin(u),g=Math.cos(u),v=(1-m)*Math.tan(l),_=1/Math.sqrt(1+v*v),b=v*_,S=Math.atan2(v,g),$=_*y,T=$*$,I=1-T,P=I*(h*h-p*p)/(p*p),R=1+P/16384*(4096+P*(P*(320-175*P)-768)),D=P/1024*(256+P*(P*(74-47*P)-128));let V,U,Z,X=i/(p*R),le=2*Math.PI;for(;Math.abs(X-le)>1e-12;)Z=Math.cos(2*S+X),V=Math.sin(X),U=Math.cos(X),le=X,X=i/(p*R)+D*V*(Z+D/4*(U*(2*Z*Z-1)-D/6*Z*(4*V*V-3)*(4*Z*Z-3)));const ee=b*V-_*U*g,ke=Math.atan2(b*U+_*V*g,(1-m)*Math.sqrt(T+ee*ee)),Ze=m/16*I*(4+m*(4-3*I)),it=Math.atan2(V*y,_*U-b*V*g)-(1-Ze)*m*$*(X+Ze*V*(Z+Ze*U*(2*Z*Z-1)));return t[0]=(a+it)/ns,t[1]=ke/ns,t}function Pq(t,e,r,i){const s=e[0]*ns,n=e[1]*ns,o=r[0]*ns,a=r[1]*ns,{a:l,b:u,f:h,radius:p}=z2(i),m=o-s,y=Math.atan((1-h)*Math.tan(n)),g=Math.atan((1-h)*Math.tan(a)),v=Math.sin(y),_=Math.cos(y),b=Math.sin(g),S=Math.cos(g);let $,T,I,P,R,D,V,U,Z,X,le=1e3,ee=m;do{if(V=Math.sin(ee),U=Math.cos(ee),I=Math.sqrt(S*V*(S*V)+(_*b-v*S*U)*(_*b-v*S*U)),I===0)return t.distance=0,t.azimuth=void 0,t.reverseAzimuth=void 0,t;R=v*b+_*S*U,D=Math.atan2(I,R),Z=_*S*V/I,T=1-Z*Z,P=R-2*v*b/T,isNaN(P)&&(P=0),X=h/16*T*(4+h*(4-3*T)),$=ee,ee=m+(1-X)*h*Z*(D+X*I*(P+X*R*(2*P*P-1)))}while(Math.abs(ee-$)>1e-12&&--le>0);if(le===0){const ho=p,Hi=Math.acos(Math.sin(n)*Math.sin(a)+Math.cos(n)*Math.cos(a)*Math.cos(o-s))*ho,po=o-s,Aa=Math.sin(po)*Math.cos(a),Od=Math.cos(n)*Math.sin(a)-Math.sin(n)*Math.cos(a)*Math.cos(po),La=Math.atan2(Aa,Od);return t.azimuth=La/ns,t.distance=Hi,t.reverseAzimuth=void 0,t}const ke=T*(l*l-u*u)/(u*u),Ze=ke/1024*(256+ke*(ke*(74-47*ke)-128)),it=u*(1+ke/16384*(4096+ke*(ke*(320-175*ke)-768)))*(D-Ze*I*(P+Ze/4*(R*(2*P*P-1)-Ze/6*P*(4*I*I-3)*(4*P*P-3)))),ze=Math.atan2(S*Math.sin(ee),_*b-v*S*Math.cos(ee)),zt=Math.atan2(_*Math.sin(ee),_*b*Math.cos(ee)-v*S);return t.azimuth=ze/ns,t.distance=it,t.reverseAzimuth=zt/ns,t}function K4e(t){return Gv(t)?t:lo(t)?ne.WGS84:null}function A1e(t){return t!=null&&typeof t=="object"&&t.type==="2d"&&t.view2dType==="linkchart"}function L1e(t){return t>.5?{min:.5,max:1}:t>.2?{min:.2,max:.5}:{min:.1,max:.2}}function R1e(t,e){switch(e){case"metric":return t>1e3?{distance:ut(t,"meters","kilometers"),unit:"kilometer"}:t>1?{distance:t,unit:"meter"}:t>.01?{distance:ut(t,"meters","centimeters"),unit:"centimeter"}:{distance:ut(t,"meters","millimeters"),unit:"millimeter"};case"imperial":return t>1609.344?{distance:ut(t,"meters","miles"),unit:"mile"}:t>.3048?{distance:ut(t,"meters","feet"),unit:"foot"}:{distance:ut(t,"meters","inches"),unit:"inch"}}}function k1e(t){const{isWebMercator:e,wkt:r,wkt2:i}=t;return e||((i||r)?.includes("WGS_1984_Web_Mercator")??!1)}function LF({state:{paddedViewState:t},spatialReference:e,width:r}){return e.isWrappable&&t.worldScreenWidth<r}function RF(t,e){const{x:r,y:i}=t?Oh(e,!0):e;return[r,i]}let Mp=class extends ce{constructor(e){super(e),this.scaleComputedFrom=or(),this.view=null}get state(){return this.view?.ready&&this.view.type==="2d"?A1e(this.view)&&!this.view.inGeographicLayout?"disabled":"ready":"disabled"}getScaleBarProperties(e,r){if(this.state==="disabled"||isNaN(e)||!r||!this.view)return null;const i=this._getDistanceInMeters();return i==null?null:this._getScaleBarProps(e,i,r)}_getDistanceInMeters(){const{state:e,spatialReference:r}=this.view;if(!as(r))return null;const{isGeographic:i}=r,s=k1e(r);if(!i&&!s)return e.extent.width*(aj(r)??1);const[n,o]=this._getScaleMeasuringPoints(),a=s||i&&!Gv(r)?ne.WGS84:r,l=new er({paths:[[RF(s,n),RF(s,o)]],spatialReference:a}),u=v7(l,10);let h;try{[h]=C1e([u],"meters")}catch{return null}return h}_getScaleMeasuringPoints(){const e=this.view,{width:r,height:i,position:s,spatialReference:n}=e;if(LF(e)){const u=Si(n),{valid:h}=u;return[new ge(h[0],0,n),new ge(h[1],0,n)]}let o=this.scaleComputedFrom.y-s[1];o>i?o=i:o<0&&(o=0);const a=or(0,o),l=or(r,o);return[e.toMap(a),e.toMap(l)]}_getScaleBarProps(e,r,i){const s=this.view,n=e*r/(LF(s)?s.state.paddedViewState.worldScreenWidth:s.width);if(n<.001)return null;const o=R1e(n,i),{distance:a,unit:l}=o;let u=a,h=0;for(;u>=1;)u/=10,h++;const{min:p,max:m}=L1e(u),y=m/u>=u/p?p:m;return{length:e*(y/u),value:10**h*y,unit:l}}};c([d()],Mp.prototype,"scaleComputedFrom",void 0),c([d({readOnly:!0})],Mp.prototype,"state",null),c([d()],Mp.prototype,"view",void 0),Mp=c([C("esri.widgets.ScaleBar.ScaleBarViewModel")],Mp);const O1e=Mp;function kF(t,e){return uc(t,{style:"unit",unit:e,unitDisplay:"short"})}let Nn=class extends Lr{constructor(e,r){super(e,r),this.messages=null,this.style="line",this.viewModel=new O1e,i3(q.getLogger(this),"Scale Bar","arcgis-scale-bar",{version:"4.32"})}initialize(){this.addHandles(ie((()=>{const{view:e}=this;return[e?.stationary,e?.center,e?.scale,e?.zoom]}),(([e])=>{e&&this.scheduleRender()})))}get icon(){return"actual-size"}set icon(e){this._overrideIfSome("icon",e)}get label(){return this.messages?.widgetLabel??""}set label(e){this._overrideIfSome("label",e)}get unit(){return this._defaultUnit}set unit(e){this._overrideIfSome("unit",e)}get view(){return this.viewModel.view}set view(e){this.viewModel.view=e}render(){const e=this.viewModel.state==="disabled",r={[Hr.disabled]:e};let i,s;if(!e){const{unit:n,style:o}=this,a=n==="metric"||n==="dual",l=100,u=n==="dual"?"line":o;if(n==="imperial"||n==="dual"){const h=this.viewModel.getScaleBarProperties(l,"imperial");h&&(s=u==="ruler"?this._renderRuler(h):this._renderLine(h,"bottom"))}if(a){const h=this.viewModel.getScaleBarProperties(l,"metric");h&&(i=u==="ruler"?this._renderRuler(h):this._renderLine(h,"top"))}}return L("div",{afterCreate:this._handleRootCreateOrUpdate,afterUpdate:this._handleRootCreateOrUpdate,bind:this,class:this.classes(gt.base,Hr.widget,r)},i,s)}_renderRuler(e){const{length:r,unit:i,value:s}=e,n=Math.round(r),o=kF(s,i);return L("div",{class:this.classes(gt.barContainer,gt.rulerBarContainer),key:gt.rulerBarContainer},L("div",{class:gt.ruler,styles:{width:`${n}px`}},L("div",{class:gt.rulerBlock}),L("div",{class:gt.rulerBlock}),L("div",{class:gt.rulerBlock}),L("div",{class:gt.rulerBlock})),L("div",{class:this.classes(gt.labelContainer,gt.rulerLabelContainer)},L("div",{class:gt.label},"0"),L("div",{class:gt.label},o)))}_renderLine(e,r){const{length:i,unit:s,value:n}=e,o=Math.round(i),a=kF(n,s),l={[gt.topLabelContainer]:r==="top",[gt.bottomLabelContainer]:r==="bottom"},u=L("div",{class:this.classes(gt.labelContainer,gt.lineLabelContainer,l),key:gt.labelContainer},L("div",{class:gt.label},a)),h={[gt.topLine]:r==="top",[gt.bottomLine]:r==="bottom"},p=L("div",{class:this.classes(gt.line,h),key:gt.line,styles:{width:`${o}px`}});return L("div",{class:this.classes(gt.barContainer,gt.lineBarContainer),key:gt.lineBarContainer},[p,u])}_handleRootCreateOrUpdate(e){if(!this.viewModel)return;const{scaleComputedFrom:r}=this.viewModel,i=e.getBoundingClientRect(),s=i.left+window.pageXOffset,n=i.top+window.pageYOffset,o=or(s,n);(o.x!==r.x||o.y!==r.y)&&(this.viewModel.scaleComputedFrom=o)}};c([d(T1e)],Nn.prototype,"_defaultUnit",void 0),c([d()],Nn.prototype,"icon",null),c([d()],Nn.prototype,"label",null),c([d(),Ea("esri/widgets/ScaleBar/t9n/ScaleBar")],Nn.prototype,"messages",void 0),c([d({type:["ruler","line"]})],Nn.prototype,"style",void 0),c([d({type:["metric","imperial","dual"]})],Nn.prototype,"unit",null),c([d()],Nn.prototype,"view",null),c([d()],Nn.prototype,"viewModel",void 0),Nn=c([C("esri.widgets.ScaleBar")],Nn);const N1e=Nn;function OF(t,e){const r=t.featureReduction;return r&&r.type!=="selection"&&(!("maxScale"in r)||!r.maxScale||r.maxScale<e.scale)?r:null}let NF=class extends SyntaxError{constructor(e,r,i,s){super(e),this.expected=r,this.found=i,this.location=s,this.name="SyntaxError"}format(e){let r="Error: "+this.message;if(this.location){let i=null;const s=e.find((l=>l.source===this.location.source));s&&(i=s.text.split(/\r\n|\n|\r/g));const n=this.location.start,o=this.location.source&&typeof this.location.source.offset=="function"?this.location.source.offset(n):n,a=this.location.source+":"+o.line+":"+o.column;if(i){const l=this.location.end,u="".padEnd(o.line.toString().length," "),h=i[n.line-1],p=(n.line===l.line?l.column:h.length+1)-n.column||1;r+=`
 --> `+a+`
`+u+` |
`+o.line+" | "+h+`
`+u+" | "+"".padEnd(n.column-1," ")+"".padEnd(p,"^")}else r+=`
 at `+a}return r}static buildMessage(e,r){function i(m){return m.codePointAt(0).toString(16).toUpperCase()}const s=Object.prototype.hasOwnProperty.call(RegExp.prototype,"unicode")?new RegExp("[\\p{C}\\p{Mn}\\p{Mc}]","gu"):null;function n(m){return s?m.replace(s,(y=>"\\u{"+i(y)+"}")):m}function o(m){return n(m.replace(/\\/g,"\\\\").replace(/"/g,'\\"').replace(/\0/g,"\\0").replace(/\t/g,"\\t").replace(/\n/g,"\\n").replace(/\r/g,"\\r").replace(/[\x00-\x0F]/g,(y=>"\\x0"+i(y))).replace(/[\x10-\x1F\x7F-\x9F]/g,(y=>"\\x"+i(y))))}function a(m){return n(m.replace(/\\/g,"\\\\").replace(/\]/g,"\\]").replace(/\^/g,"\\^").replace(/-/g,"\\-").replace(/\0/g,"\\0").replace(/\t/g,"\\t").replace(/\n/g,"\\n").replace(/\r/g,"\\r").replace(/[\x00-\x0F]/g,(y=>"\\x0"+i(y))).replace(/[\x10-\x1F\x7F-\x9F]/g,(y=>"\\x"+i(y))))}const l={literal:m=>'"'+o(m.text)+'"',class(m){const y=m.parts.map((g=>Array.isArray(g)?a(g[0])+"-"+a(g[1]):a(g)));return"["+(m.inverted?"^":"")+y.join("")+"]"+(m.unicode?"u":"")},any:()=>"any character",end:()=>"end of input",other:m=>m.description};function u(m){return l[m.type](m)}function h(m){const y=m.map(u);if(y.sort(),y.length>0){let g=1;for(let v=1;v<y.length;v++)y[v-1]!==y[v]&&(y[g]=y[v],g++);y.length=g}switch(y.length){case 1:return y[0];case 2:return y[0]+" or "+y[1];default:return y.slice(0,-1).join(", ")+", or "+y[y.length-1]}}function p(m){return m?'"'+o(m)+'"':"end of input"}return"Expected "+h(e)+" but "+p(r)+" found."}};function F1e(t,e){const r={},i=(e=e!==void 0?e:{}).grammarSource,s={start:WL};let n=WL;const o="none",a=")",l=",",u="(",h="%",p="px",m="cm",y="mm",g="in",v="pt",_="pc",b="deg",S="rad",$="grad",T="turn",I="#",P=".",R="e",D=/^[ \t\n\r]/,V=/^[a-z\-]/,U=/^[0-9a-fA-F]/,Z=/^[+\-]/,X=/^[0-9]/,le=Jl("none"),ee=Rr("none",!1),ke=Rr(")",!1),Ze=Rr(",",!1),it=Qm([" ","	",`
`,"\r"],!1,!1,!1),ze=Jl("function"),zt=Rr("(",!1),ho=Jl("identifier"),Hi=Qm([["a","z"],"-"],!1,!1,!1),po=Jl("percentage"),Aa=Rr("%",!1),Od=Jl("length"),La=Rr("px",!1),Nd=Rr("cm",!1),TJ=Rr("mm",!1),EJ=Rr("in",!1),IJ=Rr("pt",!1),CJ=Rr("pc",!1),PJ=Jl("angle"),AJ=Rr("deg",!1),LJ=Rr("rad",!1),RJ=Rr("grad",!1),kJ=Rr("turn",!1),OJ=Jl("number"),NJ=Jl("color"),FJ=Rr("#",!1),GL=Qm([["0","9"],["a","f"],["A","F"]],!1,!1,!1),BL=Qm(["+","-"],!1,!1,!1),Zl=Qm([["0","9"]],!1,!1,!1),DJ=Rr(".",!1),zJ=Rr("e",!1);function VJ(){return[]}function jJ(A,G){return{type:"function",name:A,parameters:G||[]}}function UJ(A,G){return G.length>0?wY(A,G,3):[A]}function GJ(A){return{type:"quantity",value:A.value,unit:A.unit}}function BJ(A){return{type:"color",colorType:A.type,value:A.value}}function KAe(A){return A}function qJ(){return Qv()}function HJ(A){return{value:A,unit:"%"}}function WJ(A){return{value:A,unit:"px"}}function ZJ(A){return{value:A,unit:"cm"}}function JJ(A){return{value:A,unit:"mm"}}function YJ(A){return{value:A,unit:"in"}}function XJ(A){return{value:A,unit:"pt"}}function KJ(A){return{value:A,unit:"pc"}}function QJ(A){return{value:A,unit:"deg"}}function eY(A){return{value:A,unit:"rad"}}function tY(A){return{value:A,unit:"grad"}}function rY(A){return{value:A,unit:"turn"}}function iY(A){return{value:A,unit:null}}function sY(){return{type:"hex",value:Qv()}}function nY(A){return{type:"function",value:A}}function oY(){return{type:"named",value:Qv()}}function aY(){return parseFloat(Qv())}let B=0|e.peg$currPos,Rt=B;const Fd=[{line:1,column:1}];let Km,wn=B,Kv=e.peg$maxFailExpected||[],ve=0|e.peg$silentFails;if(e.startRule){if(!(e.startRule in s))throw new Error(`Can't start parsing from rule "`+e.startRule+'".');n=s[e.startRule]}function Qv(){return t.substring(Rt,B)}function lY(A=B){const G=t.codePointAt(A);return G===void 0?"":String.fromCodePoint(G)}function Rr(A,G){return{type:"literal",text:A,ignoreCase:G}}function Qm(A,G,te,Te){return{type:"class",parts:A,inverted:G,ignoreCase:te,unicode:Te}}function uY(){return{type:"end"}}function Jl(A){return{type:"other",description:A}}function qL(A){let G,te=Fd[A];if(te)return te;if(A>=Fd.length)G=Fd.length-1;else for(G=A;!Fd[--G];);for(te=Fd[G],te={line:te.line,column:te.column};G<A;)t.charCodeAt(G)===10?(te.line++,te.column=1):te.column++,G++;return Fd[A]=te,te}function HL(A,G,te){const Te=qL(A),nt=qL(G);return{source:i,start:{offset:A,line:Te.line,column:Te.column},end:{offset:G,line:nt.line,column:nt.column}}}function Oe(A){B<wn||(B>wn&&(wn=B,Kv=[]),Kv.push(A))}function cY(A,G,te){return new NF(NF.buildMessage(A,G),A,G,te)}function WL(){let A;return A=hY(),A===r&&(A=dY()),A}function hY(){let A,G;return ve++,A=B,kr(),t.substr(B,4)===o?(G=o,B+=4):(G=r,ve===0&&Oe(ee)),G!==r?(kr(),Rt=A,A=VJ()):(B=A,A=r),ve--,A===r&&ve===0&&Oe(le),A}function dY(){let A,G;if(A=[],G=ax(),G!==r)for(;G!==r;)A.push(G),G=ax();else A=r;return A}function ax(){let A,G,te,Te;return A=B,kr(),G=fY(),G!==r?(kr(),te=pY(),te===r&&(te=null),kr(),t.charCodeAt(B)===41?(Te=a,B++):(Te=r,ve===0&&Oe(ke)),Te!==r?(kr(),Rt=A,A=jJ(G,te)):(B=A,A=r)):(B=A,A=r),A}function pY(){let A,G,te,Te,nt,Ht,wr,ni;if(A=B,G=lx(),G!==r){for(te=[],Te=B,nt=kr(),t.charCodeAt(B)===44?(Ht=l,B++):(Ht=r,ve===0&&Oe(Ze)),Ht===r&&(Ht=null),wr=kr(),ni=lx(),ni!==r?(nt=[nt,Ht,wr,ni],Te=nt):(B=Te,Te=r);Te!==r;)te.push(Te),Te=B,nt=kr(),t.charCodeAt(B)===44?(Ht=l,B++):(Ht=r,ve===0&&Oe(Ze)),Ht===r&&(Ht=null),wr=kr(),ni=lx(),ni!==r?(nt=[nt,Ht,wr,ni],Te=nt):(B=Te,Te=r);Rt=A,A=UJ(G,te)}else B=A,A=r;return A}function lx(){let A,G;return A=B,G=mY(),G===r&&(G=yY(),G===r&&(G=gY(),G===r&&(G=vY()))),G!==r&&(Rt=A,G=GJ(G)),A=G,A===r&&(A=B,G=_Y(),G!==r&&(Rt=A,G=BJ(G)),A=G),A}function kr(){let A,G;for(ve++,A=[],G=t.charAt(B),D.test(G)?B++:(G=r,ve===0&&Oe(it));G!==r;)A.push(G),G=t.charAt(B),D.test(G)?B++:(G=r,ve===0&&Oe(it));return ve--,A}function fY(){let A,G,te;return ve++,A=B,G=ZL(),G!==r?(t.charCodeAt(B)===40?(te=u,B++):(te=r,ve===0&&Oe(zt)),te!==r?(Rt=A,A=G):(B=A,A=r)):(B=A,A=r),ve--,A===r&&(G=r,ve===0&&Oe(ze)),A}function ZL(){let A,G,te;if(ve++,A=B,G=[],te=t.charAt(B),V.test(te)?B++:(te=r,ve===0&&Oe(Hi)),te!==r)for(;te!==r;)G.push(te),te=t.charAt(B),V.test(te)?B++:(te=r,ve===0&&Oe(Hi));else G=r;return G!==r&&(Rt=A,G=qJ()),A=G,ve--,A===r&&(G=r,ve===0&&Oe(ho)),A}function mY(){let A,G,te;return ve++,A=B,kr(),G=Ds(),G!==r?(t.charCodeAt(B)===37?(te=h,B++):(te=r,ve===0&&Oe(Aa)),te!==r?(Rt=A,A=HJ(G)):(B=A,A=r)):(B=A,A=r),ve--,A===r&&ve===0&&Oe(po),A}function yY(){let A,G,te;return ve++,A=B,kr(),G=Ds(),G!==r?(t.substr(B,2)===p?(te=p,B+=2):(te=r,ve===0&&Oe(La)),te!==r?(Rt=A,A=WJ(G)):(B=A,A=r)):(B=A,A=r),A===r&&(A=B,kr(),G=Ds(),G!==r?(t.substr(B,2)===m?(te=m,B+=2):(te=r,ve===0&&Oe(Nd)),te!==r?(Rt=A,A=ZJ(G)):(B=A,A=r)):(B=A,A=r),A===r&&(A=B,kr(),G=Ds(),G!==r?(t.substr(B,2)===y?(te=y,B+=2):(te=r,ve===0&&Oe(TJ)),te!==r?(Rt=A,A=JJ(G)):(B=A,A=r)):(B=A,A=r),A===r&&(A=B,kr(),G=Ds(),G!==r?(t.substr(B,2)===g?(te=g,B+=2):(te=r,ve===0&&Oe(EJ)),te!==r?(Rt=A,A=YJ(G)):(B=A,A=r)):(B=A,A=r),A===r&&(A=B,kr(),G=Ds(),G!==r?(t.substr(B,2)===v?(te=v,B+=2):(te=r,ve===0&&Oe(IJ)),te!==r?(Rt=A,A=XJ(G)):(B=A,A=r)):(B=A,A=r),A===r&&(A=B,kr(),G=Ds(),G!==r?(t.substr(B,2)===_?(te=_,B+=2):(te=r,ve===0&&Oe(CJ)),te!==r?(Rt=A,A=KJ(G)):(B=A,A=r)):(B=A,A=r)))))),ve--,A===r&&ve===0&&Oe(Od),A}function gY(){let A,G,te;return ve++,A=B,G=Ds(),G!==r?(t.substr(B,3)===b?(te=b,B+=3):(te=r,ve===0&&Oe(AJ)),te!==r?(Rt=A,A=QJ(G)):(B=A,A=r)):(B=A,A=r),A===r&&(A=B,G=Ds(),G!==r?(t.substr(B,3)===S?(te=S,B+=3):(te=r,ve===0&&Oe(LJ)),te!==r?(Rt=A,A=eY(G)):(B=A,A=r)):(B=A,A=r),A===r&&(A=B,G=Ds(),G!==r?(t.substr(B,4)===$?(te=$,B+=4):(te=r,ve===0&&Oe(RJ)),te!==r?(Rt=A,A=tY(G)):(B=A,A=r)):(B=A,A=r),A===r&&(A=B,G=Ds(),G!==r?(t.substr(B,4)===T?(te=T,B+=4):(te=r,ve===0&&Oe(kJ)),te!==r?(Rt=A,A=rY(G)):(B=A,A=r)):(B=A,A=r)))),ve--,A===r&&(G=r,ve===0&&Oe(PJ)),A}function vY(){let A,G;return ve++,A=B,kr(),G=Ds(),G!==r?(Rt=A,A=iY(G)):(B=A,A=r),ve--,A===r&&ve===0&&Oe(OJ),A}function _Y(){let A,G,te,Te;if(ve++,A=B,t.charCodeAt(B)===35?(G=I,B++):(G=r,ve===0&&Oe(FJ)),G!==r){if(te=[],Te=t.charAt(B),U.test(Te)?B++:(Te=r,ve===0&&Oe(GL)),Te!==r)for(;Te!==r;)te.push(Te),Te=t.charAt(B),U.test(Te)?B++:(Te=r,ve===0&&Oe(GL));else te=r;te!==r?(Rt=A,A=sY()):(B=A,A=r)}else B=A,A=r;return A===r&&(A=B,G=ax(),G!==r&&(Rt=A,G=nY(G)),A=G,A===r&&(A=B,G=ZL(),G!==r&&(Rt=A,G=oY()),A=G)),ve--,A===r&&(G=r,ve===0&&Oe(NJ)),A}function Ds(){let A,G,te,Te,nt,Ht,wr,ni;for(A=B,G=t.charAt(B),Z.test(G)?B++:(G=r,ve===0&&Oe(BL)),G===r&&(G=null),te=B,Te=[],nt=t.charAt(B),X.test(nt)?B++:(nt=r,ve===0&&Oe(Zl));nt!==r;)Te.push(nt),nt=t.charAt(B),X.test(nt)?B++:(nt=r,ve===0&&Oe(Zl));if(t.charCodeAt(B)===46?(nt=P,B++):(nt=r,ve===0&&Oe(DJ)),nt!==r){if(Ht=[],wr=t.charAt(B),X.test(wr)?B++:(wr=r,ve===0&&Oe(Zl)),wr!==r)for(;wr!==r;)Ht.push(wr),wr=t.charAt(B),X.test(wr)?B++:(wr=r,ve===0&&Oe(Zl));else Ht=r;Ht!==r?(Te=[Te,nt,Ht],te=Te):(B=te,te=r)}else B=te,te=r;if(te===r)if(te=[],Te=t.charAt(B),X.test(Te)?B++:(Te=r,ve===0&&Oe(Zl)),Te!==r)for(;Te!==r;)te.push(Te),Te=t.charAt(B),X.test(Te)?B++:(Te=r,ve===0&&Oe(Zl));else te=r;if(te!==r){if(Te=B,t.charCodeAt(B)===101?(nt=R,B++):(nt=r,ve===0&&Oe(zJ)),nt!==r){if(Ht=t.charAt(B),Z.test(Ht)?B++:(Ht=r,ve===0&&Oe(BL)),Ht===r&&(Ht=null),wr=[],ni=t.charAt(B),X.test(ni)?B++:(ni=r,ve===0&&Oe(Zl)),ni!==r)for(;ni!==r;)wr.push(ni),ni=t.charAt(B),X.test(ni)?B++:(ni=r,ve===0&&Oe(Zl));else wr=r;wr!==r?(nt=[nt,Ht,wr],Te=nt):(B=Te,Te=r)}else B=Te,Te=r;Te===r&&(Te=null),Rt=A,A=aY()}else B=A,A=r;return A}function bY(A,G){return A.map((function(te){return te[G]}))}function wY(A,G,te){return[A].concat(bY(G,te))}Km=n();const ux=Km!==r&&B===t.length;function JL(){throw Km!==r&&B<t.length&&Oe(uY()),cY(Kv,wn<t.length?lY(wn):null,wn<t.length?HL(wn,wn+1):HL(wn,wn))}return e.peg$library?{peg$result:Km,peg$currPos:B,peg$FAILED:r,peg$maxFailExpected:Kv,peg$maxFailPos:wn,peg$success:ux,peg$throw:ux?void 0:JL}:ux?Km:void JL()}function GA(t){if(!t||t.length===0)return null;if(typeof t=="string"){const r=FF(t);return r&&r.length!==0?r:null}const e=t.map((r=>{if(!Number.isFinite(r.scale)||r.scale<=0)throw new F("effect:invalid-scale","scale must be finite and greater than 0",{stop:r});return{scale:r.scale,effects:FF(r.value)}}));e.sort(((r,i)=>i.effects.length-r.effects.length));for(let r=0;r<e.length-1;r++){if(!n9(e[r].effects,e[r+1].effects))throw new F("effect:interpolation-impossible","Cannot interpolate by scale between 2 lists of mixed effects",{a:e[r].effects,b:e[r+1].effects});o9(e[r].effects,e[r+1].effects)}return e.sort(((r,i)=>i.scale-r.scale)),e}function FF(t){let e;if(!t)return[];try{e=F1e(t)}catch(r){throw new F("effect:invalid-syntax","Invalid effect syntax",{value:t,error:r})}return e.map((r=>D1e(r)))}function D1e(t){try{switch(t.name){case"grayscale":case"sepia":case"saturate":case"invert":case"brightness":case"contrast":return z1e(t);case"opacity":return V1e(t);case"hue-rotate":return j1e(t);case"blur":return U1e(t);case"drop-shadow":return G1e(t);case"bloom":return B1e(t)}}catch(e){throw e.details.filter=t,e}throw new F("effect:unknown-effect",`Effect '${t.name}' is not supported`,{effect:t})}function z1e(t){let e=1;return Hm(t.parameters,1),t.parameters.length===1&&(e=Wn(t.parameters[0])),new ET(t.name,e)}function V1e(t){let e=1;return Hm(t.parameters,1),t.parameters.length===1&&(e=Wn(t.parameters[0])),new i9(e)}function j1e(t){let e=0;return Hm(t.parameters,1),t.parameters.length===1&&(e=Y1e(t.parameters[0])),new t9(e)}function U1e(t){let e=0;return Hm(t.parameters,1),t.parameters.length===1&&(e=HA(t.parameters[0]),Bv(e,t.parameters[0])),new YU(e)}function G1e(t){const e=[];let r=null;for(const i of t.parameters)if(i.type==="color"){if(e.length&&Object.freeze(e),r)throw new F("effect:type-error","Accepts only one color",{});r=X1e(i)}else{const s=HA(i);if(Object.isFrozen(e))throw new F("effect:type-error","<length> parameters not consecutive",{lengths:e});e.push(s),e.length===3&&Bv(s,i)}if(e.length<2||e.length>3)throw new F("effect:type-error",`Expected <length>{2,3}, Actual: <length>{${e.length}}`,{lengths:e});return new QU(e[0],e[1],e[2]||0,r||Aq("black"))}function B1e(t){let e=1,r=0,i=0;return Hm(t.parameters,3),t.parameters[0]&&(e=Wn(t.parameters[0])),t.parameters[1]&&(r=HA(t.parameters[1]),Bv(r,t.parameters[1])),t.parameters[2]&&(i=Wn(t.parameters[2])),new ZU(e,r,i)}function Hm(t,e){if(t.length>e)throw new F("effect:type-error",`Function supports up to ${e} parameters, Actual: ${t.length}`,{parameters:t})}function V2(t){if(t.type==="color")return"<color>";if(t.unit){if(t.unit in qA)return"<length>";if(t.unit in BA)return"<angle>";if(t.unit==="%")return"<percentage>"}return"<double>"}function Bv(t,e){if(t<0)throw new F("effect:type-error",`Negative values are not allowed, Actual: ${t}`,{term:e})}function q1e(t){if(t.type!=="quantity"||t.unit!==null)throw new F("effect:type-error",`Expected <double>, Actual: ${V2(t)}`,{term:t})}function H1e(t){if(t.type!=="quantity"||t.unit!==null&&t.unit!=="%")throw new F("effect:type-error",`Expected <double> or <percentage>, Actual: ${V2(t)}`,{term:t})}const BA={deg:1,grad:.9,rad:180/Math.PI,turn:360};function W1e(t){if(t.type!=="quantity"||!(t.value===0&&t.unit===null||t.unit&&BA[t.unit]!=null))throw new F("effect:type-error",`Expected <angle>, Actual: ${V2(t)}`,{term:t})}const qA={px:1,cm:96/2.54,mm:96/2.54/10,in:96,pc:16,pt:96/72};function Z1e(t){if(t.type!=="quantity"||!(t.value===0&&t.unit===null||t.unit&&qA[t.unit]!=null))throw new F("effect:type-error",`Expected <length>, Actual: ${V2(t)}`,{term:t})}function Wn(t){H1e(t);const e=t.value;return Bv(e,t),t.unit==="%"?.01*e:e}function J1e(t){return q1e(t),Bv(t.value,t),t.value}function Y1e(t){return W1e(t),t.value*BA[t.unit]||0}function HA(t){return Z1e(t),t.value*qA[t.unit]||0}function X1e(t){switch(t.colorType){case"hex":return yse(t.value);case"named":return Aq(t.value);case"function":return ebe(t.value)}}function Aq(t){if(!O8(t))throw new F("effect:unknown-color",`color '${t}' isn't valid`,{namedColor:t});return mse(t)}const K1e=/^rgba?/i,Q1e=/^hsla?/i;function ebe(t){if(Hm(t.parameters,4),K1e.test(t.name))return[Wn(t.parameters[0]),Wn(t.parameters[1]),Wn(t.parameters[2]),t.parameters[3]?Wn(t.parameters[3]):1];if(Q1e.test(t.name))return N8(J1e(t.parameters[0]),Wn(t.parameters[1]),Wn(t.parameters[2]),t.parameters[3]?Wn(t.parameters[3]):1);throw new F("effect:syntax-error",`Invalid color function '${t.name}'`,{colorFunction:t})}const X0=-1;let Fn=class extends ce{constructor(e){super(e),this._from=null,this._to=null,this._final=null,this._current=[],this._time=0,this.duration=z("mapview-transitions-duration"),this.effects=[]}set effect(e){if(this._get("effect")!==(e=e||"")){this._set("effect",e);try{this._transitionTo(DF(e))}catch(r){this._transitionTo([]),q.getLogger(this).warn("Invalid Effect",{effect:e,error:r})}}}get final(){return this._final}get hasEffects(){return this.transitioning||!!this.effects.length}set scale(e){this._updateForScale(e)}get transitioning(){return this._to!==null}canTransitionTo(e){try{return this.scale>0&&zF(this._current,DF(e),this.scale)}catch{return!1}}transitionStep(e,r){this._applyTimeTransition(e),this._updateForScale(r)}endTransition(){this._applyTimeTransition(this.duration)}_transitionTo(e){this.scale>0&&zF(this._current,e,this.scale)?(this._final=e,this._to=k(e),tbe(this._current,this._to,this.scale),this._from=k(this._current),this._time=0):(this._from=this._to=this._final=null,this._current=e),this._set("effects",this._current[0]?k(this._current[0].effects):[])}_applyTimeTransition(e){if(!(this._to&&this._from&&this._current&&this._final))return;this._time+=e;const r=Math.min(1,this._time/this.duration);for(let i=0;i<this._current.length;i++){const s=this._current[i],n=this._from[i],o=this._to[i];s.scale=rbe(n.scale,o.scale,r);for(let a=0;a<s.effects.length;a++){const l=s.effects[a],u=n.effects[a],h=o.effects[a];l.interpolate(u,h,r)}}r===1&&(this._current=this._final,this._set("effects",this._current[0]?k(this._current[0].effects):[]),this._from=this._to=this._final=null)}_updateForScale(e){if(this._set("scale",e),this._current.length===0)return;const r=this._current,i=this._current.length-1;let s,n,o=1;if(r.length===1||e>=r[0].scale)n=s=r[0].effects;else if(e<=r[i].scale)n=s=r[i].effects;else for(let a=0;a<i;a++){const l=r[a],u=r[a+1];if(l.scale>=e&&u.scale<=e){o=(e-l.scale)/(u.scale-l.scale),s=l.effects,n=u.effects;break}}for(let a=0;a<this.effects.length;a++)this.effects[a].interpolate(s[a],n[a],o)}};function DF(t){const e=GA(t)||[];return ibe(e)?[{scale:X0,effects:e}]:e}function zF(t,e,r){return!t[0]?.effects||!e[0]?.effects?!0:!((t[0]?.scale===X0||e[0]?.scale===X0)&&(t.length>1||e.length>1)&&r<=0)&&n9(t[0].effects,e[0].effects)}function tbe(t,e,r){const i=t.length>e.length?t:e,s=t.length>e.length?e:t,n=s[s.length-1],o=n?.scale??r,a=n?.effects??[];for(let l=s.length;l<i.length;l++)s.push({scale:o,effects:[...a]});for(let l=0;l<i.length;l++)s[l].scale=s[l].scale===X0?r:s[l].scale,i[l].scale=i[l].scale===X0?r:i[l].scale,o9(s[l].effects,i[l].effects)}function rbe(t,e,r){return t+(e-t)*r}function ibe(t){const e=t[0];return!!e&&"type"in e}c([d()],Fn.prototype,"_to",void 0),c([d()],Fn.prototype,"duration",void 0),c([d({value:""})],Fn.prototype,"effect",null),c([d({readOnly:!0})],Fn.prototype,"effects",void 0),c([d({readOnly:!0})],Fn.prototype,"final",null),c([d({readOnly:!0})],Fn.prototype,"hasEffects",null),c([d({value:0})],Fn.prototype,"scale",null),c([d({readOnly:!0})],Fn.prototype,"transitioning",null),Fn=c([C("esri.layers.effects.EffectView")],Fn);function K0(t,e,r){try{return nbe(t)}catch(i){r?.messages?.push(i)}return null}function Q0(t,e,r,i){try{const s=sbe(t);Cr(r,s,e)}catch(s){i.messages&&i.messages.push(s)}}function sbe(t){const e=GA(t);return e?wae(e)?e.map((r=>r.toJSON())):e.map((({scale:r,effects:i})=>({scale:r,value:i.map((s=>s.toJSON()))}))):null}function nbe(t){if(!t||t.length===0)return null;if(obe(t)){const e=[];for(const r of t)e.push({scale:r.scale,value:cS(r.value)});return e}return cS(t)}function obe(t){const e=t[0];return!!e&&"scale"in e}function cS(t){if(!t?.length)return"";const e=[];for(const r of t){let i=[];switch(r.type){case"grayscale":case"sepia":case"saturate":case"invert":case"brightness":case"contrast":case"opacity":i=[za(r,"amount")];break;case"blur":i=[za(r,"radius","pt")];break;case"hue-rotate":i=[za(r,"angle","deg")];break;case"drop-shadow":i=[za(r,"xoffset","pt"),za(r,"yoffset","pt"),za(r,"blurRadius","pt"),abe(r,"color")];break;case"bloom":i=[za(r,"strength"),za(r,"radius","pt"),za(r,"threshold")]}const s=`${r.type}(${i.filter(Boolean).join(" ")})`;GA(s),e.push(s)}return e.join(" ")}function za(t,e,r){if(t[e]==null)throw new F("effect:missing-parameter",`Missing parameter '${e}' in ${t.type} effect`,{effect:t});return r?t[e]+r:""+t[e]}function abe(t,e){if(t[e]==null)throw new F("effect:missing-parameter",`Missing parameter '${e}' in ${t.type} effect`,{effect:t});const r=t[e];return`rgba(${r[0]||0}, ${r[1]||0}, ${r[2]||0}, ${r[3]/255||0})`}function lbe(t,e){return{...e,filterMode:t.mode}}function ube(t,e){return Lq(t,e).next().value??null}function i6e(t,e,r){const i=cbe(t);if(i&&(G8(e,i[0])||fT(r,i[1])))return"";const s=Array.from(Lq(t,e,r)),n=hbe(s,e,r)?"1=1":s.map((o=>o.where||"1=1")).reduce(((o,a)=>Wue(o,a)),"");return n&&n!=="1=1"?n:""}function cbe(t){if(Rq(t)==="manual")return null;const e=[Number.NEGATIVE_INFINITY,Number.POSITIVE_INFINITY];for(const{minScale:r,maxScale:i}of t.filters)e[0]=Math.max(e[0],ev(r)),e[1]=Math.min(e[1],hS(i));return e}function*Lq(t,e,r){if(Rq(t)==="manual"){const i=t.filters.find((s=>s.id===t.activeFilterId));i&&(yield i)}else{typeof e=="object"&&(e=e.scale);for(const i of t.filters)dbe(i.minScale,i.maxScale,e,r)&&(yield i)}}function hbe(t,e,r){if(t.length===0)return!0;const i=ev(t.at(0)?.minScale),s=hS(t.at(-1)?.maxScale);if(fT(i,e)||G8(s,r))return!0;for(let n=0;n<t.length-1;n++){const o=t[n],a=t[n+1];if(fT(ev(a.minScale),hS(o.maxScale)))return!0}return!1}function dbe(t,e,r,i){return t=ev(t),r=ev(r),e=hS(e),!(!no(r,t)&&(i??r)>t)&&!_se(e,r)&&(i===void 0||!no(i,t))}function Rq(t){return"mode"in t?t.mode:t.filterMode}function ev(t){return t||Number.POSITIVE_INFINITY}function hS(t){return t||0}const kq=96;function s6e(t,e){const r=t.extent,i=t.width,s=vn(r?.spatialReference);return r&&i?r.width/i*s*rj*kq:0}function n6e(t,e){return t/(vn(e)*rj*kq)}function pbe(t,e,r){return fbe(t,e)&&mbe(t,r)}function fbe(t,e){return e===0||no(t,e)||t<e}function mbe(t,e){return e===0||no(t,e)||t>e}function ybe(t,e){return no(t,e)?0:(t||Number.POSITIVE_INFINITY)>(e||Number.POSITIVE_INFINITY)?1:-1}function o6e(t){const e=t.layer;return"floorInfo"in e&&e.floorInfo?.floorField&&"floors"in t.view?Oq(t.view.floors,e.floorInfo.floorField):null}function VF(t,e){return"floorInfo"in e&&e.floorInfo?.floorField?Oq(t,e.floorInfo.floorField):null}function Oq(t,e){if(!t?.length)return null;const r=t.filter((i=>i!=="")).map((i=>`'${i}'`));return r.push("''"),`${e} IN (${r.join(",")}) OR ${e} IS NULL`}function a6e(t,e,r){return e.flatten((({sublayers:s})=>s)).length!==t.length?!0:!!t.some((s=>s.originIdOf("minScale")>r||s.originIdOf("maxScale")>r||s.originIdOf("renderer")>r||s.originIdOf("labelingInfo")>r||s.originIdOf("opacity")>r||s.originIdOf("labelsVisible")>r||s.originIdOf("source")>r))||!Nq(t,e)}function gbe(t,e,r){return!!t.some((i=>{const s=i.source,n=!s||s.type==="map-layer"&&s.mapLayerId===i.id&&(s.gdbVersion==null||s.gdbVersion===r);i.commitProperty("renderer"),i.commitProperty("labelingInfo"),i.commitProperty("opacity"),i.commitProperty("labelsVisible"),i.commitProperty("orderBy");const o=i.layer?.capabilities?.exportMap?.supportsSublayerOrderBy??!1;return!n||i.originIdOf("renderer")>xe.SERVICE||i.originIdOf("labelingInfo")>xe.SERVICE||i.originIdOf("opacity")>xe.SERVICE||i.originIdOf("labelsVisible")>xe.SERVICE||o&&i.originIdOf("orderBy")>xe.SERVICE}))||!Nq(t,e)}function Nq(t,e){if(!t?.length||e==null)return!0;const r=e.slice().reverse().flatten((({sublayers:n})=>n&&n.toArray().reverse())).map((n=>n.id)).toArray();if(t.length>r.length)return!1;let i=0;const s=r.length;for(const{id:n}of t){for(;i<s&&r[i]!==n;)i++;if(i>=s)return!1}return!0}function l6e(t){return!!t&&t.some((e=>e.minScale!=null||e.layerDefinition?.minScale!=null))}const vbe={visible:"visibleSublayers",definitionExpression:"layerDefs",labelingInfo:"hasDynamicLayers",labelsVisible:"hasDynamicLayers",opacity:"hasDynamicLayers",minScale:"visibleSublayers",maxScale:"visibleSublayers",renderer:"hasDynamicLayers",source:"hasDynamicLayers"};let Zs=class extends ce{constructor(e){super(e),this.floors=null,this.scale=0}destroy(){this.layer=null}get dynamicLayers(){if(!this.hasDynamicLayers)return null;const e=this.visibleSublayers.map((r=>{const i=VF(this.floors,r);return r.toExportImageJSON(i)}));return e.length?JSON.stringify(e):null}get hasDynamicLayers(){return this.layer&&gbe(this.visibleSublayers,this.layer.serviceSublayers,this.layer.gdbVersion)}set layer(e){this._get("layer")!==e&&(this._set("layer",e),this.removeHandles("layer"),e&&this.addHandles([e.allSublayers.on("change",(()=>this.notifyChange("visibleSublayers"))),e.on("sublayer-update",(r=>this.notifyChange(vbe[r.propertyName])))],"layer"))}get layers(){const e=this.visibleSublayers;return e?e.length?"show:"+e.map((r=>r.id)).join(","):"show:-1":null}get layerDefs(){const e=!!this.floors?.length,r=this.visibleSublayers.filter((i=>i.definitionExpression!=null||e&&i.floorInfo!=null));return r.length?JSON.stringify(r.reduce(((i,s)=>{const n=VF(this.floors,s),o=H9(n,s.definitionExpression);return o!=null&&(i[s.id]=o),i}),{})):null}get version(){this.commitProperty("layers"),this.commitProperty("layerDefs"),this.commitProperty("dynamicLayers");const e=this.layer;return e&&(e.commitProperty("dpi"),e.commitProperty("imageFormat"),e.commitProperty("imageTransparency"),e.commitProperty("gdbVersion")),(this._get("version")||0)+1}get visibleSublayers(){const e=[];if(!this.layer)return e;const r=this.layer.sublayers,i=this.scale,s=o=>{o.visible&&(i===0||pbe(i,o.minScale,o.maxScale))&&(o.sublayers?o.sublayers.forEach(s):e.unshift(o))};r&&r.forEach(s);const n=this._get("visibleSublayers");return!n||n.length!==e.length||n.some(((o,a)=>e[a]!==o))?e:n}toJSON(){const e=this.layer;let r={dpi:e.dpi,format:e.imageFormat,transparent:e.imageTransparency,gdbVersion:e.gdbVersion||null};return this.hasDynamicLayers&&this.dynamicLayers?r.dynamicLayers=this.dynamicLayers:r={...r,layers:this.layers,layerDefs:this.layerDefs},r}};c([d({readOnly:!0})],Zs.prototype,"dynamicLayers",null),c([d()],Zs.prototype,"floors",void 0),c([d({readOnly:!0})],Zs.prototype,"hasDynamicLayers",null),c([d()],Zs.prototype,"layer",null),c([d({readOnly:!0})],Zs.prototype,"layers",null),c([d({readOnly:!0})],Zs.prototype,"layerDefs",null),c([d({type:Number})],Zs.prototype,"scale",void 0),c([d({readOnly:!0})],Zs.prototype,"version",null),c([d({readOnly:!0})],Zs.prototype,"visibleSublayers",null),Zs=c([C("esri.layers.support.ExportImageParameters")],Zs);const _be=9999999e31,bbe=2e-7,wbe={u1:[0,1],u2:[0,3],u4:[0,15],u8:[0,255],s8:[-128,127],u16:[0,65535],s16:[-32768,32767],u32:[0,4294967295],s32:[-2147483648,2147483647],f32:[-34028234663852886e22,34028234663852886e22],f64:[-Number.MAX_VALUE,Number.MAX_VALUE],unknown:void 0,c64:void 0,c128:void 0};function dS(t){return wbe[t]??[-34028234663852886e22,34028234663852886e22]}const Sbe={u1:1,u2:1,u4:1,u8:1,s8:1,u16:2,s16:2,u32:4,s32:4,f32:4,f64:8,unknown:4,c64:16,c128:32};function xbe(t){return Sbe[t]}function c6e(t){return xbe(t.pixelType)*t.bandCount}function h6e(t,e){return t==null||e==null?"s32":t<0?t>=-128&&e<128?"s8":t>=-32768&&e<32768?"s16":"s32":e<256?"u8":e<65536?"u16":"u32"}function $be(t){return(t?.startsWith("s")||t?.startsWith("u"))??!1}function d6e(t,e,r,i){let[s,n]=dS(r);const o=$be(r);return o&&(s-=1e-5,n+=1e-5),o?r.startsWith("u")?Mbe(t,e,i,[s,n]):Tbe(t,e,i,[s,n]):Ebe(t,e,i,[s,n])}function p6e(t,e){for(let r=0;r<e.length;r++)e[r]&&isNaN(t[r])&&(e[r]=0,t[r]=0)}function Mbe(t,e,r,i){const[s,n]=i;for(let o=0;o<e.length;o++)if(e[o]){const a=t[o];a<s||a>n?e[o]=0:r[o]=a+.5|0}}function Tbe(t,e,r,i){const[s,n]=i;for(let o=0;o<e.length;o++)if(e[o]){const a=t[o];a<s||a>n?e[o]=0:r[o]=a+(a>0?.5:-.5)|0}}function Ebe(t,e,r,i){const[s,n]=i;for(let o=0;o<e.length;o++)if(e[o]){const a=t[o];a<s||a>n?e[o]=0:r[o]=a}}function f6e(t,e,r){if(t.depthCount&&t.depthCount>1)return;const{pixels:i,statistics:s,pixelType:n}=t,o=i[0].length,a=t.bandMasks??[],l=t.mask??new Uint8Array(o).fill(255),u=n==="f32"||n==="f64",h=dS(n);let p=!1;for(let y=0;y<i.length;y++){const g=typeof e=="number"?e:e[y];if(g==null)continue;const v=s?.[y]?.minValue??h[0],_=s?.[y]?.maxValue??h[1];if(v>g+Number.EPSILON||_<g-Number.EPSILON)continue;const b=a[y]||l.slice(),S=i[y],$=r?.customFloatTolerance;if(u&&$!==0){let T=$;T||(T=Math.abs(g)>=_be?bbe*Math.abs(g):n==="f32"?2**-23:Number.EPSILON);for(let I=0;I<S.length;I++)b[I]&&Math.abs(S[I]-g)<T&&(S[I]=0,b[I]=0,l[I]=0,p=!0)}else for(let T=0;T<S.length;T++)b[T]&&S[T]===g&&(S[T]=0,b[T]=0,l[T]=0,p=!0);a[y]=b}if(p){const y=t.bandMasks||t.pixels.length>1?a:null;r?.matchAllNoData?t.mask=y&&y.length>1?m(y):l:(t.bandMasks=y,t.mask=l)}function m(y){if(y.length<2)return y[0];const g=y[0].length,v=new Uint8Array(g).fill(0);for(let _=0;_<y.length;_++){const b=y[_];for(let S=0;S<g;S++)b[S]&&(v[S]=255)}return v}p&&"updateStatistics"in t&&t.updateStatistics()}var VI;let Mg=VI=class extends W{constructor(t){super(t),this.minValue=0,this.maxValue=0}clone(){return new VI({minValue:this.minValue,maxValue:this.maxValue})}};c([d({type:Number,json:{write:!0}})],Mg.prototype,"minValue",void 0),c([d({type:Number,json:{write:!0}})],Mg.prototype,"maxValue",void 0),Mg=VI=c([C("esri.renderers.support.AuthoringInfoClassBreakInfo")],Mg);var jI;let Ru=jI=class extends W{constructor(t){super(t),this.field="",this.normalizationField="",this.label="",this.classBreakInfos=new Array}clone(){return new jI({field:this.field,normalizationField:this.normalizationField,label:this.label,classBreakInfos:k(this.classBreakInfos)})}};c([d({type:String,json:{write:!0}})],Ru.prototype,"field",void 0),c([d({type:String,json:{write:!0}})],Ru.prototype,"normalizationField",void 0),c([d({type:String,json:{write:!0}})],Ru.prototype,"label",void 0),c([d({type:[Mg],json:{write:!0}})],Ru.prototype,"classBreakInfos",void 0),Ru=jI=c([C("esri.renderers.support.AuthoringInfoFieldInfo")],Ru);var UI;let Tp=UI=class extends W{constructor(t){super(t),this.label=null,this.size=null,this.value=null}clone(){return new UI({label:this.label,value:this.value,size:this.size})}};c([d({type:String,json:{write:!0}})],Tp.prototype,"label",void 0),c([d({type:Number,json:{write:!0}})],Tp.prototype,"size",void 0),c([d({type:Number,json:{write:!0}})],Tp.prototype,"value",void 0),Tp=UI=c([C("esri.renderers.support.AuthoringInfoSizeStop")],Tp);const Ibe=Tp;var GI;const F_=new De({percentTotal:"percent-of-total",ratio:"ratio",percent:"percent"}),D_=new De({sizeInfo:"size",colorInfo:"color",transparencyInfo:"opacity",rotationInfo:"rotation"}),jF={key:t=>typeof t=="number"?"number":"string",typeMap:{number:Number,string:String},base:null},UF=["high-to-low","above-and-below","centered-on","extremes"],GF=[...new Set(["high-to-low","above-and-below","centered-on","extremes","above","below","high-to-low","above-and-below","above","below","reference-size","spike"])],BF=["seconds","minutes","hours","days","months","years"],Cbe=["circle","diamond","hexagon-flat","hexagon-pointy","square"],Pbe=["triangle-closed-outline","triangle-gradient-fill-closed","triangle-gradient-fill-closed-outline","triangle-gradient-fill-open","triangle-gradient-fill-open-outline","triangle-open-outline","triangle-solid-fill-closed","triangle-solid-fill-closed-outline","triangle-solid-fill-open","triangle-solid-fill-open-outline"];let Sr=GI=class extends W{constructor(t){super(t),this.endTime=null,this.field=null,this.maxSliderValue=null,this.minSliderValue=null,this.startTime=null,this.type=null,this.units=null}castEndTime(t){return typeof t=="string"||typeof t=="number"?t:null}get normalizationField(){return this.theme==="reference-size"||this.theme==="spike"?this._get("normalizationField"):null}set normalizationField(t){this._set("normalizationField",t)}get referenceSizeScale(){return this.theme==="reference-size"?this._get("referenceSizeScale"):null}set referenceSizeScale(t){this._set("referenceSizeScale",t)}get referenceSizeSymbolStyle(){return this.theme==="reference-size"?this._get("referenceSizeSymbolStyle"):null}set referenceSizeSymbolStyle(t){this._set("referenceSizeSymbolStyle",t)}get spikeSymbolStyle(){return this.theme==="spike"?this._get("spikeSymbolStyle"):null}set spikeSymbolStyle(t){this._set("spikeSymbolStyle",t)}castStartTime(t){return typeof t=="string"||typeof t=="number"?t:null}get sizeStops(){return this.theme==="reference-size"||this.theme==="spike"?this._get("sizeStops"):null}set sizeStops(t){this._set("sizeStops",t)}get style(){return this.type==="color"?this._get("style"):null}set style(t){this._set("style",t)}get theme(){return this.type==="color"||this.type==="size"?this._get("theme")||"high-to-low":null}set theme(t){this._set("theme",t)}clone(){return new GI({endTime:this.endTime,field:this.field,maxSliderValue:this.maxSliderValue,minSliderValue:this.minSliderValue,normalizationField:this.normalizationField,referenceSizeScale:this.referenceSizeScale,referenceSizeSymbolStyle:this.referenceSizeSymbolStyle,spikeSymbolStyle:this.spikeSymbolStyle,sizeStops:k(this.sizeStops),startTime:this.startTime,style:this.style,theme:this.theme,type:this.type,units:this.units})}};c([d({types:jF,json:{write:!0}})],Sr.prototype,"endTime",void 0),c([We("endTime")],Sr.prototype,"castEndTime",null),c([d({type:String,json:{write:!0}})],Sr.prototype,"field",void 0),c([d({type:Number,json:{write:!0}})],Sr.prototype,"maxSliderValue",void 0),c([d({type:Number,json:{write:!0}})],Sr.prototype,"minSliderValue",void 0),c([d({type:String,json:{origins:{"web-scene":{write:!1}},write:!0}})],Sr.prototype,"normalizationField",null),c([d({type:Number,value:null,json:{origins:{"web-scene":{write:!1}},write:!0}})],Sr.prototype,"referenceSizeScale",null),c([d({type:Cbe,value:null,json:{origins:{"web-scene":{write:!1}},write:!0}})],Sr.prototype,"referenceSizeSymbolStyle",null),c([d({type:Pbe,value:null,json:{origins:{"web-scene":{write:!1}},write:!0}})],Sr.prototype,"spikeSymbolStyle",null),c([d({types:jF,json:{write:!0}})],Sr.prototype,"startTime",void 0),c([We("startTime")],Sr.prototype,"castStartTime",null),c([d({type:[Ibe],json:{origins:{"web-scene":{write:!1}},write:!0}})],Sr.prototype,"sizeStops",null),c([d({type:F_.apiValues,value:null,json:{type:F_.jsonValues,read:F_.read,write:F_.write}})],Sr.prototype,"style",null),c([d({type:GF,value:null,json:{type:GF,origins:{"web-scene":{type:UF,write:{writer:(t,e)=>{UF.includes(t)&&(e.theme=t)}}}},write:!0}})],Sr.prototype,"theme",null),c([d({type:D_.apiValues,json:{type:D_.jsonValues,read:D_.read,write:D_.write}})],Sr.prototype,"type",void 0),c([d({type:BF,json:{type:BF,write:!0}})],Sr.prototype,"units",void 0),Sr=GI=c([C("esri.renderers.support.AuthoringInfoVisualVariable")],Sr);const Abe=Sr;let Ef=class extends W{constructor(e){super(e),this.type=null}};c([d({readOnly:!0,json:{read:!1,write:!0}})],Ef.prototype,"type",void 0),Ef=c([C("esri.rest.support.ColorRamp")],Ef);var BI;let wl=BI=class extends Ef{constructor(t){super(t),this.algorithm=null,this.fromColor=null,this.toColor=null,this.type="algorithmic"}clone(){return new BI({fromColor:k(this.fromColor),toColor:k(this.toColor),algorithm:this.algorithm})}};c([ye({esriCIELabAlgorithm:"cie-lab",esriHSVAlgorithm:"hsv",esriLabLChAlgorithm:"lab-lch"})],wl.prototype,"algorithm",void 0),c([d({type:Q,json:{type:[qe],write:!0}})],wl.prototype,"fromColor",void 0),c([d({type:Q,json:{type:[qe],write:!0}})],wl.prototype,"toColor",void 0),c([d({type:["algorithmic"]})],wl.prototype,"type",void 0),wl=BI=c([C("esri.rest.support.AlgorithmicColorRamp")],wl);var qI;let sf=qI=class extends Ef{constructor(t){super(t),this.colorRamps=null,this.type="multipart"}clone(){return new qI({colorRamps:k(this.colorRamps)})}};c([d({type:[wl],json:{write:!0}})],sf.prototype,"colorRamps",void 0),c([d({type:["multipart"]})],sf.prototype,"type",void 0),sf=qI=c([C("esri.rest.support.MultipartColorRamp")],sf);const Lbe={key:"type",base:Ef,typeMap:{algorithmic:wl,multipart:sf}};function Rbe(t){return t?.type?t.type==="algorithmic"?wl.fromJSON(t):t.type==="multipart"?sf.fromJSON(t):null:null}var HI;const Oc=new De({esriClassifyDefinedInterval:"defined-interval",esriClassifyEqualInterval:"equal-interval",esriClassifyManual:"manual",esriClassifyNaturalBreaks:"natural-breaks",esriClassifyQuantile:"quantile",esriClassifyStandardDeviation:"standard-deviation"}),z_=new De({classedSize:"class-breaks-size",classedColor:"class-breaks-color",univariateColorSize:"univariate-color-size",relationship:"relationship",predominance:"predominance",dotDensity:"dot-density",flow:"flow"}),qF=new De({classedSize:"class-breaks-size",classedColor:"class-breaks-color",univariateColorSize:"univariate-color-size",relationship:"relationship",predominance:"predominance",dotDensity:"dot-density"}),HF=["inches","feet","yards","miles","nautical-miles","millimeters","centimeters","decimeters","meters","kilometers"],kbe=["high-to-low","above-and-below","above","below"],Obe=["flow-line","wave-front"],Nbe=["caret","circle-caret","arrow","circle-arrow","plus-minus","circle-plus-minus","square","circle","triangle","happy-sad","thumb","custom"];let Tt=HI=class extends W{constructor(t){super(t),this.colorRamp=null,this.fadeRatio=null,this.isAutoGenerated=!1,this.lengthUnit=null,this.maxSliderValue=null,this.minSliderValue=null,this.visualVariables=null}get classificationMethod(){const t=this._get("classificationMethod"),e=this.type;return e&&e!=="relationship"?e==="class-breaks-size"||e==="class-breaks-color"?t||"manual":null:t}set classificationMethod(t){this._set("classificationMethod",t)}readColorRamp(t){return t?Rbe(t):void 0}get fields(){return this.type&&this.type!=="predominance"?null:this._get("fields")}set fields(t){this._set("fields",t)}get field1(){return this.type&&this.type!=="relationship"?null:this._get("field1")}set field1(t){this._set("field1",t)}get field2(){return this.type&&this.type!=="relationship"?null:this._get("field2")}set field2(t){this._set("field2",t)}get flowTheme(){return this.type==="flow"?this._get("flowTheme"):null}set flowTheme(t){this._set("flowTheme",t)}get focus(){return this.type&&this.type!=="relationship"?null:this._get("focus")}set focus(t){this._set("focus",t)}get numClasses(){return this.type&&this.type!=="relationship"?null:this._get("numClasses")}set numClasses(t){this._set("numClasses",t)}get statistics(){return this.type==="univariate-color-size"&&this.univariateTheme==="above-and-below"?this._get("statistics"):null}set statistics(t){this._set("statistics",t)}get standardDeviationInterval(){const t=this.type;return t&&t!=="relationship"&&t!=="class-breaks-size"&&t!=="class-breaks-color"||this.classificationMethod&&this.classificationMethod!=="standard-deviation"?null:this._get("standardDeviationInterval")}set standardDeviationInterval(t){this._set("standardDeviationInterval",t)}get type(){return this._get("type")}set type(t){let e=t;t==="classed-size"?e="class-breaks-size":t==="classed-color"&&(e="class-breaks-color"),this._set("type",e)}get univariateSymbolStyle(){return this.type==="univariate-color-size"&&this.univariateTheme==="above-and-below"?this._get("univariateSymbolStyle"):null}set univariateSymbolStyle(t){this._set("univariateSymbolStyle",t)}get univariateTheme(){return this.type==="univariate-color-size"?this._get("univariateTheme"):null}set univariateTheme(t){this._set("univariateTheme",t)}clone(){return new HI({classificationMethod:this.classificationMethod,colorRamp:k(this.colorRamp),fadeRatio:k(this.fadeRatio),fields:this.fields?.slice(),field1:k(this.field1),field2:k(this.field2),isAutoGenerated:this.isAutoGenerated,focus:this.focus,numClasses:this.numClasses,maxSliderValue:this.maxSliderValue,minSliderValue:this.minSliderValue,lengthUnit:this.lengthUnit,statistics:this.statistics,standardDeviationInterval:this.standardDeviationInterval,type:this.type,visualVariables:this.visualVariables&&this.visualVariables.map((t=>t.clone())),univariateSymbolStyle:this.univariateSymbolStyle,univariateTheme:this.univariateTheme,flowTheme:this.flowTheme})}};c([d({type:Oc.apiValues,value:null,json:{type:Oc.jsonValues,read:Oc.read,write:Oc.write,origins:{"web-document":{default:"manual",type:Oc.jsonValues,read:Oc.read,write:Oc.write}}}})],Tt.prototype,"classificationMethod",null),c([d({types:Lbe,json:{write:!0}})],Tt.prototype,"colorRamp",void 0),c([K("colorRamp")],Tt.prototype,"readColorRamp",null),c([d({json:{write:!0,origins:{"web-scene":{write:!1,read:!1}}}})],Tt.prototype,"fadeRatio",void 0),c([d({type:[String],value:null,json:{write:!0}})],Tt.prototype,"fields",null),c([d({type:Ru,value:null,json:{write:!0}})],Tt.prototype,"field1",null),c([d({type:Ru,value:null,json:{write:!0}})],Tt.prototype,"field2",null),c([d({type:Obe,value:null,json:{write:!0,origins:{"web-scene":{write:!1}}}})],Tt.prototype,"flowTheme",null),c([d({type:["HH","HL","LH","LL"],value:null,json:{write:!0}})],Tt.prototype,"focus",null),c([d({type:Boolean,json:{write:!0,default:!1,origins:{"web-scene":{write:!1}}}})],Tt.prototype,"isAutoGenerated",void 0),c([d({type:Number,value:null,json:{type:qe,write:!0}})],Tt.prototype,"numClasses",null),c([d({type:HF,json:{type:HF,read:!1,write:!1,origins:{"web-scene":{read:!0,write:!0}}}})],Tt.prototype,"lengthUnit",void 0),c([d({type:Number,json:{write:!0,origins:{"web-scene":{write:!1,read:!1}}}})],Tt.prototype,"maxSliderValue",void 0),c([d({type:Number,json:{write:!0,origins:{"web-scene":{write:!1,read:!1}}}})],Tt.prototype,"minSliderValue",void 0),c([d({type:Object,value:null,json:{write:!0,origins:{"web-scene":{write:!1,read:!1}}}})],Tt.prototype,"statistics",null),c([d({type:[.25,.33,.5,1],value:null,json:{type:[.25,.33,.5,1],write:!0}})],Tt.prototype,"standardDeviationInterval",null),c([d({type:z_.apiValues,value:null,json:{type:z_.jsonValues,read:z_.read,write:z_.write,origins:{"web-scene":{type:qF.jsonValues,write:{writer:qF.write,overridePolicy:t=>({enabled:t!=="flow"})}}}}})],Tt.prototype,"type",null),c([d({type:[Abe],json:{write:!0}})],Tt.prototype,"visualVariables",void 0),c([d({type:Nbe,value:null,json:{write:!0,origins:{"web-scene":{write:!1}}}})],Tt.prototype,"univariateSymbolStyle",null),c([d({type:kbe,value:null,json:{write:!0,origins:{"web-scene":{write:!1}}}})],Tt.prototype,"univariateTheme",null),Tt=HI=c([C("esri.renderers.support.AuthoringInfo")],Tt);const M$=new De({simple:"simple",uniqueValue:"unique-value",classBreaks:"class-breaks",heatmap:"heatmap",dotDensity:"dot-density",dictionary:"dictionary",pieChart:"pie-chart"},{ignoreUnknown:!0});let Rs=class extends W{constructor(e){super(e),this.authoringInfo=null,this.type=null}async getRequiredFields(e){if(!this.collectRequiredFields)return[];const r=new Set;return await this.collectRequiredFields(r,e),Array.from(r).sort()}getSymbol(e,r){}async getSymbolAsync(e,r){}get symbols(){return[]}get arcadeRequired(){return!1}getAttributeHash(){return JSON.stringify(this)}getMeshHash(){return JSON.stringify(this)}};c([d({type:Tt,json:{write:!0}})],Rs.prototype,"authoringInfo",void 0),c([d({type:M$.apiValues,readOnly:!0,json:{type:M$.jsonValues,read:!1,write:{writer:M$.write,ignoreOrigin:!0,isRequired:!0}}})],Rs.prototype,"type",void 0),Rs=c([C("esri.renderers.Renderer")],Rs);let Tg=class extends Ce.ClonableMixin(W){constructor(){super(...arguments),this.showLegend=null,this.title=null}};c([d({type:Boolean,json:{write:!0}})],Tg.prototype,"showLegend",void 0),c([d({type:String,json:{write:!0}})],Tg.prototype,"title",void 0),Tg=c([C("esri.renderers.visualVariables.support.VisualVariableLegendOptions")],Tg);const Fq=Tg,T$=new De({colorInfo:"color",transparencyInfo:"opacity",rotationInfo:"rotation",sizeInfo:"size"});let pi=class extends W{constructor(e){super(e),this.index=null,this.type=null,this.field=null,this.valueExpression=null,this.valueExpressionTitle=null,this.legendOptions=null}castField(e){return e==null?e:typeof e=="function"?(q.getLogger(this).error(".field: field must be a string value"),null):wv(e)}get arcadeRequired(){return!!this.valueExpression}clone(){}getAttributeHash(){return`${this.type}-${this.field}-${this.valueExpression}`}};c([d()],pi.prototype,"index",void 0),c([d({type:T$.apiValues,readOnly:!0,json:{read:T$.read,write:{writer:T$.write,isRequired:!0}}})],pi.prototype,"type",void 0),c([d({type:String,json:{write:!0}})],pi.prototype,"field",void 0),c([We("field")],pi.prototype,"castField",null),c([d({type:String,json:{write:!0}})],pi.prototype,"valueExpression",void 0),c([d({type:String,json:{write:!0}})],pi.prototype,"valueExpressionTitle",void 0),c([d({readOnly:!0})],pi.prototype,"arcadeRequired",null),c([d({type:Fq,json:{write:!0}})],pi.prototype,"legendOptions",void 0),pi=c([C("esri.renderers.visualVariables.VisualVariable")],pi);var WI;let oh=WI=class extends W{constructor(t){super(t),this.color=null,this.label=null,this.value=null}writeValue(t,e,r){e[r]=t??0}clone(){return new WI({color:this.color&&this.color.clone(),label:this.label,value:this.value})}};c([d({type:Q,json:{type:[qe],write:{isRequired:!0}}})],oh.prototype,"color",void 0),c([d({type:String,json:{write:!0}})],oh.prototype,"label",void 0),c([d({type:Number,json:{write:{writerEnsuresNonNull:!0}}})],oh.prototype,"value",void 0),c([re("value")],oh.prototype,"writeValue",null),oh=WI=c([C("esri.renderers.visualVariables.support.ColorStop")],oh);const Fbe=oh;var ZI;let ku=ZI=class extends pi{constructor(t){super(t),this.type="color",this.normalizationField=null}get cache(){return{ipData:this._interpolateData(),hasExpression:!!this.valueExpression,compiledFunc:null}}set stops(t){t&&Array.isArray(t)&&(t=t.filter((e=>!!e))).sort(((e,r)=>e.value-r.value)),this._set("stops",t)}clone(){return new ZI({field:this.field,normalizationField:this.normalizationField,valueExpression:this.valueExpression,valueExpressionTitle:this.valueExpressionTitle,stops:this.stops&&this.stops.map((t=>t.clone())),legendOptions:this.legendOptions?.clone()})}getAttributeHash(){return`${super.getAttributeHash()}-${this.normalizationField}`}_interpolateData(){return this.stops&&this.stops.map((t=>t.value||0))}};c([d({readOnly:!0})],ku.prototype,"cache",null),c([d({type:["color"],json:{type:["colorInfo"]}})],ku.prototype,"type",void 0),c([d({type:String,json:{write:!0}})],ku.prototype,"normalizationField",void 0),c([d({type:[Fbe],json:{write:!0}})],ku.prototype,"stops",null),ku=ZI=c([C("esri.renderers.visualVariables.ColorVariable")],ku);var JI;let Su=JI=class extends W{constructor(t){super(t),this.label=null,this.opacity=null,this.value=null}readOpacity(t,e){return k0(e.transparency)}writeOpacity(t,e,r){e[r]=l2(t)}clone(){return new JI({label:this.label,opacity:this.opacity,value:this.value})}};c([d({type:String,json:{write:!0}})],Su.prototype,"label",void 0),c([d({type:Number,json:{type:qe,write:{target:"transparency",isRequired:!0}}})],Su.prototype,"opacity",void 0),c([K("opacity",["transparency"])],Su.prototype,"readOpacity",null),c([re("opacity")],Su.prototype,"writeOpacity",null),c([d({type:Number,json:{write:{isRequired:!0}}})],Su.prototype,"value",void 0),Su=JI=c([C("esri.renderers.visualVariables.support.OpacityStop")],Su);const Dbe=Su;var YI;let Sl=YI=class extends pi{constructor(t){super(t),this.type="opacity",this.normalizationField=null}get cache(){return{ipData:this._interpolateData(),hasExpression:!!this.valueExpression,compiledFunc:null}}set stops(t){t&&Array.isArray(t)&&(t=t.filter((e=>!!e))).sort(((e,r)=>e.value-r.value)),this._set("stops",t)}clone(){return new YI({field:this.field,normalizationField:this.normalizationField,valueExpression:this.valueExpression,valueExpressionTitle:this.valueExpressionTitle,stops:this.stops&&this.stops.map((t=>t.clone())),legendOptions:this.legendOptions?.clone()})}getAttributeHash(){return`${super.getAttributeHash()}-${this.normalizationField}`}_interpolateData(){return this.stops&&this.stops.map((t=>t.value||0))}};c([d({readOnly:!0})],Sl.prototype,"cache",null),c([d({type:["opacity"],json:{type:["transparencyInfo"]}})],Sl.prototype,"type",void 0),c([d({type:String,json:{write:!0}})],Sl.prototype,"normalizationField",void 0),c([d({type:[Dbe],json:{write:!0}})],Sl.prototype,"stops",null),Sl=YI=c([C("esri.renderers.visualVariables.OpacityVariable")],Sl);var XI;let Ou=XI=class extends pi{constructor(t){super(t),this.axis=null,this.type="rotation",this.rotationType="geographic"}get cache(){return{hasExpression:!!this.valueExpression,compiledFunc:null}}clone(){return new XI({axis:this.axis,rotationType:this.rotationType,field:this.field,valueExpression:this.valueExpression,valueExpressionTitle:this.valueExpressionTitle,legendOptions:this.legendOptions?.clone()})}};c([d({readOnly:!0})],Ou.prototype,"cache",null),c([d({type:["heading","tilt","roll"],json:{origins:{"web-scene":{default:"heading",write:!0}}}})],Ou.prototype,"axis",void 0),c([d({type:["rotation"],json:{type:["rotationInfo"]}})],Ou.prototype,"type",void 0),c([d({type:["geographic","arithmetic"],json:{write:!0,origins:{"web-document":{write:!0,default:"geographic"}}}})],Ou.prototype,"rotationType",void 0),Ou=XI=c([C("esri.renderers.visualVariables.RotationVariable")],Ou);function zbe(t){return Be(t)}var KI;let Zn=KI=class extends W{constructor(t){super(t),this.label=null,this.size=null,this.value=null,this.useMinValue=null,this.useMaxValue=null}clone(){return new KI({label:this.label,size:this.size,value:this.value,useMaxValue:this.useMaxValue,useMinValue:this.useMinValue})}};c([d({type:String,json:{write:!0}})],Zn.prototype,"label",void 0),c([d({type:Number,cast:Be,json:{write:{isRequired:!0}}})],Zn.prototype,"size",void 0),c([d({type:Number,json:{write:{isRequired:!0}}})],Zn.prototype,"value",void 0),c([d({type:Boolean,json:{write:!1}})],Zn.prototype,"useMinValue",void 0),c([d({type:Boolean,json:{write:!1}})],Zn.prototype,"useMaxValue",void 0),Zn=KI=c([C("esri.renderers.visualVariables.support.SizeStop")],Zn);let vb=class extends Fq{constructor(){super(...arguments),this.customValues=null}};c([d({type:[Number],json:{write:!0}})],vb.prototype,"customValues",void 0),vb=c([C("esri.renderers.visualVariables.support.SizeVariableLegendOptions")],vb);const Dq=vb;var Nl,Ir;function nf(t){return t&&t.declaredClass==="esri.renderers.visualVariables.SizeVariable"}function Sd(t){return t!=null&&!isNaN(t)&&isFinite(t)}function zq(t){return t.valueExpression?Nl.Expression:t.field&&typeof t.field=="string"?Nl.Field:Nl.Unknown}function Vbe(t,e){const r=e||zq(t),i=t.valueUnit||"unknown";return r===Nl.Unknown?Ir.Constant:t.stops?Ir.Stops:t.minSize!=null&&t.maxSize!=null&&t.minDataValue!=null&&t.maxDataValue!=null?Ir.ClampedLinear:i==="unknown"?t.minSize!=null&&t.minDataValue!=null?t.minSize&&t.minDataValue?Ir.Proportional:Ir.Additive:Ir.Identity:Ir.RealWorldSize}(function(t){t.Unknown="unknown",t.Expression="expression",t.Field="field"})(Nl||(Nl={})),(function(t){t.Unknown="unknown",t.Stops="stops",t.ClampedLinear="clamped-linear",t.Proportional="proportional",t.Additive="additive",t.Constant="constant",t.Identity="identity",t.RealWorldSize="real-world-size"})(Ir||(Ir={}));const j2={unknown:1,inches:ut(1,"meters","inches"),feet:ut(1,"meters","feet"),"us-feet":ut(1,"meters","us-feet"),yards:ut(1,"meters","yards"),miles:ut(1,"meters","miles"),"nautical-miles":ut(1,"meters","nautical-miles"),millimeters:ut(1,"meters","millimeters"),centimeters:ut(1,"meters","centimeters"),decimeters:ut(1,"meters","decimeters"),meters:ut(1,"meters","meters"),kilometers:ut(1,"meters","kilometers"),"decimal-degrees":1/Oee(1,"meters",Gt.radius)},Vq=()=>q.getLogger("esri.renderers.visualVariables.support.visualVariableUtils"),U2=t=>Vq().warn(`The visualVariable should be an instance of esri.renderers.visualVariables.${t}`),G2=()=>Vq().error("Use of arcade expressions requires an arcade context"),WF=new dr,_b=Math.PI,jq=/^\s*(return\s+)?\$view\.scale\s*(;)?\s*$/i;function Uq(t,e,r){const i="visualVariables"in t&&t.visualVariables?t.visualVariables.find((g=>g.type==="color")):t;if(!i)return;if(i.declaredClass!=="esri.renderers.visualVariables.ColorVariable")return void U2("ColorVariable");const s=typeof e=="number",n=s?null:e,o=n?.attributes;let a=s?e:null;const l=i.field,{ipData:u,hasExpression:h}=i.cache;let p=i.cache.compiledFunc;if(!l&&!h){const g=i.stops;return g&&g[0]&&g[0].color}if(typeof a!="number")if(h){if(r?.arcade==null)return void G2();const g={viewingMode:r.viewingMode,scale:r.scale,spatialReference:r.spatialReference},v=r.arcade.arcadeUtils,_=v.getViewInfo(g),b=v.createExecContext(n,_,r.timeZone);if(!p){const S=v.createSyntaxTree(i.valueExpression);p=v.createFunction(S),i.cache.compiledFunc=p}a=v.executeFunction(p,b)}else o&&(a=o[l]);const m=i.normalizationField,y=o!=null&&m!=null?parseFloat(o[m]):void 0;if(a!=null&&(!m||s||!isNaN(y)&&y!==0)){Sd(y)&&!s&&(a/=y);const g=WA(a,u);if(g){const v=g[0],_=g[1],b=v===_?i.stops[v].color:Q.blendColors(i.stops[v].color,i.stops[_].color,g[2],r?.color);return new Q(b)}}}function Gq(t,e,r){const i="visualVariables"in t&&t.visualVariables?t.visualVariables.find((g=>g.type==="opacity")):t;if(!i)return;if(i.declaredClass!=="esri.renderers.visualVariables.OpacityVariable")return void U2("OpacityVariable");const s=typeof e=="number",n=s?null:e,o=n?.attributes;let a=s?e:null;const l=i.field,{ipData:u,hasExpression:h}=i.cache;let p=i.cache.compiledFunc;if(!l&&!h){const g=i.stops;return g&&g[0]&&g[0].opacity}if(typeof a!="number")if(h){if(r?.arcade==null)return void G2();const g={viewingMode:r.viewingMode,scale:r.scale,spatialReference:r.spatialReference},v=r.arcade.arcadeUtils,_=v.getViewInfo(g),b=v.createExecContext(n,_,r.timeZone);if(!p){const S=v.createSyntaxTree(i.valueExpression);p=v.createFunction(S),i.cache.compiledFunc=p}a=v.executeFunction(p,b)}else o&&(a=o[l]);const m=i.normalizationField,y=o!=null&&m!=null?parseFloat(o[m]):void 0;if(a!=null&&(!m||s||!isNaN(y)&&y!==0)){Sd(y)&&!s&&(a/=y);const g=WA(a,u);if(g){const v=g[0],_=g[1];if(v===_)return i.stops[v].opacity;{const b=i.stops[v].opacity;return b+(i.stops[_].opacity-b)*g[2]}}}}function Bq(t,e,r){const i="visualVariables"in t&&t.visualVariables?t.visualVariables.find((y=>y.type==="rotation")):t;if(!i)return;if(i.declaredClass!=="esri.renderers.visualVariables.RotationVariable")return void U2("RotationVariable");const s=i.axis||"heading",n=s==="heading"&&i.rotationType==="arithmetic"?90:0,o=s==="heading"&&i.rotationType==="arithmetic"?-1:1,a=typeof e=="number"?null:e,l=a?.attributes,u=i.field,{hasExpression:h}=i.cache;let p=i.cache.compiledFunc,m=null;if(!u&&!h)return m;if(h){if(r?.arcade==null)return void G2();const y={viewingMode:r.viewingMode,scale:r.scale,spatialReference:r.spatialReference},g=r.arcade.arcadeUtils,v=g.getViewInfo(y),_=g.createExecContext(a,v,r.timeZone);if(!p){const b=g.createSyntaxTree(i.valueExpression);p=g.createFunction(b),i.cache.compiledFunc=p}m=g.executeFunction(p,_)}else l&&(m=l[u]);return m=typeof m!="number"||isNaN(m)?null:n+o*m,m}function jbe(t,e,r){const i=typeof e=="number",s=i?null:e,n=s?.attributes;let o=i?e:null;const{isScaleDriven:a}=t.cache;let l=t.cache.compiledFunc;if(a){const h=r?.scale,p=r?.view;o=h==null||p==="3d"?Ube(t):h}else if(!i)switch(t.inputValueType){case Nl.Expression:{if(r?.arcade==null)return void G2();const h={viewingMode:r.viewingMode,scale:r.scale,spatialReference:r.spatialReference},p=r.arcade.arcadeUtils,m=p.getViewInfo(h),y=p.createExecContext(s,m,r.timeZone);if(!l){const g=p.createSyntaxTree(t.valueExpression);l=p.createFunction(g),t.cache.compiledFunc=l}o=p.executeFunction(l,y);break}case Nl.Field:n&&(o=n[t.field]);break;case Nl.Unknown:o=null}if(!Sd(o))return null;if(i||!t.normalizationField)return o;const u=n?parseFloat(n[t.normalizationField]):null;return Sd(u)&&u!==0?o/u:null}function Ube(t){let e=null,r=null;const i=t.stops;return i?(e=i[0].value,r=i[i.length-1].value):(e=t.minDataValue||0,r=t.maxDataValue||0),(e+r)/2}function B2(t,e,r){const i="visualVariables"in t&&t.visualVariables?t.visualVariables.find((n=>n.type==="size")):t;if(!i)return;if(i.declaredClass!=="esri.renderers.visualVariables.SizeVariable")return void U2("SizeVariable");const s=Hq(jbe(i,e,r),i,e,r,i.cache.ipData);return s==null||isNaN(s)?void 0:s}function ds(t,e,r){return t==null?null:nf(t)?B2(t,e,r):Sd(t)?t:null}function qq(t,e,r){return Sd(r)&&t>r?r:Sd(e)&&t<e?e:t}function Gbe(t,e,r,i){const s=ds(e.minSize,r,i)||e.minDataValue;return t==null&&s==null?null:(t??0)+(s??0)}function Bbe(t,e,r){const i=t.stops;let s=i?.length&&i[0].size;return s==null&&(s=t.minSize),ds(s,e,r)}function qbe(t,e,r,i){const s=ds(e.minSize,r,i);if(t==null)return s;const{minDataValue:n,maxDataValue:o}=e;if(n==null||o==null)return null;const a=(t-n)/(o-n),l=ds(e.maxSize,r,i),u=i?.shape;if(t<=n)return s;if(t>=o)return l;if(s==null||l==null)return null;if(e.scaleBy==="area"&&u){const h=u==="circle",p=h?_b*(s/2)**2:s*s,m=p+a*((h?_b*(l/2)**2:l*l)-p);return h?2*Math.sqrt(m/_b):Math.sqrt(m)}return s+a*(l-s)}function Hbe(t,e,r,i){const s=ds(e.minSize,r,i);if(t==null||s==null)return s;const n=i?.shape,{minDataValue:o}=e;if(o==null)return null;const a=t/o,l=ds(e.maxSize,r,i);let u=null;return u=n==="circle"?2*Math.sqrt(a*(s/2)**2):n==="square"||n==="diamond"||n==="image"?Math.sqrt(a*s**2):a*s,qq(u,s,l)}function Wbe(t,e,r,i,s){if(t==null)return null;const[n,o,a]=WA(t,s);if(n===o)return ds(e.stops?.[n].size,r,i);{const l=ds(e.stops?.[n].size,r,i),u=ds(e.stops?.[o].size,r,i);return l==null||u==null?null:l+(u-l)*a}}function Zbe(t,e,r,i){const s=(i?.resolution??1)*j2[e.valueUnit],n=ds(e.minSize,r,i),o=ds(e.maxSize,r,i),{valueRepresentation:a}=e;if(t==null)return n;let l=null;return l=a==="area"?2*Math.sqrt(t/_b)/s:a==="radius"||a==="distance"?2*t/s:t/s,qq(l,n,o)}function Hq(t,e,r,i,s){switch(e.transformationType){case Ir.Additive:return Gbe(t,e,r,i);case Ir.Constant:return Bbe(e,r,i);case Ir.ClampedLinear:return qbe(t,e,r,i);case Ir.Proportional:return Hbe(t,e,r,i);case Ir.Stops:return Wbe(t,e,r,i,s);case Ir.RealWorldSize:return Zbe(t,e,r,i);case Ir.Identity:return t;case Ir.Unknown:return null}}function Jbe(t,e,r){const{isScaleDriven:i}=t.cache;if(!(i&&r==="3d"||e))return null;const s={scale:e,view:r};let n=ds(t.minSize,WF,s),o=ds(t.maxSize,WF,s);if(n!=null||o!=null){if(n>o){const a=o;o=n,n=a}return{minSize:n,maxSize:o}}}function Ybe(t,e,r){if(!t.visualVariables)return;const i=[],s=[],n=[],o=[],a=[];for(const l of t.visualVariables)switch(l.type){case"color":s.push(l);break;case"opacity":n.push(l);break;case"rotation":a.push(l);break;case"size":o.push(l)}return s.forEach((l=>{const u=Uq(l,e,r);i.push({variable:l,value:u})})),n.forEach((l=>{const u=Gq(l,e,r);i.push({variable:l,value:u})})),a.forEach((l=>{const u=Bq(l,e,r);i.push({variable:l,value:u})})),o.forEach((l=>{const u=B2(l,e,r);i.push({variable:l,value:u})})),i}function WA(t,e){if(!e)return;let r=0,i=e.length-1;return e.some(((s,n)=>t<s?(i=n,!0):(r=n,!1))),[r,i,(t-e[r])/(e[i]-e[r])]}function Xbe(t,e,r){const i=["proportional","proportional","proportional"];for(const s of t){const n=s.useSymbolValue?"symbol-value":B2(s,e,r)??"proportional";switch(s.axis){case"width":i[0]=n;break;case"depth":i[1]=n;break;case"height":i[2]=n;break;case"width-and-depth":i[0]=n,i[1]=n;break;case"all":case void 0:case null:i[0]=n,i[1]=n,i[2]=n;break;default:s.axis}}return i}const Ad=Object.freeze(Object.defineProperty({__proto__:null,getAllSizes:Xbe,getColor:Uq,getOpacity:Gq,getRotationAngle:Bq,getSize:B2,getSizeForValue:Hq,getSizeFromNumberOrVariable:ds,getSizeRangeAtScale:Jbe,getVisualVariableValues:Ybe,viewScaleRE:jq},Symbol.toStringTag,{value:"Module"}));var QI;const V_=new De({width:"width",depth:"depth",height:"height",widthAndDepth:"width-and-depth",all:"all"}),eC=new De({unknown:"unknown",inch:"inches",foot:"feet",yard:"yards",mile:"miles","nautical-mile":"nautical-miles",millimeter:"millimeters",centimeter:"centimeters",decimeter:"decimeters",meter:"meters",kilometer:"kilometers"});function ZF(t){if(t!=null)return typeof t=="string"||typeof t=="number"?zbe(t):t.type==="size"?nf(t)?t:(delete(t={...t}).type,new Ue(t)):void 0}function JF(t,e,r){if(typeof t!="object")return t;const i=new Ue;return i.read(t,r),i}let Ue=QI=class extends pi{constructor(t){super(t),this.axis=null,this.legendOptions=null,this.normalizationField=null,this.scaleBy=null,this.target=null,this.type="size",this.useSymbolValue=null,this.valueExpression=null,this.valueRepresentation=null,this.valueUnit=null}get cache(){return{ipData:this._interpolateData(),hasExpression:!!this.valueExpression,compiledFunc:null,isScaleDriven:this.valueExpression!=null&&jq.test(this.valueExpression)}}set index(t){nf(this.maxSize)&&(this.maxSize.index=`visualVariables[${t}].maxSize`),nf(this.minSize)&&(this.minSize.index=`visualVariables[${t}].minSize`),this._set("index",t)}get inputValueType(){return zq(this)}set maxDataValue(t){t&&this.stops&&(q.getLogger(this).warn("cannot set maxDataValue when stops is not null."),t=null),this._set("maxDataValue",t)}set maxSize(t){t&&this.stops&&(q.getLogger(this).warn("cannot set maxSize when stops is not null."),t=null),this._set("maxSize",t)}castMaxSize(t){return ZF(t)}readMaxSize(t,e,r){return JF(t,e,r)}set minDataValue(t){t&&this.stops&&(q.getLogger(this).warn("cannot set minDataValue when stops is not null."),t=null),this._set("minDataValue",t)}set minSize(t){t&&this.stops&&(q.getLogger(this).warn("cannot set minSize when stops is not null."),t=null),this._set("minSize",t)}castMinSize(t){return ZF(t)}readMinSize(t,e,r){return JF(t,e,r)}get arcadeRequired(){return!!this.valueExpression||this.minSize!=null&&typeof this.minSize=="object"&&this.minSize.arcadeRequired||this.maxSize!=null&&typeof this.maxSize=="object"&&this.maxSize.arcadeRequired}set stops(t){this.minDataValue==null&&this.maxDataValue==null&&this.minSize==null&&this.maxSize==null?t&&Array.isArray(t)&&(t=t.filter((e=>!!e))).sort(((e,r)=>e.value-r.value)):t&&(q.getLogger(this).warn("cannot set stops when one of minDataValue, maxDataValue, minSize or maxSize is not null."),t=null),this._set("stops",t)}get transformationType(){return Vbe(this,this.inputValueType)}readValueExpression(t,e){return t||e.expression&&"$view.scale"}writeValueExpressionWebScene(t,e,r,i){if(t==="$view.scale"){if(i?.messages){const s=this.index,n=typeof s=="string"?s:`visualVariables[${s}]`;i.messages.push(new F("property:unsupported",this.type+"VisualVariable.valueExpression = '$view.scale' is not supported in Web Scene. Please remove this property to save the Web Scene.",{instance:this,propertyName:n+".valueExpression",context:i}))}}else e[r]=t}readValueUnit(t){return t?eC.read(t):null}clone(){return new QI({axis:this.axis,field:this.field,valueExpression:this.valueExpression,valueExpressionTitle:this.valueExpressionTitle,maxDataValue:this.maxDataValue,maxSize:nf(this.maxSize)?this.maxSize.clone():this.maxSize,minDataValue:this.minDataValue,minSize:nf(this.minSize)?this.minSize.clone():this.minSize,normalizationField:this.normalizationField,stops:this.stops?.map((t=>t.clone())),target:this.target,useSymbolValue:this.useSymbolValue,valueRepresentation:this.valueRepresentation,valueUnit:this.valueUnit,legendOptions:this.legendOptions?.clone()})}flipSizes(){if(this.transformationType===Ir.ClampedLinear){const{minSize:t,maxSize:e}=this;return this.minSize=e,this.maxSize=t,this}if(this.transformationType===Ir.Stops){const t=this.stops;if(!t)return this;const e=t.map((i=>i.size)).reverse(),r=t.length;for(let i=0;i<r;i++)t[i].size=e[i];return this}return this}getAttributeHash(){return`${super.getAttributeHash()}-${this.target}-${this.normalizationField}`}_interpolateData(){return this.stops?.map((t=>t.value||0))}};c([d({readOnly:!0})],Ue.prototype,"cache",null),c([d({type:V_.apiValues,json:{type:V_.jsonValues,origins:{"web-map":{read:!1}},read:V_.read,write:V_.write}})],Ue.prototype,"axis",void 0),c([d()],Ue.prototype,"index",null),c([d({type:String,readOnly:!0})],Ue.prototype,"inputValueType",null),c([d({type:Dq,json:{write:!0}})],Ue.prototype,"legendOptions",void 0),c([d({type:Number,value:null,json:{write:!0}})],Ue.prototype,"maxDataValue",null),c([d({type:Number,value:null,json:{write:!0}})],Ue.prototype,"maxSize",null),c([We("maxSize")],Ue.prototype,"castMaxSize",null),c([K("maxSize")],Ue.prototype,"readMaxSize",null),c([d({type:Number,value:null,json:{write:!0}})],Ue.prototype,"minDataValue",null),c([d({type:Number,value:null,json:{write:!0}})],Ue.prototype,"minSize",null),c([We("minSize")],Ue.prototype,"castMinSize",null),c([K("minSize")],Ue.prototype,"readMinSize",null),c([d({type:String,json:{write:!0}})],Ue.prototype,"normalizationField",void 0),c([d({readOnly:!0})],Ue.prototype,"arcadeRequired",null),c([d({type:String})],Ue.prototype,"scaleBy",void 0),c([d({type:[Zn],value:null,json:{write:!0}})],Ue.prototype,"stops",null),c([d({type:["outline"],json:{write:!0}})],Ue.prototype,"target",void 0),c([d({type:String,readOnly:!0})],Ue.prototype,"transformationType",null),c([d({type:["size"],json:{type:["sizeInfo"]}})],Ue.prototype,"type",void 0),c([d({type:Boolean,json:{write:!0,origins:{"web-map":{read:!1}}}})],Ue.prototype,"useSymbolValue",void 0),c([d({type:String,json:{write:!0}})],Ue.prototype,"valueExpression",void 0),c([K("valueExpression",["valueExpression","expression"])],Ue.prototype,"readValueExpression",null),c([re("web-scene","valueExpression")],Ue.prototype,"writeValueExpressionWebScene",null),c([d({type:["radius","diameter","area","width","distance"],json:{write:!0}})],Ue.prototype,"valueRepresentation",void 0),c([d({type:eC.apiValues,json:{write:eC.write,origins:{"web-map":{read:!1},"web-scene":{write:!0},"portal-item":{write:!0}}}})],Ue.prototype,"valueUnit",void 0),c([K("valueUnit")],Ue.prototype,"readValueUnit",null),Ue=QI=c([C("esri.renderers.visualVariables.SizeVariable")],Ue);const Kbe={color:ku,size:Ue,opacity:Sl,rotation:Ou},Qbe=new De({colorInfo:"color",transparencyInfo:"opacity",rotationInfo:"rotation",sizeInfo:"size"}),ewe=/^\[([^\]]+)\]$/i;let bb=class extends ce{constructor(){super(...arguments),this.colorVariables=null,this.opacityVariables=null,this.rotationVariables=null,this.sizeVariables=null}set visualVariables(e){if(this._resetVariables(),e=e?.filter((r=>!!r)),e?.length){for(const r of e)switch(r.type){case"color":this.colorVariables.push(r);break;case"opacity":this.opacityVariables.push(r);break;case"rotation":this.rotationVariables.push(r);break;case"size":this.sizeVariables.push(r)}this.sizeVariables.length&&this.sizeVariables.some((r=>!!r.target))&&e.sort(((r,i)=>{let s=null;return s=r.target===i.target?0:r.target?1:-1,s}));for(let r=0;r<e.length;r++)e[r].index=r;this._set("visualVariables",e)}else this._set("visualVariables",e)}readVariables(e,r,i){const{rotationExpression:s,rotationType:n}=r,o=s?.match(ewe),a=o?.[1];if(a&&(e||(e=[]),e.push({type:"rotationInfo",rotationType:n,field:a})),e)return e.map((l=>{const u=Qbe.read(l.type),h=Kbe[u];h||(q.getLogger(this).warn(`Unknown variable type: ${u}`),i?.messages&&i.messages.push(new Fs("visual-variable:unsupported",`visualVariable of type '${u}' is not supported`,{definition:l,context:i})));const p=new h;return p.read(l,i),p}))}writeVariables(e,r){const i=[];for(const s of e){const n=s.toJSON(r);n&&i.push(n)}return i}_resetVariables(){this.colorVariables=[],this.opacityVariables=[],this.rotationVariables=[],this.sizeVariables=[]}};c([d()],bb.prototype,"visualVariables",null),bb=c([C("esri.renderers.visualVariables.VisualVariableFactory")],bb);const twe={base:pi,key:"type",typeMap:{opacity:Sl,color:ku,rotation:Ou,size:Ue}},Wm=t=>{let e=class extends t{constructor(){super(...arguments),this._vvFactory=new bb}set visualVariables(r){this._vvFactory.visualVariables=r,this._set("visualVariables",this._vvFactory.visualVariables)}readVisualVariables(r,i,s){return this._vvFactory.readVariables(r,i,s)}writeVisualVariables(r,i,s,n){i[s]=this._vvFactory.writeVariables(r,n)}get arcadeRequiredForVisualVariables(){return this.visualVariables?.some((({arcadeRequired:r})=>r))??!1}hasVisualVariables(r,i){return r?this.getVisualVariablesForType(r,i).length>0:this.getVisualVariablesForType("size",i).length>0||this.getVisualVariablesForType("color",i).length>0||this.getVisualVariablesForType("opacity",i).length>0||this.getVisualVariablesForType("rotation",i).length>0}getVisualVariablesForType(r,i){return this.visualVariables?.filter((s=>s.type===r&&(typeof i=="string"?s.target===i:i!==!1||!s.target)))??[]}async collectVVRequiredFields(r,i){let s=[];this.visualVariables&&(s=s.concat(this.visualVariables));for(const n of s)n&&(n.field&&Bi(r,i,n.field),n.normalizationField&&Bi(r,i,n.normalizationField),n.valueExpression&&(rwe(n.valueExpression,r,i)||await si(r,i,n.valueExpression)))}};return c([d({types:[twe],value:null,json:{write:!0}})],e.prototype,"visualVariables",null),c([K("visualVariables",["visualVariables","rotationType","rotationExpression"])],e.prototype,"readVisualVariables",null),c([re("visualVariables")],e.prototype,"writeVisualVariables",null),e=c([C("esri.renderers.mixins.VisualVariablesMixin")],e),e};function rwe(t,e,r){const i=ace(t);return i!=null&&(Bi(e,r,i),!0)}const ZA=[252,146,31,255],iwe=[153,153,153,255],swe={type:"esriSMS",style:"esriSMSCircle",size:6,color:ZA,outline:{type:"esriSLS",style:"esriSLSSolid",width:.75,color:[153,153,153,255]}},nwe={type:"esriSLS",style:"esriSLSSolid",width:.75,color:ZA},owe={type:"esriSFS",style:"esriSFSSolid",color:[252,146,31,196],outline:{type:"esriSLS",style:"esriSLSSolid",width:.75,color:[255,255,255,191]}},awe={type:"esriTS",color:[255,255,255,255],font:{family:"arial-unicode-ms",size:10,weight:"bold"},horizontalAlignment:"center",kerning:!0,haloColor:[0,0,0,255],haloSize:1,rotated:!1,text:"",xoffset:0,yoffset:0,angle:0},lwe={type:"esriSMS",style:"esriSMSCircle",color:[0,0,0,255],outline:null,size:10.5},uwe={type:"esriSLS",style:"esriSLSSolid",color:[0,0,0,255],width:1.5},cwe={type:"esriSFS",style:"esriSFSSolid",color:[0,0,0,255],outline:null},pS=Pt.fromJSON(swe),q2=jt.fromJSON(nwe),Wq=Vi.fromJSON(owe),hwe=lt.fromJSON(awe);function w6e(t){if(t==null)return null;switch(t.type){case"mesh":return null;case"point":case"multipoint":return pS;case"polyline":return q2;case"polygon":case"extent":return Wq}return null}const S6e=Pt.fromJSON(lwe),x6e=jt.fromJSON(uwe),$6e=Vi.fromJSON(cwe),dwe=zi.fromSimpleMarkerSymbol(pS),pwe=ro.fromSimpleLineSymbol(q2),fwe=dn.fromSimpleFillSymbol(Wq),mwe=new El({symbolLayers:new se([new ki({material:{color:ZA},edges:new yG({size:tt(1),color:new Q(iwe)})})])}),ywe=new ro({symbolLayers:new se([new Ri({material:{color:new Q([0,0,0])},size:tt(1)})])}),gwe=new dn({symbolLayers:new se([new ki({outline:{color:new Q([0,0,0]),size:tt(1)}})])});function M6e(t){if(t==null)return null;switch(t.type){case"mesh":return mwe;case"point":case"multipoint":return dwe;case"polyline":return pwe;case"polygon":case"extent":return fwe}return null}const YF="#useCIMFallbackSymbology()",xl={retainId:!1,ignoreDrivers:!1,hasLabelingContext:!0};function Sm(t,e=xl){if(!t)return{symbol:null};const{retainId:r=xl.retainId,ignoreDrivers:i=xl.ignoreDrivers,hasLabelingContext:s=xl.hasLabelingContext,retainCIM:n=xl.retainCIM,cimFallbackEnabled:o=xl.cimFallbackEnabled}=e;let a=null;if(Pa(t)||t instanceof Ur)a=t.clone();else if(t.type==="cim"){const l=t.data?.symbol?.type;switch(l){case"CIMPointSymbol":a=n?t.clone():zi.fromCIMSymbol(t);break;case"CIMLineSymbol":o&&(a=ywe.clone(),e?.logWarning?.(YF,"Unsupported CIM line symbology converted to fallback 3D line symbology"));break;case"CIMPolygonSymbol":o&&(a=gwe.clone(),e?.logWarning?.(YF,"Unsupported CIM polygon symbology converted to fallback 3D polygon symbology"))}if(!a)return{error:new F("symbol-conversion:unsupported-cim-symbol",`CIM symbol of type '${l||"unknown"}' is unsupported in 3D`,{symbol:t})}}else if(t instanceof jt)a=ro.fromSimpleLineSymbol(t);else if(t instanceof Pt)a=zi.fromSimpleMarkerSymbol(t);else if(t instanceof Li)a=zi.fromPictureMarkerSymbol(t);else if(t instanceof Vi)a=e.geometryType&&e.geometryType==="mesh"?El.fromSimpleFillSymbol(t):dn.fromSimpleFillSymbol(t);else{if(!(t instanceof lt))return{error:new F("symbol-conversion:unsupported-2d-symbol",`2D symbol of type '${t.type||t.declaredClass}' is unsupported in 3D`,{symbol:t})};a=s?qn.fromTextSymbol(t):zi.fromTextSymbol(t)}return r&&a&&a.type!=="cim"&&(a.id=t.id),!i||a.type==="cim"||a instanceof Ur||a.symbolLayers.forEach((l=>l.ignoreDrivers=!0)),{symbol:a}}function fS(t,e,r,i){const s=Zq(t,{},{context:i,isLabelSymbol:!1});s!=null&&Cr(r,s,e)}function XF(t,e,r,i){const s=Zq(t,{},{context:i,isLabelSymbol:!0});s!=null&&(e[r]=s)}function KF(t){return Pa(t)||t instanceof Ur}function vwe(t){return t?.type==="polygon-3d"||t?.type==="line-3d"}function Zq(t,e,r){if(t==null)return null;const{context:i,isLabelSymbol:s}=r,n=i?.origin,o=i?.messages;if(n==="web-scene"&&!KF(t)){const a=Sm(t,{retainCIM:!0,hasLabelingContext:s});return a.symbol!=null?a.symbol.write(e,i):(o?.push(new F("symbol:unsupported",`Symbols of type '${t.declaredClass}' are not supported in scenes. Use 3D symbology instead when working with WebScene and SceneView`,{symbol:t,context:i,error:a.error})),null)}return dT(i?.layer)&&vwe(t)?(o?.push(new F("symbol:unsupported",`Symbols of type '${t.declaredClass}' are not supported on layers of type '${i?.layer?.declaredClass}'.`,{symbol:t,context:i})),null):(n==="web-map"||n==="portal-item"&&!dT(i?.layer))&&KF(t)?(o?.push(new F("symbol:unsupported",`Symbols of type '${t.declaredClass}' are not supported in web maps and portal items. Use 2D symbology and CIMSymbol instead when working with MapView`,{symbol:t,context:i})),null):t.write(e,i)}function Jq(t,e){return Xhe(t,null,e)}const H2={types:NG,json:{write:{writer:fS},origins:{"web-scene":{types:YO,write:{writer:fS},read:{reader:Om({types:YO})}}}}},JA=VP({json:{origins:{"web-scene":{write:{isRequired:!0}}}}},H2),YA={types:{base:sr,key:"type",typeMap:{"simple-fill":Wu.typeMap["simple-fill"],"picture-fill":Wu.typeMap["picture-fill"],"polygon-3d":Wu.typeMap["polygon-3d"],cim:Wu.typeMap.cim}},json:{write:{writer:fS},origins:{"web-scene":{type:dn,write:{writer:fS}}}}},wb={cast:t=>t==null||typeof t=="string"||typeof t=="number"?t:`${t}`,json:{type:String,write:{writer:(t,e)=>{e.value=t?.toString()}}}};var tC;let Jn=tC=class extends W{constructor(t){super(t),this.description=null,this.label=null,this.minValue=null,this.maxValue=0,this.symbol=null}clone(){return new tC({description:this.description,label:this.label,minValue:this.minValue,maxValue:this.maxValue,symbol:this.symbol?.clone()??null})}getMeshHash(){const t=JSON.stringify(this.symbol);return`${this.minValue}.${this.maxValue}.${t}`}};c([d({type:String,json:{write:!0}})],Jn.prototype,"description",void 0),c([d({type:String,json:{write:!0}})],Jn.prototype,"label",void 0),c([d({type:Number,json:{read:{source:"classMinValue"},write:{target:"classMinValue"}}})],Jn.prototype,"minValue",void 0),c([d({type:Number,json:{read:{source:"classMaxValue"},write:{target:"classMaxValue"}}})],Jn.prototype,"maxValue",void 0),c([d(JA)],Jn.prototype,"symbol",void 0),Jn=tC=c([C("esri.renderers.support.ClassBreakInfo")],Jn);var rC;const _we=Wr()({ascendingValues:"ascending-values",descendingValues:"descending-values"});let Eg=rC=class extends Ce.ClonableMixin(W){static from(t){return km(rC,t)}constructor(t){super(t),this.title=null,this.order=null}};c([d({type:String,json:{write:!0}})],Eg.prototype,"title",void 0),c([ye(_we)],Eg.prototype,"order",void 0),Eg=rC=c([C("esri.renderers.support.RendererLegendOptions")],Eg);const XA=Eg;var iC;const Yq="log",Sb="percent-of-total",xb="field",j_=new De({esriNormalizeByLog:Yq,esriNormalizeByPercentOfTotal:Sb,esriNormalizeByField:xb}),bwe=br(Jn);let ur=iC=class extends Wm(Rs){constructor(t){super(t),this._compiledValueExpression={valueExpression:null,compiledFunction:null},this.backgroundFillSymbol=null,this.classBreakInfos=null,this.defaultLabel=null,this.defaultSymbol=null,this.field=null,this.isMaxInclusive=!0,this.legendOptions=null,this.normalizationField=null,this.normalizationTotal=null,this.type="class-breaks",this.valueExpression=null,this.valueExpressionTitle=null,this._set("classBreakInfos",[])}readClassBreakInfos(t,e,r){if(!Array.isArray(t))return;let i=e.minValue;return t.map((s=>{const n=new Jn;return n.read(s,r),n.minValue==null&&(n.minValue=i),n.maxValue==null&&(n.maxValue=n.minValue),i=n.maxValue,n}))}writeClassBreakInfos(t,e,r,i){const s=t.map((n=>n.write({},i)));this._areClassBreaksConsecutive()&&s.forEach((n=>delete n.classMinValue)),e[r]=s}castField(t){return t==null?t:typeof t=="function"?(q.getLogger(this).error(".field: field must be a string value"),null):wv(t)}get minValue(){return this.classBreakInfos&&this.classBreakInfos[0]&&this.classBreakInfos[0].minValue||0}get normalizationType(){let t=this._get("normalizationType");const e=!!this.normalizationField,r=this.normalizationTotal!=null;return e||r?(t=e&&xb||r&&Sb||null,e&&r&&q.getLogger(this).warn("warning: both normalizationField and normalizationTotal are set!")):t!==xb&&t!==Sb||(t=null),t}set normalizationType(t){this._set("normalizationType",t)}addClassBreakInfo(t,e,r){let i=null;i=typeof t=="number"?new Jn({minValue:t,maxValue:e,symbol:FG(r)}):bwe(k(t)),this.classBreakInfos.push(i),this.classBreakInfos.length===1&&this.notifyChange("minValue")}removeClassBreakInfo(t,e){const r=this.classBreakInfos.length;for(let i=0;i<r;i++){const s=[this.classBreakInfos[i].minValue,this.classBreakInfos[i].maxValue];if(s[0]===t&&s[1]===e){this.classBreakInfos.splice(i,1);break}}}getBreakIndex(t,e){return this.valueExpression&&e?.arcade==null&&q.getLogger(this).warn(""),this.valueExpression?this._getBreakIndexForExpression(t,e):this._getBreakIndexForField(t)}async getClassBreakInfo(t,e){let r=e;this.valueExpression&&e?.arcade==null&&(r={...r,arcade:await jl()});const i=this.getBreakIndex(t,r);return i!==-1?this.classBreakInfos[i]:null}getSymbol(t,e){if(this.valueExpression&&e?.arcade==null)return void q.getLogger(this).error("#getSymbol()","Please use getSymbolAsync if valueExpression is used");const r=this.getBreakIndex(t,e);return r>-1?this.classBreakInfos[r].symbol:this.defaultSymbol}async getSymbolAsync(t,e){let r=e;if(this.valueExpression&&e?.arcade==null){const s=await jl(),{arcadeUtils:n}=s;n.hasGeometryOperations(this.valueExpression)&&await n.enableGeometryOperations(),r={...r,arcade:s}}const i=this.getBreakIndex(t,r);return i>-1?this.classBreakInfos[i].symbol:this.defaultSymbol}get symbols(){const t=[];return this.classBreakInfos.forEach((e=>{e.symbol&&t.push(e.symbol)})),this.defaultSymbol&&t.push(this.defaultSymbol),t}getAttributeHash(){return this.visualVariables?.reduce(((t,e)=>t+e.getAttributeHash()),"")??""}getMeshHash(){const t=JSON.stringify(this.backgroundFillSymbol),e=JSON.stringify(this.defaultSymbol),r=`${this.normalizationField}.${this.normalizationType}.${this.normalizationTotal}`;return`${t}.${e}.${this.classBreakInfos.reduce(((i,s)=>i+s.getMeshHash()),"")}.${r}.${this.field}.${this.valueExpression}`}get arcadeRequired(){return this.arcadeRequiredForVisualVariables||!!this.valueExpression}clone(){return new iC({field:this.field,backgroundFillSymbol:this.backgroundFillSymbol?.clone(),defaultLabel:this.defaultLabel,defaultSymbol:this.defaultSymbol?.clone(),valueExpression:this.valueExpression,valueExpressionTitle:this.valueExpressionTitle,classBreakInfos:k(this.classBreakInfos),isMaxInclusive:this.isMaxInclusive,normalizationField:this.normalizationField,normalizationTotal:this.normalizationTotal,normalizationType:this.normalizationType,visualVariables:k(this.visualVariables),legendOptions:k(this.legendOptions),authoringInfo:k(this.authoringInfo)})}async collectRequiredFields(t,e){const r=[this.collectVVRequiredFields(t,e),this.collectSymbolFields(t,e)];await Promise.all(r)}async collectSymbolFields(t,e){const r=[...this.symbols.map((i=>i.collectRequiredFields(t,e))),si(t,e,this.valueExpression)];Bi(t,e,this.field),Bi(t,e,this.normalizationField),await Promise.all(r)}_getBreakIndexForExpression(t,e){const{viewingMode:r,scale:i,spatialReference:s,arcade:n,timeZone:o}=e??{},{valueExpression:a}=this;let l=this._compiledValueExpression.valueExpression===a?this._compiledValueExpression.compiledFunction:null;const u=n.arcadeUtils;if(!l){const p=u.createSyntaxTree(a);l=u.createFunction(p),this._compiledValueExpression.compiledFunction=l}this._compiledValueExpression.valueExpression=a;const h=u.executeFunction(l,u.createExecContext(t,u.getViewInfo({viewingMode:r,scale:i,spatialReference:s}),o));return this._getBreakIndexfromInfos(h)}_getBreakIndexForField(t){const e=this.field,r=t.attributes,i=this.normalizationType;let s=parseFloat(r[e]);if(i){const n=this.normalizationTotal,o=parseFloat(this.normalizationField?r[this.normalizationField]:void 0);if(i===Yq)s=Math.log(s)*Math.LOG10E;else if(i!==Sb||n==null||isNaN(n)){if(i===xb&&!isNaN(o)){if(isNaN(s)||isNaN(o))return-1;s/=o}}else s=s/n*100}return this._getBreakIndexfromInfos(s)}_getBreakIndexfromInfos(t){const e=this.isMaxInclusive;if(t!=null&&typeof t=="number"&&!isNaN(t))for(let r=0;r<this.classBreakInfos.length;r++){const i=[this.classBreakInfos[r].minValue,this.classBreakInfos[r].maxValue];if(i[0]<=t&&(e?t<=i[1]:t<i[1]))return r}return-1}_areClassBreaksConsecutive(){const t=this.classBreakInfos,e=t.length;for(let r=1;r<e;r++)if(t[r-1].maxValue!==t[r].minValue)return!1;return!0}};c([d(YA)],ur.prototype,"backgroundFillSymbol",void 0),c([d({type:[Jn],json:{write:{isRequired:!0}}})],ur.prototype,"classBreakInfos",void 0),c([K("classBreakInfos")],ur.prototype,"readClassBreakInfos",null),c([re("classBreakInfos")],ur.prototype,"writeClassBreakInfos",null),c([d({type:String,json:{write:!0}})],ur.prototype,"defaultLabel",void 0),c([d(H2)],ur.prototype,"defaultSymbol",void 0),c([d({type:String,json:{write:!0}})],ur.prototype,"field",void 0),c([We("field")],ur.prototype,"castField",null),c([d({type:Boolean})],ur.prototype,"isMaxInclusive",void 0),c([d({type:XA,json:{write:!0}})],ur.prototype,"legendOptions",void 0),c([d({type:Number,readOnly:!0,value:null,json:{read:!1,write:{overridePolicy(){return this.classBreakInfos.length!==0&&this._areClassBreaksConsecutive()?{enabled:!0}:{enabled:!1}}}}})],ur.prototype,"minValue",null),c([d({type:String,json:{write:!0}})],ur.prototype,"normalizationField",void 0),c([d({type:Number,json:{write:!0}})],ur.prototype,"normalizationTotal",void 0),c([d({type:j_.apiValues,value:null,json:{type:j_.jsonValues,read:j_.read,write:j_.write}})],ur.prototype,"normalizationType",null),c([ye({classBreaks:"class-breaks"})],ur.prototype,"type",void 0),c([d({type:String,json:{write:!0}})],ur.prototype,"valueExpression",void 0),c([d({type:String,json:{write:!0}})],ur.prototype,"valueExpressionTitle",void 0),ur=iC=c([C("esri.renderers.ClassBreaksRenderer")],ur);const sC=-3,wwe=sC-1;var dl;(function(t){t[t.ALL=0]="ALL",t[t.SOME=1]="SOME"})(dl||(dl={}));let Swe=class{get size(){return this._size}constructor(e=10485760){this._maxSize=e,this._db=new Map,this._size=0,this._hit=0,this._miss=0,this._users=new Map,this._sizeLimits=new Map}destroy(){this.clearAll(),this._sizeLimits.clear(),this._users.clear()}register(e){this._users.set(e.id.slice(0,-1),e)}deregister(e){this.clear(e),this._sizeLimits.delete(e),this._users.delete(e.id.slice(0,-1))}get maxSize(){return this._maxSize}set maxSize(e){this._maxSize=Math.max(e,-1),this._checkSize()}getSize(e,r){return this._db.get(e.id+r)?.size??0}put(e,r,i,s,n){r=e.id+r;const o=this._db.get(r);if(o&&(this._size-=o.size,e.size-=o.size,this._db.delete(r),o.entry!==i&&this._notifyRemove(r,o.entry,o.size,dl.ALL)),s>this._maxSize)return void this._notifyRemove(r,i,s,dl.ALL);if(i===void 0)return void console.warn("Refusing to cache undefined entry ");if(!s||s<0)return console.warn(`Refusing to cache entry with size ${s} for key ${r}`),void this._notifyRemove(r,i,0,dl.ALL);const a=1+Math.max(n,wwe)-sC;this._db.set(r,new xwe(i,s,a)),this._size+=s,e.size+=s,this._checkSize()}updateSize(e,r,i,s){r=e.id+r;const n=this._db.get(r);if(n&&n.entry===i){for(this._size-=n.size,e.size-=n.size;s>this._maxSize;){const o=this._notifyRemove(r,i,s,dl.SOME);if(!(o!=null&&o>0))return void this._db.delete(r);s=o}n.size=s,this._size+=s,e.size+=s,this._checkSize()}}pop(e,r){r=e.id+r;const i=this._db.get(r);if(i)return this._size-=i.size,e.size-=i.size,this._db.delete(r),++this._hit,i.entry;++this._miss}get(e,r){r=e.id+r;const i=this._db.get(r);if(i!==void 0)return this._db.delete(r),i.lives=i.lifetime,this._db.set(r,i),++this._hit,i.entry;++this._miss}peek(e,r){const i=this._db.get(e.id+r);return i?++this._hit:++this._miss,i?.entry}get performanceInfo(){const e={Size:Math.round(this._size/1048576)+"/"+Math.round(this._maxSize/1048576)+"MB","Hit rate":Math.round(100*this._getHitRate())+"%",Entries:this._db.size.toString()},r={},i=new Array;this._db.forEach(((o,a)=>{const l=o.lifetime;i[l]=(i[l]||0)+o.size,this._users.forEach((u=>{const{id:h,name:p}=u;if(a.startsWith(h)){const m=r[p]||0;r[p]=m+o.size}}))}));const s={};this._users.forEach((o=>{const a=o.name;if("hitRate"in o&&typeof o.hitRate=="number"&&!isNaN(o.hitRate)&&o.hitRate>0){const l=r[a]||0;r[a]=l,s[a]=Math.round(100*o.hitRate)+"%"}else s[a]="0%"}));const n=Object.keys(r);n.sort(((o,a)=>r[a]-r[o])),n.forEach((o=>e[o]=Math.round(r[o]/2**20)+"MB / "+s[o]));for(let o=i.length-1;o>=0;--o){const a=i[o];a&&(e["Priority "+(o+sC-1)]=Math.round(a/this._size*100)+"%")}return e}resetStats(){this._hit=this._miss=0,this._users.forEach((e=>e.resetHitRate()))}clear(e){const r=e.id;this._db.forEach(((i,s)=>{s.startsWith(r)&&(this._size-=i.size,this._db.delete(s),this._notifyRemove(s,i.entry,i.size,dl.ALL))})),e.size=0}clearAll(){this._db.forEach(((e,r)=>this._notifyRemove(r,e.entry,e.size,dl.ALL))),this._users.forEach((e=>e.size=0)),this._size=0,this._db.clear()}*values(e){for(const[r,i]of this._db)r.startsWith(e.id)&&(yield i.entry)}_getHitRate(){return this._hit/(this._hit+this._miss)}_notifyRemove(e,r,i,s){const n=this._users.get(e.split(E$)[0])?.removeFunc,o=n?.(r,s,i);return typeof o=="number"?o:null}_checkSize(){this._sizeLimits.forEach(((e,r)=>this._checkSizeLimits(e,r))),this._checkSizeLimits(this.maxSize)}setMaxSize(e,r){r==null||r<=0?this._sizeLimits.delete(e):this._sizeLimits.set(e,r)}_checkSizeLimits(e,r){const i=r??this;if(i.size<=e)return;const s=r?.id;let n=!0;for(;n;){n=!1;for(const[o,a]of this._db)if(a.lifetime===0&&(!s||o.startsWith(s))){const l=r??this._users.get(o.split(E$)[0]);if(this._purgeItem(o,a,l),i.size<=.9*e)return;n||=this._db.has(o)}}for(const[o,a]of this._db)if(!s||o.startsWith(s)){const l=r??this._users.get(o.split(E$)[0]);if(this._purgeItem(o,a,l),i.size<=.9*e)return}}_purgeItem(e,r,i){if(this._db.delete(e),r.lives<=1){this._size-=r.size,i&&(i.size-=r.size);const s=this._notifyRemove(e,r.entry,r.size,dl.SOME);s!=null&&s>0&&(this._size+=s,i&&(i.size+=s),r.lives=r.lifetime,r.size=s,this._db.set(e,r))}else--r.lives,this._db.set(e,r)}},xwe=class{constructor(e,r,i){this.entry=e,this.size=r,this.lifetime=i,this.lives=i}};const E$=":";let Xq=class{constructor(e,r){this.removeFunc=r,this._storage=new Swe,this.id="",this.name="",this.size=0,this._storage.maxSize=e,this._storage.register(this)}destroy(){this._storage.deregister(this),this._storage.destroy()}put(e,r,i=1){this._storage.put(this,e,r,i,1)}pop(e){return this._storage.pop(this,e)}get(e){return this._storage.get(this,e)}clear(){this._storage.clearAll()}get maxSize(){return this._storage.maxSize}set maxSize(e){this._storage.maxSize=e}resetHitRate(){}},QF=class Kq{static parse(e,r,i){const s=[],n=[],o=e.split(";");for(let a=0;a<o.length;a++){const l=o[a];if(l){if(l.includes("po:")){const u=l.slice(3).split("|");if(u.length===3){const[h,p,m]=u,y=Mwe(h,p,m);y&&n.push(y)}}else if(l.includes("|")){for(const u of l.split("|"))if(r.has(u)){s.push(u);break}}else if(r.has(l))s.push(l);else if(a===0){s.length=0,s.push(Twe(i));break}}}return new Kq(s,n)}constructor(e,r){this.partNames=e,this.overrides=r}};function $we(t,e){if(t==="DashTemplate")return e.split(" ").map((r=>Number(r)));if(t==="Color"){const r=new Q(e).toRgba();return[r[0],r[1],r[2],255*r[3]]}return Number(e)}function Mwe(t,e,r){return{primitiveName:t,propertyName:e,value:$we(e,r),defaultValue:null}}function Twe(t){switch(t){case"esriGeometryPolyline":return"Invalid_L";case"esriGeometryPolygon":return"Invalid_A";default:return"Invalid_P"}}var Zf;let zo=(Zf=class{},Zf.instance=new ps("Etc/UTC"),Zf);function Ewe(t){return t instanceof Cd?t===zo.instance:t?.toString().toLowerCase()==="unknown"}function C6e(t){return Ewe(t)?zo.instance:t}function Iwe(t){return"timeZone"in t}function Cwe(t){return"timeZone"in t}function Pwe(t){return"dateFieldsTimeZone"in t}const Awe=new Map;let tv=class $b{static fromJSON(e){return new $b(e.fields,e.timeZoneByFieldName)}static fromLayer(e){return new $b(e.fields??[],tD(e))}static fromLayerJSON(e){return new $b(e.fields??[],tD(e))}constructor(e=[],r){this._fieldsMap=new Map,this._normalizedFieldsMap=new Map,this._dateFieldsSet=new Set,this._numericFieldsSet=new Set,this._requiredFields=null,this.dateFields=[],this.numericFields=[],this.fields=e||[],this._timeZoneByFieldName=r?new Map(r):null;const i=[];for(const s of this.fields){const n=s?.name,o=eD(n);if(n&&o){const a=Ih(n);this._fieldsMap.set(n,s),this._fieldsMap.set(a,s),this._normalizedFieldsMap.set(o,s),i.push(`${a}:${s.type}:${this._timeZoneByFieldName?.get(n)}`),lA(s)?(this.dateFields.push(s),this._dateFieldsSet.add(s)):nG(s)&&(this._numericFieldsSet.add(s),this.numericFields.push(s)),UO(s)||GO(s)||(s.editable=s.editable==null||!!s.editable,s.nullable=s.nullable==null||!!s.nullable)}}i.sort(),this.uid=i.join()}get requiredFields(){if(!this._requiredFields){this._requiredFields=[];for(const e of this.fields)UO(e)||GO(e)||e.nullable||Mce(e)!==void 0||this._requiredFields.push(e)}return this._requiredFields}equals(e){return this.uid===e?.uid}has(e){return this.get(e)!=null}get(e){if(!e)return;let r=this._fieldsMap.get(e);return r||(r=this._fieldsMap.get(Ih(e))??this._normalizedFieldsMap.get(eD(e)),r&&this._fieldsMap.set(e,r),r)}getTimeZone(e){const r=this.get(e&&typeof e!="string"?e.name:e);return r?this._timeZoneByFieldName?this._timeZoneByFieldName.get(r.name):r.type==="date"||r.type==="esriFieldTypeDate"?(q.getLogger("esri.layers.support.FieldsIndex").errorOnce(new F("getTimeZone:no-timezone-information",`no time zone information for field '${r.name}'`)),$a):Qq.has(r.type)?lc:null:null}getLuxonTimeZone(e){const r=this.getTimeZone(e);return r?r===lc?zo.instance:r===$a?_r.utcInstance:Pm(Awe,r,(()=>ps.create(r))):null}isDateField(e){return this._dateFieldsSet.has(this.get(e))}isTimeOnlyField(e){return aG(this.get(e))}isNumericField(e){return this._numericFieldsSet.has(this.get(e))}normalizeFieldName(e){return this.get(e)?.name??void 0}toJSON(){return{fields:this.fields.map((e=>T0(e)?e.toJSON():e)),timeZoneByFieldName:this._timeZoneByFieldName?Array.from(this._timeZoneByFieldName.entries()):null}}};function Ih(t){return t.trim().toLowerCase()}function eD(t){return hce(t)?.toLowerCase()??""}const Qq=new Set(["time-only","date-only","timestamp-offset","esriFieldTypeDateOnly","esriFieldTypeTimeOnly","esriFieldTypeTimestampOffset"]);function tD(t){const e=new Map;if(!t.fields)return e;const r=t.datesInUnknownTimezone===!0,{timeInfo:i,editFieldsInfo:s}=t,n=(i?"startField"in i?i.startField:i.startTimeField:"")??"",o=(i?"endField"in i?i.endField:i.endTimeField:"")??"",a=Pwe(t)?t.dateFieldsTimeZone??null:t.dateFieldsTimeReference?I1(t.dateFieldsTimeReference):null,l=s?Iwe(s)?s.timeZone??a:s.dateFieldsTimeReference?I1(s.dateFieldsTimeReference):a??$a:null,u=i?Cwe(i)?i.timeZone??a:i.timeReference?I1(i.timeReference):a:null,h=new Map([[Ih(s?.creationDateField??""),l],[Ih(s?.editDateField??""),l],[Ih(n),u],[Ih(o),u]]);for(const{name:p,type:m}of t.fields)if(Qq.has(m))e.set(p,lc);else if(m!=="date"&&m!=="esriFieldTypeDate")e.set(p,null);else if(r)e.set(p,lc);else{const y=h.get(Ih(p??""))??a;e.set(p,y)}return e}var Pe;(function(t){t.AsyncNotEnabled="AsyncNotEnabled",t.ModulesNotSupported="ModulesNotSupported",t.CircularModules="CircularModules",t.CannotCompareDateAndTime="CannotCompareDateAndTime",t.NeverReach="NeverReach",t.UnsupportedHashType="UnsupportedHashType",t.InvalidParameter="InvalidParameter",t.FeatureSetDoesNotHaveSubtypes="FeatureSetDoesNotHaveSubtypes",t.UnexpectedToken="UnexpectedToken",t.Unrecognized="Unrecognized",t.UnrecognizedType="UnrecognizedType",t.MaximumCallDepth="MaximumCallDepth",t.BooleanConditionRequired="BooleanConditionRequired",t.TypeNotAllowedInFeature="TypeNotAllowedInFeature",t.KeyMustBeString="KeyMustBeString",t.WrongNumberOfParameters="WrongNumberOfParameters",t.CallNonFunction="CallNonFunction",t.NoFunctionInTemplateLiteral="NoFunctionInTemplateLiteral",t.NoFunctionInDictionary="NoFunctionInDictionary",t.NoFunctionInArray="NoFunctionInArray",t.AssignModuleFunction="AssignModuleFunction",t.LogicExpressionOrAnd="LogicExpressionOrAnd",t.LogicalExpressionOnlyBoolean="LogicalExpressionOnlyBoolean",t.FunctionNotFound="FunctionNotFound",t.InvalidMemberAccessKey="InvalidMemberAccessKey",t.UnsupportedUnaryOperator="UnsupportUnaryOperator",t.InvalidIdentifier="InvalidIdentifier",t.MemberOfNull="MemberOfNull",t.UnsupportedOperator="UnsupportedOperator",t.Cancelled="Cancelled",t.ModuleAccessorMustBeString="ModuleAccessorMustBeString",t.ModuleExportNotFound="ModuleExportNotFound",t.Immutable="Immutable",t.OutOfBounds="OutOfBounds",t.IllegalResult="IllegalResult",t.FieldNotFound="FieldNotFound",t.PortalRequired="PortalRequired",t.LogicError="LogicError",t.ArrayAccessorMustBeNumber="ArrayAccessMustBeNumber",t.KeyAccessorMustBeString="KeyAccessorMustBeString",t.WrongSpatialReference="WrongSpatialReference",t.CannotChangeTimeZoneTime="CannotChangeTimeZoneTime",t.CannotChangeTimeZoneDateOnly="CannotChangeTimeZoneDateOnly"})(Pe||(Pe={}));const eH={[Pe.TypeNotAllowedInFeature]:"Feature attributes only support dates, numbers, strings, guids.",[Pe.LogicError]:"Logic error - {reason}",[Pe.CannotCompareDateAndTime]:"Cannot compare date or dateonly with timeonly types",[Pe.NeverReach]:"Encountered unreachable logic",[Pe.AsyncNotEnabled]:"Async Arcade must be enabled for this script",[Pe.ModuleAccessorMustBeString]:"Module accessor must be a string",[Pe.ModuleExportNotFound]:"Module has no export with provided identifier",[Pe.ModulesNotSupported]:"Current profile does not support modules",[Pe.ArrayAccessorMustBeNumber]:"Array accessor must be a number",[Pe.FunctionNotFound]:"Function not found",[Pe.FieldNotFound]:"Key not found - {key}",[Pe.CircularModules]:"Circular module dependencies are not allowed",[Pe.Cancelled]:"Execution cancelled",[Pe.UnsupportedHashType]:"Type not supported in hash function",[Pe.IllegalResult]:"Value is not a supported return type",[Pe.PortalRequired]:"Portal is required",[Pe.InvalidParameter]:"Invalid parameter",[Pe.WrongNumberOfParameters]:"Call with wrong number of parameters",[Pe.Unrecognized]:"Unrecognized code structure",[Pe.UnrecognizedType]:"Unrecognized type",[Pe.WrongSpatialReference]:"Cannot work with geometry in this spatial reference. It is different to the execution spatial reference",[Pe.BooleanConditionRequired]:"Conditions must use booleans",[Pe.NoFunctionInDictionary]:"Dictionaries cannot contain functions.",[Pe.NoFunctionInArray]:"Arrays cannot contain functions.",[Pe.NoFunctionInTemplateLiteral]:"Template Literals do not expect functions by value.",[Pe.KeyAccessorMustBeString]:"Accessor must be a string",[Pe.KeyMustBeString]:"Object keys must be a string",[Pe.Immutable]:"Object is immutable",[Pe.UnexpectedToken]:"Unexpected token",[Pe.MemberOfNull]:"Cannot access property of null object",[Pe.MaximumCallDepth]:"Exceeded maximum function depth",[Pe.OutOfBounds]:"Out of bounds",[Pe.InvalidIdentifier]:"Identifier not recognized",[Pe.CallNonFunction]:"Expression is not a function",[Pe.InvalidMemberAccessKey]:"Cannot access value using a key of this type",[Pe.AssignModuleFunction]:"Cannot assign function to module variable",[Pe.UnsupportedUnaryOperator]:"Unsupported unary operator",[Pe.UnsupportedOperator]:"Unsupported operator",[Pe.LogicalExpressionOnlyBoolean]:"Logical expressions must be boolean",[Pe.LogicExpressionOrAnd]:"Logical expression can only be combined with || or &&",[Pe.CannotChangeTimeZoneTime]:"Cannot change the timezone of a Time",[Pe.CannotChangeTimeZoneDateOnly]:"Cannot change the timezone of a DateOnly",[Pe.FeatureSetDoesNotHaveSubtypes]:"FeatureSet does not have subtypes"};let Lwe=class extends Error{constructor(...e){super(...e)}},rD=class tH extends Lwe{constructor(e,r){super(KA(r)+e.message,{cause:e}),this.loc=null,Error.captureStackTrace&&Error.captureStackTrace(this,tH),r?.loc&&(this.loc=r.loc)}},Rwe=class rH extends Error{constructor(e,r,i,s){super("Execution error - "+KA(i)+gc(eH[r],s)),this.loc=null,this.declaredRootClass="esri.arcade.arcadeexecutionerror",Error.captureStackTrace&&Error.captureStackTrace(this,rH),i?.loc&&(this.loc=i.loc)}};function KA(t){return t&&t.loc?`Line : ${t.loc.start?.line}, ${t.loc.start?.column}: `:""}let A6e=class iH extends Error{constructor(e,r,i,s){super("Compilation error - "+KA(i)+gc(eH[r],s)),this.loc=null,this.declaredRootClass="esri.arcade.arcadecompilationerror",Error.captureStackTrace&&Error.captureStackTrace(this,iH),i?.loc&&(this.loc=i.loc)}},L6e=class sH extends Error{constructor(){super("Uncompilable code structures"),this.declaredRootClass="esri.arcade.arcadeuncompilableerror",Error.captureStackTrace&&Error.captureStackTrace(this,sH)}};function R6e(t,e,r){return r.declaredRootClass==="esri.arcade.arcadeexecutionerror"||r.declaredRootClass==="esri.arcade.arcadecompilationerror"?r.loc===null&&e?.loc?new rD(r,{cause:r}):r:(r.declaredRootClass==="esri.arcade.featureset.support.featureseterror"||r.declaredRootClass==="esri.arcade.featureset.support.sqlerror"||r.declaredRootClass,e?.loc?new rD(r,{cause:r}):r)}var mS;(function(t){t.UnrecognizedUri="UnrecognizedUri",t.UnsupportedUriProtocol="UnsupportedUriProtocol"})(mS||(mS={}));const kwe={[mS.UnrecognizedUri]:"Unrecognized uri - {uri}",[mS.UnsupportedUriProtocol]:"Unrecognized uri protocol"};let k6e=class nH extends Error{constructor(e,r){super(gc(kwe[e],r)),this.declaredRootClass="esri.arcade.arcademoduleerror",Error.captureStackTrace&&Error.captureStackTrace(this,nH)}};function Mb(t){return t.toLowerCase().replaceAll(/[\s-]+/g,"")}let O6e=class{constructor(e,r){const i=new Map;for(const s of e){const n=Mb(s);if(i.has(n))throw new Error(`${s} already added as ${i.get(n)}`);i.set(n,s)}if(r!=null)for(const[s,n]of r){const o=Mb(s);if(i.has(o))throw new Error(`${s} already associated with ${i.get(o)}`);i.set(o,n)}this._enumMap=i}lookup(e){return this._enumMap.get(Mb(e))}get(e){const r=this.lookup(e);if(r==null)throw new Rwe(null,Pe.InvalidParameter,null);return r}};var yS;(function(t){t.TimeZoneNotRecognized="TimeZoneNotRecognized"})(yS||(yS={}));const Owe={[yS.TimeZoneNotRecognized]:"Timezone identifier has not been recognized."};let Nwe=class oH extends Error{constructor(e,r){super(gc(Owe[e],r)),this.declaredRootClass="esri.arcade.arcadedate.dateerror",Error.captureStackTrace&&Error.captureStackTrace(this,oH)}};function Kd(t,e,r){return t<e?t-e:t>r?t-r:0}function Qd(t,e,r){return t<e?e:t>r?r:t}let Il=class lr{constructor(e){this._date=e,this.declaredRootClass="esri.arcade.arcadedate"}static fromParts(e=0,r=1,i=1,s=0,n=0,o=0,a=0,l){if(isNaN(e)||isNaN(r)||isNaN(i)||isNaN(s)||isNaN(n)||isNaN(o)||isNaN(a))return null;const u=ue.local(e,r).daysInMonth;let h=ue.fromObject({day:Qd(i,1,u),year:e,month:Qd(r,1,12),hour:Qd(s,0,23),minute:Qd(n,0,59),second:Qd(o,0,59),millisecond:Qd(a,0,999)},{zone:ko(l)});return h=h.plus({months:Kd(r,1,12),days:Kd(i,1,u),hours:Kd(s,0,23),minutes:Kd(n,0,59),seconds:Kd(o,0,59),milliseconds:Kd(a,0,999)}),new lr(h)}static get systemTimeZoneCanonicalName(){return Intl.DateTimeFormat().resolvedOptions().timeZone??"system"}static arcadeDateAndZoneToArcadeDate(e,r){const i=ko(r);return e.isUnknownTimeZone||i===zo.instance?lr.fromParts(e.year,e.monthJS+1,e.day,e.hour,e.minute,e.second,e.millisecond,i):new lr(e._date.setZone(i))}static dateJSToArcadeDate(e){return new lr(ue.fromJSDate(e,{zone:"system"}))}static dateJSAndZoneToArcadeDate(e,r="system"){const i=ko(r);return new lr(ue.fromJSDate(e,{zone:i}))}static unknownEpochToArcadeDate(e){return new lr(ue.fromMillis(e,{zone:zo.instance}))}static unknownDateJSToArcadeDate(e){return new lr(ue.fromMillis(e.getTime(),{zone:zo.instance}))}static epochToArcadeDate(e,r="system"){const i=ko(r);return new lr(ue.fromMillis(e,{zone:i}))}static dateTimeToArcadeDate(e){return new lr(e)}clone(){return new lr(this._date)}changeTimeZone(e){const r=ko(e);return lr.dateTimeToArcadeDate(this._date.setZone(r))}static dateTimeAndZoneToArcadeDate(e,r){const i=ko(r);return e.zone===zo.instance||i===zo.instance?lr.fromParts(e.year,e.month,e.day,e.hour,e.minute,e.second,e.millisecond,i):new lr(e.setZone(i))}static nowToArcadeDate(e){const r=ko(e);return new lr(ue.fromJSDate(new Date,{zone:r}))}static nowUTCToArcadeDate(){return new lr(ue.utc())}get isSystem(){return this.timeZone==="system"||this.timeZone===lr.systemTimeZoneCanonicalName}equals(e){return this.isSystem&&e.isSystem?this.toNumber()===e.toNumber():this.isUnknownTimeZone===e.isUnknownTimeZone&&this._date.equals(e._date)}get isUnknownTimeZone(){return this._date.zone===zo.instance}get isValid(){return this._date.isValid}get hour(){return this._date.hour}get second(){return this._date.second}get day(){return this._date.day}get dayOfWeekISO(){return this._date.weekday}get dayOfWeekJS(){let e=this._date.weekday;return e>6&&(e=0),e}get millisecond(){return this._date.millisecond}get monthISO(){return this._date.month}get weekISO(){return this._date.weekNumber}get yearISO(){return this._date.weekYear}get monthJS(){return this._date.month-1}get year(){return this._date.year}get minute(){return this._date.minute}get zone(){return this._date.zone}get timeZoneOffset(){return this.isUnknownTimeZone?0:this._date.offset}get timeZone(){if(this.isUnknownTimeZone)return"unknown";if(this._date.zone.type==="system")return"system";const e=this.zone;return e.type==="fixed"?e.fixed===0?"UTC":e.formatOffset(0,"short"):e.name}stringify(){return JSON.stringify(this.toJSDate())}plus(e){return new lr(this._date.plus(e))}diff(e,r){return this._date.diff(e._date,r)[r]}toISODate(){return this._date.toISODate()}toISOString(e){return e?this._date.toISO({suppressMilliseconds:!0,includeOffset:!this.isUnknownTimeZone}):this._date.toISO({includeOffset:!this.isUnknownTimeZone})}toISOTime(e,r){return this._date.toISOTime({suppressMilliseconds:e,includeOffset:r&&!this.isUnknownTimeZone})}toFormat(e,r){return this.isUnknownTimeZone&&(e=e.replaceAll("Z","")),this._date.toFormat(e,r)}toJSDate(){return this._date.toJSDate()}toSQLValue(){return this._date.toFormat("yyyy-LL-dd HH:mm:ss")}toSQLWithKeyword(){return`timestamp '${this.toSQLValue()}'`}toDateTime(){return this._date}toNumber(){return this._date.toMillis()}getTime(){return this._date.toMillis()}toUTC(){return new lr(this._date.toUTC())}toLocal(){return new lr(this._date.toLocal())}toString(){return this.toISOString(!0)}static fromReaderAsTimeStampOffset(e){if(!e)return null;const r=ue.fromISO(e,{setZone:!0});return new lr(r)}};function ko(t,e=!0){if(t instanceof Cd)return t;switch(Mb(t)){case"system":return"system";case"utc":return"UTC";case"unknown":return zo.instance}if(/^[+-]?[0-9]{1,2}([:][0-9]{2})?$/.test(t)){const i=_r.parseSpecifier("UTC"+(t.startsWith("+")||t.startsWith("-")?"":"+")+t);if(i)return i}const r=ps.create(t);if(!r.isValid){if(e)throw new Nwe(yS.TimeZoneNotRecognized);return null}return r}function iD(t){t=t.replaceAll(/LTS|LT|L{1,4}|l{1,4}/g,"[$&]");let e="";const r=/(\[[^[]*\])|(\\)?([Hh]mm(ss)?|Mo|M{1,4}|Do|DDDo|D{1,4}|d{2,4}|do?|w[o|w]?|W[o|W]?|Qo?|N{1,5}|YYYYYY|YYYYY|YYYY|YY|y{2,4}|yo?|gg(ggg?)?|GG(GGG?)?|e|E|a|A|hh?|HH?|kk?|mm?|ss?|S{1,9}|x|X|zz?|ZZ?|.)/g;for(const i of t.match(r)||[])switch(i){case"D":e+="d";break;case"DD":e+="dd";break;case"DDD":e+="o";break;case"d":e+="c";break;case"ddd":e+="ccc";break;case"dddd":e+="cccc";break;case"M":e+="L";break;case"MM":e+="LL";break;case"MMM":e+="LLL";break;case"MMMM":e+="LLLL";break;case"YY":e+="yy";break;case"Y":case"YYYY":e+="yyyy";break;case"Q":e+="q";break;case"X":case"x":e+=i;break;default:i.length>=2&&i.slice(0,1)==="["&&i.slice(-1)==="]"?e+=`'${i.slice(1,-1)}'`:e+=`'${i}'`}return e}const sD="esri.core.sql.dateonly";let Fwe=class Ss{constructor(e,r,i){this._year=e,this._month=r,this._day=i,this.declaredRootClass=sD}static isDateOnly(e){return typeof e=="object"&&e!=null&&"declaredRootClass"in e&&e.declaredRootClass===sD}get month(){return this._month}get monthJS(){return this._month-1}get year(){return this._year}get day(){return this._day}get isValid(){return this.toDateTime("unknown").isValid}equals(e){return Ss.isDateOnly(e)&&e.day===this.day&&e.month===this.month&&e.year===this.year}clone(){return new Ss(this._year,this._month,this._day)}toDateTime(e){return ue.fromObject({day:this.day,month:this.month,year:this.year},{zone:ko(e)})}toDateTimeLuxon(e){return ue.fromObject({day:this.day,month:this.month,year:this.year},{zone:ko(e)})}toString(){return`${this.year.toString().padStart(4,"0")}-${this.month.toString().padStart(2,"0")}-${this.day.toString().padStart(2,"0")}`}toFormat(e=null,r=!0){if(e===null||e==="")return this.toString();if(r&&(e=iD(e)),!e)return"";const i=this.toDateTime("unknown");return Il.dateTimeToArcadeDate(i).toFormat(e,{locale:hs(),numberingSystem:"latn"})}toArcadeDate(){const e=this.toDateTime("unknown");return Il.dateTimeToArcadeDate(e)}toNumber(){return this.toDateTime("unknown").toMillis()}toJSDate(){return this.toDateTime("unknown").toJSDate()}toStorageFormat(){return this.toFormat("yyyy-LL-dd",!1)}toSQLValue(){return this.toFormat("yyyy-LL-dd",!1)}toSQLWithKeyword(){return"date '"+this.toFormat("yyyy-LL-dd",!1)+"'"}plus(e,r){return Ss.fromDateTime(this.toUTCDateTime().plus({[e]:r}))}toUTCDateTime(){return ue.utc(this.year,this.month,this.day,0,0,0,0)}difference(e,r){switch(r.toLowerCase()){case"days":case"day":case"d":return this.toUTCDateTime().diff(e.toUTCDateTime(),"days").days;case"months":case"month":return this.toUTCDateTime().diff(e.toUTCDateTime(),"months").months;case"minutes":case"minute":case"m":return r==="M"?this.toUTCDateTime().diff(e.toUTCDateTime(),"months").months:this.toUTCDateTime().diff(e.toUTCDateTime(),"minutes").minutes;case"seconds":case"second":case"s":return this.toUTCDateTime().diff(e.toUTCDateTime(),"seconds").seconds;case"milliseconds":case"millisecond":case"ms":default:return this.toUTCDateTime().diff(e.toUTCDateTime(),"milliseconds").milliseconds;case"hours":case"hour":case"h":return this.toUTCDateTime().diff(e.toUTCDateTime(),"hours").hours;case"years":case"year":case"y":return this.toUTCDateTime().diff(e.toUTCDateTime(),"years").years}}static fromMilliseconds(e){const r=ue.fromMillis(e,{zone:_r.utcInstance});return r.isValid?Ss.fromParts(r.year,r.month,r.day):null}static fromSeconds(e){const r=ue.fromSeconds(e,{zone:_r.utcInstance});return r.isValid?Ss.fromParts(r.year,r.month,r.day):null}static fromReader(e){if(!e)return null;const r=e.split("-");return r.length!==3?null:new Ss(parseInt(r[0],10),parseInt(r[1],10),parseInt(r[2],10))}static fromParts(e,r,i){const s=new Ss(e,r,i);return s.isValid===!1?null:s}static fromDateJS(e){return Ss.fromParts(e.getFullYear(),e.getMonth()+1,e.getDay())}static fromDateTime(e){return Ss.fromParts(e.year,e.month,e.day)}static fromSqlTimeStampOffset(e){return this.fromDateTime(e.toDateTime())}static fromString(e,r=null){if(e===""||e===null)return null;const i=[];if(r)(r=iD(r))&&i.push(r);else if(r===null||r===""){const s=ue.fromISO(e,{setZone:!0});return s.isValid?Ss.fromParts(s.year,s.month,s.day):null}for(const s of i){const n=ue.fromFormat(e,r??s);if(n.isValid)return new Ss(n.year,n.month,n.day)}return null}static fromNow(e="system"){const r=ue.fromJSDate(new Date).setZone(ko(e));return new Ss(r.year,r.month,r.day)}};function F6e(t){if(t==null)return null;switch(t.type){case"polygon":case"multipoint":case"polyline":return t.extent;case"point":return new Le({xmin:t.x,ymin:t.y,xmax:t.x,ymax:t.y,spatialReference:t.spatialReference});case"extent":return t}return null}function D6e(t){if(t==null)return null;const e=t.clone();return t.cache._geVersion!==void 0&&(e.cache._geVersion=t.cache._geVersion),e}function U_(t){return typeof t=="number"&&isFinite(t)&&Math.floor(t)===t}function nD(t){if(!t)return"";const e=/(a|A|hh?|HH?|mm?|ss?|SSS|S|.)/g;let r="";for(const i of t.match(e)||[])switch(i){case"SSS":case"m":case"mm":case"h":case"hh":case"H":case"HH":case"s":case"ss":r+=i;break;case"A":case"a":r+="a";break;default:r+=`'${i}'`}return r}const oD="esri.core.sql.timeonly";let Dwe=class Mo{constructor(e,r,i,s){this._hour=e,this._minute=r,this._second=i,this._millisecond=s,this.declaredRootClass=oD}static isTimeOnly(e){return typeof e=="object"&&e!=null&&"declaredRootClass"in e&&e.declaredRootClass===oD}get hour(){return this._hour}get minute(){return this._minute}get second(){return this._second}get millisecond(){return this._millisecond}equals(e){return Mo.isTimeOnly(e)&&e.hour===this.hour&&e.minute===this.minute&&e.second===this.second&&e.millisecond===this.millisecond}clone(){return new Mo(this.hour,this.minute,this.second,this.millisecond)}isValid(){return U_(this.hour)&&U_(this.minute)&&U_(this.second)&&U_(this.millisecond)&&this.hour>=0&&this.hour<24&&this.minute>=0&&this.minute<60&&this.second>=0&&this.second<60&&this.millisecond>=0&&this.millisecond<1e3}toString(){return`${this.hour.toString().padStart(2,"0")}:${this.minute.toString().padStart(2,"0")}:${this.second.toString().padStart(2,"0")}`+(this.millisecond>0?"."+this.millisecond.toString().padStart(3,"0"):"")}toSQLValue(){return this.toString()}toSQLWithKeyword(){return`time '${this.hour.toString().padStart(2,"0")}:${this.minute.toString().padStart(2,"0")}:${this.second.toString().padStart(2,"0")}${this.millisecond>0?"."+this.millisecond.toString().padStart(3,"0"):""}'`}toStorageString(){return`${this.hour.toString().padStart(2,"0")}:${this.minute.toString().padStart(2,"0")}:${this.second.toString().padStart(2,"0")}`}toFormat(e=null){return e===null||e===""?this.toString():(e=nD(e))?ue.local(1970,1,1,this._hour,this._minute,this._second,this._millisecond).toFormat(e,{locale:hs(),numberingSystem:"latn"}):""}toNumber(){return this.millisecond+1e3*this.second+1e3*this.minute*60+60*this.hour*60*1e3}static fromParts(e,r,i,s){const n=new Mo(e,r,i,s);return n.isValid()?n:null}static fromReader(e){if(!e)return null;const r=e.split(":");return r.length!==3?null:new Mo(parseInt(r[0],10),parseInt(r[1],10),parseInt(r[2],10),0)}static fromMilliseconds(e){if(e>864e5||e<0)return null;const r=Math.floor(e/1e3%60),i=Math.floor(e/6e4%60),s=Math.floor(e/36e5%24),n=Math.floor(e%1e3);return new Mo(s,i,r,n)}static fromDateJS(e){return new Mo(e.getHours(),e.getMinutes(),e.getSeconds(),e.getMilliseconds())}static fromDateTime(e){return new Mo(e.hour,e.minute,e.second,e.millisecond)}static fromSqlTimeStampOffset(e){return this.fromDateTime(e.toDateTime())}static fromString(e,r=null){if(e===""||e===null)return null;const i=[];r?(r=nD(r))&&i.push(r):r!==null&&r!==""||(i.push("HH:mm:ss"),i.push("HH:mm:ss.SSS"),i.push("hh:mm:ss a"),i.push("hh:mm:ss.SSS a"),i.push("HH:mm"),i.push("hh:mm a"),i.push("H:mm"),i.push("h:mm a"),i.push("H:mm:ss"),i.push("h:mm:ss a"),i.push("H:mm:ss.SSS"),i.push("h:mm:ss.SSS a"));for(const s of i){const n=ue.fromFormat(e,s);if(n.isValid)return new Mo(n.hour,n.minute,n.second,n.millisecond)}return null}plus(e,r){switch(e){case"days":case"years":case"months":return this.clone();case"hours":case"minutes":case"seconds":case"milliseconds":return Mo.fromDateTime(this.toUTCDateTime().plus({[e]:r}))}return null}toUTCDateTime(){return ue.utc(1970,1,1,this.hour,this.minute,this.second,this.millisecond)}difference(e,r){switch(r.toLowerCase()){case"days":case"day":case"d":return this.toUTCDateTime().diff(e.toUTCDateTime(),"days").days;case"months":case"month":return this.toUTCDateTime().diff(e.toUTCDateTime(),"months").months;case"minutes":case"minute":case"m":return r==="M"?this.toUTCDateTime().diff(e.toUTCDateTime(),"months").months:this.toUTCDateTime().diff(e.toUTCDateTime(),"minutes").minutes;case"seconds":case"second":case"s":return this.toUTCDateTime().diff(e.toUTCDateTime(),"seconds").seconds;case"milliseconds":case"millisecond":case"ms":default:return this.toUTCDateTime().diff(e.toUTCDateTime(),"milliseconds").milliseconds;case"hours":case"hour":case"h":return this.toUTCDateTime().diff(e.toUTCDateTime(),"hours").hours;case"years":case"year":case"y":return this.toUTCDateTime().diff(e.toUTCDateTime(),"years").years}}};const zwe=["geometry","scale","timeProperties"];function z6e(t,e){if(e!=null)for(const r of zwe)e.hasArcadeDependency(r)&&t.add(r);return t}function Vwe(t,e){return aH.create(t,e,null,["$feature","$view"])}function jwe(t,e,r){return aH.create(t,e,r,["$feature","$view","$config"])}let aH=class lH{static async create(e,r,i,s){const{arcade:n,Dictionary:o}=await jl();let a;try{a=n.parseScript(e)}catch(y){throw new F("arcade-bad-expression","Failed to parse arcade script",{script:e,error:y})}const l=n.scriptUsesGeometryEngine(a);l&&await n.enableGeometrySupport(),await n.loadDependentModules(new Set,a,null,!1,l);const u={vars:s.reduce(((y,g)=>({...y,[g]:null})),{}),spatialReference:r,useAsync:!1},h=n.compileScript(a,u);let p=null;i!=null&&(p=new o(i),p.immutable=!0);const m=new o;return m.immutable=!1,m.setField("scale",0),new lH(e,n,a,h,r,m,p,o)}constructor(e,r,i,s,n,o,a,l){this.script=e,this._arcade=r,this._syntaxTree=i,this._compiled=s,this._spatialReference=n,this._viewDict=o,this._configDict=a,this._dictionaryCtor=l,this._dependencies=new Map,this._featureReader=new uH,this._dependencies.set("geometry",r.scriptTouchesGeometry(this._syntaxTree)),this._dependencies.set("scale",this._arcade.referencesMember(this._syntaxTree,"scale")),this._dependencies.set("timeProperties",this._arcade.scriptUsesViewProperties(this._syntaxTree,["timeProperties"]))}evaluate(e,r){const i=r.$view?.timeZone;if(r.$view){let s;if(this._viewDict.setField("scale",r.$view.scale),r.$view.timeProperties!=null){const{currentStart:n,currentEnd:o}=r.$view.timeProperties;s=new this._dictionaryCtor({currentStart:n!=null?i!=null?Il.epochToArcadeDate(n,i):Il.unknownEpochToArcadeDate(n):void 0,currentEnd:o!=null?i!=null?Il.epochToArcadeDate(o,i):Il.unknownEpochToArcadeDate(o):void 0,startIncluded:!0,endIncluded:!0})}this._viewDict.setField("timeProperties",s)}return this._compiled({vars:{$view:this._viewDict,$config:this._configDict,$feature:e},spatialReference:this._spatialReference,timeZone:i})}repurposeFeature(e,r){return this._featureReader.bind(e,r,this._spatialReference),this._featureReader}references(e){return this._dependencies.get(e)??!1}},uH=class{constructor(){this._boundTarget=null,this._boundSchema={fields:null,fieldsIndex:null,spatialReference:null,get geometryType(){return null},get objectIdField(){return null}},this.arcadeDeclaredClass="esri.arcade.Feature",this._contextTimeZone=null}bind(e,r,i){const s=r??new tv(cH(e.attributes));this._boundTarget=e,this._boundSchema.fields=s.fields,this._boundSchema.fieldsIndex=s,this._boundSchema.spatialReference=i}_getField(e){return this._boundSchema.fieldsIndex.get(e)}get contextTimeZone(){return this._contextTimeZone}set contextTimeZone(e){this._contextTimeZone=e}readArcadeFeature(){return this}hasField(e){return this._boundSchema.fieldsIndex.has(e)}geometry(){if("fromJSON"in this._boundTarget)return this._boundTarget.geometry;const e=hc(this._boundTarget.geometry);if(e){if(!this._boundSchema.spatialReference)throw new Error("InternalError: Expected spatial reference to be defined");e.spatialReference=this._boundSchema.spatialReference}return e}isUnknownDateTimeField(e){return this._boundSchema.fieldsIndex.getTimeZone(e)===lc}field(e,r=!0){const i=this._getField(e);if(i){const s=this._boundTarget.attributes[i.name];if(s==null)return null;switch(i.type){case"date-only":case"esriFieldTypeDateOnly":return Fwe.fromReader(s);case"time-only":case"esriFieldTypeTimeOnly":return Dwe.fromReader(s);case"esriFieldTypeTimestampOffset":case"timestamp-offset":return Il.fromReaderAsTimeStampOffset(s);case"date":case"esriFieldTypeDate":return this.isUnknownDateTimeField(e)?Il.unknownEpochToArcadeDate(s):Il.epochToArcadeDate(s,this.contextTimeZone??uo);default:return s}}if(r)throw new Error(`Field ${e} does not exist`);return null}setField(e,r){throw new Error("Unable to update feature attribute values, feature is readonly")}keys(){return this._boundSchema.fieldsIndex.fields.map((e=>e.name))}castToText(e=!1){return JSON.stringify(this._boundTarget)}gdbVersion(){return null}fullSchema(){return this._boundSchema}castAsJson(e=null){return{attributes:this._boundTarget.attributes,geometry:e?.keepGeometryType===!0?this.geometry():this.geometry()?.toJSON()??null}}castAsJsonAsync(e=null,r=null){return Promise.resolve(this.castAsJson(r))}};function cH(t){const e=[];for(const r in t)e.push({name:r,alias:r,type:typeof t[r]=="string"?"esriFieldTypeString":"esriFieldTypeDouble"});return e}let Uwe=class hH{static async from(e,r,i){const s=e.dictionary_version?_q.parse(e.dictionary_version):null,n=new Set(e.itemsNames),o={};if(r)for(const p in r)o[p]=r[p];if(e.authoringInfo.configuration)for(const p of e.authoringInfo.configuration)o.hasOwnProperty(p.name)||(o[p.name]=p.value);const a=new Set(e.authoringInfo.symbol);for(const p of Object.keys(i))a.delete(p);a.size&&q.getLogger("esri.renderers.support.DictionaryScriptEvaluator").warnOnce("missing-fields: fieldMap entries for the following symbol fields are missing",{symbolFields:a});const l=await jwe(e.expression,null,o);if(!l)throw new F("dictionary-renderer:expression-error","Unable to create dictionary renderer expression");const u=!s||!s.greaterEqual(4,0);u&&q.getLogger("esri.renderers.support.DictionaryScriptEvaluator").warnOnce("Dictionary script does not support native field types. Applying fallback",{version:s});const h=new Gwe(i,u);return new hH(u,n,l,h)}constructor(e,r,i,s){this._requiresFieldCoercionToString=e,this._itemNames=r,this._compiled=i,this._reader=s}get itemNames(){return this._itemNames}evaluate(e,r,i,s){try{return this._reader.bind(e,i,s),this._compiled.evaluate(this._reader,{$view:{scale:r}})}catch(n){q.getLogger("esri.renderers.support.DictionaryScriptEvaluator").warnOnce("arcade: dictionary script evaluation failed",{error:n})}return null}createDictionaryFieldsIndex(e){if(!this._requiresFieldCoercionToString)return new tv(e);const r=e.map((i=>({...i,type:"esriFieldTypeString"})));return new tv(r)}},Gwe=class extends uH{constructor(e,r){super(),this._fieldMap=e,this._requiresFieldCoercionToString=r}_getField(e){const r=this._fieldMap[e]??e;return this._boundSchema.fieldsIndex.get(r)}field(e){if(!this._requiresFieldCoercionToString)return super.field(e,!1);const r=this._getField(e);return r==null||this._boundTarget.attributes[r.name]==null?"":""+this._boundTarget.attributes[r.name]}};var aD,lD,uD,cD,ya,hD,nC,oC,aC,dD,lC,uC,pD,fD,mD,yD,cC,hC,gD,vD,If,Ie,Ch,gS,_D,Cl,bD,wD,of,dC,SD,xD,$D,MD,TD,ED,ID,us,Qr,CD,PD,pn,AD,LD,RD,kD,Un,g0,Ph,af,OD,ND,FD,pC,DD,vS,zD,_S,lf,VD,fC,jD,UD;(function(t){t[t.BUTT=0]="BUTT",t[t.ROUND=1]="ROUND",t[t.SQUARE=2]="SQUARE",t[t.UNKNOWN=4]="UNKNOWN"})(aD||(aD={})),(function(t){t[t.BEVEL=0]="BEVEL",t[t.ROUND=1]="ROUND",t[t.MITER=2]="MITER",t[t.UNKNOWN=4]="UNKNOWN"})(lD||(lD={})),(function(t){t[t.SCREEN=0]="SCREEN",t[t.MAP=1]="MAP"})(uD||(uD={})),(function(t){t[t.Tint=0]="Tint",t[t.Ignore=1]="Ignore",t[t.Multiply=99]="Multiply"})(cD||(cD={})),(function(t){t.Both="Both",t.JustBegin="JustBegin",t.JustEnd="JustEnd",t.None="None"})(ya||(ya={})),(function(t){t[t.Mosaic=0]="Mosaic",t[t.Centered=1]="Centered"})(hD||(hD={})),(function(t){t[t.Normal=0]="Normal",t[t.Superscript=1]="Superscript",t[t.Subscript=2]="Subscript"})(nC||(nC={})),(function(t){t[t.MSSymbol=0]="MSSymbol",t[t.Unicode=1]="Unicode"})(oC||(oC={})),(function(t){t[t.Unspecified=0]="Unspecified",t[t.TrueType=1]="TrueType",t[t.PSOpenType=2]="PSOpenType",t[t.TTOpenType=3]="TTOpenType",t[t.Type1=4]="Type1"})(aC||(aC={})),(function(t){t[t.Display=0]="Display",t[t.Map=1]="Map"})(dD||(dD={})),(function(t){t.None="None",t.Loop="Loop",t.Oscillate="Oscillate"})(lC||(lC={})),(function(t){t.Linear="Linear",t.EaseIn="EaseIn",t.EaseOut="EaseOut",t.EaseInOut="EaseInOut"})(uC||(uC={})),(function(t){t[t.Z=0]="Z",t[t.X=1]="X",t[t.Y=2]="Y"})(pD||(pD={})),(function(t){t[t.XYZ=0]="XYZ",t[t.ZXY=1]="ZXY",t[t.YXZ=2]="YXZ"})(fD||(fD={})),(function(t){t[t.Rectangle=0]="Rectangle",t[t.RoundedRectangle=1]="RoundedRectangle",t[t.Oval=2]="Oval"})(mD||(mD={})),(function(t){t[t.None=0]="None",t[t.Alpha=1]="Alpha",t[t.Screen=2]="Screen",t[t.Multiply=3]="Multiply",t[t.Add=4]="Add"})(yD||(yD={})),(function(t){t[t.TTB=0]="TTB",t[t.RTL=1]="RTL",t[t.BTT=2]="BTT"})(cC||(cC={})),(function(t){t[t.None=0]="None",t[t.SignPost=1]="SignPost",t[t.FaceNearPlane=2]="FaceNearPlane"})(hC||(hC={})),(function(t){t[t.Float=0]="Float",t[t.String=1]="String",t[t.Boolean=2]="Boolean"})(gD||(gD={})),(function(t){t[t.Intersect=0]="Intersect",t[t.Subtract=1]="Subtract"})(vD||(vD={})),(function(t){t.OpenEnded="OpenEnded",t.Block="Block",t.Crossed="Crossed"})(If||(If={})),(function(t){t.FullGeometry="FullGeometry",t.PerpendicularFromFirstSegment="PerpendicularFromFirstSegment",t.ReversedFirstSegment="ReversedFirstSegment",t.PerpendicularToSecondSegment="PerpendicularToSecondSegment",t.SecondSegmentWithTicks="SecondSegmentWithTicks",t.DoublePerpendicular="DoublePerpendicular",t.OppositeToFirstSegment="OppositeToFirstSegment",t.TriplePerpendicular="TriplePerpendicular",t.HalfCircleFirstSegment="HalfCircleFirstSegment",t.HalfCircleSecondSegment="HalfCircleSecondSegment",t.HalfCircleExtended="HalfCircleExtended",t.OpenCircle="OpenCircle",t.CoverageEdgesWithTicks="CoverageEdgesWithTicks",t.GapExtentWithDoubleTicks="GapExtentWithDoubleTicks",t.GapExtentMidline="GapExtentMidline",t.Chevron="Chevron",t.PerpendicularWithArc="PerpendicularWithArc",t.ClosedHalfCircle="ClosedHalfCircle",t.TripleParallelExtended="TripleParallelExtended",t.ParallelWithTicks="ParallelWithTicks",t.Parallel="Parallel",t.PerpendicularToFirstSegment="PerpendicularToFirstSegment",t.ParallelOffset="ParallelOffset",t.OffsetOpposite="OffsetOpposite",t.OffsetSame="OffsetSame",t.CircleWithArc="CircleWithArc",t.DoubleJog="DoubleJog",t.PerpendicularOffset="PerpendicularOffset",t.LineExcludingLastSegment="LineExcludingLastSegment",t.MultivertexArrow="MultivertexArrow",t.CrossedArrow="CrossedArrow",t.ChevronArrow="ChevronArrow",t.ChevronArrowOffset="ChevronArrowOffset",t.PartialFirstSegment="PartialFirstSegment",t.Arch="Arch",t.CurvedParallelTicks="CurvedParallelTicks",t.Arc90Degrees="Arc90Degrees",t.TipWithPerpendicularAndTicks="TipWithPerpendicularAndTicks",t.ConcentricCircles="ConcentricCircles",t.DoubleJogArrow="DoubleJogArrow",t.LinkedChevrons="LinkedChevrons",t.SegmentThenHalfCircle="SegmentThenHalfCircle",t.LineWithStraightTicks="LineWithStraightTicks",t.DoubleCurve="DoubleCurve",t.ParallelWithTicksByWidth="ParallelWithTicksByWidth",t.EnclosingRoundedRectangle="EnclosingRoundedRectangle"})(Ie||(Ie={})),(function(t){t.Mitered="Mitered",t.Bevelled="Bevelled",t.Rounded="Rounded",t.Square="Square",t.TrueBuffer="TrueBuffer"})(Ch||(Ch={})),(function(t){t.ClosePath="ClosePath",t.ConvexHull="ConvexHull",t.RectangularBox="RectangularBox"})(gS||(gS={})),(function(t){t.BeginningOfLine="BeginningOfLine",t.EndOfLine="EndOfLine"})(_D||(_D={})),(function(t){t.Mitered="Mitered",t.Bevelled="Bevelled",t.Rounded="Rounded",t.Square="Square"})(Cl||(Cl={})),(function(t){t.Fast="Fast",t.Accurate="Accurate"})(bD||(bD={})),(function(t){t.BeginningOfLine="BeginningOfLine",t.EndOfLine="EndOfLine"})(wD||(wD={})),(function(t){t.Sinus="Sinus",t.Square="Square",t.Triangle="Triangle",t.Random="Random"})(of||(of={})),(function(t){t[t.None=0]="None",t[t.Default=1]="Default",t[t.Force=2]="Force"})(dC||(dC={})),(function(t){t[t.Buffered=0]="Buffered",t[t.Left=1]="Left",t[t.Right=2]="Right",t[t.AlongLine=3]="AlongLine"})(SD||(SD={})),(function(t){t[t.Linear=0]="Linear",t[t.Rectangular=1]="Rectangular",t[t.Circular=2]="Circular",t[t.Buffered=3]="Buffered"})(xD||(xD={})),(function(t){t[t.Discrete=0]="Discrete",t[t.Continuous=1]="Continuous"})($D||($D={})),(function(t){t[t.AcrossLine=0]="AcrossLine",t[t.AlongLine=1]="AlongLine"})(MD||(MD={})),(function(t){t[t.Auto=0]="Auto",t[t.Clockwise=1]="Clockwise",t[t.Counterclockwise=2]="Counterclockwise"})(TD||(TD={})),(function(t){t[t.Left=0]="Left",t[t.Right=1]="Right",t[t.Center=2]="Center",t[t.Justify=3]="Justify"})(ED||(ED={})),(function(t){t[t.Base=0]="Base",t[t.MidPoint=1]="MidPoint",t[t.ThreePoint=2]="ThreePoint",t[t.FourPoint=3]="FourPoint",t[t.Underline=4]="Underline",t[t.CircularCW=5]="CircularCW",t[t.CircularCCW=6]="CircularCCW"})(ID||(ID={})),(function(t){t.Butt="Butt",t.Round="Round",t.Square="Square"})(us||(us={})),(function(t){t.NoConstraint="NoConstraint",t.HalfPattern="HalfPattern",t.HalfGap="HalfGap",t.FullPattern="FullPattern",t.FullGap="FullGap",t.Custom="Custom"})(Qr||(Qr={})),(function(t){t[t.None=-1]="None",t[t.Custom=0]="Custom",t[t.Circle=1]="Circle",t[t.OpenArrow=2]="OpenArrow",t[t.ClosedArrow=3]="ClosedArrow",t[t.Diamond=4]="Diamond"})(CD||(CD={})),(function(t){t[t.ExtraLeading=0]="ExtraLeading",t[t.Multiple=1]="Multiple",t[t.Exact=2]="Exact"})(PD||(PD={})),(function(t){t.Bevel="Bevel",t.Round="Round",t.Miter="Miter"})(pn||(pn={})),(function(t){t[t.Default=0]="Default",t[t.String=1]="String",t[t.Numeric=2]="Numeric"})(AD||(AD={})),(function(t){t[t.InsidePolygon=0]="InsidePolygon",t[t.PolygonCenter=1]="PolygonCenter",t[t.RandomlyInsidePolygon=2]="RandomlyInsidePolygon"})(LD||(LD={})),(function(t){t[t.Tint=0]="Tint",t[t.Replace=1]="Replace",t[t.Multiply=2]="Multiply"})(RD||(RD={})),(function(t){t[t.ClipAtBoundary=0]="ClipAtBoundary",t[t.RemoveIfCenterOutsideBoundary=1]="RemoveIfCenterOutsideBoundary",t[t.DoNotTouchBoundary=2]="DoNotTouchBoundary",t[t.DoNotClip=3]="DoNotClip"})(kD||(kD={})),(function(t){t.NoConstraint="NoConstraint",t.WithMarkers="WithMarkers",t.WithFullGap="WithFullGap",t.WithHalfGap="WithHalfGap",t.Custom="Custom"})(Un||(Un={})),(function(t){t.Fixed="Fixed",t.Random="Random",t.RandomFixedQuantity="RandomFixedQuantity"})(g0||(g0={})),(function(t){t.LineMiddle="LineMiddle",t.LineBeginning="LineBeginning",t.LineEnd="LineEnd",t.SegmentMidpoint="SegmentMidpoint"})(Ph||(Ph={})),(function(t){t.OnPolygon="OnPolygon",t.CenterOfMass="CenterOfMass",t.BoundingBoxCenter="BoundingBoxCenter"})(af||(af={})),(function(t){t[t.Low=0]="Low",t[t.Medium=1]="Medium",t[t.High=2]="High"})(OD||(OD={})),(function(t){t[t.MarkerCenter=0]="MarkerCenter",t[t.MarkerBounds=1]="MarkerBounds"})(ND||(ND={})),(function(t){t[t.None=0]="None",t[t.PropUniform=1]="PropUniform",t[t.PropNonuniform=2]="PropNonuniform",t[t.DifUniform=3]="DifUniform",t[t.DifNonuniform=4]="DifNonuniform"})(FD||(FD={})),(function(t){t.Tube="Tube",t.Strip="Strip",t.Wall="Wall"})(pC||(pC={})),(function(t){t[t.Random=0]="Random",t[t.Increasing=1]="Increasing",t[t.Decreasing=2]="Decreasing",t[t.IncreasingThenDecreasing=3]="IncreasingThenDecreasing"})(DD||(DD={})),(function(t){t[t.Relative=0]="Relative",t[t.Absolute=1]="Absolute"})(vS||(vS={})),(function(t){t[t.Normal=0]="Normal",t[t.LowerCase=1]="LowerCase",t[t.Allcaps=2]="Allcaps"})(zD||(zD={})),(function(t){t[t.LTR=0]="LTR",t[t.RTL=1]="RTL"})(_S||(_S={})),(function(t){t.Draft="Draft",t.Picture="Picture",t.Text="Text"})(lf||(lf={})),(function(t){t[t.Top=0]="Top",t[t.Center=1]="Center",t[t.Baseline=2]="Baseline",t[t.Bottom=3]="Bottom"})(VD||(VD={})),(function(t){t[t.Right=0]="Right",t[t.Upright=1]="Upright"})(fC||(fC={})),(function(t){t[t.Small=0]="Small",t[t.Medium=1]="Medium",t[t.Large=2]="Large"})(jD||(jD={})),(function(t){t[t.Calm=0]="Calm",t[t.Rippled=1]="Rippled",t[t.Slight=2]="Slight",t[t.Moderate=3]="Moderate"})(UD||(UD={}));const Bwe={color:[128,128,128,1],outlinecolor:[0,0,0,1],backgroundcolor:[128,128,128,1],borderlinecolor:[0,0,0,1],tintcolor:[255,255,255,1]},ar={CIMVectorMarker:{scalesymbolsproportionally:!1,respectframe:!0,anchorpointunits:"Relative",offsetx:0,offsety:0,rotateclockwise:!1,rotation:0,size:10,enable:!0,colorlocked:!1},CIMPictureMarker:{scalex:1,texturefilter:"Draft",anchorpointunits:"Relative",offsetx:0,offsety:0,rotateclockwise:!1,rotation:0,size:10,enable:!0,colorlocked:!1},CIMTextSymbol:{angle:0,anglex:0,angley:0,halosize:1,height:10,horizontalalignment:"Left",kerning:!0,letterspacing:0,letterwidth:100,ligatures:!0,linegap:0,offsetx:0,offsety:0,strikethrough:!1,textcase:"Normal",textstring:"",underline:!1,verticalalignment:"Bottom",enable:!0,colorlocked:!1},CIMSolidStroke:{capstyle:"Round",joinstyle:"Round",miterlimit:4,width:4,enable:!0,colorlocked:!1},CIMPictureStroke:{texturefilter:"Draft",capstyle:"Round",joinstyle:"Round",miterlimit:4,width:4,enable:!0,colorlocked:!1},CIMGradientStroke:{capstyle:"Round",joinstyle:"Round",miterlimit:4,width:4,enable:!0,colorlocked:!1,gradientMethod:"AcrossLine",gradientSize:75,gradientSizeUnits:vS.Relative,gradientType:"Discrete",interval:5},CIMSolidFill:{enable:!0,colorlocked:!1},CIMPictureFill:{offsetx:0,offsety:0,rotation:0,scalex:1,height:10,texturefilter:"Draft",enable:!0,colorlocked:!1},CIMHatchFill:{offsetx:0,offsety:0,rotation:0,separation:4,enable:!0,colorlocked:!1},CIMGradientFill:{enable:!0,angle:90,gradientMethod:"Linear",gradientSize:75,gradientSizeUnits:vS.Relative,gradientType:"Discrete",interval:5},CIMGeometricEffectAddControlPoints:{angletolerance:120},CIMGeometricEffectArrow:{arrowtype:"OpenEnded",width:5},CIMGeometricEffectBuffer:{size:1},CIMGeometricEffectCut:{begincut:1,endcut:1,middlecut:0,invert:!1},CIMGeometricEffectDashes:{customendingoffset:0,linedashending:"NoConstraint",offsetalongline:0},CIMGeometricEffectDonut:{method:"Mitered",option:"Accurate",width:2},CIMGeometricEffectJog:{angle:225,length:20,position:50},CIMGeometricEffectControlMeasureLine:{rule:"FullGeometry"},CIMGeometricEffectMove:{offsetx:1,offsety:-1},CIMGeometricEffectOffset:{method:"Square",offset:1,option:"Fast"},CIMGeometricEffectRadial:{angle:0,length:5},CIMGeometricEffectRotate:{angle:15},CIMGeometricEffectScale:{xscalefactor:1.15,yscalefactor:1.15},CIMGeometricEffectWave:{amplitude:2,period:3,seed:1,waveform:"Sinus"},CIMMarkerPlacementAlongLine:{customendingoffset:0,endings:"WithHalfGap",offsetalongline:0,placeperpart:!0,angletoline:!0,offset:0},CIMMarkerPlacementAtExtremities:{extremityplacement:"Both",offsetalongline:0,angletoline:!0,offset:0},CIMMarkerPlacementAtRatioPositions:{beginposition:0,endposition:0,flipfirst:!0,angletoline:!0,offset:0},CIMMarkerPlacementInsidePolygon:{gridangle:0,gridtype:"Fixed",offsetx:0,offsety:0,randomness:100,seed:0,shiftoddrows:!1,stepx:16,stepy:16,clipping:"ClipAtBoundary"},CIMMarkerPlacementOnLine:{relativeto:"LineMiddle",startpointoffset:0,angletoline:!0,offset:0},CIMMarkerPlacementOnVertices:{placeperpart:!0,placeoncontrolpoints:!0,placeonendpoints:!0,placeonregularvertices:!0,angletoline:!0,offset:0},CIMMarkerPlacementPolygonCenter:{method:"OnPolygon",offsetx:0,offsety:0,clipatboundary:!1},CIMAnimatedSymbolProperties:{playanimation:!1,reverseanimation:!1,randomizestarttime:!1,randomizestartseed:0,starttimeoffset:0,duration:3,endingduration:3,useendingduration:!1,repeattype:lC.Loop,repeatdelay:0,easing:uC.Linear},CIMSymbolAnimationSize:{tosize:10},CIMSymbolAnimationScale:{scalefactor:1},CIMSymbolAnimationColor:{tocolor:[255,255,255,1]},CIMSymbolAnimationTransparency:{totransparency:0},CIMSymbolAnimationRotation:{torotation:0,rotateclockwise:!1},CIMSymbolAnimationOffset:{offsetx:0,offsety:0},CIMSymbolAnimationMoveAlongLine:{speed:30,distanceAlong:100}};function qwe(t){return typeof t=="function"}function U6e(t,e,r,i){return qwe(t)?t(e,r,i):t}function G6e(t){return[t.r,t.g,t.b,t.a]}const Hwe=` /-,
`;function GD(t){let e=t.length;for(;e--;)if(!Hwe.includes(t.charAt(e)))return!1;return!0}function Wwe(t,e){const r=[];let i=0,s=-1;do if(s=t.indexOf("[",i),s>=i){if(s>i){const n=t.slice(i,s);r.push([n,null,GD(n)])}if(i=s+1,s=t.indexOf("]",i),s>=i){if(s>i){const n=e[t.slice(i,s)];n&&r.push([null,n,!1])}i=s+1}}while(s!==-1);if(i<t.length){const n=t.slice(i);r.push([n,null,GD(n)])}return r}function B6e(t,e,r){let i="",s=null;for(const n of e){const[o,a,l]=n;if(o!=null&&o!=="")l?s=o:(s!=null&&(i+=s,s=null),i+=o);else{const u=t.readAttribute(a);u!=null&&u!==""&&(s!==null&&(i+=s,s=null),i+=u)}}return dH(i,r)}function Zwe(t,e,r,i){let s="",n=null;for(const o of e){const[a,l,u]=o;if(a!=null&&a!=="")u?n=a:(n!=null&&(s+=n,n=null),s+=a);else{let h=l;r!=null&&(h=lSe(l,r));const p=t.attributes[h];p!=null&&p!==""&&(n!=null&&(s+=n,n=null),s+=p)}}return dH(s,i)}function dH(t,e){switch(typeof t!="string"&&(t=String(t)),e){case"LowerCase":return t.toLowerCase();case"Allcaps":return t.toUpperCase();default:return t}}function q6e(t,e,r,i,s,n,o=!0){const a=e/s,l=r/n,u=Math.ceil(a/2),h=Math.ceil(l/2);for(let p=0;p<n;p++)for(let m=0;m<s;m++){const y=4*(m+(o?n-p-1:p)*s);let g=0,v=0,_=0,b=0,S=0,$=0,T=0;const I=(p+.5)*l;for(let P=Math.floor(p*l);P<(p+1)*l;P++){const R=Math.abs(I-(P+.5))/h,D=(m+.5)*a,V=R*R;for(let U=Math.floor(m*a);U<(m+1)*a;U++){let Z=Math.abs(D-(U+.5))/u;const X=Math.sqrt(V+Z*Z);X>=-1&&X<=1&&(g=2*X*X*X-3*X*X+1,g>0&&(Z=4*(U+P*e),T+=g*t[Z+3],_+=g,t[Z+3]<255&&(g=g*t[Z+3]/250),b+=g*t[Z],S+=g*t[Z+1],$+=g*t[Z+2],v+=g))}}i[y]=b/v,i[y+1]=S/v,i[y+2]=$/v,i[y+3]=T/_}}function pH(t){return t?[t[0],t[1],t[2],t[3]/255]:[0,0,0,0]}function QA(t){return t.data?.symbol??null}function eL(t){return t.type==="CIMVectorMarker"||t.type==="CIMPictureMarker"||t.type==="CIMBarChartMarker"||t.type==="CIMCharacterMarker"||t.type==="CIMPieChartMarker"||t.type==="CIMStackedBarChartMarker"}function fH(t){return t.type==="CIMGradientStroke"||t.type==="CIMPictureStroke"||t.type==="CIMSolidStroke"}function Jwe(t){return t!=null&&(t.type==="CIMGradientFill"||t.type==="CIMHatchFill"||t.type==="CIMPictureFill"||t.type==="CIMSolidFill"||t.type==="CIMWaterFill")}function W2(t){return t!=null&&(t.type==="CIMMarkerPlacementAlongLineRandomSize"||t.type==="CIMMarkerPlacementAlongLineSameSize"||t.type==="CIMMarkerPlacementAlongLineVariableSize"||t.type==="CIMMarkerPlacementAtExtremities"||t.type==="CIMMarkerPlacementAtMeasuredUnits"||t.type==="CIMMarkerPlacementAtRatioPositions"||t.type==="CIMMarkerPlacementOnLine"||t.type==="CIMMarkerPlacementOnVertices")}const Me=(t,e=0)=>t==null||isNaN(t)?e:t,H6e=(t,e)=>t??e,W6e=(t,e)=>t??e,Z6e=t=>t.tintColor?pH(t.tintColor):[255,255,255,1],Ywe=t=>{if(!t)return!1;for(const e of t)switch(e.type){case"CIMGeometricEffectBuffer":case"CIMGeometricEffectDonut":case"CIMGeometricEffectOffset":case"CIMGeometricEffectTaperedPolygon":case"CIMGeometricEffectEnclosingPolygon":return!0}return!1};function Xwe(){return J(()=>import("./geometryEngineJSON-CO8CMyeT.js").then(t=>t.g),__vite__mapDeps([20,12,13,21]))}function Kwe(t){if(!t)return"normal";switch(t.toLowerCase()){case"italic":return"italic";case"oblique":return"oblique";default:return"normal"}}function Qwe(t){if(!t)return"normal";switch(t.toLowerCase()){case"bold":return"bold";case"bolder":return"bolder";case"lighter":return"lighter";default:return"normal"}}function mH(t){let e="normal",r="normal";if(t){const i=t.toLowerCase();i.includes("italic")?e="italic":i.includes("oblique")&&(e="oblique"),i.includes("bold")?r="bold":i.includes("light")&&(r="lighter")}return{style:e,weight:r}}function yH(t){return t.underline?"underline":t.strikethrough?"line-through":"none"}function v0(t){if(!t)return null;switch(t.type){case"CIMPolygonSymbol":if(t.symbolLayers)for(const e of t.symbolLayers){const r=v0(e);if(r!=null)return r}break;case"CIMTextSymbol":return v0(t.symbol);case"CIMSolidFill":return t.color}return null}function bS(t){if(t)switch(t.type){case"CIMPolygonSymbol":case"CIMLineSymbol":{const e=t.symbolLayers;if(e)for(const r of e){const i=bS(r);if(i!=null)return i}break}case"CIMTextSymbol":return bS(t.symbol);case"CIMSolidStroke":return t.color}}function J6e(t){for(const e of t)if(e.enable)switch(e.type){case"CIMSolidStroke":case"CIMGradientStroke":case"CIMPictureStroke":return!0}return!1}function wS(t){if(t)switch(t.type){case"CIMPolygonSymbol":case"CIMLineSymbol":if(t.symbolLayers)for(const e of t.symbolLayers){const r=wS(e);if(r!==void 0)return r}break;case"CIMTextSymbol":return wS(t.symbol);case"CIMSolidStroke":case"CIMGradientStroke":case"CIMPictureStroke":return t.width}}function eSe(t){switch(t){case"Left":default:return"left";case"Right":return"right";case"Center":case"Justify":return"center"}}function tSe(t){switch(t){case"Top":default:return"top";case"Center":return"middle";case"Baseline":return"baseline";case"Bottom":return"bottom"}}function rSe(t){return(t?Object.keys(t):[]).map((e=>({name:e,alias:e,type:typeof t[e]=="string"?"esriFieldTypeString":"esriFieldTypeDouble"})))}const ep=t=>t.includes("data:image/svg+xml");function SS(t){if(!t)return null;switch(t.type){case"CIMPointSymbol":case"CIMTextSymbol":return"esriGeometryPoint";case"CIMLineSymbol":return"esriGeometryPolyline";case"CIMPolygonSymbol":return"esriGeometryPolygon";default:return null}}function qv(t){return t&&t.charAt(0).toLowerCase()+t.slice(1)}function Y6e(t,e,r,i,s,n,o=!0){const{infos:a}=n;let l=1,u=0,h=0,p=0,m=1;for(const{absoluteAnchorPoint:v,offsetX:_,offsetY:b,rotation:S,size:$,frameHeight:T,rotateClockWise:I,scaleSymbolsProportionally:P}of a)m=v?1:l,h=HD(_,b,u,m,h),p=qD(_,b,u,m,p),T&&(P||o)&&(l*=$/T),u=WD(S,I,u);const y=HD(i,s,u,m,h),g=qD(i,s,u,m,p);return{size:t*l,rotation:WD(e,r,u),offsetX:y,offsetY:g}}function iSe(t){if(t==null)return!1;if(Array.isArray(t))return t.every((e=>iSe(e)));switch(typeof t){case"string":return!!t;case"number":return!isNaN(t)}}function sSe(t,e){if(e==="color"||e==="outlinecolor"||e==="backgroundcolor"||e==="borderlinecolor"||e==="tintcolor")return[...Bwe[e]];const r=ar[t];if(!r)throw new Error(`InternalError: default value for type ${t}.`);return r[e]}function nSe(t){return t.split(" ").map((e=>Number(e)))}function oSe(t){return typeof t=="string"?nSe(t):t}function gH(t){return t?.dashTemplate&&(t.dashTemplate=oSe(t.dashTemplate)),t}function mC(t){if(t==null)return"Normal";switch(t.type){case"CIMTextSymbol":return t.textCase??"Normal";case"CIMPointSymbol":case"CIMLineSymbol":case"CIMPolygonSymbol":{const e=t.symbolLayers;if(!e)return"Normal";for(const r of e)if(r.type==="CIMVectorMarker")return mC(r)}break;case"CIMVectorMarker":{const e=t.markerGraphics;if(!e)return"Normal";for(const r of e)if(r.symbol)return mC(r.symbol)}}return"Normal"}function aSe(t){if(t)switch(t.type){case"CIMTextSymbol":return t.height;case"CIMPointSymbol":{let e=0;if(t.symbolLayers){for(const r of t.symbolLayers)if(r)switch(r.type){case"CIMCharacterMarker":case"CIMPictureMarker":case"CIMVectorMarker":case"CIMObjectMarker3D":case"CIMglTFMarker3D":{const i=r.size??ar.CIMVectorMarker.size;i>e&&(e=i);break}}}return e}case"CIMLineSymbol":case"CIMPolygonSymbol":{let e=0;if(t.symbolLayers){for(const r of t.symbolLayers)if(r)switch(r.type){case"CIMSolidStroke":case"CIMPictureStroke":case"CIMGradientStroke":{const i=r.width;i!=null&&i>e&&(e=i);break}case"CIMCharacterMarker":case"CIMPictureMarker":case"CIMVectorMarker":case"CIMObjectMarker3D":case"CIMglTFMarker3D":if(r.markerPlacement&&W2(r.markerPlacement)){const i=r.size??ar.CIMVectorMarker.size;i>e&&(e=i)}break;case"CIMPictureFill":{const i=r.height;i!=null&&i>e&&(e=i)}}}return e}}}function lSe(t,e){if(e!==null){const r=e.get(t);return r?r.name:t}return t}function uSe(t){return t.map((e=>({...e,propertyName:qv(e.propertyName)})))}function BD(t){const e={};for(const r in t){const i=t[r];e[qv(r)]=i}return e}function qD(t,e,r,i,s){const n=r*Math.PI/180;if(n){const o=Math.cos(n);return(Math.sin(n)*t+o*e)*i+s}return e*i+s}function HD(t,e,r,i,s){const n=r*Math.PI/180;return n?(Math.cos(n)*t-Math.sin(n)*e)*i+s:t*i+s}function WD(t,e,r){return e?r-t:r+t}function X6e(t,e,r){const i=r==="Color"||r==="TintColor"||r==="ToColor",s=r==="Rotation"||r==="Angle"||r==="ToRotation";let n=e[qv(r)];if(n!=null&&(i?n=[n[0]/255,n[1]/255,n[2]/255,n[3]/255]:s&&(n*=Math.PI/180)),n==null&&(n=sSe(e.type,r.toLowerCase()),n!=null&&(i?n=[n[0]/255,n[1]/255,n[2]/255,n[3]]:s&&(n*=Math.PI/180))),e.primitiveName!=null){const o=t[e.primitiveName];if(o!=null){const a=o[r];a==null||(typeof a=="string"||typeof a=="number"||Array.isArray(a)?(n=a,n!=null&&(i?n=[n[0]/255,n[1]/255,n[2]/255,n[3]/255]:s&&(n*=Math.PI/180))):(n={valueExpressionInfo:a,defaultValue:n},n!=null&&(i?n={type:"Process",op:"ArcadeColor",value:n}:s&&(n={type:"Process",op:"Divide",left:n,right:180/Math.PI}))))}}if(n==null)throw new Error(`Failed to derive a value or an expression for "${r}".`);return n}function K6e(t,e,r){if(e[qv(r)]!=null)return!0;if(e.primitiveName!=null){const i=t[e.primitiveName];if(i!=null&&i[r]!=null)return!0}return!1}function Iy(t,e){return Math.max(Math.min((t??e)/100,1),0)}const cSe={type:"CIMSimpleLineCallout",lineSymbol:{type:"CIMLineSymbol",symbolLayers:[{type:"CIMSolidStroke",width:.5,color:[0,0,0,255]}]}};let vH=class{constructor(e,r,i,s){this.url=e,this.fieldMap=i,this.dictionaryInfo=s,this._symbolPartCache=new Xq(100);const n=async()=>Uwe.from(await s,r,i);this._evaluator=n()}async getSymbolAsync(e,r,i=!0){const s=await this._evaluator,n=r?.fields??cH(e.attributes),o=s.createDictionaryFieldsIndex(n),a=s.evaluate(e,r?.scale??0,o,r?.spatialReference);if(a==null)return null;const l=v2(e.geometry),u=QF.parse(a,s.itemNames,l),h=l==="esriGeometryPoint"&&!e.geometry?.hasZ;return await this._cimPartsToCIMSymbol(e,u.partNames,u.overrides,h,r,i,o)}async getSymbolForControlString(e,r,i){const s=await this._evaluator,n=QF.parse(e,s.itemNames,r),o=r==="esriGeometryPoint"&&!i,a=ZD(await Promise.all(n.partNames.map((l=>this._getSymbolPart(l)))),n.overrides,o);return new gi({data:a})}async _cimPartsToCIMSymbol(e,r,i,s,n,o,a){const l=r.map((p=>this._getSymbolPart(p,n)));let u=await Promise.all(l);if(o&&this.fieldMap&&u.length>0){const{OverrideHelper:p}=await J(()=>Promise.resolve().then(()=>$Ie),void 0);u=k(u);for(const m of u)p.applyDictionaryTextOverrides(m,e,this.fieldMap,a,mC(m))}const h=ZD(u,i,s);return new gi({data:h})}async _fetchSymbolPart(e,r){const i=await this.dictionaryInfo,s=(this.url+"/"+i.cimRefTemplateUrl).replaceAll(/\{itemName\}/gi,e),{data:n}=await et(s,{responseType:"json",query:{f:"json"},...r});return n}async _getSymbolPart(e,r){let i=this._symbolPartCache.get(e);return i||(i=this._fetchSymbolPart(e,r),this._symbolPartCache.put(e,i)),i}};function ZD(t,e,r){if(!t||t.length===0)return null;const i={...t[0]};if(t.length>1){i.effects=null,i.symbolLayers=[];for(const s of t){const n=s;if(n.effects!=null)for(const o of n.symbolLayers)o.effects==null?o.effects=n.effects:o.effects.unshift(...n.effects);i.symbolLayers.unshift(...n.symbolLayers)}}return r&&(i.callout=cSe),{type:"CIMSymbolReference",symbol:i,primitiveOverrides:e}}var yC;let Dn=yC=class extends Wm(Rs){constructor(t){super(t),this.config=null,this.fieldMap=null,this.scaleExpression=null,this.scaleExpressionTitle=null,this.url=null,this.type="dictionary"}get _loader(){const t=this.getDictionaryInfo();return new vH(this.url,this.config,this.fieldMap??{},t)}writeData(t,e){t&&(e.scalingExpressionInfo={expression:t,returnType:"number"})}writeVisualVariables(t,e,r,i){i?.origin||super.writeVisualVariables(t,e,r,i)}clone(){return new yC({config:k(this.config),scaleExpression:this.scaleExpression,scaleExpressionTitle:this.scaleExpressionTitle,fieldMap:k(this.fieldMap),url:k(this.url),visualVariables:k(this.visualVariables)})}async getSymbolAsync(t,e,r=!0){return this._loader.getSymbolAsync(t,e,r)}async getSymbolForControlString(t,e,r){return this._loader.getSymbolForControlString(t,e,r)}getDictionaryInfo(){return this._dictionaryInfoPromise||(this._dictionaryInfoPromise=this._fetchDictionaryInfo()),this._dictionaryInfoPromise}async collectRequiredFields(t,e){await this.collectVVRequiredFields(t,e),this.scaleExpression&&await si(t,e,this.scaleExpression);for(const r in this.fieldMap){const i=this.fieldMap[r];e.has(i)&&t.add(i)}}get arcadeRequired(){return!0}getSymbol(){return null}get symbols(){return[]}getAttributeHash(){return this.visualVariables?.reduce(((t,e)=>t+e.getAttributeHash()),"")??""}getMeshHash(){return`${this.url}-${JSON.stringify(this.fieldMap)}`}async _fetchDictionaryInfo(){const{data:t}=await et(this.url+"/resources/styles/dictionary-info.json",{responseType:"json",query:{f:"json"}});return t}};c([d({type:vH})],Dn.prototype,"_loader",null),c([d({type:Object,json:{read:{source:"configuration"},write:{target:"configuration"}}})],Dn.prototype,"config",void 0),c([d({type:Object,json:{write:!0}})],Dn.prototype,"fieldMap",void 0),c([d({type:String,json:{read:{source:"scalingExpressionInfo.expression"},write:!0}})],Dn.prototype,"scaleExpression",void 0),c([re("scaleExpression")],Dn.prototype,"writeData",null),c([d({type:String,json:{read:{source:"scalingExpressionInfo.title"},write:{target:"scalingExpressionInfo.title",overridePolicy(t){return{enabled:!!t&&!!this.scaleExpression}}}}})],Dn.prototype,"scaleExpressionTitle",void 0),c([d({type:String,json:{write:!0}})],Dn.prototype,"url",void 0),c([re("visualVariables")],Dn.prototype,"writeVisualVariables",null),Dn=yC=c([C("esri.renderers.DictionaryRenderer")],Dn);var gC;let il=gC=class extends W{constructor(t){super(t),this.color=null,this.field=null,this.label=null,this.valueExpression=null,this.valueExpressionTitle=null}castField(t){return t==null?t:typeof t=="function"?(q.getLogger(this).error(".field: field must be a string value"),null):wv(t)}getAttributeHash(){return`${this.field}-${this.valueExpression}`}clone(){return new gC({color:this.color?.clone(),field:this.field,label:this.label,valueExpression:this.valueExpression,valueExpressionTitle:this.valueExpressionTitle})}};c([d({type:Q,json:{type:[Number],write:!0}})],il.prototype,"color",void 0),c([d({type:String,json:{write:!0}})],il.prototype,"field",void 0),c([We("field")],il.prototype,"castField",null),c([d({type:String,json:{write:!0}})],il.prototype,"label",void 0),c([d({type:String,json:{write:!0}})],il.prototype,"valueExpression",void 0),c([d({type:String,json:{write:!0}})],il.prototype,"valueExpressionTitle",void 0),il=gC=c([C("esri.renderers.support.AttributeColorInfo")],il);const _H=il;var vC;let Tb=vC=class extends W{constructor(){super(...arguments),this.unit=null}clone(){return new vC({unit:this.unit})}};c([d({type:String,json:{write:!0}})],Tb.prototype,"unit",void 0),Tb=vC=c([C("esri.renderers.support.DotDensityLegendOptions")],Tb);const hSe=Tb;var _C;let Yi=_C=class extends Wm(Rs){constructor(t){super(t),this.attributes=null,this.backgroundColor=new Q([0,0,0,0]),this.dotBlendingEnabled=!0,this.dotShape="square",this.dotSize=1,this.legendOptions=null,this.outline=new jt,this.dotValue=null,this.referenceScale=null,this.seed=1,this.type="dot-density"}calculateDotValue(t){if(this.referenceScale==null)return this.dotValue;const e=t/this.referenceScale*this.dotValue;return e<1?1:e}getSymbol(){return new Vi({outline:this.outline})}async getSymbolAsync(){return this.getSymbol()}get symbols(){return[this.getSymbol()]}getAttributeHash(){return this.attributes?.reduce(((t,e)=>t+e.getAttributeHash()),"")??""}getMeshHash(){return JSON.stringify(this.outline)}clone(){return new _C({attributes:k(this.attributes),backgroundColor:k(this.backgroundColor),dotBlendingEnabled:k(this.dotBlendingEnabled),dotShape:k(this.dotShape),dotSize:k(this.dotSize),dotValue:k(this.dotValue),legendOptions:k(this.legendOptions),outline:k(this.outline),referenceScale:k(this.referenceScale),seed:k(this.seed),visualVariables:k(this.visualVariables),authoringInfo:k(this.authoringInfo)})}getControllerHash(){return`${this.attributes?.map((e=>e.field||e.valueExpression||""))}-${this.outline&&JSON.stringify(this.outline.toJSON())||""}`}async collectRequiredFields(t,e){await this.collectVVRequiredFields(t,e);for(const r of this.attributes??[])r.valueExpression&&await si(t,e,r.valueExpression),r.field&&t.add(r.field)}};c([d({type:[_H],json:{write:!0}})],Yi.prototype,"attributes",void 0),c([d({type:Q,json:{write:!0}})],Yi.prototype,"backgroundColor",void 0),c([d({type:Boolean,json:{write:!0}})],Yi.prototype,"dotBlendingEnabled",void 0),c([d({type:String,json:{write:!1}})],Yi.prototype,"dotShape",void 0),c([d({type:Number,json:{write:!0}})],Yi.prototype,"dotSize",void 0),c([d({type:hSe,json:{write:!0}})],Yi.prototype,"legendOptions",void 0),c([d({type:jt,json:{default:null,write:!0}})],Yi.prototype,"outline",void 0),c([d({type:Number,json:{write:!0}})],Yi.prototype,"dotValue",void 0),c([d({type:Number,json:{write:!0}})],Yi.prototype,"referenceScale",void 0),c([d({type:Number,json:{write:!0}})],Yi.prototype,"seed",void 0),c([ye({dotDensity:"dot-density"})],Yi.prototype,"type",void 0),Yi=_C=c([C("esri.renderers.DotDensityRenderer")],Yi);var bC;let Pl=bC=class extends W{constructor(t){super(t),this.color=null,this.ratio=null}clone(){return new bC({color:this.color&&this.color.clone(),ratio:this.ratio})}};c([d({type:Q,json:{type:[qe],default:null,write:{isRequired:!0}}})],Pl.prototype,"color",void 0),c([d({type:Number,json:{write:{isRequired:!0}}})],Pl.prototype,"ratio",void 0),Pl=bC=c([C("esri.renderers.support.HeatmapColorStop")],Pl);let Ep=class extends Ce.ClonableMixin(W){constructor(){super(...arguments),this.minLabel=null,this.maxLabel=null,this.title=null}};c([d({type:String,json:{write:!0}})],Ep.prototype,"minLabel",void 0),c([d({type:String,json:{write:!0}})],Ep.prototype,"maxLabel",void 0),c([d({type:String,json:{write:!0}})],Ep.prototype,"title",void 0),Ep=c([C("esri.renderers.support.HeatmapLegendOptions")],Ep);function dSe(t,e){return t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3],t}function pSe(t,e){return t[0]=e[0],t[1]=e[1],t[2]=e[2],t}function fSe(t,e,r,i,s){return t[0]=e,t[1]=r,t[2]=i,t[3]=s,t}function mSe(t,e,r){return t[0]=e[0]+r[0],t[1]=e[1]+r[1],t[2]=e[2]+r[2],t[3]=e[3]+r[3],t}function bH(t,e,r){return t[0]=e[0]-r[0],t[1]=e[1]-r[1],t[2]=e[2]-r[2],t[3]=e[3]-r[3],t}function wH(t,e,r){return t[0]=e[0]*r[0],t[1]=e[1]*r[1],t[2]=e[2]*r[2],t[3]=e[3]*r[3],t}function SH(t,e,r){return t[0]=e[0]/r[0],t[1]=e[1]/r[1],t[2]=e[2]/r[2],t[3]=e[3]/r[3],t}function ySe(t,e){return t[0]=Math.ceil(e[0]),t[1]=Math.ceil(e[1]),t[2]=Math.ceil(e[2]),t[3]=Math.ceil(e[3]),t}function gSe(t,e){return t[0]=Math.floor(e[0]),t[1]=Math.floor(e[1]),t[2]=Math.floor(e[2]),t[3]=Math.floor(e[3]),t}function vSe(t,e,r){return t[0]=Math.min(e[0],r[0]),t[1]=Math.min(e[1],r[1]),t[2]=Math.min(e[2],r[2]),t[3]=Math.min(e[3],r[3]),t}function _Se(t,e,r){return t[0]=Math.max(e[0],r[0]),t[1]=Math.max(e[1],r[1]),t[2]=Math.max(e[2],r[2]),t[3]=Math.max(e[3],r[3]),t}function bSe(t,e){return t[0]=Math.round(e[0]),t[1]=Math.round(e[1]),t[2]=Math.round(e[2]),t[3]=Math.round(e[3]),t}function wSe(t,e,r){return t[0]=e[0]*r,t[1]=e[1]*r,t[2]=e[2]*r,t[3]=e[3]*r,t}function SSe(t,e,r,i){return t[0]=e[0]+r[0]*i,t[1]=e[1]+r[1]*i,t[2]=e[2]+r[2]*i,t[3]=e[3]+r[3]*i,t}function xH(t,e){const r=e[0]-t[0],i=e[1]-t[1],s=e[2]-t[2],n=e[3]-t[3];return Math.sqrt(r*r+i*i+s*s+n*n)}function $H(t,e){const r=e[0]-t[0],i=e[1]-t[1],s=e[2]-t[2],n=e[3]-t[3];return r*r+i*i+s*s+n*n}function MH(t){const e=t[0],r=t[1],i=t[2],s=t[3];return Math.sqrt(e*e+r*r+i*i+s*s)}function TH(t){const e=t[0],r=t[1],i=t[2],s=t[3];return e*e+r*r+i*i+s*s}function xSe(t,e){return t[0]=-e[0],t[1]=-e[1],t[2]=-e[2],t[3]=-e[3],t}function $Se(t,e){return t[0]=1/e[0],t[1]=1/e[1],t[2]=1/e[2],t[3]=1/e[3],t}function MSe(t,e){const r=e[0],i=e[1],s=e[2],n=e[3];let o=r*r+i*i+s*s+n*n;return o>0&&(o=1/Math.sqrt(o),t[0]=r*o,t[1]=i*o,t[2]=s*o,t[3]=n*o),t}function TSe(t,e){return t[0]*e[0]+t[1]*e[1]+t[2]*e[2]+t[3]*e[3]}function EH(t,e,r,i){const s=e[0],n=e[1],o=e[2],a=e[3];return t[0]=s+i*(r[0]-s),t[1]=n+i*(r[1]-n),t[2]=o+i*(r[2]-o),t[3]=a+i*(r[3]-a),t}function ESe(t,e=1){const r=y2;let i,s,n,o,a,l;do i=2*r()-1,s=2*r()-1,a=i*i+s*s;while(a>=1);do n=2*r()-1,o=2*r()-1,l=n*n+o*o;while(l>=1);const u=Math.sqrt((1-a)/l);return t[0]=e*i,t[1]=e*s,t[2]=e*n*u,t[3]=e*o*u,t}function ISe(t,e,r){const i=e[0],s=e[1],n=e[2],o=e[3];return t[0]=r[0]*i+r[4]*s+r[8]*n+r[12]*o,t[1]=r[1]*i+r[5]*s+r[9]*n+r[13]*o,t[2]=r[2]*i+r[6]*s+r[10]*n+r[14]*o,t[3]=r[3]*i+r[7]*s+r[11]*n+r[15]*o,t}function CSe(t,e,r){const i=e[0],s=e[1],n=e[2],o=r[0],a=r[1],l=r[2],u=r[3],h=u*i+a*n-l*s,p=u*s+l*i-o*n,m=u*n+o*s-a*i,y=-o*i-a*s-l*n;return t[0]=h*u+y*-o+p*-l-m*-a,t[1]=p*u+y*-a+m*-o-h*-l,t[2]=m*u+y*-l+h*-a-p*-o,t[3]=e[3],t}function PSe(t){return"vec4("+t[0]+", "+t[1]+", "+t[2]+", "+t[3]+")"}function ASe(t,e){return t[0]===e[0]&&t[1]===e[1]&&t[2]===e[2]&&t[3]===e[3]}function LSe(t,e){const r=t[0],i=t[1],s=t[2],n=t[3],o=e[0],a=e[1],l=e[2],u=e[3],h=Gi();return Math.abs(r-o)<=h*Math.max(1,Math.abs(r),Math.abs(o))&&Math.abs(i-a)<=h*Math.max(1,Math.abs(i),Math.abs(a))&&Math.abs(s-l)<=h*Math.max(1,Math.abs(s),Math.abs(l))&&Math.abs(n-u)<=h*Math.max(1,Math.abs(n),Math.abs(u))}const RSe=bH,kSe=wH,OSe=SH,NSe=xH,FSe=$H,DSe=MH,zSe=TH;Object.freeze(Object.defineProperty({__proto__:null,add:mSe,ceil:ySe,copy:dSe,copyVec3:pSe,dist:NSe,distance:xH,div:OSe,divide:SH,dot:TSe,equals:LSe,exactEquals:ASe,floor:gSe,inverse:$Se,len:DSe,length:MH,lerp:EH,max:_Se,min:vSe,mul:kSe,multiply:wH,negate:xSe,normalize:MSe,random:ESe,round:bSe,scale:wSe,scaleAndAdd:SSe,set:fSe,sqrDist:FSe,sqrLen:zSe,squaredDistance:$H,squaredLength:TH,str:PSe,sub:RSe,subtract:bH,transformMat4:ISe,transformQuat:CSe},Symbol.toStringTag,{value:"Module"}));function Z2(){return[0,0,0,0]}function VSe(t){return[t[0],t[1],t[2],t[3]]}function Ld(t,e,r,i){return[t,e,r,i]}function jSe(t,e,r,i){return[t,e,r,i]}function USe(t,e=Z2()){const r=Math.min(4,t.length);for(let i=0;i<r;++i)e[i]=t[i];return e}function IH(){return Z2()}function CH(){return Ld(1,1,1,1)}function PH(){return Ld(1,0,0,0)}function AH(){return Ld(0,1,0,0)}function LH(){return Ld(0,0,1,0)}function RH(){return Ld(0,0,0,1)}const GSe=IH(),BSe=CH(),qSe=PH(),HSe=AH(),WSe=LH(),ZSe=RH();Object.freeze(Object.defineProperty({__proto__:null,ONES:BSe,UNIT_W:ZSe,UNIT_X:qSe,UNIT_Y:HSe,UNIT_Z:WSe,ZEROS:GSe,clone:VSe,create:Z2,freeze:jSe,fromArray:USe,fromValues:Ld,ones:CH,unitW:RH,unitX:PH,unitY:AH,unitZ:LH,zeros:IH},Symbol.toStringTag,{value:"Module"}));const tL=2.4;function JSe(t){return tt(t*tL)}function YSe(t){return Fe(t)/tL}function XSe(t,e,r,i){let{color:s,ratio:n}=e,{color:o,ratio:a}=r;a===n&&(a===1?n-=1e-6:a+=1e-6);const l=$i((i-n)/(a-n),0,1);EH(t,s.toArray(),o.toArray(),l)}function tze(t){const r=new Uint8ClampedArray(2048);if(t=t.filter((({ratio:a})=>a>=0&&a<=1)).sort(((a,l)=>a.ratio-l.ratio)).map((({color:a,ratio:l})=>({color:a,ratio:Math.max(l,.001)}))),t.length<1)return r;let i=t[0],s=t[0],n=1;const o=Z2();for(let a=0;a<512;a++){const l=(a+.5)/512;for(;l>s.ratio&&n<t.length;)i=s,s=t[n++];XSe(o,i,s,l),r.set(o,4*a)}return r}function rze(t,e,r){const i=Math.sqrt(t**2+e**2)/r;return i>1?0:3/(Math.PI*r**2)*(1-i**2)**2}function ize(t){return typeof t=="function"?t:t?e=>+e[t]:()=>1}var wC;function JD(t){if(t!=null){const{maxDensity:e,minDensity:r,radius:i}=t;if(e!=null||r!=null||i!=null){const{blurRadius:s,maxPixelIntensity:n,minPixelIntensity:o,...a}=t;return a}}return t}let Mr=wC=class extends Rs{constructor(t){super(t),this.authoringInfo=null,this.colorStops=[new Pl({ratio:0,color:new Q("rgba(255, 140, 0, 0)")}),new Pl({ratio:.75,color:new Q("rgba(255, 140, 0, 1)")}),new Pl({ratio:.9,color:new Q("rgba(255, 0,   0, 1)")})],this.field=null,this.legendOptions=null,this.maxDensity=.04,this.minDensity=0,this.radius=18,this.referenceScale=0,this.type="heatmap",this.valueExpression=null,this.valueExpressionTitle=null}normalizeCtorArgs(t){return JD(t)}get blurRadius(){return YSe(this.radius)}set blurRadius(t){const e=this.maxPixelIntensity,r=this.minPixelIntensity;this._set("radius",JSe(t)),this._set("maxDensity",e*this._pixelIntensityToDensity),this._set("minDensity",r*this._pixelIntensityToDensity)}get maxPixelIntensity(){return this.maxDensity/this._pixelIntensityToDensity}set maxPixelIntensity(t){this._set("maxDensity",t*this._pixelIntensityToDensity)}get minPixelIntensity(){return this.minDensity/this._pixelIntensityToDensity}set minPixelIntensity(t){this._set("minDensity",t*this._pixelIntensityToDensity)}get _pixelIntensityToDensity(){return 24/(tL**2*this.blurRadius**4)}read(t,e){t=JD(t),super.read(t,e)}getSymbol(){return new Pt}async getSymbolAsync(){return this.getSymbol()}get symbols(){return[this.getSymbol()]}async collectRequiredFields(t,e){const r=this.field,i=this.valueExpression;r&&typeof r=="string"&&Bi(t,e,r),i&&typeof i=="string"&&await si(t,e,i)}getAttributeHash(){return""}getMeshHash(){return`${JSON.stringify(this.colorStops)}.${this.blurRadius}.${this.field}`}clone(){return new wC({authoringInfo:this.authoringInfo&&this.authoringInfo.clone(),colorStops:k(this.colorStops),field:this.field,legendOptions:k(this.legendOptions),maxDensity:this.maxDensity,minDensity:this.minDensity,radius:this.radius,referenceScale:this.referenceScale,valueExpression:this.valueExpression,valueExpressionTitle:this.valueExpressionTitle})}};c([d({type:Tt,json:{write:!0,origins:{"web-scene":{write:!1,read:!1}}}})],Mr.prototype,"authoringInfo",void 0),c([d({type:Number,json:{origins:{"portal-item":{write:!0},"web-map":{write:!0}}}})],Mr.prototype,"blurRadius",null),c([d({type:[Pl],json:{write:{isRequired:!0}}})],Mr.prototype,"colorStops",void 0),c([d({type:String,json:{write:!0}})],Mr.prototype,"field",void 0),c([d({type:Ep,json:{write:!0}})],Mr.prototype,"legendOptions",void 0),c([d({type:Number,json:{write:!0}})],Mr.prototype,"maxDensity",void 0),c([d({type:Number,json:{origins:{"portal-item":{write:!0},"web-map":{write:!0}}}})],Mr.prototype,"maxPixelIntensity",null),c([d({type:Number,json:{write:!0}})],Mr.prototype,"minDensity",void 0),c([d({type:Number,json:{origins:{"portal-item":{write:!0},"web-map":{write:!0}}}})],Mr.prototype,"minPixelIntensity",null),c([d({type:Number,cast:Be,json:{write:!0}})],Mr.prototype,"radius",void 0),c([d({type:Number,range:{min:0},json:{default:0,write:!0}})],Mr.prototype,"referenceScale",void 0),c([ye({heatmap:"heatmap"})],Mr.prototype,"type",void 0),c([d({type:String,json:{write:!0,origins:{"web-document":{write:!1},"portal-item":{write:!1}}}})],Mr.prototype,"valueExpression",void 0),c([d({type:String})],Mr.prototype,"valueExpressionTitle",void 0),c([d({readOnly:!0})],Mr.prototype,"_pixelIntensityToDensity",null),Mr=wC=c([C("esri.renderers.HeatmapRenderer")],Mr);let Ah=class extends Ce.ClonableMixin(W){constructor(){super(...arguments),this.color=new Q([0,0,0,0]),this.label=null,this.threshold=0}};c([d({type:Q,json:{write:!0}})],Ah.prototype,"color",void 0),c([d({type:String,json:{write:!0}})],Ah.prototype,"label",void 0),c([d({type:Number,range:{min:0,max:1},json:{write:!0}})],Ah.prototype,"threshold",void 0),Ah=c([C("esri.renderers.support.OthersCategory")],Ah);const KSe={base:pi,key:"type",typeMap:{size:Ue,opacity:Sl}};let Xi=class extends Wm(Ce.ClonableMixin(Rs)){constructor(e){super(e),this.attributes=null,this.backgroundFillSymbol=null,this.defaultColor=new Q([0,0,0,0]),this.defaultLabel=null,this.holePercentage=0,this.othersCategory=new Ah,this.legendOptions=null,this.outline=null,this.size=12,this.type="pie-chart",this.visualVariables=null}getSymbol(){return new Pt({size:this.size?this.size/2+(this.outline?.width||0):0})}async getSymbolAsync(){return this.getSymbol()}get symbols(){return[this.getSymbol(),this.backgroundFillSymbol].filter(ii)}getAttributeHash(){return this.visualVariables?.reduce(((e,r)=>e+r.getAttributeHash()),"")??""}getMeshHash(){return this.symbols.reduce(((e,r)=>e+JSON.stringify(r)),"")}async collectRequiredFields(e,r){await this.collectVVRequiredFields(e,r);for(const i of this.attributes)i.valueExpression&&await si(e,r,i.valueExpression),i.field&&e.add(i.field)}};c([d({type:[_H],json:{write:!0}})],Xi.prototype,"attributes",void 0),c([d(YA)],Xi.prototype,"backgroundFillSymbol",void 0),c([d({type:Q,json:{write:!0}})],Xi.prototype,"defaultColor",void 0),c([d({type:String,json:{write:!0}})],Xi.prototype,"defaultLabel",void 0),c([d({type:Number,range:{min:0,max:1},json:{write:!0}})],Xi.prototype,"holePercentage",void 0),c([d({type:Ah,json:{write:!0}})],Xi.prototype,"othersCategory",void 0),c([d({type:XA,json:{write:!0}})],Xi.prototype,"legendOptions",void 0),c([d({type:jt,json:{default:null,write:!0}})],Xi.prototype,"outline",void 0),c([d({type:Number,cast:Be,json:{write:!0}})],Xi.prototype,"size",void 0),c([ye({pieChart:"pie-chart"})],Xi.prototype,"type",void 0),c([d({types:[KSe]})],Xi.prototype,"visualVariables",void 0),Xi=c([C("esri.renderers.PieChartRenderer")],Xi);var SC;let ji=SC=class extends Wm(Rs){constructor(t){super(t),this.description=null,this.label=null,this.symbol=null,this.type="simple"}async collectRequiredFields(t,e){await Promise.all([this.collectSymbolFields(t,e),this.collectVVRequiredFields(t,e)])}async collectSymbolFields(t,e){await Promise.all(this.symbols.map((r=>r.collectRequiredFields(t,e))))}getSymbol(t,e){return this.symbol}async getSymbolAsync(t,e){return this.symbol}get symbols(){return this.symbol?[this.symbol]:[]}getAttributeHash(){return this.visualVariables?.reduce(((t,e)=>t+e.getAttributeHash()),"")??""}getMeshHash(){return this.symbols.reduce(((t,e)=>t+JSON.stringify(e)),"")}get arcadeRequired(){return this.arcadeRequiredForVisualVariables}clone(){return new SC({description:this.description,label:this.label,symbol:k(this.symbol),visualVariables:k(this.visualVariables),authoringInfo:k(this.authoringInfo)})}};c([d({type:String,json:{write:!0}})],ji.prototype,"description",void 0),c([d({type:String,json:{write:!0}})],ji.prototype,"label",void 0),c([d(JA)],ji.prototype,"symbol",void 0),c([ye({simple:"simple"})],ji.prototype,"type",void 0),ji=SC=c([C("esri.renderers.SimpleRenderer")],ji);const QSe=new Set(["esri.Color","esri.portal.Portal","esri.symbols.support.Symbol3DAnchorPosition2D","esri.symbols.support.Symbol3DAnchorPosition3D"]);function xC(t){return t instanceof ce}function YD(t){return t instanceof se?Object.keys(t.items):xC(t)?qi(t).keys():t?Object.keys(t):[]}function G_(t,e){return t instanceof se?t.items[e]:t[e]}function e2e(t,e){return!(!Array.isArray(t)||!Array.isArray(e))&&t.length!==e.length}function _0(t){return t?t.declaredClass:null}function kH(t,e){const r=t.diff;if(r&&typeof r=="function")return r(t,e);const i=YD(t),s=YD(e);if(i.length===0&&s.length===0)return;if(!i.length||!s.length||e2e(t,e))return{type:"complete",oldValue:t,newValue:e};const n=s.filter((p=>!i.includes(p))),o=i.filter((p=>!s.includes(p))),a=i.filter((p=>s.includes(p)&&G_(t,p)!==G_(e,p))).concat(n,o).sort(),l=_0(t);if(l&&QSe.has(l)&&a.length)return{type:"complete",oldValue:t,newValue:e};let u;const h=xC(t)&&xC(e);for(const p of a){const m=G_(t,p),y=G_(e,p);let g;if((h||typeof m!="function"&&typeof y!="function")&&m!==y&&(m!=null||y!=null)){if(r&&r[p]&&typeof r[p]=="function")g=r[p]?.(m,y);else if(m instanceof Date&&y instanceof Date){if(m.getTime()===y.getTime())continue;g={type:"complete",oldValue:m,newValue:y}}else g=typeof m=="object"&&typeof y=="object"&&_0(m)===_0(y)?kH(m,y):{type:"complete",oldValue:m,newValue:y};g!=null&&(u!=null?u.diff[p]=g:u={type:"partial",diff:{[p]:g}})}}return u}function oze(t,e){return t2e(t,e)}function t2e(t,e){if(t==null)return!1;const r=e.split(".");let i=t;for(const s of r){if(i.type==="complete")return!0;if(i.type!=="partial")return!1;{const n=i.diff[s];if(!n)return!1;i=n}}return!0}function aze(t,e){if(!t)return!1;if(t.type==="partial"){const r=Object.keys(t.diff);return r.length===1&&r[0]===e}return!1}function r2e(t,e){if(typeof t!="function"&&typeof e!="function"&&(t!=null||e!=null))return t==null||e==null||typeof t=="object"&&typeof e=="object"&&_0(t)!==_0(e)?{type:"complete",oldValue:t,newValue:e}:kH(t,e)}function B_(t){if(t==null)return!0;switch(t.type){case"complete":return!1;case"collection":{const e=t;for(const r of e.added)if(!B_(r))return!1;for(const r of e.removed)if(!B_(r))return!1;for(const r of e.changed)if(!B_(r))return!1;return!0}case"partial":for(const e in t.diff)if(!B_(t.diff[e]))return!1;return!0}}let Qn=class extends Ce.ClonableMixin(W){constructor(e){super(e),this.value=null,this.value2=null,this.value3=null}};c([d(wb)],Qn.prototype,"value",void 0),c([d(wb)],Qn.prototype,"value2",void 0),c([d(wb)],Qn.prototype,"value3",void 0),Qn=c([C("esri.renderers.support.UniqueValue")],Qn);let pl=class extends Ce.ClonableMixin(W){constructor(e){super(e),this.description=null,this.label=null,this.symbol=null,this.values=null}castValues(e){if(e==null)return null;const r=typeof(e=Array.isArray(e)?e:[e])[0];return r==="string"||r==="number"?e.map((i=>new Qn({value:i}))):r==="object"?e[0]instanceof Qn?e:e.map((i=>new Qn(i))):null}};c([d({type:String,json:{write:!0}})],pl.prototype,"description",void 0),c([d({type:String,json:{write:!0}})],pl.prototype,"label",void 0),c([d(H2)],pl.prototype,"symbol",void 0),c([d({type:[Qn],json:{type:[[String]],read:{reader:t=>t?t.map((e=>new Qn({value:e[0],value2:e[1],value3:e[2]}))):null},write:{writer:(t,e)=>{const r=[];for(const i of t){const s=[i.value,i.value2,i.value3].filter(ii).map((n=>n.toString()));r.push(s)}e.values=r}}}})],pl.prototype,"values",void 0),c([We("values")],pl.prototype,"castValues",null),pl=c([C("esri.renderers.support.UniqueValueClass")],pl);let Gh=class extends Ce.ClonableMixin(W){constructor(e){super(e),this.heading=null,this.classes=null}};c([d({type:String,json:{write:!0}})],Gh.prototype,"heading",void 0),c([d({type:[pl],json:{write:{isRequired:!0}}})],Gh.prototype,"classes",void 0),Gh=c([C("esri.renderers.support.UniqueValueGroup")],Gh);var $C;let Kn=$C=class extends W{constructor(t){super(t),this.description=null,this.label=null,this.symbol=null,this.value=null}clone(){return new $C({value:this.value,description:this.description,label:this.label,symbol:this.symbol?this.symbol.clone():null})}getMeshHash(){const t=JSON.stringify(this.symbol?.toJSON());return`${this.value}.${t}`}};c([d({type:String,json:{write:!0}})],Kn.prototype,"description",void 0),c([d({type:String,json:{write:!0}})],Kn.prototype,"label",void 0),c([d(JA)],Kn.prototype,"symbol",void 0),c([d(wb)],Kn.prototype,"value",void 0),Kn=$C=c([C("esri.renderers.support.UniqueValueInfo")],Kn);const XD=new Map;async function i2e(t,e){try{return{data:(await rL(t,e)).data,baseUrl:JP(t),styleUrl:t}}catch(r){return Do(r),null}}function s2e(t,e,r){const i=e.portal!=null?e.portal:Y.getDefault();let s;const n=`${i.url} - ${i.user?.username} - ${t}`,o=XD.get(n);if(o)return o;const a=n2e(t,i,r).then((l=>(s=l,l.fetchData()))).then((l=>({data:l,baseUrl:s.itemUrl??"",styleName:t})));return XD.set(n,a),a}function n2e(t,e,r){return e.load(r).then((()=>{const i=new Kt({disableExtraQuery:!0,query:`owner:${KD} AND type:${QD} AND typekeywords:"${t}"`});return e.queryItems(i,r)})).then((({results:i})=>{let s=null;const n=t.toLowerCase();if(i&&Array.isArray(i)){for(const o of i)if(o.typeKeywords?.some((l=>l.toLowerCase()===n))&&o.type===QD&&o.owner===KD){s=o;break}}if(!s)throw new F("symbolstyleutils:style-not-found",`The style '${t}' could not be found`,{styleName:t});return s.load(r)}))}function OH(t,e,r){return t?.styleUrl!=null?i2e(t.styleUrl,r):t?.styleName!=null?s2e(t.styleName,e,r):Promise.reject(new F("symbolstyleutils:style-url-and-name-missing","Either styleUrl or styleName is required to resolve a style"))}function NH(t){return t===null||t.type==="CIMSymbolReference"?t:{type:"CIMSymbolReference",symbol:t}}function o2e(t,e){for(const r of e)switch(r){case"cim":if(t.cimRef)return{format:r,url:encodeURI(t.cimRef)};break;case"web-gltf-basisu":{const i=I$(t,"gltf_basisu");if(i)return{format:r,url:i};break}case"web-gltf":{const i=I$(t,"gltf");if(i)return{format:r,url:i};break}case"web":{const i=I$(t,"gltf");if(i)return{format:"web-gltf",url:i};if(t.webRef)return{format:r,url:encodeURI(t.webRef)};break}}}function I$(t,e){if(!z("enable-feature:force-wosr"))return t.formatInfos?.find((r=>r.type===e))?.href}function rL(t,e){const r={responseType:"json",query:{f:"json"},...e};return et(fn(t),r)}const KD="esri_en",QD="Style",a2e="https://cdn.arcgis.com/sharing/rest/content/items/220936cc6ed342c9937abd8f180e7d1e/resources/styles/cim/{SymbolName}.json?f=json";var Ig;const e4="uvInfos-watcher",t4="uvGroups-watcher",l2e=",",u2e=br(Kn);function c2e(t){const{field1:e,field2:r,field3:i,fieldDelimiter:s,uniqueValueInfos:n,valueExpression:o}=t,a=!(!e||!r);return[{classes:(n??[]).map((l=>{const{symbol:u,label:h,value:p,description:m}=l,[y,g,v]=a?p?.toString()?.split(s||"")||[]:[p],_=[];return(e||o)&&_.push(y),r&&_.push(g),i&&_.push(v),{symbol:u,label:h,values:[_],description:m}}))}]}function tp(t){return t!=null&&t!==""&&(typeof t!="string"||t.trim()!==""&&t.toLowerCase()!=="<null>")||(t=null),t+""}let mt=Ig=class extends Wm(Rs){constructor(t){super(t),this._valueInfoMap={},this._isDefaultSymbolDerived=!1,this._isInfosSource=null,this.type="unique-value",this.backgroundFillSymbol=null,this.orderByClassesEnabled=!1,this.valueExpressionTitle=null,this.legendOptions=null,this.defaultLabel=null,this.portal=null,this.styleOrigin=null,this.diff={uniqueValueInfos(e,r){if(!e&&!r)return;if(!e||!r)return{type:"complete",oldValue:e,newValue:r};let i=!1;const s={type:"collection",added:[],removed:[],changed:[],unchanged:[]};for(let n=0;n<r.length;n++){const o=e.find((a=>a.value===r[n].value));o?r2e(o,r[n])?(s.changed.push({type:"complete",oldValue:o,newValue:r[n]}),i=!0):s.unchanged.push({oldValue:o,newValue:r[n]}):(s.added.push(r[n]),i=!0)}for(let n=0;n<e.length;n++)r.find((o=>o.value===e[n].value))||(s.removed.push(e[n]),i=!0);return i?s:void 0}},this._set("uniqueValueInfos",[]),this._set("uniqueValueGroups",[])}get _cache(){return{compiledFunc:null}}set field(t){this._set("field",t),this._updateFieldDelimiter(),this._updateUniqueValues()}castField(t){return t==null||typeof t=="function"?t:wv(t)}writeField(t,e,r,i){typeof t=="string"?e[r]=t:i?.messages?i.messages.push(new F("property:unsupported","UniqueValueRenderer.field set to a function cannot be written to JSON")):q.getLogger(this).error(".field: cannot write field to JSON since it's not a string value")}set field2(t){this._set("field2",t),this._updateFieldDelimiter(),this._updateUniqueValues()}set field3(t){this._set("field3",t),this._updateUniqueValues()}set valueExpression(t){this._set("valueExpression",t),this._updateUniqueValues()}set defaultSymbol(t){this._isDefaultSymbolDerived=!1,this._set("defaultSymbol",t)}set fieldDelimiter(t){this._set("fieldDelimiter",t),this._updateUniqueValues()}readPortal(t,e,r){return r.portal||Y.getDefault()}readStyleOrigin(t,e,r){if(e.styleName)return Object.freeze({styleName:e.styleName});if(e.styleUrl){const i=Fl(e.styleUrl,r);return Object.freeze({styleUrl:i})}}writeStyleOrigin(t,e,r,i){t.styleName?e.styleName=t.styleName:t.styleUrl&&(e.styleUrl=cd(t.styleUrl,i))}set uniqueValueGroups(t){this.styleOrigin?q.getLogger(this).error("#uniqueValueGroups=","Cannot modify unique value groups of a UniqueValueRenderer created from a web style"):(this._set("uniqueValueGroups",t),this._updateInfosFromGroups(),this._isInfosSource=!1,this._watchUniqueValueGroups())}set uniqueValueInfos(t){this.styleOrigin?q.getLogger(this).error("#uniqueValueInfos=","Cannot modify unique value infos of a UniqueValueRenderer created from a web style"):(this._set("uniqueValueInfos",t),this._updateValueInfoMap(),this._updateGroupsFromInfos(),this._isInfosSource=!0,this._watchUniqueValueInfos())}addUniqueValueInfo(t,e){if(this.styleOrigin)return void q.getLogger(this).error("#addUniqueValueInfo()","Cannot modify unique value infos of a UniqueValueRenderer created from a web style");let r;r=typeof t=="object"?u2e(t):new Kn({value:t,symbol:FG(e)}),this.uniqueValueInfos?.push(r),this._valueInfoMap[tp(r.value)]=r,this._updateGroupsFromInfos(),this._isInfosSource=!0,this._watchUniqueValueInfos()}removeUniqueValueInfo(t){if(this.styleOrigin)return void q.getLogger(this).error("#removeUniqueValueInfo()","Cannot modify unique value infos of a UniqueValueRenderer created from a web style");const e=this.uniqueValueInfos;if(e)for(let r=0;r<e.length;r++){const i=e[r];if(String(i.value)===String(t)){delete this._valueInfoMap[tp(t)],e.splice(r,1);break}}this._updateGroupsFromInfos(),this._isInfosSource=!0,this._watchUniqueValueInfos()}async getUniqueValueInfo(t,e){let r=e;return this.valueExpression&&e?.arcade==null&&(r={...r,arcade:await jl()}),this._getUniqueValueInfo(t,r)}getSymbol(t,e){return this.valueExpression&&e?.arcade==null?void q.getLogger(this).error("#getSymbol()","Please use getSymbolAsync if valueExpression is used"):this._getUniqueValueInfo(t,e)?.symbol||this.defaultSymbol}async getSymbolAsync(t,e){let r=e;if(this.valueExpression&&r?.arcade==null){const s=await jl(),{arcadeUtils:n}=s;n.hasGeometryOperations(this.valueExpression)&&await n.enableGeometryOperations(),r={...r,arcade:s}}return this._getUniqueValueInfo(t,r)?.symbol||this.defaultSymbol}get symbols(){const t=[];for(const e of this.uniqueValueInfos??[])e.symbol&&t.push(e.symbol);return this.defaultSymbol&&t.push(this.defaultSymbol),t}getAttributeHash(){return this.visualVariables?.reduce(((t,e)=>t+e.getAttributeHash()),"")??""}getMeshHash(){const t=JSON.stringify(this.backgroundFillSymbol),e=JSON.stringify(this.defaultSymbol),r=this.uniqueValueInfos?.reduce(((i,s)=>i+s.getMeshHash()),"");return`${t}.${e}.${r}.${`${this.field}.${this.field2}.${this.field3}.${this.fieldDelimiter}`}.${this.valueExpression}`}clone(){const t=new Ig({field:this.field,field2:this.field2,field3:this.field3,defaultLabel:this.defaultLabel,defaultSymbol:k(this.defaultSymbol),orderByClassesEnabled:this.orderByClassesEnabled,valueExpression:this.valueExpression,valueExpressionTitle:this.valueExpressionTitle,fieldDelimiter:this.fieldDelimiter,visualVariables:k(this.visualVariables),legendOptions:k(this.legendOptions),authoringInfo:k(this.authoringInfo),backgroundFillSymbol:k(this.backgroundFillSymbol)});this._isDefaultSymbolDerived&&(t._isDefaultSymbolDerived=!0),t._set("portal",this.portal);const e=k(this.uniqueValueInfos),r=k(this.uniqueValueGroups);return this.styleOrigin&&(t._set("styleOrigin",Object.freeze(k(this.styleOrigin))),Object.freeze(e),Object.freeze(r)),t._set("uniqueValueInfos",e),t._updateValueInfoMap(),t._set("uniqueValueGroups",r),t._isInfosSource=this._isInfosSource,t._watchUniqueValueInfosAndGroups(),t}get arcadeRequired(){return this.arcadeRequiredForVisualVariables||!!this.valueExpression}async collectRequiredFields(t,e){const r=[this.collectVVRequiredFields(t,e),this.collectSymbolFields(t,e)];await Promise.all(r)}async collectSymbolFields(t,e){const r=[...this.symbols.map((i=>i.collectRequiredFields(t,e))),si(t,e,this.valueExpression)];Bi(t,e,this.field),Bi(t,e,this.field2),Bi(t,e,this.field3),await Promise.all(r)}populateFromStyle(){return OH(this.styleOrigin,{portal:this.portal}).then((t=>{const e=[];return this._valueInfoMap={},t?.data&&Array.isArray(t.data.items)&&t.data.items.forEach((r=>{const i=new Ur({styleUrl:t.styleUrl,styleName:t.styleName,portal:this.portal,name:r.name});this.defaultSymbol||r.name!==t.data.defaultItem||(this.defaultSymbol=i,this._isDefaultSymbolDerived=!0);const s=new Kn({value:r.name,symbol:i});e.push(s),this._valueInfoMap[tp(r.name)]=s})),this._set("uniqueValueInfos",Object.freeze(e)),this._updateGroupsFromInfos(!0),this._isInfosSource=null,this._watchUniqueValueInfos(),!this.defaultSymbol&&this.uniqueValueInfos?.length&&(this.defaultSymbol=this.uniqueValueInfos[0].symbol,this._isDefaultSymbolDerived=!0),this}))}_updateFieldDelimiter(){this.field&&this.field2&&!this.fieldDelimiter&&this._set("fieldDelimiter",l2e)}_updateUniqueValues(){this._isInfosSource!=null&&(this._isInfosSource?this._updateGroupsFromInfos():this._updateInfosFromGroups())}_updateValueInfoMap(){this._valueInfoMap={};const{uniqueValueInfos:t}=this;if(t)for(const e of t)this._valueInfoMap[tp(e.value)]=e}_watchUniqueValueInfosAndGroups(){this._watchUniqueValueInfos(),this._watchUniqueValueGroups()}_watchUniqueValueInfos(){this.removeHandles(e4);const{uniqueValueInfos:t}=this;if(t){const e=[];for(const r of t)e.push(ie((()=>({symbol:r.symbol,value:r.value,label:r.label,description:r.description})),((i,s)=>{i!==s&&(this._updateGroupsFromInfos(),this._isInfosSource=!0)}),{sync:!0}));this.addHandles(e,e4)}}_watchUniqueValueGroups(){this.removeHandles(t4);const{uniqueValueGroups:t}=this;if(t){const e=[];for(const r of t){e.push(ie((()=>({classes:r.classes})),((i,s)=>{i!==s&&(this._updateInfosFromGroups(),this._isInfosSource=!1)}),{sync:!0}));for(const i of r.classes??[])e.push(ie((()=>({symbol:i.symbol,values:i.values,label:i.label,description:i.description})),((s,n)=>{s!==n&&(this._updateInfosFromGroups(),this._isInfosSource=!1)}),{sync:!0}))}this.addHandles(e,t4)}}_updateInfosFromGroups(){if(!this.uniqueValueGroups)return this._set("uniqueValueInfos",null),this._updateValueInfoMap(),void this._watchUniqueValueInfos();const t=[],{field:e,field2:r,field3:i,fieldDelimiter:s,uniqueValueGroups:n,valueExpression:o}=this;if(!e&&!o)return this._set("uniqueValueInfos",t),this._updateValueInfoMap(),void this._watchUniqueValueInfos();const a=!(!e||!r);for(const l of n)for(const u of l.classes??[]){const{symbol:h,label:p,values:m,description:y}=u;for(const g of m??[]){const{value:v,value2:_,value3:b}=g,S=[v];r&&S.push(_),i&&S.push(b);const $=a?S.join(s||""):S[0]??void 0;t.push(new Kn({symbol:h,label:p,value:$,description:y}))}}this._set("uniqueValueInfos",t),this._updateValueInfoMap(),this._watchUniqueValueInfos()}_updateGroupsFromInfos(t=!1){if(!this.uniqueValueInfos)return this._set("uniqueValueGroups",null),void this._watchUniqueValueGroups();const{field:e,field2:r,valueExpression:i,fieldDelimiter:s,uniqueValueInfos:n}=this;if(!e&&!i||!n.length)return this._set("uniqueValueGroups",[]),void this._watchUniqueValueGroups();const o=!(!e||!r),a=n.map((u=>{const{symbol:h,label:p,value:m,description:y}=u,[g,v,_]=o?m?.toString()?.split(s||"")||[]:[m];return new pl({symbol:h,label:p,description:y,values:[new Qn({value:g,value2:v,value3:_})]})})),l=[new Gh({classes:a})];t&&Object.freeze(l),this._set("uniqueValueGroups",l),this._watchUniqueValueGroups()}_getUniqueValueInfo(t,e){return this.valueExpression?this._getUnqiueValueInfoForExpression(t,e):this._getUnqiueValueInfoForFields(t)}_getUnqiueValueInfoForExpression(t,e){const{viewingMode:r,scale:i,spatialReference:s,arcade:n,timeZone:o}=e??{};let a=this._cache.compiledFunc;const l=n.arcadeUtils;if(!a){const h=l.createSyntaxTree(this.valueExpression);a=l.createFunction(h),this._cache.compiledFunc=a}const u=l.executeFunction(a,l.createExecContext(t,l.getViewInfo({viewingMode:r,scale:i,spatialReference:s}),o));return this._valueInfoMap[tp(u)]}_getUnqiueValueInfoForFields(t){const e=this.field,r=t.attributes;let i;if(this.field2){const s=this.field2,n=this.field3,o=[];e&&o.push(r[e]),s&&o.push(r[s]),n&&o.push(r[n]),i=o.join(this.fieldDelimiter||"")}else e&&(i=r[e]);return this._valueInfoMap[tp(i)]}static fromPortalStyle(t,e){const r=new Ig(e?.properties);r._set("styleOrigin",Object.freeze({styleName:t})),r._set("portal",e?.portal||Y.getDefault());const i=r.populateFromStyle();return i.catch((s=>{q.getLogger(this.prototype).error(`#fromPortalStyle('${t}'[, ...])`,"Failed to create unique value renderer from style name",s)})),i}static fromStyleUrl(t,e){const r=new Ig(e?.properties);r._set("styleOrigin",Object.freeze({styleUrl:t}));const i=r.populateFromStyle();return i.catch((s=>{q.getLogger(this.prototype).error(`#fromStyleUrl('${t}'[, ...])`,"Failed to create unique value renderer from style URL",s)})),i}};c([d({readOnly:!0})],mt.prototype,"_cache",null),c([ye({uniqueValue:"unique-value"})],mt.prototype,"type",void 0),c([d(YA)],mt.prototype,"backgroundFillSymbol",void 0),c([d({value:null,json:{type:String,read:{source:"field1"},write:{target:"field1"}}})],mt.prototype,"field",null),c([We("field")],mt.prototype,"castField",null),c([re("field")],mt.prototype,"writeField",null),c([d({type:String,value:null,json:{write:!0}})],mt.prototype,"field2",null),c([d({type:String,value:null,json:{write:!0}})],mt.prototype,"field3",null),c([d({type:Boolean,json:{name:"drawInClassOrder",default:!1,write:!0,origins:{"web-scene":{write:!1}}}})],mt.prototype,"orderByClassesEnabled",void 0),c([d({type:String,value:null,json:{write:!0}})],mt.prototype,"valueExpression",null),c([d({type:String,json:{write:!0}})],mt.prototype,"valueExpressionTitle",void 0),c([d({type:XA,json:{write:!0}})],mt.prototype,"legendOptions",void 0),c([d({type:String,json:{write:!0}})],mt.prototype,"defaultLabel",void 0),c([d(VP({...H2},{json:{write:{overridePolicy(){return{enabled:!this._isDefaultSymbolDerived}}},origins:{"web-scene":{write:{overridePolicy(){return{enabled:!this._isDefaultSymbolDerived}}}}}}}))],mt.prototype,"defaultSymbol",null),c([d({type:String,value:null,json:{write:!0}})],mt.prototype,"fieldDelimiter",null),c([d({type:Y,readOnly:!0})],mt.prototype,"portal",void 0),c([K("portal",["styleName"])],mt.prototype,"readPortal",null),c([d({readOnly:!0,json:{write:{enabled:!1,overridePolicy:()=>({enabled:!0})}}})],mt.prototype,"styleOrigin",void 0),c([K("styleOrigin",["styleName","styleUrl"])],mt.prototype,"readStyleOrigin",null),c([re("styleOrigin",{styleName:{type:String},styleUrl:{type:String}})],mt.prototype,"writeStyleOrigin",null),c([d({type:[Gh],json:{read:{source:["uniqueValueGroups","uniqueValueInfos"],reader:(t,e,r)=>(e.uniqueValueGroups||c2e(e)).map((i=>Gh.fromJSON(i,r)))},write:{overridePolicy(){return this.styleOrigin?{enabled:!1}:{enabled:!0}}}}})],mt.prototype,"uniqueValueGroups",null),c([d({type:[Kn],json:{read:!1,write:{isRequired:!0,overridePolicy(){return this.styleOrigin?{enabled:!1}:{enabled:!0,isRequired:!0}}}}})],mt.prototype,"uniqueValueInfos",null),mt=Ig=c([C("esri.renderers.UniqueValueRenderer")],mt);const Hv={key:"type",base:Rs,typeMap:{heatmap:Mr,simple:ji,"unique-value":mt,"class-breaks":ur,"dot-density":Yi,dictionary:Dn,"pie-chart":Xi},errorContext:"renderer"},h2e={key:"type",base:Rs,typeMap:{simple:ji,"unique-value":mt,"class-breaks":ur,heatmap:Mr},errorContext:"renderer",validate:d2e};function d2e(t){switch(t.type){case"simple":return p2e(t);case"unique-value":return f2e(t);case"class-breaks":return m2e(t);case"heatmap":return t}}function p2e(t){if(t.symbol)return t;q.getLogger("esri.renderers.support.types").error("Removed invalid 'simple' renderer without a symbol from web scene.")}function f2e(t){const e=t.uniqueValueInfos,r=e?.filter((({symbol:i,label:s},n)=>(i||q.getLogger("esri.renderers.support.types").error(`Removed invalid unique value info ([${n}] ${s}) without a symbol from web scene.`),!!i)));return r?.length!==e?.length&&(t.uniqueValueInfos=r),t}function m2e(t){const e=t.classBreakInfos,r=e?.filter((({symbol:i,label:s},n)=>(i||q.getLogger("esri.renderers.support.types").error(`Removed invalid class break info ([${n}] ${s}) without a symbol from web scene.`),!!i)));return r?.length!==e?.length&&(t.classBreakInfos=r),t}function y2e(t,e){return rv(t,null,e)}const g2e=Om({types:Hv});function rv(t,e,r){return t?t&&(t.styleName||t.styleUrl)&&t.type!=="uniqueValue"?(r?.messages&&r.messages.push(new Fs("renderer:unsupported","Only UniqueValueRenderer can be referenced from a web style, but found '"+t.type+"'",{definition:t,context:r})),null):g2e(t,e,r):null}function FH(t){return t==null||t.type==="simple"||t.type==="unique-value"||t.type==="class-breaks"||t.type==="dictionary"||t.type==="heatmap"}function hze(t,e){if(t==null)return null;if(!FH(t))return new F("renderer-conversion-3d:unsupported-renderer",`Unsupported renderer of type '${t.type||t.declaredClass}'`,{renderer:t});switch(t.type){case"simple":return v2e(t,e);case"unique-value":return _2e(t,e);case"class-breaks":return b2e(t,e);case"dictionary":case"heatmap":return null}return null}function iL(t,e){if(!e)return null;if(Array.isArray(e)||(e=[e]),e.length>0){const r=e.map((s=>s.details.symbol.type||s.details.symbol.declaredClass)).filter((s=>!!s));r.sort();const i=new Array;return r.forEach(((s,n)=>{n!==0&&s===r[n-1]||i.push(s)})),new F("renderer-conversion-3d:unsupported-symbols",`Renderer contains symbols (${i.join(", ")}) which are not supported in 3D`,{renderer:t,symbolErrors:e})}return null}function v2e(t,e){const r={...xl,...e,cimFallbackEnabled:!0};return iL(t,Sm(t.symbol,r).error)}function _2e(t,e){const r={...xl,...e,cimFallbackEnabled:!0},i=t.uniqueValueInfos?.map((n=>Sm(n.symbol,r).error)).filter(ii),s=Sm(t.defaultSymbol,r);return s.error&&i?.unshift(s.error),iL(t,i)}function b2e(t,e){const r={...xl,...e,cimFallbackEnabled:!0},i=t.classBreakInfos.map((n=>Sm(n.symbol,r).error)).filter(ii),s=Sm(t.defaultSymbol,r);return s.error&&i.unshift(s.error),iL(t,i)}var MC;function w2e(t){switch(t){case"circle":return{rings:[[[8.5,.2],[7.06,.33],[5.66,.7],[4.35,1.31],[3.16,2.14],[2.14,3.16],[1.31,4.35],[.7,5.66],[.33,7.06],[.2,8.5],[.33,9.94],[.7,11.34],[1.31,12.65],[2.14,13.84],[3.16,14.86],[4.35,15.69],[5.66,16.3],[7.06,16.67],[8.5,16.8],[9.94,16.67],[11.34,16.3],[12.65,15.69],[13.84,14.86],[14.86,13.84],[15.69,12.65],[16.3,11.34],[16.67,9.94],[16.8,8.5],[16.67,7.06],[16.3,5.66],[15.69,4.35],[14.86,3.16],[13.84,2.14],[12.65,1.31],[11.34,.7],[9.94,.33],[8.5,.2]]]};case"square":return{rings:[[[.5,.5],[.5,16.5],[16.5,16.5],[16.5,.5],[.5,.5]]]};case"diamond":return{rings:[[[8.5,.5],[.2,8.5],[8.5,16.5],[16.5,8.5],[8.5,.5]]]};case"hexagon-pointy":return{rings:[[[15.86,12.75],[15.86,4.25],[8.5,0],[1.14,4.25],[1.14,12.75],[8.5,17],[15.86,12.75]]]};case"hexagon-flat":return{rings:[[[12.75,15.86],[17,8.5],[12.75,1.14],[4.25,1.14],[0,8.5],[4.25,15.86],[12.75,15.86]]]}}}function sL(t){return t?.type==="CIMVectorMarker"?t.markerGraphics?.[0]:void 0}function DH(t){return t?.symbol?.type==="CIMPolygonSymbol"?t.symbol.symbolLayers?.[0]:void 0}function S2e(t,e){t?.type==="CIMVectorMarker"&&e!=null&&(t.size=e)}function x2e(t,e){const r=sL(t);r&&e!=null&&(r.geometry=w2e(e))}function $2e(t,e){const r=DH(sL(t));r&&e!=null&&(r.color=e.toArray())}function M2e(t,e,r){const i=DH(sL(t));i&&e!=null&&r&&(i.colorLocked=e)}function nL(t,e){const{outerRingSize:r,innerDotSize:i,type:s,color:n,colorLocked:o,primitiveOverrides:a}=e,l=t.data.symbol?.type==="CIMPolygonSymbol"?t.data.symbol.symbolLayers:null;if(l?.length===2)for(const u of l){const h=u.primitiveName===MC.OuterRing;S2e(u,h?r:i),x2e(u,s),$2e(u,n),M2e(u,o,h)}return r!=null&&i!=null&&(t.data.primitiveOverrides=null),a!==void 0&&(t.data.primitiveOverrides=k(a)),t}(function(t){t.OuterRing="reference-size-outer-ring",t.InnerDot="reference-size-inner-dot"})(MC||(MC={}));function zH(t,e,r,i){if(t)if(t.type!=="CIMTextSymbol"){if(t.effects)for(const s of t.effects)r4(s,e);if(t.symbolLayers)for(const s of t.symbolLayers){switch(s.type){case"CIMPictureMarker":case"CIMVectorMarker":T2e(s,e,i);break;case"CIMPictureStroke":case"CIMSolidStroke":case"CIMGradientStroke":!i?.preserveOutlineWidth&&s.width&&(s.width*=e);break;case"CIMPictureFill":s.height&&(s.height*=e),s.offsetX&&(s.offsetX*=e),s.offsetY&&(s.offsetY*=e);break;case"CIMHatchFill":zH(s.lineSymbol,e,!0,{...i,preserveOutlineWidth:!1}),s.offsetX&&(s.offsetX*=e),s.offsetY&&(s.offsetY*=e),s.separation&&(s.separation*=e)}if(s.effects)for(const n of s.effects)r4(n,e)}}else t.height!=null&&(t.height*=e)}function T2e(t,e,r){if(t&&(t.markerPlacement&&E2e(t.markerPlacement,e),t.offsetX&&(t.offsetX*=e),t.offsetY&&(t.offsetY*=e),t.anchorPoint&&t.anchorPointUnits==="Absolute"&&(t.anchorPoint={x:t.anchorPoint.x*e,y:t.anchorPoint.y*e}),t.size=t.size!=null?t.size*e:0,t.type==="CIMVectorMarker"&&t.markerGraphics))for(const i of t.markerGraphics)t.scaleSymbolsProportionally||zH(i.symbol,e,!0,r)}function E2e(t,e){switch(W2(t)&&t.offset&&(t.offset*=e),t.type){case"CIMMarkerPlacementAlongLineRandomSize":case"CIMMarkerPlacementAlongLineSameSize":if(t.customEndingOffset&&(t.customEndingOffset*=e),t.offsetAlongLine&&(t.offsetAlongLine*=e),t.placementTemplate&&t.placementTemplate.length){const r=t.placementTemplate.map((i=>i*e));t.placementTemplate=r}break;case"CIMMarkerPlacementAlongLineVariableSize":if(t.maxRandomOffset&&(t.maxRandomOffset*=e),t.placementTemplate&&t.placementTemplate.length){const r=t.placementTemplate.map((i=>i*e));t.placementTemplate=r}break;case"CIMMarkerPlacementOnLine":t.startPointOffset&&(t.startPointOffset*=e);break;case"CIMMarkerPlacementAtExtremities":t.offsetAlongLine&&(t.offsetAlongLine*=e);break;case"CIMMarkerPlacementAtMeasuredUnits":case"CIMMarkerPlacementOnVertices":break;case"CIMMarkerPlacementAtRatioPositions":t.beginPosition&&(t.beginPosition*=e),t.endPosition&&(t.endPosition*=e);break;case"CIMMarkerPlacementPolygonCenter":t.offsetX&&(t.offsetX*=e),t.offsetY&&(t.offsetY*=e);break;case"CIMMarkerPlacementInsidePolygon":t.offsetX&&(t.offsetX*=e),t.offsetY&&(t.offsetY*=e),t.stepX&&(t.stepX*=e),t.stepY&&(t.stepY*=e)}}function r4(t,e){switch(t.type){case"CIMGeometricEffectArrow":case"CIMGeometricEffectDonut":t.width&&(t.width*=e);break;case"CIMGeometricEffectBuffer":t.size&&(t.size*=e);break;case"CIMGeometricEffectCut":t.beginCut&&(t.beginCut*=e),t.endCut&&(t.endCut*=e),t.middleCut&&(t.middleCut*=e);break;case"CIMGeometricEffectDashes":if(t.customEndingOffset&&(t.customEndingOffset*=e),t.offsetAlongLine&&(t.offsetAlongLine*=e),t.dashTemplate&&t.dashTemplate.length){const r=t.dashTemplate.map((i=>i*e));t.dashTemplate=r}break;case"CIMGeometricEffectExtension":case"CIMGeometricEffectJog":case"CIMGeometricEffectRadial":t.length&&(t.length*=e);break;case"CIMGeometricEffectMove":t.offsetX&&(t.offsetX*=e),t.offsetY&&(t.offsetY*=e);break;case"CIMGeometricEffectOffset":case"CIMGeometricEffectOffsetTangent":t.offset&&(t.offset*=e);break;case"CIMGeometricEffectRegularPolygon":t.radius&&(t.radius*=e);break;case"CIMGeometricEffectTaperedPolygon":t.fromWidth&&(t.fromWidth*=e),t.length&&(t.length*=e),t.toWidth&&(t.toWidth*=e);break;case"CIMGeometricEffectWave":t.amplitude&&(t.amplitude*=e),t.period&&(t.period*=e)}}function VH(t){const e=[];return TC(QA(t),e),e.length?new Q(pH(e[0])):null}function TC(t,e){if(!t)return;let r;r=t.type==="CIMTextSymbol"?t.symbol:t;const i=t.type==="CIMPolygonSymbol";if(r?.symbolLayers){for(const s of r.symbolLayers)if(!(s.colorLocked||i&&(fH(s)||eL(s)&&s.markerPlacement&&W2(s.markerPlacement))))switch(s.type){case"CIMPictureMarker":case"CIMPictureStroke":case"CIMPictureFill":s.tintColor&&xS(e,s.tintColor);break;case"CIMVectorMarker":s.markerGraphics?.forEach((n=>{TC(n.symbol,e)}));break;case"CIMSolidStroke":case"CIMSolidFill":xS(e,s.color);break;case"CIMGradientFill":I2e(e,s);break;case"CIMHatchFill":TC(s.lineSymbol,e)}}}function xS(t,e){for(const r of t)if(r.join(".")===e.join("."))return;t.push(e)}function I2e(t,e){switch(e.colorRamp?.type){case"CIMMultipartColorRamp":e.colorRamp.colorRamps?.forEach((i=>{i.type==="CIMLinearContinuousColorRamp"&&i4(t,i)}));break;case"CIMLinearContinuousColorRamp":case"CIMPolarContinuousColorRamp":i4(t,e.colorRamp)}}function i4(t,e){e&&(e.fromColor&&xS(t,e.fromColor),e.toColor&&xS(t,e.toColor))}function jH(t,e,r){e instanceof Q||(e=new Q(e));const i=QA(t);i&&EC(i,e)}function EC(t,e,r){if(!t)return;let i;i=t.type==="CIMTextSymbol"?t.symbol:t;const s=i?.type==="CIMPolygonSymbol";if(i?.symbolLayers)for(const n of i.symbolLayers){if(n.colorLocked||s&&(fH(n)||eL(n)&&n.markerPlacement&&W2(n.markerPlacement)))continue;const o=e.toArray();switch(n.type){case"CIMPictureMarker":case"CIMPictureStroke":case"CIMPictureFill":n.tintColor=o;break;case"CIMVectorMarker":n.markerGraphics?.forEach((a=>{EC(a.symbol,e)}));break;case"CIMSolidStroke":case"CIMSolidFill":n.color=o;break;case"CIMGradientFill":C2e(n,e);break;case"CIMHatchFill":EC(n.lineSymbol,e)}}}function C2e(t,e){switch(t.colorRamp?.type){case"CIMMultipartColorRamp":t.colorRamp.colorRamps?.forEach((i=>{i.type==="CIMLinearContinuousColorRamp"&&s4(i,e)}));break;case"CIMLinearContinuousColorRamp":case"CIMPolarContinuousColorRamp":s4(t.colorRamp,e)}}function s4(t,e){if(t&&(t.fromColor&&(t.fromColor=e.toArray()),t.toColor)){const r=e.clone();r.a=0,t.toColor=r.toArray()}}function dze(t,e,r=!1){const i=QA(t);if(r&&(e=360-e),i?.type!=="CIMTextSymbol"){if(i?.type==="CIMPointSymbol"&&i.symbolLayers){const s=e-(i.angle||0);for(const n of i.symbolLayers)if(eL(n)){let o=n.rotation||0;n.rotateClockwise?o-=s:o+=s,n.rotation=o}i.angle=e}}else i.angle=e}var Bt;(function(t){t[t.size=22]="size",t[t.lineWidth=50]="lineWidth",t[t.maxSize=120]="maxSize",t[t.maxOutlineSize=80]="maxOutlineSize",t[t.tallSymbolWidth=20]="tallSymbolWidth"})(Bt||(Bt={}));const b0={fill:[{type:"path",path:"M -10,-10 L 10,0 L 10,10 L -10,10 L -10,-10 Z"}],meshSymbol3DFill:[{type:"path",path:"M -10,-8 L 6,0 L 6,6 L -10,6 L -10,-8 Z"},{type:"path",path:"M -10,-8 L -7,-10 L 9,-2 L 6,0 L -10,-8 Z"},{type:"path",path:"M 6,0 L 9,-2 L 9,4 L 6,6 L 6,0 Z"}],pathSymbol3DLayer:[{type:"path",path:"M 3,12 L 12,0 L 11,-2 L -4,5 L -1,5 L 1,7 L 3,10 L 3,12 Z"},{type:"circle",cx:-2,cy:10,r:5}]};function P2e(t,e,r){const i=Bt.size;let s=i,n=i;t<1?s*=.75:t>1&&(n*=1.25);const o=0,a=0;let l=i,u=i;return e&&r&&(s=n=l=u=0),[{type:"path",path:[{command:"M",values:[l,o]},{command:"L",values:[r?l:.875*l,o]},{command:"L",values:[r?s-.5*l:a,n-.5*u]},{command:"L",values:[s-.5*l,n-.5*u]},{command:"Z",values:[]}]},{type:"path",path:[{command:"M",values:[l,o]},{command:"L",values:[l,e?o:.125*u]},{command:"L",values:[s-.5*l,e?n-.5*u:u]},{command:"L",values:[s-.5*l,n-.5*u]},{command:"Z",values:[]}]},{type:"path",path:[{command:"M",values:[s-.5*l,n-.5*u]},{command:"L",values:[r?s-.5*l:a,n-.5*u]},{command:"L",values:[r?s-.5*l:a,e?n-.5*u:u]},{command:"L",values:[s-.5*l,e?n-.5*u:u]},{command:"Z",values:[]}]}]}function A2e(t){const e=Bt.size,r=.5*t,i=0,s=0;return[{type:"path",path:[{command:"M",values:[s,.7*e*.5]},{command:"L",values:[.3*e,.7*e]},{command:"L",values:[.3*e,.7*e+r]},{command:"L",values:[s,.7*e+r-.7*e*.5]},{command:"Z",values:[]}]},{type:"path",path:[{command:"M",values:[.3*e,.7*e]},{command:"L",values:[.3*e,.7*e+r]},{command:"L",values:[e,r]},{command:"L",values:[e,i]},{command:"Z",values:[]}]},{type:"path",path:[{command:"M",values:[.3*e,i]},{command:"L",values:[e,i]},{command:"L",values:[.3*e,.7*e]},{command:"L",values:[s,.7*e*.5]},{command:"Z",values:[]}]}]}function L2e(){return[{type:"path",path:"M80,80.2v-27c-1.5,0.7-2.8,1.6-3.9,2.8c-1.8,2.1-4.4,3.3-7.1,3.5c-2.7-0.1-5.3-1.4-7.1-3.4c-2.2-2.3-4.7-3.6-7.4-3.6s-5.1,1.3-7.3,3.6c-1.8,2.1-4.4,3.3-7.2,3.4c-2.7-0.1-5.3-1.4-7.1-3.4c-2.2-2.3-4.7-3.6-7.4-3.6s-5.1,1.3-7.4,3.6c-1.8,2.1-4.4,3.3-7.2,3.4C8.3,59.3,5.7,58,3.9,56c-1.1-1.2-2.4-2.1-3.9-2.8v27"},{type:"path",path:"M11,59.4c2.7-0.1,5.3-1.4,7.1-3.4c2.2-2.3,4.7-3.6,7.4-3.6s5.1,1.3,7.4,3.6c1.8,2,4.4,3.3,7.2,3.4c2.7-0.1,5.3-1.4,7.1-3.4c2.2-2.3,4.7-3.6,7.3-3.6s5.1,1.3,7.4,3.6c1.8,2.1,4.4,3.3,7.2,3.4c2.7-0.1,5.3-1.4,7.1-3.4c1.1-1.2,2.4-2.1,3.9-2.8v-24c-1.5,0.7-2.8,1.6-3.9,2.8c-1.8,2.1-4.4,3.3-7.1,3.5c-2.7-0.1-5.3-1.4-7.1-3.4c-2.2-2.3-4.7-3.6-7.4-3.6s-5.1,1.3-7.3,3.6c-1.8,2.1-4.4,3.3-7.2,3.4c-2.7-0.1-5.3-1.4-7.1-3.4c-2.2-2.3-4.7-3.6-7.4-3.6s-5.1,1.3-7.4,3.6c-1.8,2.1-4.4,3.3-7.2,3.4c-2.7-0.1-5.3-1.4-7.1-3.4c-1.1-1.2-2.4-2.1-3.9-2.8v24c1.5,0.7,2.8,1.6,3.9,2.8C5.7,58,8.3,59.3,11,59.4z"},{type:"path",path:"M11,35.4c2.7-0.1,5.3-1.4,7.1-3.4c2.2-2.3,4.7-3.6,7.4-3.6s5.1,1.3,7.4,3.6c1.8,2,4.4,3.3,7.2,3.4c2.7-0.1,5.3-1.4,7.1-3.4c2.2-2.3,4.7-3.6,7.3-3.6s5.1,1.3,7.4,3.6c1.8,2.1,4.4,3.3,7.2,3.4c2.7-0.1,5.3-1.4,7.1-3.4c1.1-1.2,2.4-2.1,3.9-2.8V3.6c-1.5,0.7-2.8,1.6-3.9,2.8c-2.2,2.1-4.6,3.4-7.1,3.4s-5-1.3-7.1-3.4s-4.7-3.6-7.4-3.6s-5.1,1.3-7.3,3.6S42.5,9.9,40,9.9s-5-1.3-7.1-3.4s-4.7-3.6-7.4-3.6s-5.1,1.3-7.3,3.6c-1.8,2.1-4.4,3.3-7.2,3.4c-2.5,0-5-1.3-7.1-3.4C2.8,5.3,1.4,4.3,0,3.6v25.6c1.5,0.7,2.8,1.6,3.9,2.8C5.7,34.1,8.3,35.3,11,35.4z"}]}function R2e(t,e){let r=e?Bt.tallSymbolWidth:t;const i=t,s=e?4:6;r<=Bt.size?r-=.5*s:r-=s;const n=0,o=0,a=e?.35*r:.5*r;return[{type:"path",path:[{command:"M",values:[.5*r,n]},{command:"L",values:[r,.5*a]},{command:"L",values:[.5*r,a]},{command:"L",values:[o,.5*a]},{command:"Z",values:[]}]},{type:"path",path:[{command:"M",values:[n,.5*a]},{command:"L",values:[.5*r,a]},{command:"L",values:[.5*r,i]},{command:"L",values:[o,i-.5*a]},{command:"Z",values:[]}]},{type:"path",path:[{command:"M",values:[.5*r,a]},{command:"L",values:[.5*r,i]},{command:"L",values:[r,i-.5*a]},{command:"L",values:[r,.5*a]},{command:"Z",values:[]}]}]}function k2e(t,e){let r=e?Bt.tallSymbolWidth:t;const i=t,s=e?4:6;r<=Bt.size?r-=.5*s:r-=s;const n=.5*r,o=.15*r,a=0,l=i-o;return[{type:"ellipse",cx:.5*r,cy:l,rx:n,ry:o},{type:"path",path:[{command:"M",values:[a,o]},{command:"L",values:[a,l]},{command:"L",values:[r,l]},{command:"L",values:[r,o]},{command:"Z",values:[]}]},{type:"ellipse",cx:.5*r,cy:o,rx:n,ry:o}]}function O2e(t,e){let r=e?Bt.tallSymbolWidth:t;const i=t,s=e?4:6;r<=Bt.size?r-=.5*s:r-=s;const n=.15*r,o=i-n;return[{type:"ellipse",cx:.5*r,cy:o,rx:.5*r,ry:n},{type:"path",path:[{command:"M",values:[.5*r,0]},{command:"L",values:[r,o]},{command:"L",values:[0,o]},{command:"Z",values:[]}]}]}function N2e(t){let e=t;const r=t,i=6;e<Bt.size?e-=.5*i:e-=i;const s=.15*e,n=0;return[{type:"path",path:[{command:"M",values:[0,n]},{command:"L",values:[e,n]},{command:"L",values:[.5*e,r-s]},{command:"Z",values:[]}]},{type:"ellipse",cx:.5*e,cy:n,rx:.5*e,ry:s}]}function F2e(t){let e=t;const r=t,i=4;e<Bt.size?e-=.5*i:e-=i;const s=0,n=0,o=e,a=r,l=Math.floor(t/10)-1||1;return[{type:"path",path:[{command:"M",values:[.45*o,s]},{command:"L",values:[o,.5*a-l]},{command:"L",values:[.45*o-l,.5*a+l]},{command:"Z",values:[]}]},{type:"path",path:[{command:"M",values:[.45*o,s]},{command:"L",values:[.45*o-l,.5*a+l]},{command:"L",values:[n,.5*a-l]},{command:"Z",values:[]}]},{type:"path",path:[{command:"M",values:[n,.5*a-l]},{command:"L",values:[.45*o-l,.5*a+l]},{command:"L",values:[.45*o,r]},{command:"Z",values:[]}]},{type:"path",path:[{command:"M",values:[.45*o,r]},{command:"L",values:[o,.5*a-l]},{command:"L",values:[.45*o-l,.5*a+l]},{command:"Z",values:[]}]}]}function D2e(t){const e=t,r=2;let i=t;i<Bt.size?i-=.5*r:i-=r;const s=0,n=0;return[{type:"path",path:[{command:"M",values:[.45*e,s]},{command:"L",values:[e,i]},{command:"L",values:[.45*e,.6*i]},{command:"Z",values:[]}]},{type:"path",path:[{command:"M",values:[.45*e,s]},{command:"L",values:[.45*e,.6*i]},{command:"L",values:[n,i]},{command:"Z",values:[]}]},{type:"path",path:[{command:"M",values:[n,i]},{command:"L",values:[.45*e,.6*i]},{command:"L",values:[e,i]},{command:"Z",values:[]}]}]}function tc(t,e){return Math.round(Math.min(Math.max(t+255*e*.75,0),255))}function pze(t,e){if(t==null)return new Q;if("type"in t&&(t.type==="linear"||t.type==="pattern"))return t;const r=new Q(t);return new Q([tc(r.r,e),tc(r.g,e),tc(r.b,e),r.a])}function UH(t){return"r"in t&&"g"in t&&"b"in t}function GH(t){return"h"in t&&"s"in t&&"v"in t}function BH(t){return"l"in t&&"a"in t&&"b"in t}function qH(t){return"l"in t&&"c"in t&&"h"in t}function z2e(t){return"x"in t&&"y"in t&&"z"in t}const V2e=[[.4124,.3576,.1805],[.2126,.7152,.0722],[.0193,.1192,.9505]],j2e=[[3.2406,-1.5372,-.4986],[-.9689,1.8758,.0415],[.0557,-.204,1.057]];function HH(t,e){const r=[];let i,s;if(t[0].length!==e.length)throw new Error("dimensions do not match");const n=t.length,o=t[0].length;let a=0;for(i=0;i<n;i++){for(a=0,s=0;s<o;s++)a+=t[i][s]*e[s];r.push(a)}return r}function WH(t){const e=[t.r/255,t.g/255,t.b/255].map((i=>i<=.04045?i/12.92:((i+.055)/1.055)**2.4)),r=HH(V2e,e);return{x:100*r[0],y:100*r[1],z:100*r[2]}}function oL(t){const e=HH(j2e,[t.x/100,t.y/100,t.z/100]).map((r=>{const i=r<=.0031308?12.92*r:1.055*r**.4166666666666667-.055;return Math.min(1,Math.max(i,0))}));return{r:Math.round(255*e[0]),g:Math.round(255*e[1]),b:Math.round(255*e[2])}}function ZH(t){const e=[t.x/95.047,t.y/100,t.z/108.883].map((r=>r>.008856451679035631?r**.3333333333333333:7.787037037037035*r+.13793103448275862));return{l:116*e[1]-16,a:500*(e[0]-e[1]),b:200*(e[1]-e[2])}}function JH(t){const e=t.l,r=[(e+16)/116+t.a/500,(e+16)/116,(e+16)/116-t.b/200].map((i=>i>6/29?i**3:3*(6/29)**2*(i-4/29)));return{x:95.047*r[0],y:100*r[1],z:108.883*r[2]}}function U2e(t){const e=t.l,r=t.a,i=t.b,s=Math.sqrt(r*r+i*i);let n=Math.atan2(i,r);return n=n>0?n:n+2*Math.PI,{l:e,c:s,h:n}}function G2e(t){const e=t.l,r=t.c,i=t.h;return{l:e,a:r*Math.cos(i),b:r*Math.sin(i)}}function B2e(t){return ZH(WH(t))}function q2e(t){return oL(JH(t))}function H2e(t){return U2e(ZH(WH(t)))}function W2e(t){return oL(JH(G2e(t)))}function Z2e(t){const e=t.r,r=t.g,i=t.b,s=Math.max(e,r,i),n=s-Math.min(e,r,i);let o=s,a=n===0?0:s===e?(r-i)/n%6:s===r?(i-e)/n+2:(e-r)/n+4,l=n===0?0:n/o;return a<0&&(a+=6),a*=60,l*=100,o*=100/255,{h:a,s:l,v:o}}function J2e(t){const e=(t.h+360)%360/60,r=t.s/100,i=t.v/100*255,s=i*r,n=s*(1-Math.abs(e%2-1));let o;switch(Math.floor(e)){case 0:o={r:s,g:n,b:0};break;case 1:o={r:n,g:s,b:0};break;case 2:o={r:0,g:s,b:n};break;case 3:o={r:0,g:n,b:s};break;case 4:o={r:n,g:0,b:s};break;case 5:case 6:o={r:s,g:0,b:n};break;default:o={r:0,g:0,b:0}}return o.r=Math.round(o.r+i-s),o.g=Math.round(o.g+i-s),o.b=Math.round(o.b+i-s),o}function Rd(t){return UH(t)?t:qH(t)?W2e(t):BH(t)?q2e(t):z2e(t)?oL(t):GH(t)?J2e(t):t}function J2(t){return GH(t)?t:Z2e(Rd(t))}function Y2e(t){return BH(t)?t:B2e(Rd(t))}function fze(t){return qH(t)?t:H2e(Rd(t))}function X2e(t){let{r:e,g:r,b:i,a:s}=t;return s<1&&(e=Math.round(s*e+255*(1-s)),r=Math.round(s*r+255*(1-s)),i=Math.round(s*i+255*(1-s))),new Q({r:e,g:r,b:i})}function YH(t,e){const{r,g:i,b:s}=e?.ignoreAlpha?t:X2e(t);return .2126*r+.7152*i+.0722*s}var IC;function mze(t,e=IC.High){return YH(t,{ignoreAlpha:!0})>e?new Q([0,0,0,t.a]):new Q([255,255,255,t.a])}function yze(t,e){const r=Y2e(t);r.l*=1-e;const i=Rd(r),s=t.clone();return s.setColor(i),s.a=t.a,s}function gze(t,e){const r=t.clone();return r.a*=e,r}function vze(t,e){const r=J2(t);r.s*=e;const i=Rd(r),s=t.clone();return s.setColor(i),s.a=t.a,s}function _ze(t){return Q.toUnitRGBA(t)}function bze(t){return Ld(t[0],t[1],t[2],t.length>3?t[3]:1)}function wze(t,e){const r=Q.toUnitRGBA(t);return r[3]*=e,r}function Sze(t,e,r={}){if(t.length===0||e<=0)return[];if((t=t.map((i=>typeof i=="string"?new Q(i):i))).length===1||e===1){const i=[],s=t[0];for(let n=0;n<e;n++)i.push(s.clone());return i}if(r.shuffle&&(t=ez(k(t),r.seed)),t.length>=e){const i=[],s=(t.length-1)/(e-1);for(let n=0;n<e;n++){const o=Math.round(n*s);i.push(t[o].clone())}return i}return K2e(t,e,r)}function K2e(t,e,r={}){const i=[],s=t.length-1,n=Math.ceil((e-t.length)/s);e:for(let o=0;o<s;o++){const a=t[o],l=t[o+1];for(let u=1;u<=n;u++){const h=u/(n+1);if(i.push(Q2e(a,l,h,r)),i.length+t.length===e)break e}}return[...t.map((o=>o.clone())),...ez(i,r.seed??1)]}(function(t){t[t.Low=160]="Low",t[t.High=225]="High"})(IC||(IC={}));const C$=(t,e)=>{const r=Math.floor(10*e())-5;return Math.min(255,Math.max(0,t+r))};function Q2e(t,e,r,i={}){const s=t.r,n=t.g,o=t.b,a=e.r,l=e.g,u=e.b,h=Math.round(s+(a-s)*r),p=Math.round(n+(l-n)*r),m=Math.round(o+(u-o)*r);if(!i.offset)return new Q([h,p,m]);const y=kP(i.seed);return new Q([C$(h,y),C$(p,y),C$(m,y)])}const XH="picture-fill",KH="simple-fill",exe="simple-line",QH="simple-marker",txe="text",rxe="cim",n4=new Map([["dash",[4,3]],["dashdot",[4,3,1,3]],["dot",[1,3]],["longdash",[8,3]],["longdashdot",[8,3,1,3]],["longdashdotdot",[8,3,1,3,1,3]],["shortdash",[4,1]],["shortdashdot",[4,1,1,1]],["shortdashdotdot",[4,1,1,1,1,1]],["shortdot",[1,1]],["solid",[]]]),P$=new Xq(1e3);function ixe(t){const e=t.style;let r=null;if(t)switch(t.type){case QH:e!=="cross"&&e!=="x"&&(r=t.color);break;case KH:e&&e!=="solid"?e!=="none"&&(r={type:"pattern",x:0,y:0,src:Et(`esri/symbols/patterns/${e}.png`),width:5,height:5}):r=t.color;break;case XH:r={type:"pattern",src:t.url,width:Fe(t.width)*t.xscale,height:Fe(t.height)*t.yscale,x:Fe(t.xoffset),y:Fe(t.yoffset)};break;case txe:r=t.color;break;case rxe:r=VH(t)}return r}function sxe(t,e){const r=t+"-"+e;return P$.get(r)!==void 0?Promise.resolve(P$.get(r)):et(t,{responseType:"image"}).then((i=>{const s=i.data,n=s.naturalWidth,o=s.naturalHeight,a=document.createElement("canvas");a.width=n,a.height=o;const l=a.getContext("2d");l.fillStyle=e,l.fillRect(0,0,n,o),l.globalCompositeOperation="destination-in",l.drawImage(s,0,0);const u=a.toDataURL();return P$.put(r,u),u}))}function iv(t){if(!t)return null;let e=null;switch(t.type){case KH:case XH:case QH:e=iv(t.outline);break;case exe:{const r=Fe(t.width);t.style!=null&&t.style!=="none"&&r!==0&&(e={color:t.color,style:aL(t.style),width:r,cap:t.cap,join:t.join==="miter"?Fe(t.miterLimit):t.join},e.dashArray=eW(e).join(",")||"none");break}default:e=null}return e}function eW(t){if(!t?.style)return[];const{dashArray:e,style:r,width:i}=t;if(typeof e=="string"&&e!=="none")return e.split(",").map((o=>Number(o)));const s=i??0,n=n4.has(r)?n4.get(r).map((o=>o*s)):[];if(t.cap!=="butt")for(const[o,a]of n.entries())n[o]=o%2==1?a+s:Math.max(a-s,1);return n}const aL=(()=>{const t={};return e=>{if(t[e])return t[e];const r=e.replaceAll("-","");return t[e]=r,r}})(),nxe=new Q([128,128,128]);let oxe=0;function axe(){return oxe++}let lxe=0;function uxe(){return lxe++}let cxe=0;function hxe(){return cxe++}const dxe="http://www.w3.org/2000/svg",o4=z("android"),pxe=z("chrome")||o4&&o4>=4?"auto":"optimizeLegibility",fxe={m:2,l:2,h:1,v:1,c:6,s:4,q:4,t:2,a:7,z:0},mxe=/([A-DF-Za-df-z])|([-+]?\d*[.]?\d+(?:[eE][-+]?\d+)?)/g;let Nt={},Ke={};const yxe=Math.PI;function Yu(t,e){const r=t*(yxe/180);return Math.abs(e*Math.sin(r))+Math.abs(e*Math.cos(r))}function tW(t){return t.map((e=>`${e.command} ${e.values.join(" ")}`)).join(" ").trim()}function lL(t,e,r,i,s){if(t){if(t.type==="circle")return L("circle",{cx:t.cx,cy:t.cy,fill:e,"fill-rule":"evenodd",r:t.r,stroke:r.color,"stroke-dasharray":r.dashArray,"stroke-dashoffset":r.dashOffset,"stroke-linecap":r.cap,"stroke-linejoin":r.join,"stroke-miterlimit":"4","stroke-width":r.width});if(t.type==="ellipse")return L("ellipse",{cx:t.cx,cy:t.cy,fill:e,"fill-rule":"evenodd",rx:t.rx,ry:t.ry,stroke:r.color,"stroke-dasharray":r.dashArray,"stroke-linecap":r.cap,"stroke-linejoin":r.join,"stroke-miterlimit":"4","stroke-width":r.width});if(t.type==="rect")return L("rect",{fill:e,"fill-rule":"evenodd",height:t.height,stroke:r.color,"stroke-dasharray":r.dashArray,"stroke-linecap":r.cap,"stroke-linejoin":r.join,"stroke-miterlimit":"4","stroke-width":r.width,width:t.width,x:t.x,y:t.y});if(t.type==="image")return L("image",{alt:s||"image",height:t.height,href:t.src,preserveAspectRatio:"none",width:t.width,x:t.x,y:t.y});if(t.type==="path"){const n=typeof t.path!="string"?tW(t.path):t.path;return L("path",{d:n,fill:e,"fill-rule":"evenodd",stroke:r.color,"stroke-dasharray":r.dashArray,"stroke-linecap":r.cap,"stroke-linejoin":r.join,"stroke-miterlimit":"4","stroke-width":r.width})}if(t.type==="text")return mv(i),L("text",{"dominant-baseline":i.dominantBaseline,fill:e,"fill-rule":"evenodd","font-family":i.font.family,"font-size":i.font.size,"font-style":i.font.style,"font-variant":i.font.variant,"font-weight":i.font.weight,kerning:i.kerning,rotate:i.rotate,stroke:r.color,"stroke-dasharray":r.dashArray,"stroke-linecap":r.cap,"stroke-linejoin":r.join,"stroke-miterlimit":"4","stroke-width":r.width,"text-anchor":i.align,"text-decoration":i.decoration,"text-rendering":pxe,x:t.x,y:t.y},t.text)}return null}function uL(t){if(!t)return{fill:"none",pattern:null,linearGradient:null};if(!("type"in t))return{fill:new Q(t).toString(),pattern:null,linearGradient:null};if(t.type==="pattern"){const r=`patternId-${axe()}`;return{fill:`url(#${r})`,pattern:{id:r,x:t.x,y:t.y,width:t.width,height:t.height,image:{x:0,y:0,width:t.width,height:t.height,href:t.src}},linearGradient:null}}const e=`linearGradientId-${uxe()}`;return{fill:`url(#${e})`,pattern:null,linearGradient:{id:e,x1:t.x1,y1:t.y1,x2:t.x2,y2:t.y2,stops:t.colors.map((r=>({offset:r.offset,color:r.color&&new Q(r.color).toString()})))}}}function cL(t){const e={color:"none",width:1,cap:"butt",join:"4",dashArray:"none",dashOffset:"0"};return t&&(t.width!=null&&(e.width=t.width),t.cap&&(e.cap=t.cap),t.join&&(e.join=t.join.toString()),t.color&&(e.color=new Q(t.color).toString()),t.dashArray&&(e.dashArray=t.dashArray),t.dashoffset&&(e.dashOffset=t.dashoffset),t.style&&!t.dashArray&&(e.dashArray=eW(t).join(",")||"none")),e}function rW(t,e){const r={align:null,decoration:null,kerning:null,rotate:null,font:{style:null,variant:null,weight:null,size:null,family:null}};if(t){const i=t.alignBaseline,s=i==="baseline"?"auto":i==="top"?"text-top":i==="bottom"?"hanging":i;r.align=t.align,r.dominantBaseline=s,r.decoration=t.decoration,r.kerning=t.kerning?"auto":"0",r.rotate=t.rotated?"90":"0",mv(e),r.font.style=e.style||"normal",r.font.variant=e.variant||"normal",r.font.weight=e.weight||"normal",r.font.size=e.size&&e.size.toString()||"10pt",r.font.family=e.family||"serif"}return r}function iW(t){const{pattern:e,linearGradient:r}=t;if(e)return L("pattern",{height:e.height,id:e.id,patternUnits:"userSpaceOnUse",width:e.width,x:e.x,y:e.y},L("image",{height:e.image.height,href:e.image.href,width:e.image.width,x:e.image.x,y:e.image.y}));if(r){const i=r.stops.map(((s,n)=>L("stop",{key:`${n}-stop`,offset:s.offset,"stop-color":s.color})));return L("linearGradient",{gradientUnits:"userSpaceOnUse",id:r.id,x1:r.x1,x2:r.x2,y1:r.y1,y2:r.y2},i)}return null}function gxe(t,e){if(!t||t.length===0)return null;const r=[];for(const i of t){const{shape:s,fill:n,stroke:o,font:a}=i,l=uL(n),u=cL(o),h=s.type==="text"?rW(s,a):null,p=lL(s,l.fill,u,h);p&&r.push(p)}return L("mask",{id:e,maskUnits:"userSpaceOnUse"},L("g",null,r))}function a4(t,e,r){return ba(t,Vv(t),[e,r])}function l4(t,e,r,i,s){return jv(t,Vv(t),[e,r]),t[4]=t[4]*e-i*e+i,t[5]=t[5]*r-s*r+s,t}function vxe(t,e,r,i){const s=e%360*Math.PI/180;pc(t,Vv(t),s);const n=Math.cos(s),o=Math.sin(s),a=t[4],l=t[5];return t[4]=a*n-l*o+i*o-r*n+r,t[5]=l*n+a*o-r*o-i*n+i,t}function Ti(t,e){Nt&&"left"in Nt?(Nt.left!=null&&Nt.left>t&&(Nt.left=t),(Nt.right==null||Nt.right<t)&&(Nt.right=t),(Nt.top==null||Nt.top>e)&&(Nt.top=e),(Nt.bottom==null||Nt.bottom<e)&&(Nt.bottom=e)):Nt={left:t,bottom:e,right:t,top:e}}function u4(t){const e=t.args,r=e.length;let i;switch(t.action){case"M":case"L":case"C":case"S":case"Q":case"T":for(i=0;i<r;i+=2)Ti(e[i],e[i+1]);Ke.x=e[r-2],Ke.y=e[r-1];break;case"H":for(i=0;i<r;++i)Ti(e[i],Ke.y);Ke.x=e[r-1];break;case"V":for(i=0;i<r;++i)Ti(Ke.x,e[i]);Ke.y=e[r-1];break;case"m":{let s=0;for(("x"in Ke)||(Ti(Ke.x=e[0],Ke.y=e[1]),s=2),i=s;i<r;i+=2)Ti(Ke.x+=e[i],Ke.y+=e[i+1]);break}case"l":case"t":for(i=0;i<r;i+=2)Ti(Ke.x+=e[i],Ke.y+=e[i+1]);break;case"h":for(i=0;i<r;++i)Ti(Ke.x+=e[i],Ke.y);break;case"v":for(i=0;i<r;++i)Ti(Ke.x,Ke.y+=e[i]);break;case"c":for(i=0;i<r;i+=6)Ti(Ke.x+e[i],Ke.y+e[i+1]),Ti(Ke.x+e[i+2],Ke.y+e[i+3]),Ti(Ke.x+=e[i+4],Ke.y+=e[i+5]);break;case"s":case"q":for(i=0;i<r;i+=4)Ti(Ke.x+e[i],Ke.y+e[i+1]),Ti(Ke.x+=e[i+2],Ke.y+=e[i+3]);break;case"A":for(i=0;i<r;i+=7)Ti(e[i+5],e[i+6]);Ke.x=e[r-2],Ke.y=e[r-1];break;case"a":for(i=0;i<r;i+=7)Ti(Ke.x+=e[i+5],Ke.y+=e[i+6])}}function c4(t,e,r){const i=fxe[t.toLowerCase()];let s;typeof i=="number"&&(i?e.length>=i&&(s={action:t,args:e.slice(0,e.length-e.length%i)},r.push(s),u4(s)):(s={action:t,args:[]},r.push(s),u4(s)))}function _xe(t){const e=(typeof t.path!="string"?tW(t.path):t.path).match(mxe),r=[];if(Nt={},Ke={},!e)return null;let i="",s=[];const n=e.length;for(let a=0;a<n;++a){const l=e[a],u=parseFloat(l);isNaN(u)?(i&&c4(i,s,r),s=[],i=l):s.push(u)}c4(i,s,r);const o={x:0,y:0,width:0,height:0};return Nt&&"left"in Nt&&(o.x=Nt.left,o.y=Nt.top,o.width=Nt.right-Nt.left,o.height=Nt.bottom-Nt.top),o}function sW(t){const e={x:0,y:0,width:0,height:0};if(t.type==="circle")e.x=t.cx-t.r,e.y=t.cy-t.r,e.width=2*t.r,e.height=2*t.r;else if(t.type==="ellipse")e.x=t.cx-t.rx,e.y=t.cy-t.ry,e.width=2*t.rx,e.height=2*t.ry;else if(t.type==="image"||t.type==="rect")e.x=t.x,e.y=t.y,e.width=t.width,e.height=t.height;else if(t.type==="path"){const r=_xe(t);e.x=r.x,e.y=r.y,e.width=r.width,e.height=r.height}return e}function nW(t){const e={x:0,y:0,width:0,height:0};let r=null,i=Number.NEGATIVE_INFINITY,s=Number.NEGATIVE_INFINITY;for(const n of t)r?(r.x=Math.min(r.x,n.x),r.y=Math.min(r.y,n.y),i=Math.max(i,n.x+n.width),s=Math.max(s,n.y+n.height)):(r=e,r.x=n.x,r.y=n.y,i=n.x+n.width,s=n.y+n.height);return r&&(r.width=i-r.x,r.height=s-r.y),r}function CC(t,e,r,i,s,n,o,a,l){let u=(o&&n?Yu(n,e):e)/2,h=(o&&n?Yu(n,r):r)/2;if(l){const S=l[0],$=l[1];u=(o&&n?Yu(n,S):S)/2,h=(o&&n?Yu(n,$):$)/2}const p=t.width+i,m=t.height+i,y=Ol(),g=Ol();let v=!1;if(s&&p!==0&&m!==0){const S=e!==r?e/r:p/m,$=e>r?e:r;let T=1,I=1;isNaN($)||(S>1?(T=$/p,I=$/S/m):(I=$/m,T=$*S/p)),jo(g,g,l4(y,T,I,u,h)),v=!0}const _=t.x+(p-i)/2,b=t.y+(m-i)/2;if(jo(g,g,a4(y,u-_,h-b)),!v&&(p>e||m>r)){const S=p/e>m/r,$=(S?e:r)/(S?p:m);jo(g,g,l4(y,$,$,_,b))}return a&&jo(g,g,a4(y,a[0],a[1])),n&&jo(g,g,vxe(y,n,_,b)),`matrix(${g[0]},${g[1]},${g[2]},${g[3]},${g[4]},${g[5]})`}function bxe(t,e,r){const i=t?.effects.find((u=>u.type==="bloom"));if(!i)return null;const{strength:s,radius:n}=i,o=s>0?n:0,a=(s+o)*e,l=4*s+1;return L("filter",{filterUnits:"userSpaceOnUse",height:"300%",id:`bloom${r}`,width:"300%",x:"-100%",y:"-100%"},L("feMorphology",{in:"SourceGraphic",operator:"dilate",radius:(s+.5*o)*(5**(e/100)*(.4+e/100)),result:"dilate"}),L("feGaussianBlur",{in:"dilate",result:"blur",stdDeviation:a/25}),L("feGaussianBlur",{in:"blur",result:"intensityBlur",stdDeviation:a/50}),L("feComponentTransfer",{in:"SourceGraphic",result:"intensityBrightness"},L("feFuncR",{slope:l,type:"linear"}),L("feFuncG",{slope:l,type:"linear"}),L("feFuncB",{slope:l,type:"linear"})),L("feMerge",null,L("feMergeNode",{in:"intensityBlur"}),L("feMergeNode",{in:"intensityBrightness"}),L("feGaussianBlur",{stdDeviation:s/10})))}function oW(t,e,r,i={}){const s=[],n=[],o=hxe(),a=bxe(i.effectView,e,o);let l=null;if(a){const m=i.effectView?.effects.find((_=>_.type==="bloom")),y=i.clipBloomEffect||!m.strength?0:(m.strength+m.radius/2)/3,g=e+e*y,v=r+r*y;l=[Math.max(g,10),Math.max(v,10)]}let u=e,h=r;if(i.useRotationSize)for(let m=0;m<t.length;m++){const y=i.rotations?.[m]??0;u=Math.max(Yu(y,e),u),h=Math.max(Yu(y,r),h)}for(let m=0;m<t.length;m++){const y=t[m],g=[],v=[];let _=0,b=0,S=0;for(const P of y){const{shape:R,fill:D,stroke:V,font:U,offset:Z}=P;i.ignoreStrokeWidth||R.type==="text"||(_+=V?.width||0);const X=uL(D),le=cL(V),ee=R.type==="text"?rW(R,U):null;s.push(iW(X)),g.push(lL(R,X.fill,le,ee,i.ariaLabel)),v.push(sW(R)),Z&&(b+=Z[0],S+=Z[1])}const $=i.rotations?.[m]??0;i.useRotationSize&&(b+=(u-Yu($,e))/2,S+=(h-Yu($,r))/2);const T=CC(nW(v),e,r,_,i.scale??!1,$,i.useRotationSize??!1,[b,S],l);let I=null;if(i.masking){const P=`mask-${m}`,R=i.masking[m];s.push(gxe(R,P)),I=`url(#${P})`}n.push(I?L("g",{mask:I},L("g",{transform:T},g)):L("g",{transform:T},g))}return a&&(mv(l),u=l[0],h=l[1]),L("svg",{"aria-label":i.ariaLabel,focusable:!1,height:h,role:"img",style:"display: block;",width:u,xmlns:dxe},a,L("defs",null,s),a?L("g",{filter:`url(#bloom${o})`},n):n)}const wxe=new Q("white");function Sxe(t){const e=t.symbolLayers?.at(-1);if(e&&"outline"in e)return e?.outline?.size}function xxe(t){if(!t)return 0;if(Pa(t)){const e=Sxe(t);return e??0}return tt(iv(t)?.width)}function Y2(t){if(t==null||!("symbolLayers"in t)||t.symbolLayers==null)return!1;switch(t.type){case"point-3d":return t.symbolLayers.some((e=>e.type==="object"));case"line-3d":return t.symbolLayers.some((e=>e.type==="path"));case"polygon-3d":return t.symbolLayers.some((e=>e.type==="object"||e.type==="extrude"));default:return!1}}function $xe(t){return t.resource?.href??""}function xze(t,e){if(!t)return null;let r=null;return Pa(t)?r=Mxe(t):M2(t)&&(r=t.type==="cim"?VH(t):t.color?new Q(t.color):null),r?sv(r,e):null}function Mxe(t){const e=t.symbolLayers;if(!e)return null;let r=null;return e.forEach((i=>{i.type==="object"&&i.resource?.href||(r=i.type==="water"?i.color:i.material?i.material.color:null)})),r?new Q(r):null}function sv(t,e){if(e==null||t==null)return t;const r=t.toRgba();return r[3]=r[3]*e,new Q(r)}function Txe(t,e,r){const i=t.symbolLayers;if(!i)return;const s=n=>sv(e??n??(r!=null?wxe:null),r);i.forEach((n=>{if(n.type!=="object"||!n.resource?.href||e)if(n.type==="water")n.color=s(n.color);else{const o=n.material!=null?n.material.color:null,a=s(o);if(n.material==null?n.material=new ls({color:a}):n.material.color=a,r!=null&&"outline"in n&&n.outline?.color!=null&&(n.outline.color=sv(n.outline.color,r)),"marker"in n&&n.marker!=null){const l=s(n.marker.color);n.marker.color=l}}}))}function Exe(t,e,r){(e=e??t.color)&&(t.color=sv(e,r)),r!=null&&"outline"in t&&t.outline?.color&&(t.outline.color=sv(t.outline.color,r))}function A$(t,e,r){t&&(e||r!=null)&&(e&&(e=new Q(e)),Pa(t)?Txe(t,e,r):M2(t)&&Exe(t,e,r))}async function Ixe(t,e){const r=t.symbolLayers;r&&await see(r,(async i=>Cxe(i,e)))}async function Cxe(t,e){switch(t.type){case"extrude":Axe(t,e);break;case"icon":case"line":case"text":Pxe(t,e);break;case"path":Rxe(t,e);break;case"object":await Lxe(t,e)}}function Pxe(t,e){const r=aW(e);r!=null&&(t.size=r)}function aW(t){for(const e of t)if(typeof e=="number")return e;return null}function Axe(t,e){const r=e[2];typeof r=="number"&&(t.size=r)}async function Lxe(t,e){const{resourceSize:r,symbolSize:i}=await kxe(t),s=lW(e,r,i);s!=null&&(t.width=w0(e[0],i[0],r[0],s),t.depth=w0(e[1],i[1],r[1],s),t.height=w0(e[2],i[2],r[2],s))}function Rxe(t,e){const r=lW(e,MU,[t.width,void 0,t.height]);r!=null&&(t.width=w0(e[0],t.width,1,r),t.height=w0(e[2],t.height,1,r))}function lW(t,e,r){for(let i=0;i<3;i++){const s=t[i];switch(s){case"symbol-value":{const n=r[i];return n!=null?n/e[i]:1}case"proportional":break;default:if(s&&e[i])return s/e[i]}}return null}async function kxe(t){const{computeObjectLayerResourceSize:e}=await J(()=>import("./symbolLayerUtils-C0tMowM3.js"),[]),r=await e(t,10),{width:i,height:s,depth:n}=t,o=[i,n,s];let a=1;for(let l=0;l<3;l++){const u=o[l];if(u!=null){a=u/r[l];break}}for(let l=0;l<3;l++)o[l]==null&&(o[l]=r[l]*a);return{resourceSize:r,symbolSize:o}}function w0(t,e,r,i){switch(t){case"proportional":return r*i;case"symbol-value":return e??r;default:return t}}function Oxe(t,e){const r=aW(e);if(r!=null)switch(t.type){case"simple-marker":t.size=r;break;case"picture-marker":{const i=t.width/t.height;i>1?(t.width=r,t.height=r*i):(t.width=r*i,t.height=r);break}case"simple-line":t.width=r;break;case"text":t.font.size=r}}async function Nxe(t,e){if(t&&e)return Pa(t)?Ixe(t,e):void(M2(t)&&Oxe(t,e))}function Fxe(t,e,r){if(t&&e!=null)if(Pa(t)){const i=t.symbolLayers;i&&i.forEach((s=>{if(s.type==="object")switch(r){case"tilt":s.tilt=(s.tilt??0)+e;break;case"roll":s.roll=(s.roll??0)+e;break;default:s.heading=(s.heading??0)+e}s.type==="icon"&&(s.angle+=e)}))}else M2(t)&&(t.type!=="simple-marker"&&t.type!=="picture-marker"&&t.type!=="text"||(t.angle+=e))}function Wv(t){if(!t)return null;const e=t.effects.filter((r=>r.type!=="bloom")).map((r=>r.toJSON()));return cS(e)}function $ze(t){return t!=null&&t.type==="polygon-3d"&&t.symbolLayers.some((e=>e.type==="extrude"))}const h4=Aw();function Dxe(t,e){h4.append(t,e),h4.detach(e)}function Zm(t,e,r){const i=Math.ceil(e[0]),s=Math.ceil(e[1]);if(!t.some((o=>!!o.length)))return null;const n=r?.node||document.createElement("div");return r.opacity!=null&&(n.style.opacity=r.opacity.toString()),r.effectView!=null&&(n.style.filter=Wv(r.effectView)),Dxe(n,(()=>oW(t,i,s,r))),n}function zxe(t,e){t=Math.ceil(t),e=Math.ceil(e);const r=document.createElement("canvas");r.width=t,r.height=e,r.style.width=t+"px",r.style.height=e+"px";const i=r.getContext("2d");return i.clearRect(0,0,t,e),i}function Vxe(t,e,r){return t?et(t,{responseType:"image"}).then((i=>{const s=i.data,n=s.width,o=s.height,a=n/o;let l=e;if(r){const u=Math.max(n,o);l=Math.min(l,u)}return{image:s,width:a<=1?Math.ceil(l*a):l,height:a<=1?l:Math.ceil(l/a)}})):Promise.reject(new F("renderUtils: imageDataSize","href not provided."))}function jxe(t,e){return!(!t||e==="ignore")&&(e!=="multiply"||t.r!==255||t.g!==255||t.b!==255||t.a!==1)}function Uxe(t,e,r,i,s){switch(s){case"multiply":t[e]*=r[0],t[e+1]*=r[1],t[e+2]*=r[2],t[e+3]*=r[3];break;default:{const n=J2({r:t[e],g:t[e+1],b:t[e+2]});n.h=i.h,n.s=i.s,n.v=n.v/100*i.v;const o=Rd(n);t[e]=o.r,t[e+1]=o.g,t[e+2]=o.b,t[e+3]*=r[3];break}}}function Gxe(t,e,r,i,s){return Vxe(t,e,s).then((n=>{const o=n.width??e,a=n.height??e;if(n.image&&jxe(r,i)){let l=n.image.width,u=n.image.height;z("edge")&&/\.svg$/i.test(t)&&(l-=1,u-=1);const h=zxe(o,a);h.drawImage(n.image,0,0,l,u,0,0,o,a);const p=h.getImageData(0,0,o,a),m=[r.r/255,r.g/255,r.b/255,r.a],y=J2(r);for(let g=0;g<p.data.length;g+=4)Uxe(p.data,g,m,y,i);h.putImageData(p,0,0),t=h.canvas.toDataURL("image/png")}else{const l=Ve?.findCredential(t);if(l?.token){const u=t.includes("?")?"&":"?";t=`${t}${u}token=${l.token}`}}return{url:t,width:o,height:a}})).catch((()=>({url:t,width:e,height:e})))}const uW="esri-relationship-ramp",rp=`${uW}--diamond`,au=`${uW}--square`,Bxe="http://www.w3.org/2000/svg",pt={diamondContainer:`${rp}__container`,diamondLeftCol:`${rp}__left-column`,diamondRightCol:`${rp}__right-column`,diamondMidCol:`${rp}__middle-column`,diamondMidColLabel:`${rp}__middle-column--label`,diamondMidColRamp:`${rp}__middle-column--ramp`,squareTable:`${au}__table`,squareTableRow:`${au}__table-row`,squareTableCell:`${au}__table-cell`,squareTableLabel:`${au}__table-label`,squareTableLabelLeftBottom:`${au}__table-label--left-bottom`,squareTableLabelRightBottom:`${au}__table-label--right-bottom`,squareTableLabelLeftTop:`${au}__table-label--left-top`,squareTableLabelRightTop:`${au}__table-label--right-top`};function cW(t,e,r={}){const{focus:i,labels:s}=t,n=!!i,o=qxe(t,e,r),a={justifyContent:"center"},l=k2(),u=r.key??e;return n?L("div",{class:pt.diamondContainer,key:`${u}-container`,styles:a},L("div",{class:pt.diamondLeftCol},l?s.right:s.left),L("div",{class:pt.diamondMidCol},L("div",{class:pt.diamondMidColLabel},s.top),o,L("div",{class:pt.diamondMidColLabel},s.bottom)),L("div",{class:pt.diamondRightCol},l?s.left:s.right)):L("div",{class:pt.squareTable,key:`${u}-container`},L("div",{class:pt.squareTableRow},L("div",{class:ef(pt.squareTableCell,pt.squareTableLabel,pt.squareTableLabelRightBottom)},l?s.top:s.left),L("div",{class:pt.squareTableCell}),L("div",{class:ef(pt.squareTableCell,pt.squareTableLabel,pt.squareTableLabelLeftBottom)},l?s.left:s.top)),L("div",{class:pt.squareTableRow},L("div",{class:pt.squareTableCell}),o,L("div",{class:pt.squareTableCell})),L("div",{class:pt.squareTableRow},L("div",{class:ef(pt.squareTableCell,pt.squareTableLabel,pt.squareTableLabelRightTop)},l?s.right:s.bottom),L("div",{class:pt.squareTableCell}),L("div",{class:ef(pt.squareTableCell,pt.squareTableLabel,pt.squareTableLabelLeftTop)},l?s.bottom:s.right)))}function d4(t,e,r){const i=`${r}_arrowStart`,s=`${r}_arrowEnd`,n=t==="left",o={markerStart:null,markerEnd:null};switch(e){case"HL":n?o.markerStart=`url(#${s})`:o.markerEnd=`url(#${i})`;break;case"LL":o.markerStart=`url(#${s})`;break;case"LH":n?o.markerEnd=`url(#${i})`:o.markerStart=`url(#${s})`;break;default:o.markerEnd=`url(#${i})`}return o}function qxe(t,e,r={}){const{focus:i,numClasses:s,colors:n,rotation:o}=t,{opacity:a,effectList:l,ariaLabel:u}=r,h=r.size??60,p=!!i,m=Math.sqrt(h**2+h**2)+(p?0:5),y=[],g=[],v=[],_=(h||75)/s;for(let Z=0;Z<s;Z++){const X=Z*_;for(let le=0;le<s;le++){const ee=le*_,ke=uL(n[Z][le]),Ze=cL(null),it={type:"rect",x:ee,y:X,width:_,height:_},ze=iW(ke);ze&&y.push(ze);const zt=lL(it,ke.fill,Ze,null);zt&&g.push(zt),v.push(sW(it))}}const b=15,S=15,$=10;let T=null;p||(T="margin: -15px -15px -18px -15px");const I=d4("left",i,e),P=d4("right",i,e),R=nW(v),D=CC(R,m,m,0,!1,o,!1),V=CC(R,m,m,0,!1,p?-45:null,!1),U={filter:Wv(l)??void 0,opacity:a==null?"":`${a}`};return L("div",{class:p?pt.diamondMidColRamp:pt.squareTableCell,styles:U},L("svg",{"aria-label":u,focusable:!1,height:m,role:"image",style:T,width:m,xmlns:Bxe},L("defs",null,L("marker",{id:`${e}_arrowStart`,markerHeight:"10",markerUnits:"strokeWidth",markerWidth:"10",orient:"auto",refX:"5",refY:"5"},L("polyline",{fill:"none",points:"0,0 5,5 0,10",stroke:"#555555","stroke-width":"1"})),L("marker",{id:`${e}_arrowEnd`,markerHeight:"10",markerUnits:"strokeWidth",markerWidth:"10",orient:"auto",refX:"0",refY:"5"},L("polyline",{fill:"none",points:"5,0 0,5 5,10",stroke:"#555555","stroke-width":"1"})),y),L("g",{transform:D},g),L("g",{transform:V},L("line",{fill:"none","marker-end":I.markerEnd,"marker-start":I.markerStart,stroke:"#555555","stroke-width":"1",x1:-10,x2:-10,y1:h-b,y2:b}),L("line",{fill:"none","marker-end":P.markerEnd,"marker-start":P.markerStart,stroke:"#555555","stroke-width":"1",x1:S,x2:h-S,y1:h+$,y2:h+$}))))}function Hxe(t){return t=t||globalThis.location.hostname,Wxe.some((e=>t?.match(e)!=null))}function p4(t,e){return t?(e=e||globalThis.location.hostname)?e.match(hW)!=null||e.match(pW)!=null?t.replace("static.arcgis.com","staticdev.arcgis.com"):e.match(dW)!=null||e.match(fW)!=null?t.replace("static.arcgis.com","staticqa.arcgis.com"):t:t:null}const hW=/^devext\.arcgis\.com$/,dW=/^qaext\.arcgis\.com$/,pW=/^[\w-]*\.mapsdevext\.arcgis\.com$/,fW=/^[\w-]*\.mapsqa\.arcgis\.com$/,Wxe=[/^([\w-]*\.)?[\w-]*\.zrh-dev-local\.esri\.com$/,hW,dW,/^jsapps\.esri\.com$/,pW,fW],Zxe=["web-gltf","web","cim"];function mW(t,e,r){const i=t.name;return i==null?Promise.reject(new F("symbolstyleutils:style-symbol-reference-name-missing","Missing name in style symbol reference")):t.styleName==="Esri2DPointSymbolsStyle"?Jxe(i,e,r):OH(t,e,r).then((s=>gW(s,i,e,o2e,r)))}function yW(t,e){return e.items.find((r=>r.name===t))}async function gW(t,e,r,i,s){const n=r?.portal!=null?r.portal:Y.getDefault(),o={portal:n,url:Pr(t.baseUrl)},a=yW(e,t.data);if(!a)throw new F("symbolstyleutils:symbol-name-not-found",`The symbol name '${e}' could not be found`,{symbolName:e});const l=s?.acceptedFormats??Zxe,u=i(a,l);if(!u)throw new F("symbolstyleutils:symbol-reference-no-accepted-format",`The symbol name '${e}' does not have an accepted format (one of ${l})`,{symbolName:e});const{url:h,format:p}=u;let m=Fl(h,o),y=a.thumbnail?.href??null;const g=a.thumbnail?.imageData;Hxe()&&(m=p4(m)??"",y=p4(y));const v={portal:n,url:Pr(JP(m)),origin:"portal-item"};return rL(m,s).then((_=>{const b=p==="cim"?NH(_.data):_.data,S=Jq(b,v);if(S&&Pa(S)){if(y){const $=Fl(y,o);S.thumbnail=new Kh({url:$})}else g&&(S.thumbnail=new Kh({url:`data:image/png;base64,${g}`}));t.styleUrl?S.styleOrigin=new Xn({portal:r.portal,styleUrl:t.styleUrl,name:e}):t.styleName&&(S.styleOrigin=new Xn({portal:r.portal,styleName:t.styleName,name:e}))}return S}))}function Jxe(t,e,r){const i=a2e.replaceAll(/\{SymbolName\}/gi,t),s=e.portal!=null?e.portal:Y.getDefault();return rL(i,r).then((n=>{const o=NH(n.data);return Jq(o,{portal:s,url:Pr(JP(i)),origin:"portal-item"})}))}const Yxe=Object.freeze(Object.defineProperty({__proto__:null,fetchSymbolFromStyle:gW,getStyleItemFromStyle:yW,resolveWebStyleSymbol:mW},Symbol.toStringTag,{value:"Module"})),Lh=Bt.size,Eb=Bt.maxSize,hL=Bt.maxOutlineSize,f4=Bt.lineWidth,PC=Bt.tallSymbolWidth;function uf(t){const e=t.outline,r=t.material!=null?t.material.color:null,i=r!=null?r.toHex():null;if(e==null||"pattern"in e&&e.pattern!=null&&e.pattern.type==="style"&&e.pattern.style==="none")return t.type==="fill"&&i==="#ffffff"?{color:"#bdc3c7",width:.75}:null;const s=Fe(e.size)||0;return{color:"rgba("+(e.color!=null?e.color.toRgba():"255,255,255,1")+")",width:Math.min(s,hL),style:"pattern"in e&&e.pattern!=null&&e.pattern.type==="style"?aL(e.pattern.style):null,join:"butt",cap:"patternCap"in e?e.patternCap:"butt"}}async function Xxe(t,e){if(t.thumbnail?.url)return t.thumbnail.url;if(e.type==="icon"&&e?.resource?.href)return $xe(e);const r=Et("esri/images/Legend/legend3dsymboldefault.png");if(t.styleOrigin&&(t.styleOrigin.styleName||t.styleOrigin.styleUrl)){const i=await mW(t.styleOrigin,{portal:t.styleOrigin.portal}).catch((()=>null));if(i&&"thumbnail"in i&&i.thumbnail?.url)return i.thumbnail.url}return r}function L$(t,e=1){const r=t.a,i=J2(t),s=i.h,n=i.s/e,o=100-(100-i.v)/e,{r:a,g:l,b:u}=Rd({h:s,s:n,v:o});return[a,l,u,r]}function $S(t){return t.type==="water"?t.color==null?null:t.color:t.material?.color==null?null:t.material.color}function Je(t,e=0){const r=$S(t);if(!r){if(t.type==="fill")return null;const s=nxe.r,n=tc(s,e);return[n,n,n,100]}const i=r.toRgba();for(let s=0;s<3;s++)i[s]=tc(i[s],e);return i}async function vW(t,e){const r=t.style;return r==="none"?null:{type:"pattern",x:0,y:0,src:await sxe(Et(`esri/symbols/patterns/${r}.png`),e.toCss(!0)),width:5,height:5}}function m4(t){return t.outline?uf(t):{color:"rgba(0, 0, 0, 1)",width:1.5}}function dL(t,e){const r=$S(t);if(!r)return null;let i="rgba(";return i+=tc(r.r,e)+",",i+=tc(r.g,e)+",",i+=tc(r.b,e)+",",i+r.a+");"}function AC(t,e){const r=dL(t,e);return r?"pattern"in t&&t.pattern!=null&&t.pattern.type==="style"&&t.pattern.style==="none"?null:{color:r,width:Math.min(t.size?Fe(t.size):.75,hL),style:"pattern"in t&&t.pattern!=null&&t.pattern.type==="style"?aL(t.pattern.style):null,cap:"cap"in t?t.cap:null,join:"join"in t?t.join==="miter"?Fe(2):t.join:null}:{}}function q_(t,e,r){const i=r!=null?.75*r:0;return{type:"linear",x1:i?.25*i:0,y1:i?.5*i:0,x2:i||4,y2:i?.5*i:4,colors:[{color:t,offset:0},{color:e,offset:1}]}}function Kxe(t){const e=t.depth,r=t.height,i=t.width;return i!==0&&e!==0&&r!==0&&i===e&&i!=null&&r!=null&&i<r}function Qxe(t,e,r){const i=[];if(!t)return i;switch(t.type){case"icon":{const o=e,a=e;switch(t.resource?.primitive??Phe){case"circle":i.push({shape:{type:"circle",cx:0,cy:0,r:.5*e},fill:Je(t,0),stroke:uf(t)});break;case"square":i.push({shape:{type:"path",path:[{command:"M",values:[0,a]},{command:"L",values:[0,0]},{command:"L",values:[o,0]},{command:"L",values:[o,a]},{command:"Z",values:[]}]},fill:Je(t,0),stroke:uf(t)});break;case"triangle":i.push({shape:{type:"path",path:[{command:"M",values:[0,a]},{command:"L",values:[.5*o,0]},{command:"L",values:[o,a]},{command:"Z",values:[]}]},fill:Je(t,0),stroke:uf(t)});break;case"cross":i.push({shape:{type:"path",path:[{command:"M",values:[.5*o,0]},{command:"L",values:[.5*o,a]},{command:"M",values:[0,.5*a]},{command:"L",values:[o,.5*a]}]},stroke:m4(t)});break;case"x":i.push({shape:{type:"path",path:[{command:"M",values:[0,0]},{command:"L",values:[o,a]},{command:"M",values:[o,0]},{command:"L",values:[0,a]}]},stroke:m4(t)});break;case"kite":i.push({shape:{type:"path",path:[{command:"M",values:[0,.5*a]},{command:"L",values:[.5*o,0]},{command:"L",values:[o,.5*a]},{command:"L",values:[.5*o,a]},{command:"Z",values:[]}]},fill:Je(t,0),stroke:uf(t)})}break}case"object":switch(t.resource?.primitive??Ohe){case"cone":{const s=q_(Je(t,0),Je(t,-.6),r?PC:e),n=O2e(e,r);i.push({shape:n[0],fill:s},{shape:n[1],fill:s});break}case"inverted-cone":{const s=Je(t,0),n=q_(s,Je(t,-.6),e),o=N2e(e);i.push({shape:o[0],fill:n},{shape:o[1],fill:s});break}case"cube":{const s=R2e(e,r);i.push({shape:s[0],fill:Je(t,0)},{shape:s[1],fill:Je(t,-.3)},{shape:s[2],fill:Je(t,-.5)});break}case"cylinder":{const s=q_(Je(t,0),Je(t,-.6),r?PC:e),n=k2e(e,r);i.push({shape:n[0],fill:s},{shape:n[1],fill:s},{shape:n[2],fill:Je(t,0)});break}case"diamond":{const s=F2e(e);i.push({shape:s[0],fill:Je(t,-.3)},{shape:s[1],fill:Je(t,0)},{shape:s[2],fill:Je(t,-.3)},{shape:s[3],fill:Je(t,-.7)});break}case"sphere":{const s=q_(Je(t,0),Je(t,-.6));s.x1=0,s.y1=0,s.x2=.25*e,s.y2=.25*e,i.push({shape:{type:"circle",cx:0,cy:0,r:.5*e},fill:s});break}case"tetrahedron":{const s=D2e(e);i.push({shape:s[0],fill:Je(t,-.3)},{shape:s[1],fill:Je(t,0)},{shape:s[2],fill:Je(t,-.6)});break}}break}return i}function X2(t){const e=typeof t?.size=="number"?t?.size:null;return e?Fe(e):null}function e$e(t){return t.type==="icon"?"multiply":"tint"}async function t$e(t,e){const r=X2(e),i=e?.maxSize?Fe(e.maxSize):null,s=e?.disableUpsampling??!1,n=t.symbolLayers,o=[],a=[];let l=!1,u=0,h=0,p=0;n.forEach((g=>{if(g.type!=="icon"&&g.type!=="object")return;g&&g.type==="icon"&&(p=Math.max(g.size&&Fe(g.size),p));const v=g.type==="icon"?g.size&&Fe(g.size):0,_=r||v?Math.ceil(Math.min(r||v,i||Eb)):Lh;let b=g.type==="icon"?g.angle:null;if(e?.rotation!=null&&(b=(b??0)+e.rotation),a.push(b),g?.resource?.href){const S=Xxe(t,g).then(($=>{const T=g?.material?.color,I=e$e(g);return Gxe($,_,T,I,s)})).then(($=>{const T=$.width,I=$.height;return u=Math.max(u,T),h=Math.max(h,I),b&&(l=!0),[{shape:{type:"image",x:0,y:0,width:T,height:I,src:$.url},fill:null,stroke:null}]}));o.push(S)}else{let S=_;g.type==="icon"&&r&&(S=_*(v/p));const $=e?.symbolConfig==="tall"||e?.symbolConfig?.isTall||g.type==="object"&&Kxe(g);u=Math.max(u,$?PC:S),h=Math.max(h,S),b&&g.resource?.primitive&&["square","triangle","x"].includes(g.resource?.primitive)&&(l=!0),o.push(Promise.resolve(Qxe(g,S,$)))}}));const m=await Promise.allSettled(o),y=[];return m.forEach((g=>{g.status==="fulfilled"?y.push(g.value):g.reason&&q.getLogger("esri.symbols.support.previewSymbol3D").warn("error while building swatchInfo!",g.reason)})),Zm(y,[u,h],{node:e?.node,scale:!1,opacity:e?.opacity,ariaLabel:e?.ariaLabel,rotations:a,useRotationSize:l})}function r$e(t,e){const r=t.symbolLayers,i=[],s=Y2(t),n=X2(e),o=(e?.maxSize?Fe(e.maxSize):null)||hL;let a,l=0,u=0;return r.forEach(((h,p)=>{if(!h||h.type!=="line"&&h.type!=="path")return;const m=[];switch(h.type){case"line":{const y=AC(h,0);if(y==null)break;const g=y?.width||0;p===0&&(a=g);const v=Math.min(n||g,o),_=p===0?v:n?v*(g/a):v,b=_>f4/2?2*_:f4;u=Math.max(u,_),l=Math.max(l,b),y.width=_,m.push({shape:{type:"path",path:[{command:"M",values:[0,.5*u]},{command:"L",values:[l,.5*u]}]},stroke:y});break}case"path":{const y=Math.min(n||Lh,o),g=Je(h,0),v=Je(h,-.2),_=dL(h,-.4),b=_?{color:_,width:1}:{};if(h.profile==="quad"){const S=h.width,$=h.height,T=P2e(S&&$?S/$:1,$===0,S===0),I={...b,join:"bevel"};m.push({shape:T[0],fill:v,stroke:I},{shape:T[1],fill:v,stroke:I},{shape:T[2],fill:g,stroke:I})}else m.push({shape:b0.pathSymbol3DLayer[0],fill:v,stroke:b},{shape:b0.pathSymbol3DLayer[1],fill:g,stroke:b});u=Math.max(u,y),l=u}}i.push(m)})),Promise.resolve(Zm(i,[l,u],{node:e?.node,scale:s,opacity:e?.opacity,ariaLabel:e?.ariaLabel}))}async function i$e(t,e){const r=t.type==="mesh-3d",i=t.symbolLayers,s=X2(e),n=e?.maxSize?Fe(e.maxSize):null,o=s||Lh,a=[];let l=0,u=0,h=!1;for(let p=0;p<i.length;p++){const m=i.at(p),y=[];if(!r||m.type==="fill"){switch(m.type){case"fill":{const g=Math.min(o,n||Eb);if(l=Math.max(l,g),u=Math.max(u,g),h=!0,r){const v=b0.meshSymbol3DFill,_=dL(m,-.4),b=_?{color:_,width:1,join:"round"}:{};y.push({shape:v[0],fill:Je(m,0),stroke:b},{shape:v[1],fill:Je(m,-.2),stroke:b},{shape:v[2],fill:Je(m,-.6),stroke:b})}else{let v=Je(m,0);const _="pattern"in m?m.pattern:null,b=uf(m),S=$S(m);_!=null&&_.type==="style"&&_.style!=="solid"&&S&&(v=await vW(_,S)),y.push({shape:b0.fill[0],fill:v,stroke:b})}break}case"line":{const g=AC(m,0);if(g==null)break;const v={stroke:g,shape:b0.fill[0]};l=Math.max(l,Lh),u=Math.max(u,Lh),y.push(v);break}case"extrude":{const g={join:"round",width:1,...AC(m,-.4)},v=Je(m,0),_=Je(m,-.2),b=Math.min(o,n||Eb),S=A2e(b);g.width=1,y.push({shape:S[0],fill:_,stroke:g},{shape:S[1],fill:_,stroke:g},{shape:S[2],fill:v,stroke:g});const $=Lh,T=.7*Lh+.5*b;l=Math.max(l,$),u=Math.max(u,T);break}case"water":{const g=$S(m),v=L$(g),_=L$(g,2),b=L$(g,3),S=L2e();h=!0,y.push({shape:S[0],fill:v},{shape:S[1],fill:_},{shape:S[2],fill:b});const $=Math.min(o,n||Eb);l=Math.max(l,$),u=Math.max(u,$);break}}a.push(y)}}return Zm(a,[l,u],{node:e?.node,scale:h,opacity:e?.opacity,ariaLabel:e?.ariaLabel})}function s$e(t,e){if(t.symbolLayers.length===0)return Promise.reject(new F("symbolPreview: renderPreviewHTML3D","No symbolLayers in the symbol."));switch(t.type){case"point-3d":return t$e(t,e);case"line-3d":return r$e(t,e);case"polygon-3d":case"mesh-3d":return i$e(t,e)}return Promise.reject(new F("symbolPreview: swatchInfo3D","symbol not supported."))}const n$e=Object.freeze(Object.defineProperty({__proto__:null,getPatternDescriptor:vW,getSizeFromOptions:X2,getSymbolLayerFill:Je,previewSymbol3D:s$e},Symbol.toStringTag,{value:"Module"})),y4={HH:315,HL:45,LL:135,LH:225},o$e={2:[["HL","HH"],["LL","LH"]],3:[["HL","HM","HH"],["ML","MM","MH"],["LL","LM","LH"]],4:[["HL","HM1","HM2","HH"],["M2L","M2M1","M2M2","M2H"],["M1L","M1M1","M1M2","M1H"],["LL","LM1","LM2","LH"]]};function a$e(t){if(!t)return;const{type:e}=t;if(e.includes("3d"))return Je(t.symbolLayers.at(0));if(e==="simple-line"){const r=iv(t);return r&&r.color}if(t.type==="simple-marker"&&(t.style==="x"||t.style==="cross")){const r=iv(t);return r&&r.color}return ixe(t)}function l$e(t,e){const r=e.HH.label,i=e.LL.label,s=e.HL.label,n=e.LH.label;switch(t){case"HH":default:return{top:r,bottom:i,left:s,right:n};case"HL":return{top:s,bottom:n,left:i,right:r};case"LL":return{top:i,bottom:r,left:n,right:s};case"LH":return{top:n,bottom:s,left:r,right:i}}}function u$e(t){const{focus:e,infos:r,numClasses:i}=t,s=o$e[i],n={};r.forEach((a=>{n[a.value]={label:a.label,fill:a$e(a.symbol)}}));const o=[];for(let a=0;a<i;a++){const l=[];for(let u=0;u<i;u++){const h=n[s[a][u]];l.push(h.fill)}o.push(l)}return{type:"relationship-ramp",numClasses:i,focus:e,colors:o,labels:l$e(e,n),rotation:_W(e)}}function _W(t){let e=y4[t];return t&&e==null&&(e=y4.HH),e||0}let ip=null;const g4=[255,255,255];function v4(t,e){return Math.floor(Math.random()*(e-t+1)+t)}function c$e(t,e,r){const{backgroundColor:i,outline:s,dotSize:n}=t,o=r?.swatchSize||Bt.size,a=.8,l=Math.round(o*o/Math.max(n,.5)**2*a),u=window.devicePixelRatio,h=document.createElement("canvas"),p=o*u;h.width=p,h.height=p,h.style.width=h.width/u+"px",h.style.height=h.height/u+"px";const m=h.getContext("2d");if(i&&(m.fillStyle=i.toCss(!0),m.fillRect(0,0,p,p),m.fill()),m.fillStyle=e?.toCss(!0)??"",ip&&ip.length/2===l)for(let g=0;g<2*l;g+=2){const v=ip[g],_=ip[g+1];m.fillRect(v,_,n*u,n*u),m.fill()}else{ip=[];for(let g=0;g<2*l;g+=2){const v=v4(0,p),_=v4(0,p);ip.push(v,_),m.fillRect(v,_,n*u,n*u),m.fill()}}s&&(s.color&&(m.strokeStyle=s.color.toCss(!0)),m.lineWidth=s.width,m.strokeRect(0,0,p,p));const y=new Image(o,o);return y.src=h.toDataURL(),y.ariaLabel=r?.ariaLabel??null,y.alt=r?.ariaLabel??"",y}function h$e(t,e={}){const r=e.radius||40,i=2*Math.PI*r,s=t.length,n=i/s,o=[],a=iv(e.outline);a?.width!=null&&(a.width*=2),(a||e.backgroundColor)&&o.push({shape:{type:"circle",cx:r,cy:r,r},fill:e.backgroundColor,stroke:a,offset:[0,0]});const l=e.values,u=l&&l.length===s&&l.reduce(((g,v)=>g+v),0)===100,h=[0];for(let g=0;g<s;g++){let v=null;u&&(v=l[g]*i/100,h.push(v+h[g])),o.push({shape:{type:"circle",cx:r,cy:r,r:r/2},fill:[0,0,0,0],stroke:{width:r,dashArray:`${(v??n)/2} ${i}`,dashoffset:"-"+(u?h[g]/2:g*(n/2)),color:t[g]},offset:[0,0]})}let p=null;const m=2*r+(a?.width||0),y=e.holePercentage;if(y){a&&o.push({shape:{type:"circle",cx:r,cy:r,r:r*y},fill:null,stroke:a,offset:[0,0]});const g=m/2;p=[[{shape:{type:"circle",cx:g,cy:g,r:g},fill:g4,stroke:a?{...a,color:g4}:null,offset:[0,0]},{shape:{type:"circle",cx:g,cy:g,r:r*y},fill:[0,0,0],stroke:null,offset:[0,0]}]]}return Zm([o],[m,m],{effectView:e.effectList,ignoreStrokeWidth:!0,masking:p,rotations:[-90],ariaLabel:e.ariaLabel})}function ah(t,e={}){const s=e.align==="horizontal",n=s?75:24,o=s?24:75,a=e.width??n,l=e.height??o,u=e.gradient??!0,h=window.devicePixelRatio,p=a*h,m=l*h,y=document.createElement("canvas");y.width=p,y.height=m,y.ariaLabel=e.ariaLabel??null,y.style.width=`${a}px`,y.style.height=`${l}px`;const g=y.getContext("2d"),v=s?p:0,_=s?0:m;if(u){const S=g.createLinearGradient(0,0,v,_),$=t.length,T=$===1?0:1/($-1);t.forEach(((I,P)=>S.addColorStop(P*T,I.toString()))),g.fillStyle=S,g.fillRect(0,0,p,m)}else{const S=s?p/t.length:p,$=s?m:m/t.length;let T=0,I=0;for(const P of t)g.fillStyle=P.toString(),g.fillRect(T,I,S,$),T=s?T+S:0,I=s?0:I+$}const b=document.createElement("div");return b.style.width=`${a}px`,b.style.height=`${l}px`,d$e(b,e?.effectList),b.appendChild(y),b}function d$e(t,e){if(!e)return;t.style.filter=Wv(e);const r=e.effects;if(r){for(const i of r)if(i?.type==="drop-shadow"){i.offsetX<0?t.style.marginLeft=`${Math.abs(i.offsetX)}px`:t.style.marginRight=`${i.offsetX}px`;break}}}async function bW(t,e){switch(t.type){case"web-style":{const{previewWebStyleSymbol:r}=await J(()=>import("./previewWebStyleSymbol-DDS_zTQJ.js"),[]);return r(t,bW,e)}case"label-3d":case"line-3d":case"mesh-3d":case"point-3d":case"polygon-3d":{const{previewSymbol3D:r}=await J(()=>Promise.resolve().then(()=>n$e),void 0);return r(t,e)}case"simple-marker":case"simple-line":case"simple-fill":case"picture-marker":case"picture-fill":case"text":{const{previewSymbol2D:r}=await J(()=>import("./previewSymbol2D-Dm3YaeIo.js"),[]);return r(t,e)}case"cim":{const{previewCIMSymbol:r}=await J(()=>Promise.resolve().then(()=>PIe),void 0);return r(t,e)}default:return}}function wW(t){return t&&"opacity"in t?t.opacity*wW(t.parent):1}async function Mze(t,e){if(!t)return;const r=t.sourceLayer,i=(e!=null&&e.useSourceLayer?r:t.layer)??r,s=e?.ignoreOpacity?1:wW(i);if(t.symbol!=null&&(e==null||e.ignoreGraphicSymbol!==!0)){const $=t.symbol.type==="web-style"?await t.symbol.fetchSymbol({...e,acceptedFormats:e?.webStyleAcceptedFormats,cache:e?.webStyleCache}):t.symbol.clone();return A$($,null,s),$}const n=e?.renderer??p$e(i);let o=n&&"getSymbolAsync"in n?await n.getSymbolAsync(t,e):null;if(!o)return;if(o=o.type==="web-style"?await o.fetchSymbol({...e,acceptedFormats:e?.webStyleAcceptedFormats,cache:e?.webStyleCache}):o.clone(),!n||!("visualVariables"in n)||!n.visualVariables?.length)return A$(o,null,s),o;if("arcadeRequiredForVisualVariables"in n&&n.arcadeRequiredForVisualVariables&&e?.arcade==null){const $={...e};$.arcade=await jl(),e=$}const{getColor:a,getOpacity:l,getAllSizes:u,getRotationAngle:h}=await J(()=>Promise.resolve().then(()=>Ad),void 0),p=[],m=[],y=[],g=[];for(const $ of n.visualVariables)switch($.type){case"color":p.push($);break;case"opacity":m.push($);break;case"rotation":g.push($);break;case"size":$.target||y.push($)}const v=!!p.length&&p[p.length-1],_=v?a(v,t,e):null,b=!!m.length&&m[m.length-1];let S=b?l(b,t,e):null;if(s!=null&&(S=S!=null?S*s:s),e?.ignoreOpacity&&(S=1),_!=null&&b&&S!=null&&(_.a=1),A$(o,_,S),y.length&&e?.ignoreSizeVariables!==!0){const $=u(y,t,e);await Nxe(o,$)}if(e?.ignoreRotationVariables!==!0)for(const $ of g)Fxe(o,h($,t,e),$.axis);return o}function p$e(t){if(t)return"renderer"in t?t.renderer:void 0}function f$e(t,e,r){const i=t.effectiveClusterRenderer;if(!i||!("visualVariables"in i)||!i.visualVariables)return null;const s=i.visualVariables.find((h=>h.type==="size"));if(!("stops"in s)||!s.stops)return null;const n=s.stops.find((h=>h.useMinValue)),o=s.stops.find((h=>h.useMaxValue));if(n==null||o==null)return null;const a=r.featuresTilingScheme.getClosestInfoForScale(r.scale).level,l=s.field,u=e.getDisplayStatistics(a,l);return u?new Ue({field:s.field,minSize:t.clusterMinSize,minDataValue:u.minValue,maxSize:t.clusterMaxSize,maxDataValue:u.maxValue}):null}const m$e=/^-?(\d+)(\.(\d+))?$/i;function y$e(t,e){return t-e}function g$e(t,e){let r,i;return r=Number(t.toFixed(e)),r<t?i=r+1/10**e:(i=r,r-=1/10**e),r=Number(r.toFixed(e)),i=Number(i.toFixed(e)),[r,i]}function v$e(t,e,r,i,s){const n=Ib(t,e,r,i),o=n.previous==null||n.previous<=s,a=n.next==null||n.next<=s;return o&&a||n.previous+n.next<=2*s}function MS(t){const e=String(t),r=e.match(m$e);if(r?.[1])return{integer:r[1].split("").length,fractional:r[3]?r[3].split("").length:0};if(e.toLowerCase().includes("e")){const i=e.split("e"),s=i[0],n=i[1];if(s&&n){const o=Number(s);let a=Number(n);const l=a>0;l||(a=Math.abs(a));const u=MS(o);return l?(u.integer+=a,a>u.fractional?u.fractional=0:u.fractional-=a):(u.fractional+=a,a>u.integer?u.integer=1:u.integer-=a),u}}return{integer:0,fractional:0}}function Ib(t,e,r,i){const s={previous:null,next:null};if(r!=null){const n=t-r,o=e-r-n;s.previous=Math.floor(Math.abs(100*o/n))}if(i!=null){const n=i-t,o=i-e-n;s.next=Math.floor(Math.abs(100*o/n))}return s}function TS(t,e={}){const r=t.slice(),{tolerance:i=2,strictBounds:s=!1,indexes:n=r.map(((o,a)=>a))}=e;n.sort(y$e);for(let o=0;o<n.length;o++){const a=n[o],l=r[a],u=a===0?null:r[a-1],h=a===r.length-1?null:r[a+1],p=MS(l).fractional;if(p){let m,y=0,g=!1;for(;y<=p&&!g;){const v=g$e(l,y);m=s&&o===0?v[1]:v[0],g=v$e(l,m,u,h,i),y++}g&&(r[a]=m)}}return r}const _$e={maximumFractionDigits:20};function b$e(t){return uc(t,_$e)}const Tze=",",w$e={years:365,months:30,days:1,hours:1/24,minutes:1/1440,seconds:1/86400,milliseconds:1/864e5},S$e=new Set(["integer","small-integer"]);let R$=null;function x$e(t){return lA(t)||Nce(t)||Fce(t)}async function Eze(t){const{field:e,field2:r,field3:i,normalizationField:s,valueExpression:n}=t;let o=[];if(n){if(!R$){const{arcadeUtils:a}=await jl();R$=a}o=R$.extractFieldNames(n)}return e&&o.push(e),r&&o.push(r),i&&o.push(i),s&&o.push(s),o}function Cy(t){return String(t).padStart(2,"0")}function _4(t,e,r){let i;return e==="date"||e==="number"?(e==="number"&&(t=new Date(t)),i=`TIMESTAMP'${r?t.getFullYear():t.getUTCFullYear()}-${Cy((r?t.getMonth():t.getUTCMonth())+1)}-${Cy(r?t.getDate():t.getUTCDate())} ${Cy(r?t.getHours():t.getUTCHours())}:${Cy(r?t.getMinutes():t.getUTCMinutes())}:${Cy(r?t.getSeconds():t.getUTCSeconds())}'`):i=t,i}function Ize(t,e,r,i){const{hasQueryEngine:s}=t,n=`(${_4(r,b4(t,r),s)} - ${_4(e,b4(t,e),s)})`;let o=w$e[i],a="/";return o<1&&(o=1/o,a="*"),{sqlExpression:o===1?n:`(${n} ${a} ${o})`,sqlWhere:null}}function b4(t,e){if(e instanceof Date)return"date";if(typeof e=="number")return"number";if(typeof e=="string"){const r=t.getField(e);if(e.toLowerCase()==="<now>")return;if(lA(r))return"field"}}function Cze(t,e){const r=e&&t.getField(e);return!!r&&S$e.has(r.type)}function Pze(t){return`cast(${t} as float)`}function $$e(t,e){const{format:r,timeZoneOptions:i,fieldType:s}=e??{};let n,o;if(i&&({timeZone:n,timeZoneName:o}=Lie(i.layerTimeZone,i.datesInUnknownTimezone,i.viewTimeZone,cy(r||"short-date-short-time"),s)),typeof t=="string"&&isNaN(Date.parse(s==="time-only"?`1970-01-01T${t}Z`:t)))return t;switch(s){case"date-only":{const a=cy(r||"short-date");return typeof t=="string"?Vie(t,{...a}):to(t,{...a,timeZone:$a})}case"time-only":{const a=cy(r||"short-time");return typeof t=="string"?jie(t,a):to(t,{...a,timeZone:$a})}case"timestamp-offset":{if(!n&&typeof t=="string"&&new Date(t).toISOString()!==t)return t;const a=r||i?cy(r||"short-date-short-time"):void 0,l=a?{...a,timeZone:n,timeZoneName:o}:void 0;return typeof t=="string"?Uie(t,l):to(t,l)}default:{const a=r||i?cy(r||"short-date-short-time"):void 0;return to(typeof t=="string"?new Date(t):t,a?{...a,timeZone:n,timeZoneName:o}:void 0)}}}const SW="<",xW=">";function $W(t,e,r,i){let s="";return e===0?s=`${SW} `:e===r&&(s=`${xW} `),s+(i?$$e(t,i):b$e(t))}const M$e=["data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAUCAYAAACNiR0NAAAACXBIWXMAAAAAAAAAAAHqZRakAAAANUlEQVQ4jWPMy8v7z0BFwMLAwMAwcdIkqhiWn5fHwEQVk5DAqIGjBo4aOGrgqIEQwEjtKgAATl0Hu6JrzFUAAAAASUVORK5CYII=","data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAUCAYAAACNiR0NAAAACXBIWXMAAAAAAAAAAAHqZRakAAAANUlEQVQ4jWPMy8v7z0BFwMLAwMAwaeIkqhiWl5/HwEQVk5DAqIGjBo4aOGrgqIEQwEjtKgAATl0Hu6sKxboAAAAASUVORK5CYII=","data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAUCAYAAACNiR0NAAAACXBIWXMAAAAAAAAAAAHqZRakAAAANUlEQVQ4jWPMy8v7z0BFwMLAwMAwadJEqhiWl5fPwEQVk5DAqIGjBo4aOGrgqIEQwEjtKgAATl0Hu75+IUcAAAAASUVORK5CYII="];async function LC(t){if(!("visualVariables"in t)||!t.visualVariables)return null;const e=t.visualVariables.find((o=>o.type==="color"));if(!e)return null;let r=null,i=null;if(e.stops){if(e.stops.length===1)return e.stops[0].color;r=e.stops[0].value,i=e.stops[e.stops.length-1].value}const s=r!=null&&i!=null?r+(i-r)/2:0,{getColor:n}=await J(async()=>{const{getColor:o}=await Promise.resolve().then(()=>Ad);return{getColor:o}},void 0);return n(e,s)??null}async function MW(t,e){const r=t.trailCap,i=t.trailWidth||1,s=e||await LC(t)||t.color;return new jt({cap:r,color:s,width:i})}function T$e(t,e){if(!e.field)return null;if("featureReduction"in t)switch(t.featureReduction?.type){case"cluster":case"binning":{const r=t.featureReduction.fields.find((({name:i})=>i.toLowerCase()===e.field.toLowerCase()));return r&&"getField"in t?t.getField(r.onStatisticField):null}}return"getField"in t?t.getField?.(e.field):null}function E$e(t,e){const r="popupTemplate"in t?t.popupTemplate?.fieldInfos:null;if(r?.length&&e)return r.find((i=>i.fieldName?.toLowerCase()===e.toLowerCase()))?.format?.dateFormat}function I$e(t,e,r){const i=T$e(t,e);if(!i||!x$e(i)&&!aG(i))return null;let s=E$e(t,i.name);if(!s&&i.type==="date"){let n=0,o=0;e.stops?(n=e.stops?.at(0)?.value??n,o=e.stops?.at(-1)?.value??o):"minDataValue"in e&&"maxDataValue"in e&&(n=e.minDataValue??n,o=e.maxDataValue??o),s=o-n>2*IT.days?"short-date":"short-date-short-time"}return{fieldType:i.type,format:s,timeZoneOptions:{layerTimeZone:"preferredTimeZone"in t?t.preferredTimeZone:null,viewTimeZone:r,datesInUnknownTimezone:"datesInUnknownTimezone"in t&&t.datesInUnknownTimezone}}}function ga(t,e){if("authoringInfo"in t)return t.authoringInfo?.visualVariables?.find((({theme:r})=>r===e))}const C$e=new Q([64,64,64]);function TW(t,e){const r=[],i=t.length-1;return t.length===5?r.push(0,2,4):r.push(0,i),t.map(((s,n)=>r.includes(n)?$W(s,n,i,e):null))}async function w4(t,e,r){let i=!1,s=[],n=[];if(t.stops){const u=t.stops;s=u.map((h=>h.value)),i=u.some((h=>!!h.label)),i&&(n=u.map((h=>h.label)))}const o=s[0],a=s[s.length-1];if(o==null&&a==null)return null;const l=i?null:TW(s,r);return(await Promise.all(s.map((async(u,h)=>{const p=t.type==="opacity"?await P$e(u,t,e):(await J(async()=>{const{getColor:y}=await Promise.resolve().then(()=>Ad);return{getColor:y}},void 0)).getColor(t,u),m=i?n[h]:l?.[h]??"";return p==null?null:{value:u,color:p,label:m}})))).filter(ii).reverse()}async function P$e(t,e,r){const i=new Q(r??C$e),s=(await J(async()=>{const{getOpacity:n}=await Promise.resolve().then(()=>Ad);return{getOpacity:n}},void 0)).getOpacity(e,t);return s!=null&&(i.a=s),i}function A$e(t){let e=!1,r=[],i=[];r=t.map((a=>a.value)),e=t.some((a=>!!a.label)),e&&(i=t.map((a=>a.label??"")));const s=r[0],n=r[r.length-1];if(s==null&&n==null)return null;const o=e?null:TW(r);return r.map(((a,l)=>({value:a,color:EW(a,t),label:e?i[l]:o?.[l]??""}))).reverse()}function EW(t,e){const{startIndex:r,endIndex:i,weight:s}=L$e(t,e);if(r===i)return e[r].color;const n=Q.blendColors(e[r].color,e[i].color,s);return new Q(n)}function L$e(t,e){let r=0,i=e.length-1;return e.some(((s,n)=>t<s.value?(i=n,!0):(r=n,!1))),{startIndex:r,endIndex:i,weight:(t-e[r].value)/(e[i].value-e[r].value)}}function R$e(t,e){let r=[];if(t&&t.type==="multipart")t.colorRamps.reverse().forEach(((i,s)=>{s===0?r.push({value:e.max,color:new Q(i.toColor),label:"high"}):r.push({value:null,color:new Q(i.toColor),label:""}),s===t.colorRamps.length-1?r.push({value:e.min,color:new Q(i.fromColor),label:"low"}):r.push({value:null,color:new Q(i.fromColor),label:""})}));else{let i,s;t&&t.type==="algorithmic"?(i=t.fromColor,s=t.toColor):(i=[0,0,0,1],s=[255,255,255,1]),r=[{value:e.max,color:new Q(s),label:"high"},{value:e.min,color:new Q(i),label:"low"}]}return r}function k$e(t){if(!t.colorStops)return[];const e=[...t.colorStops].filter((i=>i.color?.a>0));let r=e.length-1;if(e&&e[0]){const i=e[r];i&&i.ratio!==1&&(e.push(new Pl({ratio:1,color:i.color})),r++)}return e.map(((i,s)=>{let n="";return s===0?n=t.legendOptions?.minLabel||"low":s===r&&(n=t.legendOptions?.maxLabel||"high"),{color:i.color,label:n,ratio:i.ratio}})).reverse()}const O$e="spike-height-override";function N$e(t){const{strokeColor:e,strokeWidth:r,symbolStyle:i}=t,s=i?.includes("solid-fill")||i?.includes("gradient-fill");let n=e?.toArray(),o=!1;return i?.includes("outline")&&s?o=!0:n=t.color?.toArray(),{type:"CIMSolidStroke",effects:F$e(i),enable:!0,colorLocked:o,capStyle:us.Round,joinStyle:pn.Round,lineStyle3D:pC.Strip,miterLimit:4,width:r??tt(1),color:n}}function F$e(t){if(!t?.includes("closed"))return[{type:"CIMGeometricEffectAddControlPoints",angleTolerance:90,primitiveName:"spike-control-points"},{type:"CIMGeometricEffectSuppress",suppress:!0,invert:!0,primitiveName:"spike-stroke-suppress"}]}function S4(t){const{color:e,symbolStyle:r}=t,i=r?.includes("solid-fill"),s=r?.includes("gradient-fill");if(!i&&!s||!e)return;if(i)return{type:"CIMSolidFill",enable:!0,colorLocked:!1,color:e?.toArray()};const n=e.clone();return n.a=0,{type:"CIMGradientFill",enable:!0,angle:90,colorRamp:{type:"CIMMultipartColorRamp",colorRamps:[{type:"CIMLinearContinuousColorRamp",fromColor:e.toArray(),toColor:n.toArray()}],weights:[1]},gradientMethod:"Linear",gradientSize:70,gradientSizeUnits:"Relative",gradientType:"Continuous"}}function IW(t,e){const{defaultHeight:r,baseWidth:i,color:s,strokeColor:n,primitiveOverrides:o,symbolStyle:a,strokeWidth:l}=e,u=t.data.symbol?.type==="CIMPointSymbol"?t.data.symbol:null,h=u?.symbolLayers;if(!h)return t;const p=u.effects,m=p?.find((S=>S.type==="CIMGeometricEffectTaperedPolygon")),y=p?.find((S=>S.type==="CIMGeometricEffectRadial"&&S.primitiveName===O$e));i!=null&&m&&(m.fromWidth=i),r!=null&&y&&(y.length=r);const g=h?.find((S=>S.type==="CIMSolidStroke")),v=h?.find((S=>S.type==="CIMSolidFill")),_=h?.find((S=>S.type==="CIMGradientFill")),b=_?.colorRamp?.type==="CIMMultipartColorRamp"&&_.colorRamp.colorRamps[0]?.type==="CIMLinearContinuousColorRamp"?_.colorRamp.colorRamps[0]:null;if(a){const S=v?.color??b?.fromColor??g?.color,$=s??(S?new Q(S):void 0),T=g?.color??S,I=n??(T?new Q(T):void 0),P=a.includes("solid-fill"),R=a.includes("gradient-fill");if(P||R||k$(h,v??_),$){if(P)k$(h,_),v?v.color=$?.toArray():h.push(S4({...e,color:$}));else if(R)if(k$(h,v),_){if(b&&s){const D=$.clone();D.a=0,b.fromColor=$.toArray(),b.toColor=D.toArray()}}else h.push(S4({...e,color:$}))}if(g){const D=N$e({...e,strokeColor:I,color:$});g.effects=D.effects,g.color=D.color,g.width=D.width,g.colorLocked=D.colorLocked}}else if(g&&(n&&(g.color=n.toArray()),l!=null&&(g.width=l)),v&&s&&(v.color=s.toArray()),b&&s){const S=s.clone();S.a=0,b.fromColor=s.toArray(),b.toColor=S.toArray()}return o!==void 0&&(t.data.primitiveOverrides=k(o)),t}function k$(t,e){if(!e)return;const r=t.indexOf(e);r!==-1&&t.splice(r,1)}const H_=[["(",")"],[")","("],["<",">"],[">","<"],["[","]"],["]","["],["{","}"],["}","{"],["",""],["",""],["",""],["",""],["",""],["",""],["",""],["",""],["",""],["",""],["",""],["",""],["",""],["",""],["",""],["",""],["",""],["",""],["",""],["",""]],xm=["","","",""],D$e=["","","",""],z$e=["","","",""],ES=["","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","",""],V$e=["","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","",""],j$e=["","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","",""],U$e=["","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","",""],G$e=["","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","",""],x4=["","","","","","","","","","","","",""],B$e=["","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","",""],$4=["",""],q$e=["",""],H$e=[[0,3,0,1,0,0,0],[0,3,0,1,2,2,0],[0,3,0,17,2,0,1],[0,3,5,5,4,1,0],[0,3,21,21,4,0,1],[0,3,5,5,4,2,0]],W$e=[[2,0,1,1,0,1,0],[2,0,1,1,0,2,0],[2,0,2,1,3,2,0],[2,0,2,33,3,1,1]],M=0,H=1,_e=2,Xt=3,w=4,Oo=5,Cb=6,x=7,hi=8,Ei=9,An=10,$e=11,O=12,Z$e=13,J$e=14,Y$e=15,X$e=16,K$e=17,he=18,Q$e=["UBAT_L","UBAT_R","UBAT_EN","UBAT_AN","UBAT_ON","UBAT_B","UBAT_S","UBAT_AL","UBAT_WS","UBAT_CS","UBAT_ES","UBAT_ET","UBAT_NSM","UBAT_LRE","UBAT_RLE","UBAT_PDF","UBAT_LRO","UBAT_RLO","UBAT_BN"],Co=100,eMe=[Co+0,M,M,M,M,Co+1,Co+2,Co+3,H,M,M,M,M,M,M,M,M,M,M,M,M,M,M,M,M,M,M,M,M,M,M,M,Co+4,w,w,w,M,w,M,w,M,w,w,w,M,M,w,w,M,M,M,M,M,w,w,w,w,w,w,w,w,w,w,w,w,w,w,w,w,w,w,w,w,w,w,w,w,M,M,w,w,w,w,w,w,w,w,w,w,w,w,w,w,w,w,w,w,w,w,w,w,w,w,w,w,w,w,w,w,w,w,w,w,w,w,w,w,w,w,w,w,w,w,w,w,w,w,w,w,w,w,w,w,w,w,w,w,w,w,w,w,w,w,w,w,w,w,w,w,w,w,w,w,w,w,w,w,w,w,M,M,M,M,M,M,M,M,M,M,M,M,M,M,w,w,w,w,w,w,w,w,w,w,w,w,w,w,w,w,w,w,w,w,w,w,w,w,w,w,w,w,w,w,w,w,w,w,w,w,w,w,w,w,w,w,M,M,w,w,M,M,w,w,M,M,w,w,w,w,w,w,w,w,w,w,w,w,w,w,w,w,w,w,w,w,w,w,w,M,M,M,Co+5,x,x,Co+6,Co+7],tMe=[[he,he,he,he,he,he,he,he,he,Cb,Oo,Cb,hi,Oo,he,he,he,he,he,he,he,he,he,he,he,he,he,he,Oo,Oo,Oo,Cb,hi,w,w,$e,$e,$e,w,w,w,w,w,An,Ei,An,Ei,Ei,_e,_e,_e,_e,_e,_e,_e,_e,_e,_e,Ei,w,w,w,w,w,w,M,M,M,M,M,M,M,M,M,M,M,M,M,M,M,M,M,M,M,M,M,M,M,M,M,M,w,w,w,w,w,w,M,M,M,M,M,M,M,M,M,M,M,M,M,M,M,M,M,M,M,M,M,M,M,M,M,M,w,w,w,w,he,he,he,he,he,he,Oo,he,he,he,he,he,he,he,he,he,he,he,he,he,he,he,he,he,he,he,he,he,he,he,he,he,he,Ei,w,$e,$e,$e,$e,w,w,w,w,M,w,w,he,w,w,$e,$e,_e,_e,w,M,w,w,w,_e,M,w,w,w,w,w,M,M,M,M,M,M,M,M,M,M,M,M,M,M,M,M,M,M,M,M,M,M,M,w,M,M,M,M,M,M,M,M,M,M,M,M,M,M,M,M,M,M,M,M,M,M,M,M,M,M,M,M,M,M,M,w,M,M,M,M,M,M,M,M],[M,M,M,M,M,M,M,M,M,M,M,M,M,M,M,M,M,M,M,M,M,M,M,M,M,M,M,M,M,M,M,M,M,M,M,M,M,M,M,M,w,w,w,w,w,w,w,w,w,M,M,M,M,M,M,M,M,M,M,M,M,M,M,M,M,M,M,M,M,M,M,M,M,M,M,M,M,M,M,M,M,M,M,M,M,M,M,w,w,M,M,M,M,M,M,M,w,M,M,M,M,M,M,M,M,M,M,M,M,M,M,M,M,M,M,M,M,M,M,M,M,M,M,M,M,M,M,M,M,M,M,M,M,M,M,M,w,M,w,w,w,w,w,w,w,O,O,O,O,O,O,O,O,O,O,O,O,O,O,O,O,O,O,O,O,O,O,O,O,O,O,O,O,O,O,O,O,O,O,O,O,O,O,O,O,O,O,O,O,O,H,O,H,O,O,H,O,O,H,O,w,w,w,w,w,w,w,w,H,H,H,H,H,H,H,H,H,H,H,H,H,H,H,H,H,H,H,H,H,H,H,H,H,H,H,w,w,w,w,w,H,H,H,H,H,w,w,w,w,w,w,w,w,w,w,w],[Xt,Xt,Xt,Xt,w,w,w,w,x,$e,$e,x,Ei,x,w,w,O,O,O,O,O,O,O,O,O,O,O,x,w,w,x,x,x,x,x,x,x,x,x,x,x,x,x,x,x,x,x,x,x,x,x,x,x,x,x,x,x,x,x,x,x,x,x,x,x,x,x,x,x,x,x,x,x,x,x,O,O,O,O,O,O,O,O,O,O,O,O,O,O,O,O,O,O,O,O,O,Xt,Xt,Xt,Xt,Xt,Xt,Xt,Xt,Xt,Xt,$e,Xt,Xt,x,x,x,O,x,x,x,x,x,x,x,x,x,x,x,x,x,x,x,x,x,x,x,x,x,x,x,x,x,x,x,x,x,x,x,x,x,x,x,x,x,x,x,x,x,x,x,x,x,x,x,x,x,x,x,x,x,x,x,x,x,x,x,x,x,x,x,x,x,x,x,x,x,x,x,x,x,x,x,x,x,x,x,x,x,x,x,x,x,x,x,x,x,x,x,x,x,x,x,x,x,x,x,x,x,O,O,O,O,O,O,O,Xt,w,O,O,O,O,O,O,x,x,O,O,w,O,O,O,O,x,x,_e,_e,_e,_e,_e,_e,_e,_e,_e,_e,x,x,x,x,x,x],[x,x,x,x,x,x,x,x,x,x,x,x,x,x,w,x,x,O,x,x,x,x,x,x,x,x,x,x,x,x,x,x,x,x,x,x,x,x,x,x,x,x,x,x,x,x,x,x,O,O,O,O,O,O,O,O,O,O,O,O,O,O,O,O,O,O,O,O,O,O,O,O,O,O,O,w,w,x,x,x,x,x,x,x,x,x,x,x,x,x,x,x,x,x,x,x,x,x,x,x,x,x,x,x,x,x,x,x,x,x,x,x,x,x,x,x,x,x,x,x,x,x,x,x,x,x,x,x,x,x,x,x,x,x,x,x,x,x,x,x,x,x,x,x,x,x,x,x,x,x,x,x,x,x,x,x,x,x,x,x,x,x,x,x,x,x,O,O,O,O,O,O,O,O,O,O,O,x,w,w,w,w,w,w,w,w,w,w,w,w,w,w,H,H,H,H,H,H,H,H,H,H,H,H,H,H,H,H,H,H,H,H,H,H,H,H,H,H,H,H,H,H,H,H,H,H,H,H,H,H,H,H,H,H,H,O,O,O,O,O,O,O,O,O,H,H,w,w,w,w,H,w,w,w,w,w],[hi,hi,hi,hi,hi,hi,hi,hi,hi,hi,hi,he,he,he,M,H,w,w,w,w,w,w,w,w,w,w,w,w,w,w,w,w,w,w,w,w,w,w,w,w,hi,Oo,Z$e,J$e,Y$e,X$e,K$e,Ei,$e,$e,$e,$e,$e,w,w,w,w,w,w,w,w,w,w,w,w,w,w,w,Ei,w,w,w,w,w,w,w,w,w,w,w,w,w,w,w,w,w,w,w,w,w,w,w,w,w,w,hi,he,he,he,he,he,w,w,w,w,w,he,he,he,he,he,he,_e,M,w,w,_e,_e,_e,_e,_e,_e,An,An,w,w,w,M,_e,_e,_e,_e,_e,_e,_e,_e,_e,_e,An,An,w,w,w,w,M,M,M,M,M,M,M,M,M,M,M,M,M,w,w,w,$e,$e,$e,$e,$e,$e,$e,$e,$e,$e,$e,$e,$e,$e,$e,$e,$e,$e,$e,$e,$e,$e,$e,$e,$e,$e,w,w,w,w,w,w,w,w,w,w,w,w,w,w,w,w,w,w,w,w,w,w,O,O,O,O,O,O,O,O,O,O,O,O,O,O,O,O,O,O,O,O,O,O,O,O,O,O,O,O,O,O,O,O,O,w,w,w,w,w,w,w,w,w,w,w,w,w,w,w],[M,M,M,M,M,M,M,w,w,w,w,w,w,w,w,w,w,w,w,M,M,M,M,M,w,w,w,w,w,H,O,H,H,H,H,H,H,H,H,H,H,An,H,H,H,H,H,H,H,H,H,H,H,H,H,w,H,H,H,H,H,w,H,w,H,H,w,H,H,w,H,H,H,H,H,H,H,H,H,H,x,x,x,x,x,x,x,x,x,x,x,x,x,x,x,x,x,x,x,x,x,x,x,x,x,x,x,x,x,x,x,x,x,x,x,x,x,x,x,x,x,x,x,x,x,x,x,x,x,x,x,x,x,x,x,x,x,x,x,x,x,x,x,x,x,x,x,x,x,x,x,x,x,x,x,x,x,x,x,x,x,x,x,x,x,x,x,x,x,x,x,x,x,x,x,x,x,x,x,x,x,x,x,x,x,x,x,x,x,x,x,x,x,x,w,w,w,w,w,w,w,w,w,w,w,w,w,w,w,w,w,x,x,x,x,x,x,x,x,x,x,x,x,x,x,x,x,x,x,x,x,x,x,x,x,x,x,x,x,x,x,x,x,x,x,x,x,x,x,x,x,x,x,x,x,x],[O,O,O,O,O,O,O,O,O,O,O,O,O,O,O,O,w,w,w,w,w,w,w,w,w,w,w,w,w,w,w,w,O,O,O,O,O,O,O,w,w,w,w,w,w,w,w,w,w,w,w,w,w,w,w,w,w,w,w,w,w,w,w,w,w,w,w,w,w,w,w,w,w,w,w,w,w,w,w,w,Ei,w,Ei,w,w,Ei,w,w,w,w,w,w,w,w,w,$e,w,w,An,An,w,w,w,w,w,$e,$e,w,w,w,w,w,x,x,x,x,x,w,x,x,x,x,x,x,x,x,x,x,x,x,x,x,x,x,x,x,x,x,x,x,x,x,x,x,x,x,x,x,x,x,x,x,x,x,x,x,x,x,x,x,x,x,x,x,x,x,x,x,x,x,x,x,x,x,x,x,x,x,x,x,x,x,x,x,x,x,x,x,x,x,x,x,x,x,x,x,x,x,x,x,x,x,x,x,x,x,x,x,x,x,x,x,x,x,x,x,x,x,x,x,x,x,x,x,x,x,x,x,x,x,x,x,x,x,x,x,x,x,x,x,x,x,x,x,x,x,x,x,x,x,x,x,x,w,w,he],[w,w,w,$e,$e,$e,w,w,w,w,w,An,Ei,An,Ei,Ei,_e,_e,_e,_e,_e,_e,_e,_e,_e,_e,Ei,w,w,w,w,w,w,M,M,M,M,M,M,M,M,M,M,M,M,M,M,M,M,M,M,M,M,M,M,M,M,M,M,w,w,w,w,w,w,M,M,M,M,M,M,M,M,M,M,M,M,M,M,M,M,M,M,M,M,M,M,M,M,M,M,w,w,w,w,w,w,w,w,w,w,w,M,M,M,M,M,M,M,M,M,M,M,M,M,M,M,M,M,M,M,M,M,M,M,M,M,M,M,M,M,M,M,M,M,M,M,M,M,M,M,M,M,M,M,M,M,M,M,M,M,M,M,M,M,M,M,M,M,M,M,M,M,M,M,M,M,M,M,M,M,M,M,M,M,M,M,M,M,M,M,M,M,M,M,M,M,M,M,M,M,w,w,w,M,M,M,M,M,M,w,w,M,M,M,M,M,M,w,w,M,M,M,M,M,M,w,w,M,M,M,w,w,w,$e,$e,w,w,w,$e,$e,w,w,w,w,w,w,w,w,w,w,w,w,w,w,w,w,w,w,w,w,w,w,w,w,w]];let rMe=class{constructor(){this.inputFormat="ILYNN",this.outputFormat="VLNNN",this.sourceToTarget=[],this.targetToSource=[],this.levels=[]}bidiTransform(e,r,i){if(this.sourceToTarget=[],this.targetToSource=[],!e)return"";if(_Me(this.sourceToTarget,this.targetToSource,e.length),!this.checkParameters(r,i))return e;r=this.inputFormat,i=this.outputFormat;let s=e;const n=wMe,o=E4(r.charAt(1)),a=E4(i.charAt(1)),l=(r.charAt(0)==="I"?"L":r.charAt(0))+o,u=(i.charAt(0)==="I"?"L":i.charAt(0))+a,h=r.charAt(2)+i.charAt(2);n.defInFormat=l,n.defOutFormat=u,n.defSwap=h;const p=Cg(e,l,u,h,n);let m=!1;return i.charAt(1)==="R"?m=!0:i.charAt(1)!=="C"&&i.charAt(1)!=="D"||(m=this.checkContextual(p)==="rtl"),this.sourceToTarget=As,this.targetToSource=bMe(this.sourceToTarget),CS=this.targetToSource,s=r.charAt(3)===i.charAt(3)?p:i.charAt(3)==="S"?sMe(m,p):aMe(p,m,!0),this.sourceToTarget=As,this.targetToSource=CS,this.levels=K2,s}_inputFormatSetter(e){if(!I4.test(e))throw new Error("dojox/string/BidiEngine: the bidi layout string is wrong!");this.inputFormat=e}_outputFormatSetter(e){if(!I4.test(e))throw new Error("dojox/string/BidiEngine: the bidi layout string is wrong!");this.outputFormat=e}checkParameters(e,r){return e?this._inputFormatSetter(e):e=this.inputFormat,r?this._outputFormatSetter(r):r=this.outputFormat,e!==r}checkContextual(e){let r=IS(e);if(r!=="ltr"&&r!=="rtl"){try{r=document.dir.toLowerCase()}catch{}r!=="ltr"&&r!=="rtl"&&(r="ltr")}return r}hasBidiChar(e){return $Me.test(e)}};function Cg(t,e,r,i,s){const n=iMe(t,{inFormat:e,outFormat:r,swap:i},s);if(n.inFormat===n.outFormat)return t;e=n.inFormat,r=n.outFormat,i=n.swap;const o=e.slice(0,1),a=e.slice(1,4),l=r.slice(0,1),u=r.slice(1,4);if(s.inFormat=e,s.outFormat=r,s.swap=i,o==="L"&&r==="VLTR"){if(a==="LTR")return s.dir=sp,lu(t,s);if(a==="RTL")return s.dir=Pg,lu(t,s)}if(o==="V"&&l==="V")return s.dir=a==="RTL"?Pg:sp,O$(t,s);if(o==="L"&&r==="VRTL")return a==="LTR"?(s.dir=sp,t=lu(t,s)):(s.dir=Pg,t=lu(t,s)),O$(t);if(e==="VLTR"&&r==="LLTR")return s.dir=sp,lu(t,s);if(o==="V"&&l==="L"&&a!==u)return t=O$(t),a==="RTL"?Cg(t,"LLTR","VLTR",i,s):Cg(t,"LRTL","VRTL",i,s);if(e==="VRTL"&&r==="LRTL")return Cg(t,"LRTL","VRTL",i,s);if(o==="L"&&l==="L"){const h=s.swap;return s.swap=h.slice(0,1)+"N",a==="RTL"?(s.dir=Pg,t=lu(t,s),s.swap="N"+h.slice(1,3),s.dir=sp,t=lu(t,s)):(s.dir=sp,t=lu(t,s),s.swap="N"+h.slice(1,3),t=Cg(t,"VLTR","LRTL",s.swap,s)),t}return t}function iMe(t,e,r){if(e.inFormat===void 0&&(e.inFormat=r.defInFormat),e.outFormat===void 0&&(e.outFormat=r.defOutFormat),e.swap===void 0&&(e.swap=r.defSwap),e.inFormat===e.outFormat)return e;const i=e.inFormat.slice(0,1),s=e.outFormat.slice(0,1);let n,o=e.inFormat.slice(1,4),a=e.outFormat.slice(1,4);return o.charAt(0)==="C"&&(n=IS(t),o=n==="ltr"||n==="rtl"?n.toUpperCase():e.inFormat.charAt(2)==="L"?"LTR":"RTL",e.inFormat=i+o),a.charAt(0)==="C"&&(n=IS(t),n==="rtl"?a="RTL":n==="ltr"?(n=oMe(t),a=n.toUpperCase()):a=e.outFormat.charAt(2)==="L"?"LTR":"RTL",e.outFormat=s+a),e}function sMe(t,e,r){if(e.length===0)return"";t===void 0&&(t=!0);const i=(e=String(e)).split("");let s=0,n=1,o=i.length;t||(s=i.length-1,n=-1,o=1);const a=nMe(i,s,n,o);let l="";for(let u=0;u<i.length;u++)hMe(a,a.length,u)>-1?(AW(CS,u,!t,-1),As.splice(u,1)):l+=i[u];return l}function nMe(t,e,r,i,s){let n=0;const o=[];let a=0;for(let l=e;l*r<i;l+=r)if(PW(t[l])||nv(t[l])){if(t[l]===""&&dMe(t,l+r,r,i)){t[l]=vMe(t[l+r],n===0?D$e:z$e),l+=r,gMe(t,l,r,i),o[a]=l,a++,n=0;continue}const u=t[l];n===1?t[l]=M4(t,l+r,r,i)?yMe(t[l]):N$(t[l],j$e):M4(t,l+r,r,i)===!0?t[l]=N$(t[l],G$e):t[l]=N$(t[l],V$e),nv(u)||(n=1),mMe(u)===!0&&(n=0)}else n=0;return o}function IS(t){const e=/[A-Za-z\u05d0-\u065f\u066a-\u06ef\u06fa-\u07ff\ufb1d-\ufdff\ufe70-\ufefc]/.exec(t);return e?e[0]<="z"?"ltr":"rtl":""}function oMe(t){const e=t.split("");return e.reverse(),IS(e.join(""))}function aMe(t,e,r){if(t.length===0)return"";e===void 0&&(e=!0);let i="";const s=(t=String(t)).split("");for(let n=0;n<t.length;n++){let o=!1;if(s[n]>=""&&s[n]<"\uFEFF"){const a=t.charCodeAt(n);s[n]>=""&&s[n]<=""?(e?(n>0&&r&&s[n-1]===" "?i=i.slice(0,-1)+"":(i+="",o=!0),i+=xm[(a-65269)/2]):(i+=xm[(a-65269)/2],i+="",n+1<t.length&&r&&s[n+1]===" "?n++:o=!0),o&&(AW(CS,n,!0,1),As.splice(n,0,As[n]))):i+=B$e[a-65136]}else i+=s[n]}return i}function lu(t,e){const r=t.split(""),i=[];return CW(r,i,e),uMe(r,i,e),T4(2,r,i,e),T4(1,r,i,e),K2=i,r.join("")}function CW(t,e,r){const i=t.length,s=r.dir?W$e:H$e;let n=0,o=-1;const a=[],l=[];r.hiLevel=r.dir,r.lastArabic=!1,r.hasUbatAl=!1,r.hasUbatB=!1,r.hasUbatS=!1;for(let u=0;u<i;u++)a[u]=cMe(t[u]);for(let u=0;u<i;u++){const h=n,p=pMe(t,a,l,u,r);l[u]=p,n=s[h][p];const m=240&n;n&=15;const y=s[n][SMe];if(e[u]=y,m>0)if(m===16){for(let g=o;g<u;g++)e[g]=1;o=-1}else o=-1;if(s[n][xMe])o===-1&&(o=u);else if(o>-1){for(let g=o;g<u;g++)e[g]=y;o=-1}a[u]===Oo&&(e[u]=0),r.hiLevel|=y}r.hasUbatS&&lMe(a,e,i,r)}function lMe(t,e,r,i){for(let s=0;s<r;s++)if(t[s]===Cb){e[s]=i.dir;for(let n=s-1;n>=0&&t[n]===hi;n--)e[n]=i.dir}}function uMe(t,e,r){if(r.hiLevel!==0&&r.swap[0]!==r.swap[1])for(let i=0;i<t.length;i++)e[i]===1&&(t[i]=fMe(t[i]))}function cMe(t){const e=t.charCodeAt(0),r=eMe[e>>8];return r<Co?r:tMe[r-Co][255&e]}function O$(t,e){const r=t.split("");if(e){const i=[];CW(r,i,e),K2=i}return r.reverse(),As.reverse(),r.join("")}function hMe(t,e,r){for(let i=0;i<e;i++)if(t[i]===r)return i;return-1}function PW(t){for(let e=0;e<$4.length;e++)if(t>=$4[e]&&t<=q$e[e])return!0;return!1}function M4(t,e,r,i){for(;e*r<i&&nv(t[e]);)e+=r;return!!(e*r<i&&PW(t[e]))}function dMe(t,e,r,i){for(;e*r<i&&nv(t[e]);)e+=r;let s=" ";if(!(e*r<i))return!1;s=t[e];for(let n=0;n<xm.length;n++)if(xm[n]===s)return!0;return!1}function T4(t,e,r,i){if(i.hiLevel<t)return;if(t===1&&i.dir===Pg&&!i.hasUbatB)return e.reverse(),void As.reverse();const s=e.length;let n,o,a,l,u,h=0;for(;h<s;){if(r[h]>=t){for(n=h+1;n<s&&r[n]>=t;)n++;for(o=h,a=n-1;o<a;o++,a--)l=e[o],e[o]=e[a],e[a]=l,u=As[o],As[o]=As[a],As[a]=u;h=n}h++}}function pMe(t,e,r,i,s){const n=e[i];return{UBAT_L:()=>(s.lastArabic=!1,M),UBAT_R:()=>(s.lastArabic=!1,H),UBAT_ON:()=>w,UBAT_AN:()=>Xt,UBAT_EN:()=>s.lastArabic?Xt:_e,UBAT_AL:()=>(s.lastArabic=!0,s.hasUbatAl=!0,H),UBAT_WS:()=>w,UBAT_CS:()=>{let o,a;return i<1||i+1>=e.length||(o=r[i-1])!==_e&&o!==Xt||(a=e[i+1])!==_e&&a!==Xt?w:(s.lastArabic&&(a=Xt),a===o?a:w)},UBAT_ES:()=>(i>0?r[i-1]:Oo)===_e&&i+1<e.length&&e[i+1]===_e?_e:w,UBAT_ET:()=>{if(i>0&&r[i-1]===_e)return _e;if(s.lastArabic)return w;let o=i+1;const a=e.length;for(;o<a&&e[o]===$e;)o++;return o<a&&e[o]===_e?_e:w},UBAT_NSM:()=>{if(s.inFormat==="VLTR"){const o=e.length;let a=i+1;for(;a<o&&e[a]===O;)a++;if(a<o){const l=t[i].charCodeAt(0),u=l>=1425&&l<=2303||l===64286,h=e[a];if(u&&(h===H||h===x))return H}}return i<1||e[i-1]===Oo?w:r[i-1]},UBAT_B:()=>(s.lastArabic=!0,s.hasUbatB=!0,s.dir),UBAT_S:()=>(s.hasUbatS=!0,w),UBAT_LRE:()=>(s.lastArabic=!1,w),UBAT_RLE:()=>(s.lastArabic=!1,w),UBAT_LRO:()=>(s.lastArabic=!1,w),UBAT_RLO:()=>(s.lastArabic=!1,w),UBAT_PDF:()=>(s.lastArabic=!1,w),UBAT_BN:()=>w}[Q$e[n]]()}function fMe(t){let e,r=0,i=H_.length-1;for(;r<=i;)if(e=Math.floor((r+i)/2),t<H_[e][0])i=e-1;else{if(!(t>H_[e][0]))return H_[e][1];r=e+1}return t}function mMe(t){for(let e=0;e<x4.length;e++)if(x4[e]===t)return!0;return!1}function yMe(t){for(let e=0;e<ES.length;e++)if(t===ES[e])return U$e[e];return t}function N$(t,e){for(let r=0;r<ES.length;r++)if(t===ES[r])return e[r];return t}function nv(t){return t>=""&&t<=""}function E4(t){return t==="L"?"LTR":t==="R"?"RTL":t==="C"?"CLR":t==="D"?"CRL":""}function gMe(t,e,r,i){for(;e*r<i&&nv(t[e]);)e+=r;return e*r<i&&(t[e]=" ",!0)}function vMe(t,e){for(let r=0;r<xm.length;r++)if(t===xm[r])return e[r];return t}function _Me(t,e,r){As=[],K2=[];for(let i=0;i<r;i++)t[i]=i,e[i]=i,As[i]=i}function bMe(t){const e=new Array(t.length);for(let r=0;r<t.length;r++)e[t[r]]=r;return e}function AW(t,e,r,i){for(let s=0;s<t.length;s++)(t[s]>e||!r&&t[s]===e)&&(t[s]+=i)}let As=[],CS=[],K2=[];const wMe={dir:0,defInFormat:"LLTR",defSwap:"YN",inFormat:"LLTR",outFormat:"VLTR",swap:"YN",hiLevel:0,lastArabic:!1,hasUbatAl:!1,defOutFormat:""},SMe=5,xMe=6,sp=0,Pg=1,I4=/^[(I|V)][(L|R|C|D)][(Y|N)][(S|N)][N]$/,$Me=/[\u0591-\u06ff\ufb1d-\ufefc]/,F$=new rMe;function MMe(t){if(t==null)return["",!1];if(!F$.hasBidiChar(t))return[t,!1];let e;return e=F$.checkContextual(t)==="rtl"?"IDNNN":"ICNNN",[F$.bidiTransform(t,e,"VLYSN"),!0]}let Jm=class{constructor(){this.setIdentity()}getAngle(){return(this.rz==null||this.rz===0&&this.rzCos!==1&&this.rzSin!==0)&&(this.rz=Math.atan2(this.rzSin,this.rzCos)),this.rz}setIdentity(){this.tx=0,this.ty=0,this.tz=0,this.s=1,this.rx=0,this.ry=0,this.rz=0,this.rzCos=1,this.rzSin=0}setTranslate(e,r){this.tx=e,this.ty=r}setTranslateZ(e){this.tz=e}setRotateCS(e,r){this.rz=void 0,this.rzCos=e,this.rzSin=r}setRotate(e){this.rz=e,this.rzCos=void 0,this.rzSin=void 0}setRotateY(e){this.ry=e}setScale(e){this.s=e}setMeasure(e){this.m=e}};const pL="arial-unicode-ms",C4="woff2",P4=new Map,LW=new Set;let TMe=class{constructor(e,r){this.fontFace=e,this.promise=r}};async function EMe(t){const e=PMe(t),r=CMe(t),i=P4.get(e);if(i)return i.promise;const s=new FontFace(t.family,`url('${Ge.fontsUrl}/woff2/${r}.${C4}') format('${C4}')`,{style:t.style,weight:t.weight}),n=document.fonts;if(n.has(s)&&s.status==="loading")return s.loaded;const o=s.load().then((()=>(n.add(s),s)));return P4.set(e,new TMe(s,o)),LW.add(s),o}function kze(t){return LW.has(t)}function IMe(t){if(!t)return pL;const e=t.toLowerCase().split(" ").join("-");switch(e){case"serif":return"noto-serif";case"sans-serif":return"arial-unicode-ms";case"monospace":return"ubuntu-mono";case"fantasy":return"cabin-sketch";case"cursive":return"redressed";default:return e}}function CMe(t){const e=RW(t)+kW(t);return IMe(t.family)+(e.length>0?e:"-regular")}function PMe(t){const e=RW(t)+kW(t);return(t.family||pL)+(e.length>0?e:"-regular")}function RW(t){if(!t.weight)return"";switch(t.weight.toLowerCase()){case"bold":case"bolder":return"-bold"}return""}function kW(t){if(!t.style)return"";switch(t.style.toLowerCase()){case"italic":case"oblique":return"-italic"}return""}function AMe(t){return 32+t.length}const OW=16;function Oze(t){if(!t)return 0;let e=mL;for(const r in t)t.hasOwnProperty(r)&&(e+=fL(t[r],!1));return e}function LMe(t){if(!t)return 0;if(typeof t[0]=="number")return NW(t);if(Array.isArray(t))return RMe(t);let e=mL;for(const r in t)t.hasOwnProperty(r)&&(e+=fL(t[r]));return e}function RMe(t){const e=t.length;if(e===0||typeof t[0]=="number")return FW(t,8);let r=DW;for(let i=0;i<e;i++)r+=fL(t[i]);return r}function fL(t,e=!0){switch(typeof t){case"object":return e?LMe(t):mL;case"string":return AMe(t);case"number":return OW;case"boolean":return 4;default:return 8}}function NW(...t){return t.reduce(((e,r)=>e+(r?nz(r)?r.byteLength+kMe:Array.isArray(r)?FW(r,OW):0:0)),0)}function FW(t,e){return DW+t.length*e}const mL=32,DW=16,kMe=145,Nc=2;let PS=class Ip{constructor(e=[],r=[]){this.lengths=e??[],this.coords=r??[]}static fromJSON(e){return new Ip(e.lengths,e.coords)}static fromRect(e){const[r,i,s,n]=e,o=s-r,a=n-i;return new Ip([5],[r,i,o,0,0,a,-o,0,0,-a])}get isPoint(){return this.lengths.length===0&&this.coords.length>=2}get maxLength(){return Math.max(...this.lengths)}get size(){return this.lengths.reduce(((e,r)=>e+r))}get usedMemory(){return 64+NW(this.lengths,this.coords)}area(){let e=0,r=0;if(!this.lengths.length)return 0;for(let i=0;i<this.lengths.length;i++){const s=this.lengths[i];if(s<3)continue;let n=this.coords[Nc*r],o=this.coords[Nc*r+1];for(let a=1;a<s;a+=1){const l=this.coords[Nc*(a+r)],u=this.coords[Nc*(a+r)+1];e+=-.5*(l-n)*(u+o),n=l,o=u}r+=s}return e}forEachVertex(e){let r=0;this.lengths.length||e(this.coords[0],this.coords[1]);for(let i=0;i<this.lengths.length;i++){const s=this.lengths[i];for(let n=0;n<s;n++)e(this.coords[Nc*(n+r)],this.coords[Nc*(n+r)+1]);r+=s}}deltaDecode(){const e=this.clone(),{coords:r,lengths:i}=e;let s=0;for(const n of i){for(let o=1;o<n;o++)r[2*(s+o)]+=r[2*(s+o)-2],r[2*(s+o)+1]+=r[2*(s+o)-1];s+=n}return e}clone(e){if(this.lengths.length===0)return new Ip([],[this.coords[0],this.coords[1]]);const r=(this.lengths.length===0?1:this.lengths.reduce(((s,n)=>s+n)))*Nc,i=this.coords.slice(0,r);return e?(e.set(i),new Ip(this.lengths,e)):new Ip(Array.from(this.lengths),Array.from(i))}},rt=class{static fromOptimized(e,r,i=!1,s=!1,n=1){return new RC().initialize(e,r,i,s,n)}static fromJSON(e,r=!1,i=!1){const[s,n]=A4(e);return new OC().initialize(s,n,r,i,1)}static fromOptimizedCIM(e,r,i=!1,s=!1,n=1){return new L4().initialize(e,r,i,s,n)}static fromJSONCIM(e,r=!1,i=!1,s=1){const[n,o]=A4(e);return new R4().initialize(n,o,r,i,s)}static fromFeatureSetReader(e){const r=e.readGeometryForDisplay(),i=e.geometryType;return r&&i?this.fromOptimized(r,i):null}static fromFeatureSetReaderCIM(e){const r=e.readGeometryForDisplay(),i=e.geometryType;return r&&i?this.fromOptimizedCIM(r,i):null}static createEmptyOptimized(e,r=!1,i=!1,s=1){return new RC().initialize(new PS,e,r,i,s)}static createEmptyJSON(e,r=!1,i=!1){return new OC().initialize([],e,r,i,1)}static createEmptyOptimizedCIM(e,r=!1,i=!1,s=1){return new L4().initialize(new PS,e,r,i,s)}static createEmptyJSONCIM(e,r=!1,i=!1,s=1){return new R4().initialize([],e,r,i,s)}asJSON(){const e=c2(this);return this.geometryType==="esriGeometryEnvelope"?{xmin:e[0][0][0],ymin:e[0][0][1],xmax:e[0][2][0],ymax:e[0][2][1]}:this.geometryType==="esriGeometryMultipoint"?{points:e.flat()}:this.geometryType==="esriGeometryPoint"?{x:e[0][0][0],y:e[0][0][1]}:this.geometryType==="esriGeometryPolygon"?{rings:e}:{paths:e}}getCurrentRingArea(){if(this.pathSize<3)return 0;let e,r,i=0;if(this.seekPathStart(),!this.nextPoint())return 0;e=this.x,r=this.y;const s=e,n=r;for(;this.nextPoint();)i+=(e-this.x)*(r+this.y),e=this.x,r=this.y;return i+=(e-s)*(r+n),-.5*i}invertY(){this.yFactor*=-1}},RC=class kC extends rt{constructor(){super(...arguments),this._end=-1}initialize(e,r,i,s,n){return this.hasZ=i,this.hasM=s,this.geometryType=r,this._stride=2+Number(i)+Number(s),this._geometry=e,this._pathIndex=-1,this._pathOffset=0,this._pointOffset=-this._stride,this._end=-1,this.yFactor=n,this}reset(){this.initialize(this._geometry,this.geometryType,this.hasZ,this.hasM,this.yFactor)}seekPath(e){if(e>=0&&e<this.totalSize){if(this._pathIndex<e)for(;this._pathIndex<e&&this.nextPath(););else if(this._pathIndex>e)for(;this._pathIndex>e&&this.prevPath(););return!0}return!1}seekPathStart(){this._pointOffset=this._pathOffset-this._stride}seekPathEnd(){this._pointOffset=this._end}seekInPath(e){const r=this._pathOffset+e*this._stride;return r>=0&&r<this._end&&(this._pointOffset=r,!0)}nextPoint(){return(this._pointOffset+=this._stride)<this._end}prevPoint(){return(this._pointOffset-=this._stride)>=this._pathOffset}nextPath(){return!(this.pathIndex>=this.totalSize-1)&&(this._pathIndex>=0&&(this._pathOffset+=this._stride*this.pathSize),this._pathIndex++,this._pointOffset=this._pathOffset-this._stride,this._end=this._pointOffset+this._stride+this._stride*this.pathSize,!0)}prevPath(){return!(this.pathIndex<=0)&&(this._pathIndex--,this._end=this._pathOffset,this._pathOffset-=this._stride*this.pathSize,this._pointOffset=this._pathOffset-this._stride,!0)}getCurrentPath(){const e=this._end,r=this._geometry.coords,i=this._pathOffset;return new kC().initialize(new PS([this.pathSize],r.slice(i,e)),this.geometryType,this.hasZ,this.hasM,this.yFactor)}pathLength(){const e=this._end,r=this._stride,i=this._geometry.coords;let s=0;for(let n=this._pathOffset+r;n<e;n+=r){const o=i[n-r],a=i[n-r+1],l=i[n]-o,u=i[n+1]-a;s+=Math.sqrt(l*l+u*u)}return s}startPath(){this._geometry.lengths.push(0)}pushPath(e){this.startPath(),this.pushPoints(e)}pushPoint(e){for(let r=0;r<this._stride;++r)this._geometry.coords.push(e[r]);this._geometry.lengths[this.totalSize-1]++}pushXY(e,r){this._geometry.coords.push(e,r),this._geometry.lengths[this.totalSize-1]++}pushPoints(e){for(const r of e)for(let i=0;i<this._stride;++i)this._geometry.coords.push(r[i]);this._geometry.lengths[this.totalSize-1]+=e.length}pushCursor(e){const r=e.asOptimized();this._geometry.coords.push(...r.coords),this._geometry.lengths.push(...r.lengths)}asOptimized(){const e=this._geometry.clone();if(this.yFactor!==1)for(let r=1;r<e.coords.length;r+=this._stride)e.coords[r]*=this.yFactor;return this.geometryType==="esriGeometryPoint"&&(e.lengths.length=0),e}isClosed(){const e=this._geometry.coords,r=this._pathOffset,i=this._end-this._stride;for(let s=0;s<this._stride;s++)if(e[r+s]!==e[i+s])return!1;return!0}clone(){return new kC().initialize(this._geometry.clone(),this.geometryType,this.hasZ,this.hasM,this.yFactor)}get totalPoints(){return this._geometry.isPoint?1:this._geometry.lengths.reduce(((e,r)=>e+r))}get pathSize(){const{lengths:e}=this._geometry;return this._geometry.isPoint?1:this._pathIndex<0||this._pathIndex>e.length-1?0:e[this._pathIndex]}get totalSize(){return this._geometry.isPoint?1:this._geometry.lengths.length}get x(){return this._geometry.coords[this._pointOffset]}set x(e){this._geometry.coords[this._pointOffset]=e}get y(){return this.yFactor*this._geometry.coords[this._pointOffset+1]}set y(e){this._geometry.coords[this._pointOffset+1]=this.yFactor*e}get z(){return this._geometry.coords[this._pointOffset+2]}set z(e){this._geometry.coords[this._pointOffset+2]=e}get m(){const e=this.hasZ?3:2;return this._geometry.coords[this._pointOffset+e]}set m(e){this._geometry.coords[this._pointOffset+3]=e}get pathIndex(){return this._pathIndex}get _coordIndex(){return this._pointOffset/this._stride}};function OMe(t){const e=[t.x,t.y];return t.z&&e.push(t.z),t.m&&e.push(t.m),e}function A4(t){return rr(t)?[t.rings,"esriGeometryPolygon"]:ri(t)?[t.paths,"esriGeometryPolyline"]:Mf(t)?[[t.points],"esriGeometryMultipoint"]:Ni(t)?[[[[t.xmin,t.ymin],[t.xmin,t.ymax],[t.xmax,t.ymax],[t.xmax,t.ymin],[t.xmin,t.ymin]]],"esriGeometryEnvelope"]:N0(t)?[[[OMe(t)]],"esriGeometryPoint"]:[[],"esriGeometryPolyline"]}let OC=class NC extends rt{initialize(e,r,i,s,n){return this._paths=e,this.geometryType=r,this.hasZ=i,this.hasM=s,this._pathIndex=this._pointIndex=-1,this.yFactor=n,this._mIndex=this.hasZ?3:2,this}reset(){this._pathIndex=this._pointIndex=-1}seekPath(e){return this._pathIndex=e,this._pointIndex=-1,e>=0&&e<this.totalSize&&(this._currentPath=this._paths[e],!0)}seekPathStart(){this._pointIndex=-1}seekPathEnd(){this._pointIndex=this._currentPath.length}seekInPath(e){return e>=0&&e<this._currentPath.length&&(this._pointIndex=e,this._currentPoint=this._currentPath[this._pointIndex],!0)}nextPoint(){return this._currentPoint=this._currentPath[++this._pointIndex],this._pointIndex<this._currentPath.length}prevPoint(){return this._currentPoint=this._currentPath[--this._pointIndex],this._pointIndex>=0}nextPath(){return this._pointIndex=-1,this._currentPath=this._paths[++this._pathIndex],this._pathIndex<this.totalSize}prevPath(){return this.pathIndex>0&&(this._pointIndex=-1,this._pathIndex--,this._currentPath=this._paths[this._pathIndex],!0)}pathLength(){const e=this._currentPath.length,r=this._currentPath;let i=0;for(let s=1;s<e;s++){const n=r[s-1],o=r[s],a=n[0],l=n[1],u=o[0]-a,h=o[1]-l;i+=Math.sqrt(u*u+h*h)}return i}startPath(){this._paths.push([])}getCurrentPath(){return new NC().initialize([this._currentPath],this.geometryType,this.hasZ,this.hasM,this.yFactor)}pushPath(e){this._paths.push(e)}pushPoint(e){this._paths[this.totalSize-1].push(e)}pushXY(e,r){this._paths[this.totalSize-1].push([e,r])}pushPoints(e){this._paths[this.totalSize-1].push(...e)}pushCursor(e){const r=c2(e);for(const i of r)this.pushPath(i)}asOptimized(){const e=new PS;if(this.geometryType==="esriGeometryPoint")e.coords.push(...this._paths[0][0]),e.lengths.length=0;else for(const r of this._paths){for(const i of r)e.coords.push(i[0]),e.coords.push(i[1]*this.yFactor),this.hasZ&&e.coords.push(i[2]),this.hasM&&e.coords.push(i[this._mIndex]);e.lengths.push(r.length)}return e}isClosed(){const e=this._currentPath[0],r=this._currentPath[this._currentPath.length-1];for(let i=0;i<e.length;i++)if(e[i]!==r[i])return!1;return!0}clone(){return new NC().initialize(k(this._paths),this.geometryType,this.hasZ,this.hasM,this.yFactor)}get totalPoints(){return this._paths.map((e=>e.length)).reduce(((e,r)=>e+r))}get pathSize(){return this._pathIndex<0||this._pathIndex>this.totalSize-1?-1:this._paths[this._pathIndex].length}get totalSize(){return this._paths.length}get x(){return this._currentPoint[0]}set x(e){this._currentPoint[0]=e}get y(){return this.yFactor*this._currentPoint[1]}set y(e){this._currentPoint[1]=this.yFactor*e}get z(){return this._currentPoint[2]}set z(e){this._currentPoint[2]=e}get m(){return this._currentPoint[this._mIndex]}set m(e){this._currentPoint[this._mIndex]=e}get pathIndex(){return this._pathIndex}};const W_=4,Z_=1;let L4=class zW extends RC{initialize(e,r,i,s,n){return super.initialize(e,r,i,s,n),this._controlPoints||(this._controlPoints=this._controlPoints=new Array(this.totalSize).fill(void 0).map((o=>new Set))),this}startPath(){super.startPath(),this._controlPoints.push(new Set)}clone(){const e=new zW().initialize(this._geometry.clone(),this.geometryType,this.hasZ,this.hasM,this.yFactor);return e._controlPoints=this._controlPoints,e}setControlPoint(){this._controlPoints[this.pathIndex].add(this._coordIndex)}getControlPoint(){return this._controlPoints[this.pathIndex].has(this._coordIndex)}setControlPointAt(e){this._controlPoints[this.pathIndex].add(e)}getControlPointAt(e){return this._controlPoints[this.pathIndex].has(e)}},R4=class VW extends OC{initialize(e,r,i,s,n){return super.initialize(e,r,i,s,n)}clone(){return new VW().initialize(k(this._paths),this.geometryType,this.hasZ,this.hasM,this.yFactor)}setControlPoint(){this._paths[this.pathIndex][this._pointIndex][W_]=Z_}getControlPoint(){return this._paths[this.pathIndex][this._pointIndex][W_]===Z_}setControlPointAt(e){this._paths[this.pathIndex][e][W_]=Z_}getControlPointAt(e){return this._paths[this.pathIndex][e][W_]===Z_}};const NMe=512;var Yn,Fr;(function(t){t[t.Unknown=0]="Unknown",t[t.Point=1]="Point",t[t.LineString=2]="LineString",t[t.Polygon=3]="Polygon"})(Yn||(Yn={}));let Ne=class Ag{constructor(e,r){this.x=e,this.y=r}static fromArray(e){return new Ag(e[0],e[1])}clone(){return new Ag(this.x,this.y)}equals(e,r){return e===this.x&&r===this.y}isEqual(e){return e.x===this.x&&e.y===this.y}setCoords(e,r){return this.x=e,this.y=r,this}normalize(){const e=this.x,r=this.y,i=Math.sqrt(e*e+r*r);return this.x/=i,this.y/=i,this}rightPerpendicular(){const e=this.x;return this.x=this.y,this.y=-e,this}leftPerpendicular(){const e=this.x;return this.x=-this.y,this.y=e,this}move(e,r){return this.x+=e,this.y+=r,this}assign(e){return this.x=e.x,this.y=e.y,this}assignAdd(e,r){return this.x=e.x+r.x,this.y=e.y+r.y,this}assignSub(e,r){return this.x=e.x-r.x,this.y=e.y-r.y,this}rotate(e,r){const i=this.x,s=this.y;return this.x=i*e-s*r,this.y=i*r+s*e,this}rotateReverse(e,r){const i=this.x,s=this.y;return this.x=i*e+s*r,this.y=-i*r+s*e,this}scale(e){return this.x*=e,this.y*=e,this}length(){const e=this.x,r=this.y;return Math.sqrt(e*e+r*r)}sub(e){return this.x-=e.x,this.y-=e.y,this}add(e){return this.x+=e.x,this.y+=e.y,this}static distance(e,r){const i=r.x-e.x,s=r.y-e.y;return Math.sqrt(i*i+s*s)}static add(e,r){return new Ag(e.x+r.x,e.y+r.y)}static sub(e,r){return new Ag(e.x-r.x,e.y-r.y)}},J_=class{constructor(e,r,i){this.ratio=e,this.x=r,this.y=i}},FMe=class{constructor(e,r,i,s=8,n=8){this._lines=[],this._starts=[],this.validateTessellation=!0,this._pixelRatio=s,this._pixelMargin=n,this._tileSize=NMe*s,this._dz=e,this._yPos=r,this._xPos=i}setPixelMargin(e){e!==this._pixelMargin&&(this._pixelMargin=e,this.setExtent(this._extent))}setExtent(e){this._extent=e,this._finalRatio=this._tileSize/e*(1<<this._dz);let r=this._pixelRatio*this._pixelMargin;r/=this._finalRatio;const i=e>>this._dz;r>i&&(r=i),this._margin=r,this._xmin=i*this._xPos-r,this._ymin=i*this._yPos-r,this._xmax=this._xmin+i+2*r,this._ymax=this._ymin+i+2*r}reset(e){this._type=e,this._lines=[],this._starts=[],this._line=null,this._start=0}moveTo(e,r){this._pushLine(),this._prevIsIn=this._isIn(e,r),this._moveTo(e,r,this._prevIsIn),this._prevPt=new Ne(e,r),this._firstPt=new Ne(e,r),this._dist=0}lineTo(e,r){const i=this._isIn(e,r),s=new Ne(e,r),n=Ne.distance(this._prevPt,s);let o,a,l,u,h,p,m,y;if(i)this._prevIsIn?this._lineTo(e,r,!0):(o=this._prevPt,a=s,l=this._intersect(a,o),this._start=this._dist+n*(1-this._r),this._lineTo(l.x,l.y,!0),this._lineTo(a.x,a.y,!0));else if(this._prevIsIn)a=this._prevPt,o=s,l=this._intersect(a,o),this._lineTo(l.x,l.y,!0),this._lineTo(o.x,o.y,!1);else{const g=this._prevPt,v=s;if(g.x<=this._xmin&&v.x<=this._xmin||g.x>=this._xmax&&v.x>=this._xmax||g.y<=this._ymin&&v.y<=this._ymin||g.y>=this._ymax&&v.y>=this._ymax)this._lineTo(v.x,v.y,!1);else{const _=[];if((g.x<this._xmin&&v.x>this._xmin||g.x>this._xmin&&v.x<this._xmin)&&(u=(this._xmin-g.x)/(v.x-g.x),y=g.y+u*(v.y-g.y),y<=this._ymin?p=!1:y>=this._ymax?p=!0:_.push(new J_(u,this._xmin,y))),(g.x<this._xmax&&v.x>this._xmax||g.x>this._xmax&&v.x<this._xmax)&&(u=(this._xmax-g.x)/(v.x-g.x),y=g.y+u*(v.y-g.y),y<=this._ymin?p=!1:y>=this._ymax?p=!0:_.push(new J_(u,this._xmax,y))),(g.y<this._ymin&&v.y>this._ymin||g.y>this._ymin&&v.y<this._ymin)&&(u=(this._ymin-g.y)/(v.y-g.y),m=g.x+u*(v.x-g.x),m<=this._xmin?h=!1:m>=this._xmax?h=!0:_.push(new J_(u,m,this._ymin))),(g.y<this._ymax&&v.y>this._ymax||g.y>this._ymax&&v.y<this._ymax)&&(u=(this._ymax-g.y)/(v.y-g.y),m=g.x+u*(v.x-g.x),m<=this._xmin?h=!1:m>=this._xmax?h=!0:_.push(new J_(u,m,this._ymax))),_.length===0)h?p?this._lineTo(this._xmax,this._ymax,!0):this._lineTo(this._xmax,this._ymin,!0):p?this._lineTo(this._xmin,this._ymax,!0):this._lineTo(this._xmin,this._ymin,!0);else if(_.length>1&&_[0].ratio>_[1].ratio)this._start=this._dist+n*_[1].ratio,this._lineTo(_[1].x,_[1].y,!0),this._lineTo(_[0].x,_[0].y,!0);else{this._start=this._dist+n*_[0].ratio;for(let b=0;b<_.length;b++)this._lineTo(_[b].x,_[b].y,!0)}this._lineTo(v.x,v.y,!1)}}this._dist+=n,this._prevIsIn=i,this._prevPt=s}close(){if(this._line.length>2){const e=this._firstPt,r=this._prevPt;e.x===r.x&&e.y===r.y||this.lineTo(e.x,e.y);const i=this._line;let s=i.length;for(;s>=4&&(i[0].x===i[1].x&&i[0].x===i[s-2].x||i[0].y===i[1].y&&i[0].y===i[s-2].y);)i.pop(),i[0].x=i[s-2].x,i[0].y=i[s-2].y,--s}}result(e=!0){return this._pushLine(),this._lines.length===0?null:(this._type===Yn.Polygon&&e&&DMe.simplify(this._tileSize,this._margin*this._finalRatio,this._lines),this._lines)}resultWithStarts(){if(this._type!==Yn.LineString)throw new Error("Only valid for lines");this._pushLine();const e=this._lines,r=e.length;if(r===0)return null;const i=[];for(let s=0;s<r;s++)i.push({line:e[s],start:this._starts[s]||0});return i}_isIn(e,r){return e>=this._xmin&&e<=this._xmax&&r>=this._ymin&&r<=this._ymax}_intersect(e,r){let i,s,n;if(r.x>=this._xmin&&r.x<=this._xmax)s=r.y<=this._ymin?this._ymin:this._ymax,n=(s-e.y)/(r.y-e.y),i=e.x+n*(r.x-e.x);else if(r.y>=this._ymin&&r.y<=this._ymax)i=r.x<=this._xmin?this._xmin:this._xmax,n=(i-e.x)/(r.x-e.x),s=e.y+n*(r.y-e.y);else{s=r.y<=this._ymin?this._ymin:this._ymax,i=r.x<=this._xmin?this._xmin:this._xmax;const o=(i-e.x)/(r.x-e.x),a=(s-e.y)/(r.y-e.y);o<a?(n=o,s=e.y+o*(r.y-e.y)):(n=a,i=e.x+a*(r.x-e.x))}return this._r=n,new Ne(i,s)}_pushLine(){this._line&&(this._type===Yn.Point?this._line.length>0&&(this._lines.push(this._line),this._starts.push(this._start)):this._type===Yn.LineString?this._line.length>1&&(this._lines.push(this._line),this._starts.push(this._start)):this._type===Yn.Polygon&&this._line.length>3&&(this._lines.push(this._line),this._starts.push(this._start))),this._line=[],this._start=0}_moveTo(e,r,i){this._type!==Yn.Polygon?i&&(e=Math.round((e-(this._xmin+this._margin))*this._finalRatio),r=Math.round((r-(this._ymin+this._margin))*this._finalRatio),this._line.push(new Ne(e,r))):(i||(e<this._xmin&&(e=this._xmin),e>this._xmax&&(e=this._xmax),r<this._ymin&&(r=this._ymin),r>this._ymax&&(r=this._ymax)),e=Math.round((e-(this._xmin+this._margin))*this._finalRatio),r=Math.round((r-(this._ymin+this._margin))*this._finalRatio),this._line.push(new Ne(e,r)),this._isH=!1,this._isV=!1)}_lineTo(e,r,i){let s,n;if(this._type!==Yn.Polygon)if(i){if(e=Math.round((e-(this._xmin+this._margin))*this._finalRatio),r=Math.round((r-(this._ymin+this._margin))*this._finalRatio),this._line.length>0&&(s=this._line[this._line.length-1],s.equals(e,r)))return;this._line.push(new Ne(e,r))}else this._line&&this._line.length>0&&this._pushLine();else if(i||(e<this._xmin&&(e=this._xmin),e>this._xmax&&(e=this._xmax),r<this._ymin&&(r=this._ymin),r>this._ymax&&(r=this._ymax)),e=Math.round((e-(this._xmin+this._margin))*this._finalRatio),r=Math.round((r-(this._ymin+this._margin))*this._finalRatio),this._line&&this._line.length>0){s=this._line[this._line.length-1];const o=s.x===e,a=s.y===r;if(o&&a)return;this._isH&&o||this._isV&&a?(s.x=e,s.y=r,n=this._line[this._line.length-2],n.x===e&&n.y===r?(this._line.pop(),this._line.length<=1?(this._isH=!1,this._isV=!1):(n=this._line[this._line.length-2],this._isH=n.x===e,this._isV=n.y===r)):(this._isH=n.x===e,this._isV=n.y===r)):(this._line.push(new Ne(e,r)),this._isH=o,this._isV=a)}else this._line.push(new Ne(e,r))}},zze=class{setExtent(e){this._ratio=e===4096?1:4096/e}get validateTessellation(){return this._ratio<1}reset(e){this._lines=[],this._line=null}moveTo(e,r){this._line&&this._lines.push(this._line),this._line=[];const i=this._ratio;this._line.push(new Ne(e*i,r*i))}lineTo(e,r){const i=this._ratio;this._line.push(new Ne(e*i,r*i))}close(){const e=this._line;e&&!e[0].isEqual(e[e.length-1])&&e.push(e[0])}result(){return this._line&&this._lines.push(this._line),this._lines.length===0?null:this._lines}};(function(t){t[t.sideLeft=0]="sideLeft",t[t.sideRight=1]="sideRight",t[t.sideTop=2]="sideTop",t[t.sideBottom=3]="sideBottom"})(Fr||(Fr={}));let DMe=class xu{static simplify(e,r,i){if(!i)return;const s=-r,n=e+r,o=-r,a=e+r,l=[],u=[],h=i.length;for(let m=0;m<h;++m){const y=i[m];if(!y||y.length<2)continue;let g,v=y[0];const _=y.length;for(let b=1;b<_;++b)g=y[b],v.x===g.x&&(v.x<=s&&(v.y>g.y?(l.push(m),l.push(b),l.push(Fr.sideLeft),l.push(-1)):(u.push(m),u.push(b),u.push(Fr.sideLeft),u.push(-1))),v.x>=n&&(v.y<g.y?(l.push(m),l.push(b),l.push(Fr.sideRight),l.push(-1)):(u.push(m),u.push(b),u.push(Fr.sideRight),u.push(-1)))),v.y===g.y&&(v.y<=o&&(v.x<g.x?(l.push(m),l.push(b),l.push(Fr.sideTop),l.push(-1)):(u.push(m),u.push(b),u.push(Fr.sideTop),u.push(-1))),v.y>=a&&(v.x>g.x?(l.push(m),l.push(b),l.push(Fr.sideBottom),l.push(-1)):(u.push(m),u.push(b),u.push(Fr.sideBottom),u.push(-1)))),v=g}if(l.length===0||u.length===0)return;xu.fillParent(i,u,l),xu.fillParent(i,l,u);const p=[];xu.calcDeltas(p,u,l),xu.calcDeltas(p,l,u),xu.addDeltas(p,i)}static fillParent(e,r,i){const s=i.length,n=r.length;for(let o=0;o<n;o+=4){const a=r[o],l=r[o+1],u=r[o+2],h=e[a][l-1],p=e[a][l];let m=8092,y=-1;for(let g=0;g<s;g+=4){if(i[g+2]!==u)continue;const v=i[g],_=i[g+1],b=e[v][_-1],S=e[v][_];switch(u){case Fr.sideLeft:case Fr.sideRight:if(Y_(h.y,b.y,S.y)&&Y_(p.y,b.y,S.y)){const $=Math.abs(S.y-b.y);$<m&&(m=$,y=g)}break;case Fr.sideTop:case Fr.sideBottom:if(Y_(h.x,b.x,S.x)&&Y_(p.x,b.x,S.x)){const $=Math.abs(S.x-b.x);$<m&&(m=$,y=g)}}}r[o+3]=y}}static calcDeltas(e,r,i){const s=r.length;for(let n=0;n<s;n+=4){const o=[],a=xu.calcDelta(n,r,i,o);e.push(r[n]),e.push(r[n+1]),e.push(r[n+2]),e.push(a)}}static calcDelta(e,r,i,s){const n=r[e+3];if(n===-1)return 0;const o=s.length;return o>1&&s[o-2]===n?0:(s.push(n),xu.calcDelta(n,i,r,s)+1)}static addDeltas(e,r){const i=e.length;let s=0;for(let n=0;n<i;n+=4){const o=e[n+3];o>s&&(s=o)}for(let n=0;n<i;n+=4){const o=r[e[n]],a=e[n+1],l=s-e[n+3];switch(e[n+2]){case Fr.sideLeft:o[a-1].x-=l,o[a].x-=l,a===1&&(o[o.length-1].x-=l),a===o.length-1&&(o[0].x-=l);break;case Fr.sideRight:o[a-1].x+=l,o[a].x+=l,a===1&&(o[o.length-1].x+=l),a===o.length-1&&(o[0].x+=l);break;case Fr.sideTop:o[a-1].y-=l,o[a].y-=l,a===1&&(o[o.length-1].y-=l),a===o.length-1&&(o[0].y-=l);break;case Fr.sideBottom:o[a-1].y+=l,o[a].y+=l,a===1&&(o[o.length-1].y+=l),a===o.length-1&&(o[0].y+=l)}}}};const Y_=(t,e,r)=>t>=e&&t<=r||t>=r&&t<=e,zMe=512;let Va,VMe=class{constructor(e){this._geometry=e}next(){const e=this._geometry;return this._geometry=null,e}};function yL(t,e,r){if(!t)return null;Va||(Va=new FMe(0,0,0,1));const i=r?-1:1,s=t.geometryType==="esriGeometryPolygon",n=s?Yn.Polygon:Yn.LineString,o=s?3:2;let a,l;for(Va.reset(n),Va.setPixelMargin(e+1),Va.setExtent(zMe);t.nextPath();)if(!(t.pathSize<o)){for(t.nextPoint(),a=t.x,l=i*t.y,Va.moveTo(a,l);t.nextPoint();)a=t.x,l=i*t.y,Va.lineTo(a,l);s&&Va.close()}const u=Va.result(!1);if(u){const h=rt.createEmptyOptimizedCIM(t.geometryType);for(const p of u){h.startPath();for(const m of p)h.pushXY(m.x,i*m.y)}return h.reset(),h}return null}let jMe=class{applyColorSubstitution(e,r){if(!r)return e;this._rasterizationCanvas||(this._rasterizationCanvas=document.createElement("canvas"));const{width:i,height:s}=e,n=this._rasterizationCanvas,o=n.getContext("2d",{willReadFrequently:!0});e!==n&&(n.width=i,n.height=s,o.drawImage(e,0,0,i,s));const a=o.getImageData(0,0,i,s).data;if(r){for(const u of r)if(u&&u.oldColor&&u.oldColor.length===4&&u.newColor&&u.newColor.length===4){const[h,p,m,y]=u.oldColor,[g,v,_,b]=u.newColor;if(h===g&&p===v&&m===_&&y===b)continue;for(let S=0;S<a.length;S+=4)h===a[S]&&p===a[S+1]&&m===a[S+2]&&y===a[S+3]&&(a[S]=g,a[S+1]=v,a[S+2]=_,a[S+3]=b)}}const l=new ImageData(a,i,s);return o.putImageData(l,0,0),n}tintImageData(e,r){if(!r||r.length<4)return e;this._rasterizationCanvas||(this._rasterizationCanvas=document.createElement("canvas"));const{width:i,height:s}=e,n=this._rasterizationCanvas,o=n.getContext("2d",{willReadFrequently:!0});e!==n&&(n.width=i,n.height=s,o.drawImage(e,0,0,i,s));const a=o.getImageData(0,0,i,s),l=new Uint8Array(a.data),u=[r[0]/255,r[1]/255,r[2]/255,r[3]/255];for(let p=0;p<l.length;p+=4)l[p]*=u[0],l[p+1]*=u[1],l[p+2]*=u[2],l[p+3]*=u[3];const h=new ImageData(new Uint8ClampedArray(l.buffer),i,s);return o.putImageData(h,0,0),n}};var qo;let UMe=(qo=class{static local(){return qo.instance===null&&(qo.instance=new qo),qo.instance}execute(e,r,i,s){return new GMe(e,r)}},qo.instance=null,qo),GMe=class{constructor(e,r){this._inputGeometries=e,this._angleTolerance=r.angleTolerance!==void 0?r.angleTolerance:120,this._maxCosAngle=Math.cos((1-Math.abs(this._angleTolerance)/180)*Math.PI)}next(){let e=this._inputGeometries.next();if(!e)return null;for(;e;){if(e.geometryType==="esriGeometryPolygon")this._isClosed=!0;else if(e.geometryType==="esriGeometryPolyline")this._isClosed=!1;else{if(e.geometryType!=="esriGeometryEnvelope"){e=this._inputGeometries.next();continue}if(this._maxCosAngle)return e;this._isClosed=!0}for(;e.nextPath();)this._processPath(e);return e.reset(),e}return null}_processPath(e){if(e.nextPoint()){const r=e.x,i=e.y;let s=r,n=i,o=e.pathSize,a=0,l=0,u=0,h=0,p=0,m=0;this._isClosed&&++o;for(let y=1;e.nextPoint()||y<o;++y){let g,v;this._isClosed&&y===o-1?(g=r,v=i):(g=e.x,v=e.y);const _=g-s,b=v-n,S=Math.sqrt(_*_+b*b);y>1&&S>0&&u>0&&(a*_+l*b)/S/u<=this._maxCosAngle&&e.setControlPointAt(y-1),y===1&&(h=_,p=b,m=S),S>0&&(s=g,n=v,a=_,l=b,u=S)}this._isClosed&&u>0&&m>0&&(a*h+l*p)/m/u<=this._maxCosAngle&&e.setControlPointAt(0)}}};function Py(t,e){t[4]=e}let Zv=class{constructor(e,r=!0,i=!0,s=0){this.isClosed=!1,this.geometryCursor=null,this.geometryCursor=!r&&e.geometryType==="esriGeometryPolygon"||!i&&e.geometryType==="esriGeometryPolyline"?null:e,this.geomUnitsPerPoint=s,this.iterateMultiPath=!1,this.iteratePath=!1,this.internalPlacement=new Jm}next(){if(!this.geometryCursor)return null;const e=this.processMultiPath(this.geometryCursor);return this.iterateMultiPath&&e||(this.geometryCursor=null),e}processMultiPath(e){for(;this.iteratePath||e.pathIndex<e.totalSize-1;){this.iteratePath||e.nextPath(),this.iterateMultiPath=!0;const r=this.processPath(e);if(r)return r}return this.iterateMultiPath=!1,null}},Ym=class{constructor(e,r,i,s=0){this.isClosed=!1,this.inputGeometries=e,this.acceptPolygon=r,this.acceptPolyline=i,this.geomUnitsPerPoint=s,this.iteratePath=!1,this.multiPathCursor=null}next(){for(;;){if(!this.multiPathCursor){let e=this.inputGeometries.next();for(;e&&(this.isClosed=this.acceptPolygon&&e.geometryType==="esriGeometryPolygon"||e.geometryType==="esriGeometryEnvelope",this.multiPathCursor=e,!this.multiPathCursor);)e=this.inputGeometries.next();if(!this.multiPathCursor)return null}for(;this.iteratePath||this.multiPathCursor.nextPath();){this.multiPathCursor.seekPathStart();const e=this.processPath(this.multiPathCursor);if(e)return e}this.multiPathCursor=null}}};const ov=.03;let Hl=class{constructor(e=0,r=!1){}isEmpty(e){if(!e.nextPoint())return!0;let r,i,s,n;for(r=e.x,i=e.y;e.nextPoint();r=i,i=n)if(s=e.x,n=e.y,s!==r||n!==i)return e.seekPathStart(),!1;return e.seekPathStart(),!0}normalize(e){const r=Math.sqrt(e[0]*e[0]+e[1]*e[1]);r!==0&&(e[0]/=r,e[1]/=r)}getLength(e,r,i,s){const n=i-e,o=s-r;return Math.sqrt(n*n+o*o)}getSegLength(e){const[[r,i],[s,n]]=e;return this.getLength(r,i,s,n)}getCoord2D(e,r,i,s,n){return[e+(i-e)*n,r+(s-r)*n]}getSegCoord2D(e,r){const[[i,s],[n,o]]=e;return this.getCoord2D(i,s,n,o,r)}getAngle(e,r,i,s,n){const o=i-e,a=s-r;return Math.atan2(a,o)}getAngleCS(e,r,i,s,n,o){e==null&&(e=[0,0]);const a=s-r,l=n-i,u=Math.sqrt(a*a+l*l);return u!==0?(e[0]=a/u,e[1]=l/u,e):(e[0]=1,e[1]=0,e)}getSegAngleCS(e,r,i){const[[s,n],[o,a]]=r;return this.getAngleCS(e,s,n,o,a,i)}cut(e,r,i,s,n,o){return[n<=0?[e,r]:this.getCoord2D(e,r,i,s,n),o>=1?[i,s]:this.getCoord2D(e,r,i,s,o)]}getSubCurve(e,r,i){const s=rt.createEmptyOptimizedCIM("esriGeometryPolyline");return this.appendSubCurve(s,e,r,i)?s:null}appendSubCurve(e,r,i,s){e.startPath(),r.seekPathStart();let n=0,o=!0;if(!r.nextPoint())return!1;let a=r.x,l=r.y;for(;r.nextPoint();){const u=this.getLength(a,l,r.x,r.y);if(u!==0){if(o){if(n+u>i){const h=(i-n)/u;let p=1,m=!1;n+u>=s&&(p=(s-n)/u,m=!0);const y=this.cut(a,l,r.x,r.y,h,p);if(y&&e.pushPoints(y),m)break;o=!1}}else{if(n+u>s){const h=this.cut(a,l,r.x,r.y,0,(s-n)/u);h&&e.pushPoint(h[1]);break}e.pushXY(r.x,r.y)}n+=u,a=r.x,l=r.y}else a=r.x,l=r.y}return!0}getCIMPointAlong(e,r){if(!e.nextPoint())return null;let i,s,n,o,a=0;for(i=e.x,s=e.y;e.nextPoint();i=n,s=o){n=e.x,o=e.y;const l=this.getLength(i,s,n,o);if(l!==0){if(a+l>r){const u=(r-a)/l;return this.getCoord2D(i,s,n,o,u)}a+=l}}return null}offset(e,r,i,s,n){if(!e||e.length<2)return null;let o=0,a=e[o++],l=o;for(;o<e.length;){const m=e[o];m[0]===a[0]&&m[1]===a[1]||(o!==l&&(e[l]=e[o]),a=e[l++]),o++}const u=e[0][0]===e[l-1][0]&&e[0][1]===e[l-1][1];if(u&&--l,l<(u?3:2))return null;const h=[];a=u?e[l-1]:null;let p=e[0];for(let m=0;m<l;m++){const y=m===l-1?u?e[0]:null:e[m+1];if(a)if(y){const g=[y[0]-p[0],y[1]-p[1]];this.normalize(g);const v=[p[0]-a[0],p[1]-a[1]];this.normalize(v);const _=v[0]*g[1]-v[1]*g[0],b=v[0]*g[0]+v[1]*g[1];if(_===0&&b===1){p=y;continue}if(_>=0==r<=0){if(b<1){const S=[g[0]-v[0],g[1]-v[1]];this.normalize(S);const $=Math.sqrt((1+b)/2);if($>1/s){const T=-Math.abs(r)/$;h.push([p[0]-S[0]*T,p[1]-S[1]*T])}}}else switch(i){case Cl.Mitered:{const S=Math.sqrt((1+b)/2);if(S>0&&1/S<s){const $=[g[0]-v[0],g[1]-v[1]];this.normalize($);const T=Math.abs(r)/S;h.push([p[0]-$[0]*T,p[1]-$[1]*T]);break}}case Cl.Bevelled:h.push([p[0]+v[1]*r,p[1]-v[0]*r]),h.push([p[0]+g[1]*r,p[1]-g[0]*r]);break;case Cl.Rounded:if(b<1){h.push([p[0]+v[1]*r,p[1]-v[0]*r]);const S=Math.floor(2.5*(1-b));if(S>0){const $=1/S;let T=$;for(let I=1;I<S;I++,T+=$){const P=[v[1]*(1-T)+g[1]*T,-v[0]*(1-T)-g[0]*T];this.normalize(P),h.push([p[0]+P[0]*r,p[1]+P[1]*r])}}h.push([p[0]+g[1]*r,p[1]-g[0]*r])}break;case Cl.Square:default:if(_<0)h.push([p[0]+(v[1]+v[0])*r,p[1]+(v[1]-v[0])*r]),h.push([p[0]+(g[1]-g[0])*r,p[1]-(g[0]+g[1])*r]);else{const S=Math.sqrt((1+Math.abs(b))/2),$=[g[0]-v[0],g[1]-v[1]];this.normalize($);const T=r/S;h.push([p[0]-$[0]*T,p[1]-$[1]*T])}}}else{const g=[p[0]-a[0],p[1]-a[1]];this.normalize(g),h.push([p[0]+g[1]*r,p[1]-g[0]*r])}else{const g=[y[0]-p[0],y[1]-p[1]];this.normalize(g),h.push([p[0]+g[1]*r,p[1]-g[0]*r])}a=p,p=y}return h.length<(u?3:2)?null:(u&&h.push([h[0][0],h[0][1]]),h)}};const D$=1.7320508075688772,BMe=5,qMe=If.OpenEnded;var Ho;let HMe=(Ho=class{static local(){return Ho.instance===null&&(Ho.instance=new Ho),Ho.instance}execute(e,r,i,s,n){return new WMe(e,r,i)}},Ho.instance=null,Ho),WMe=class extends Ym{constructor(e,r,i){super(e,!1,!0),this._curveHelper=new Hl,this._width=(r.width!==void 0?r.width:BMe)*i,this._arrowType=r.geometricEffectArrowType!==void 0?r.geometricEffectArrowType:r.arrowType!==void 0?r.arrowType:qMe,this._offsetFlattenError=ov*i}processPath(e){const r=rt.createEmptyOptimizedCIM(e.geometryType);switch(this._arrowType){case If.OpenEnded:default:this._constructSimpleArrow(r,e,!0);break;case If.Block:this._constructSimpleArrow(r,e,!1);break;case If.Crossed:this._constructCrossedArrow(r,e)}return r}_constructSimpleArrow(e,r,i){const s=r.pathLength();let n=this._width;s<2*n&&(n=s/2);const o=this._curveHelper.getSubCurve(r,0,s-n);if(!o||!o.nextPath())return;o.seekPathStart();const a=n/2;if(this._curveHelper.isEmpty(o))return;const l=Qu(o),u=this._constructOffset(l,-a);if(!u)return;const h=this._constructOffset(l,a);if(!h)return;const p=this._constructArrowBasePoint(u,-a/2);if(!p)return;const m=this._constructArrowBasePoint(h,a/2);if(!m)return;r.seekInPath(r.pathSize-1);const y=[r.x,r.y];e.pushPath(h),e.nextPath(),e.nextPoint(),e.setControlPoint(),e.pushPoint(m),e.nextPoint(),e.setControlPoint(),e.pushPoint(y),e.nextPoint(),e.setControlPoint(),e.pushPoint(p),e.nextPoint(),e.setControlPoint(),e.pushPoints(u.reverse()),e.setControlPoint(),i||(e.setControlPointAt(0),e.setControlPointAt(e.pathSize-1),e.pushPoint(h[0])),e.reset()}_constructCrossedArrow(e,r){const i=r.pathLength();let s=this._width;i<s*(1+D$+1)&&(s=i/(1+D$+1)),r.seekPathStart();const n=this._curveHelper.getSubCurve(r,0,i-s*(1+D$));if(!n)return;n.nextPath();const o=s/2;if(this._curveHelper.isEmpty(n))return;const a=Qu(n),l=this._constructOffset(a,o);if(!l)return;const u=this._constructOffset(a,-o);if(!u)return;const h=this._curveHelper.getSubCurve(r,0,i-s);if(!h||(h.nextPath(),this._curveHelper.isEmpty(h)))return;const p=Qu(h),m=this._constructOffset(p,o);if(!m)return;const y=this._constructOffset(p,-o);if(!y)return;const g=m[m.length-1],v=this._constructArrowBasePoint(m,o/2);if(!v)return;const _=y[y.length-1],b=this._constructArrowBasePoint(y,-o/2);if(!b)return;r.seekInPath(r.pathSize-1);const S=[r.x,r.y];e.pushPath(l),e.nextPath(),e.nextPoint(),e.setControlPoint(),e.pushPoint(_),e.nextPoint(),e.setControlPoint(),e.pushPoint(b),e.nextPoint(),e.setControlPoint(),e.pushPoint(S),e.nextPoint(),e.setControlPoint(),e.pushPoint(v),e.nextPoint(),e.setControlPoint(),e.pushPoint(g),e.nextPoint(),e.setControlPoint(),e.pushPoints(u.reverse()),e.nextPoint(),e.setControlPoint(),e.reset()}_constructOffset(e,r){return this._curveHelper.offset(e,r,Cl.Rounded,4,this._offsetFlattenError)}_constructArrowBasePoint(e,r){if(!e||e.length<2)return null;const i=e[e.length-2],s=e[e.length-1],n=[s[0]-i[0],s[1]-i[1]];return this._curveHelper.normalize(n),[s[0]+n[1]*r,s[1]-n[0]*r]}};var Wo;let ZMe=(Wo=class{static local(){return Wo.instance===null&&(Wo.instance=new Wo),Wo.instance}execute(e,r,i,s,n,o,a){return new JMe(e,r,i,s,n,o,a)}},Wo.instance=null,Wo),JMe=class{constructor(e,r,i,s,n,o,a){this._preventClipping=a,this._inputGeometries=e,this._tileKey=s,this._geometryEngine=n,this._curveHelper=new Hl,this._size=(r.size!==void 0?r.size:1)*i,this._maxInflateSize=o*i,this._offsetFlattenError=ov*i}next(){let e;for(;e=this._inputGeometries.next();){if(this._size===0)return e;if(e.geometryType==="esriGeometryEnvelope"){if(this._size>0){const n=rt.createEmptyOptimizedCIM(e.geometryType),o=c2(e)[0],a=this._curveHelper.offset(o,this._size,Cl.Rounded,4,this._offsetFlattenError);if(a)return n.pushPath(a),n}else if(this._size<0){const n=e.asJSON();if(Math.min(n.xmax-n.xmin,n.ymax-n.ymin)+2*this._size>0)return rt.fromJSONCIM({xmin:n.xmin-this._size,xmax:n.xmax+this._size,ymin:n.ymin-this._size,ymax:n.ymax+this._size})}}const r=this._geometryEngine;if(r==null)return null;const i=!this._preventClipping&&this._tileKey?yL(e,this._maxInflateSize,!0):e;if(!i)continue;const s=r.buffer(ne.WebMercator,i.asJSON(),this._size,1);return s?rt.fromJSONCIM(s):null}return null}};var Zo;let YMe=(Zo=class{static local(){return Zo.instance===null&&(Zo.instance=new Zo),Zo.instance}execute(e,r,i,s,n){return new XMe(e,r,i)}},Zo.instance=null,Zo),XMe=class{constructor(e,r,i){this._defaultPointSize=20,this._inputGeometries=e,this._geomUnitsPerPoint=i,this._rule=r.rule??Ie.FullGeometry,this._defaultSize=this._defaultPointSize*i}next(){let e;for(;e=this._inputGeometries.next();){const r=this._processGeom(c2(e));if(r?.length)return rt.fromJSONCIM({paths:r})}return null}_clone(e){return[e[0],e[1]]}_mid(e,r){return[(e[0]+r[0])/2,(e[1]+r[1])/2]}_mix(e,r,i,s){return[e[0]*r+i[0]*s,e[1]*r+i[1]*s]}_add(e,r){return[e[0]+r[0],e[1]+r[1]]}_add2(e,r,i){return[e[0]+r,e[1]+i]}_sub(e,r){return[e[0]-r[0],e[1]-r[1]]}_dist(e,r){return Math.sqrt((e[0]-r[0])*(e[0]-r[0])+(e[1]-r[1])*(e[1]-r[1]))}_norm(e){return Math.sqrt(e[0]*e[0]+e[1]*e[1])}_normalize(e,r=1){const i=r/this._norm(e);e[0]*=i,e[1]*=i}_leftPerpendicular(e){const r=-e[1],i=e[0];e[0]=r,e[1]=i}_leftPerp(e){return[-e[1],e[0]]}_rightPerpendicular(e){const r=e[1],i=-e[0];e[0]=r,e[1]=i}_rightPerp(e){return[e[1],-e[0]]}_dotProduct(e,r){return e[0]*r[0]+e[1]*r[1]}_crossProduct(e,r){return e[0]*r[1]-e[1]*r[0]}_rotateDirect(e,r,i){const s=e[0]*r-e[1]*i,n=e[0]*i+e[1]*r;e[0]=s,e[1]=n}_makeCtrlPt(e){const r=[e[0],e[1]];return Py(r,1),r}_addAngledTicks(e,r,i,s){const n=this._sub(i,r);this._normalize(n);const o=this._crossProduct(n,this._sub(s,r));let a;a=o>0?this._rightPerp(n):this._leftPerp(n);const l=Math.abs(o)/2,u=[];u.push([r[0]+(a[0]-n[0])*l,r[1]+(a[1]-n[1])*l]),u.push(r),u.push(i),u.push([i[0]+(a[0]+n[0])*l,i[1]+(a[1]+n[1])*l]),e.push(u)}_addBezier2(e,r,i,s,n){if(n--===0)return void e.push(s);const o=this._mid(r,i),a=this._mid(i,s),l=this._mid(o,a);this._addBezier2(e,r,o,l,n),this._addBezier2(e,l,a,s,n)}_addBezier3(e,r,i,s,n,o){if(o--===0)return void e.push(n);const a=this._mid(r,i),l=this._mid(i,s),u=this._mid(s,n),h=this._mid(a,l),p=this._mid(l,u),m=this._mid(h,p);this._addBezier3(e,r,a,h,m,o),this._addBezier3(e,m,p,u,n,o)}_add90DegArc(e,r,i,s,n){const o=n??this._crossProduct(this._sub(i,r),this._sub(s,r))>0,a=this._mid(r,i),l=this._sub(a,r);o?this._leftPerpendicular(l):this._rightPerpendicular(l),a[0]+=l[0],a[1]+=l[1],this._addBezier3(e,r,this._mix(r,.33333,a,.66667),this._mix(i,.33333,a,.66667),i,4)}_addArrow(e,r,i){const s=r[0],n=r[1],o=r[r.length-1],a=this._sub(s,n),l=this._norm(a);this._normalize(a);const u=Math.abs(this._crossProduct(a,this._sub(o,n)));let h=this._dotProduct(a,this._sub(o,n));h<.05*l?h=.05*l:h>.95*l&&(h=.95*l);const p=.5*u,m=this._leftPerp(a),y=[n[0]+a[0]*h,n[1]+a[1]*h],g=r.length-1,v=[];v.push(i?[-m[0],-m[1]]:m);let _=[-a[0],-a[1]];for(let b=1;b<g-1;b++){const S=this._sub(r[b+1],r[b]);this._normalize(S);const $=this._dotProduct(S,_),T=this._crossProduct(S,_),I=Math.sqrt((1+$)/2),P=this._sub(S,_);this._normalize(P),P[0]/=I,P[1]/=I,v.push(T<0?[-P[0],-P[1]]:P),_=S}v.push(this._rightPerp(_));for(let b=v.length-1;b>0;b--)e.push([r[b][0]+v[b][0]*p,r[b][1]+v[b][1]*p]);e.push([y[0]+v[0][0]*p,y[1]+v[0][1]*p]),e.push([y[0]+v[0][0]*u,y[1]+v[0][1]*u]),e.push(s),e.push([y[0]-v[0][0]*u,y[1]-v[0][1]*u]),e.push([y[0]-v[0][0]*p,y[1]-v[0][1]*p]);for(let b=1;b<v.length;b++)e.push([r[b][0]-v[b][0]*p,r[b][1]-v[b][1]*p])}_addDash(e,r,i){const s=this._norm(i)/7;this._normalize(i);let n=[];for(let o=0;o<=7;o++)n.push([r[0]+i[0]*o*s,r[1]+i[1]*o*s]),1&o&&(e.push(n),n=[])}_cp2(e,r,i){return e.length>=2?e[1]:this._add2(e[0],r*this._defaultSize,i*this._defaultSize)}_cp3(e,r,i,s){if(e.length>=3)return e[2];const n=this._mix(e[0],1-i,r,i),o=this._sub(r,e[0]);return this._normalize(o),this._rightPerpendicular(o),[n[0]+o[0]*s*this._defaultSize,n[1]+o[1]*s*this._defaultSize]}_arrowPath(e){if(e.length>2)return e;const r=e[0],i=this._cp2(e,-4,0),s=this._sub(r,i);this._normalize(s);const n=this._rightPerp(s);return[r,i,[r[0]+(n[0]-s[0])*this._defaultSize,r[1]+(n[1]-s[1])*this._defaultSize]]}_arrowLastSeg(e){const r=e[0],i=this._cp2(e,-4,0);let s;if(e.length>=3)s=e[e.length-1];else{const n=this._sub(r,i);this._normalize(n);const o=this._rightPerp(n);s=[r[0]+(o[0]-n[0])*this._defaultSize,r[1]+(o[1]-n[1])*this._defaultSize]}return[i,s]}_processGeom(e){if(!e)return null;const r=[];for(const i of e){const s=i.length>1&&Wse(i)<this._defaultSize;if(!i||i.length===0||s)continue;const n=i.length;let o=i[0];switch(this._rule){case Ie.PerpendicularFromFirstSegment:{const a=this._cp2(i,0,-1),l=this._cp3(i,a,.5,4),u=[];u.push(l),u.push(this._mid(o,a)),r.push(u);break}case Ie.ReversedFirstSegment:{const a=this._cp2(i,0,-1);r.push([a,o]);break}case Ie.PerpendicularToSecondSegment:{if(i.length<3)return[];const a=this._cp2(i,-4,1),l=this._cp3(i,a,.882353,-1.94),u=[];u.push(this._mid(a,l)),u.push(o),r.push(u);break}case Ie.SecondSegmentWithTicks:{if(i.length<3)return[];const a=this._cp2(i,-4,1),l=this._cp3(i,a,.882353,-1.94),u=this._sub(l,a);let h;h=this._crossProduct(u,this._sub(o,a))>0?this._rightPerp(u):this._leftPerp(u);const p=[];p.push([a[0]+(h[0]-u[0])/3,a[1]+(h[1]-u[1])/3]),p.push(a),p.push(l),p.push([l[0]+(h[0]+u[0])/3,l[1]+(h[1]+u[1])/3]),r.push(p);break}case Ie.DoublePerpendicular:{const a=this._cp2(i,0,-1),l=this._cp3(i,a,.5,3),u=this._mid(o,a),h=this._sub(u,l);this._normalize(h);const p=this._crossProduct(h,this._sub(o,l));this._leftPerpendicular(h);const m=[];m.push(o),m.push([l[0]+h[0]*p,l[1]+h[1]*p]),r.push(m);const y=[];y.push([l[0]-h[0]*p,l[1]-h[1]*p]),y.push(a),r.push(y);break}case Ie.OppositeToFirstSegment:{const a=this._cp2(i,0,-1),l=this._cp3(i,a,.5,3),u=this._mid(o,a),h=this._sub(u,l);this._normalize(h);const p=this._crossProduct(h,this._sub(o,l));this._leftPerpendicular(h);const m=[];m.push([l[0]+h[0]*p,l[1]+h[1]*p]),m.push([l[0]-h[0]*p,l[1]-h[1]*p]),r.push(m);break}case Ie.TriplePerpendicular:{const a=this._cp2(i,0,-1),l=this._cp3(i,a,.5,4),u=this._mid(o,a),h=this._sub(u,l);this._normalize(h);const p=this._crossProduct(h,this._sub(o,l));this._leftPerpendicular(h);const m=[];m.push([l[0]+h[0]*p*.8,l[1]+h[1]*p*.8]),m.push([u[0]+.8*(o[0]-u[0]),u[1]+.8*(o[1]-u[1])]),r.push(m),r.push([l,u]);const y=[];y.push([l[0]-h[0]*p*.8,l[1]-h[1]*p*.8]),y.push([u[0]+.8*(a[0]-u[0]),u[1]+.8*(a[1]-u[1])]),r.push(y);break}case Ie.HalfCircleFirstSegment:{const a=this._cp2(i,0,-1),l=this._cp3(i,a,.5,4),u=this._mid(o,a);let h=this._sub(a,o);const p=Math.cos(Math.PI/18),m=Math.sin(Math.PI/18),y=Math.sqrt((1+p)/2),g=Math.sqrt((1-p)/2),v=[];let _;this._crossProduct(h,this._sub(l,o))>0?(v.push(o),h=this._sub(o,u),_=a):(v.push(a),h=this._sub(a,u),_=o),this._rotateDirect(h,y,g),h[0]/=y,h[1]/=y;for(let b=1;b<=18;b++)v.push(this._add(u,h)),this._rotateDirect(h,p,m);v.push(_),r.push(v);break}case Ie.HalfCircleSecondSegment:{const a=this._cp2(i,0,-1),l=this._cp3(i,a,1,-1);let u=this._sub(o,a);this._normalize(u);const h=this._crossProduct(u,this._sub(l,a))/2;this._leftPerpendicular(u);const p=[a[0]+u[0]*h,a[1]+u[1]*h];u=this._sub(a,p);const m=Math.cos(Math.PI/18);let y=Math.sin(Math.PI/18);h>0&&(y=-y);const g=[a];for(let v=1;v<=18;v++)this._rotateDirect(u,m,y),g.push(this._add(p,u));r.push(g);break}case Ie.HalfCircleExtended:{const a=this._cp2(i,0,-2),l=this._cp3(i,a,1,-1);let u;if(n>=4)u=i[3];else{const v=this._sub(o,a);u=this._add(l,v)}const h=this._dist(a,l)/2/.75,p=this._sub(a,o);this._normalize(p,h);const m=this._sub(l,u);this._normalize(m,h);const y=[u,l];r.push(y);const g=[this._clone(l)];this._addBezier3(g,l,this._add(l,m),this._add(a,p),a,4),g.push(o),r.push(g);break}case Ie.OpenCircle:{const a=this._cp2(i,-2,0),l=this._sub(a,o),u=Math.cos(Math.PI/18),h=-Math.sin(Math.PI/18),p=[a];for(let m=1;m<=33;m++)this._rotateDirect(l,u,h),p.push(this._add(o,l));r.push(p);break}case Ie.CoverageEdgesWithTicks:{const a=this._cp2(i,0,-1);let l,u;if(n>=3)l=i[2];else{const y=this._sub(a,o),g=this._leftPerp(y);l=[o[0]+g[0]-.25*y[0],o[1]+g[1]-.25*y[1]]}if(n>=4)u=i[3];else{const y=this._mid(o,a),g=this._sub(o,a);this._normalize(g),this._leftPerpendicular(g);const v=this._crossProduct(g,this._sub(l,y));this._rightPerpendicular(g),u=[l[0]+g[0]*v*2,l[1]+g[1]*v*2]}const h=this._sub(a,o);let p,m;p=this._crossProduct(h,this._sub(l,o))>0?this._rightPerp(h):this._leftPerp(h),m=[],m.push(l),m.push(o),m.push([o[0]+(p[0]-h[0])/3,o[1]+(p[1]-h[1])/3]),r.push(m),p=this._crossProduct(h,this._sub(u,a))>0?this._rightPerp(h):this._leftPerp(h),m=[],m.push([a[0]+(p[0]+h[0])/3,a[1]+(p[1]+h[1])/3]),m.push(a),m.push(u),r.push(m);break}case Ie.GapExtentWithDoubleTicks:{const a=this._cp2(i,0,2),l=this._cp3(i,a,0,1);let u;if(n>=4)u=i[3];else{const h=this._sub(a,o);u=this._add(l,h)}this._addAngledTicks(r,o,a,this._mid(l,u)),this._addAngledTicks(r,l,u,this._mid(o,a));break}case Ie.GapExtentMidline:{const a=this._cp2(i,2,0),l=this._cp3(i,a,0,1);let u;if(n>=4)u=i[3];else{const p=this._sub(a,o);u=this._add(l,p)}const h=[];h.push(this._mid(o,l)),h.push(this._mid(a,u)),r.push(h);break}case Ie.Chevron:{const a=this._cp2(i,-1,-1);let l;if(n>=3)l=i[2];else{const u=this._sub(a,o);this._leftPerpendicular(u),l=this._add(o,u)}r.push([a,this._makeCtrlPt(o),l]);break}case Ie.PerpendicularWithArc:{const a=this._cp2(i,0,-2),l=this._cp3(i,a,.5,-1),u=this._sub(a,o),h=this._norm(u);u[0]/=h,u[1]/=h;const p=this._crossProduct(u,this._sub(l,o));let m=this._dotProduct(u,this._sub(l,o));m<.05*h?m=.05*h:m>.95*h&&(m=.95*h);const y=[o[0]+u[0]*m,o[1]+u[1]*m];let g=this._leftPerp(u),v=[];if(v.push([y[0]-g[0]*p,y[1]-g[1]*p]),v.push([y[0]+g[0]*p,y[1]+g[1]*p]),r.push(v),n>=4){const $=i[3];let T=this._dotProduct(u,this._sub($,o));T<.1*h?T=.1*h:T>.9*h&&(T=.9*h);const I=[o[0]+u[0]*T,o[1]+u[1]*T],P=this._crossProduct(u,this._sub($,o)),R=[];R.push([I[0]-g[0]*P,I[1]-g[1]*P]),R.push([I[0]+g[0]*P,I[1]+g[1]*P]),r.push(R)}const _=[a[0]+g[0]*p,a[1]+g[1]*p];g=this._sub(a,_);const b=Math.cos(Math.PI/18);let S=Math.sin(Math.PI/18);p<0&&(S=-S),v=[o,a];for(let $=1;$<=9;$++)this._rotateDirect(g,b,S),v.push(this._add(_,g));r.push(v);break}case Ie.ClosedHalfCircle:{const a=this._cp2(i,2,0),l=this._mid(o,a),u=this._sub(a,l),h=Math.cos(Math.PI/18),p=Math.sin(Math.PI/18),m=[o,a];for(let y=1;y<=18;y++)this._rotateDirect(u,h,p),m.push(this._add(l,u));r.push(m);break}case Ie.TripleParallelExtended:{const a=this._cp2(i,0,-2),l=this._cp3(i,a,1,-2),u=this._mid(o,a),h=this._sub(l,a);this._normalize(h);const p=Math.abs(this._crossProduct(h,this._sub(u,a)))/2,m=this._dist(a,l),y=[a,o];y.push([o[0]+h[0]*m*.5,o[1]+h[1]*m*.5]),r.push(y);const g=[];g.push([u[0]-h[0]*p,u[1]-h[1]*p]),g.push([u[0]+h[0]*m*.375,u[1]+h[1]*m*.375]),Py(g[g.length-1],1),g.push([u[0]+h[0]*m*.75,u[1]+h[1]*m*.75]),r.push(g);const v=[a,l];r.push(v);break}case Ie.ParallelWithTicks:{const a=this._cp2(i,3,0),l=this._cp3(i,a,.5,-1),u=this._sub(l,a);this._normalize(u);const h=this._crossProduct(u,this._sub(l,o));this._leftPerpendicular(u),this._addAngledTicks(r,o,a,l),this._addAngledTicks(r,this._mix(o,1,u,h),this._mix(a,1,u,h),this._mid(o,a));break}case Ie.Parallel:{const a=this._cp2(i,3,0),l=this._cp3(i,a,.5,-1),u=this._sub(a,o);this._normalize(u);const h=this._leftPerp(u),p=this._crossProduct(u,this._sub(l,o));let m=[o,a];r.push(m),m=[],m.push([o[0]+h[0]*p,o[1]+h[1]*p]),m.push([a[0]+h[0]*p,a[1]+h[1]*p]),r.push(m);break}case Ie.PerpendicularToFirstSegment:{const a=this._cp2(i,3,0),l=this._cp3(i,a,.5,-1),u=this._mid(o,a),h=this._sub(a,o);this._normalize(h);const p=this._crossProduct(h,this._sub(l,o));this._leftPerpendicular(h);const m=[];m.push([u[0]-h[0]*p*.25,u[1]-h[1]*p*.25]),m.push([u[0]+h[0]*p*1.25,u[1]+h[1]*p*1.25]),r.push(m);break}case Ie.ParallelOffset:{const a=this._cp2(i,3,0),l=this._cp3(i,a,.5,-1),u=this._sub(a,o);this._normalize(u);const h=this._crossProduct(u,this._sub(l,o));this._leftPerpendicular(u);const p=[];p.push([o[0]-u[0]*h,o[1]-u[1]*h]),p.push([a[0]-u[0]*h,a[1]-u[1]*h]),r.push(p);const m=[];m.push([o[0]+u[0]*h,o[1]+u[1]*h]),m.push([a[0]+u[0]*h,a[1]+u[1]*h]),r.push(m);break}case Ie.OffsetOpposite:{const a=this._cp2(i,3,0),l=this._cp3(i,a,.5,-1),u=this._sub(a,o);this._normalize(u);const h=this._crossProduct(u,this._sub(l,o));this._leftPerpendicular(u);const p=[];p.push([o[0]-u[0]*h,o[1]-u[1]*h]),p.push([a[0]-u[0]*h,a[1]-u[1]*h]),r.push(p);break}case Ie.OffsetSame:{const a=this._cp2(i,3,0),l=this._cp3(i,a,.5,-1),u=this._sub(a,o);this._normalize(u);const h=this._crossProduct(u,this._sub(l,o));this._leftPerpendicular(u);const p=[];p.push([o[0]+u[0]*h,o[1]+u[1]*h]),p.push([a[0]+u[0]*h,a[1]+u[1]*h]),r.push(p);break}case Ie.CircleWithArc:{let a=this._cp2(i,3,0);const l=this._cp3(i,a,.5,-1);let u,h;if(n>=4)u=i[3],h=this._crossProduct(this._sub(u,a),this._sub(l,a))>0;else{u=a,h=this._crossProduct(this._sub(u,o),this._sub(l,o))>0;const v=24*this._geomUnitsPerPoint,_=this._sub(u,o);this._normalize(_,v);const b=Math.sqrt(2)/2;this._rotateDirect(_,b,h?b:-b),a=this._add(o,_)}const p=this._sub(a,o),m=Math.cos(Math.PI/18),y=Math.sin(Math.PI/18),g=[a];for(let v=1;v<=36;v++)this._rotateDirect(p,m,y),g.push(this._add(o,p));this._add90DegArc(g,a,u,l,h),Py(g[g.length-8],1),r.push(g);break}case Ie.DoubleJog:{let a,l=this._cp2(i,-3,1),u=this._cp3(i,l,-1,-.5);if(n>=4)a=i[3];else{const S=o;o=l,a=u;const $=this._dist(o,S),T=this._dist(a,S);let I=30*this._geomUnitsPerPoint;.5*$<I&&(I=.5*$),.5*T<I&&(I=.5*T),l=this._mix(o,I/$,S,($-I)/$),u=this._mix(a,I/T,S,(T-I)/T)}const h=this._mid(o,l),p=this._mid(a,u),m=this._dist(o,l),y=this._dist(u,a);let g=Math.min(m,y)/8;g=Math.min(g,24*this._geomUnitsPerPoint);const v=Math.cos(Math.PI/4);let _=this._sub(o,l);this._normalize(_,g),this._crossProduct(_,this._sub(a,l))>0?this._rotateDirect(_,v,-v):this._rotateDirect(_,v,v);let b=[];b.push(l),b.push(this._add(h,_)),b.push(this._sub(h,_)),b.push(o),r.push(b),_=this._sub(a,u),this._normalize(_,g),this._crossProduct(_,this._sub(o,u))<0?this._rotateDirect(_,v,v):this._rotateDirect(_,v,-v),b=[],b.push(u),b.push(this._add(p,_)),b.push(this._sub(p,_)),b.push(a),r.push(b);break}case Ie.PerpendicularOffset:{const a=this._cp2(i,-4,1),l=this._cp3(i,a,.882353,-1.94),u=this._sub(l,a);this._crossProduct(u,this._sub(o,a))>0?this._rightPerpendicular(u):this._leftPerpendicular(u);const h=[u[0]/8,u[1]/8],p=this._sub(this._mid(a,l),h);r.push([p,o]);break}case Ie.LineExcludingLastSegment:{const a=this._arrowPath(i),l=[];let u=a.length-2;for(;u--;)l.push(a[u]);r.push(l);break}case Ie.MultivertexArrow:{const a=this._arrowPath(i),l=[];this._addArrow(l,a,!1),r.push(l);break}case Ie.CrossedArrow:{const a=this._arrowPath(i),l=[];this._addArrow(l,a,!0),r.push(l);break}case Ie.ChevronArrow:{const[a,l]=this._arrowLastSeg(i),u=10*this._geomUnitsPerPoint,h=this._sub(o,a),p=this._norm(h);this._normalize(h);const m=this._crossProduct(h,this._sub(l,a));let y=this._dotProduct(h,this._sub(l,a));y<.05*p?y=.05*p:y>.95*p-u&&(y=.95*p-u);const g=[a[0]+h[0]*y,a[1]+h[1]*y],v=this._leftPerp(h),_=[];_.push([g[0]+v[0]*m+h[0]*u,g[1]+v[1]*m+h[1]*u]),_.push(o),_.push([g[0]-v[0]*m+h[0]*u,g[1]-v[1]*m+h[1]*u]),r.push(_);break}case Ie.ChevronArrowOffset:{const[a,l]=this._arrowLastSeg(i),u=this._sub(o,a),h=this._norm(u);this._normalize(u);const p=this._crossProduct(u,this._sub(l,a));let m=this._dotProduct(u,this._sub(l,a));m<.05*h?m=.05*h:m>.95*h&&(m=.95*h);const y=[a[0]+u[0]*m,a[1]+u[1]*m];this._leftPerpendicular(u);const g=[];g.push([y[0]+u[0]*p*.5,y[1]+u[1]*p*.5]),g.push(this._mid(y,o)),g.push([y[0]-u[0]*p*.5,y[1]-u[1]*p*.5]),r.push(g);break}case Ie.PartialFirstSegment:{const[a,l]=this._arrowLastSeg(i),u=this._sub(o,a),h=this._norm(u);this._normalize(u);let p=this._dotProduct(u,this._sub(l,a));p<.05*h?p=.05*h:p>.95*h&&(p=.95*h);const m=[a[0]+u[0]*p,a[1]+u[1]*p];r.push([a,m]);break}case Ie.Arch:{const a=this._cp2(i,0,-1),l=this._cp3(i,a,.5,1),u=this._sub(o,a),h=this._mix(l,1,u,.55),p=this._mix(l,1,u,-.55),m=[o];this._addBezier2(m,o,h,l,4),this._addBezier2(m,l,p,a,4),r.push(m);break}case Ie.CurvedParallelTicks:{const a=this._cp2(i,-4,1),l=this._cp3(i,a,.882353,-1.94),u=this._sub(l,a);this._crossProduct(u,this._sub(o,a))>0?this._rightPerpendicular(u):this._leftPerpendicular(u);const h=[u[0]/8,u[1]/8],p=this._sub(this._mid(a,l),h),m=this._sub(this._mix(a,.75,l,.25),h),y=this._sub(this._mix(a,.25,l,.75),h),g=[a];this._addBezier2(g,a,m,p,3),this._addBezier2(g,p,y,l,3),r.push(g);for(let v=0;v<8;v++){const _=g[2*v+1],b=[this._clone(_)];b.push(this._add(_,[u[0]/4,u[1]/4])),r.push(b)}break}case Ie.Arc90Degrees:{const a=this._cp2(i,0,-1),l=this._cp3(i,a,.5,1),u=[a];this._add90DegArc(u,a,o,l),r.push(u);break}case Ie.TipWithPerpendicularAndTicks:{const[a,l]=this._arrowLastSeg(i),u=10*this._geomUnitsPerPoint,h=this._sub(o,a),p=this._norm(h);this._normalize(h);let m=this._crossProduct(h,this._sub(l,a)),y=this._dotProduct(h,this._sub(l,a));y<.05*p?y=.05*p:y>.95*p-u&&(y=.95*p-u);const g=this._leftPerp(h),v=[o[0]-h[0]*u,o[1]-h[1]*u],_=.5*Math.max(p-y-u,u);m=Math.abs(m);const b=[];b.push([v[0]+g[0]*(m+_)-h[0]*_,v[1]+g[1]*(m+_)-h[1]*_]),b.push([v[0]+g[0]*m,v[1]+g[1]*m]),b.push([v[0]-g[0]*m,v[1]-g[1]*m]),b.push([v[0]-g[0]*(m+_)-h[0]*_,v[1]-g[1]*(m+_)-h[1]*_]),r.push(b),r.push([v,o]);break}case Ie.ConcentricCircles:{const a=this._cp2(i,1,0),l=this._cp3(i,a,2,0),u=Math.cos(Math.PI/18),h=Math.sin(Math.PI/18);let p=this._dist(a,o),m=[p,0],y=[];for(let g=0;g<=36;g++)y.push(this._add(o,m)),this._rotateDirect(m,u,h);if(r.push(y),n>=4){y=[];const g=i[3];p=this._dist(g,o),m=[p,0];for(let v=0;v<=36;v++)y.push(this._add(o,m)),v===0&&(y.push(this._add(o,m)),Py(y[1],1)),this._rotateDirect(m,u,h);r.push(y)}y=[],p=this._dist(l,o),m=[p,0];for(let g=0;g<=36;g++)y.push(this._add(o,m)),this._rotateDirect(m,u,h);r.push(y);break}case Ie.DoubleJogArrow:{o=this._arrowPath(i)[0];const[a,l]=this._arrowLastSeg(i),u=this._sub(o,a),h=this._norm(u);this._normalize(u);const p=Math.abs(this._crossProduct(u,this._sub(l,o)));let m=Math.abs(this._dotProduct(u,this._sub(l,o)));m<.05*h?m=.05*h:m>.95*h&&(m=.95*h);const y=Math.max(p,m),g=this._leftPerp(u);let v=[];const _=[o[0]-u[0]*m*.5+g[0]*p*.5,o[1]-u[1]*m*.5+g[1]*p*.5];v.push([_[0],_[1]]),_[0]+=u[0]*y*.5+g[0]*y*.4,_[1]+=u[1]*y*.5+g[1]*y*.4,v.push([_[0],_[1]]),_[0]-=g[0]*y*.25,_[1]-=g[1]*y*.25,v.push([_[0],_[1]]),_[0]+=u[0]*y*.5+g[0]*y*.4,_[1]+=u[1]*y*.5+g[1]*y*.4,v.push([_[0],_[1]]),r.push(v),v=[],_[0]=o[0]-u[0]*m*.5-g[0]*p*.5,_[1]=o[1]-u[1]*m*.5-g[1]*p*.5,v.push([_[0],_[1]]),_[0]+=u[0]*y*.5-g[0]*y*.4,_[1]+=u[1]*y*.5-g[1]*y*.4,v.push([_[0],_[1]]),_[0]+=g[0]*y*.25,_[1]+=g[1]*y*.25,v.push([_[0],_[1]]),_[0]+=u[0]*y*.5-g[0]*y*.4,_[1]+=u[1]*y*.5-g[1]*y*.4,v.push([_[0],_[1]]),r.push(v);break}case Ie.LinkedChevrons:{const a=this._cp2(i,-5,0),l=this._cp3(i,a,-.2,1),u=this._sub(o,a);this._normalize(u);const h=this._leftPerp(u),p=Math.abs(this._crossProduct(u,this._sub(l,a)));r.push([a,o]);const m=[];m.push([o[0]-u[0]*p+h[0]*p,o[1]-u[1]*p+h[1]*p]),m.push(o),m.push([o[0]-u[0]*p-h[0]*p,o[1]-u[1]*p-h[1]*p]),r.push(m),this._addDash(r,a,[-u[0]*p+h[0]*p,-u[1]*p+h[1]*p]),this._addDash(r,a,[-u[0]*p-h[0]*p,-u[1]*p-h[1]*p]);break}case Ie.SegmentThenHalfCircle:{const a=this._cp2(i,2,0),l=this._cp3(i,a,1.5,0);let u;u=n>=4?i[3]:this._cp3(i,a,1.25,-.5);const h=this._sub(a,o);this._normalize(h);const p=.5*this._dist(a,l),m=this._crossProduct(h,this._sub(u,o))>0,y=Math.cos(Math.PI/18);let g=Math.sin(Math.PI/18);m&&(g=-g);const v=[o,a];h[0]*=p,h[1]*=p;const _=this._add(a,h);h[0]=-h[0],h[1]=-h[1];for(let b=1;b<=18;b++)this._rotateDirect(h,y,g),v.push(this._add(_,h));r.push(v);break}case Ie.LineWithStraightTicks:{const a=this._cp2(i,-2,1),l=this._cp3(i,a,-1,-.5),u=this._sub(l,a);this._normalize(u);const h=this._dotProduct(u,this._sub(a,o)),p=this._dotProduct(u,this._sub(l,o));let m=[o];m.push([o[0]+u[0]*h,o[1]+u[1]*h]),m.push(a),r.push(m),m=[o],m.push([o[0]+u[0]*p,o[1]+u[1]*p]),m.push(l),r.push(m);break}case Ie.DoubleCurve:{const a=this._cp2(i,-5,-1),l=this._cp3(i,a,2,0),u=Math.atan2(1,5),h=Math.cos(u),p=Math.sin(u),m=this._sub(a,o),y=this._dist(o,a);this._normalize(m),this._rotateDirect(m,h,-p);const g=[o];g.push([o[0]+m[0]*y*.5,o[1]+m[1]*y*.5]),Py(g[1],1),g.push([o[0]+m[0]*y*.8,o[1]+m[1]*y*.8]),this._addBezier2(g,g[2],[o[0]+m[0]*y,o[1]+m[1]*y],a,3);const v=this._sub(l,a),_=this._dist(a,l);this._normalize(v),this._rotateDirect(v,h,-p),this._addBezier2(g,a,[l[0]-v[0]*_,l[1]-v[1]*_],[l[0]-v[0]*_*.8,l[1]-v[1]*_*.8],3),g.push(l),r.push(g);break}case Ie.ParallelWithTicksByWidth:{const a=this._cp2(i,0,-1),l=this._cp3(i,a,.5,3),u=this._sub(a,o);this._normalize(u);const h=this._crossProduct(u,this._sub(l,o));this._leftPerpendicular(u),h>0?(this._addAngledTicks(r,o,[o[0]+u[0]*h,o[1]+u[1]*h],a),this._addAngledTicks(r,a,[a[0]+u[0]*h,a[1]+u[1]*h],o)):(this._addAngledTicks(r,[o[0]+u[0]*h,o[1]+u[1]*h],o,a),this._addAngledTicks(r,[a[0]+u[0]*h,a[1]+u[1]*h],o,a));break}case Ie.EnclosingRoundedRectangle:{const a=this._cp2(i,3,-2),l=[Math.min(o[0],a[0]),Math.max(o[1],a[1])],u=[Math.max(o[0],a[0]),Math.min(o[1],a[1])],h=u[0]-l[0],p=l[1]-u[1],m=Math.min(h,p)/10,y=[];y.push([l[0]+m+.75*(h-2*m),l[1]]),y.push([u[0]-m,l[1]]),this._add90DegArc(y,[u[0]-m,l[1]],[u[0],l[1]-m],[u[0],l[1]]),y.push([u[0],u[1]+m]),this._add90DegArc(y,[u[0],u[1]+m],[u[0]-m,u[1]],u),y.push([l[0]+m,u[1]]),this._add90DegArc(y,[l[0]+m,u[1]],[l[0],u[1]+m],[l[0],u[1]]),y.push([l[0],l[1]-m]),this._add90DegArc(y,[l[0],l[1]-m],[l[0]+m,l[1]],l),y.push([l[0]+m+.75*(h-2*m),l[1]]);break}case Ie.FullGeometry:default:r.push(i)}}return r}};var Jo;let KMe=(Jo=class{static local(){return Jo.instance===null&&(Jo.instance=new Jo),Jo.instance}execute(e,r,i,s,n){return new QMe(e,r,i)}},Jo.instance=null,Jo),QMe=class extends Ym{constructor(e,r,i){super(e,!0,!0),this._curveHelper=new Hl,this._beginCut=(r.beginCut!==void 0?r.beginCut:1)*i,this._endCut=(r.endCut!==void 0?r.endCut:1)*i,this._middleCut=(r.middleCut!==void 0?r.middleCut:0)*i,this._invert=r.invert!==void 0&&r.invert,this._beginCut<0&&(this._beginCut=0),this._endCut<0&&(this._endCut=0),this._middleCut<0&&(this._middleCut=0)}processPath(e){const{_beginCut:r,_endCut:i,_middleCut:s}=this,n=e.pathLength(),o=rt.createEmptyOptimizedCIM("esriGeometryPolyline");if(this._invert){if(r!==0||i!==0||s!==0)if(r+i+s>=n)for(o.startPath();e.nextPoint();)o.pushXY(e.x,e.y);else this._curveHelper.appendSubCurve(o,e,0,r),this._curveHelper.appendSubCurve(o,e,.5*(n-s),.5*(n+s)),this._curveHelper.appendSubCurve(o,e,n-i,i)}else if(r===0&&i===0&&s===0)for(o.startPath();e.nextPoint();)o.pushXY(e.x,e.y);else r+i+s<n&&(s===0?this._curveHelper.appendSubCurve(o,e,r,n-i):(this._curveHelper.appendSubCurve(o,e,r,.5*(n-s)),this._curveHelper.appendSubCurve(o,e,.5*(n+s),n-i)));return o.totalSize===0?null:o}};const k4=1e-7;let Q2=class{constructor(){this._values=[],this.extPtGap=0,this.ctrlPtGap=0,this._length=0,this._currentValue=0}isEmpty(){return this._values.length===0}size(){return this._values.length}init(e,r,i=!0){if(this._setEmpty(),!e||e.length===0)return!1;for(let s=0;s<e.length;s++){let n=Math.abs(e[s]);i&&n<k4&&(n=k4),this._values.push(n),this._length+=n}return r&&1&e.length&&(this._length*=2),this._length!==0&&(this.ctrlPtGap=this.extPtGap=0,this._currentValue=-1,!0)}scale(e){const r=this._values?this._values.length:0;for(let i=0;i<r;++i)this._values[i]*=e;this._length*=e,this.extPtGap*=e,this.ctrlPtGap*=e}addValue(e){this._length+=e,this._values.push(e)}firstValue(){return this._values[0]}lastValue(){return this._values[this._values.length-1]}nextValue(){return this._currentValue++,this._currentValue===this._values.length&&(this._currentValue=0),this._values[this._currentValue]}reset(){this._currentValue=-1}length(){return this._length}_setEmpty(){this.extPtGap=this.ctrlPtGap=this._length=0,this._currentValue=-1,this._values.length=0}},fl=class{constructor(){this.pt=null,this.ca=0,this.sa=0}};var Vu;(function(t){t[t.FAIL=0]="FAIL",t[t.END=1]="END",t[t.CONTINUE=2]="CONTINUE"})(Vu||(Vu={}));let X_=class{constructor(){this.reset()}reset(){this.segment=null,this.segmentLength=0,this.abscissa=0,this.isPathEnd=!1,this.isPartEnd=!1}isValid(){return this.segment!==null}copyTo(e){e.segment=this.segment,e.segmentLength=this.segmentLength,e.abscissa=this.abscissa,e.isPathEnd=this.isPathEnd,e.isPartEnd=this.isPartEnd}},ex=class extends Hl{constructor(e=0,r=!1){super(e,r),this._tempPos=new X_,this._tempPt=[0,0],this._tolerance=ov,this._currentPosition=new X_}updateTolerance(e){this._tolerance=ov*e}init(e,r,i=!0){return i?(this._patternLength=r.length(),this._partExtPtGap=r.extPtGap,this._partCtrlPtGap=r.ctrlPtGap):(this._patternLength=0,this._partExtPtGap=0,this._partCtrlPtGap=0),this._currentPosition.reset(),this._partSegCount=0,this._pathCursor=e,this._seg=-1,this._setPosAtNextPart()}curPositionIsValid(){return this._currentPosition.isValid()}nextPosition(e,r=Vu.FAIL){const i=new X_;return!!this._nextPosition(e,i,null,r)&&(i.copyTo(this._currentPosition),!0)}curPointAndAngle(e){e.pt=this._getPoint(this._currentPosition);const[r,i]=this._getAngleCS(this._tempPt,this._currentPosition);e.ca=r,e.sa=i}nextPointAndAngle(e,r,i=Vu.FAIL){const s=this._tempPos;if(!this._nextPosition(e,s,null,i))return!1;s.copyTo(this._currentPosition),r.pt=this._getPoint(s);const[n,o]=this._getAngleCS(this._tempPt,s);return r.ca=n,r.sa=o,!0}nextCurve(e){if(e===0)return null;const r=rt.createEmptyOptimizedCIM("esriGeometryPolyline");r.startPath(),r.nextPath();const i=new X_;return this._nextPosition(e,i,r,Vu.END)?(i.copyTo(this._currentPosition),r):null}isPathEnd(){return this._currentPosition.isPathEnd}getPathEnd(){return this._currentPosition.segment[1]}getPt(e){return this._pathCursor.seekInPath(e),[this._pathCursor.x,this._pathCursor.y]}getSeg(e){return[this.getPt(e),this.getPt(e+1)]}_nextPosition(e,r,i,s){if(this._currentPosition.isPathEnd)return!1;let n=this._currentPosition.abscissa;for(this._currentPosition.segmentLength>0&&(n/=this._currentPosition.segmentLength),this._currentPosition.copyTo(r);r.abscissa+e*this._partLengthRatio>r.segmentLength+this._tolerance;){if(i){if(i.pathSize===0)if(n===0){const a=r.segment[0];i.pushXY(a[0],a[1])}else i.pushPoint(this.getSegCoord2D(r.segment,n));const o=r.segment[1];i.pushXY(o[0],o[1])}if(n=0,e-=(r.segmentLength-r.abscissa)/this._partLengthRatio,this._partSegCount)r.segment=this._nextSegment(),r.segmentLength=this.getSegLength(r.segment),r.abscissa=0,this._partSegCount--;else{if(!this._setPosAtNextPart())return s!==Vu.FAIL&&(r.segmentLength=this.getSegLength(r.segment),r.isPartEnd=!0,s===Vu.END?(r.abscissa=r.segmentLength,r.isPathEnd=!0):r.abscissa=r.segmentLength+e,!0);this._currentPosition.copyTo(r)}}if(r.abscissa+=e*this._partLengthRatio,i){i.pathSize===0&&(n===0?i.pushPoint(r.segment[0]):i.pushPoint(this.getSegCoord2D(r.segment,n)));const o=r.abscissa/r.segmentLength;o===1?i.pushPoint(r.segment[1]):i.pushPoint(this.getSegCoord2D(r.segment,o))}return this._partSegCount||Math.abs(r.abscissa-r.segmentLength)<this._tolerance&&(r.isPathEnd=this._partIsLast,r.isPartEnd=!0),!0}_getPoint(e){const r=e.segmentLength<=0?0:e.abscissa/e.segmentLength;return this.getSegCoord2D(this._currentPosition.segment,r)}_getAngleCS(e,r){const i=r.segmentLength<=0?0:r.abscissa/r.segmentLength;return this.getSegAngleCS(e,this._currentPosition.segment,i)}_setPosAtNextPart(){for(;this._partSegCount;)this._hasNextSegment()&&this._nextSegment(),this._partSegCount--;if(!this._hasNextSegment())return!1;for(this._partLength=0,this._partIsLast=!0,this._partSegCount=0;this._hasNextSegment();)if(this._partLength+=this.getSegLength(this._nextSegment()),this._partSegCount++,this._pathCursor.getControlPointAt(this._getEndPointIndex())){this._partIsLast=!this._hasNextSegment();break}let e=this._partSegCount;for(;e;)this._previousSegment(),--e;this._currentPosition.segment=this._nextSegment(),this._currentPosition.segmentLength=this.getSegLength(this._currentPosition.segment),this._currentPosition.abscissa=0,this._currentPosition.isPathEnd=this._currentPosition.isPartEnd=!1,--this._partSegCount;const r=this._getStartPointIndex();this._ctrlPtBegin=this._pathCursor.getControlPointAt(r);let i=r+this._partSegCount+1;if(i>=this._pathCursor.pathSize&&(i=0),this._ctrlPtEnd=this._pathCursor.getControlPointAt(i),this._patternLength>0){const s=this._ctrlPtBegin?this._partCtrlPtGap:this._partExtPtGap,n=this._ctrlPtEnd?this._partCtrlPtGap:this._partExtPtGap;let o=Math.round((this._partLength-(s+n))/this._patternLength);o<=0&&(o=s+n>0?0:1),this._partLengthRatio=this._partLength/(s+n+o*this._patternLength),this._partLengthRatio<.01&&(this._partLengthRatio=1)}else this._partLengthRatio=1;return!0}_hasNextSegment(){return this._seg<this._pathCursor.pathSize-2}_previousSegment(){return this.getSeg(--this._seg)}_nextSegment(){return this.getSeg(++this._seg)}_getStartPointIndex(){return this._seg}_getEndPointIndex(){return this._seg+1}};var Yo;let eTe=(Yo=class{static local(){return Yo.instance===null&&(Yo.instance=new Yo),Yo.instance}execute(e,r,i,s,n){return new tTe(e,r,i)}},Yo.instance=null,Yo),tTe=class extends Ym{constructor(e,r,i){super(e,!0,!0),this._firstCurve=null,this._walker=new ex,this._walker.updateTolerance(i),this._endings=r.lineDashEnding,this._customDashPos=-(r.offsetAlongLine??0)*i,this._offsetAtEnd=(r.customEndingOffset??0)*i;let s=gH(r).dashTemplate;s==null&&(s=[]),s.length%2&&(s=[...s,...s]),this._pattern=new Q2,this._pattern.init(s,!0),this._pattern.scale(i)}processPath(e){if(this._pattern.length()===0){this.iteratePath=!1;const s=Qu(e);return rt.fromJSONCIM({paths:[s]})}if(!this.iteratePath){let s=!0;switch(this._endings){case Qr.HalfPattern:case Qr.HalfGap:default:this._pattern.extPtGap=0;break;case Qr.FullPattern:this.isClosed||(this._pattern.extPtGap=.5*this._pattern.firstValue());break;case Qr.FullGap:this.isClosed||(this._pattern.extPtGap=.5*this._pattern.lastValue());break;case Qr.NoConstraint:this.isClosed||(s=!1);break;case Qr.Custom:this.isClosed||(this._pattern.extPtGap=.5*this._offsetAtEnd)}const n=e.pathLength();if(this._pattern.isEmpty()||n<.1*this._pattern.length()){const o=Qu(e);return rt.fromJSONCIM({paths:[o]})}if(!this._walker.init(e,this._pattern,s)){const o=Qu(e);return rt.fromJSONCIM({paths:[o]})}}let r;if(this.iteratePath)r=this._pattern.nextValue();else{let s;switch(this._endings){case Qr.HalfPattern:default:s=.5*this._pattern.firstValue();break;case Qr.HalfGap:s=.5*-this._pattern.lastValue();break;case Qr.FullGap:s=-this._pattern.lastValue();break;case Qr.FullPattern:s=0;break;case Qr.NoConstraint:case Qr.Custom:s=-this._customDashPos}let n=s/this._pattern.length();n-=Math.floor(n),s=n*this._pattern.length(),this._pattern.reset(),r=this._pattern.nextValue();let o=!1;for(;s>=r;)s-=r,r=this._pattern.nextValue(),o=!o;r-=s,o?(this._walker.nextPosition(r),r=this._pattern.nextValue()):this.isClosed&&(this._firstCurve=this._walker.nextCurve(r),r=this._pattern.nextValue(),this._walker.nextPosition(r),r=this._pattern.nextValue())}let i=this._walker.nextCurve(r);if(i)if(this._walker.isPathEnd()){if(this.iteratePath=!1,this._firstCurve){for(this._firstCurve.nextPath();this._firstCurve.nextPoint();)i.pushXY(this._firstCurve.x,this._firstCurve.y);this._firstCurve=null}}else r=this._pattern.nextValue(),!this._walker.nextPosition(r)||this._walker.isPathEnd()?(this.iteratePath=!1,this._firstCurve&&(i.pushCursor(this._firstCurve),this._firstCurve=null)):this.iteratePath=!0;else this.iteratePath=!1,i=this._firstCurve,this._firstCurve=null;return i?.reset(),i}};var Xo;let rTe=(Xo=class{static local(){return Xo.instance===null&&(Xo.instance=new Xo),Xo.instance}execute(e,r,i,s,n,o,a){return new iTe(e,r,i,s,n,o,a)}},Xo.instance=null,Xo),iTe=class{constructor(e,r,i,s,n,o,a){switch(this._preventClipping=a,this._inputGeometries=e,this._tileKey=s,this._geometryEngine=n,this._maxInflateSize=o*i,this._width=(r.width!==void 0?r.width:2)*i,r.method){case Ch.Mitered:case Ch.Bevelled:case Ch.Rounded:case Ch.TrueBuffer:case Ch.Square:}this._option=r.option}next(){let e;for(;e=this._inputGeometries.next();){if(e.geometryType==="esriGeometryEnvelope"&&this._width>0){const r=e.asJSON();return Math.min(r.xmax-r.xmin,r.ymax-r.ymin)-2*this._width<0?e:rt.fromJSONCIM({paths:[[[r.xmin+this._width,r.ymin+this._width],[r.xmax-this._width,r.ymin+this._width],[r.xmax-this._width,r.ymax-this._width],[r.xmin+this._width,r.ymax-this._width],[r.xmin+this._width,r.ymin+this._width]],[[r.xmin,r.ymin],[r.xmin,r.ymax],[r.xmax,r.ymax],[r.xmax,r.ymin],[r.xmin,r.ymin]]]})}if(e.geometryType==="esriGeometryPolygon"){if(this._width===0)return e.clone();const r=this._geometryEngine;if(r==null)return null;const i=!this._preventClipping&&this._tileKey?yL(e,this._maxInflateSize,!0):e.clone();if(!i)continue;const s=r.buffer(ne.WebMercator,i.asJSON(),-this._width,1);if(s){for(const n of s.rings)if(n){i.startPath();for(const o of n.reverse())i.pushXY(o[0],i.yFactor*o[1])}}return i}}return null}};var Ko;let sTe=(Ko=class{static local(){return Ko.instance===null&&(Ko.instance=new Ko),Ko.instance}execute(e,r,i,s,n){return new nTe(e,r,i,n)}},Ko.instance=null,Ko),nTe=class{constructor(e,r,i,s){this._inputGeometries=e,this._medhod=r.method,this._geometryEngine=s}next(){let e=this._inputGeometries.next();const r=this._medhod;for(;e!=null;){if(e.totalSize>0)switch(r){case gS.RectangularBox:return oTe(e);case gS.ConvexHull:return this._constructConvexHull(e);default:return aTe(e)}e=this._inputGeometries.next()}return null}_constructConvexHull(e){switch(e.geometryType){case"esriGeometryPolyline":case"esriGeometryPolygon":{const r=this._geometryEngine;if(r==null)return null;const i=r.convexHull(ne.WebMercator,e.asJSON());return i?rt.fromJSONCIM(i):null}case"esriGeometryEnvelope":return e;default:return null}}};function oTe(t){const e=Iv(t),r={xmin:e[0],ymin:e[1],xmax:e[2],ymax:e[3]};return rt.fromJSONCIM(r)}function aTe(t){switch(t.geometryType){case"esriGeometryPolyline":{const e=[];for(;t.nextPath();)lTe(t,e);return rt.fromJSONCIM({rings:e})}case"esriGeometryPolygon":case"esriGeometryEnvelope":return t;default:return null}}function lTe(t,e){if(t.seekPathStart(),!t.nextPoint())return;const r=t.x,i=t.y,s=[[r,i]];for(e.push(s);t.nextPoint();)s.push([t.x,t.y]);s.push([r,i])}var Qo;let uTe=(Qo=class{static local(){return Qo.instance===null&&(Qo.instance=new Qo),Qo.instance}execute(e,r,i,s,n){return new cTe(e,r,i)}},Qo.instance=null,Qo),cTe=class extends Ym{constructor(e,r,i){super(e,!1,!0),this._curveHelper=new Hl,this._length=(r.length!==void 0?r.length:20)*i,this._angle=r.angle!==void 0?r.angle:225,this._position=r.position!==void 0?r.position:50,this._length<0&&(this._length=-this._length),this._position<20&&(this._position=20),this._position>80&&(this._position=80),this._mirror=!1}processPath(e){const r=rt.createEmptyOptimizedCIM("esriGeometryPolyline");if(this._curveHelper.isEmpty(e))return null;e.seekInPath(0);const i=e.x,s=e.y;e.seekInPath(e.pathSize-1);const n=e.x,o=e.y,a=[n-i,o-s];this._curveHelper.normalize(a);const l=i+(n-i)*this._position/100,u=s+(o-s)*this._position/100,h=Math.cos((90-this._angle)/180*Math.PI);let p=Math.sin((90-this._angle)/180*Math.PI);this._mirror&&(p=-p),this._mirror=!this._mirror;const m=[l-this._length/2*h,u-this._length/2*p],y=[l+this._length/2*h,u+this._length/2*p];return r.pushPath([[i,s],m,y,[n,o]]),r}};var ea;let hTe=(ea=class{static local(){return ea.instance===null&&(ea.instance=new ea),ea.instance}execute(e,r,i,s,n){return new dTe(e,r,i)}},ea.instance=null,ea),dTe=class{constructor(e,r,i){this._inputGeometries=e,this._offsetX=r.offsetX!==void 0?r.offsetX*i:0,this._offsetY=r.offsetY!==void 0?r.offsetY*i:0}next(){let e=this._inputGeometries.next();for(;e;){if(e.totalSize>0)return this._move(e.clone(),this._offsetX,this._offsetY);e=this._inputGeometries.next()}return null}_move(e,r,i){for(;e.nextPath();)for(;e.nextPoint();)e.x=e.x+r,e.y=e.y+i;return e.reset(),e}};const pTe=10;var ta;let fTe=(ta=class{static local(){return ta.instance===null&&(ta.instance=new ta),ta.instance}execute(e,r,i,s,n,o,a){return new mTe(e,r,i,s,n,o,a)}},ta.instance=null,ta),mTe=class{constructor(e,r,i,s,n,o,a){this._preventClipping=a,this._inputGeometries=e,this._tileKey=s,this._geometryEngine=n,this._curveHelper=new Hl,this._offset=(r.offset??1)*i,this._method=r.method,this._maxInflateSize=Math.max(Math.abs(o*i),pTe),this._option=r.option,this._offsetFlattenError=ov*i}next(){let e;for(;e=this._inputGeometries.next();){if(this._offset===0)return e.clone();if(e.geometryType==="esriGeometryEnvelope"){if(this._method===Cl.Rounded&&this._offset>0){const o=Qu(e),a=this._curveHelper.offset(o,-this._offset,this._method,4,this._offsetFlattenError);if(a){const l=rt.createEmptyOptimizedCIM(e.geometryType);return l.pushPath(a),l}return null}const n=e.asJSON();if(Ni(n)&&Math.min(n.xmax-n.xmin,n.ymax-n.ymin)+2*this._offset>0)return rt.fromJSONCIM({xmin:n.xmin-this._offset,xmax:n.xmax+this._offset,ymin:n.ymin-this._offset,ymax:n.ymax+this._offset})}const r=this._geometryEngine;if(r==null)continue;const i=!this._preventClipping&&this._tileKey?yL(e,this._maxInflateSize,!0):e.clone();if(!i)continue;const s=r.offset(ne.WebMercator,i.asJSON(),-this._offset,1,this._method,4,this._offsetFlattenError);return s?rt.fromJSONCIM(s):null}return null}};var ra;let yTe=(ra=class{static local(){return ra.instance===null&&(ra.instance=new ra),ra.instance}execute(e,r,i,s,n){return new gTe(e,r,i)}},ra.instance=null,ra),gTe=class{constructor(e,r,i){this._inputGeometries=e,this._length=(r.length!==void 0?r.length:ar.CIMGeometricEffectRadial.length)*i,this._angle=r.angle!==void 0?r.angle*Math.PI/180:ar.CIMGeometricEffectRadial.angle,this._lx=Math.cos(this._angle)*this._length,this._ly=Math.sin(this._angle)*this._length}next(){let e=this._inputGeometries.next();for(;e;){if(e.geometryType==="esriGeometryPoint"||e.geometryType==="esriGeometryMultipoint"){const r=rt.createEmptyOptimizedCIM("esriGeometryPolyline");return e.nextPath()&&e.nextPoint()&&r.pushPath([[e.x,e.y],[e.x+this._lx,e.y+this._ly]]),r}if(e.geometryType==="esriGeometryPolygon"){const r=sU(e);if(!r)return null;const i=rt.createEmptyOptimizedCIM("esriGeometryPolyline");return i.pushPath([[r[0],r[1]],[r[0]+this._lx,r[1]+this._ly]]),i}e=this._inputGeometries.next()}return null}};var ia;let vTe=(ia=class{static local(){return ia.instance===null&&(ia.instance=new ia),ia.instance}execute(e,r,i,s,n){return new _Te(e,r,i)}},ia.instance=null,ia),_Te=class{constructor(e,r,i){this._inputGeometries=e,this._reverse=r.reverse===void 0||r.reverse}next(){let e=this._inputGeometries.next();for(;e;){if(!this._reverse)return e;if(e.geometryType==="esriGeometryPolyline")return bTe(e.clone());e=this._inputGeometries.next()}return null}};function bTe(t){for(;t.nextPath();)for(let e=0;e<t.pathSize/2;e++){t.seekInPath(e);const r=t.x,i=t.y;t.seekInPath(t.pathSize-e-1);const s=t.x,n=t.y;t.x=r,t.y=i,t.seekInPath(e),t.x=s,t.y=n}return t.reset(),t}var sa;let wTe=(sa=class{static local(){return sa.instance===null&&(sa.instance=new sa),sa.instance}execute(e,r,i,s,n){return new STe(e,r,i)}},sa.instance=null,sa),STe=class{constructor(e,r,i){this._inputGeometries=e,this._rotateAngle=r.angle!==void 0?r.angle*Math.PI/180:0}next(){let e=this._inputGeometries.next();for(;e;){if(this._rotateAngle===0||e.geometryType==="esriGeometryPoint")return e;if(e.totalSize>0){const r=Iv(e),i=(r[2]+r[0])/2,s=(r[3]+r[1])/2;return e.reset(),this._rotate(e.clone(),i,s)}e=this._inputGeometries.next()}return null}_rotate(e,r,i){const s=Math.cos(this._rotateAngle),n=Math.sin(this._rotateAngle);for(;e.nextPath();)for(;e.nextPoint();){const o=e.x-r,a=e.y-i;e.x=r+o*s-a*n,e.y=i+o*n+a*s}return e.reset(),e}};var na;let xTe=(na=class{static local(){return na.instance===null&&(na.instance=new na),na.instance}execute(e,r,i,s,n){return new $Te(e,r,i)}},na.instance=null,na),$Te=class{constructor(e,r,i){this._inputGeometries=e,this._xFactor=r.xScaleFactor!==void 0?r.xScaleFactor:1.15,this._yFactor=r.yScaleFactor!==void 0?r.yScaleFactor:1.15}next(){const e=this._inputGeometries.next();if(e){if(this._xFactor===1&&this._yFactor===1||e.geometryType==="esriGeometryPoint")return e;if(e.totalSize>0){const r=Iv(e),i=(r[2]+r[0])/2,s=(r[3]+r[1])/2;return e.reset(),this._scaleCursor(e.clone(),i,s)}}return null}_scaleCursor(e,r,i){for(;e.nextPath();)for(;e.nextPoint();)e.x=r+(e.x-r)*this._xFactor,e.y=i+(e.y-i)*this._yFactor;return e.reset(),e}},FC=class{constructor(){this._polyline=[]}beginPath(e){this._polyline.push([e])}lineTo(e){if(this._polyline.length===0)throw new Error("No path started. Call beginPath first.");this._polyline[this._polyline.length-1].push(e)}getPointCount(){return this._polyline.reduce(((e,r)=>e+r.length),0)}addSegment(e,r,i){i&&this.beginPath(e),this.lineTo(r)}getXY(e){let r=0;for(const i of this._polyline){if(e<r+i.length)return i[e-r];r+=i.length}return null}getGeometry(){return this._polyline}};var oa;let MTe=(oa=class{static local(){return oa.instance===null&&(oa.instance=new oa),oa.instance}execute(e,r,i,s,n){return new TTe(e,r,i)}},oa.instance=null,oa),TTe=class extends Ym{constructor(e,r,i){super(e,!1,!0),this._suppress=r.suppress!==void 0&&r.suppress,this._invert=r.invert!==void 0&&r.invert}processPath(e){if(e.totalSize<=0)return null;if(!this._suppress){const y=rt.createEmptyOptimizedCIM("esriGeometryPolygon",!1,!1,e.yFactor);for(e.seekPathEnd();e.nextPoint();)y.pushXY(e.x,e.y);return y}const r=[],i=new Array(e.pathSize);let s=0;for(e.seekPathStart();e.nextPoint();)i[s++]=e.getControlPoint(),r.push([e.x,e.y]);let n=!0,o=!0,a=!1,l=!this._invert;s=0;const u=new FC;let h=r[0];for(;s<r.length;){const y=r[s+1],g=i[s],v=i[s+1];s++,o&&(l=g||v?this._invert:!this._invert,o=!1),l?(u.addSegment(h,y,n),n=!1):a=!0,h=y,v&&(l?(l=!1,n=!0):l=!0)}const p=u.getGeometry();if(p.length===0)return null;if(!a&&r[0][0]===r[r.length-1][0]&&r[0][1]===r[r.length-1][1]){const y=p[p.length-1];return y[0][0]===y[y.length-1][0]&&y[0][1]===y[y.length-1][1]||y.push([y[0][0],y[0][1]]),rt.fromJSONCIM({paths:p})}const m=p[p.length-1];return u.getPointCount()>1&&e.geometryType==="esriGeometryPolygon"&&m[0][0]===m[m.length-1][0]&&m[0][1]===m[m.length-1][1]&&p.length>1&&(p[p.length-1].push(...p[0]),p.splice(0,1)),rt.fromJSONCIM({paths:p})}};function O4(t,e,r){return t[0]=e[0]-r[0],t[1]=e[1]-r[1],t}function jW(t,e){return Math.sqrt(t*t+e*e)}function N4(t){const e=jW(t[0],t[1]);t[0]/=e,t[1]/=e}function ETe(t,e){return jW(t[0]-e[0],t[1]-e[1])}function ITe(t,e){return t[e+1]}function UW(t){return t.length-1}function CTe(t){let e=0;for(let r=0;r<UW(t);r++)e+=PTe(t,r);return e}function PTe(t,e,r=1){let[i,s]=ITe(t,e);return[i,s]=[Math.round(i),Math.round(s)],Math.sqrt(i*i+s*s)*r}let DC=class zC{constructor(e,r,i,s,n){this._segments=e,this._index=r,this._distance=i,this._xStart=s,this._yStart=n,this._done=!1}static create(e){return new zC(e,0,0,e[0][0],e[0][1])}clone(){return new zC(this._segments,this._index,this._distance,this.xStart,this.yStart)}equals(e){return this._index===e._index||e._index===this._index-1&&(this._distance===0||e._distance===1)||e._index===this._index+1&&(this._distance===1||e._distance===0)}leq(e){return this._index<e._index||this._index===e._index&&this._distance<=e._distance}geq(e){return this._index>e._index||this._index===e._index&&this._distance>=e._distance}get _segment(){return this._segments[this._index+1]}get angle(){const e=this.dy,r=(0*e+-1*-this.dx)/(1*this.length);let i=Math.acos(r);return e>0&&(i=2*Math.PI-i),i}get xStart(){return this._xStart}get yStart(){return this._yStart}get x(){return this.xStart+this.distance*this.dx}get y(){return this.yStart+this.distance*this.dy}get dx(){return this._segment[0]}get dy(){return this._segment[1]}get xMidpoint(){return this.xStart+.5*this.dx}get yMidpoint(){return this.yStart+.5*this.dy}get xEnd(){return this.xStart+this.dx}get yEnd(){return this.yStart+this.dy}get length(){const{dx:e,dy:r}=this;return Math.sqrt(e*e+r*r)}get remainingLength(){return this.length*(1-this._distance)}get backwardLength(){return this.length*this._distance}get distance(){return this._distance}get done(){return this._done}hasPrev(){return this._index-1>=0}hasNext(){return this._index+1<UW(this._segments)}next(){return this.hasNext()?(this._xStart+=this.dx,this._yStart+=this.dy,this._distance=0,this._index+=1,this):null}prev(){return this.hasPrev()?(this._index-=1,this._xStart-=this.dx,this._yStart-=this.dy,this._distance=1,this):(this._done=!0,null)}_seekBackwards(e,r){const i=this.backwardLength;if(e<=i)return this._distance=(i-e)/this.length,this;let s=this.backwardLength;for(;this.prev();){if(s+this.length>e)return this._seekBackwards(e-s);s+=this.length}return this._distance=0,r?this:null}seek(e,r=!1){if(e<0)return this._seekBackwards(Math.abs(e),r);if(e<=this.remainingLength)return this._distance=(this.backwardLength+e)/this.length,this;let i=this.remainingLength;for(;this.next();){if(i+this.length>e)return this.seek(e-i,r);i+=this.length}return this._distance=1,r?this:null}};function pVe(t,e,r,i=!0){const s=CTe(t),n=DC.create(t),o=s/2;if(!i)return n.seek(o),void(n.x<Qp&&n.y<Qp&&n.x>=0&&n.y>=0&&r(n.clone(),0,o+0*e,s));const a=Math.max((s-e)/2,0),l=Math.floor(a/e),u=o-l*e;n.seek(u);for(let h=-l;h<=l;h++)n.x<Qp&&n.y<Qp&&n.x>=0&&n.y>=0&&r(n.clone(),h,o+h*e,s),n.seek(e)}function fVe(t,e){const r=e;for(let i=0;i<t.length;i++){let s=t[i];ATe(s,r);const n=[];n.push(s[0]);for(let o=1;o<s.length;o++){const[a,l]=s[o-1],[u,h]=s[o],p=u-a,m=h-l;n.push([p,m])}t[i]=n,s=n}return t}function ATe(t,e){if(e<=0)return;const i=t.length;if(i<3)return;const s=[];let n=0;s.push(0);for(let p=1;p<i;p++)n+=ETe(t[p],t[p-1]),s.push(n);e=Math.min(e,.2*n);const o=[];o.push(t[0][0]),o.push(t[0][1]);const a=t[i-1][0],l=t[i-1][1],u=O4([0,0],t[0],t[1]);N4(u),t[0][0]+=e*u[0],t[0][1]+=e*u[1],O4(u,t[i-1],t[i-2]),N4(u),t[i-1][0]+=e*u[0],t[i-1][1]+=e*u[1];for(let p=1;p<i;p++)s[p]+=e;s[i-1]+=e;const h=.5*e;for(let p=1;p<i-1;p++){let m=0,y=0,g=0;for(let v=p-1;v>=0&&!(s[v+1]<s[p]-h);v--){const _=h+s[v+1]-s[p],b=s[v+1]-s[v],S=s[p]-s[v]<h?1:_/b;if(Math.abs(S)<1e-6)break;const $=S*S,T=S*_-.5*$*b,I=S*b/e,P=t[v+1],R=t[v][0]-P[0],D=t[v][1]-P[1];m+=I/T*(P[0]*S*_+.5*$*(_*R-b*P[0])-$*S*b*R/3),y+=I/T*(P[1]*S*_+.5*$*(_*D-b*P[1])-$*S*b*D/3),g+=I}for(let v=p+1;v<i&&!(s[v-1]>s[p]+h);v++){const _=h-s[v-1]+s[p],b=s[v]-s[v-1],S=s[v]-s[p]<h?1:_/b;if(Math.abs(S)<1e-6)break;const $=S*S,T=S*_-.5*$*b,I=S*b/e,P=t[v-1],R=t[v][0]-P[0],D=t[v][1]-P[1];m+=I/T*(P[0]*S*_+.5*$*(_*R-b*P[0])-$*S*b*R/3),y+=I/T*(P[1]*S*_+.5*$*(_*D-b*P[1])-$*S*b*D/3),g+=I}o.push(m/g),o.push(y/g)}o.push(a),o.push(l);for(let p=0,m=0;p<i;p++)t[p][0]=o[m++],t[p][1]=o[m++]}const Ay=()=>q.getLogger("esri.symbols.cim.effects.EffectTaperedPolygon");var aa;let LTe=(aa=class{static local(){return aa.instance===null&&(aa.instance=new aa),aa.instance}execute(e,r,i,s,n){return new RTe(e,r,i,s,n)}},aa.instance=null,aa),RTe=class extends Ym{constructor(e,r,i,s,n){super(e,!1,!0),this._slopeS=0,this._slopeC=1,this._lastTangent1=new Ne(NaN,NaN),this._lastWidth=0,this._tileKey=null,this._halfFromWidth=Math.abs(r.fromWidth!==void 0?r.fromWidth:0)*i*.5,this._halfToWidth=Math.abs(r.toWidth!==void 0?r.toWidth:1)*i*.5,this._originalLength=(r.length!==void 0?r.length:0)*i,this._length=0,this._tileKey=s,this._geometryEngine=n}processPath(e){if(e.totalSize<=0)return null;if(this._halfFromWidth<=0&&this._halfToWidth<=0){const g=rt.createEmptyOptimizedCIM("esriGeometryPolygon",!1,!1,e.yFactor);for(e.seekPathEnd();e.prevPoint();)g.pushXY(e.x,e.y);for(e.seekPathStart();e.nextPoint();)g.pushXY(e.x,e.y);return g}const r=[];e.seekPathStart();let i=0,s=0;for(;e.nextPoint();)r.push([e.x-i,e.y-s]),i=e.x,s=e.y;let n=this._geometryEngine?.simplify(ne.WebMercator,{paths:[r]});n||this._tileKey!=null||(n={paths:[r]});const o=rr(n)?n.rings:ri(n)?n.paths:null;if(!o)return Ay().error(new F("mapview-bad-resource","Unable to process geometry")),null;const a=new FC,l=new FC;let u=0;for(const g of o){i=g[0][0],s=g[0][1];for(let v=1;v<g.length;v++){const _=i+g[v][0],b=s+g[v][1];u+=Math.sqrt((_-i)*(_-i)+(b-s)*(b-s)),i=_,s=b}}if(this._originalLength===0||this._originalLength>u){this._length=u;const g=(this._halfToWidth-this._halfFromWidth)/this._length;if(Math.abs(g)<1){const v=g*g;this._slopeC=Math.sqrt(1/(1+v)),this._slopeS=Math.sqrt(v/(1+v)),g<0&&(this._slopeS=-this._slopeS)}else this._slopeC=this._slopeS=.7071}else this._length=this._originalLength,this._slopeC=1,this._slopeS=0;let h=0;const p=[];for(const g of o){const v=DC.create(g),_=DC.create(g);this._setFromOffset(_,a,l);let b=_.next(),S=v;for(;b&&S;)h=this._setOffset(S,b,h,a,l),S=v.next(),b=_.next();S=v,S&&this._setToOffset(S,h,a,l);const $=a.getGeometry(),T=l.getGeometry(),I=[];for(const P of $)I.push(...P);for(let P=T.length-1;P>=0;P--){const R=T[P];for(let D=R.length-1;D>=0;D--)I.push(R[D])}p.push(I)}const m={rings:p};Zse(m);let y=this._geometryEngine?.simplify(ne.WebMercator,m);if(!y){if(this._tileKey!=null)return null;y=m}return rt.fromJSONCIM(y)}_setFromOffset(e,r,i){const s=this._halfFromWidth,n=new Ne(e.xEnd-e.xStart,e.yEnd-e.yStart);n.normalize(),n.scale(s),r.beginPath([e.xStart-n.y,e.yStart+n.x]),i.beginPath([e.xStart+n.y,e.yStart-n.x])}_setToOffset(e,r,i,s){let n;n=(r+=Math.sqrt((e.xEnd-e.xStart)*(e.xEnd-e.xStart)+(e.yEnd-e.yStart)*(e.yEnd-e.yStart)))>=this._length?this._halfToWidth:this._halfFromWidth+(this._halfToWidth-this._halfFromWidth)*r/this._length;const o=new Ne(e.xEnd-e.xStart,e.yEnd-e.yStart);o.normalize(),o.scale(n),i.lineTo([e.xEnd-o.y,e.yEnd+o.x]),s.lineTo([e.xEnd+o.y,e.yEnd-o.x])}_setOffset(e,r,i,s,n){const o=Math.sqrt((e.xEnd-e.xStart)*(e.xEnd-e.xStart)+(e.yEnd-e.yStart)*(e.yEnd-e.yStart));let a;a=i+o>=this._length?this._halfToWidth:this._halfFromWidth+(this._halfToWidth-this._halfFromWidth)*(i+o)/this._length,i+=o;const l=new Ne(e.xEnd,e.yEnd),u=new Ne(e.xEnd-e.xStart,e.yEnd-e.yStart);u.normalize();const h=new Ne(r.xEnd-r.xStart,r.yEnd-r.yStart);h.normalize();const p=u.x*h.y-u.y*h.x;let m;m=Math.abs(p)===0?new Ne(h.x,h.y):new Ne((h.x-u.x)/p,(h.y-u.y)/p);const y=s.getPointCount(),g=n.getPointCount();u.leftPerpendicular(),h.leftPerpendicular();const v=u.x*h.x+u.y*h.y;if(v>.99){const _=new Ne((u.x+h.x)*a/2,(u.y+h.y)*a/2),b=_.clone();b.rotate(this._slopeC,this._slopeS),s.lineTo([l.x+b.x,l.y+b.y]);const S=_.clone();S.rotateReverse(this._slopeC,this._slopeS),n.lineTo([l.x-S.x,l.y-S.y])}else{if(p<0){const I=m.clone().scale(-a);I.rotateReverse(this._slopeC,this._slopeS);const P=n.getXY(g-1);P||Ay().error(new F("mapview-bad-resource","Unable to process geometry, index out of scope"));const R=Ne.add(l,I),D=Ne.sub(R,Ne.fromArray(P));if(u.x*D.y-u.y*D.x>0){const V=new Ne(-u.x*a,-u.y*a);V.rotateReverse(this._slopeC,this._slopeS);const U=new Ne(-h.x*a,-h.y*a);U.rotateReverse(this._slopeC,this._slopeS),n.lineTo([l.x+V.x,l.y+V.y]),n.lineTo([l.x,l.y]),n.lineTo([l.x+U.x,l.y+U.y])}else n.lineTo([l.x+I.x,l.y+I.y])}else{const I=m.clone().scale(a);I.rotate(this._slopeC,this._slopeS);const P=s.getXY(y-1);P||Ay().error(new F("mapview-bad-resource","Unable to process geometry, index out of scope"));const R=Ne.add(l,I),D=Ne.sub(R,Ne.fromArray(P));if(u.x*D.y-u.y*D.x>0){const V=u.clone().scale(a);V.rotate(this._slopeC,this._slopeS);const U=h.clone().scale(a);U.rotate(this._slopeC,this._slopeS),s.lineTo([l.x+V.x,l.y+V.y]),s.lineTo([l.x,l.y]),s.lineTo([l.x+U.x,l.y+U.y])}else s.lineTo([l.x+I.x,l.y+I.y])}const _=Math.acos(v);let b=1;if(a>.25){const I=2*Math.acos(1-.25/a);I<_&&(b=Math.round(_/I))}const S=Math.cos(_/b),$=Math.sin(_/b),T=u.clone();if(p<0){T.rotate(this._slopeC,this._slopeS);const I=s.getXY(y-1);I||Ay().error(new F("mapview-bad-resource","Unable to process geometry, index out of scope"));const P=Ne.add(l,T.clone().scale(this._lastWidth)),R=Ne.sub(P,Ne.fromArray(I)),D=u.x*R.y-u.y*R.x;if(!isNaN(this._lastTangent1.x)&&!isNaN(this._lastTangent1.y)&&D>0){const V=new Ne(e.xStart,e.yStart),U=this._lastTangent1.clone().scale(this._lastWidth);U.rotate(this._slopeC,this._slopeS);const Z=u.clone().scale(this._lastWidth);Z.rotate(this._slopeC,this._slopeS),s.lineTo([V.x+U.x,V.y+U.y]),s.lineTo([V.x,V.y]),s.lineTo([V.x+Z.x,V.y+Z.y])}}else{T.scale(-1).rotateReverse(this._slopeC,this._slopeS);const I=n.getXY(g-1);I||Ay().error(new F("mapview-bad-resource","Unable to process geometry, index out of scope"));const P=Ne.add(l,T.clone().scale(this._lastWidth)),R=Ne.sub(P,Ne.fromArray(I)),D=u.x*R.y-u.y*R.x;if(!isNaN(this._lastTangent1.x)&&!isNaN(this._lastTangent1.y)&&D>0){const V=new Ne(e.xStart,e.yStart),U=this._lastTangent1.clone().scale(-this._lastWidth);U.rotateReverse(this._slopeC,this._slopeS);const Z=u.clone().scale(-this._lastWidth);Z.rotateReverse(this._slopeC,this._slopeS),n.lineTo([V.x+U.x,V.y+U.y]),n.lineTo([V.x,V.y]),n.lineTo([V.x+Z.x,V.y+Z.y])}}T.scale(a);for(let I=0;I<=b;I++)p<0?(s.lineTo([l.x+T.x,l.y+T.y]),T.rotateReverse(S,$)):(n.lineTo([l.x+T.x,l.y+T.y]),T.rotate(S,$))}return this._lastTangent1.setCoords(u.x,u.y),this._lastWidth=a,i}};var la;let kTe=(la=class{static local(){return la.instance===null&&(la.instance=new la),la.instance}execute(e,r,i,s,n){return new OTe(e,r,i)}},la.instance=null,la),OTe=class{constructor(e,r,i){this._inputGeometries=e,this._height=(r.amplitude!==void 0?r.amplitude:2)*i,this._period=(r.period!==void 0?r.period:3)*i,this._style=r.waveform,this._height<=0&&(this._height=Math.abs(this._height)),this._period<=0&&(this._period=Math.abs(this._period)),this._pattern=new Q2,this._pattern.addValue(this._period),this._pattern.addValue(this._period),this._walker=new ex,this._walker.updateTolerance(i)}next(){let e=this._inputGeometries.next();for(;e;){if(this._height===0||this._period===0)return e;const r=this._processGeom(e);if(r)return r;e=this._inputGeometries.next()}return null}_processGeom(e){const r=rt.createEmptyOptimizedCIM(e.geometryType);for(;e.nextPath();){r.startPath();const i=e.pathLength();if(this._walker.init(e,this._pattern))switch(this._style){case of.Sinus:default:this._constructCurve(r,i,!1);break;case of.Square:this._constructSquare(r,i);break;case of.Triangle:this._constructTriangle(r,i);break;case of.Random:this._constructCurve(r,i,!0)}else for(;e.nextPoint();)r.pushXY(e.x,e.y)}return r}_constructCurve(e,r,i){let s=Math.round(r/this._period);s===0&&(s=1);const n=s*16+1,o=r/s,a=this._period/16,l=1/n,u=2*Math.PI*r/o,h=2*Math.PI*Math.random(),p=2*Math.PI*Math.random(),m=2*Math.PI*Math.random(),y=.75-Math.random()/2,g=.75-Math.random()/2,v=new fl;this._walker.curPointAndAngle(v),e.pushPoint(v.pt);let _=0;for(;;){if(!this._walker.nextPointAndAngle(a,v)){e.pushPoint(this._walker.getPathEnd());break}{const b=_;let S;if(_+=l,i){const $=this._height/2*(1+.3*Math.sin(y*u*b+h));S=$*Math.sin(u*b+p),S+=$*Math.sin(g*u*b+m),S/=2}else S=.5*this._height*Math.sin(.5*u*b);e.pushXY(v.pt[0]-S*v.sa,v.pt[1]+S*v.ca)}}}_constructSquare(e,r){Math.round(r/this._period);let i=!0;for(;;){let s=!1;if(this._walker.curPositionIsValid()){const n=new fl;this._walker.curPointAndAngle(n);const o=new fl;if(this._walker.nextPointAndAngle(this._period,o)){const a=new fl;this._walker.nextPointAndAngle(this._period,a)&&(i?(e.pushPoint(n.pt),i=!1):e.pushPoint(n.pt),e.pushXY(n.pt[0]-this._height/2*n.sa,n.pt[1]+this._height/2*n.ca),e.pushXY(o.pt[0]-this._height/2*o.sa,o.pt[1]+this._height/2*o.ca),e.pushXY(o.pt[0]+this._height/2*o.sa,o.pt[1]-this._height/2*o.ca),e.pushXY(a.pt[0]+this._height/2*a.sa,a.pt[1]-this._height/2*a.ca),s=!0)}}if(!s){e.pushPoint(this._walker.getPathEnd());break}}}_constructTriangle(e,r){Math.round(r/this._period);let i=!0;for(;;){let s=!1;if(this._walker.curPositionIsValid()){const n=new fl;this._walker.curPointAndAngle(n);const o=new fl;if(this._walker.nextPointAndAngle(this._period/2,o)){const a=new fl;this._walker.nextPointAndAngle(this._period,a)&&(this._walker.nextPosition(this._period/2)&&(i?(e.pushPoint(n.pt),i=!1):e.pushPoint(n.pt),e.pushXY(o.pt[0]-this._height/2*o.sa,o.pt[1]+this._height/2*o.ca),e.pushXY(a.pt[0]+this._height/2*a.sa,a.pt[1]-this._height/2*a.ca)),s=!0)}}if(!s){e.pushPoint(this._walker.getPathEnd());break}}}};var ua;let NTe=(ua=class{static local(){return ua.instance===null&&(ua.instance=new ua),ua.instance}execute(e,r,i,s,n){return new FTe(e,r,i)}},ua.instance=null,ua),FTe=class extends Zv{constructor(e,r,i){super(e),this._geometryWalker=new ex,this._geometryWalker.updateTolerance(i),this._angleToLine=r.angleToLine??!0,this._offset=(r.offset?r.offset:0)*i,this._originalEndings=r.endings,this._offsetAtEnd=(r.customEndingOffset?r.customEndingOffset:0)*i,this._position=-(r.offsetAlongLine?r.offsetAlongLine:0)*i,this._pattern=new Q2,this._pattern.init(r.placementTemplate,!1),this._pattern.scale(i),this._endings=this._originalEndings}processPath(e){if(this._pattern.isEmpty())return null;let r;if(this.iteratePath)r=this._pattern.nextValue();else{this._originalEndings===Un.WithFullGap&&this.isClosed?this._endings=Un.WithMarkers:this._endings=this._originalEndings,this._pattern.extPtGap=0;let s,n=!0;switch(this._endings){case Un.NoConstraint:s=-this._position,s=this._adjustPosition(s),n=!1;break;case Un.WithHalfGap:default:s=-this._pattern.lastValue()/2;break;case Un.WithFullGap:s=-this._pattern.lastValue(),this._pattern.extPtGap=this._pattern.lastValue();break;case Un.WithMarkers:s=0;break;case Un.Custom:s=-this._position,s=this._adjustPosition(s),this._pattern.extPtGap=.5*this._offsetAtEnd}if(!this._geometryWalker.init(e,this._pattern,n))return null;this._pattern.reset();let o=0;for(;s>o;)s-=o,o=this._pattern.nextValue();o-=s,r=o,this.iteratePath=!0}const i=new fl;return this._geometryWalker.nextPointAndAngle(r,i)?this._endings===Un.WithFullGap&&this._geometryWalker.isPathEnd()?(this.iteratePath=!1,null):this._endings===Un.WithMarkers&&this._geometryWalker.isPathEnd()&&(this.iteratePath=!1,this.isClosed)?null:(this.internalPlacement.setTranslate(i.pt[0]-this._offset*i.sa,i.pt[1]+this._offset*i.ca),this._angleToLine&&this.internalPlacement.setRotateCS(i.ca,i.sa),this.internalPlacement):(this.iteratePath=!1,null)}_adjustPosition(e){let r=e/this._pattern.length();return r-=Math.floor(r),r*this._pattern.length()}};var ca;let DTe=(ca=class{static local(){return ca.instance===null&&(ca.instance=new ca),ca.instance}execute(e,r,i,s,n){return new zTe(e,r,i)}},ca.instance=null,ca),zTe=class extends Zv{constructor(e,r,i){super(e,!1,!0),this._curveHelper=new Hl,this._placePerPart=r.placePerPart??!1,this._angleToLine=r.angleToLine===void 0||r.angleToLine,this._offset=r.offset!==void 0?r.offset*i:0,this._type=r.extremityPlacement,this._position=r.offsetAlongLine!==void 0?r.offsetAlongLine*i:0,this._beginProcessed=!1}processMultiPath(e){return this._placePerPart?super.processMultiPath(e):this.processPath(e)}processPath(e){let r;switch(this._type){case ya.Both:default:this._beginProcessed?(r=this._atExtremities(e,this._position,!1),this._beginProcessed=!1,this.iterateMultiPath=!1,this.iteratePath=!1):(r=this._atExtremities(e,this._position,!0),this._beginProcessed=!0,this.iterateMultiPath=!0,this.iteratePath=!0);break;case ya.JustBegin:r=this._atExtremities(e,this._position,!0);break;case ya.JustEnd:r=this._atExtremities(e,this._position,!1);case ya.None:}return r}_atExtremities(e,r,i){if(this._placePerPart||(i?e.seekPath(0):e.seekPath(e.totalSize-1)),i||e.seekPathEnd(),i?e.nextPoint():e.prevPoint()){let s=0,[n,o]=[0,0],[a,l]=[e.x,e.y];const u=[0,0];for(;i?e.nextPoint():e.prevPoint();){n=a,o=l,a=e.x,l=e.y;const h=this._curveHelper.getLength(n,o,a,l);if(s+h>r){const p=(r-s)/h,[m,y]=this._curveHelper.getAngleCS(u,n,o,a,l,p),g=this._curveHelper.getCoord2D(n,o,a,l,p);return this.internalPlacement.setTranslate(g[0]-this._offset*y,g[1]+this._offset*m),this._angleToLine&&this.internalPlacement.setRotateCS(-m,-y),this.internalPlacement}s+=h}}return null}};var ha;let VTe=(ha=class{static local(){return ha.instance===null&&(ha.instance=new ha),ha.instance}execute(e,r,i,s,n){return new jTe(e,r,i)}},ha.instance=null,ha),jTe=class extends Zv{constructor(e,r,i){super(e),this._walker=new ex,this._walker.updateTolerance(i),this._angleToLine=r.angleToLine===void 0||r.angleToLine,this._offset=r.offset!==void 0?r.offset*i:0,this._beginGap=r.beginPosition!==void 0?r.beginPosition*i:0,this._endGap=r.endPosition!==void 0?r.endPosition*i:0,this._flipFirst=r.flipFirst===void 0||r.flipFirst,this._pattern=new Q2,this._pattern.init(r.positionArray,!1,!1),this._subPathLen=0,this._posCount=this._pattern.size(),this._isFirst=!0,this._prevPos=0}processPath(e){if(this._pattern.isEmpty())return null;let r;if(this.iteratePath){const a=this._pattern.nextValue()*this._subPathLen,l=this._beginGap+a;r=l-this._prevPos,this._prevPos=l}else{if(this._posCount=this._pattern.size(),this._isFirst=!0,this._prevPos=0,this._subPathLen=e.pathLength()-this._beginGap-this._endGap,this._subPathLen<0)return this.iteratePath=!1,null;if(!this._walker.init(e,this._pattern,!1))return null;this._pattern.reset();const a=this._pattern.nextValue()*this._subPathLen,l=this._beginGap+a;r=l-this._prevPos,this._prevPos=l,this.iteratePath=!0}const i=new fl;if(!this._walker.nextPointAndAngle(r,i,Vu.END))return this.iteratePath=!1,null;this.internalPlacement.setTranslate(i.pt[0]-this._offset*i.sa,i.pt[1]+this._offset*i.ca);const s=this._isFirst&&this._flipFirst;let n,o;return this._angleToLine?(n=i.ca,o=i.sa):(n=1,o=0),s&&(n=-n,o=-o),this.internalPlacement.setRotateCS(n,o),this._isFirst=!1,this._posCount--,this._posCount===0&&(this.iteratePath=!1),this.internalPlacement}};const Ly=512,UTe=10,yo=24,AS=1e-6;var da;let GTe=(da=class{static local(){return da.instance===null&&(da.instance=new da),da.instance}execute(e,r,i,s,n){return new BTe(e,r,i,s,n)}},da.instance=null,da),BTe=class lh{constructor(e,r,i,s,n){if(this._xMin=0,this._xMax=0,this._yMin=0,this._yMax=0,this._currentX=0,this._currentY=0,this._accelerationMap=null,this._testInsidePolygon=!1,this._verticalSubdivision=!0,this._stepX=Math.abs(r.stepX??16)*i,this._stepY=Math.abs(r.stepY??16)*i,this._stepX=Math.round(128*this._stepX)/128,this._stepY=Math.round(128*this._stepY)/128,this._stepX!==0&&this._stepY!==0){if(this._gridType=r.gridType??g0.Fixed,this._gridType===g0.Random){const o=r.seed??13,a=1;this._randomLCG=new RP(o*a),this._randomness=(r.randomness??100)/100,this._gridAngle=0,this._shiftOddRows=!1,this._cosAngle=1,this._sinAngle=0,this._offsetX=0,this._offsetY=0,this._buildRandomValues()}else{if(this._randomness=0,this._gridAngle=r.gridAngle??0,this._shiftOddRows=r.shiftOddRows??!1,this._offsetX=(r.offsetX??0)*i,this._offsetY=(r.offsetY??0)*i,this._cosAngle=Math.cos(this._gridAngle/180*Math.PI),this._sinAngle=-Math.sin(this._gridAngle/180*Math.PI),this._stepX)if(this._offsetX<0)for(;this._offsetX<-.5*this._stepX;)this._offsetX+=this._stepX;else for(;this._offsetX>=.5*this._stepX;)this._offsetX-=this._stepX;if(this._stepY)if(this._offsetY<0)for(;this._offsetY<-.5*this._stepY;)this._offsetY+=this._stepY;else for(;this._offsetY>=.5*this._stepY;)this._offsetY-=this._stepY}if(this._graphicOriginX=0,this._graphicOriginY=0,s!=null){const[o,a,l,u]=s.split("/"),h=parseFloat(o),p=parseFloat(a),m=parseFloat(l),y=parseFloat(u);this._graphicOriginX=-(y*2**h+m)*Ly,this._graphicOriginY=p*Ly,this._testInsidePolygon=!0}this._internalPlacement=new Jm,this._calculateMinMax(e),this._geometryCursor=e}}next(){return this._geometryCursor?this._nextInside():null}_buildRandomValues(){if(!lh._randValues){lh._randValues=[];for(let e=0;e<yo;e++)for(let r=0;r<yo;r++)lh._randValues.push(this._randomLCG.getFloat()),lh._randValues.push(this._randomLCG.getFloat())}}_calculateMinMax(e){let r,i,s,n,o,a,l,u,h,p,m,y,g,v;this._xMin=0,this._xMax=0,this._yMin=0,this._yMax=0,l=u=g=m=Number.MAX_VALUE,h=p=v=y=-Number.MAX_VALUE;const _=this._cosAngle!==1;for(e.reset();e.nextPath();)for(;e.nextPoint();)a=e.x,o=e.y,r=a-this._graphicOriginX-this._offsetX,i=o-this._graphicOriginY-this._offsetY,_?(s=this._cosAngle*r-this._sinAngle*i,n=this._sinAngle*r+this._cosAngle*i):(s=r,n=i),l=Math.min(l,s),h=Math.max(h,s),u=Math.min(u,n),p=Math.max(p,n),m=Math.min(m,o),y=Math.max(y,o),g=Math.min(g,a),v=Math.max(v,a);m=m!==Number.MAX_VALUE?m:-512-this._stepY,y=y!==-Number.MAX_VALUE?y:this._stepY,g=g!==Number.MAX_VALUE?g:-this._stepX,v=v!==-Number.MAX_VALUE?v:Ly+this._stepX;const b=y-m,S=v-g;if(this._verticalSubdivision=b>=S,this._polygonMin=this._verticalSubdivision?m:g,this._testInsidePolygon){let $=0-this._graphicOriginX-this._offsetX-this._stepX,T=Ly-this._graphicOriginX-this._offsetX+this._stepX,I=-512-this._graphicOriginY-this._offsetY-this._stepY,P=0-this._graphicOriginY-this._offsetY+this._stepY;if(_){const R=[[$,I],[$,P],[T,I],[T,P]];$=I=Number.MAX_VALUE,T=P=-Number.MAX_VALUE;for(const D of R){const V=this._cosAngle*D[0]-this._sinAngle*D[1],U=this._sinAngle*D[0]+this._cosAngle*D[1];$=Math.min($,V),T=Math.max(T,V),I=Math.min(I,U),P=Math.max(P,U)}}l=l!==Number.MAX_VALUE?Math.max(l,$):$,u=u!==Number.MAX_VALUE?Math.max(u,I):I,h=h!==-Number.MAX_VALUE?Math.min(h,T):T,p=p!==-Number.MAX_VALUE?Math.min(p,P):P}this._xMin=Math.round(l/this._stepX),this._xMax=Math.round(h/this._stepX),this._yMin=Math.round(u/this._stepY),this._yMax=Math.round(p/this._stepY),this._currentX=this._xMax+1,this._currentY=this._yMin-1,this._buildAccelerationMap(e,g,v,m,y)}_buildAccelerationMap(e,r,i,s,n){e.reset();const o=new Map,a=this._verticalSubdivision,l=a?n-s:i-r;let u=Math.ceil(l/UTe);if(u<=1)return;const h=Math.floor(l/u);let p,m,y,g,v,_,b,S,$,T,I;for(u++,this._delta=h,a?($=-512-2*this._stepY,T=2*this._stepY,I=s):($=-2*this._stepX,T=Ly+2*this._stepX,I=r);e.nextPath();)if(!(e.pathSize<2)&&e.nextPoint())for(p=e.x,m=e.y;e.nextPoint();p=y,m=g){if(y=e.x,g=e.y,a){if(m===g||m<$&&g<$||m>T&&g>T)continue;v=Math.min(m,g),_=Math.max(m,g)}else{if(p===y||p<$&&y<$||p>T&&y>T)continue;v=Math.min(p,y),_=Math.max(p,y)}for(;v<_;)b=Math.floor((v-I)/h),F4(b,p,m,y,g,o),v+=h;S=Math.floor((_-I)/h),S>b&&F4(S,p,m,y,g,o)}this._accelerationMap=o}_nextInside(){for(;;){if(this._currentX>this._xMax){if(this._currentY++,this._currentY>this._yMax)return null;this._currentX=this._xMin,this._shiftOddRows&&this._currentY%2&&this._currentX--}let e=this._currentX*this._stepX+this._offsetX;this._shiftOddRows&&this._currentY%2&&(e+=.5*this._stepX);const r=this._currentY*this._stepY+this._offsetY;let i,s;if(this._currentX++,this._gridType===g0.Random){const n=(this._currentX%yo+yo)%yo,o=(this._currentY%yo+yo)%yo;i=this._graphicOriginX+e+this._stepX*this._randomness*(.5-lh._randValues[o*yo+n])*2/3,s=this._graphicOriginY+r+this._stepY*this._randomness*(.5-lh._randValues[o*yo+n+1])*2/3}else i=this._graphicOriginX+this._cosAngle*e+this._sinAngle*r,s=this._graphicOriginY-this._sinAngle*e+this._cosAngle*r;if(!this._testInsidePolygon||this._isInsidePolygon(i,s,this._geometryCursor))return this._internalPlacement.setTranslate(i,s),this._internalPlacement}}_isInsidePolygon(e,r,i){if(this._accelerationMap==null)return qTe(e,r,i);e+=AS,r+=AS;const s=this._verticalSubdivision,n=s?r:e,o=Math.floor((n-this._polygonMin)/this._delta),a=this._accelerationMap.get(o);if(!a)return!1;let l,u,h,p=0;for(const m of a){if(l=m[0],u=m[1],s){if(l[1]>r==u[1]>r)continue;h=(u[0]-l[0])*(r-l[1])-(u[1]-l[1])*(e-l[0])}else{if(l[0]>e==u[0]>e)continue;h=(u[1]-l[1])*(e-l[0])-(u[0]-l[0])*(r-l[1])}h>0?p++:p--}return p!==0}};function qTe(t,e,r){let i,s,n,o,a=0;for(t+=AS,e+=AS,r.reset();r.nextPath();)if(r.nextPoint())for(i=r.x,s=r.y;r.nextPoint();i=n,s=o)n=r.x,o=r.y,s>e!=o>e&&((n-i)*(e-s)-(o-s)*(t-i)>0?a++:a--);return a!==0}function F4(t,e,r,i,s,n){let o=n.get(t);o||(o=[],n.set(t,o)),o.push([[e,r],[i,s]])}const HTe=.001;var pa;let WTe=(pa=class{static local(){return pa.instance===null&&(pa.instance=new pa),pa.instance}execute(e,r,i,s,n){return new ZTe(e,r,i)}},pa.instance=null,pa),ZTe=class extends Zv{constructor(e,r,i){super(e),this._curveHelper=new Hl,this._angleToLine=r.angleToLine===void 0||r.angleToLine,this._offset=r.offset!==void 0?r.offset*i:0,this._relativeTo=r.relativeTo,this._position=r.startPointOffset!==void 0?r.startPointOffset*i:0,this._epsilon=HTe*i}processPath(e){const r=this._position;if(this._relativeTo===Ph.SegmentMidpoint){if(this.iteratePath||(this.iteratePath=!0),e.nextPoint()){let[s,n]=[e.x,e.y],[o,a]=[0,0];const l=[0,0];for(;e.nextPoint();){o=e.x,a=e.y;const u=this._curveHelper.getLength(s,n,o,a);if(u<this._epsilon){s=o,n=a;continue}const h=.5+this._position/u,[p,m]=this._curveHelper.getAngleCS(l,s,n,o,a,h),y=this._curveHelper.getCoord2D(s,n,o,a,h);return this.internalPlacement.setTranslate(y[0]-this._offset*m,y[1]+this._offset*p),this._angleToLine&&this.internalPlacement.setRotateCS(p,m),this.internalPlacement}}return this.iteratePath=!1,null}const i=this._relativeTo===Ph.LineEnd;return this.onLine(e,r,i)}onLine(e,r,i){let s,n=!1;switch(this._relativeTo){case Ph.LineMiddle:default:e.seekPathStart(),s=e.pathLength()/2+r;break;case Ph.LineBeginning:s=r;break;case Ph.LineEnd:s=r,n=!0}i?e.seekPathEnd():e.seekPathStart();let o=0;if(i?e.prevPoint():e.nextPoint()){let[a,l]=[e.x,e.y],[u,h]=[0,0];const p=[0,0];for(;i?e.prevPoint():e.nextPoint();){u=e.x,h=e.y;const m=this._curveHelper.getLength(a,l,u,h);if(o+m>s){const y=(s-o)/m,[g,v]=this._curveHelper.getAngleCS(p,a,l,u,h,y),_=this._curveHelper.getCoord2D(a,l,u,h,y),b=n?-this._offset:this._offset;return this.internalPlacement.setTranslate(_[0]-b*v,_[1]+b*g),this._angleToLine&&(n?this.internalPlacement.setRotateCS(-g,-v):this.internalPlacement.setRotateCS(g,v)),this.internalPlacement}a=u,l=h,o+=m}}return null}};const JTe=1e-15;var fa;let YTe=(fa=class{static local(){return fa.instance===null&&(fa.instance=new fa),fa.instance}execute(e,r,i,s,n){return new XTe(e,r,i)}},fa.instance=null,fa),XTe=class extends Zv{constructor(e,r,i){super(e),this._curveHelper=new Hl,this._angleToLine=r.angleToLine===void 0||r.angleToLine,this._offset=r.offset!==void 0?r.offset*i:0,this._endPoints=r.placeOnEndPoints===void 0||r.placeOnEndPoints,this._controlPoints=r.placeOnControlPoints===void 0||r.placeOnControlPoints,this._regularVertices=r.placeOnRegularVertices===void 0||r.placeOnRegularVertices,this._tags=[],this._tagIterator=0}processPath(e){if(this.iteratePath||(this._preparePath(e),this.iteratePath=!0),this._tagIterator>=this._tags.length)return this._tags.length=0,this._tagIterator=0,this.iteratePath=!1,null;const r=this._tags[this._tagIterator];this._angleToLine&&this.internalPlacement.setRotate(r[2]);let i=r[0],s=r[1];if(this._offset!==0){const n=Math.cos(r[2]),o=Math.sin(r[2]);i-=this._offset*o,s+=this._offset*n}return this.internalPlacement.setTranslate(i,s),this._tagIterator++,this.internalPlacement}_preparePath(e){this._tags.length=0,this._tagIterator=0,e.seekPathStart();const r=e.isClosed();let i=0,s=!1,n=0,o=0;if(e.seekPathStart(),e.nextPoint()){let a=e.x,l=e.y,u=e.getControlPoint(),h=!0,p=e.nextPoint();for(;p;){const m=e.x,y=e.y,g=e.getControlPoint();(this._angleToLine||this._offset!==0)&&(n=this._curveHelper.getAngle(a,l,m,y,0)),h?(h=!1,r?(i=n,s=u):(this._endPoints||this._controlPoints&&u)&&this._tags.push([a,l,n])):u?this._controlPoints&&this._tags.push([a,l,K_(o,n)]):this._regularVertices&&this._tags.push([a,l,K_(o,n)]),(this._angleToLine||this._offset!==0)&&(o=this._curveHelper.getAngle(a,l,m,y,1)),p=e.nextPoint(),p||(r?g||s?this._controlPoints&&this._tags.push([m,y,K_(o,i)]):this._regularVertices&&this._tags.push([m,y,K_(o,i)]):(this._endPoints||this._controlPoints&&g)&&this._tags.push([m,y,o])),a=m,l=y,u=g}}this._tagIterator=0}};function K_(t,e){const r=Math.PI;for(;Math.abs(e-t)>r+2*JTe;)e-t>r?e-=2*r:e+=2*r;return(t+e)/2}const KTe=100*222045e-21;function QTe(t){if(t.totalSize===0)return null;const e=Iv(t);if(!e)return null;const r=4*(Math.abs(e[0])+Math.abs(e[2])+Math.abs(e[1])+Math.abs(e[3])+1)*KTe;let i=0,s=0;t.reset();for(let V=0;t.nextPath();V++){const U=t.getCurrentRingArea();U>s&&(s=U,i=V)}if(t.seekPath(i),t.pathSize===0)return null;t.seekPathStart();const n=dU(t);if(Math.abs(s)<=2*r*r)return[(n[0]+n[2])/2,(n[1]+n[3])/2];t.seekPathStart();const o=ene(t,nr());if(o===null)return null;if(t.totalPoints<4)return o;const a=[[NaN,NaN],[NaN,NaN],[NaN,NaN],[NaN,NaN]],l=[NaN,NaN,NaN,NaN],u=[NaN,NaN,NaN,NaN];let h=!1,p=Ry(o,t,!0);p.distance===0&&(h=!0,a[0][0]=o[0],a[0][1]=o[1],p=Ry(o,t,!1)),l[0]=p.distance,u[0]=0;const m=[NaN,NaN];let y=!1,g=.25,v=-1,_=NaN;do if(_=NaN,a[1]=z$(t,V$(n[0],n[2],g),r,e),isNaN(a[1][0])||isNaN(a[1][1])||(p=Ry(a[1],t,!1),_=p.distance),!isNaN(_)&&_>r&&Pb(a[1],t))y=!0,l[1]=_,u[1]=uh(a[1],o);else if(!isNaN(_)&&_>v&&(v=_,m[0]=a[1][0],m[1]=a[1][1]),g-=.01,g<.1){if(!(v>=0))break;y=!0,l[1]=v,a[1][0]=m[0],a[1][1]=m[1],u[1]=uh(a[1],o)}while(!y);y=!1,g=.5,v=-1;let b=.01,S=1;do if(_=NaN,a[2]=z$(t,V$(n[0],n[2],g),r,e),isNaN(a[2][0])||isNaN(a[2][1])||(p=Ry(a[2],t,!1),_=p.distance),!isNaN(_)&&_>r&&Pb(a[2],t))y=!0,l[2]=_,u[2]=uh(a[2],o);else if(!isNaN(_)&&_>v)v=_,m[0]=a[2][0],m[1]=a[2][1];else if(_>v&&(v=_,m[0]=a[2][0],m[1]=a[2][1]),g=.5+b*S,b+=.01,S*=-1,g<.3||g>.7){if(!(v>=0))break;y=!0,l[2]=v,a[2][0]=m[0],a[2][1]=m[1],u[2]=uh(a[2],o)}while(!y);y=!1,g=.75,v=-1;do if(_=NaN,a[3]=z$(t,V$(n[0],n[2],g),r,e),isNaN(a[3][0])||isNaN(a[3][1])||(p=Ry(a[3],t,!1),_=p.distance),!isNaN(_)&&_>r&&Pb(a[3],t))y=!0,l[3]=_,u[3]=uh(a[3],o);else if(_>v&&(v=_,m[0]=a[3][0],m[1]=a[3][1]),g+=.01,g>.9){if(!(v>=0))break;y=!0,l[3]=v,a[3][0]=m[0],a[3][1]=m[1],u[3]=uh(a[3],o)}while(!y);const $=[0,1,2,3],T=h?0:1;let I;for(let V=T;V<4;V++)for(let U=T;U<3;U++){const Z=u[U],X=u[U+1];rEe(Z,X)>0&&(I=$[U],$[U]=$[U+1],$[U+1]=I,u[U]=X,u[U+1]=Z)}let P=T,R=0,D=0;for(let V=T;V<4;V++){switch(V){case 0:D=2*l[$[V]];break;case 1:D=1.66666666*l[$[V]];break;case 2:D=1.33333333*l[$[V]];break;case 3:D=l[$[V]]}D>R&&(R=D,P=$[V])}return a[P]}function Pb(t,e){let r,i,s,n,o=0;for(e.reset();e.nextPath()&&e.nextPoint();)for(r=e.x,i=e.y;e.nextPoint();r=s,i=n)s=e.x,n=e.y,i>t[1]!=n>t[1]&&((s-r)*(t[1]-i)-(n-i)*(t[0]-r)>0?o++:o--);return o!==0}function Ry(t,e,r){if(r&&Pb(t,e))return{coord:t,distance:0};let i=1/0,s=0,n=0,o=[0,0],a=[0,0];const l=[0,0];for(e.reset();e.nextPath()&&e.nextPoint();)if(!(e.pathSize<2))for(o[0]=e.x,o[1]=e.y;e.nextPoint();o=a){a=[e.x,e.y],K8(l,t,o,a);const u=uh(t,l);u<i&&(i=u,s=l[0],n=l[1])}return{coord:[s,n],distance:Math.sqrt(i)}}function z$(t,e,r,i){const s=[e,0];let n=1/0,o=1/0,a=!1,l=!1;const u=[[e,i[1]-1],[e,i[3]+1]],h=[0,0],p=[0,0],m=[0,0],y=[[0,0],[0,0]],g=nr();for(t.reset();t.nextPath()&&t.nextPoint();)if(!(t.pathSize<2))for(y[0][0]=t.x,y[0][1]=t.y;t.nextPoint();y[0][0]=y[1][0],y[0][1]=y[1][1]){if(y[1][0]=t.x,y[1][1]=t.y,eEe(g,y)===null||(p[0]=u[0][0],p[1]=u[0][1],m[0]=u[1][0],m[1]=u[1][1],tEe(g,p,m)===0)||!yw(u[0],u[1],y[0],y[1],h))continue;const v=h[1];n>o?v<n&&(n=v,a=!0):v<o&&(o=v,l=!0)}return a&&l?s[1]=(n+o)/2:s[0]=s[1]=NaN,s}function eEe(t,e){if(e.length<2)return null;t||(t=nr());const[r,i]=e[0],[s,n]=e[1];return t[0]=Math.min(r,s),t[1]=Math.min(i,n),t[2]=Math.max(r,s),t[3]=Math.max(i,n),t}const Q_=1,e1=4,D4=3,z4=12;function tEe(t,e,r){let i=go(e,t),s=go(r,t);const n=t[0],o=t[1],a=t[2],l=t[3];if(i&s)return 0;if(!(i|s))return 4;const u=(i?1:0)|(s?2:0);do{const h=r[0]-e[0],p=r[1]-e[1];if(h>p)i&D4?(i&Q_?(e[1]+=p*(n-e[0])/h,e[0]=n):(e[1]+=p*(a-e[0])/h,e[0]=a),i=go(e,t)):s&D4?(s&Q_?(r[1]+=p*(n-r[0])/h,r[0]=n):(r[1]+=p*(a-r[0])/h,r[0]=a),s=go(r,t)):i?(i&e1?(e[0]+=h*(o-e[1])/p,e[1]=o):(e[0]+=h*(l-e[1])/p,e[1]=l),i=go(e,t)):(s&e1?(r[0]+=h*(o-r[1])/p,r[1]=o):(r[0]+=h*(l-r[1])/p,r[1]=l),s=go(r,t));else if(i&z4?(i&e1?(e[0]+=h*(o-e[1])/p,e[1]=o):(e[0]+=h*(l-e[1])/p,e[1]=l),i=go(e,t)):s&z4?(s&e1?(r[0]+=h*(o-r[1])/p,r[1]=o):(r[0]+=h*(l-r[1])/p,r[1]=l),s=go(r,t)):i?(i&Q_?(e[1]+=p*(n-e[0])/h,e[0]=n):(e[1]+=p*(a-e[0])/h,e[0]=a),i=go(e,t)):(s&Q_?(r[1]+=p*(n-r[0])/h,r[0]=n):(r[1]+=p*(a-r[0])/h,r[0]=a),s=go(r,t)),i&s)return 0}while(i|s);return u}function go(t,e){return(t[0]<e[0]?1:0)|(t[0]>e[2]?1:0)<<1|(t[1]<e[1]?1:0)<<2|(t[1]>e[3]?1:0)<<3}function V$(t,e,r){return t+(e-t)*r}function uh(t,e){return(t[0]-e[0])*(t[0]-e[0])+(t[1]-e[1])*(t[1]-e[1])}function rEe(t,e){if(t<e)return-1;if(t>e)return 1;if(t===e)return 0;const r=isNaN(t),i=isNaN(e);return r<i?-1:r>i?1:0}var ma;let iEe=(ma=class{static local(){return ma.instance===null&&(ma.instance=new ma),ma.instance}execute(e,r,i,s,n){return new sEe(e,r,i)}},ma.instance=null,ma),sEe=class{constructor(e,r,i){this._geometryCursor=e,this._offsetX=r.offsetX!==void 0?r.offsetX*i:0,this._offsetY=r.offsetY!==void 0?r.offsetY*i:0,this._method=r.method!==void 0?r.method:af.OnPolygon,this._placementPerPart=r.placePerPart!==void 0&&r.placePerPart,this._internalPlacement=new Jm}next(){const e=this._geometryCursor;if(!e)return null;if(!this._placementPerPart)return this._geometryCursor=null,this._polygonCenter(e);for(;e.nextPath();)if(!(e.getCurrentRingArea()<0))return this._polygonCenter(e.getCurrentPath());return this._geometryCursor=null,null}_polygonCenter(e){let r=!1;switch(this._method){case af.CenterOfMass:{const i=sne(e);i&&(this._internalPlacement.setTranslate(i[0]+this._offsetX,i[1]+this._offsetY),r=!0)}break;case af.BoundingBoxCenter:{const i=Iv(e);i&&(this._internalPlacement.setTranslate((i[2]+i[0])/2+this._offsetX,(i[3]+i[1])/2+this._offsetY),r=!0)}break;case af.OnPolygon:default:{const i=QTe(e);i!==null&&(this._internalPlacement.setTranslate(i[0]+this._offsetX,i[1]+this._offsetY),r=!0)}}return r?this._internalPlacement:null}};function nEe(t){if(!t)return null;switch(t.type){case"CIMGeometricEffectAddControlPoints":return UMe.local();case"CIMGeometricEffectArrow":return HMe.local();case"CIMGeometricEffectBuffer":return ZMe.local();case"CIMGeometricEffectControlMeasureLine":return YMe.local();case"CIMGeometricEffectCut":return KMe.local();case"CIMGeometricEffectDashes":return eTe.local();case"CIMGeometricEffectDonut":return rTe.local();case"CIMGeometricEffectJog":return uTe.local();case"CIMGeometricEffectMove":return hTe.local();case"CIMGeometricEffectOffset":return fTe.local();case"CIMGeometricEffectRadial":return yTe.local();case"CIMGeometricEffectReverse":return vTe.local();case"CIMGeometricEffectRotate":return wTe.local();case"CIMGeometricEffectScale":return xTe.local();case"CIMGeometricEffectSuppress":return MTe.local();case"CIMGeometricEffectTaperedPolygon":return LTe.local();case"CIMGeometricEffectWave":return kTe.local();case"CIMGeometricEffectEnclosingPolygon":return sTe.local()}return null}function oEe(t){if(!t)return null;switch(t.type){case"CIMMarkerPlacementAlongLineSameSize":return NTe.local();case"CIMMarkerPlacementAtExtremities":return DTe.local();case"CIMMarkerPlacementAtRatioPositions":return VTe.local();case"CIMMarkerPlacementInsidePolygon":return GTe.local();case"CIMMarkerPlacementOnLine":return WTe.local();case"CIMMarkerPlacementOnVertices":return YTe.local();case"CIMMarkerPlacementPolygonCenter":return iEe.local()}return null}function j$(t){const e=t.getFrame(0);if(e instanceof HTMLImageElement||e instanceof HTMLCanvasElement)return e;const r=document.createElement("canvas");r.width=t.width,r.height=t.height;const i=r.getContext("2d");return e instanceof ImageData?i.putImageData(e,0,0):i.drawImage(e,0,0),r}function ja(t,e=0){if(e===0)return t;const r=Math.cos(e),i=Math.sin(e),[s,n]=t;return[s*r+n*-i,s*i+n*r]}function GW(t,e,r=0){const i=$i(t,0,cEe);for(let s=0;s<4;s++)e[r+s]=Math.floor(256*hEe(i*lEe[s]))}function aEe(t,e=0){let r=0;for(let i=0;i<4;i++)r+=t[e+i]*uEe[i];return r}const lEe=[1,256,65536,16777216],uEe=[1/256,1/65536,1/16777216,1/4294967296],cEe=aEe(new Uint8ClampedArray([255,255,255,255]));function hEe(t){return t-Math.floor(t)}const dEe=15.5,U$=4,pEe=64,xVe=1024,$Ve={outlineWidth:.75,referenceWidth:.75,cap:ar.CIMSolidStroke.capstyle,join:ar.CIMSolidStroke.joinstyle,miterLimit:ar.CIMSolidStroke.miterlimit},V4=()=>q.getLogger("esri.symbols.cim.rasterizingUtils"),fEe=32,mEe=t=>t==="vertical"||t==="horizontal"||t==="cross"||t==="esriSFSCross"||t==="esriSFSVertical"||t==="esriSFSHorizontal";function MVe(t,e,r){const i=e.style,s=gse(Math.ceil(r)),n=mEe(i)?8*s:16*s,o=2*s;t.width=n,t.height=n;const a=t.getContext("2d");a.strokeStyle="#ffffff",a.lineWidth=s,a.beginPath(),i!=="vertical"&&i!=="cross"&&i!=="esriSFSCross"&&i!=="esriSFSVertical"||(a.moveTo(n/2,-o),a.lineTo(n/2,n+o)),i!=="horizontal"&&i!=="cross"&&i!=="esriSFSCross"&&i!=="esriSFSHorizontal"||(a.moveTo(-o,n/2),a.lineTo(n+o,n/2)),i!=="backward-diagonal"&&i!=="diagonal-cross"&&i!=="esriSFSDiagonalCross"&&i!=="esriSFSBackwardDiagonal"||(a.moveTo(-o,-o),a.lineTo(n+o,n+o),a.moveTo(n-o,-o),a.lineTo(n+o,o),a.moveTo(-o,n-o),a.lineTo(o,n+o)),i!=="forward-diagonal"&&i!=="diagonal-cross"&&i!=="esriSFSForwardDiagonal"&&i!=="esriSFSDiagonalCross"||(a.moveTo(n+o,-o),a.lineTo(-o,n+o),a.moveTo(o,-o),a.lineTo(-o,o),a.moveTo(n+o,n-o),a.lineTo(n-o,n+o)),a.stroke();const l=a.getImageData(0,0,t.width,t.height),u=new Uint8Array(l.data);let h;for(let p=0;p<u.length;p+=4)h=u[p+3]/255,u[p]=u[p]*h,u[p+1]=u[p+1]*h,u[p+2]=u[p+2]*h;return[u,t.width,t.height,s]}function TVe(t){t.length%2==1&&(t=[...t,...t]);const e=t.reduce(((p,m)=>p+m),0),r=Math.round(e*U$),i=1,s=new Float32Array(r*i);let n=0,o=0,a=.5,l=!0;for(const p of t){for(n=o,o+=p*U$;a<=o;){const m=a-.5,y=Math.min(Math.abs(a-n),Math.abs(a-o));s[m]=l?-y:y,a++}l=!l}const u=s.length,h=new Uint8Array(4*u);for(let p=0;p<u;++p){const m=s[p]/U$;GW(m/pEe*.5+.5,h,4*p)}return[h,r,i]}function EVe(t,e){t==null&&(t=[]);const r=e==="Butt",i=e==="Square",s=!r&&!i;t.length%2==1&&(t=[...t,...t]);const n=dEe,o=2*n;let a=0;for(const b of t)a+=b;const l=Math.round(a*n),u=new Float32Array(l*o),h=.5*n;let p=0,m=0,y=.5,g=!0;for(const b of t){for(p=m,m+=b*n;y<=m;){let S=.5;for(;S<o;){const $=(S-.5)*l+y-.5,T=s?(S-n)*(S-n):Math.abs(S-n);u[$]=g?r?Math.max(Math.max(p+h-y,T),Math.max(y-m+h,T)):T:s?Math.min((y-p)*(y-p)+T,(y-m)*(y-m)+T):i?Math.min(Math.max(y-p,T),Math.max(m-y,T)):Math.min(Math.max(y-p+h,T),Math.max(m+h-y,T)),S++}y++}g=!g}const v=u.length,_=new Uint8Array(4*v);for(let b=0;b<v;++b){const S=(s?Math.sqrt(u[b]):u[b])/n;GW(S,_,4*b)}return[_,l,o]}function IVe(t,e){const{colorRamp:r,gradientType:i}=e,s=r.type==="CIMFixedColorRamp",n=e.interval||ar.CIMGradientFill.interval;let o=gL(r);return s&&(o=BW(o,n)),i==="Discrete"||s?gEe(t,o,n):yEe(t,o)}let G$;function t1(t,e){const{colorRamp:r,gradientType:i}=e,s=gL(r),n=r.type==="CIMFixedColorRamp";if(i==="Continuous"&&!n)return Ab(t,s);const o=e.interval??ar.CIMGradientFill.interval;if(n)return Ab(t,BW(s,o));const a=[];G$??=document.createElement("canvas"),vL(G$,s,o,1,0);const l=G$.getContext("2d").getImageData(0,0,o,1).data;for(let u=0,h=0;u<o;u++,h=4*u){const p=[l[h+0],l[h+1],l[h+2],l[h+3]];a.push({offset:u/o,color:p}),a.push({offset:(u+1)/o,color:p})}return Ab(t,a)}function gL(t){const e=[];switch(t.type){case"CIMPolarContinuousColorRamp":case"CIMLinearContinuousColorRamp":{t.type==="CIMPolarContinuousColorRamp"&&V4().warnOnce("CIMPolarContinuousColorRamp is currently unsupported. Falling back to CIMLinearContinuousColorRamp.");const r=t;e.push({offset:0,color:[r.fromColor[0],r.fromColor[1],r.fromColor[2],r.fromColor[3]/255]}),e.push({offset:1,color:[r.toColor[0],r.toColor[1],r.toColor[2],r.toColor[3]/255]});break}case"CIMFixedColorRamp":{const r=t,i=1/(r.colors.length-1);let s=0;for(const n of r.colors)e.push({offset:s,color:[n[0],n[1],n[2],n[3]/255]}),s+=i;break}case"CIMMultipartColorRamp":{const r=t,i=r.weights.reduce(((n,o)=>n+o),0);let s=0;for(let n=0;n<r.colorRamps.length;n++){const o=r.colorRamps[n],a=r.weights[n],l=gL(o);for(const u of l)e.push({offset:(s+u.offset*a)/i,color:u.color});s+=a}break}default:V4().error(`Color ramp "${t.type}" currently unsupported.`)}return e}function BW(t,e){const r=[],i=(t.length-1)/(e-1);for(let s=0;s<e;s++){const n=t[Math.round(s*i)].color;r.push({offset:s/e,color:n}),r.push({offset:(s+1)/e,color:n})}return r}function yEe(t,e){return vL(t,e,fEe,1,hB),qW(t)}function gEe(t,e,r){return vL(t,e,r,1,hB),qW(t)}function Ab(t,e,r=0){for(const{offset:i,color:s}of e)t.addColorStop(Math.min(Math.max(i,r),1-r),`rgba(${s[0]}, ${s[1]}, ${s[2]}, ${s[3]})`)}function vL(t,e,r,i,s){const n=r+2*s;t.width=n,t.height=i;const o=(s+1)/n,a=t.getContext("2d",{willReadFrequently:!0});if(e.length>0){const l=a.createLinearGradient(0,0,n,i);Ab(l,e,o),a.fillStyle=l}else a.fillStyle="rgba(128, 128, 128, 1)";a.fillRect(0,0,n,i)}function qW(t){const{width:e,height:r}=t,i=t.getContext("2d").getImageData(0,0,e,r),s=new Uint8Array(i.data);for(let n=0;n<s.length;n+=4){const o=s[n+3]/255;s[n]*=o,s[n+1]*=o,s[n+2]*=o}return[s,e,r]}function vEe(t){const e=t[0]?.[0]?.[0]??0,r=t[0]?.[0]?.[1]??0,i={ymin:r,xmin:e,ymax:r,xmax:e,width:0,height:0};for(let s=0;s<t.length;s++){const n=t[s];for(let o=0;o<n.length;o++){const a=n[o][0],l=n[o][1];a<i.xmin&&(i.xmin=a),a>i.xmax&&(i.xmax=a),l<i.ymin&&(i.ymin=l),l>i.ymax&&(i.ymax=l)}}return i.width=Math.abs(i.xmax-i.xmin),i.height=Math.abs(i.ymax-i.ymin),i}function LS(t,e){const r=vEe(t),i=r.width===0?1:r.width,s=r.height===0?1:r.height,n=[];for(let o=0;o<t.length;o++){const a=t[o],l=[];for(let u=0;u<a.length;u++){let h=Math.round(a[u][0]-r.xmin),p=Math.round(a[u][1]-r.ymin);if(h=e.xmin+h*e.width/i,p=e.ymin+p*e.height/s,isNaN(h)||isNaN(p))throw new Error("Scaled shape has NaN values");l.push([h,p])}n.push(l)}return n}function j4(t,e,r){const i=[];for(let s=0;s<t.length;s++){const n=t[s],o=[];for(let a=0;a<n.length;a++){const l=n[a][0]+e,u=n[a][1]+r;if(isNaN(l)||isNaN(u))throw new Error("Scaled shape has NaN values");o.push([l,u])}i.push(o)}return i}let _Ee=class HW{constructor(e=0,r=0,i=0,s=0){this.x=e,this.y=r,this.width=i,this.height=s}static fromExtent(e){return new HW(e.xmin,-e.ymax,e.xmax-e.xmin,e.ymax-e.ymin)}get isEmpty(){return this.width<=0||this.height<=0}union(e){this.x=Math.min(this.x,e.x),this.y=Math.min(this.y,e.y),this.width=Math.max(this.width,e.width),this.height=Math.max(this.height,e.height)}};function bEe(t){return`rgb(${t.slice(0,3).toString()})`}function r1(t){return`rgba(${t.slice(0,3).toString()},${t[3]})`}let WW=class{constructor(e){e&&(this._textRasterizationCanvas=e)}rasterizeText(e,r){this._textRasterizationCanvas||(this._textRasterizationCanvas=document.createElement("canvas"));const i=this._textRasterizationCanvas,s=i.getContext("2d",{willReadFrequently:!0});ky(s,r),this._parameters=r,this._textLines=e.split(/\r?\n/),this._lineHeight=this._computeLineHeight();const{decoration:n,weight:o}=r.font;this._lineThroughWidthOffset=n&&n==="line-through"?.1*this._lineHeight:0;const a=r.backgroundColor!=null||r.borderLine!=null,l=a?jhe:0,u=this._computeTextWidth(s,r)+2*l,h=this._lineHeight*this._textLines.length+2*l;if(i.width=u+2*this._lineThroughWidthOffset,i.height=h,i.width===0||i.height===0)return i.width=i.height=1,{size:[0,0],image:new Uint32Array(0),sdf:!1,simplePattern:!1,anchorX:0,anchorY:0,canvas:i};this._renderedLineHeight=Math.round(this._lineHeight),this._renderedOutlineSize=(r.outline.size||0)*r.pixelRatio,this._renderedHaloSize=(r.halo.size||0)*r.pixelRatio,this._renderedWidth=u,this._renderedHeight=h,this._lineThroughWidthOffset*=r.pixelRatio;const p=(r.outline&&r.outline.color)??[0,0,0,0],m=r.color??[0,0,0,0],y=r.halo&&r.halo.color?r.halo.color:[0,0,0,0];this._fillStyle=r1(m),this._outlineStyle=r1(p),this._haloStyle=bEe(y);const g=this._renderedLineHeight,v=this._renderedOutlineSize,_=this._renderedHaloSize;s.save(),s.clearRect(0,0,i.width,i.height),ky(s,r);const b=l*r.pixelRatio,S=wEe(s.textAlign,this._renderedWidth-2*b,this._renderedHaloSize+this._renderedOutlineSize)+b,$=_+v+b,T=_>0;let I=this._lineThroughWidthOffset,P=0;if(a){s.save();const le=r.backgroundColor??[0,0,0,0],ee=r.borderLine?.color??[0,0,0,0],ke=2*(r.borderLine?.size??0);s.fillStyle=r1(le),s.strokeStyle=r1(ee),s.lineWidth=ke,s.fillRect(0,0,i.width,i.height),s.strokeRect(0,0,i.width,i.height),s.restore()}T&&this._renderHalo(s,S,$,I,P,r),v>0&&this._renderOutline(s,S,$,I,P,r),P+=$,I+=S;for(const le of this._textLines)T?(s.globalCompositeOperation="destination-out",s.fillStyle="rgb(0, 0, 0)",s.fillText(le,I,P),s.globalCompositeOperation="source-over",s.fillStyle=this._fillStyle,s.fillText(le,I,P)):(s.fillStyle=this._fillStyle,s.fillText(le,I,P)),n&&n!=="none"&&this._renderDecoration(s,I,P,n,o),P+=g;s.restore();const R=this._renderedWidth+2*this._lineThroughWidthOffset,D=this._renderedHeight,V=s.getImageData(0,0,R,D),U=new Uint8Array(V.data);if(r.premultiplyColors){let le;for(let ee=0;ee<U.length;ee+=4)le=U[ee+3]/255,U[ee]=U[ee]*le,U[ee+1]=U[ee+1]*le,U[ee+2]=U[ee+2]*le}let Z,X;switch(r.horizontalAlignment){case"left":Z=-.5;break;case"right":Z=.5;break;default:Z=0}switch(r.verticalAlignment){case"bottom":X=-.5;break;case"top":X=.5;break;case"baseline":X=-1/6;break;default:X=0}return{size:[R,D],image:new Uint32Array(U.buffer),sdf:!1,simplePattern:!1,anchorX:Z,anchorY:X,canvas:i}}_renderHalo(e,r,i,s,n,o){const a=this._renderedWidth,l=this._renderedHeight;this._outlineRasterizationCanvas||(this._outlineRasterizationCanvas=document.createElement("canvas")),this._outlineRasterizationCanvas.width=a,this._outlineRasterizationCanvas.height=l;const u=this._outlineRasterizationCanvas,h=u.getContext("2d");h.clearRect(0,0,a,l),ky(h,o);const{decoration:p,weight:m}=o.font;h.fillStyle=this._haloStyle,h.strokeStyle=this._haloStyle,h.lineJoin="round",this._renderOutlineNative(h,r,i,p,m,this._renderedHaloSize+this._renderedOutlineSize),e.globalAlpha=this._parameters.halo.color[3],e.drawImage(u,0,0,a,l,s,n,a,l),e.globalAlpha=1}_renderOutline(e,r,i,s,n,o){const a=this._renderedWidth,l=this._renderedHeight;this._outlineRasterizationCanvas||(this._outlineRasterizationCanvas=document.createElement("canvas")),this._outlineRasterizationCanvas.width=a,this._outlineRasterizationCanvas.height=l;const u=this._outlineRasterizationCanvas,h=u.getContext("2d");h.clearRect(0,0,a,l),ky(h,o);const{decoration:p,weight:m}=o.font;h.fillStyle=this._outlineStyle,h.strokeStyle=this._outlineStyle,h.lineJoin="round",this._renderOutlineNative(h,r,i,p,m,this._renderedOutlineSize),e.globalAlpha=this._parameters.outline.color[3],e.drawImage(u,0,0,a,l,s,n,a,l),e.globalAlpha=1}_renderOutlineNative(e,r,i,s,n,o){const a=this._renderedLineHeight;for(const l of this._textLines){const u=2*o,h=5,p=.1;for(let m=0;m<h;m++){const y=(1-(h-1)*p+m*p)*u;e.lineWidth=y,e.strokeText(l,r,i),s&&s!=="none"&&this._renderDecoration(e,r,i,s,n,y)}i+=a}}computeTextSize(e,r){this._textRasterizationCanvas||(this._textRasterizationCanvas=document.createElement("canvas"));const i=this._textRasterizationCanvas,s=i.getContext("2d");ky(s,r),this._parameters=r,this._textLines=e.split(/\r?\n/),this._lineHeight=this._computeLineHeight();const n=this._computeTextWidth(s,r),o=this._lineHeight*this._textLines.length;return i.width=n,i.height=o,[n*r.pixelRatio,o*r.pixelRatio]}_computeTextWidth(e,r){let i=0;for(const n of this._textLines)i=Math.max(i,e.measureText(n).width);const s=r.font;return(s.style==="italic"||s.style==="oblique"||typeof s.weight=="string"&&(s.weight==="bold"||s.weight==="bolder")||typeof s.weight=="number"&&s.weight>600)&&(i+=.3*e.measureText("w").width),i+=2*Fe(this._parameters.halo.size),Math.round(i)}_computeLineHeightBase(){return 1.275*this._parameters.size}_computeLineHeight(){let e=this._computeLineHeightBase();const r=this._parameters.font.decoration;return r&&r==="underline"&&(e*=1.3),Math.round(e+2*Fe(this._parameters.halo.size))}_renderDecoration(e,r,i,s,n,o){let a=.9*this._lineHeight;const l=n==="bold"?.06:n==="bolder"?.09:.04;switch(e.textAlign){case"center":r-=this._renderedWidth/2;break;case"right":r-=this._renderedWidth}const u=e.textBaseline;if(s==="underline")switch(a=.9*this._computeLineHeightBase(),u){case"top":i+=a;break;case"middle":i+=a/2}else if(s==="line-through")switch(u){case"top":i+=a/1.5;break;case"middle":i+=a/3}const h=o?1.5*o:Math.ceil(a*l);e.save(),e.beginPath(),e.strokeStyle=e.fillStyle,e.lineWidth=h,e.moveTo(r-this._lineThroughWidthOffset,i),e.lineTo(r+this._renderedWidth+2*this._lineThroughWidthOffset,i),e.stroke(),e.restore()}};function ky(t,e){const r=Math.max(e.size,.5),i=e.font,s=`${i.style} ${i.weight} ${Fe(r).toFixed(1)}px ${i.family}, sans-serif`;let n;switch(t.font=s,t.textBaseline="top",e.horizontalAlignment){case"left":default:n="left";break;case"right":n="right";break;case"center":n="center"}t.textAlign=n}function wEe(t,e,r){return t==="center"?.5*e:t==="right"?e-r:r}function ZW(t){return document.createElementNS("http://www.w3.org/2000/svg",t)}function SEe(){const t=ZW("svg");return t.setAttribute("style","position: absolute;"),t.setAttribute("width","0"),t.setAttribute("height","0"),t.setAttribute("aria-hidden","true"),t.setAttribute("role","presentation"),document.body.appendChild(t),t}function xEe(t){return t!=null&&document.body.removeChild(t),null}const $Ee=()=>q.getLogger("esri.views.2d.engine.webgl.alignmentUtils");var Uo,ln;function MEe(t){if(!t)return Uo.Center;switch(t){case"Left":case"left":return Uo.Left;case"Right":case"right":return Uo.Right;case"Justify":return $Ee().warnOnce("Horizontal alignment 'justify' is not implemented. Falling back to 'center'."),Uo.Center;case"Center":case"center":return Uo.Center}}function TEe(t){if(!t)return ln.Center;switch(t){case"Top":case"top":return ln.Top;case"Center":case"middle":return ln.Center;case"Baseline":case"baseline":return ln.Baseline;case"Bottom":case"bottom":return ln.Bottom}}function PVe(t){switch(t){case"above-left":case"esriServerPointLabelPlacementAboveLeft":return["right","bottom"];case"above-center":case"above-along":case"esriServerPointLabelPlacementAboveCenter":case"esriServerLinePlacementAboveAlong":return["center","bottom"];case"above-right":case"esriServerPointLabelPlacementAboveRight":return["left","bottom"];case"center-left":case"esriServerPointLabelPlacementCenterLeft":return["right","middle"];case"center-center":case"center-along":case"esriServerPointLabelPlacementCenterCenter":case"esriServerLinePlacementCenterAlong":case"always-horizontal":case"esriServerPolygonPlacementAlwaysHorizontal":return["center","middle"];case"center-right":case"esriServerPointLabelPlacementCenterRight":return["left","middle"];case"below-left":case"esriServerPointLabelPlacementBelowLeft":return["right","top"];case"below-center":case"below-along":case"esriServerPointLabelPlacementBelowCenter":case"esriServerLinePlacementBelowAlong":return["center","top"];case"below-right":case"esriServerPointLabelPlacementBelowRight":return["left","top"];default:return console.debug(`Found invalid placement type ${t}`),["center","middle"]}}function AVe(t){switch(t){case Uo.Right:case"right":return-1;case Uo.Center:case"center":return 0;case Uo.Left:case"left":return 1;default:return console.debug(`Found invalid horizontal alignment ${t}`),0}}function LVe(t){switch(t){case ln.Top:case"top":return 1;case ln.Center:case"middle":return 0;case ln.Bottom:case ln.Baseline:case"baseline":case"bottom":return-1;default:return console.debug(`Found invalid vertical alignment ${t}`),0}}(function(t){t[t.Left=-1]="Left",t[t.Center=0]="Center",t[t.Right=1]="Right"})(Uo||(Uo={})),(function(t){t[t.Top=1]="Top",t[t.Center=0]="Center",t[t.Bottom=-1]="Bottom",t[t.Baseline=2]="Baseline"})(ln||(ln={}));let EEe=class{constructor(e=0,r=0,i=0,s=0){this.x=e,this.y=r,this.width=i,this.height=s}get isEmpty(){return this.width<=0||this.height<=0}union(e){this.x=Math.min(this.x,e.x),this.y=Math.min(this.y,e.y),this.width=Math.max(this.width,e.width),this.height=Math.max(this.height,e.height)}},Lg=class VC{constructor(e,r,i,s){this.transformedX=0,this.transformedY=0,this.center=bd(e,r),this.centerT=q0(),this.halfWidth=i/2,this.halfHeight=s/2,this.width=i,this.height=s}get x(){return this.center[0]}get y(){return this.center[1]}get blX(){return this.center[0]+this.halfWidth}get blY(){return this.center[1]+this.halfHeight}get trX(){return this.center[0]-this.halfWidth}get trY(){return this.center[1]-this.halfHeight}get xmin(){return this.x-this.halfWidth}get xmax(){return this.x+this.halfWidth}get ymin(){return this.y-this.halfHeight}get ymax(){return this.y+this.halfHeight}set x(e){this.center[0]=e}set y(e){this.center[1]=e}clone(){return new VC(this.x,this.y,this.width,this.height)}serialize(e){return e.writeF32(this.center[0]),e.writeF32(this.center[1]),e.push(this.width),e.push(this.height),e}findCollisionDelta(e,r=4){const i=Math.abs(e.centerT[0]-this.centerT[0]),s=Math.abs(e.centerT[1]-this.centerT[1]),n=(e.halfWidth+this.halfWidth+r)/i,o=(e.halfHeight+this.halfHeight+r)/s,a=Math.min(n,o);return Math.log2(a)}extend(e){const r=Math.min(this.xmin,e.xmin),i=Math.min(this.ymin,e.ymin),s=Math.max(this.xmax,e.xmax)-r,n=Math.max(this.ymax,e.ymax)-i,o=r+s/2,a=i+n/2;this.width=s,this.height=n,this.halfWidth=s/2,this.halfHeight=n/2,this.x=o,this.y=a}static deserialize(e){const r=e.readF32(),i=e.readF32(),s=e.readInt32(),n=e.readInt32();return new VC(r,i,s,n)}};const JW=22,YW=4,IEe=JW+YW,CEe=JW-6,U4=3,PEe=Math.PI/180,uu=8,AEe=1.5;let XW=class{constructor(e,r,i,s){this._rotationT=Ol(),this._xBounds=0,this._yBounds=0,this.minZoom=0,this.maxZoom=255,this._bounds=null;const n=i.rect,o=new Float32Array(8);e*=s,r*=s;const a=i.code?n.width*s:i.metrics.width,l=i.code?n.height*s:i.metrics.height;this.width=a,this.height=l,o[0]=e,o[1]=r,o[2]=e+a,o[3]=r,o[4]=e,o[5]=r+l,o[6]=e+a,o[7]=r+l,this._data=o,this._setTextureCoords(n),this._scale=s,this._mosaic=i,this.x=e,this.y=r,this.maxOffset=Math.max(e+a,r+l)}get mosaic(){return this._mosaic}set angle(e){this._angle=e,C2(this._rotationT,-e),this._setOffsets()}get angle(){return this._angle}get xTopLeft(){return this._data[0]}get yTopLeft(){return this._data[1]}get xBottomRight(){return this._data[6]}get yBottomRight(){return this._data[7]}get texcoords(){return this._texcoords}get textureBinding(){return this._mosaic.textureBinding}get offsets(){return this._offsets||this._setOffsets(),this._offsets}get char(){return String.fromCharCode(this._mosaic.code)}get code(){return this._mosaic.code}get bounds(){if(!this._bounds){const{height:e,width:r}=this._mosaic.metrics,i=r*this._scale,s=Math.abs(e)*this._scale,n=new Float32Array(8);n[0]=this.x,n[1]=this.y,n[2]=this.x+i,n[3]=this.y,n[4]=this.x,n[5]=this.y+s,n[6]=this.x+i,n[7]=this.y+s;const o=jo(Ol(),this._rotationT,this._transform);P7(n,n,o);let a=1/0,l=1/0,u=-1/0,h=-1/0;for(let v=0;v<4;v++){const _=n[2*v],b=n[2*v+1];a=Math.min(a,_),l=Math.min(l,b),u=Math.max(u,_),h=Math.max(h,b)}const p=u-a,m=h-l,y=a+p/2,g=l+m/2;this._bounds=new Lg(y,g,p,m)}return this._bounds}setTransform(e){this._transform=e,this._offsets=null}_setOffsets(){this._offsets||(this._offsets={topLeft:[0,0],topRight:[0,0],bottomLeft:[0,0],bottomRight:[0,0]});const e=jo(Ol(),this._rotationT,this._transform);this._offsets.topLeft[0]=this._data[0],this._offsets.topLeft[1]=this._data[1],this._offsets.topRight[0]=this._data[2],this._offsets.topRight[1]=this._data[3],this._offsets.bottomLeft[0]=this._data[4],this._offsets.bottomLeft[1]=this._data[5],this._offsets.bottomRight[0]=this._data[6],this._offsets.bottomRight[1]=this._data[7],vi(this._offsets.topLeft,this._offsets.topLeft,e),vi(this._offsets.topRight,this._offsets.topRight,e),vi(this._offsets.bottomLeft,this._offsets.bottomLeft,e),vi(this._offsets.bottomRight,this._offsets.bottomRight,e)}_setTextureCoords({x:e,y:r,width:i,height:s}){this._texcoords={topLeft:[e,r],topRight:[e+i,r],bottomLeft:[e,r+s],bottomRight:[e+i,r+s]}}};const LEe=(t,e)=>({code:0,page:0,sdf:!0,rect:new EEe(0,0,11,8),textureBinding:e,metrics:{advance:0,height:4,width:t,left:0,top:0}});function Oy(t,e){return t.forEach((r=>vi(r,r,e))),{topLeft:t[0],topRight:t[1],bottomLeft:t[2],bottomRight:t[3]}}let REe=class{constructor(e,r,i){this._rotation=0,this._decorate(e,r,i),this.glyphs=e,this.bounds=this._createBounds(e),this.isMultiline=r.length>1,this._hasRotation=i.angle!==0,this._transform=this._createGlyphTransform(this.bounds,i),this._borderLineSizePx=i.borderLineSizePx,(i.borderLineSizePx||i.hasBackground)&&([this.bounds,this.textBox]=this.shapeBackground(this._transform));for(const s of e)s.setTransform(this._transform)}setRotation(e){if(e===0&&this._rotation===0)return;this._rotation=e;const r=this._transform,i=C2(Ol(),e);jo(r,i,r);for(const s of this.glyphs)s.setTransform(this._transform)}_decorate(e,r,i){if(!i.decoration||i.decoration==="none"||!e.length)return;const s=i.scale,n=i.decoration==="underline"?IEe:CEe,o=e[0].textureBinding;for(const a of r){const l=a.startX*s,u=a.startY*s,h=(a.width+a.glyphWidthEnd)*s;e.push(new XW(l,u+n*s,LEe(h,o),1))}}shapeBackground(e){const r=this._borderLineSizePx||0,i=(AEe+r)/2,s=this._borderLineSizePx?i:0,{xmin:n,ymin:o,xmax:a,ymax:l,x:u,y:h,width:p,height:m}=this.bounds,y=[n-uu,o-uu],g=[a+uu,o-uu],v=[n-uu,l+uu],_=[a+uu,l+uu],b=Oy([[y[0]-i,y[1]-i],[g[0]+i,g[1]-i],[y[0]+s,y[1]+s],[g[0]-s,g[1]+s]],e),S=Oy([[v[0]+s,v[1]-s],[_[0]-s,_[1]-s],[v[0]-i,v[1]+i],[_[0]+i,_[1]+i]],e),$=Oy([[y[0]-i,y[1]-i],[y[0]+s,y[1]+s],[v[0]-i,v[1]+i],[v[0]+s,v[1]-s]],e),T=Oy([[g[0]-s,g[1]+s],[g[0]+i,g[1]-i],[_[0]-s,_[1]-s],[_[0]+i,_[1]+i]],e),I={main:Oy([y,g,v,_],e),top:b,bot:S,left:$,right:T};return[new Lg(u,h,p+2*i,m+2*i),I]}get boundsT(){const e=this.bounds,r=tr(q0(),e.x,e.y);if(vi(r,r,this._transform),this._hasRotation){const i=Math.max(e.width,e.height);return new Lg(r[0],r[1],i,i)}return new Lg(r[0],r[1],e.width,e.height)}_createBounds(e){let r=1/0,i=1/0,s=0,n=0;for(const l of e)r=Math.min(r,l.xTopLeft),i=Math.min(i,l.yTopLeft),s=Math.max(s,l.xBottomRight),n=Math.max(n,l.yBottomRight);const o=s-r,a=n-i;return new Lg(r+o/2,i+a/2,o,a)}_createGlyphTransform(e,r){const i=PEe*r.angle,s=Ol(),n=q0();return ba(s,s,tr(n,r.xOffset,-r.yOffset)),r.useCIMAngleBehavior?pc(s,s,i):(ba(s,s,tr(n,e.x,e.y)),pc(s,s,i),ba(s,s,tr(n,-e.x,-e.y))),s}},i1=class{constructor(e,r,i,s,n,o){this.glyphWidthEnd=0,this.startX=0,this.startY=0,this.start=Math.max(0,Math.min(r,i)),this.end=Math.max(0,Math.max(r,i)),this.end<e.length&&(this.glyphWidthEnd=e[this.end].metrics.width),this.width=s,this.yMin=n,this.yMax=o}};const jC=t=>t===10,G4=t=>t===32;function kEe(t,e,r){const i=new Array,s=1/r.scale,n=r.maxLineWidth*s,o=e?t.length-1:0,a=e?-1:t.length,l=e?-1:1;let u=o,h=0,p=0,m=u,y=m,g=0,v=1/0,_=0;for(;u!==a;){const{code:S,metrics:$}=t[u],T=Math.abs($.top);if(jC(S)||G4(S)||(v=Math.min(v,T),_=Math.max(_,T+$.height)),jC(S))u!==o&&(i.push(new i1(t,m,u-l,h,v===1/0?0:v,_)),v=1/0,_=0),h=0,m=u+l,y=u+l,p=0;else if(G4(S))y=u+l,p=0,g=$.advance,h+=$.advance;else if(h>n){if(y!==m){const I=y-2*l;h-=g,i.push(new i1(t,m,I,h-p,v,_)),v=1/0,_=0,m=y,h=p}else i.push(new i1(t,m,u-l,h,v,_)),v=1/0,_=0,m=u,y=u,h=0;h+=$.advance,p+=$.advance}else h+=$.advance,p+=$.advance;u+=l}const b=new i1(t,m,u-l,h,v,_);return b.start>=0&&b.end<t.length&&i.push(b),i}function OEe(t,e){let r=0;for(let n=0;n<t.length;n++){const{width:o}=t[n];r=Math.max(o,r)}const i=e.decoration==="underline"?YW:0,s=t[0].yMin;return{x:0,y:s,height:t[t.length-1].yMax+e.lineHeight*(t.length-1)+i-s,width:r}}function KW(t,e){const r=e.scale,i=new Array,{glyphs:s,isRightToLeft:n}=t,o=kEe(s,n,e),a=o.length?OEe(o,e):{y:0,height:0},l=MEe(e.horizontalAlignment),u=TEe(e.verticalAlignment),h=u===ln.Baseline?1:0,p=h?0:u-1,m=(1-h)*-a.y+p*(a.height/2)+-22*(h?1:0);for(let y=0;y<o.length;y++){const{start:g,end:v,width:_}=o[y];let b=-1*(l+1)*(_/2)-U4;const S=(t.isRightToLeft?o.length-1-y:y)*e.lineHeight+m-U4;o[y].startX=b,o[y].startY=S;for(let $=g;$<=v;$++){const T=s[$];if(jC(T.code))continue;const I=new XW(b+T.metrics.left,S-T.metrics.top,T,r);b+=T.metrics.advance,i.push(I)}}return new REe(i,o,e)}const FVe=50;function DVe(t){if(!t)return null;const{xmin:e,ymin:r,xmax:i,ymax:s,spatialReference:n}=t;return new yt({rings:[[[e,r],[e,s],[i,s],[i,r],[e,r]]],spatialReference:n})}function QW(t){return tt(Math.round(Fe(t)))}function eZ(t){const e=tt(t0e),r=tt(r0e);return Math.max(e,Math.min(t||r,r))}const Rh=Math.PI/180,tZ=.5,Rg=()=>q.getLogger("esri.symbols.cim.CIMSymbolDrawHelper");class Br{constructor(e){this._t=e}static createIdentity(){return new Br([1,0,0,0,1,0])}clone(){const e=this._t;return new Br(e.slice())}transform(e){const r=this._t;return[r[0]*e[0]+r[1]*e[1]+r[2],r[3]*e[0]+r[4]*e[1]+r[5]]}static createScale(e,r){return new Br([e,0,0,0,r,0])}scale(e,r){const i=this._t;return i[0]*=e,i[1]*=e,i[2]*=e,i[3]*=r,i[4]*=r,i[5]*=r,this}scaleRatio(){return Math.sqrt(this._t[0]*this._t[0]+this._t[1]*this._t[1])}static createTranslate(e,r){return new Br([0,0,e,0,0,r])}translate(e,r){const i=this._t;return i[2]+=e,i[5]+=r,this}static createRotate(e){const r=Math.cos(e),i=Math.sin(e);return new Br([r,-i,0,i,r,0])}rotate(e){return Br.multiply(this,Br.createRotate(e),this)}angle(){const e=this._t[0],r=this._t[3],i=Math.sqrt(e*e+r*r);return[e/i,r/i]}static multiply(e,r,i){const s=e._t,n=r._t,o=s[0]*n[0]+s[3]*n[1],a=s[1]*n[0]+s[4]*n[1],l=s[2]*n[0]+s[5]*n[1]+n[2],u=s[0]*n[3]+s[3]*n[4],h=s[1]*n[3]+s[4]*n[4],p=s[2]*n[3]+s[5]*n[4]+n[5],m=i._t;return m[0]=o,m[1]=a,m[2]=l,m[3]=u,m[4]=h,m[5]=p,i}invert(){const e=this._t;let r=e[0]*e[4]-e[1]*e[3];if(r===0)return new Br([0,0,0,0,0,0]);r=1/r;const i=(e[1]*e[5]-e[2]*e[4])*r,s=(e[2]*e[3]-e[0]*e[5])*r,n=e[4]*r,o=-e[1]*r,a=-e[3]*r,l=e[0]*r;return new Br([n,o,i,a,l,s])}}class _L{constructor(e,r){this._resourceManager=e,this._transfos=[],this._sizeTransfos=[],this._geomUnitsPerPoint=1,this._placementPool=new Md(Jm,void 0,void 0,100),this._earlyReturn=!1,this._mapRotation=0,this._transfos.push(r||Br.createIdentity()),this._sizeTransfos.push(r?r.scaleRatio():1)}setTransform(e,r){this._transfos=[e||Br.createIdentity()],this._sizeTransfos=[r||(e?e.scaleRatio():1)]}setGeomUnitsPerPoint(e){this._geomUnitsPerPoint=e}transformPt(e){return this._transfos[this._transfos.length-1].transform(e)}transformSize(e){return e*this._sizeTransfos[this._sizeTransfos.length-1]}reverseTransformPt(e){return this._transfos[this._transfos.length-1].invert().transform(e)}reverseTransformSize(e){return e/this._sizeTransfos[this._sizeTransfos.length-1]}reverseTransformScalar(e){return e/this._transfos[this._transfos.length-1].scaleRatio()}getTransformAngle(){return this._transfos[this._transfos.length-1].angle()}geomUnitsPerPoint(){return this.isEmbedded()?1:this._geomUnitsPerPoint}prevGeomUnitsPerPoint(){return this._transfos.length>2?1:this._geomUnitsPerPoint}isEmbedded(){return this._transfos.length>1}back(){return this._transfos[this._transfos.length-1]}push(e,r){const i=r?e.scaleRatio():1;Br.multiply(e,this.back(),e),this._transfos.push(e),this._sizeTransfos.push(this._sizeTransfos[this._sizeTransfos.length-1]*i)}pop(){this._transfos.splice(-1,1),this._sizeTransfos.splice(-1,1)}drawSymbol(e,r,i){if(e)switch(e.type){case"CIMPointSymbol":case"CIMLineSymbol":case"CIMPolygonSymbol":this.drawMultiLayerSymbol(e,r);break;case"CIMTextSymbol":this.drawTextSymbol(e,r,i)}}drawMultiLayerSymbol(e,r){if(!e||!r)return;const i=e.symbolLayers;if(!i)return;const s=e.effects;if(s&&s.length>0){const n=this.executeEffects(s,r);if(n){let o=n.next();for(;o;)this.drawSymbolLayers(i,o.asJSON()),o=n.next()}}else this.drawSymbolLayers(i,r)}executeEffects(e,r){const i=this._resourceManager.geometryEngine;let s=new VMe(rt.fromJSONCIM(r));for(const n of e){const o=nEe(n);o&&(s=o.execute(s,n,this.geomUnitsPerPoint(),null,i))}return s}drawSymbolLayers(e,r){let i=e.length;for(;i--;){const s=e[i];if(!s||s.enable===!1)continue;const n=s.effects;if(n&&n.length>0){const o=this.executeEffects(n,r);if(o){let a=null;for(;(a=o.next())&&(this.drawSymbolLayer(s,a.asJSON()),!this._earlyReturn););}}else this.drawSymbolLayer(s,r);if(this._earlyReturn)return}}drawSymbolLayer(e,r){switch(e.type){case"CIMSolidFill":this.drawSolidFill(r,e.color,e.path);break;case"CIMHatchFill":this.drawHatchFill(r,e);break;case"CIMPictureFill":this.drawPictureFill(r,e);break;case"CIMGradientFill":this.drawGradientFill(r,e);break;case"CIMSolidStroke":this.drawSolidStroke(r,e.color,e.width,e.capStyle,e.joinStyle,e.miterLimit,e.path);break;case"CIMPictureStroke":this.drawPictureStroke(r,e);break;case"CIMGradientStroke":this.drawGradientStroke(r,e);break;case"CIMCharacterMarker":case"CIMPictureMarker":case"CIMVectorMarker":this.drawMarkerLayer(e,r)}}drawHatchFill(e,r){const i=FEe(r,e,this.geomUnitsPerPoint());i&&(this.pushClipPath(e),this.drawMultiLayerSymbol(r.lineSymbol,i),this.popClipPath())}drawPictureFill(e,r){}drawGradientFill(e,r){}drawPictureStroke(e,r){}drawGradientStroke(e,r){}drawMarkerLayer(e,r){const i=e.markerPlacement;if(i){const s=oEe(i);if(s){const n=i.type==="CIMMarkerPlacementInsidePolygon"||i.type==="CIMMarkerPlacementPolygonCenter"&&i.clipAtBoundary;n&&this.pushClipPath(r);const o=s.execute(rt.fromJSONCIM(r),i,this.geomUnitsPerPoint(),null,this._resourceManager.geometryEngine);if(o){let a=null;for(;(a=o.next())&&(this.drawMarker(e,a),!this._earlyReturn););}n&&this.popClipPath()}}else{const s=this._placementPool.acquire();if(N0(r))s.tx=r.x,s.ty=r.y,this.drawMarker(e,s);else if(rr(r)){const n=rU(r);n&&([s.tx,s.ty]=n,this.drawMarker(e,s))}else if(ri(r)){for(const n of r.paths)for(const o of n)if(s.tx=o[0],s.ty=o[1],this.drawMarker(e,s),this._earlyReturn)break}else for(const n of r.points)if(s.tx=n[0],s.ty=n[1],this.drawMarker(e,s),this._earlyReturn)break;this._placementPool.release(s)}}drawMarker(e,r){switch(e.type){case"CIMCharacterMarker":case"CIMPictureMarker":this.drawPictureMarker(e,r);break;case"CIMVectorMarker":this.drawVectorMarker(e,r)}}drawPictureMarker(e,r){if(!e)return;const i=this._resourceManager.getResource(e.url),s=Me(e.size,ar.CIMPictureMarker.size);if(i==null||s<=0)return;const n=i.width,o=i.height;if(!n||!o)return;const a=n/o,l=Me(e.scaleX,1),u=Br.createIdentity(),h=e.anchorPoint;if(h){let _=h.x,b=h.y;e.anchorPointUnits!=="Absolute"&&(_*=s*a*l,b*=s),u.translate(-_,-b)}let p=Me(e.rotation);e.rotateClockwise&&(p=-p),this._mapRotation&&(p+=this._mapRotation),p&&u.rotate(p*Rh);let m=Me(e.offsetX),y=Me(e.offsetY);if(m||y){if(this._mapRotation){const _=Rh*this._mapRotation,b=Math.cos(_),S=Math.sin(_),$=m*S+y*b;m=m*b-y*S,y=$}u.translate(m,y)}const g=this.geomUnitsPerPoint();g!==1&&u.scale(g,g);const v=r.getAngle();v&&u.rotate(v),u.translate(r.tx,r.ty),this.push(u,!1),this.drawImage(e,s),this.pop()}drawVectorMarker(e,r){if(!e)return;const i=e.markerGraphics;if(!i)return;const s=Me(e.size,ar.CIMVectorMarker.size),n=e.frame,o=n?n.ymax-n.ymin:0,a=s&&o?s/o:1,l=Br.createIdentity();n&&l.translate(.5*-(n.xmax+n.xmin),.5*-(n.ymax+n.ymin));const u=e.anchorPoint;if(u){let v=u.x,_=u.y;e.anchorPointUnits!=="Absolute"?n&&(v*=n.xmax-n.xmin,_*=n.ymax-n.ymin):(v/=a,_/=a),l.translate(-v,-_)}a!==1&&l.scale(a,a);let h=Me(e.rotation);e.rotateClockwise&&(h=-h),this._mapRotation&&(h+=this._mapRotation),h&&l.rotate(h*Rh);let p=Me(e.offsetX),m=Me(e.offsetY);if(p||m){if(this._mapRotation){const v=Rh*this._mapRotation,_=Math.cos(v),b=Math.sin(v),S=p*b+m*_;p=p*_-m*b,m=S}l.translate(p,m)}const y=this.geomUnitsPerPoint();y!==1&&l.scale(y,y);const g=r.getAngle();g&&l.rotate(g),l.translate(r.tx,r.ty),this.push(l,e.scaleSymbolsProportionally);for(const v of i){v?.symbol&&v.geometry||Rg().error("Invalid marker graphic",v);let _=v.textString;if(typeof _=="number"&&(_=_.toString()),this.drawSymbol(v.symbol,v.geometry,_),this._earlyReturn)break}this.pop()}drawTextSymbol(e,r,i){if(!e||!N0(r)||Me(e.height,ar.CIMTextSymbol.height)<=0)return;const s=Br.createIdentity();let n=Me(e.angle);n=-n,n&&s.rotate(n*Rh);const o=Me(e.offsetX),a=Me(e.offsetY);(o||a)&&s.translate(o,a);const l=this.geomUnitsPerPoint();l!==1&&s.scale(l,l),s.translate(r.x,r.y),this.push(s,!1),this.drawText(e,i),this.pop()}}class NEe extends _L{constructor(e,r){super(e,r),this.reset()}reset(){this._xmin=this._ymin=1/0,this._xmax=this._ymax=-1/0,this._clipCount=0}envelope(){return new _Ee(this._xmin,this._ymin,this._xmax-this._xmin,this._ymax-this._ymin)}bounds(){return ane(this._xmin,this._ymin,this._xmax,this._ymax)}drawSolidFill(e){if(e&&!(this._clipCount>0))if(rr(e))this._processPath(e.rings,0);else if(ri(e))this._processPath(e.paths,0);else if(Ni(e)){const r=ml(e);r&&this._processPath(r.rings,0)}else console.error("drawSolidFill Unexpected geometry type!")}drawSolidStroke(e,r,i){if(!e||this._clipCount>0||i==null||i<=0)return;const s=Math.max(.5*this.transformSize(Me(i,ar.CIMSolidStroke.width)),.5*tZ);if(rr(e))this._processPath(e.rings,s);else if(ri(e))this._processPath(e.paths,s);else if(Ni(e)){const n=ml(e);n&&this._processPath(n.rings,s)}else console.error("drawSolidStroke unexpected geometry type!")}drawMarkerLayer(e,r){rr(r)&&e.markerPlacement&&(e.markerPlacement.type==="CIMMarkerPlacementInsidePolygon"||e.markerPlacement.type==="CIMMarkerPlacementPolygonCenter"&&e.markerPlacement.clipAtBoundary)?this._processPath(r.rings,0):super.drawMarkerLayer(e,r)}drawHatchFill(e,r){this.drawSolidFill(e)}drawPictureFill(e,r){this.drawSolidFill(e)}drawGradientFill(e,r){this.drawSolidFill(e)}drawPictureStroke(e,r){this.drawSolidStroke(e,null,r.width)}drawGradientStroke(e,r){this.drawSolidStroke(e,null,r.width)}pushClipPath(e){this.drawSolidFill(e),this._clipCount++}popClipPath(){this._clipCount--}drawImage(e,r){const{url:i}=e,s=Me(e.scaleX,1);let n=s*r,o=r;const a=this._resourceManager.getResource(i);if(a!=null){const l=a.height/a.width;n=s*(r?l>1?r:r/l:a.width),o=r?l>1?r*l:r:a.height}this._merge(this.transformPt([-n/2,-o/2]),0),this._merge(this.transformPt([-n/2,o/2]),0),this._merge(this.transformPt([n/2,-o/2]),0),this._merge(this.transformPt([n/2,o/2]),0)}drawText(e,r){if(!r||r.length===0)return;this._textRasterizer||(this._textRasterizer=new WW);const i=sZ(e);let[s,n]=this._textRasterizer.computeTextSize(r,i);s=tt(s),n=tt(n);const o=this.transformSize(1)*this.reverseTransformScalar(1);s*=o,n*=o;let a=0;switch(e.horizontalAlignment){case"Left":a=s/2;break;case"Right":a=-s/2}let l=0;switch(e.verticalAlignment){case"Bottom":l=n/2;break;case"Top":l=-n/2;break;case"Baseline":l=n/6}this._merge(this.transformPt([-s/2+a,-n/2+l]),0),this._merge(this.transformPt([-s/2+a,n/2+l]),0),this._merge(this.transformPt([s/2+a,-n/2+l]),0),this._merge(this.transformPt([s/2+a,n/2+l]),0)}_processPath(e,r){if(e)for(const i of e){const s=i?i.length:0;if(s>1){this._merge(this.transformPt(i[0]),r);for(let n=1;n<s;n++)this._merge(this.transformPt(i[n]),r)}}}_merge(e,r){e[0]-r<this._xmin&&(this._xmin=e[0]-r),e[0]+r>this._xmax&&(this._xmax=e[0]+r),e[1]-r<this._ymin&&(this._ymin=e[1]-r),e[1]+r>this._ymax&&(this._ymax=e[1]+r)}}class zVe extends _L{constructor(){super(...arguments),this._searchPoint=[0,0],this._searchDistPoint=0,this._textInfo=null,this._svg=null,this._path=null,this._canvas=null}destroy(){this._svg=xEe(this._svg),this._path=null,this._canvas=null}hitTest(e,r,i,s,n,o){const a=o*Fe(1);this.setTransform(),this.setGeomUnitsPerPoint(a),this._searchPoint=[(e[0]+e[2])/2,(e[1]+e[3])/2],this._searchDistPoint=(e[2]-e[0])/2/a,this._textInfo=s;const l=r&&(r.type==="CIMPointSymbol"&&r.angleAlignment!=="Map"||r.type==="CIMTextSymbol");if(this._mapRotation=l?n:0,!z("esri-mobile")){const u=tt(Yge*window.devicePixelRatio),h=tt(Xge);!((r?.type==="CIMLineSymbol"||r?.type==="CIMPolygonSymbol")&&r.symbolLayers?.some(Jwe))&&r?.type!=="CIMMeshSymbol"&&(aSe(r)??0)<h&&(this._searchDistPoint=u)}return this._earlyReturn=!1,this.drawSymbol(r,i),this._earlyReturn}executeEffects(e,r){return e.at(-1)?.type==="CIMGeometricEffectDashes"&&(e=e.slice(0,-1)),super.executeEffects(e,r)}drawSolidFill(e,r,i){i!=null?this._hittestSvgPath(e,i,!0):this._hitTestFill(e)}drawHatchFill(e,r){this._hitTestFill(e)}drawPictureFill(e,r){this._hitTestFill(e)}drawGradientFill(e,r){this._hitTestFill(e)}drawSolidStroke(e,r,i,s,n,o,a){a!=null?this._hittestSvgPath(e,a,!1,i):this._hitTestStroke(e,i)}drawPictureStroke(e,r){this._hitTestStroke(e,r.width)}drawGradientStroke(e,r){this._hitTestStroke(e,r.width)}drawMarkerLayer(e,r){e.markerPlacement&&(e.markerPlacement.type==="CIMMarkerPlacementInsidePolygon"||e.markerPlacement.type==="CIMMarkerPlacementPolygonCenter"&&e.markerPlacement.clipAtBoundary)?this._hitTestFill(r):super.drawMarkerLayer(e,r)}pushClipPath(e){}popClipPath(){}drawImage(e,r){const{url:i}=e,s=Me(e.scaleX,1),n=this._resourceManager.getResource(i);if(n==null||n.height===0||r===0)return;const o=r*this.geomUnitsPerPoint(),a=o*s*(n.width/n.height),l=this.reverseTransformPt(this._searchPoint),u=this._searchDistPoint;Math.abs(l[0])<a/2+u&&Math.abs(l[1])<o/2+u&&(this._earlyReturn=!0)}drawText(e,r){const i=this._textInfo;if(!i)return;const s=i.get(e);if(!s||!s.glyphMosaicItems.glyphs.length)return;const n=QW(Me(e.height,ar.CIMTextSymbol.height)),{lineGapType:o,lineGap:a}=e,l=o?iZ(o,Me(a),n):0,u=e.callout?.type==="CIMBackgroundCallout",h=KW(s.glyphMosaicItems,{scale:n/uB,angle:0,xOffset:0,yOffset:0,horizontalAlignment:e.horizontalAlignment,verticalAlignment:e.verticalAlignment,maxLineWidth:eZ(e.lineWidth),lineHeight:lB*Math.max(.25,Math.min(l||1,4)),decoration:e.font.decoration||"none",useCIMAngleBehavior:!0,hasBackground:u}),p=this.reverseTransformPt(this._searchPoint),m=p[0],y=p[1];for(const g of h.glyphs)if(m>g.xTopLeft&&m<g.xBottomRight&&y>-g.yBottomRight&&y<-g.yTopLeft){this._earlyReturn=!0;break}}_hitTestFill(e){let r=null;if(Ni(e)){const s=e;r=[[[s.xmin,s.ymin],[s.xmin,s.ymax],[s.xmax,s.ymax],[s.xmax,s.ymin],[s.xmin,s.ymin]]]}else if(rr(e))r=e.rings;else{if(!ri(e))return;r=e.paths}const i=this.reverseTransformPt(this._searchPoint);DEe(i,r)&&(this._earlyReturn=!0),!this._earlyReturn&&B4(i,r,this.reverseTransformScalar(this._searchDistPoint)*this.prevGeomUnitsPerPoint())&&(this._earlyReturn=!0)}_getSvgPath(){return this._svg!=null&&this._path!=null||(this._svg??=SEe(),this._path??=ZW("path"),this._svg.appendChild(this._path)),this._path}_getCanvasContext(e,r){return this._canvas??=document.createElement("canvas"),this._canvas.width=e,this._canvas.height=r,this._canvas.getContext("2d",{willReadFrequently:!0})}_hittestSvgPath(e,r,i,s=0){const n=this.reverseTransformScalar(this._searchDistPoint)*this.prevGeomUnitsPerPoint(),o=this.reverseTransformPt(this._searchPoint),a=nr();G3(a,e);const l={x:a[0],y:a[1],width:a[2]-a[0],height:a[3]-a[1]},u=this._getSvgPath();u.setAttribute("d",r);const h=u.getBBox();let p=Math.max(h.width/l.width,h.height/l.height),m=1;const y=2*n*p;y<1&&(m=2/y,p*=m,h.x*=m,h.y*=m,h.width*=m,h.height*=m);const g=1+s*p/2,v=this._getCanvasContext(h.width+2*g,h.height+2*g);v.setTransform(m,0,0,m,-h.x+g,-h.y+g);const _=new Path2D(r);i?v.fill(_):(v.lineWidth=s*(p/m),v.stroke(_));const b=(l.width*p-h.width)/2,S=(l.height*p-h.height)/2,$=Math.floor((o[0]-l.x-n)*p-b+g),T=Math.floor((l.height-(o[1]-l.y)-n)*p+S+g),I=Math.ceil(2*n*p),P=Math.ceil(2*n*p),R=v.getImageData($,T,I,P).data;for(let D=3;D<R.length;D+=4)if(R[D]>127.5)return void(this._earlyReturn=!0)}_hitTestStroke(e,r){let i=null;if(Ni(e)){const s=e;i=[[[s.xmin,s.ymin],[s.xmin,s.ymax],[s.xmax,s.ymax],[s.xmax,s.ymin],[s.xmin,s.ymin]]]}else if(rr(e))i=e.rings;else{if(!ri(e))return;i=e.paths}B4(this.reverseTransformPt(this._searchPoint),i,Me(r,ar.CIMSolidStroke.width)*this.geomUnitsPerPoint()/2+this.reverseTransformScalar(this._searchDistPoint)*this.prevGeomUnitsPerPoint())&&(this._earlyReturn=!0)}}class rZ extends _L{constructor(e,r,i,s){super(r,i),this._applyAdditionalRenderProps=s,this._colorSubstitutionHelper=new jMe,this._ctx=e}drawSolidFill(e,r){if(!e)return;if(rr(e))this._buildPath(e.rings,!0);else if(ri(e))this._buildPath(e.paths,!0);else if(Ni(e))this._buildPath(ml(e).rings,!0);else{if(!Mf(e))return;console.log("CanvasDrawHelper.drawSolidFill - No implementation!")}const i=this._ctx;i.fillStyle=typeof r=="string"?r:"rgba("+Math.round(r[0])+","+Math.round(r[1])+","+Math.round(r[2])+","+(r[3]??255)/255+")",i.fill("evenodd")}drawSolidStroke(e,r,i,s,n,o){if(!e||!r||i===0)return;if(rr(e))this._buildPath(e.rings,!0);else if(ri(e))this._buildPath(e.paths,!1);else{if(!Ni(e))return void console.log("CanvasDrawHelper.drawSolidStroke isn't implemented!");this._buildPath(ml(e).rings,!0)}const a=this._ctx;a.strokeStyle=typeof r=="string"?r:"rgba("+Math.round(r[0])+","+Math.round(r[1])+","+Math.round(r[2])+","+(r[3]??255)/255+")",a.lineWidth=Math.max(this.transformSize(i),tZ),this._setCapStyle(s),this._setJoinStyle(n),a.miterLimit=o,a.stroke()}pushClipPath(e){if(this._ctx.save(),rr(e))this._buildPath(e.rings,!0);else if(ri(e))this._buildPath(e.paths,!0);else{if(!Ni(e))return;this._buildPath(ml(e).rings,!0)}this._ctx.clip("evenodd")}popClipPath(){this._ctx.restore()}drawImage(e,r){const{colorSubstitutions:i,url:s,tintColor:n}=e,o=Me(e.scaleX,1),a=this._resourceManager.getResource(s);if(a==null)return;let l=r*(a.width/a.height),u=r;r||(l=a.width,u=a.height);const h=ep(s)||"src"in a&&ep(a.src);let p="getFrame"in a?j$(a):a;i&&(p=this._colorSubstitutionHelper.applyColorSubstitution(p,i)),this._applyAdditionalRenderProps&&!h&&n&&(p=this._colorSubstitutionHelper.tintImageData(p,n));const m=this.transformPt([0,0]),[y,g]=this.getTransformAngle(),v=this.transformSize(1),_=this._ctx;_.save(),_.setTransform({m11:o*v*y,m12:o*v*g,m21:-v*g,m22:v*y,m41:m[0],m42:m[1]}),_.drawImage(p,-l/2,-u/2,l,u),_.restore()}drawText(e,r){if(!r||r.length===0)return;this._textRasterizer||(this._textRasterizer=new WW);const i=sZ(e,this.transformSize(tt(1))),s=this._textRasterizer.rasterizeText(r,i);if(!s)return;const{size:n,anchorX:o,anchorY:a,canvas:l}=s,u=n[0]*(o+.5),h=n[1]*(a-.5),p=this._ctx,m=this.transformPt([0,0]),[y,g]=this.getTransformAngle(),v=1;p.save(),p.setTransform({m11:v*y,m12:v*g,m21:-1*g,m22:v*y,m41:m[0]-v*u,m42:m[1]+v*h}),p.drawImage(l,0,0),p.restore()}drawPictureFill(e,r){if(!e)return;let{colorSubstitutions:i,height:s,offsetX:n,offsetY:o,rotation:a,scaleX:l,tintColor:u,url:h}=r;const p=this._resourceManager.getResource(h);if(p==null)return;if(rr(e))this._buildPath(e.rings,!0);else if(ri(e))this._buildPath(e.paths,!0);else if(Ni(e))this._buildPath(ml(e).rings,!0);else{if(!Mf(e))return;console.log("CanvasDrawHelper.drawPictureFill - No implementation!")}const m=this._ctx,y=ep(h)||"src"in p&&ep(p.src);let g,v="getFrame"in p?j$(p):p;if(i&&(v=this._colorSubstitutionHelper.applyColorSubstitution(v,i)),this._applyAdditionalRenderProps){y||u&&(v=this._colorSubstitutionHelper.tintImageData(v,u)),g=m.createPattern(v,"repeat");const _=this.transformSize(1);a||(a=0),n?n*=_:n=0,o?o*=_:o=0,s&&(s*=_);const b=s?s/p.height:1,S=l&&s?l*s/p.width:1;if(a!==0||b!==1||S!==1||n!==0||o!==0){const $=new DOMMatrix;$.rotateSelf(0,0,-a).translateSelf(n,o).scaleSelf(S,b,1),g.setTransform($)}}else g=m.createPattern(v,"repeat");m.save(),m.fillStyle=g,m.fill("evenodd"),m.restore()}drawPictureStroke(e,r){if(!e)return;let{colorSubstitutions:i,capStyle:s,joinStyle:n,miterLimit:o,tintColor:a,url:l,width:u}=r;const h=this._resourceManager.getResource(l);if(h==null)return;let p;if(rr(e))p=e.rings;else if(ri(e))p=e.paths;else{if(!Ni(e))return Mf(e)?void console.log("CanvasDrawHelper.drawPictureStroke - No implementation!"):void 0;p=ml(e).rings}u||(u=h.width);const m=ep(l)||"src"in h&&ep(h.src);let y="getFrame"in h?j$(h):h;i&&(y=this._colorSubstitutionHelper.applyColorSubstitution(y,i)),this._applyAdditionalRenderProps&&(m||a&&(y=this._colorSubstitutionHelper.tintImageData(y,a)));const g=Math.max(this.transformSize(Fe(u)),.5),v=g/y.width,_=this._ctx,b=_.createPattern(y,"repeat-y");let S,$;_.save(),this._setCapStyle(s),this._setJoinStyle(n),o!==void 0&&(_.miterLimit=o),_.lineWidth=g;for(let T of p)if(T=k(T),q4(T),T&&!(T.length<=1)){S=this.transformPt(T[0]);for(let I=1;I<T.length;I++){$=this.transformPt(T[I]);const P=zEe(S,$),R=new DOMMatrix;R.translateSelf(0,S[1]-g/2).scaleSelf(v,v,1).rotateSelf(0,0,90-P),b.setTransform(R),_.strokeStyle=b,_.beginPath(),_.moveTo(S[0],S[1]),_.lineTo($[0],$[1]),_.stroke(),S=$}}_.restore()}drawGradientFill(e,r){if(!e)return;let i;if(rr(e))i=e.rings;else if(ri(e))i=e.paths;else{if(!Ni(e))return void Rg().error("Unable to draw gradient fill");i=ml(e).rings}this._buildPath(i,!0);const{angle:s,gradientMethod:n,gradientSize:o,gradientSizeUnits:a}=r,l=ar.CIMGradientFill,u=r.gradientType??l.gradientType,h=-Vm(s??0),p=dne();for(const b of i){const S=b?b.length:0;if(S>1)for(let $=0;$<S;$++){let T=this.transformPt(b[$]);n!=="Linear"&&n!=="Rectangular"||(T=ja(T,-h)),Jy(p,T)}}const[m,y,g,v]=p,_=this._ctx;switch(_.save(),n){case"Buffered":Rg().error(`Gradient method "${n}" currently unsupported.`);break;case"Linear":{const b=(y+v)/2,S=a==="Absolute"?this.transformSize(Fe(o)):Iy(o,l.gradientSize)*(g-m),[$,T]=u==="Discrete"?[g,g-S]:[m+S,m],I=ja([$,b],h),P=ja([T,b],h),R=_.createLinearGradient(I[0],I[1],P[0],P[1]);t1(R,r),_.fillStyle=R,_.fill("evenodd");break}case"Circular":{const b=Bk(p),S=une(p)/2,$=a==="Absolute"?this.transformSize(Fe(o)):Iy(o,l.gradientSize)*S,[T,I]=u==="Discrete"?[S,S-$]:[$,0],P=_.createRadialGradient(b[0],b[1],T,b[0],b[1],I);t1(P,r),_.fillStyle=P,_.fill("evenodd");break}case"Rectangular":{const b=Bk(p),S=b[0],$=b[1],T=ja(b,h),I=(Z,X,le,ee,ke,Ze,it,ze)=>{_.save(),this.pushClipPath(e);const zt=ja([ke,Ze],h),ho=ja([it,ze],h);_.beginPath(),_.moveTo(T[0],T[1]),_.lineTo(zt[0],zt[1]),_.lineTo(ho[0],ho[1]),_.lineTo(T[0],T[1]),_.clip();const Hi=ja([Z,X],h),po=ja([le,ee],h),Aa=_.createLinearGradient(Hi[0],Hi[1],po[0],po[1]);t1(Aa,r),_.fillStyle=Aa,_.fill("evenodd"),_.restore()};let P=a==="Absolute"?this.transformSize(Fe(o)):Iy(o,l.gradientSize)*(d2(p)/2),[R,D]=u==="Discrete"?[g,g-P]:[S+P,S];I(R,$,D,$,g,y,g,v),[R,D]=u==="Discrete"?[m,m+P]:[S-P,S],I(R,$,D,$,m,v,m,y),P=a==="Absolute"?this.transformSize(Fe(o)):Iy(o,l.gradientSize)*(p2(p)/2);let[V,U]=u==="Discrete"?[v,v-P]:[$+P,$];I(S,V,S,U,g,v,m,v),[V,U]=u==="Discrete"?[y,y+P]:[$-P,$],I(S,V,S,U,m,y,g,y);break}}_.restore()}drawGradientStroke(e,r){const{capStyle:i,gradientMethod:s,gradientSize:n,gradientSizeUnits:o,joinStyle:a,miterLimit:l,width:u}=r;if(!e||u===0)return;let h;if(rr(e))h=e.rings;else if(ri(e))h=e.paths;else{if(!Ni(e))return void Rg().error("Unable to draw gradient stroke");h=ml(e).rings}const p=r.gradientType??ar.CIMGradientStroke.gradientType,m=Math.max(this.transformSize(Fe(u)),.5),y=this._ctx;let g,v;y.save(),this._setCapStyle(i),this._setJoinStyle(a),l!==void 0&&(y.miterLimit=l),y.lineWidth=m;for(let _ of h){if(_=k(_),q4(_),!_||_.length<=1)continue;let b=0;g=this.transformPt(_[0]);for(let T=1;T<_.length;T++){v=this.transformPt(_[T]);const I=v[0]-g[0],P=v[1]-g[1];b+=Math.sqrt(I*I+P*P),g=v}const S=o==="Absolute"?this.transformSize(Fe(n)):Iy(n,ar.CIMGradientStroke.gradientSize)*(s==="AcrossLine"?m:b);let $=0;g=this.transformPt(_[0]);for(let T=1;T<_.length;T++){v=this.transformPt(_[T]);const I=v[0]-g[0],P=v[1]-g[1],R=Math.sqrt(I*I+P*P);let D,V,U,Z;switch(s){case"AcrossLine":{const[le,ee]=ja([I/R,P/R],-Math.PI/2),ke=m/2,Ze=p==="Discrete"?ke:S-ke;D=(g[0]+v[0])/2+le*Ze,V=(g[1]+v[1])/2+ee*Ze,U=D-le*S,Z=V-ee*S;break}case"AlongLine":{const le=I/R,ee=P/R;p==="Discrete"?(D=g[0]-le*$,V=g[1]-ee*$,U=D+le*S,Z=V+ee*S):(U=g[0]+le*(b-$),Z=g[1]+ee*(b-$),D=U-le*S,V=Z-ee*S);break}default:return Rg().error("Unrecognized gradient method:",s),void y.restore()}const X=y.createLinearGradient(D,V,U,Z);t1(X,r),y.strokeStyle=X,y.beginPath(),y.moveTo(g[0],g[1]),y.lineTo(v[0],v[1]),y.stroke(),$+=R,g=v}}y.restore()}_buildPath(e,r){const i=this._ctx;if(i.beginPath(),e)for(const s of e){const n=s?s.length:0;if(n>1){let o=this.transformPt(s[0]);i.moveTo(o[0],o[1]);for(let a=1;a<n;a++)o=this.transformPt(s[a]),i.lineTo(o[0],o[1]);r&&i.closePath()}}}_setCapStyle(e){switch(e){case us.Butt:this._ctx.lineCap="butt";break;case us.Round:this._ctx.lineCap="round";break;case us.Square:this._ctx.lineCap="square"}}_setJoinStyle(e){switch(e){case pn.Bevel:this._ctx.lineJoin="bevel";break;case pn.Round:this._ctx.lineJoin="round";break;case pn.Miter:this._ctx.lineJoin="miter"}}}function FEe(t,e,r){let i=Me(t.separation,ar.CIMHatchFill.separation)*r,s=Me(t.rotation);if(i===0)return null;i<0&&(i=-i);let n=0;const o=.5*i;for(;n>o;)n-=i;for(;n<-o;)n+=i;const a=nr();G3(a,e),a[0]-=o,a[1]-=o,a[2]+=o,a[3]+=o;const l=[[a[0],a[1]],[a[0],a[3]],[a[2],a[3]],[a[2],a[1]]];for(;s>180;)s-=180;for(;s<0;)s+=180;const u=Math.cos(s*Rh),h=Math.sin(s*Rh),p=-i*h,m=i*u;let y,g,v,_;n=Me(t.offsetX)*r*h-Me(t.offsetY)*r*u,y=v=Number.MAX_VALUE,g=_=-Number.MAX_VALUE;for(const R of l){const D=R[0],V=R[1],U=u*D+h*V,Z=-h*D+u*V;y=Math.min(y,U),v=Math.min(v,Z),g=Math.max(g,U),_=Math.max(_,Z)}v=Math.floor(v/i)*i;let b=u*y-h*v-p*n/i,S=h*y+u*v-m*n/i,$=u*g-h*v-p*n/i,T=h*g+u*v-m*n/i;const I=1+Math.round((_-v)/i),P=[];for(let R=0;R<I;R++)b+=p,S+=m,$+=p,T+=m,P.push([[b,S],[$,T]]);return{paths:P}}function DEe(t,e){let r=0;for(const i of e){const s=i.length;for(let n=1;n<s;n++){const o=i[n-1],a=i[n];o[1]>t[1]!=a[1]>t[1]&&((a[0]-o[0])*(t[1]-o[1])-(a[1]-o[1])*(t[0]-o[0])>0?r++:r--)}}return r!==0}function B4(t,e,r){for(const i of e){const s=i.length;for(let n=1;n<s;n++){const o=i[n-1],a=i[n];let l=(a[0]-o[0])*(a[0]-o[0])+(a[1]-o[1])*(a[1]-o[1]);if(l===0)continue;l=Math.sqrt(l);const u=((a[0]-o[0])*(t[1]-o[1])-(a[1]-o[1])*(t[0]-o[0]))/l;if(Math.abs(u)<r){const h=((a[0]-o[0])*(t[0]-o[0])+(a[1]-o[1])*(t[1]-o[1]))/l;if(h>-r&&h<l+r)return!0}}}return!1}function zEe(t,e){const r=e[0]-t[0],i=e[1]-t[1];return 180/Math.PI*Math.atan2(i,r)}const ml=t=>t?{spatialReference:t.spatialReference,rings:[[[t.xmin,t.ymin],[t.xmin,t.ymax],[t.xmax,t.ymax],[t.xmax,t.ymin],[t.xmin,t.ymin]]]}:null,iZ=(t,e,r)=>{switch(t){case"ExtraLeading":return 1+e/r;case"Multiple":return e;case"Exact":return e/r}};function sZ(t,e=1){const r=yH(t),i=mH(t.fontStyleName),s=t.fontFamilyName??pL,{weight:n,style:o}=i,a=e*(t.height||5),l=eSe(t.horizontalAlignment),u=tSe(t.verticalAlignment),h=v0(t),p=v0(t.haloSymbol),m=p!=null?e*(t.haloSize??0):0,y=bS(t.symbol),g=e*(wS(t.symbol)||0),v=t.callout?.type==="CIMBackgroundCallout"?t.callout.backgroundSymbol:null,_=v0(v),b=wS(v),S=bS(v);return{color:h,size:a,horizontalAlignment:l,verticalAlignment:u,font:{family:s,style:Kwe(o),weight:Qwe(n),decoration:r},outline:{size:g||0,color:y},halo:{size:m||0,color:p,style:o},backgroundColor:_,borderLine:b!=null&&S!=null?{size:b,color:S}:null,pixelRatio:1,premultiplyColors:!0}}const VEe=1e-4;function q4(t){let e,r,i,s,n,o=t[0],a=1;for(;a<t.length;)e=t[a][0]-o[0],r=t[a][1]-o[1],s=e!==0?r/e:Math.PI/2,i!==void 0&&Math.abs(s-i)<=VEe?(t.splice(a-1,1),o=n):(n=o,o=t[a],a++),i=s}const s1=Number.POSITIVE_INFINITY,bL=Math.PI,VVe=2*bL,jEe=128/bL,UEe=256/360,jVe=bL/180,GEe=1/Math.LN2;function nZ(t,e){return(t%=e)>=0?t:t+e}function UVe(t){return nZ(t*jEe,256)}function GVe(t){return nZ(t*UEe,256)}function BVe(t){return Math.log(t)*GEe}function qVe(t,e,r){return t*(1-r)+e*r}const BEe=8,qEe=14,HEe=16;function HVe(t){return BEe+Math.max((t-qEe)*HEe,0)}function WVe(t,e,r){let i,s,n,o=0;for(const a of r){i=a.length;for(let l=1;l<i;++l)s=a[l-1],n=a[l],s.y>e!=n.y>e&&((n.x-s.x)*(e-s.y)-(n.y-s.y)*(t-s.x)>0?o++:o--)}return o!==0}function ZVe(t,e,r,i){let s,n,o,a;const l=i*i;for(const u of r){const h=u.length;if(!(h<2)){s=u[0].x,n=u[0].y;for(let p=1;p<h;++p){if(o=u[p].x,a=u[p].y,Hse(t,e,s,n,o,a)<l)return!0;s=o,n=a}}}return!1}function JVe(t,e,r,i,s,n,o){const a=Math.max(i,Math.min(e,n))-e,l=Math.max(s,Math.min(r,o))-r;return a*a+l*l<=t*t}function YVe(t,e){if(e===0||Number.isNaN(e))return t;const r=[],i=new Ne(0,0),s=new Ne(0,0),n=new Ne(0,0);for(let o=0;o<t.length;o++){const a=t[o],l=[];for(let u=0;u<a.length;u++){const h=a[u-1],p=a[u],m=a[u+1];u===0?i.setCoords(0,0):i.assignSub(p,h).normalize().rightPerpendicular(),u===a.length-1?s.setCoords(0,0):s.assignSub(m,p).normalize().rightPerpendicular(),n.assignAdd(i,s).normalize();const y=n.x*s.x+n.y*s.y;y!==0&&n.scale(1/y),l.push(Ne.add(p,n.scale(e)))}r.push(l)}return r}function XVe(t,e,r,i){const s=new Ne(t[0],t[1]);if(s.scale(i),e==="viewport"){const n=-r*(Math.PI/180),o=Math.cos(n),a=Math.sin(n);s.rotate(o,a)}return s}const oZ=Math.PI,WEe=oZ/2,H4=Math.PI/180,B$=96/72,ZEe=1.4142135623730951,W4=2,Z4=4,RS=()=>q.getLogger("esri.symbols.cim.CIMSymbolHelper");function KVe(t){let e;switch(t.type){case"cim":return t.data;case"web-style":return t;case"simple-marker":{const r=rn.fromSimpleMarker(t);if(!r)throw new Error("InternalError: Cannot convert symbol to CIM");e=r;break}case"picture-marker":e=rn.fromPictureMarker(t);break;case"simple-line":e=rn.fromSimpleLineSymbol(t);break;case"simple-fill":e=rn.fromSimpleFillSymbol(t);break;case"picture-fill":e=rn.fromPictureFillSymbol(t);break;case"text":e=rn.fromTextSymbol(t)}return{type:"CIMSymbolReference",symbol:e}}function Lb(t,e,r){switch(e.type){case"CIMSymbolReference":return Lb(t,e.symbol,r);case"CIMPointSymbol":r==null&&(r={x:0,y:0}),t.drawSymbol(e,r);break;case"CIMLineSymbol":r==null&&(r={paths:[[[0,0],[10,0]]]}),t.drawSymbol(e,r);break;case"CIMPolygonSymbol":r==null&&(r={rings:[[[0,0],[0,10],[10,10],[10,0],[0,0]]]}),t.drawSymbol(e,r);break;case"CIMTextSymbol":{const i={x:0,y:0};t.drawSymbol(e,i);break}case"CIMVectorMarker":{const i=new Jm;t.drawMarker(e,i);break}}return t.envelope()}function JEe(t){if(!t)return 0;switch(t.type){case"CIMMarkerPlacementAlongLineSameSize":case"CIMMarkerPlacementAlongLineRandomSize":case"CIMMarkerPlacementAtExtremities":case"CIMMarkerPlacementAtMeasuredUnits":case"CIMMarkerPlacementAtRatioPositions":case"CIMMarkerPlacementOnLine":case"CIMMarkerPlacementOnVertices":return Math.abs(t.offset);default:return 0}}function YEe(t){if(!t)return 0;switch(t.type){case"CIMGeometricEffectArrow":return Math.abs(.5*t.width);case"CIMGeometricEffectBuffer":return Math.abs(t.size);case"CIMGeometricEffectControlMeasureLine":return 500;case"CIMGeometricEffectExtension":case"CIMGeometricEffectRadial":return Math.abs(t.length);case"CIMGeometricEffectJog":return Math.abs(.5*t.length);case"CIMGeometricEffectMove":return Math.max(Math.abs(Me(t.offsetX)),Math.abs(Me(t.offsetY)));case"CIMGeometricEffectOffset":case"CIMGeometricEffectOffsetTangent":return Math.abs(t.offset);case"CIMGeometricEffectRegularPolygon":return Math.abs(t.radius);case"CIMGeometricEffectRotate":case"CIMGeometricEffectScale":default:return 0;case"CIMGeometricEffectTaperedPolygon":return .5*Math.max(Math.abs(t.fromWidth),Math.abs(t.toWidth));case"CIMGeometricEffectWave":return Math.abs(t.amplitude);case"CIMGeometricEffectDonut":return Math.abs(t.width)}}function J4(t){if(!t)return 0;let e=0;for(const r of t)e+=YEe(r);return e}let QVe=class{static getSymbolInflateSize(e,r,i,s,n){return e||(e=[0,0,0,0]),r?this._getInflateSize(e,r,i,s,n):e}static safeSize(e){const r=Math.max(Math.abs(e[0]),Math.abs(e[2])),i=Math.max(Math.abs(e[1]),Math.abs(e[3]));return Math.sqrt(r*r+i*i)}static _vectorMarkerBounds(e,r,i,s){let n=!0;const o=nr();if(r?.markerGraphics)for(const a of r.markerGraphics){const l=[0,0,0,0];a.geometry&&(G3(o,a.geometry),l[0]=0,l[1]=0,l[2]=0,l[3]=0,this.getSymbolInflateSize(l,a.symbol,i,0,s),o[0]+=l[0],o[1]+=l[1],o[2]+=l[2],o[3]+=l[3],n?(e[0]=o[0],e[1]=o[1],e[2]=o[2],e[3]=o[3],n=!1):(e[0]=Math.min(e[0],o[0]),e[1]=Math.min(e[1],o[1]),e[2]=Math.max(e[2],o[2]),e[3]=Math.max(e[3],o[3])))}return e}static _getInflateSize(e,r,i,s,n){if(rIe(r)){const o=this._getLayersInflateSize(e,r.symbolLayers,i,s,n),a=J4(r.effects);return a>0&&(o[0]-=a,o[1]-=a,o[2]+=a,o[3]+=a),o}return this._getTextInflatedSize(e,r,n)}static _getLayersInflateSize(e,r,i,s,n){let o=!0;if(!r)return e;for(const a of r){if(!a)continue;let l=[0,0,0,0];switch(a.type){case"CIMSolidFill":case"CIMPictureFill":case"CIMHatchFill":case"CIMGradientFill":break;case"CIMSolidStroke":case"CIMPictureStroke":case"CIMGradientStroke":{const h=a;let p=h.width;p!=null&&(h.capStyle===us.Square||h.joinStyle===pn.Miter?p/=ZEe:p/=2,l[0]=-p,l[1]=-p,l[2]=p,l[3]=p);break}case"CIMCharacterMarker":case"CIMVectorMarker":case"CIMPictureMarker":{const h=a;if(a.type==="CIMVectorMarker"){const v=a;if(l=this._vectorMarkerBounds(l,v,i,n),v.frame){const _=(v.frame.xmin+v.frame.xmax)/2,b=(v.frame.ymin+v.frame.ymax)/2;if(l[0]-=_,l[1]-=b,l[2]-=_,l[3]-=b,v.size!=null){const S=v.size/(v.frame.ymax-v.frame.ymin);l[0]*=S,l[1]*=S,l[2]*=S,l[3]*=S}}}else if(a.type==="CIMPictureMarker"){const v=a,_=i.getResource(v.url);let b=1;if(_!=null&&_.height&&(b=_.width/_.height),h.size!=null){const S=h.size/2,$=h.size*b*v.scaleX/2;l=[-$,-S,$,S]}}else if(h.size!=null){const v=h.size/2;l=[-v,-v,v,v]}if(h.anchorPoint){let v,_;h.anchorPointUnits==="Absolute"?(v=h.anchorPoint.x,_=h.anchorPoint.y):(v=h.anchorPoint.x*(l[2]-l[0]),_=h.anchorPoint.y*(l[3]-l[1]));const b=1.25*Math.sqrt(v*v+_*_);l[0]-=b,l[1]-=b,l[2]+=b,l[3]+=b}let p=Me(h.rotation);if(h.rotateClockwise&&(p=-p),s&&(p-=s),p){const v=H4*p,_=Math.cos(v),b=Math.sin(v),S=nr([s1,s1,-s1,-s1]);Jy(S,[l[0]*_-l[1]*b,l[0]*b+l[1]*_]),Jy(S,[l[0]*_-l[3]*b,l[0]*b+l[3]*_]),Jy(S,[l[2]*_-l[1]*b,l[2]*b+l[1]*_]),Jy(S,[l[2]*_-l[3]*b,l[2]*b+l[3]*_]),l=S}let m=Me(h.offsetX),y=Me(h.offsetY);if(s){const v=H4*s,_=Math.cos(v),b=Math.sin(v),S=m*b+y*_;m=m*_-y*b,y=S}l[0]+=m,l[1]+=y,l[2]+=m,l[3]+=y;const g=JEe(h.markerPlacement);g>0&&(l[0]-=g,l[1]-=g,l[2]+=g,l[3]+=g);break}}const u=J4(a.effects);u>0&&(l[0]-=u,l[1]-=u,l[2]+=u,l[3]+=u),o?(e[0]=l[0],e[1]=l[1],e[2]=l[2],e[3]=l[3],o=!1):(e[0]=Math.min(e[0],l[0]),e[1]=Math.min(e[1],l[1]),e[2]=Math.max(e[2],l[2]),e[3]=Math.max(e[3],l[3]))}return e}static _getTextInflatedSize(e,r,i){const s=QW(r.height??ar.CIMTextSymbol.height);if(e[0]=-s/2,e[1]=-s/2,e[2]=s/2,e[3]=s/2,!i)return e;const n=i.get(r);if(!n||!n.glyphMosaicItems.glyphs.length)return e;const{lineGapType:o,lineGap:a}=r,l=o?iZ(o,a??0,s):0,u=r.callout?.type==="CIMBackgroundCallout",h=KW(n.glyphMosaicItems,{scale:s/uB,angle:Me(r.angle),xOffset:Me(r.offsetX),yOffset:Me(r.offsetY),horizontalAlignment:r.horizontalAlignment,verticalAlignment:r.verticalAlignment,maxLineWidth:eZ(r.lineWidth),lineHeight:lB*Math.max(.25,Math.min(l||1,4)),decoration:r.font.decoration||"none",useCIMAngleBehavior:!0,hasBackground:u}).boundsT,p=Math.sqrt(h.width*h.width+h.height*h.height);return e[0]-=h.x+p,e[1]-=h.y-p,e[2]+=h.x+p,e[3]+=-h.y+p,e}},rn=class Rb{static getEnvelope(e,r,i){if(!e)return null;const s=new NEe(i);if(Array.isArray(e)){let n;for(const o of e)n?n.union(Lb(s,o,r)):n=Lb(s,o,r);return n}return Lb(s,e,r)}static getTextureInfo(e,r,i,s,n){const o=s??this.getEnvelope(e,null,r);if(!o)return[0,0,0,0,1];const a=Math.max(o.width,o.height)*B$;let l=n!=null?Math.max(n/a,1):1;l*=B$,o.x*=l,o.y*=l,o.width*=l,o.height*=l,o.width=Math.max(Math.ceil(o.x+o.width)-Math.floor(o.x),1)-1,o.height=Math.max(Math.ceil(o.y+o.height)-Math.floor(o.y),1)-1;let u=o.x+.5*o.width,h=o.y+.5*o.height;return u+=o.x-Math.floor(o.x),h+=o.y-Math.floor(o.y),s||(o.width+=i,o.height+=i,u+=i/2,h+=i/2),[o.width,o.height,u,h,l]}static getTextureAnchor(e,r,i){const[s,n,o,a,l]=this.getTextureInfo(e,r,W4,null,i);return[-o/s,-a/n,n/l*B$]}static rasterize(e,r,i,s,n=!0,o){const[a,l,u,h,p]=this.getTextureInfo(r,s,W4,i,o);e.width=a,e.height=l;const m=e.getContext("2d",{willReadFrequently:!0}),y=Br.createScale(p,-p);y.translate(.5*a-u,.5*l+h);const g=new rZ(m,s,y);switch(r.type){case"CIMPointSymbol":{const b={type:"point",x:0,y:0};g.drawSymbol(r,b);break}case"CIMVectorMarker":{const b=new Jm;g.drawMarker(r,b);break}}const v=m.getImageData(0,0,e.width,e.height),_=new Uint8Array(v.data);if(n){let b;for(let S=0;S<_.length;S+=4)b=_[S+3]/255,_[S]=_[S]*b,_[S+1]=_[S+1]*b,_[S+2]=_[S+2]*b}return[_,e.width,e.height,-u/a,-h/l]}static fromTextSymbol(e){const{text:r}=e;return{type:"CIMPointSymbol",symbolLayers:[{type:"CIMVectorMarker",enable:!0,anchorPointUnits:"Relative",dominantSizeAxis3D:"Y",size:10,billboardMode3D:"FaceNearPlane",frame:{xmin:-5,ymin:-5,xmax:5,ymax:5},markerGraphics:[{type:"CIMMarkerGraphic",geometry:{x:0,y:0},symbol:Rb.createCIMTextSymbolfromTextSymbol(e),textString:r}],scaleSymbolsProportionally:!0,respectFrame:!0}],scaleX:1,angleAlignment:"Display"}}static fromPictureFillSymbol(e){const{height:r,outline:i,width:s,xoffset:n,xscale:o,yoffset:a,yscale:l}=e,u=[],h={type:"CIMPolygonSymbol",symbolLayers:u};if(i){const v=Y4(i);v&&u.push(v)}let p=e.url;e.type==="esriPFS"&&e.imageData&&(p=e.imageData);const m="angle"in e?e.angle??0:0,y=(s??0)*(o||1),g=(r??0)*(l||1);return u.push({type:"CIMPictureFill",invertBackfaceTexture:!1,scaleX:1,textureFilter:lf.Picture,tintColor:null,url:p,height:g,width:y,offsetX:Me(n),offsetY:Me(a),rotation:Me(-m),colorSubstitutions:null}),h}static fromSimpleFillSymbol(e){const{color:r,style:i,outline:s}=e,n=[],o={type:"CIMPolygonSymbol",symbolLayers:n};if(s){const a=Y4(s);a&&n.push(a)}if(i&&i!=="solid"&&i!=="none"&&i!=="esriSFSSolid"&&i!=="esriSFSNull"){const a={type:"CIMLineSymbol",symbolLayers:[{type:"CIMSolidStroke",color:xs(r),capStyle:us.Butt,joinStyle:pn.Miter,width:.75}]};let l=0;const u=tt(iIe(i)?8:10);switch(i){case"vertical":case"esriSFSVertical":l=90;break;case"forward-diagonal":case"esriSFSForwardDiagonal":case"diagonal-cross":case"esriSFSDiagonalCross":l=-45;break;case"backward-diagonal":case"esriSFSBackwardDiagonal":l=45;break;case"cross":case"esriSFSCross":l=0}n.push({type:"CIMHatchFill",lineSymbol:a,offsetX:0,offsetY:0,rotation:l,separation:u}),i==="cross"||i==="esriSFSCross"?n.push({type:"CIMHatchFill",lineSymbol:k(a),offsetX:0,offsetY:0,rotation:90,separation:u}):i!=="diagonal-cross"&&i!=="esriSFSDiagonalCross"||n.push({type:"CIMHatchFill",lineSymbol:k(a),offsetX:0,offsetY:0,rotation:45,separation:u})}else!i||i!=="solid"&&i!=="esriSFSSolid"||n.push({type:"CIMSolidFill",enable:!0,color:xs(r)});return o}static fromSimpleLineSymbol(e){const{cap:r,color:i,join:s,marker:n,miterLimit:o,style:a,width:l}=e;let u=null;a!=="solid"&&a!=="none"&&a!=="esriSLSSolid"&&a!=="esriSLSNull"&&(u=[{type:"CIMGeometricEffectDashes",dashTemplate:UC(a,r),lineDashEnding:"NoConstraint",scaleDash:!0,offsetAlongLine:null}]);const h=[];if(n){let p;switch(n.placement){case"begin-end":p=ya.Both;break;case"begin":p=ya.JustBegin;break;case"end":p=ya.JustEnd;break;default:p=ya.None}const m=Rb.fromSimpleMarker(n,l,i).symbolLayers[0];m.markerPlacement={type:"CIMMarkerPlacementAtExtremities",placePerPart:!1,angleToLine:!0,offset:0,extremityPlacement:p,offsetAlongLine:0},h.push(m)}return h.push({type:"CIMSolidStroke",color:a!=="none"&&a!=="esriSLSNull"?xs(i):[0,0,0,0],capStyle:lZ(r),joinStyle:uZ(s),miterLimit:o,width:l,effects:u}),{type:"CIMLineSymbol",symbolLayers:h}}static fromPictureMarker(e){const{angle:r,height:i,width:s,xoffset:n,yoffset:o}=e;let a=e.url;return e.type==="esriPMS"&&e.imageData&&(a=e.imageData),{type:"CIMPointSymbol",symbolLayers:[{type:"CIMPictureMarker",invertBackfaceTexture:!1,scaleX:1,textureFilter:lf.Picture,tintColor:null,url:a,size:i,width:s,offsetX:Me(n),offsetY:Me(o),rotation:Me(-r)}]}}static createCIMTextSymbolfromTextSymbol(e){const{angle:r,color:i,font:s,haloColor:n,haloSize:o,horizontalAlignment:a,kerning:l,lineWidth:u,text:h,verticalAlignment:p,xoffset:m,yoffset:y,backgroundColor:g,borderLineColor:v,borderLineSize:_}=e;let b,S,$,T,I,P;s&&(b=s.family,S=s.style,$=s.weight,T=s.size,I=s.decoration);let R=!1;return h&&(R=MMe(h)[1]),(g||_)&&(P={type:"CIMBackgroundCallout",margin:null,backgroundSymbol:{type:"CIMPolygonSymbol",symbolLayers:[{type:"CIMSolidFill",color:xs(g)},{type:"CIMSolidStroke",color:xs(v),width:_}]},accentBarSymbol:null,gap:null,leaderLineSymbol:null,lineStyle:null}),{type:"CIMTextSymbol",angle:r,blockProgression:cC.BTT,depth3D:1,extrapolateBaselines:!0,fontEffects:nC.Normal,fontEncoding:oC.Unicode,fontFamilyName:b||"Arial",fontStyleName:QEe(S,$),fontType:aC.Unspecified,haloSize:o,height:T,hinting:dC.Default,horizontalAlignment:XEe(a??"center"),kerning:l,letterWidth:100,ligatures:!0,lineGapType:"Multiple",lineWidth:u,offsetX:Me(m),offsetY:Me(y),strikethrough:I==="line-through",underline:I==="underline",symbol:{type:"CIMPolygonSymbol",symbolLayers:[{type:"CIMSolidFill",enable:!0,color:xs(i)}]},haloSymbol:{type:"CIMPolygonSymbol",symbolLayers:[{type:"CIMSolidFill",enable:!0,color:xs(n)}]},shadowColor:[0,0,0,255],shadowOffsetX:1,shadowOffsetY:1,textCase:"Normal",textDirection:R?_S.RTL:_S.LTR,verticalAlignment:KEe(p??"baseline"),verticalGlyphOrientation:fC.Right,wordSpacing:100,billboardMode3D:hC.FaceNearPlane,callout:P}}static createPictureMarkerRasterizationParam(e){const{angle:r,height:i,width:s,xoffset:n,yoffset:o}=e,a=e.url??e.source?.url??e.source?.imageData;return a?{type:"sprite-rasterization-param",overrides:[],resource:{type:"CIMPictureMarker",invertBackfaceTexture:!1,scaleX:1,textureFilter:lf.Picture,tintColor:null,url:a,size:i,width:s,offsetX:Me(n),offsetY:Me(o),rotation:Me(-r)}}:null}static createPictureFillRasterizationParam(e){const{width:r,height:i,xoffset:s,yoffset:n,url:o}=e;return o?{type:"sprite-rasterization-param",overrides:[],resource:{type:"CIMPictureFill",scaleX:1,textureFilter:lf.Picture,tintColor:null,url:o,width:r,height:i,offsetX:Me(s),offsetY:Me(n),rotation:0}}:null}static fromSimpleMarker(e,r,i){const{style:s}=e,n=e.color??i;if(s==="path"||s==="esriSMSPath"){const p=[];if("outline"in e&&e.outline){const g=e.outline;p.push({type:"CIMSolidStroke",enable:!0,width:g.width,color:xs(g.color),path:e.path})}p.push({type:"CIMSolidFill",enable:!0,color:xs(n),path:e.path});const[m,y]=Ny("square");return{type:"CIMPointSymbol",symbolLayers:[{type:"CIMVectorMarker",enable:!0,rotation:-Me(e.angle),size:Me(e.size||6),offsetX:Me(e.xoffset),offsetY:Me(e.yoffset),scaleSymbolsProportionally:!1,frame:m,markerGraphics:[{type:"CIMMarkerGraphic",geometry:y,symbol:{type:"CIMPolygonSymbol",symbolLayers:p}}]}]}}const o=[];let a,l,u=e.size;if("outline"in e&&e.outline&&e.outline.style!=="none"&&e.outline.style!=="esriSLSNull"){const p=e.outline,m=p.style!=="solid"&&p.style!=="esriSLSSolid";[a,l]=m?Ny(s,e.size):Ny(s);const y=p.width??q2.width;if(m){const _=y/e.size,b=(a.xmax-a.xmin)*_/2,S=(a.ymax-a.ymin)*_/2;a.xmin-=b,a.xmax+=b,a.ymin-=S,a.ymax+=S,u&&(u+=y)}const g=e.style!=="cross"&&e.style!=="x"||e?.outline.style==="dot"||e?.outline.style==="short-dot"?Qr.HalfGap:Qr.FullPattern,v=m?[{type:"CIMGeometricEffectAddControlPoints"},{type:"CIMGeometricEffectDashes",dashTemplate:UC(p.style,null).map((_=>p.width&&p.width>0?_*p.width:_)),lineDashEnding:g,controlPointEnding:Qr.FullPattern}]:void 0;o.push({type:"CIMSolidStroke",capStyle:m?us.Round:us.Butt,enable:!0,width:y,color:xs(p.color),effects:v})}else!r||e.type!=="line-marker"||e.style!=="cross"&&e.style!=="x"?[a,l]=Ny(s):([a,l]=Ny(s),o.push({type:"CIMSolidStroke",enable:!0,width:r,color:xs(n)}));o.push({type:"CIMSolidFill",enable:!0,color:xs(n)});const h={type:"CIMPolygonSymbol",symbolLayers:o};return{type:"CIMPointSymbol",symbolLayers:[{type:"CIMVectorMarker",enable:!0,rotation:Me(-e.angle),size:Me(u||6*r),offsetX:Me(e.xoffset),offsetY:Me(e.yoffset),scaleSymbolsProportionally:!1,frame:a,markerGraphics:[{type:"CIMMarkerGraphic",geometry:l,symbol:h}]}]}}static fromCIMHatchFill(e,r){const i=r*(e.separation??ar.CIMHatchFill.separation),s=i/2,n=k(e.lineSymbol);n.symbolLayers?.forEach((l=>{switch(l.type){case"CIMSolidStroke":l.width!=null&&(l.width*=r),l.effects?.forEach((u=>{if(u.type==="CIMGeometricEffectDashes"){const h=u.dashTemplate;u.dashTemplate=h?.map((p=>p*r))}}));break;case"CIMVectorMarker":{l.size!=null&&(l.size*=r);const u=l.markerPlacement;u!=null&&"placementTemplate"in u&&(u.placementTemplate=u.placementTemplate.map((h=>h*r)));break}}}));let o=this._getLineSymbolPeriod(n)||Z4;for(;o<Z4;)o*=2;const a=o/2;return{type:"CIMVectorMarker",frame:{xmin:-a,xmax:a,ymin:-s,ymax:s},markerGraphics:[{type:"CIMMarkerGraphic",geometry:{paths:[[[-a,0],[a,0]]]},symbol:n}],size:i}}static fetchResources(e,r,i,s=null){return e&&r&&aZ(e,(n=>{sIe(n,r,i),"url"in n&&n.url&&i.push(r.fetchResource(n.url,{signal:s}))})),i}static fetchFonts(e,r,i){if(e&&r){if("symbolLayers"in e&&e.symbolLayers){for(const s of e.symbolLayers)if(s.type==="CIMVectorMarker"&&s.markerGraphics)for(const n of s.markerGraphics)n?.symbol&&Rb.fetchFonts(n.symbol,r,i)}else if(e.type==="CIMTextSymbol"){const{fontFamilyName:s,fontStyleName:n}=e;if(!s||s.toLowerCase()==="calcitewebcoreicons")return;const{style:o,weight:a}=mH(n),l=yH(e),u=new Is({family:s,style:o,weight:a,decoration:l});i.push(r.loadFont(u).catch((()=>{RS().error(`Unsupported font ${s} in CIM symbol`)})))}}}static _getLineSymbolPeriod(e){if(e){const r=this._getEffectsRepeat(e.effects);if(r)return r;if(e.symbolLayers){for(const i of e.symbolLayers)if(i){const s=this._getEffectsRepeat(i.effects);if(s)return s;switch(i.type){case"CIMCharacterMarker":case"CIMPictureMarker":case"CIMVectorMarker":case"CIMObjectMarker3D":case"CIMglTFMarker3D":{const n=this._getPlacementRepeat(i.markerPlacement);if(n)return n}}}}}return 0}static _getEffectsRepeat(e){if(e){for(const r of e)if(r)switch(r.type){case"CIMGeometricEffectDashes":{const i=r.dashTemplate;if(i&&i.length){let s=0;for(const n of i)s+=n;return 1&i.length&&(s*=2),s}break}case"CIMGeometricEffectWave":return r.period;default:RS().error(`unsupported geometric effect type ${r.type}`)}}return 0}static _getPlacementRepeat(e){if(e)switch(e.type){case"CIMMarkerPlacementAlongLineSameSize":case"CIMMarkerPlacementAlongLineRandomSize":case"CIMMarkerPlacementAlongLineVariableSize":{const r=e.placementTemplate;if(r&&r.length){let i=0;for(const s of r)i+=+s;return 1&r.length&&(i*=2),i}break}}return 0}static fromCIMInsidePolygon(e){const r=e.markerPlacement,i={...e};i.markerPlacement=null,i.anchorPoint=null;const s=Math.abs(r.stepX),n=Math.abs(r.stepY),o=(r.randomness??100)/100;let a,l,u,h;if(r.gridType==="Random"){const p=tt(e0e),m=Math.max(Math.floor(p/s),1),y=Math.max(Math.floor(p/n),1);a=m*s/2,l=y*n/2,u=2*l;const g=new RP(r.seed),v=o*s/1.5,_=o*n/1.5;h=[];for(let b=0;b<m;b++)for(let S=0;S<y;S++){const $=b*s-a+v*(.5-g.getFloat()),T=S*n-l+_*(.5-g.getFloat());h.push({x:$,y:T}),b===0&&h.push({x:$+2*a,y:T}),S===0&&h.push({x:$,y:T+2*l})}}else r.shiftOddRows===!0?(a=s/2,l=n,u=2*n,h=[{x:-a,y:0},{x:a,y:0},{x:0,y:l},{x:0,y:-l}]):(a=s/2,l=n/2,u=n,h=[{x:-s,y:0},{x:0,y:-n},{x:-s,y:-n},{x:0,y:0},{x:s,y:0},{x:0,y:n},{x:s,y:n},{x:-s,y:n},{x:s,y:-n}]);return{type:"CIMVectorMarker",frame:{xmin:-a,xmax:a,ymin:-l,ymax:l},markerGraphics:h.map((p=>({type:"CIMMarkerGraphic",geometry:p,symbol:{type:"CIMPointSymbol",symbolLayers:[i]}}))),size:u}}};function aZ(t,e){if(t)switch(t.type){case"CIMPointSymbol":case"CIMLineSymbol":case"CIMPolygonSymbol":{const r=t.symbolLayers;if(!r)return;for(const i of r)if(e(i),i.type==="CIMVectorMarker"){const s=i.markerGraphics;if(!s)continue;for(const n of s)if(n){const o=n.symbol;o&&aZ(o,e)}}break}}}const lZ=t=>{if(!t)return us.Butt;switch(t){case"butt":return us.Butt;case"square":return us.Square;case"round":return us.Round}},uZ=t=>{if(!t)return pn.Miter;switch(t){case"miter":return pn.Miter;case"round":return pn.Round;case"bevel":return pn.Bevel}},XEe=t=>{if(t==null)return"Center";switch(t){case"left":return"Left";case"right":return"Right";case"center":return"Center"}},KEe=t=>{if(t==null)return"Center";switch(t){case"baseline":return"Baseline";case"top":return"Top";case"middle":return"Center";case"bottom":return"Bottom"}},xs=t=>{if(!t)return[0,0,0,0];const{r:e,g:r,b:i,a:s}=t;return[e,r,i,255*s]},QEe=(t,e)=>{const r=eIe(e),i=tIe(t);return r&&i?`${r}-${i}`:`${r}${i}`},eIe=t=>{if(!t)return"";switch(t.toLowerCase()){case"bold":case"bolder":return"bold"}return""},tIe=t=>{if(!t)return"";switch(t.toLowerCase()){case"italic":case"oblique":return"italic"}return""},UC=(t,e)=>{const r=z("safari")?.001:0,i=e==="butt";switch(t){case"dash":case"esriSLSDash":return i?[4,3]:[3,4];case"dash-dot":case"esriSLSDashDot":return i?[4,3,1,3]:[3,4,r,4];case"dot":case"esriSLSDot":return i?[1,3]:[r,4];case"long-dash":case"esriSLSLongDash":return i?[8,3]:[7,4];case"long-dash-dot":case"esriSLSLongDashDot":return i?[8,3,1,3]:[7,4,r,4];case"long-dash-dot-dot":case"esriSLSDashDotDot":return i?[8,3,1,3,1,3]:[7,4,r,4,r,4];case"short-dash":case"esriSLSShortDash":return i?[4,1]:[3,2];case"short-dash-dot":case"esriSLSShortDashDot":return i?[4,1,1,1]:[3,2,r,2];case"short-dash-dot-dot":case"esriSLSShortDashDotDot":return i?[4,1,1,1,1,1]:[3,2,r,2,r,2];case"short-dot":case"esriSLSShortDot":return i?[1,1]:[r,2];case"solid":case"esriSLSSolid":case"none":return RS().error("Unexpected: style does not require rasterization"),[0,0];default:return RS().error(`Tried to rasterize SLS, but found an unexpected style: ${t}!`),[0,0]}};function rIe(t){return t.symbolLayers!==void 0}const Ny=(t,e=100)=>{const r=e/2;let i,s;const n=t;if(n==="circle"||n==="esriSMSCircle"){let a=Math.acos(1-.25/r),l=Math.ceil(oZ/a/4);l===0&&(l=1),a=WEe/l,l*=4;const u=[];u.push([r,0]);for(let h=1;h<l;h++)u.push([r*Math.cos(h*a),-r*Math.sin(h*a)]);u.push([r,0]),i={rings:[u]},s={xmin:-r,ymin:-r,xmax:r,ymax:r}}else if(n==="cross"||n==="esriSMSCross")i={paths:[[[0,r],[0,-r]],[[r,0],[-r,0]]]},s={xmin:-r,ymin:-r,xmax:r,ymax:r};else if(n==="diamond"||n==="esriSMSDiamond")i={rings:[[[-r,0],[0,r],[r,0],[0,-r],[-r,0]]]},s={xmin:-r,ymin:-r,xmax:r,ymax:r};else if(n==="square"||n==="esriSMSSquare")i={rings:[[[-r,-r],[-r,r],[r,r],[r,-r],[-r,-r]]]},s={xmin:-r,ymin:-r,xmax:r,ymax:r};else if(n==="x"||n==="esriSMSX")i={paths:[[[r,r],[-r,-r]],[[r,-r],[-r,r]]]},s={xmin:-r,ymin:-r,xmax:r,ymax:r};else if(n==="triangle"||n==="esriSMSTriangle"){const o=e*.5773502691896257,a=-o,l=2/3*e,u=l-e;i={rings:[[[a,u],[0,l],[o,u],[a,u]]]},s={xmin:a,ymin:u,xmax:o,ymax:l}}else n==="arrow"&&(i={rings:[[[-50,50],[50,0],[-50,-50],[-33,-20],[-33,20],[-50,50]]]},s={xmin:-r,ymin:-r,xmax:r,ymax:r});return[s,i]},iIe=t=>t==="vertical"||t==="horizontal"||t==="cross"||t==="esriSFSCross"||t==="esriSFSVertical"||t==="esriSFSHorizontal";function sIe(t,e,r){if(!(!t.effects||e.geometryEngine!=null)){if(e.geometryEnginePromise)return void r.push(e.geometryEnginePromise);Ywe(t.effects)&&(e.geometryEnginePromise=Xwe(),r.push(e.geometryEnginePromise),e.geometryEnginePromise.then((i=>e.geometryEngine=i)))}}function Y4(t){if(!t)return null;let e=null;const{cap:r,color:i,join:s,miterLimit:n,style:o,width:a}=t;return o!=="solid"&&o!=="none"&&o!=="esriSLSSolid"&&o!=="esriSLSNull"&&(e=[{type:"CIMGeometricEffectDashes",dashTemplate:UC(o,r),lineDashEnding:"NoConstraint",scaleDash:!0,offsetAlongLine:null}]),{type:"CIMSolidStroke",color:o!=="esriSLSNull"&&o!=="none"?xs(i):[0,0,0,0],capStyle:lZ(r),joinStyle:uZ(s),miterLimit:n,width:a,effects:e}}let nIe=class{constructor(){this._resourceMap=new Map,this._inFlightResourceMap=new Map,this.geometryEngine=null,this.geometryEnginePromise=null}destroy(){this._inFlightResourceMap.clear(),this._resourceMap.clear()}getResource(e){return this._resourceMap.get(e)??null}async fetchResource(e,r){const i=this._resourceMap.get(e);if(i)return{width:i.width,height:i.height};let s=this._inFlightResourceMap.get(e);return s?s.then((n=>({width:n.width,height:n.height}))):(s=O0e(e,r),this._inFlightResourceMap.set(e,s),s.then((n=>(this._inFlightResourceMap.delete(e),this._resourceMap.set(e,n),{width:n.width,height:n.height})),(()=>({width:0,height:0}))))}deleteResource(e){this._inFlightResourceMap.delete(e),this._resourceMap.delete(e)}loadFont(e){return EMe(e)}};function rje(t){return t?{originPosition:t.originPosition==="upper-left"?"upperLeft":t.originPosition==="lower-left"?"lowerLeft":t.originPosition,scale:t.tolerance?[t.tolerance,t.tolerance,1,1]:[1,1,1,1],translate:t.extent!=null?[t.extent.xmin,t.extent.ymax,t.extent.zmin??0,t.extent.mmin??0]:[0,0,0,0]}:null}function oIe(t){return t.originPosition==="lowerLeft"&&t.scale.length===4&&t.translate.length===4}function kd(t){if(oIe(t))return t;const{originPosition:e,scale:r,translate:i}=t,s=r[0]??1,n=r[1]??1;return{originPosition:"lowerLeft",scale:[s,e==="lowerLeft"?n:-n,r[2]??1,r[3]??1],translate:[i[0]??0,i[1]??0,i[2]??0,i[3]??0]}}function Ul({scale:t,translate:e},r){return Math.round((r-e[0])/t[0])}function Gl({scale:t,translate:e},r){return Math.round((r-e[1])/t[1])}function av({scale:t,translate:e},r){return Math.round(((r??0)-e[2])/t[2])}function lv({scale:t,translate:e},r){return r?Math.round((r-e[3])/t[3]):0}function cZ(t,e){return t&&e?cIe:t&&!e?lIe:!t&&e?uIe:aIe}const aIe=(t,e)=>{const r=[];if(!e.length)return null;const i=e[0];let s=Ul(t,i[0]),n=Gl(t,i[1]);r.push([s,n]);for(let o=1;o<e.length;o++){const[a,l]=e[o],u=Ul(t,a),h=Gl(t,l);u===s&&h===n||r.push([u-s,h-n]),s=u,n=h}return r},lIe=(t,e)=>{const r=[];if(!e.length)return null;const i=e[0];let s=Ul(t,i[0]),n=Gl(t,i[1]),o=av(t,i[2]);r.push([s,n,o]);for(let a=1;a<e.length;a++){const[l,u,h]=e[a],p=Ul(t,l),m=Gl(t,u),y=av(t,h);p===s&&m===n&&y===o||r.push([p-s,m-n,y]),s=p,n=m,o=y}return r},uIe=(t,e)=>{const r=[];if(!e.length)return null;const i=e[0];let s=Ul(t,i[0]),n=Gl(t,i[1]),o=lv(t,i[2]);r.push([s,n,o]);for(let a=1;a<e.length;a++){const[l,u,h]=e[a],p=Ul(t,l),m=Gl(t,u),y=lv(t,h);p===s&&m===n&&y===o||r.push([p-s,m-n,y]),s=p,n=m,o=y}return r},cIe=(t,e)=>{const r=[];if(!e.length)return null;const i=e[0];let s=Ul(t,i[0]),n=Gl(t,i[1]),o=av(t,i[2]),a=lv(t,i[3]);r.push([s,n,o,a]);for(let l=1;l<e.length;l++){const[u,h,p,m]=e[l],y=Ul(t,u),g=Gl(t,h),v=av(t,p),_=lv(t,m);y===s&&g===n&&v===o&&_===a||r.push([y-s,g-n,v,_]),s=y,n=g,o=v,a=_}return r};function hIe(t,e,r,i){const s=[],n=cZ(r,i);for(let o=0;o<e.length;o++){const a=n(t,e[o]);a&&a.length>=3&&s.push(a)}return s.length?s:null}function dIe(t,e,r,i){const s=[],n=cZ(r,i);for(let o=0;o<e.length;o++){const a=n(t,e[o]);a&&a.length>=2&&s.push(a)}return s.length?s:null}function Jv({scale:t,translate:e},r){return r*t[0]+e[0]}function Yv({scale:t,translate:e},r){return r*t[1]+e[1]}function uv({scale:t,translate:e},r){return(r??0)*t[2]+e[2]}function cv({scale:t,translate:e},r){return r?r*t[3]+e[3]:0}function wL(t,e){return t&&e?yIe:t&&!e?fIe:!t&&e?mIe:pIe}const pIe=(t,e)=>{const r=new Array(e.length);if(!e.length)return r;const i=e[0];let s=Jv(t,i[0]),n=Yv(t,i[1]);r[0]=[s,n];const{scale:o,originPosition:a}=t,l=o[0],u=a==="lowerLeft"?o[1]:-o[1];for(let h=1;h<e.length;h++){const[p,m]=e[h];s+=l*p,n+=u*m,r[h]=[s,n]}return r},fIe=(t,e)=>{const r=new Array(e.length);if(!e.length)return r;const i=e[0];let s=Jv(t,i[0]),n=Yv(t,i[1]);r[0]=[s,n,uv(t,i[2])];const{scale:o,originPosition:a}=t,l=o[0],u=a==="lowerLeft"?o[1]:-o[1];for(let h=1;h<e.length;h++){const[p,m,y]=e[h];s+=l*p,n+=u*m,r[h]=[s,n,uv(t,y)]}return r},mIe=(t,e)=>{const r=new Array(e.length);if(!e.length)return r;const i=e[0];let s=Jv(t,i[0]),n=Yv(t,i[1]);r[0]=[s,n,cv(t,i[2])];const{scale:o,originPosition:a}=t,l=o[0],u=a==="lowerLeft"?o[1]:-o[1];for(let h=1;h<e.length;h++){const[p,m,y]=e[h];s+=l*p,n+=u*m,r[h]=[s,n,cv(t,y)]}return r},yIe=(t,e)=>{const r=new Array(e.length);if(!e.length)return r;const i=e[0];let s=Jv(t,i[0]),n=Yv(t,i[1]);r[0]=[s,n,uv(t,i[2]),cv(t,i[3])];const{scale:o,originPosition:a}=t,l=o[0],u=a==="lowerLeft"?o[1]:-o[1];for(let h=1;h<e.length;h++){const[p,m,y,g]=e[h];s+=l*p,n+=u*m,r[h]=[s,n,uv(t,y),cv(t,g)]}return r};function hZ(t,e,r){const i=new Array(r.length);for(let s=0;s<r.length;s++)i[s]=e(t,r[s]);return i}function ije(t,e,r){const i=kd(t);return e.x=Ul(i,r.x),e.y=Gl(i,r.y),r.z!=null&&(e.z=av(i,r.z)),r.m!=null&&(e.m=lv(i,r.m)),e}function sje(t,e,r){const i=hIe(kd(t),r.rings,r.hasZ,r.hasM);return i?(e.rings=i,e.hasZ=r.hasZ??!1,e.hasM=r.hasM??!1,e):null}function nje(t,e,r){const i=dIe(kd(t),r.paths,r.hasZ,r.hasM);return i?(e.paths=i,e.hasZ=r.hasZ??!1,e.hasM=r.hasM??!1,e):null}function gIe(t,e,r,i=r?.hasZ??!1,s=r?.hasM??!1){if(r!=null){const n=kd(t);e.points=wL(i,s)(n,r.points),e.hasZ=i,e.hasM=s}return e}function vIe(t,e,r,i=r?.z!=null,s=r?.m!=null){if(r==null)return e;const n=kd(t);return e.x=Jv(n,r.x),e.y=Yv(n,r.y),i&&(e.z=uv(n,r.z)),s&&(e.m=cv(n,r.m)),e}function _Ie(t,e,r,i=r?.hasZ??!1,s=r?.hasM??!1){if(r!=null){const n=kd(t);e.rings=hZ(n,wL(i,s),r.rings),e.hasZ=i,e.hasM=s}return e}function bIe(t,e,r,i=r?.hasZ??!1,s=r?.hasM??!1){if(r!=null){const n=kd(t);e.paths=hZ(n,wL(i,s),r.paths),e.hasZ=i,e.hasM=s}return e}function dZ(t,e,r,i,s,n){if(t==null)return null;const o=t.references("geometry")&&n?wIe(e,i,n):e,a=t.repurposeFeature(o,s);try{return t.evaluate(a,r)}catch(l){return q.getLogger("esri.views.2d.support.arcadeOnDemand").warn("Feature arcade evaluation failed:",l),null}}const q$=new Map;function wIe(t,e,r){const{transform:i,hasZ:s,hasM:n}=r;q$.has(e)||q$.set(e,SIe(e));const o=q$.get(e)(t.geometry,i,s,n);return{...t,geometry:o}}function SIe(t){const e={};switch(t){case"esriGeometryPoint":return(r,i,s,n)=>vIe(i,e,r,s,n);case"esriGeometryPolygon":return(r,i,s,n)=>_Ie(i,e,r,s,n);case"esriGeometryPolyline":return(r,i,s,n)=>bIe(i,e,r,s,n);case"esriGeometryMultipoint":return(r,i,s,n)=>gIe(i,e,r,s,n);default:return q.getLogger("esri.views.2d.support.arcadeOnDemand").error(new F("mapview-arcade",`Unable to handle geometryType: ${t}`)),r=>r}}const oje=Object.freeze(Object.defineProperty({__proto__:null,default:dZ},Symbol.toStringTag,{value:"Module"})),xIe=t=>{if(!t)return[0,0,0,0];const{r:e,g:r,b:i,a:s}=t;return[e,r,i,255*s]};var ht;let SL=(ht=class{static findApplicableOverrides(e,r,i){if(e&&r){if(e.primitiveName){let s=!1;for(const n of i)if(n.primitiveName===e.primitiveName){s=!0;break}if(!s)for(const n of r)n.primitiveName===e.primitiveName&&i.push(n)}switch(e.type){case"CIMPointSymbol":case"CIMLineSymbol":case"CIMPolygonSymbol":if(e.effects)for(const s of e.effects)ht.findApplicableOverrides(s,r,i);if(e.symbolLayers)for(const s of e.symbolLayers)ht.findApplicableOverrides(s,r,i);break;case"CIMTextSymbol":break;case"CIMSolidStroke":case"CIMPictureStroke":case"CIMGradientStroke":case"CIMSolidFill":case"CIMPictureFill":case"CIMHatchFill":case"CIMGradientFill":case"CIMVectorMarker":case"CIMCharacterMarker":case"CIMPictureMarker":if(e.effects)for(const s of e.effects)ht.findApplicableOverrides(s,r,i);if(e.markerPlacement&&ht.findApplicableOverrides(e.markerPlacement,r,i),e.type==="CIMVectorMarker"){if(e.markerGraphics)for(const s of e.markerGraphics)ht.findApplicableOverrides(s,r,i),ht.findApplicableOverrides(s.symbol,r,i)}else e.type==="CIMCharacterMarker"?ht.findApplicableOverrides(e.symbol,r,i):e.type==="CIMHatchFill"?ht.findApplicableOverrides(e.lineSymbol,r,i):e.type==="CIMPictureMarker"&&ht.findApplicableOverrides(e.animatedSymbolProperties,r,i)}}}static findEffectOverrides(e,r){if(!e)return null;if(e.type==="CIMGeometricEffectDashes"&&gH(e),!r||!e.primitiveName)return{type:"cim-effect-param",effect:e,overrides:[]};const i=BD(e),s=e.primitiveName,n=[];for(const o of r)o.primitiveName===s&&n.push(BD(o));return{type:"cim-effect-param",effect:i,overrides:uSe(n)}}static async resolveSymbolOverrides(e,r,i,s,n,o,a){if(!e?.symbol)return null;let{symbol:l,primitiveOverrides:u}=e;const h=!!u;if(!h&&!s)return l;l=k(l),u=k(u);let p=!0;if(r||(r={attributes:{}},p=!1),h){if(p||(u=u.filter((m=>!m.valueExpressionInfo?.expression.includes("$feature")))),a||(u=u.filter((m=>!m.valueExpressionInfo?.expression.includes("$view")))),u.length>0){const m=rSe(r.attributes),y={spatialReference:i,fields:m,geometryType:n};await ht.createRenderExpressions(u,y),ht.evaluateOverrides(u,r,n??"esriGeometryPoint",o,a,new tv(m))}ht.applyOverrides(l,u)}return s&&ht.applyDictionaryTextOverrides(l,r,s,null),l}static async createRenderExpressions(e,r){const i=[];for(const s of e){const n=s.valueExpressionInfo;if(!n||ht._expressionToRenderExpression.has(n.expression))continue;const o=Vwe(n.expression,r.spatialReference);i.push(o),o.then((a=>ht._expressionToRenderExpression.set(n.expression,a)))}i.length>0&&await Promise.all(i)}static evaluateOverrides(e,r,i,s,n,o){const a={$view:{scale:n?.scale}};for(const l of e){l.value&&typeof l.value=="object"&&UH(l.value)&&(l.propertyName==="Color"||l.propertyName==="StrokeColor")&&(l.value=xIe(l.value));const u=l.valueExpressionInfo;if(!u)continue;const h=ht._expressionToRenderExpression.get(u.expression);h&&(l.value=dZ(h,r,a,i,o,s))}}static applyDictionaryTextOverrides(e,r,i,s,n="Normal"){if(e?.type)switch(e.type){case"CIMPointSymbol":case"CIMLineSymbol":case"CIMPolygonSymbol":case"CIMTextSymbol":{const o=e.symbolLayers;if(!o)return;for(const a of o)a&&a.type==="CIMVectorMarker"&&ht.applyDictionaryTextOverrides(a,r,i,s,e.type==="CIMTextSymbol"?e.textCase:n)}break;case"CIMVectorMarker":{const o=e.markerGraphics;if(!o)return;for(const a of o)a&&ht.applyDictionaryTextOverrides(a,r,i,s)}break;case"CIMMarkerGraphic":{const o=e.textString;if(o&&o.includes("[")){const a=Wwe(o,i);e.textString=Zwe(r,a,s,n)}}}}static applyOverrides(e,r,i,s){if(e.primitiveName){for(const n of r)if(n.primitiveName===e.primitiveName){const o=qv(n.propertyName);if(s&&s.push({cim:e,nocapPropertyName:o,value:e[o]}),i){let a=!1;for(const l of i)l.primitiveName===e.primitiveName&&(a=!0);a||i.push(n)}n.value!=null&&(e[o]=n.value)}}switch(e.type){case"CIMPointSymbol":case"CIMLineSymbol":case"CIMPolygonSymbol":if(e.effects)for(const n of e.effects)ht.applyOverrides(n,r,i,s);if(e.symbolLayers)for(const n of e.symbolLayers)ht.applyOverrides(n,r,i,s);break;case"CIMTextSymbol":break;case"CIMSolidStroke":case"CIMSolidFill":case"CIMVectorMarker":if(e.effects)for(const n of e.effects)ht.applyOverrides(n,r,i,s);if(e.type==="CIMVectorMarker"&&e.markerGraphics)for(const n of e.markerGraphics)ht.applyOverrides(n,r,i,s),ht.applyOverrides(n.symbol,r,i,s)}}static restoreOverrides(e){for(const r of e)r.cim[r.nocapPropertyName]=r.value}static buildOverrideKey(e){let r="";for(const i of e)i.value!==void 0&&(r+=`${i.primitiveName}${i.propertyName}${JSON.stringify(i.value)}`);return r}static toValue(e,r){if(e==="DashTemplate")return r.split(" ").map((i=>Number(i)));if(e==="Color"){const i=new Q(r).toRgba();return i[3]*=255,i}return r}},ht._expressionToRenderExpression=new Map,ht);const $Ie=Object.freeze(Object.defineProperty({__proto__:null,OverrideHelper:SL},Symbol.toStringTag,{value:"Module"})),MIe=96/72;let pZ=class{constructor(e){this._spatialReference=e,this._imageDataCanvas=null,this._cimResourceManager=new nIe}get _canvas(){return this._imageDataCanvas||(this._imageDataCanvas=document.createElement("canvas")),this._imageDataCanvas}get resourceManager(){return this._cimResourceManager}async rasterizeCIMSymbolAsync(e,r,i,s,n,o,a,l,u,h){if(!e)return null;const{data:p}=e;if(!p||p.type!=="CIMSymbolReference"||!p.symbol)return null;const{symbol:m}=p;o||(o=SS(m));const y=await SL.resolveSymbolOverrides(p,r,this._spatialReference,n,o,a,l),g=this._cimResourceManager,v=[];rn.fetchResources(y,g,v),rn.fetchFonts(y,g,v),v.length>0&&await Promise.all(v);const{width:_,height:b}=i;let S=X4(o,_,b,s,h);const $=rn.getEnvelope(y,S,g);if(!$)return null;$.x===1/0&&($.x=_+2),$.y===1/0&&($.y=-b/2),$.width===-1/0&&($.width=_),$.height===-1/0&&($.height=b);let T=1,I=0,P=0;switch(m.type){case"CIMPointSymbol":case"CIMTextSymbol":{let D=1;$.width>_&&(D=_/$.width);let V=1;$.height>b&&(V=b/$.height),s==="preview"&&($.width<_&&(D=_/$.width),$.height<b&&(V=b/$.height)),T=Math.min(D,V),I=$.x+$.width/2,P=$.y+$.height/2}break;case"CIMLineSymbol":if(h){P=$.y+$.height/2,I=$.x+$.width/2;const D=$.width-_,V=$.height-b;S={paths:LS(S.paths,{xmin:-1*$.width/2+D,xmax:$.width/2-D,ymin:-1*$.height/2+V,ymax:$.height/2-V,width:$.width-2*D,height:$.height-2*V})}}else{(u||$.height>b)&&(T=b/$.height),P=$.y+$.height/2;const D=$.x*T+_/2,V=($.x+$.width)*T+_/2,U=ri(S)?S.paths:rr(S)?S.rings:null;if(U===null)throw new Error("Bad geometry, can't rasterise symbol!");U[0][0][0]-=D/T,U[0][2][0]-=(V-_)/T}break;case"CIMPolygonSymbol":if(h){P=$.y+$.height/2,I=$.x+$.width/2;const D=$.width-_,V=$.height-b;S={paths:LS(S.rings,{xmin:-1*$.width/2+D,xmax:$.width/2-D,ymin:-1*$.height/2+V,ymax:$.height/2-V,width:$.width-2*D,height:$.height-2*V})}}else{I=$.x+$.width/2,P=$.y+$.height/2;const D=$.x*T+_/2,V=($.x+$.width)*T+_/2,U=$.y*T+b/2,Z=($.y+$.height)*T+b/2,{rings:X}=S;D<0&&(X[0][0][0]-=D,X[0][3][0]-=D,X[0][4][0]-=D),U<0&&(X[0][0][1]+=U,X[0][1][1]+=U,X[0][4][1]+=U),V>_&&(X[0][1][0]-=V-_,X[0][2][0]-=V-_),Z>b&&(X[0][2][1]+=Z-b,X[0][3][1]+=Z-b)}}const R={type:"cim",data:{type:"CIMSymbolReference",symbol:y}};return this.rasterize(R,_,b,I,P,T,o,1,S)}rasterize(e,r,i,s,n,o,a,l=0,u=null,h=window.devicePixelRatio||1){const{data:p}=e;if(!p||p.type!=="CIMSymbolReference"||!p.symbol)return null;const{symbol:m}=p,y=this._canvas,g=h*MIe;y.width=r*g,y.height=i*g,a||(a=SS(m)),u||(u=X4(a,r,i,"legend")),y.width+=2*l,y.height+=2*l;const v=y.getContext("2d",{willReadFrequently:!0}),_=Br.createIdentity();return _.translate(-s,-n),_.scale(o*g,-o*g),_.translate(r*g/2+l,i*g/2+l),v.clearRect(0,0,y.width,y.height),new rZ(v,this._cimResourceManager,_,!0).drawSymbol(m,u),v.getImageData(0,0,y.width,y.height)}};function TIe(t,e,r,i){return e==="esriGeometryPolygon"?{rings:j4(LS(t.rings,{xmin:0,ymin:0,width:r,height:i}),-1*r/2,-1*i/2)}:e==="esriGeometryPolyline"?{paths:j4(LS(t.paths,{xmin:0,ymin:0,width:r,height:i}),-1*r/2,-1*i/2)}:null}function X4(t,e,r,i,s){const o=-e/2+1,a=e/2-1,l=r/2-1,u=-r/2+1;if(s&&(t==="esriGeometryPolygon"||t==="esriGeometryPolyline")){const h=TIe(s,t,e,r);if(h)return h}switch(t){case"esriGeometryPoint":return{x:0,y:0};case"esriGeometryPolyline":return{paths:[[[o,0],[0,0],[a,0]]]};default:return i==="legend"?{rings:[[[o,l],[a,0],[a,u],[o,u],[o,l]]]}:{rings:[[[o,l],[a,l],[a,u],[o,u],[o,l]]]}}}const lje=Object.freeze(Object.defineProperty({__proto__:null,CIMSymbolRasterizer:pZ},Symbol.toStringTag,{value:"Module"})),kb=new pZ(null),n1=tt(Bt.size),K4=tt(Bt.maxSize),H$=tt(Bt.lineWidth),EIe=1;async function IIe(t,e,r){const i=e?.size;let s=i!=null&&typeof i=="object"&&"width"in i?i.width:i,n=i!=null&&typeof i=="object"&&"height"in i?i.height:i;if(!s||!n)if(r==="esriGeometryPolygon")s=n=e.maxSize?Math.min(e.maxSize,n1):n1;else{const o=await xL(t,e,r);o&&(s=o.width,n=o.height),r==="esriGeometryPolyline"&&(s=e.maxSize?Math.min(e.maxSize,H$):H$),s=s!=null&&isFinite(s)?Math.min(s,K4):n1,n=n!=null&&isFinite(n)?Math.max(Math.min(n,K4),EIe):n1}return e.style==="legend"&&r==="esriGeometryPolyline"&&(s=H$),{width:s,height:n}}async function xL(t,e={},r){const i=e.cimOptions||e;r??=i.geometryType||SS(t?.data?.symbol);const{feature:s,fieldMap:n,viewParams:o}=i,a=await SL.resolveSymbolOverrides(t.data,s,null,n,r,null,o);if(!a)return null;(t=t.clone()).data={type:"CIMSymbolReference",symbol:a},t.data.primitiveOverrides=void 0;const l=[];return rn.fetchResources(a,kb.resourceManager,l),rn.fetchFonts(a,kb.resourceManager,l),l.length>0&&await Promise.all(l),rn.getEnvelope(a,null,kb.resourceManager)}async function CIe(t,e={}){const{node:r,opacity:i,symbolConfig:s}=e,n=s!=null&&typeof s=="object"&&"isSquareFill"in s&&s.isSquareFill,o=e.cimOptions||e,a=o.geometryType||SS(t?.data?.symbol),l=await IIe(t,e,a),{feature:u,fieldMap:h}=o,p=e?.geometry||n||a!=="esriGeometryPolygon"?"preview":"legend";let m=l;const y=l;if(e?.geometry&&(a==="esriGeometryPolygon"||a==="esriGeometryPolyline")&&(Fe(l.width)<200||Fe(l.height)<200)){const R=l.width>l.height?tt(200)*l.height/l.width:tt(200);m={width:l.width>l.height?tt(200):tt(200)*l.width/l.height,height:R}}const g=await kb.rasterizeCIMSymbolAsync(t,u,m,p,h,a,null,o.viewParams,o.allowScalingUp,e?.geometry?.toJSON());if(!g)return null;const{width:v,height:_}=g,b=document.createElement("canvas");b.width=v,b.height=_,b.getContext("2d").putImageData(g,0,0);const S=Fe(y.width),$=Fe(y.height),T=new Image(S,$);T.src=b.toDataURL(),T.ariaLabel=e.ariaLabel??null,T.alt=e.ariaLabel??"",i!=null&&(T.style.opacity=`${i}`);let I=T;if(e.effectView!=null){const P={shape:{type:"image",x:0,y:0,width:S,height:$,src:T.src},fill:null,stroke:null,offset:[0,0]};I=Zm([[P]],[S,$],e)}return r&&I&&r.appendChild(I),I}const PIe=Object.freeze(Object.defineProperty({__proto__:null,getCIMSymbolPreviewSize:xL,previewCIMSymbol:CIe},Symbol.toStringTag,{value:"Module"})),GC=30,BC=12,qC=24,fZ=[255,255,255],kS=[200,200,200],Bh=[128,128,128],AIe=20,LIe=5;function RIe(t){return t.declaredClass==="esri.symbols.SimpleMarkerSymbol"}function kIe(t){return t.declaredClass==="esri.symbols.PictureMarkerSymbol"}function OIe(t){return t.declaredClass==="esri.symbols.SimpleLineSymbol"}function NIe(t){return t.declaredClass==="esri.symbols.TextSymbol"}function FIe(t,e){const r=t.length-1;return t.map(((i,s)=>$W(i,s,r,e)))}async function DIe(t,e,r,i,s,n,o){const a=e.legendOptions,l=a?.customValues,u=o||await jIe(t,r),h=e.stops,p=!!u,m=!!l,y=e.minSize!=null&&e.maxSize!=null,g=h&&h.length>1,v=!!e.target;if(!p||!m&&!(y||g&&!v))return;const _=Y2(u);let b=!1,S=null,$=null;S=_&&!g?TS([e.minDataValue,e.maxDataValue]):l??await GIe(e,u,i,s?.type);const T=t?.authoringInfo,I=T?.type==="univariate-color-size",P=I&&T?.univariateTheme==="above-and-below",R=!!ga(t,"reference-size"),D=!!ga(t,"spike");if(!S&&g&&(S=h.map((le=>le.value)),b=h.some((le=>!!le.label)),t.type==="flow"&&(S=TS(S)),b&&($=h.map((le=>le.label)))),_&&S!=null&&S?.length>2&&!P&&(S=[S[0],S[S.length-1]]),!S)return null;I&&S?.length!==5&&(S=gZ({minSize:S[0],maxSize:S[S.length-1]}));const V=_?zIe(t,S):null,U=xxe(u),Z=b?null:FIe(S,n);return(await Promise.all(S.map((async(le,ee)=>{let ke=_?V[ee]:await Cp(e,u,le,i,s?.type),Ze=ke;R&&(ke*=qC/e.maxSize||1,Ze=qC);const it=HIe(u,ke,t,ee);return D&&it.type==="cim"&&(Ze=await xL(it)),{value:le,symbol:it,label:b?$[ee]:Z[ee],size:Ze,outlineSize:U}})))).reverse()}function zIe(t,e){const r=t?.authoringInfo,i=r?.type==="univariate-color-size";let s=[BC,GC];if(i){const n=e[0],o=e[e.length-1],a=BC,l=GC;s=e.map((u=>a+(u-n)/(o-n)*(l-a)))}return i&&r?.univariateTheme==="below"&&s.reverse(),s}function VIe(t,e){const r=t.classBreakInfos,i=r.length,s=i<2||!(e>=2)?r[0].symbol.clone():r[i-1].symbol.clone();return t.visualVariables?.some((o=>o.type==="color"))&&(s.type.includes("3d")?mZ(s):yZ(s)),s}async function jIe(t,e){if(t.type==="flow")return MW(t,e);if(t.type==="pie-chart")return new Pt({color:null,outline:t.outline?.width?t.outline:new jt});let r=null,i=null;if(t.type==="simple")r=t.symbol;else if(t.type==="class-breaks"){const s=t.classBreakInfos;r=s&&s[0]&&s[0].symbol,i=s.length>1}else if(t.type==="unique-value"){const s=t.uniqueValueInfos;r=s?.[0]?.symbol,i=s!=null&&s.length>1}if(!r||UIe(r))return null;if(r=r.clone(),e||i)if(r.type.includes("3d"))mZ(r);else if(ga(t,"reference-size")&&r.type==="cim")nL(r,{color:e??(t.type!=="class-breaks"?new Q(kS):null)});else if(ga(t,"spike")&&r.type==="cim"){const s=new Q(kS),n=new Q(Bh),o=r.data.symbol?.type==="CIMPointSymbol"?r.data.symbol:null,a=!!o?.symbolLayers?.find((({type:h})=>h==="CIMSolidStroke"))?.colorLocked;let l,u=e??void 0;if(u){const h=YH(u),p=FB();(!p&&h>225||p&&h<25)&&(u=s,l=a?n:s)}else u=s,l=a?n:s;IW(r,{color:u,strokeColor:l})}else yZ(r);return r}function UIe(t){return Pa(t)?t.symbolLayers?.some((e=>e?.type==="fill"))??!1:t?.type.includes("fill")??!1}function mZ(t){t.type==="line-3d"?t.symbolLayers.forEach((e=>{e.material={color:Bh}})):t.symbolLayers.forEach((e=>{e.type!=="icon"||e.resource?.href?e.material={color:kS}:(e.material={color:fZ},e.outline={color:Bh,size:1.5})}))}function yZ(t){const e=FB();t.type==="cim"?jH(t,new Q(kS)):t.type.includes("line")?t.color=Bh:(t.color=e?Bh:fZ,t.type==="simple-marker"&&(t.outline?t.outline?.color?.toHex()==="#ffffff"&&(t.outline.color=Bh):t.outline={color:Bh,width:1.5}))}async function GIe(t,e,r,i){const s=(await J(async()=>{const{getSizeRangeAtScale:a}=await Promise.resolve().then(()=>Ad);return{getSizeRangeAtScale:a}},void 0)).getSizeRangeAtScale(t,r,i),n=s&&gZ(s);if(!s||!n)return;let o=n.map((a=>BIe(a,t,s)));o=TS(o);for(let a=1;a<o.length-1;a++){const l=await qIe(t,e,o[a],o[a-1],r,i);l&&(o[a]=l[0],n[a]=l[1])}return o}function gZ(t){const e=t.minSize,r=t.maxSize,i=LIe,s=(r-e)/(i-1),n=[];for(let o=0;o<i;o++)n.push(e+s*o);return n}function BIe(t,e,r){const i=r.minSize,s=r.maxSize,n=e.minDataValue,o=e.maxDataValue;let a;return t<=i?a=n:t>=s?a=o:a=(t-i)/(s-i)*(o-n)+n,a}async function qIe(t,e,r,i,s,n){const o=await Cp(t,e,r,s,n),a=await Cp(t,e,i,s,n),l=MS(r),u=l.fractional,h=AIe;let p=l.integer,m=null,y=null;r>0&&r<1&&(m=10**u,p=MS(r*=m).integer);for(let g=p-1;g>=0;g--){const v=10**g;let _=Math.floor(r/v)*v,b=Math.ceil(r/v)*v;m!=null&&(_/=m,b/=m);let S=(_+b)/2;[,S]=TS([_,S,b],{indexes:[1]});const $=await Cp(t,e,_,s,n),T=await Cp(t,e,b,s,n),I=await Cp(t,e,S,s,n),P=Ib(o,$,a,null),R=Ib(o,T,a,null),D=Ib(o,I,a,null);let V=P.previous<=h,U=R.previous<=h;if(V&&U&&(P.previous<=R.previous?(V=!0,U=!1):(U=!0,V=!1)),V?y=[_,$]:U?y=[b,T]:D.previous<=h&&(y=[S,I]),y)break}return y}async function Cp(t,e,r,i,s){const{getSize:n}=await J(()=>Promise.resolve().then(()=>Ad),void 0);return n(t,r,{scale:i,view:s,shape:e.type==="simple-marker"?e.style:null})}function HIe(t,e,r,i){r?.authoringInfo?.type==="univariate-color-size"&&r?.authoringInfo?.univariateTheme==="above-and-below"&&r.type==="class-breaks"&&(t=VIe(r,i));const s=t.clone();if(Pa(s))Y2(s)||s.symbolLayers.forEach((n=>{n.type!=="fill"&&(n.size=e)}));else if(RIe(s))s.size=e;else if(kIe(s)){const n=s.width,o=s.height;s.height=e,s.width=e*(n/o)}else OIe(s)?s.width=e:NIe(s)?s.font&&(s.font.size=e):s.type==="cim"&&ga(r,"reference-size")?nL(s,{innerDotSize:e,outerRingSize:qC}):s.type==="cim"&&ga(r,"spike")&&IW(s,{defaultHeight:e,primitiveOverrides:null});return s}function WIe(t){const r=Math.floor(Math.log10(Math.abs(t)))+1,i=r<4||r>6?4:r,s=1e6,n=Math.abs(t)>=s?"compact":"standard";return uc(t,{notation:n,minimumSignificantDigits:2,maximumSignificantDigits:i})}const Q4=16,ZIe="https://utility.arcgis.com/sharing/tools/legend",JIe="esri.layers.ImageryLayer",YIe="esri.layers.ImageryTileLayer",XIe="esri.layers.WCSLayer",o1=/^\s*(return\s+)?\$view\.scale\s*(;)?\s*$/i,KIe=new De({esriGeometryPoint:"point",esriGeometryMultipoint:"multipoint",esriGeometryPolyline:"polyline",esriGeometryPolygon:"polygon",esriGeometryMultiPatch:"multipatch"}),a1=new Pt({size:6,outline:{color:[128,128,128,.5],width:.5}}),QIe=new Vi({style:"solid"});function HC(t){return t.type==="flow"}function vZ(t){return t.type==="vector-field"}function _Z(t){return t.type==="raster-colormap"}function bZ(t){return t.type==="raster-stretch"}function wZ(t){return t.type==="raster-shaded-relief"}function Pp(t){return t.declaredClass==="esri.renderers.SimpleRenderer"}function ch(t){return t.declaredClass==="esri.renderers.ClassBreaksRenderer"}function hh(t){return t.declaredClass==="esri.renderers.UniqueValueRenderer"}function SZ(t){return t.declaredClass==="esri.renderers.HeatmapRenderer"}function eCe(t){return $L(t)||ML(t)||TL(t)||tCe(t)}function tCe(t){return t.declaredClass==="esri.renderers.PointCloudRGBRenderer"}function $L(t){return t.declaredClass==="esri.renderers.PointCloudClassBreaksRenderer"}function ML(t){return t.declaredClass==="esri.renderers.PointCloudStretchRenderer"}function TL(t){return t.declaredClass==="esri.renderers.PointCloudUniqueValueRenderer"}function xZ(t){return t.declaredClass==="esri.renderers.DotDensityRenderer"}function $Z(t){return t.declaredClass==="esri.renderers.PieChartRenderer"}function rCe(t,e){return Pp(t)||ch(t)||hh(t)||SZ(t)||xZ(t)||$Z(t)?e.type==="2d"||FH(t):bZ(t)||_Z(t)||wZ(t)||$L(t)||ML(t)||TL(t)||vZ(t)||HC(t)}function iCe(t){return t.declaredClass==="esri.layers.BuildingSceneLayer"}function W$(t){return t.declaredClass==="esri.layers.SubtypeGroupLayer"}function sCe(t){return t.declaredClass==="esri.layers.VoxelLayer"}function nCe(t){return t.declaredClass==="esri.layers.WMSLayer"}function oCe(t){return t.declaredClass==="esri.layers.WMTSLayer"}function Z$(t){return t.declaredClass==="esri.layers.MapImageLayer"}function e6(t){return t.declaredClass==="esri.layers.TileLayer"}function np(t){return t.declaredClass===JIe}function l1(t){return t.declaredClass===YIe}function aCe(t){return t.declaredClass===XIe}function lCe(t){return t.type==="stretch-ramp"}function uCe(t){return("authoringInfo"in t?t?.authoringInfo:null)?.type==="univariate-color-size"}function cCe(t){const e="authoringInfo"in t?t?.authoringInfo:null;return e?.type==="univariate-color-size"&&e?.univariateTheme==="above-and-below"}function t6(t){return"sublayers"in t}function r6(t){return t&&"symbol"in t}async function Ua(t,e){const r=await E3("esri/widgets/Legend/t9n/Legend");return t!=="previewTemplateAriaLabel"||e||(t="previewAriaLabel"),Sw(r[t],{label:e})}function hCe(t,e){const{field:r,field2:i,field3:s,fieldDelimiter:n,valueExpression:o}=t;if(!r)return null;const a=!r&&!o||!i&&!s?[e]:e?.toString().split(n||""),l=r?{[r]:a?.[0]}:null;return l&&(i&&(l[i]=a?.[1]),s&&(l[s]=a?.[2])),l}const dCe=new Pt({style:"path",path:"M10,5 L5,0 0,5 M5,0 L5,15",size:15,outline:{width:1,color:[85,85,85,1]}});let op={},Zt=class extends ce{constructor(t){super(t),this._hasColorRamp=!1,this._hasOpacityRamp=!1,this._hasSizeRamp=!1,this._webStyleSymbolCache=new Map,this._dotDensityUrlCache=new Map,this._scaleDrivenSizeVariable=null,this._hasClusterSizeVariable=!1,this._layerDefinitionExpression=null,this._layerDefinitionExpressionClause=null,this._layerDisplayFilterId=null,this._layerDisplayFilterClause=null,this.children=new se,this.layerView=null,this.layer=null,this.legendElements=[],this.parent=null,this.hideLayersNotInCurrentView=!1,this.keepCacheOnDestroy=!1,this.respectLayerDefinitionExpression=!1,this.respectLayerVisibility=!0,this.sublayerIds=[],this.title=null,this.view=null}initialize(){const t=()=>this.notifyChange("ready");this.addHandles([so((()=>this.children),"change",(e=>{const{added:r,removed:i}=e;r.forEach((s=>{const n=`activeLayerInfo-ready-watcher-${s.layer.uid}`;this.addHandles(ie((()=>s.ready),t,Ft),n)})),i.forEach((s=>this.removeHandles(s.layer.uid))),t()}))]),this.keepCacheOnDestroy||(op={})}destroy(){this._webStyleSymbolCache=null,this._dotDensityUrlCache=null,this._scaleDrivenSizeVariable=null,this.keepCacheOnDestroy||(op=null),this._layerDefinitionExpressionClause=null}get effectList(){const t=this.layer;let e=null;return"effect"in t&&t.effect&&(e=new Fn,e.effect=t.effect,e.endTransition(),e.scale=this.scale),e}get opacity(){const t=this.layer.opacity,e=this.parent?.opacity,r=this.layer.parent,i=r&&"uid"in r?this._getParentLayerOpacity(r):null;return e!=null?e*t:i!=null?i*t:t}get ready(){return this.layer===null||(this.children.length>0?this._isGroupActive():this.legendElements.length>0)}get scale(){return this.view?.scale??0}get isScaleDriven(){const t=this.layer;if(t===null)return!1;if("effect"in t&&t.effect&&Array.isArray(t.effect))return!0;if("featureReduction"in t&&t.featureReduction){if(t.featureReduction.type==="cluster")return!0;if(t.featureReduction.type==="binning"&&"renderer"in t.featureReduction&&t.featureReduction.renderer)return this._isRendererScaleDriven(t.featureReduction.renderer)}return"renderer"in t&&t.renderer?!!("displayFilterInfo"in t&&t.displayFilterInfo&&hh(t.renderer))||this._isRendererScaleDriven(t.renderer):this._isLayerScaleDriven(this.layer)}get version(){return this._get("version")+1}async buildLegendElementsForFeatureCollections(t){if(!(!this.hideLayersNotInCurrentView||await this._isLayerInCurrentView()))return this.legendElements=[],void this.notifyChange("ready");const e=Array.from(t,(r=>{if(Kie(r))return this._getRendererLegendElements(r.renderer,{title:r.title});if(r.featureSet?.features.length){const i=r.layerDefinition,s=i?.drawingInfo,n=s&&y2e(s.renderer),o=KIe.read(i.geometryType);return n?this._getRendererLegendElements(n,{title:r.name,geometryType:o}):(q.getLogger(this).warn("drawingInfo not available!"),null)}return null}));try{const r=[],i=await Promise.allSettled(e);for(const s of i)if(s.status==="fulfilled")for(const n of s.value??[])r.push(n);this.legendElements=r,this.notifyChange("ready")}catch(r){q.getLogger(this).warn("error while building legend for layer!",r)}}async buildLegendElementsForRenderer(t){try{const e=!this.hideLayersNotInCurrentView||await this._isLayerInCurrentView();this.legendElements=e?await this._getRendererLegendElements(t):[],this.notifyChange("ready")}catch(e){q.getLogger(this).warn("error while building legend for layer!",e)}}async buildLegendElementsForFeatureReduction(t){try{const e=!this.hideLayersNotInCurrentView||await this._isLayerInCurrentView();this.legendElements=e?await this._getLegendElementsForFeatureReduction(t):[],this.notifyChange("ready")}catch(e){q.getLogger(this).warn("error while building legend for layer!",e)}}async buildLegendElementsForTools(){const t=this.layer;if(sCe(t))this._constructLegendElementsForVoxelLayer();else if(oCe(t))this._constructLegendElementsForWMTSlayer();else if(nCe(t))await this._constructLegendElementsForWMSSublayers();else if(iCe(t))await this._constructLegendElementsForBuildingSceneLayer();else if(Z$(t)||e6(t)||W$(t))await this._constructLegendElementsForSublayers();else{this.removeHandles("imageryLayers-watcher");let e="default";if(np(t)&&(e=(t?.rasterFunction?.functionName||"default")+"_"+(t.bandIds?.length?t.bandIds.join(""):"###")),l1(t)||t.type==="link-chart")return;await this._getLegendLayers(`${t.uid}-${e}`).then((async r=>{this.legendElements=[],this.notifyChange("ready");const i=r.map((async s=>{if(np(t)){const o=ie((()=>[t.rasterFunction,t.bandIds]),(()=>US((async()=>{op.default=null,t.renderer?await this.buildLegendElementsForRenderer(t.renderer):await this.buildLegendElementsForTools()}))()));this.addHandles(o,"imageryLayers-watcher")}const n=this._generateSymbolTableElementForLegendLayer(s);n?.infos.length&&(np(t)&&(n.title=t.title),this.legendElements.push(n)),this.notifyChange("ready")}));await Promise.allSettled(i)})).catch((r=>{q.getLogger(this).warn("Request to server for legend has failed!",r)}))}}async _isLayerInCurrentView(){const t=this.layer,e=this.layerView,r=e&&"createQuery"in e&&"queryFeatureCount"in e;if(!r&&!(e&&"createQuery"in t&&"queryFeatureCount"in t))return!0;await Ev((()=>!e.updating));const i=r?"createQuery"in e&&e.createQuery():"createQuery"in t&&t.createQuery();return i?(i.geometry=this.view.extent,(r?"queryFeatureCount"in e&&await e.queryFeatureCount(i):"queryFeatureCount"in t&&await t.queryFeatureCount(i))!==0):!0}_getParentLayerOpacity(t){let e=1;const r=t.parent;return r&&"uid"in r&&(e=this._getParentLayerOpacity(r)),t.opacity*e}_isGroupActive(){return this.children.some((t=>t.ready))}_isRendererScaleDriven(t){if(t.type==="dot-density")return!0;const e="valueExpression"in t?t.valueExpression:null;return o1.test(e)?!0:!!("visualVariables"in t?t.visualVariables:null)?.some((i=>this._isScaleDrivenSizeVariable(i)))||this._hasScaleDrivenSymbols(t)}_hasScaleDrivenSymbols(t){switch(t.type){case"simple":return this._isScaleDrivenSymbol(t.symbol);case"class-breaks":return this._isScaleDrivenSymbol(t.defaultSymbol)||t.classBreakInfos.some((e=>this._isScaleDrivenSymbol(e.symbol)));case"unique-value":return this._isScaleDrivenSymbol(t.defaultSymbol)||!!t.uniqueValueInfos?.some((e=>this._isScaleDrivenSymbol(e.symbol)))}return!1}_isScaleDrivenSymbol(t){if(t?.type==="cim"){const{primitiveOverrides:e,minScale:r,maxScale:i}=t.data,s=e?.some((n=>/\$view\.scale/.test(n.valueExpressionInfo?.expression||"")))??!1;return r!=null||i!=null||s}return!1}_isScaleDrivenSizeVariable(t){if(t&&t.type!=="size")return!1;const e=t,r=e.minSize,i=e.maxSize;return!(typeof r!="object"||!r||!this._isScaleDrivenSizeVariable(r))||!(typeof i!="object"||!i||!this._isScaleDrivenSizeVariable(i))||o1.test(e.valueExpression)}_isLayerScaleDriven(t){if("minScale"in t&&t.minScale>0||"maxScale"in t&&t.maxScale>0)return!0;if("sublayers"in t&&t.sublayers)return t.sublayers.some((r=>this._isLayerScaleDriven(r)));const e=t.parent;if(t.loaded===!1&&e&&Z$(e)&&"source"in t&&t.source&&t.source.type==="map-layer"){for(const r of e.sourceJSON.layers??[])if(r.id===t.source.mapLayerId&&(r.minScale>0||r.maxScale>0))return!0}return!1}async _constructLegendElementsForVoxelLayer(){this.legendElements=[],this.removeHandles("voxel-style-watcher"),this.removeHandles("voxel-current-variable");const t=this.layer;this.addHandles(ie((()=>t.currentVariableId),(()=>this._constructLegendElementsForVoxelLayer())),"voxel-current-variable"),this.addHandles(ie((()=>t.getVariableStyles()),(()=>this._constructLegendElementsForVoxelLayer())),"voxel-style-watcher");const e=t.getVariableStyle(null),r=[];if(e){if(e.uniqueValues?.length){const i=[];e.uniqueValues.forEach((s=>{s.enabled&&i.push({label:s.label||`${s.value}`,value:s.value,symbol:new Vi({color:s.color,outline:null})})})),i.length&&r.push({type:"symbol-table",title:e.label,infos:i})}else if(e.transferFunction){const{colorStops:i,stretchRange:s}=e.transferFunction,n=i.toArray().reverse(),o=s.map(((l,u)=>`${u===0?SW:xW} ${WIe(l)}`)).reverse(),a=n.map((l=>({color:l.color,value:null,label:null})));a[0].label=o[0],a[a.length-1].label=o[1],r.push({type:"color-ramp",title:e.label,infos:a,preview:ah(n.map((l=>l.color)),{ariaLabel:await Ua("previewColorRampAriaLabel")})})}}await this._generatePreviewsForLegendElements(r,{opacity:t.opacity}),this.legendElements=r,this.notifyChange("ready")}_constructLegendElementsForWMTSlayer(){this.legendElements=[],this.removeHandles("wmts-activeLayer-watcher");const t=this.layer.activeLayer;this.addHandles(ie((()=>{const{layer:r}=this;return r&&"activeLayer"in r&&r.activeLayer}),(()=>this._constructLegendElementsForWMTSlayer())),"wmts-activeLayer-watcher");const e=t.styleId?t.styles?.find((({id:r})=>r===t.styleId))?.legendUrl:void 0;e&&(this.legendElements=[{type:"symbol-table",title:t.title,infos:[{src:e,opacity:this.opacity}]}]),this.notifyChange("ready")}async _constructLegendElementsForWMSSublayers(){this.legendElements=[],this.removeHandles("wms-sublayers-watcher");const t=this.layer;let e=null;(t.customParameters||t.customLayerParameters)&&(e={...t.customParameters,...t.customLayerParameters}),this.addHandles(ie((()=>{const{layer:r}=this;return r&&"sublayers"in r&&r.sublayers}),(()=>this._constructLegendElementsForWMSSublayers())),"wms-sublayers-watcher"),this.legendElements=await this._generateLegendElementsForWMSSublayers(t.sublayers,e),this.notifyChange("ready")}async _generateLegendElementsForWMSSublayers(t,e){const r=this.layer,i=[];this.addHandles(t.on("change",(()=>this._constructLegendElementsForWMSSublayers())),"wms-sublayers-watcher");const s=this.sublayerIds?.map((o=>r.findSublayerById(o)))?.filter(ii)??[],n=s.length?s:t.toArray();for(const o of n){const a=ie((()=>[o.title,o.visible,o.legendEnabled]),(()=>this._constructLegendElementsForWMSSublayers()));if(this.addHandles(a,"wms-sublayers-watcher"),!this.respectLayerVisibility||o.visible&&o.legendEnabled){const l=await this._generateSymbolTableElementForWMSSublayer(o,e);l?.infos.length&&i.unshift(l)}}return i}async _generateSymbolTableElementForWMSSublayer(t,e){if(!t.legendUrl&&t.sublayers){const r=(await this._generateLegendElementsForWMSSublayers(t.sublayers,e)).filter((i=>i));return{type:"symbol-table",title:t.title,infos:r}}return this._generateSymbolTableElementForLegendUrl(t,e)}async _generateSymbolTableElementForLegendUrl(t,e){let r=t.legendUrl;if(!r)return;const i={type:"symbol-table",title:t.title||t.name||String(t.id??""),infos:[]};e&&(r=y1(r,e));let s=null;const n=t.layer?.opacity;try{s=(await et(r,{responseType:"image"})).data,s&&(s.style.opacity=n)}catch{}return i.infos.push({src:r,preview:s,opacity:n}),i}_getLegendLayers(t,e){const r=op&&op[t];return r?Promise.resolve(r):this._legendRequest(e).then((i=>{const s=i.layers;return op[t]=s,s}))}_legendRequest(t){const e=this.layer;let r={f:"json",dynamicLayers:t};if(np(e)){const s=e.exportImageServiceParameters.rasterFunction;if(s&&(r.renderingRule=JSON.stringify(s.functionDefinition?.toJSON()||s.toJSON())),e.bandIds&&(r.bandIds=e.bandIds.join()),e.raster||e.viewId||e.customParameters){const{raster:n,viewId:o,customParameters:a}=e;r={raster:n,viewId:o,...r,...a}}}let i=e.url.replace(/(\/)+$/,"");if("version"in e&&+e.version>=10.01){const s=i.indexOf("?");s>-1?i=i.slice(0,s)+"/legend"+i.slice(s):i+="/legend"}else{const s=i.toLowerCase().indexOf("/rest/"),n=s===-1?i:i.slice(0,s)+i.slice(s+5);i=ZIe+"?soapUrl="+encodeURI(n)+"&returnbytes=true"}return et(i,{query:r}).then((s=>s.data))}async _constructLegendElementsForBuildingSceneLayer(){this.legendElements=[],this.removeHandles("sublayers-watcher");const t=this.layer;this.addHandles(ie((()=>t.sublayers),(()=>this._constructLegendElementsForBuildingSceneLayer())),"sublayers-watcher");try{this.legendElements=await this._generateLegendElementsForBuildingSublayers(t.sublayers,this.opacity),this.notifyChange("ready")}catch(e){q.getLogger(this).warn("Request to server for legend has failed!",e)}}async _generateLegendElementsForBuildingSublayers(t,e){let r=[];this.addHandles(t.on("change",(()=>this._constructLegendElementsForBuildingSceneLayer())),"sublayers-watcher");const i=t.toArray();for(const s of i){const n=ie((()=>["renderer"in s&&s.renderer,s.opacity,s.title,s.visible]),(()=>this._constructLegendElementsForBuildingSceneLayer()));if(this.addHandles(n,"sublayers-watcher"),!this.respectLayerVisibility||s.visible){const o=s?.opacity!=null?s.opacity:null,a=o!=null?o*e:e;if(s.type==="building-group"){const l={type:"symbol-table",title:s.title,infos:[]},u=await this._generateLegendElementsForBuildingSublayers(s.sublayers,a);l.infos.push(...u),r=[l,...r]}else s.renderer&&(r=[...await this._getRendererLegendElements(s.renderer,{title:s.title,opacity:a,sublayer:s}),...r])}}return r.filter((s=>!!s&&(!("infos"in s)||!s.infos||s.infos.length>0)))}async _constructLegendElementsForSublayers(){this.legendElements=[],this.removeHandles("sublayers-watcher");const t=this.layer;if(Z$(t)||e6(t)||W$(t)){this.addHandles(ie((()=>t.sublayers),(()=>this._constructLegendElementsForSublayers)),"sublayers-watcher");try{this.legendElements=await this._generateLegendElementsForSublayers(t.sublayers,this.opacity),this.notifyChange("ready")}catch(e){q.getLogger(this).warn("Request to server for legend has failed!",e)}}}async _generateLegendElementsForSublayers(t,e,r){const i=this.layer;let s=[];this.addHandles(t.on("change",(()=>this._constructLegendElementsForSublayers())),"sublayers-watcher");let n=t.toArray();!r&&this.sublayerIds&&this.sublayerIds.length&&(n=W$(i)?this.sublayerIds.map((o=>i.findSublayerForSubtypeCode(o))).filter(ii):this.sublayerIds.map((o=>i.findSublayerById(o))).filter(ii));for(const o of n){const a=ie((()=>[o.renderer,o.opacity,o.title,o.visible,o.legendEnabled]),(()=>this._constructLegendElementsForSublayers()));if(this.addHandles(a,"sublayers-watcher"),!this.respectLayerVisibility||o.visible&&o.legendEnabled&&this._isSublayerInScale(o)){const l=o?.opacity!=null?o.opacity:null,u=l!=null?l*e:e,h=!t6(o)||o.originIdOf("renderer")>xe.SERVICE&&!o.sublayers;if(o.renderer&&h)await o.load(),s=[...await this._getRendererLegendElements(o.renderer,{title:o.title,opacity:u,sublayer:o}),...s];else if(t6(o)){const p=await this._generateSymbolTableElementForSublayer(o,u,r);p&&s.unshift(p)}}}return s.filter((o=>!!o&&(!("infos"in o)||!o.infos||o.infos.length>0)))}async _generateSymbolTableElementForSublayer(t,e,r){if(!r){r=new Map;const s=this.layer,n=t.source;let o=null;if(!(!n||n.type==="map-layer"&&n.mapLayerId===t.id&&(!n.gdbVersion||n.gdbVersion===("gdbVersion"in s&&s.gdbVersion)))||t.originIdOf("renderer")>xe.SERVICE||t.originIdOf("labelingInfo")>xe.SERVICE||t.originIdOf("labelsVisible")>xe.SERVICE){const l=new Zs({layer:this.layer});o=l.hasDynamicLayers?l.dynamicLayers:null,l.destroy()}const a=o||`${s.uid}-default`;(await this._getLegendLayers(a,o)).forEach((l=>r.set(l.layerId,l)))}const i=r.get(t.id);if((!i||i?.subLayerIds&&i.defaultVisibility)&&t.sublayers){const s=await this._generateLegendElementsForSublayers(t.sublayers,e,r);return{type:"symbol-table",title:t.title,infos:s}}return this._generateSymbolTableElementForLegendLayer(i,t,e)}_generateSymbolTableElementForLegendLayer(t,e,r){if(!t?.legend||this.respectLayerVisibility&&!this._isLegendLayerInScale(t,e))return null;const i=e?.renderer;let s=e?.title||t.layerName;if(i&&(!e||e?.originIdOf("renderer")>xe.SERVICE)){const a=e?.title||this._getRendererTitle(i,e);a&&(s&&typeof a!="string"&&"title"in a&&(a.title=s),s=a)}const n={type:"symbol-table",title:s,legendType:t.legendType||null,infos:[]},o=e?this._sanitizeLegendForSublayer(t.legend.slice(),e):t.legend;return t.legendGroups&&t.legendGroups.length>0?t.legendGroups.forEach((a=>{const l={type:"symbol-table",title:a.heading,legendType:t.legendType||null,infos:this._generateSymbolTableElementInfosForLegendLayer(o.filter((u=>u.groupId===a.id)),t.layerId,r)};l.infos?.length>0&&n.infos.push(l)})):n.infos=this._generateSymbolTableElementInfosForLegendLayer(o,t.layerId,r),n.infos.length>0?n:null}_generateSymbolTableElementInfosForLegendLayer(t,e,r){return t.map((i=>{let s=i.url;if(i.imageData&&i.imageData.length>0)s=`data:image/png;base64,${i.imageData}`;else{if(s.indexOf("http")===0)return null;s=_X(`${this.layer.url}/${e}/images/${s}`)}return{label:i.label,src:s,opacity:r??this.opacity,width:i.width,height:i.height}})).filter(ii)}_isSublayerInScale(t){const e=t.minScale||0,r=t.maxScale||0;return!(e>0&&e<this.scale||r>this.scale)}_isLegendLayerInScale(t,e){const r=e||this.layer;let i=null,s=null,n=!0;return!r.minScale&&r.minScale!==0||!r.maxScale&&r.maxScale!==0?(t.minScale===0&&r.tileInfo&&(i=r.tileInfo.lods[0].scale),t.maxScale===0&&r.tileInfo&&(s=r.tileInfo.lods[r.tileInfo.lods.length-1].scale)):(i=Math.min(r.minScale,t.minScale)||r.minScale||t.minScale,s=Math.max(r.maxScale,t.maxScale)),(i>0&&i<this.scale||s>this.scale)&&(n=!1),n}_sanitizeLegendForSublayer(t,e){if("version"in this.layer&&+this.layer.version<10.1||t.length===0)return t;const r=e.renderer,i=t.some((o=>o.values));let s=0,n=null;return i&&t.some(((o,a)=>(o.values||(s=a,n=o,n.label||(n.label="others")),n!=null))),r?r.type==="unique-value"?n&&(t.splice(s,1),t.push(n)):r.type==="class-breaks"&&(n&&t.splice(s,1),r.legendOptions?.order||t.reverse(),n&&t.push(n)):n&&(t.splice(s,1),t.push(n)),t}async _getRendererLegendElements(t,e={}){if(!rCe(t,this.view))return q.getLogger(this).warn(`Renderer of type '${t.type}' not supported!`),[];if(eCe(t))return this._constructPointCloudRendererLegendElements(t,e);if(xZ(t))return this._constructDotDensityRendererLegendElements(t);const r=await this._loadRenderer(t);return $Z(r)?this._constructPieChartRendererLegendElements(r):this._constructRendererLegendElements(r,e)}async _getLegendElementsForFeatureReduction(t){let e=null;return t.type==="binning"?e=t.renderer:t.type==="cluster"&&(e=this._getClusterRenderer(t)),e?this._getRendererLegendElements(e):[]}_getPointCloudRendererTitle(t){return(t.legendOptions?.title||t.field)??""}async _constructPointCloudRendererLegendElements(t,e={}){const r=e.title,i=[];let s=null,n=null;if($L(t))s={type:"symbol-table",title:r||this._getPointCloudRendererTitle(t),infos:[]},t.colorClassBreakInfos.forEach((o=>{s.infos.unshift({label:o.label||o.minValue+" - "+o.maxValue,value:[o.minValue,o.maxValue],symbol:this._getAppliedCloneSymbol(a1,o.color)})}));else if(ML(t)){const o=t.stops;let a=null;if(o?.length&&(o.length===1&&(a=o[0].color),!a)){const u=o[0].value,h=o[o.length-1].value;u!=null&&h!=null&&(a=EW(u+(h-u)/2,o))}s={type:"symbol-table",title:null,infos:[{label:null,value:null,symbol:this._getAppliedCloneSymbol(a1,a||a1.color)}]};const l=A$e(t.stops??[])??[];n={type:"color-ramp",title:r||this._getPointCloudRendererTitle(t),infos:l,preview:ah(l.map((u=>u.color)),{ariaLabel:await Ua("previewColorRampAriaLabel")})}}else TL(t)&&(s={type:"symbol-table",title:r||this._getPointCloudRendererTitle(t),infos:[]},t.colorUniqueValueInfos?.forEach((o=>{s.infos.push({label:o.label||o.values.join(", "),value:o.values.join(", "),symbol:this._getAppliedCloneSymbol(a1,o.color)})})));return s?.infos.length&&i.push(s),n?.infos.length&&i.push(n),await this._generatePreviewsForLegendElements(i,{opacity:this.opacity,symbolConfig:{applyColorModulation:!!t.colorModulation}}),i}async _getElementInfoForDotDensity(t,e){const{color:r,label:i,valueExpressionTitle:s}=e,{backgroundColor:n,outline:o,dotSize:a}=t,l=this.effectList,u=l?.effects.map((b=>b.toJSON())),h=cS(u),p=await Ua("previewTemplateAriaLabel",i||s),m=a+"-"+r+"-"+n+"-"+(o&&JSON.stringify(o.toJSON()))+"-"+h,y=this._dotDensityUrlCache,g=y.has(m)?y.get(m):c$e(t,r,{ariaLabel:p});y.set(m,g);const v={shape:{type:"image",x:0,y:0,width:g.width,height:g.height,src:g.src},fill:null,stroke:null,offset:[0,0]},_=Zm([[v]],[g.width,g.height],{effectView:this.effectList,ariaLabel:p});return{opacity:1,src:g.src,preview:_,width:g.width,height:g.height}}async _constructDotDensityRendererLegendElements(t){const e=t.calculateDotValue(this.view.scale),r=t.legendOptions?.unit,i={type:"symbol-table",title:{value:e&&Math.round(e),unit:r||""},infos:[]};for(const s of t.attributes){const n=await this._getElementInfoForDotDensity(t,s);n.label=s.label||s.valueExpressionTitle||s.field,i.infos.push(n)}return[i]}async _constructPieChartRendererLegendElements(t){const e=[];let r=null;const i=t.outline;t.attributes.forEach((o=>{const a=new Pt({color:o.color,outline:i}),l=o.label||o.valueExpressionTitle||o.field;e.push({label:l,symbol:a})}));const s=e.length?[...e]:[];if(t.othersCategory?.color&&t.othersCategory?.threshold!==0){const o=new Pt({color:t.othersCategory.color,outline:i});r=t.othersCategory.label||"Other",e.push({label:r,symbol:o})}if(t.defaultColor?.a){const o=new Pt({color:t.defaultColor,outline:i});e.push({label:t.defaultLabel,symbol:o})}const n=await this._getVisualVariableLegendElements(t,this.layer)||[];if(e.length){n.unshift({type:"symbol-table",title:null,infos:e});const o=s.filter((l=>l.label!==r)).map((l=>l.symbol.color)).filter(Boolean),a=h$e(o,{holePercentage:t.holePercentage,backgroundColor:t.backgroundFillSymbol?.color,effectList:this.effectList,outline:i,ariaLabel:await Ua("previewPieChartAriaLabel")});n.unshift({type:"pie-chart-ramp",title:this._getRendererTitle(t,this.layer),infos:e,preview:a})}return await this._generatePreviewsForLegendElements(n,{opacity:this.layer.opacity,effectView:this.effectList}),n}async _getWhereClause(t,e,r){const i=await oA(t,r),s=new Set,{field:n,field2:o,field3:a}=e;dc(s,r,[n,o,a]),si(s,r,e.valueExpression);const l=new Set(Array.from(s,(h=>h.toLowerCase())));return i?.fieldNames.map((h=>h.toLowerCase()))?.some((h=>!l.has(h)))?null:i}async _processDefinitionExpression(t,e){if(!("definitionExpression"in t))return;const r=t.definitionExpression;r&&this.respectLayerDefinitionExpression?this._layerDefinitionExpression!==r&&(this._layerDefinitionExpressionClause=await this._getWhereClause(r,e,t.fieldsIndex)):this._layerDefinitionExpressionClause=null,this._layerDefinitionExpression=r}async _processDisplayFilter(t,e){if(!("displayFilterInfo"in t))return;const r=t.displayFilterInfo?ube(t.displayFilterInfo,this.view):null;return r?.where?this._layerDisplayFilterId!==r?.id&&(this._layerDisplayFilterClause=await this._getWhereClause(r.where,e,t.fieldsIndex)):this._layerDisplayFilterClause=null,this._layerDisplayFilterId=r?.id,r}async _constructRendererLegendElements(t,e={}){const{title:r,sublayer:i}=e,s=i||this.layer,n=ga(t,"reference-size"),o=ga(t,"spike");let a=null;hh(t)&&(await this._processDefinitionExpression(s,t),a=await this._processDisplayFilter(s,t)),this._hasColorRamp=!1,this._hasOpacityRamp=!1,this._hasSizeRamp=!1,this._scaleDrivenSizeVariable=null;const l=await this._getVisualVariableLegendElements(t,s)||[],u={type:"symbol-table",title:r||this._getRendererTitle(t,s),infos:[]};let h=null,p=!1;const m=new Set;if(HC(t)&&!this._hasSizeRamp){const b=await MW(t);u.infos.push({label:null,symbol:b})}else if(uCe(t)){let b=r;const S=cCe(t)?"univariate-above-and-below-ramp":"univariate-color-size-ramp",$=l.findIndex((D=>D.type==="color-ramp")),T=$!==-1?l.splice($,1)[0]:null,I=l.findIndex((D=>D.type==="size-ramp")),P=I!==-1?l.splice(I,1)[0]:null,R=[];T&&(b=T.title,R.push(T)),P&&(b=P.title,R.push(P)),R.length>0&&l.push({type:S,title:b,infos:R})}else if(SZ(t)){const b=k$e(t);l.push({type:"heatmap-ramp",title:r||this._getRendererTitle(t,s),infos:b,preview:ah(b.map((S=>S.color)),{effectList:this.effectList,ariaLabel:await Ua("previewColorRampAriaLabel")})})}else if(hh(t)){const b=t.authoringInfo;if(b&&b.type==="relationship"){const{numClasses:S,field1:$,field2:T}=b,I=b.focus;if(S&&$&&T){const P=[$,T];let R=_W(I)||0;for(const V of P){const{field:U,normalizationField:Z,label:X}=V,le=X||{field:this._getFieldAlias(U,s),normField:Z&&this._getFieldAlias(Z,s)},ee=dCe.clone();ee.angle=R,u.infos.push({label:le,symbol:ee}),m.add(ee),R+=90}const D=u$e({focus:I,numClasses:S,infos:t.uniqueValueInfos??[]});l.unshift(D)}}else if(np(this.layer)||l1(this.layer))t.uniqueValueInfos?.forEach((S=>{S.symbol&&this._checkClausesForUVR(t,S.value)&&u.infos.push({label:S.label||S.value,value:S.value,symbol:S.symbol})}));else{const{field:S,field2:$,field3:T,fieldDelimiter:I,valueExpression:P,defaultSymbol:R}=t,D=!(!S&&!P||!$&&!T),V=this._layerDisplayFilterClause?a?.title:null,U=[];if(t.uniqueValueGroups?.forEach((Z=>{const X={type:"symbol-table",title:V||Z.heading,infos:[]};Z.classes?.forEach((le=>{const{symbol:ee,values:ke}=le;if(ee){const Ze=[],it=[];for(const Hi of ke??[]){const{value:po,value2:Aa,value3:Od}=Hi,La=[],Nd=[];(S||P)&&(La.push(po),Nd.push(this._getDomainName(S,po,s))),$&&(La.push(Aa),Nd.push(this._getDomainName($,Aa,s))),T&&(La.push(Od),Nd.push(this._getDomainName(T,Od,s))),Ze.push(D?La.join(I||""):La[0]),it.push(Nd.join(" - "))}const ze=Ze.join(", ");let zt=le.label;if(!zt){const Hi=it.filter(Boolean);zt=Hi.length?Hi.join(", "):ze}const ho=ee.clone();ho.type==="cim"&&n&&nL(ho,{innerDotSize:.5*Q4,outerRingSize:Q4}),Ze.some((Hi=>this._checkClausesForUVR(t,Hi)))&&X.infos.push({label:zt,value:ze,symbol:ho})}})),X.infos.length&&U.push(X)})),U.length){const Z=U[0];if(U.length===1&&"title"in Z&&!Z.title){const X=Z.infos?.filter(r6)??[];u.infos.push(...X)}else R&&(U.push({type:"symbol-table",infos:[{label:t.defaultLabel||"others",symbol:R}]}),p=!0),u.infos.push(...U);r||t.legendOptions?.title||t.valueExpressionTitle||(u.title=null)}}t.defaultSymbol&&!p&&(u.infos.push({label:t.defaultLabel||"others",symbol:t.defaultSymbol}),p=!0)}else if(ch(t)){if(!n&&!o){if(h=this._isUnclassedRenderer(t),!h||!this._hasSizeRamp){const b=t.classBreakInfos.filter((({symbol:$})=>$)),S=t.legendOptions?.order==="ascending-values";for(const{label:$,minValue:T,maxValue:I,symbol:P}of b){const R={label:$||(h?null:`${T} - ${I}`),value:[T,I],symbol:P};S?u.infos.push(R):u.infos.unshift(R)}h&&(u.title=null),this._updateInfosForClassedSizeRenderer(t,u.infos)}t.defaultSymbol&&!h&&(u.infos.push({label:t.defaultLabel||"others",symbol:t.defaultSymbol}),p=!0)}}else if(bZ(t))if(l1(this.layer)||aCe(this.layer)){const b=await this._constructTileImageryStretchRendererElements(t);lCe(b)?l.push(b):u.infos=b}else{const b=this.layer;let S,$;t.customStatistics?.length&&({min:S,max:$}=t.customStatistics[0]);let T=[],I=b.serviceRasterInfo;if(b.rasterFunction)try{I=await b.generateRasterInfo(b.rasterFunction)}catch{}const P=dS(I.pixelType);if(I.bandCount===1){const R=b.bandIds?.[0]||0;S=S??(I.statistics?I.statistics[R].min:P[0]),$=$??(I.statistics?I.statistics[R].max:P[1]),S||$?l.push(await this._getStretchLegendElements(t,{min:S,max:$})):this._getServerSideLegend()}else if(b.bandIds&&b.bandIds.length===1)S=S??(I.statistics?I.statistics[b.bandIds[0]].min:P[0]),$=$??(I.statistics?I.statistics[b.bandIds[0]].max:P[1]),S||$?l.push(await this._getStretchLegendElements(t,{min:S,max:$})):this._getServerSideLegend();else if(I.bandCount>=3){const{bandInfos:R}=I,{bandIds:D}=b;R.length>=I.bandCount?D?.length===3?(T=D.map((V=>R[V].name)),u.infos=this._createSymbolTableElementMultiBand(T)):b.format==="lerc"?(T=[0,1,2].map((V=>R[V].name)),u.infos=this._createSymbolTableElementMultiBand(T)):this._getServerSideLegend():b.format==="lerc"?(T=["band1","band2","band3"],u.infos=this._createSymbolTableElementMultiBand(T)):this._getServerSideLegend()}else this._getServerSideLegend()}else if(_Z(t))t.colormapInfos.forEach((b=>{u.infos.push({label:b.label,value:b.value,symbol:this._getAppliedCloneSymbol(QIe,b.color)})}));else if(Pp(t)){let b=t.symbol;switch(e.geometryType){case"point":b="pointSymbol"in s?s.pointSymbol:null;break;case"polyline":b="lineSymbol"in s?s.lineSymbol:null;break;case"polygon":b="polygonSymbol"in s?s.polygonSymbol:null}const S=this._hasClusterSizeVariable&&this._getClusterSymbol()||!this._hasSizeRamp;t.symbol&&S&&u.infos.push({label:t.label,symbol:b})}else if(vZ(t)){t.outputUnit&&(this.title="("+t.toJSON().outputUnit+")"),u.title=t.attributeField;const b=t.getClassBreakInfos();b?.length?b.forEach((S=>{u.infos.push({label:S.minValue+" - "+S.maxValue,symbol:S.symbol})})):u.infos.push({label:t.attributeField,symbol:t.getDefaultSymbol()})}else wZ(t)&&l.push(await this._getStretchLegendElements(t,{min:0,max:255}));const y=t.defaultSymbol;!y||p||Pp(t)||h&&!this._hasColorRamp&&!this._hasSizeRamp&&!this._hasOpacityRamp||l.push({type:"symbol-table",infos:[{label:t.defaultLabel||"others",symbol:y}]}),u.infos.length&&l.unshift(u);const g=e.opacity==null?this.opacity:e.opacity,v=this._isTallSymbol("visualVariables"in t?t.visualVariables:null),_=np(this.layer)||l1(this.layer);return await this._generatePreviewsForLegendElements(l,{opacity:g,symbolConfig:{isTall:v,isSquareFill:_},effectView:this.effectList},{defaultSymbol:y,arrowMarkerSymbols:m}),t=null,l}_checkClausesForUVR(t,e){const r=hCe(t,e);return!r||(!this._layerDefinitionExpressionClause||this._layerDefinitionExpressionClause.testFeature(r))&&(!this._layerDisplayFilterClause||this._layerDisplayFilterClause.testFeature(r))}_getServerSideLegend(){setTimeout((()=>this.buildLegendElementsForTools()),0)}_getAllInfos(t){const e=t?.infos;return e?e.reduce(((r,i)=>r.concat(this._getAllInfos(i))),[]):[t]}async _constructTileImageryStretchRendererElements(t){const e=this.layer,r=e.symbolizer.rasterInfo??e.raster.rasterInfo;let i,s;const n=t?.customStatistics?.length?t.customStatistics:r?.statistics;if(n)({min:i,max:s}=n[0]);else{const a=dS(r.pixelType);i=a[0],s=a[1]}if(e.hasStandardTime()&&(i=e.getStandardTimeValue(i),s=e.getStandardTimeValue(s)),r.bandCount===1||e.bandIds?.length===1)return this._getStretchLegendElements(t,{min:i,max:s});const o=(e?.bandIds?.length?e.bandIds:Array.from(Array(Math.min(r.bandCount,3)).keys())).map((a=>r.bandInfos[a].name));return o.length<3?o.push(o[1]):o.length>3&&o.splice(3),this._createSymbolTableElementMultiBand(o)}async _getStretchLegendElements(t,e){const r=t.colorRamp,i=R$e(r,e);return{type:"stretch-ramp",title:"",infos:i,preview:ah(i.map((s=>s.color)),{ariaLabel:await Ua("previewColorRampAriaLabel")})}}_getClusterSymbol(){const t=this.layer,e="featureReduction"in t&&t.featureReduction,r=e&&"symbol"in e&&e.renderer;return r&&r?.authoringInfo?.isAutoGenerated!==!0?null:e&&"symbol"in e?e.symbol:null}async _getSizeLegendElement(t,e,r,i){return{type:"size-ramp",title:this._hasClusterSizeVariable?this._getClusterTitle(e):t,infos:await DIe(r,e,await LC(r),this.scale,this.view,i,this._hasClusterSizeVariable?this._getClusterSymbol():null)}}_createSymbolTableElementMultiBand(t){const e=[],r=["red","green","blue"];return t.forEach(((i,s)=>{e.push({label:{colorName:r[s],bandName:i},src:M$e[s],opacity:this.opacity??1})})),e}_updateInfosForClassedSizeRenderer(t,e){const r=t.authoringInfo&&t.authoringInfo.type==="class-breaks-size",i=t.classBreakInfos.some((s=>Y2(s.symbol)));if(r&&i){const s=GC,n=BC,o=t.classBreakInfos.length,a=(s-n)/(o>1?o-1:o);e.forEach(((l,u)=>{l.size=s-a*u}))}}_isTallSymbol(t){let e=!1,r=!1;if(t)for(let i=0;i<t.length&&(!e||!r);i++){const s=t[i];s.type==="size"&&(s.axis==="height"&&(e=!0),s.axis==="width-and-depth"&&(r=!0))}return e&&r}async _generatePreviewsForLegendElements(t,e,r){const i=[];for(const s of t)for(const n of s.infos??[])if("infos"in n&&n.infos&&i.push(this._generatePreviewsForLegendElements([n],e,r)),r6(n)&&n.symbol&&!n.preview){let o=!0;if(n.symbol.type==="cim"){const{minScale:a,maxScale:l}=n.symbol.data;(a&&a<this.scale||l&&l>this.scale)&&(o=!1)}o&&i.push(this._generateSymbolPreviewForInfo(n,{...e,clipBloomEffect:"theme"in s&&s.theme==="spike",effectView:r?.arrowMarkerSymbols?.has(n.symbol)?null:e.effectView},r?{isDefault:n.symbol===r.defaultSymbol,applyScaleDrivenSize:!r.arrowMarkerSymbols?.has(n.symbol)}:void 0))}await Promise.all(i)}async _generateSymbolPreviewForInfo(t,e,r){try{let i=!r?.isDefault&&t.size==null&&this._hasSizeRamp?tt(Bt.size):t.size;if(this._scaleDrivenSizeVariable&&r?.applyScaleDrivenSize){const{getSize:o}=await J(()=>Promise.resolve().then(()=>Ad),void 0);i=o(this._scaleDrivenSizeVariable,null,{view:this.view.type,scale:this.scale,shape:t.symbol.type==="simple-marker"?t.symbol.style:null})}const s=t.symbol.type==="cim"?{style:"legend",cimOptions:{allowScalingUp:!r?.isDefault&&this._hasSizeRamp||!(!this._scaleDrivenSizeVariable||!r?.applyScaleDrivenSize),viewParams:this.isScaleDriven?{viewingMode:this.view?.type==="2d"?"map":this.view?.viewingMode,scale:this.view?.scale}:null}}:{},n=t.label&&typeof t.label!="string"?null:await Ua("previewTemplateAriaLabel",t.label);t.preview=await bW(t.symbol,{size:i,scale:!1,ariaLabel:n,...e,...s})}catch{t.preview=null,q.getLogger(this).warn(`Generating symbol preview failed for symbol type: ${t.symbol?.type}`)}}_getClusterRenderer(t){this._hasClusterSizeVariable=!1;const e="renderer"in this.layer?this.layer.renderer:null,r=t.renderer?.clone()||e?.clone(),i=f$e(t,this.layerView,this.view);if(i&&r!=null&&"visualVariables"in r&&!r.visualVariables?.some((n=>n.type==="size"&&n.target!=="outline"&&!o1.test(n.valueExpression)))){if("clusterMinSize"in t&&"clusterMaxSize"in t){const{clusterMinSize:o,clusterMaxSize:a}=t;i.legendOptions=new Dq({showLegend:o!==a})}const n=r.visualVariables||[];r.visualVariables=n.concat([i]),this._hasClusterSizeVariable=!0}return r}async _loadRenderer(t){const e=[],r=t.clone(),i=await LC(r);if(ch(r)||hh(r)){const s=(r.classBreakInfos||r.uniqueValueInfos).map((n=>this._fetchSymbol(n.symbol,i).then((o=>{n.symbol=o})).catch((()=>{n.symbol=null}))));Array.prototype.push.apply(e,s)}return e.push(this._fetchSymbol(r.symbol||r.defaultSymbol,r.defaultSymbol?null:i).then((s=>{this._applySymbolToRenderer(r,s,Pp(r))})).catch((()=>{this._applySymbolToRenderer(r,null,Pp(r))}))),await Promise.allSettled(e),r}_applySymbolToRenderer(t,e,r){r?t.symbol=e:t.defaultSymbol=e}async _fetchSymbol(t,e){if(!t)throw new Error;if(t.type==="web-style"){const r=this._webStyleSymbolCache;try{const i=await t.fetchSymbol({cache:r});return this._getAppliedCloneSymbol(i,e)}catch{throw q.getLogger(this).warn("Fetching web-style failed!"),new Error}}return this._getAppliedCloneSymbol(t,e)}_getAppliedCloneSymbol(t,e){if(!t||!e)return t;const r=t.clone(),i=e&&e.toRgba();return r.type.includes("3d")?this._applyColorTo3dSymbol(r,i):r.type==="cim"?jH(r,e):r.color&&(r.color=new Q(i||r.color)),r}_applyColorTo3dSymbol(t,e){e&&t.symbolLayers.forEach((r=>{r&&(r.material||(r.material={}),r.material.color=new Q(e))}))}async _getVisualVariableLegendElements(t,e){if(!("visualVariables"in t)||t.type==="vector-field")return null;const r=t.visualVariables??[],i=[],s=[],n=[],o=ga(t,"reference-size")??ga(t,"spike");let a;if(o?.sizeStops?.length===2&&(ch(t)||hh(t))){const[m,y]=o.sizeStops;a=new Ue({field:o.field??void 0,normalizationField:o.normalizationField,minSize:$i(m.size,10,100),maxSize:$i(y.size,50,150),minDataValue:m.value,maxDataValue:y.value}),s.push(a)}for(const m of r)m.type==="color"?i.push(m):m.type==="size"?s.push(m):m.type==="opacity"&&n.push(m);const l=[...i,...s,...n];let u,h;if(i.length===0&&ch(t)&&t.classBreakInfos&&t.classBreakInfos.length===1){const m=t.classBreakInfos[0];u=m&&m.symbol}if(i.length===0&&Pp(t)&&(u=t.symbol),u)if(u.type.includes("3d")){const m=u.symbolLayers.at(0);m.type==="water"?m.color!=null&&(h=m.color):m.material?.color!=null&&(h=m.material.color)}else u.url||(h=u.color);const p=this.effectList;return(await Promise.all(l.map((async m=>{if(!m.legendOptions||m.legendOptions.showLegend!==!1){const y=HC(t)?m.field:this._getRampTitle(m,e);let g=null;const v=I$e(e,m,this.view.timeZone);if(m.type==="color"){const _=await w4(m,null,v)??[];g={type:"color-ramp",title:y,infos:_,preview:ah(_.map((b=>b.color)),{effectList:p,ariaLabel:await Ua("previewColorRampAriaLabel")})},this._hasColorRamp||(this._hasColorRamp=_.length>0)}else if(m.type==="size"&&m.target!=="outline")o1.test(m.valueExpression)?this._hasClusterSizeVariable||(this._scaleDrivenSizeVariable=m):(g=await this._getSizeLegendElement(y,m,t,v),a===m&&o?.theme==="spike"&&(g.theme=o.theme),this._hasSizeRamp||(this._hasSizeRamp=!(g.infos==null||!g.infos.length)));else if(m.type==="opacity"){const _=await w4(m,h,v)??[];g={type:"opacity-ramp",title:y,infos:_,preview:ah(_.map((b=>b.color)),{effectList:p,ariaLabel:await Ua("previewColorRampAriaLabel")})},this._hasOpacityRamp||(this._hasOpacityRamp=_.length>0)}return g?.infos?g:null}})))).filter(ii)}_getDomainName(t,e,r){if(t&&typeof t!="function"){const i="getField"in r&&r.getField?.(t),s=i&&"getFieldDomain"in r&&r.getFieldDomain?r.getFieldDomain(i.name,{excludeImpliedDomains:z("esri-widget-legacy-field-domain-calculation")}):null;return s?.type==="coded-value"?s.getName(e):null}return null}_getClusterTitle(t){const e=this.layer,r=t.field;if("featureReduction"in e&&e.featureReduction&&e.featureReduction.type==="cluster"){const i=e.featureReduction,s="popupTemplate"in i&&i.popupTemplate,n=s&&s.fieldInfos;if(n){for(const o of n)if(o.fieldName===r)return r==="cluster_count"?o.label||{showCount:!0}:o.label}}return{showCount:!0}}_getRampTitle(t,e){let r=t.field,i=t.normalizationField,s=!1,n=!1,o=!1,a=null;r=typeof r=="function"?null:r,i=typeof i=="function"?null:i;const l=t.legendOptions?.title;if(l!=null)a=l;else if(t.valueExpressionTitle)a=t.valueExpressionTitle;else{if("renderer"in e&&e.renderer&&"authoringInfo"in e.renderer&&e.renderer.authoringInfo?.visualVariables){const u=e.renderer.authoringInfo.visualVariables;for(let h=0;h<u.length;h++){const p=u[h];if(p.type==="color"){if(p.style==="ratio"){s=!0;break}if(p.style==="percent"){n=!0;break}if(p.style==="percent-of-total"){o=!0;break}}}}a={field:r&&this._getFieldAlias(r,e),normField:i&&this._getFieldAlias(i,e),ratio:s,ratioPercent:n,ratioPercentTotal:o}}return a}_getRendererTitle(t,e){const r=t;if(r.legendOptions?.title)return r.legendOptions.title;if(r.valueExpressionTitle)return r.valueExpressionTitle;let i=r.field,s=null,n=null;if(ch(r)&&(s=r.normalizationField,n=r.normalizationType==="percent-of-total"),i=typeof i=="function"?null:i,s=typeof s=="function"?null:s,hh(r)){const{field2:a,field3:l,fieldDelimiter:u}=r;let h=i&&this._getFieldAlias(i,e);return a&&(h=`<${h}>${u}<${this._getFieldAlias(a,e)}>`,l&&(h=`${h}${u}<${this._getFieldAlias(l,e)}>`)),h}let o=null;return(i||s)&&(o={field:i&&this._getFieldAlias(i,e),normField:s&&this._getFieldAlias(s,e),normByPct:n}),o}_getFieldAlias(t,e){let s=("popupTemplate"in e?e.popupTemplate:null)?.fieldInfos?.find((h=>t===h.fieldName)),n=null;"getField"in e&&e.getField?n=e.getField(t):"fieldsIndex"in e&&e.fieldsIndex&&(n=e.fieldsIndex.get(t));let o=null;const a="featureReduction"in e&&e.featureReduction;a&&(s??="popupTemplate"in a?a.popupTemplate?.fieldInfos?.find((h=>t?.toLowerCase()===h.fieldName?.toLowerCase())):void 0,"fields"in a&&a.fields&&(o=a.fields.find((h=>h.name?.toLowerCase()===t?.toLowerCase()))));const l=s||n||o;let u=null;return l&&(u=s?.label||n?.alias||o?.alias||"name"in l&&l.name||"fieldName"in l&&l.fieldName||null),u}_isUnclassedRenderer(t){const e=t.visualVariables;let r=!1;return ch(t)&&t.classBreakInfos&&t.classBreakInfos.length===1&&e&&(r=t.field?e.some((i=>!(!i||t.field!==i.field||(t.normalizationField||i.normalizationField)&&t.normalizationField!==i.normalizationField))):!!e.length),r}};c([d()],Zt.prototype,"children",void 0),c([d({readOnly:!0})],Zt.prototype,"effectList",null),c([d()],Zt.prototype,"layerView",void 0),c([d()],Zt.prototype,"layer",void 0),c([d()],Zt.prototype,"legendElements",void 0),c([d({readOnly:!0})],Zt.prototype,"opacity",null),c([d()],Zt.prototype,"parent",void 0),c([d({readOnly:!0,dependsOn:[]})],Zt.prototype,"ready",null),c([d()],Zt.prototype,"hideLayersNotInCurrentView",void 0),c([d()],Zt.prototype,"keepCacheOnDestroy",void 0),c([d()],Zt.prototype,"respectLayerDefinitionExpression",void 0),c([d()],Zt.prototype,"respectLayerVisibility",void 0),c([d({readOnly:!0})],Zt.prototype,"scale",null),c([d()],Zt.prototype,"sublayerIds",void 0),c([d({readOnly:!0})],Zt.prototype,"isScaleDriven",null),c([d()],Zt.prototype,"title",void 0),c([d({readOnly:!0,dependsOn:["ready"],value:0})],Zt.prototype,"version",null),c([d()],Zt.prototype,"view",void 0),Zt=c([C("esri.widgets.Legend.support.ActiveLayerInfo")],Zt);const Fc={state:"state",view:"view",allLayerViews:"all-layer-views",legendProperties:"legend-properties"},MZ=se.ofType(Zt),pCe=new Set(["esri.layers.BuildingSceneLayer","esri.layers.CatalogLayer","esri.layers.CSVLayer","esri.layers.FeatureLayer","esri.layers.GeoJSONLayer","esri.layers.GeoRSSLayer","esri.layers.GroupLayer","esri.layers.HeatmapLayer","esri.layers.ImageryLayer","esri.layers.ImageryTileLayer","esri.layers.MapImageLayer","esri.layers.OGCFeatureLayer","esri.layers.OrientedImageryLayer","esri.layers.ParquetLayer","esri.layers.PointCloudLayer","esri.layers.StreamLayer","esri.layers.SceneLayer","esri.layers.SubtypeGroupLayer","esri.layers.TileLayer","esri.layers.VoxelLayer","esri.layers.WFSLayer","esri.layers.WMSLayer","esri.layers.WMTSLayer","esri.layers.WCSLayer","esri.layers.LinkChartLayer","esri.layers.catalog.CatalogFootprintLayer","esri.layers.catalog.CatalogDynamicGroupLayer","esri.layers.knowledgeGraph.KnowledgeGraphSublayer","esri.layers.KnowledgeGraphLayer"]),TZ="view.basemapView.baseLayerViews",EZ="view.groundView.layerViews",IZ="view.basemapView.referenceLayerViews",fCe=[TZ,EZ,"view.layerViews",IZ];let $s=class extends ce{constructor(e){super(e),this._layerViewByLayerId={},this._layerInfosByLayerViewId={},this._activeLayerInfosByLayerViewId={},this._activeLayerInfosWithNoParent=new se,this.activeLayerInfos=new MZ,this.basemapLegendVisible=!1,this.groundLegendVisible=!1,this.hideLayersNotInCurrentView=!1,this.keepCacheOnDestroy=!1,this.respectLayerDefinitionExpression=!1,this.respectLayerVisibility=!0,this.layerInfos=[],this.view=null}initialize(){this.addHandles(ie((()=>this.view),(()=>this._viewHandles()),Ft),Fc.view),this.addHandles(M3((()=>this._refresh())))}destroy(){this._destroyViewActiveLayerInfos(),this.view=null}get state(){return this.view?.ready?"ready":"disabled"}_viewHandles(){this.removeHandles(Fc.state),this.view&&this.addHandles(ie((()=>this.state),(()=>this._stateHandles()),Ft),Fc.state)}_stateHandles(){this._resetAll(),this.state==="ready"&&this._watchPropertiesAndAllLayerViews()}_resetAll(){this.removeHandles([Fc.allLayerViews,Fc.legendProperties]),this._destroyViewActiveLayerInfos(),this.activeLayerInfos.removeAll()}_destroyViewActiveLayerInfos(){Object.keys(this._activeLayerInfosByLayerViewId).forEach(this._destroyViewActiveLayerInfo,this)}_destroyViewActiveLayerInfo(e){this.removeHandles(e);const r=this._activeLayerInfosByLayerViewId[e];delete this._activeLayerInfosByLayerViewId[e],r?.parent&&r.parent.children.remove(r)}_watchPropertiesAndAllLayerViews(){const{view:e}=this;if(!e)return;const{allLayerViews:r}=e;r.length&&this._refresh(),this.addHandles(r.on("change",(i=>this._allLayerViewsChangeHandle(i))),Fc.allLayerViews),this.addHandles(ie((()=>[this.layerInfos,this.basemapLegendVisible,this.groundLegendVisible]),(()=>this._propertiesChangeHandle())),Fc.legendProperties)}_allLayerViewsChangeHandle(e){e.moved.length?this._propertiesChangeHandle():(e.removed.forEach((r=>this._destroyViewActiveLayerInfo(r.uid))),this._refresh())}_propertiesChangeHandle(){this._destroyViewActiveLayerInfos(),this._refresh()}_refresh(){this._layerInfosByLayerViewId={},this.activeLayerInfos.removeAll(),this._generateLayerViews().filter(this._filterLayerViewsByLayerInfos,this).filter(this._isLayerViewSupported,this).forEach(this._generateActiveLayerInfo,this),this._sortActiveLayerInfos(this.activeLayerInfos)}_sortActiveLayerInfos(e){const r=this.view;if(e.length<2||!r)return;const i=[];e.forEach((n=>{if(!n.parent){const o=n.layer.parent,a=o&&"uid"in o&&this._layerViewByLayerId[o.uid],l=a&&this._activeLayerInfosByLayerViewId[a.uid];l&&e.includes(l)&&(i.push(n),n.parent=l,l.children.add(n),this._sortActiveLayerInfos(l.children))}})),e.removeMany(i);const s={};r.allLayerViews.forEach(((n,o)=>s[n.layer.uid]=o)),e.sort(((n,o)=>{const a=s[n.layer.uid]||0;return(s[o.layer.uid]||0)-a}))}_generateLayerViews(){const e=[];return fCe.filter(this._filterLayerViews,this).map((r=>un(this,r))).filter((r=>r!=null)).forEach(this._collectLayerViews("layerViews",e)),e}_filterLayerViews(e){const r=!this.basemapLegendVisible&&(e===TZ||e===IZ),i=!this.groundLegendVisible&&e===EZ;return!r&&!i}_collectLayerViews(e,r){const i=s=>(s&&s.forEach((n=>{r.push(n),i(n[e])})),r);return i}_filterLayerViewsByLayerInfos(e){const r=this.layerInfos;return!r||!r.length||r.some((i=>this._hasLayerInfo(i,e)))}_hasLayerInfo(e,r){const i=this._isLayerUIDMatching(e.layer,r.layer.uid);return i&&(this._layerInfosByLayerViewId[r.uid]=e),i}_isLayerUIDMatching(e,r){return e&&(e.uid===r||this._hasLayerUID(e.layers,r))}_hasLayerUID(e,r){return e&&e.some((i=>this._isLayerUIDMatching(i,r)))}_isLayerViewSupported(e){return!!pCe.has(e.layer.declaredClass)&&(this._layerViewByLayerId[e.layer.uid]=e,!0)}_generateActiveLayerInfo(e){this._isLayerActive(e)?this._buildActiveLayerInfo(e):(this.removeHandles(e.uid),this.addHandles(ie((()=>[e.legendEnabled,e.layer?.legendEnabled]),(()=>this._layerActiveHandle(e))),e.uid))}_layerActiveHandle(e){this._isLayerActive(e)&&(this.removeHandles(e.uid),this._buildActiveLayerInfo(e))}_isLayerActive(e){return!this.respectLayerVisibility||e.legendEnabled&&e.layer?.legendEnabled}_buildActiveLayerInfo(e){const r=e.layer,i=e.uid,s=this._layerInfosByLayerViewId[i];let n=this._activeLayerInfosByLayerViewId[i];if(!n){const a=s?.title!==void 0&&s.layer.uid===r.uid;n=new Zt({layer:r,layerView:e,title:a?s.title:r.title,view:this.view??void 0,respectLayerDefinitionExpression:this.respectLayerDefinitionExpression,respectLayerVisibility:this.respectLayerVisibility,hideLayersNotInCurrentView:this.hideLayersNotInCurrentView,keepCacheOnDestroy:this.keepCacheOnDestroy,sublayerIds:s?.sublayerIds||[]}),this._activeLayerInfosByLayerViewId[i]=n}const o=r.parent&&"uid"in r.parent?this._layerViewByLayerId[r.parent?.uid]:null;if(n.parent=this._activeLayerInfosByLayerViewId[o?.uid],!this.hasHandles(i)){const a=[ie((()=>r.title),(l=>this._titleHandle(l,n))),ie((()=>[r.opacity,"renderer"in r&&r.renderer,"pointSymbol"in r&&r.pointSymbol,"lineSymbol"in r&&r.lineSymbol,"polygonSymbol"in r&&r.polygonSymbol]),(()=>this._constructLegendElements(n))),fs((()=>this.view?.stationary===!0),(()=>this._scaleHandle(n)),Ft),ie((()=>e.layer?OF(e.layer,e.view):null),(()=>this._constructLegendElements(n))),ie((()=>e.updating),(()=>{e.layer!=null&&OF(e.layer,e.view)!=null&&this._constructLegendElements(n)})),ie((()=>"effect"in r&&r.effect),(()=>this._constructLegendElements(n))),fs((()=>this.view?.timeZone),(()=>this._constructLegendElements(n)),Ft)];if(this.respectLayerVisibility){const l=ie((()=>e.legendEnabled),(h=>this._legendEnabledHandle(h,n))),u=ie((()=>r.legendEnabled),(h=>this._legendEnabledHandle(h,n)));a.push(l,u)}if(this.respectLayerDefinitionExpression&&"definitionExpression"in r){const l=ie((()=>[r.definitionExpression,this.respectLayerDefinitionExpression]),(()=>{n.respectLayerDefinitionExpression=this.respectLayerDefinitionExpression,this._constructLegendElements(n)}));a.push(l)}this.addHandles(a,i)}n.isScaleDriven||this._constructLegendElements(n),this._addActiveLayerInfo(n)}_titleHandle(e,r){r.title=e,this._constructLegendElements(r)}_legendEnabledHandle(e,r){e?this._addActiveLayerInfo(r):this._removeActiveLayerInfo(r)}_scaleHandle(e){(e.isScaleDriven||e.hideLayersNotInCurrentView)&&this._constructLegendElements(e)}_addActiveLayerInfo(e){const{layerView:r,layer:i}=e;if(this._isLayerActive(r)&&!this.activeLayerInfos.includes(e)){const s=e.parent;if(s)s.children.includes(e)||s.children.push(e),this._sortActiveLayerInfos(s.children);else{const n=this.layerInfos?.some((a=>a.layer.uid===i.uid)),o=i.parent;o&&"uid"in o&&this._layerViewByLayerId[o.uid]&&!n?this._activeLayerInfosWithNoParent.add(e):(this.activeLayerInfos.add(e),this._sortActiveLayerInfos(this.activeLayerInfos))}if(this._activeLayerInfosWithNoParent.length){const n=[];this._activeLayerInfosWithNoParent.forEach((o=>{const a=o.layer.parent,l=a&&"uid"in a?this._layerViewByLayerId[a?.uid]:null,u=this._activeLayerInfosByLayerViewId[l?.uid];u&&(n.push(o),o.parent=u)})),n.length&&(this._activeLayerInfosWithNoParent.removeMany(n),n.forEach((o=>this._addActiveLayerInfo(o))))}}}_removeActiveLayerInfo(e){const r=e.parent;r?r.children.remove(e):this.activeLayerInfos.remove(e)}_constructLegendElements(e){const r=e.layer;"featureCollections"in r&&r.featureCollections?e.buildLegendElementsForFeatureCollections(r.featureCollections):"featureReduction"in r&&r.featureReduction&&"renderer"in r.featureReduction&&(r.featureReduction.type==="binning"||r.featureReduction.type==="cluster")&&(!this.view||r.featureReduction.maxScale<=this.view.scale)?e.buildLegendElementsForFeatureReduction(r.featureReduction):"renderer"in r&&r.renderer&&!("sublayers"in r)?e.buildLegendElementsForRenderer(r.renderer):"url"in r&&r.url&&r.type!=="catalog"&&r.type!=="knowledge-graph"?e.buildLegendElementsForTools():e.children.forEach((i=>this._constructLegendElements(i)))}};c([d({type:MZ})],$s.prototype,"activeLayerInfos",void 0),c([d()],$s.prototype,"basemapLegendVisible",void 0),c([d()],$s.prototype,"groundLegendVisible",void 0),c([d()],$s.prototype,"hideLayersNotInCurrentView",void 0),c([d()],$s.prototype,"keepCacheOnDestroy",void 0),c([d()],$s.prototype,"respectLayerDefinitionExpression",void 0),c([d()],$s.prototype,"respectLayerVisibility",void 0),c([d()],$s.prototype,"layerInfos",void 0),c([d({readOnly:!0})],$s.prototype,"state",null),c([d()],$s.prototype,"view",void 0),$s=c([C("esri.widgets.Legend.LegendViewModel")],$s);const Xe="esri-legend--card",Fy="esri-legend",be={base:Xe,stacked:`${Fy}--stacked`,carouselTitle:`${Xe}__carousel-title`,intervalSeparator:`${Xe}__interval-separator`,imageryLayerStretchedImage:`${Xe}__imagery-layer-image--stretched`,imageLabel:`${Xe}__image-label`,layerCaption:`${Xe}__layer-caption`,labelElement:`${Xe}__label-element`,layerRow:`${Xe}__layer-row`,labelCell:`${Xe}__label-cell`,message:`${Xe}__message`,rampLabel:`${Xe}__ramp-label`,section:`${Xe}__section`,serviceCaptionText:`${Xe}__service-caption-text`,serviceContent:`${Xe}__service-content`,service:`${Xe}__service`,groupLayer:`${Xe}__group-layer`,groupLayerChild:`${Xe}__group-layer-child`,symbol:`${Xe}__symbol`,sizeRampRow:`${Xe}__size-ramp-row`,symbolRow:`${Xe}__symbol-row`,symbolCell:`${Xe}__symbol-cell`,carousel:`${Xe}__carousel`,carouselItem:`${Xe}__carousel-item`,intervalSeparatorsContainer:`${Xe}__interval-separators-container`,relationshipLabelContainer:`${Xe}__relationship-label-container`,labelContainer:`${Xe}__label-container`,serviceCaptionContainer:`${Xe}__service-caption-container`,symbolContainer:`${Xe}__symbol-container`,colorRampContainer:`${Xe}__color-ramp-container`,sizeRampContainer:`${Xe}__size-ramp-container`,sizeRampPreview:`${Xe}__size-ramp-preview`,pieChartRampPreview:`${Xe}__pie-chart-ramp-preview`,sizeRampHorizontal:`${Fy}__size-ramp--horizontal`,rampLabelsContainer:`${Fy}__ramp-labels`,layerInfo:`${Fy}__layer-cell ${Fy}__layer-cell--info`,univariateAboveAndBelowColorRamp:"esri-univariate-above-and-below-ramp__color--card"};function mCe(t,e){return e}function Dt(t){const e=this;t.appendChild(e)}function $m(t,e,r){if(!e)return;if(typeof e=="number")return e;if(typeof e=="string")return DY(e);if("value"in e||"unit"in e)return Sw(t.dotValue,e);if("colorName"in e&&"bandName"in e)return t[e.colorName]+": "+(t[e.bandName]||e.bandName);if("showCount"in e)return e.showCount?t.clusterCountTitle:void 0;let i=null;return mCe(e,r)?i=e.ratioPercentTotal?"showRatioPercentTotal":e.ratioPercent?"showRatioPercent":e.ratio?"showRatio":e.normField?"showNormField":e.field?"showField":null:CZ(e,r)&&(i=e.normField?"showNormField":e.normByPct?"showNormPct":e.field?"showField":null),i?Sw(i==="showField"?"{field}":t[i],{field:e.field,normField:e.normField}):void 0}function CZ(t,e){return!e}function PZ(t,e){return!!(e&&e==="Stretched"&&"version"in t&&typeof t.version=="number"&&t.version>=10.3&&t.declaredClass==="esri.layers.ImageryLayer")}function yCe(t,e){return t.label?e[t.label]+": "+(typeof t.value=="string"?t.value:uc(t.value??0,{style:"decimal",notation:t.value?.toString().toLowerCase().includes("e")?"scientific":"standard"})):""}function AZ(t,e,r){switch(e){case"heatmap-ramp":return r[t.label]||t.label;case"stretch-ramp":return yCe(t,r);default:return t.label}}function LZ(t,e){if(!t.title||typeof t.title=="string")return t.title;const r=t.type==="color-ramp"||t.type==="opacity-ramp",i=t.title,s=$m(e,i,r);return CZ(i,r)&&i.title?`${i.title} (${s})`:s}function RZ(t){return!(!t||typeof t!="object")}const gCe=25,vCe=25,_Ce=100;let dh=class extends Lr{constructor(e,r){super(e,r),this.effectList=null,this.legendElement=null,this.opacity=1}render(){const e=this.legendElement.infos.slice().reverse();return L("div",{class:this.classes(be.layerRow,be.colorRampContainer)},this._renderRampLabel(e[0]),L("div",{class:be.symbolContainer},this._renderPreview(e),this._renderMiddleStopRampLabel(e)),this._renderRampLabel(e.at(-1)))}_renderPreview(e){const{opacity:r}=this,i=this.legendElement.type==="heatmap-ramp",s=e.length-1,n=vCe,o=s>2&&!i?gCe*s:_Ce,a=o+20,l=10,u=[[{shape:{type:"path",path:`M0 ${n/2} L${l} 0 L${l} ${n} Z`},fill:e[0].color,stroke:{width:0}},{shape:{type:"rect",x:l,y:0,width:o,height:n},fill:{type:"linear",x1:l,y1:0,x2:o+l,y2:0,colors:e.map(((m,y)=>({color:m.color,offset:i&&"ratio"in m?m.ratio:y/s})))},stroke:{width:0}},{shape:{type:"path",path:`M${o+l} 0 L${a} ${n/2} L${o+l} ${n} Z`},fill:e[e.length-1].color,stroke:{width:0}}]],h=oW(u,a,n),p={filter:Wv(this.effectList)??void 0,opacity:r==null?void 0:`${r}`};return L("div",{styles:p},h)}_renderMiddleStopRampLabel(e){const r=e.length%2!=0?e[e.length/2|0]:null;return r?L("div",{class:be.intervalSeparatorsContainer},L("div",{class:be.intervalSeparator},"|"),this._renderRampLabel(r)):null}_renderRampLabel(e){return L("div",{class:be.rampLabel},AZ(e,this.legendElement.type,this.messages))}};c([d()],dh.prototype,"effectList",void 0),c([d()],dh.prototype,"legendElement",void 0),c([d()],dh.prototype,"messages",void 0),c([d()],dh.prototype,"opacity",void 0),dh=c([C("esri.widgets.Legend.styles.card.ColorRamp")],dh);const bCe="#ddd",Zr=window.devicePixelRatio,Dc="esri-spike-ramp",Al={spikeRampContainer:`${Dc}__container`,spikeRampPreviewContainer:`${Dc}__preview-container`,spikeRampPreview:`${Dc}__preview`,spikeRampSymbolPreview:`${Dc}__symbol-preview`,spikeRampLines:`${Dc}__lines`,spikeRampLabelsContainer:`${Dc}__labels-container`,spikeRampLabel:`${Dc}__label`};function kZ(t){return t.infos.length!==5?null:L("div",{class:Al.spikeRampContainer},L("div",{class:Al.spikeRampPreviewContainer},wCe(t),SCe(t)),xCe(t))}function wCe(t){const[e,r,i]=EL(t).map((({preview:s})=>{if(!s)return null;const n=s.cloneNode(!0);return n.classList.add(Al.spikeRampSymbolPreview),n}));return e&&r&&i?L("div",{class:Al.spikeRampPreview},L("div",{afterCreate:Dt,bind:i}),L("div",{afterCreate:Dt,bind:r}),L("div",{afterCreate:Dt,bind:e})):null}function SCe(t){const[{width:e,height:r},{width:i},{width:s,height:n}]=EL(t).map((({size:D})=>RZ(D)?{width:Fe(D.width),height:Fe(D.height)}:{width:0,height:0})),o=10,a=8,l=e+i+s+3*o,u=r,h=document.createElement("canvas");h.width=(l+o)*Zr,h.height=u*Zr,h.style.width=h.width/Zr+"px",h.style.height=h.height/Zr+"px";const p=h.getContext("2d");p.beginPath();const m=l-(e/2+o),y=0,g=l+a;p.moveTo(m*Zr,y*Zr),p.lineTo(g*Zr,0*Zr);const _=(l-a)/2,b=(r-n)/2,S=l+a,$=(r-n)/2;p.moveTo(_*Zr,b*Zr),p.lineTo(S*Zr,$*Zr);const T=s/2,I=u-n,P=l+a,R=u-n;return p.moveTo(T*Zr,I*Zr),p.lineTo(P*Zr,R*Zr),p.strokeStyle=bCe,p.lineWidth=.5*Zr,p.stroke(),L("div",{afterCreate:Dt,bind:h,class:Al.spikeRampLines})}function xCe(t){const[{label:e,height:r},{label:i},{label:s,height:n}]=EL(t).map((({label:h,size:p})=>({label:h,height:RZ(p)?Fe(p.height):0}))),o=r-n,a={position:"absolute",top:"0"},l={position:"absolute",top:o/2+"px"},u={position:"absolute",top:`${o}px`};return L("div",{class:Al.spikeRampLabelsContainer},L("div",{class:Al.spikeRampLabel,styles:a},e),L("div",{class:Al.spikeRampLabel,styles:l},i),L("div",{class:Al.spikeRampLabel,styles:u},s))}function EL(t){return t.infos.filter(((e,r)=>r%2==0))}const $Ce="#ddd",ap=window.devicePixelRatio;function MCe(t){if(!t)return;if(t.type.includes("3d")){if(!t.symbolLayers?.length)return;const r=t.symbolLayers.at(-1),i=r.resource?.primitive;return i==="circle"||i==="cross"||i==="kite"||i==="sphere"||i==="cube"||i==="diamond"}const e=t.style;return e==="circle"||e==="diamond"||e==="cross"}function TCe(t){if(t){if(t.type.includes("3d")){if(!t.symbolLayers?.length)return;const e=t.symbolLayers.at(-1),r=e?.resource?.primitive;return r==="triangle"||r==="cone"||r==="tetrahedron"}return t.style==="triangle"}}let ph=class extends Lr{constructor(e,r){super(e,r),this.hasIndicators=!1,this.legendElement=null,this.opacity=1}render(){if(this.legendElement.theme==="spike")return L("div",{styles:{display:"flex",flex:"1",justifyContent:"center"}},kZ(this.legendElement));const{legendElement:e,hasIndicators:r,opacity:i}=this,s=e.infos,n=s.at(0),o=s.at(-1);if(!n||!o)return null;const{label:a,...l}=n,{label:u,...h}=o;let p=l.preview,m=h.preview;const y={"flex-direction":r?"column":"row-reverse"};if(!p||!m)return null;p=p.cloneNode(!0),p.style.display="flex",m=m.cloneNode(!0),m.style.display="flex";const g={opacity:`${i??""}`};return L("div",{class:this.classes(be.layerRow,{[be.sizeRampRow]:r})},L("div",{class:be.rampLabel},r?a:u),L("div",{class:be.sizeRampContainer,styles:y},L("div",{afterCreate:Dt,bind:p,class:be.sizeRampPreview,styles:g}),this._renderSizeRampLines(e),L("div",{afterCreate:Dt,bind:m,class:be.sizeRampPreview,styles:g})),L("div",{class:be.rampLabel},r?u:a))}_renderSizeRampLines(e){const r=e.infos,i=r.at(0),s=r.at(-1);if(!i||!s)return null;const n=i.symbol,o=this.hasIndicators,a=i.size&&typeof i.size=="number"?i.size:0,l=s.size&&typeof s.size=="number"?s.size:0,u=i.outlineSize||0,h=s.outlineSize||0,p=Fe(a+u)*ap,m=Fe(l+h)*ap,y=o?p:p+50*ap,g=o?p/2+50*ap:p,v=TCe(n),_=MCe(n),b=document.createElement("canvas");b.width=y,b.height=g,b.style.width=b.width/ap+"px",b.style.height=b.height/ap+"px";const S=b.getContext("2d");if(o){S.beginPath();const $=0,T=0,I=y/2-m/2,P=g;S.moveTo($,T),S.lineTo(I,P);const R=y,D=0,V=y/2+m/2,U=g;S.moveTo(R,D),S.lineTo(V,U)}else{S.beginPath();const $=0,T=g/2-m/2,I=y;S.moveTo($,T),S.lineTo(I,0);const R=0,D=g/2+m/2,V=y,U=g;S.moveTo(R,D),S.lineTo(V,U)}return S.strokeStyle=$Ce,S.stroke(),L("div",{afterCreate:Dt,bind:b,styles:o?{display:"flex",marginTop:`-${v?0:_?p/2:0}px`,marginBottom:`-${v?m:_?m/2:0}px`}:{display:"flex",marginRight:`-${v?0:_?p/2:0}px`,marginLeft:`-${v?0:_?m/2:0}px`}})}};c([d()],ph.prototype,"hasIndicators",void 0),c([d()],ph.prototype,"legendElement",void 0),c([d()],ph.prototype,"messages",void 0),c([d()],ph.prototype,"opacity",void 0),ph=c([C("esri.widgets.Legend.styles.card.SizeRamp")],ph);const ECe=Aw(),OZ=10,IL=20,tx=10,CL=20,PL={univariateAboveAndBelowSymbol:"esri-univariate-above-and-below-ramp__symbol",colorRamp:"esri-legend__color-ramp"};function ICe(t="vertical"){const e="stroke:rgb(200, 200, 200);stroke-width:1";return t==="vertical"?L("svg",{height:"4",width:"10"},L("line",{style:e,x1:"0",x2:"10",y1:"2",y2:"2"})):L("svg",{height:"10",width:"10"},L("line",{style:e,x1:"5",x2:"5",y1:"0",y2:"10"}))}function CCe(t,e="vertical"){const r=document.createElement("div");return r.style.height=`${IL}px`,r.className=PL.univariateAboveAndBelowSymbol,t!=null&&(r.style.opacity=t.toString()),ECe.append(r,ICe.bind(null,e)),r}function NZ(t,e,r="vertical",i){t.infos.forEach(((s,n)=>{if(i&&n===2)s.preview=CCe(e,r);else{const o=(_d(s.size)?Fe(s.size):0)+(r==="horizontal"?CL:tx),a=s.preview,l=a?.tagName.toLowerCase()==="div",u=l?a:document.createElement("div");u.className=PL.univariateAboveAndBelowSymbol,r==="horizontal"?u.style.width=`${o}px`:u.style.height=`${o}px`,!l&&a&&u.appendChild(a),s.preview=u}}))}function rx(t,e="classic"){const r=t.infos,i=r.at(0),s=r.at(-1),n=_d(i.size)?Fe(i.size):0,o=_d(s.size)?Fe(s.size):0;return e==="classic"?(n+tx)/2:(n-o)/2}function Mm(t,e){if(!t)return null;const r=t.infos.map((s=>s.color)),i=ah(e.type==="full"?r:e.type==="above"?r.slice(0,3):r.slice(2,5),{width:e.width,height:e.height,align:e.rampAlignment,effectList:e.effectList,ariaLabel:e.ariaLabel});return i.className=PL.colorRamp,e.opacity!=null&&(i.style.opacity=e.opacity.toString()),i}function AL(t,e,r,i="vertical"){let s=0;const n=t.infos,o=Math.floor(n.length/2),a=e==="full"||e==="above"?0:o,l=e==="full"||e==="below"?n.length-1:o;for(let u=a;u<=l;u++)if(r&&u===o)s+=i==="horizontal"?OZ:IL;else{const h=n[u].size;s+=(_d(h)?Fe(h):0)+(i==="horizontal"?CL:tx)}return Math.round(s)}function Tm(t,e,r,i="vertical"){const s=AL(t,e,r,i),n=t.infos,o=Math.floor(n.length/2),a=e==="full"||e==="above"?0:o,l=e==="full"||e==="below"?n.length-1:o,u=_d(n[a].size)?n[a].size:0,h=_d(n[l].size)?n[l].size:0,p=e==="full"?u+h:e==="above"?u:h,m=r?i==="vertical"?IL:OZ:0,y=i==="vertical"?tx*(e==="full"?2:1):CL*(e==="full"?2:1);return Math.round(s-(Fe(p)/2+m/2+y/2))}function FZ(t,e,r="vertical"){const i=t.infos;let s=i.find((({type:o})=>o==="size-ramp")),n=i.find((({type:o})=>o==="color-ramp"));return s&&(s={...s},s.infos=[...s.infos],NZ(s,e,r,!0)),n&&(n={...n},n.infos=[...n.infos]),r==="horizontal"&&(s?.infos.reverse(),n?.infos.reverse()),{sizeRampElement:s,colorRampElement:n}}function DZ(t,e="vertical"){const r=t.infos;let i=r.find((({type:n})=>n==="size-ramp")),s=r.find((({type:n})=>n==="color-ramp"));return i&&(i={...i},i.infos=[...i.infos],NZ(i,null,e,!1)),s&&(s={...s},s.infos=[...s.infos]),e==="horizontal"&&(i?.infos.reverse(),s?.infos.reverse()),{sizeRampElement:i,colorRampElement:s}}const WC={marginLeft:"3px"},cf={display:"table-cell",verticalAlign:"middle"},zZ={display:"flex",alignItems:"flex-start"};let fh=class extends Lr{constructor(e,r){super(e,r),this.effectList=null,this.legendElement=null,this.opacity=1}render(){const{legendElement:e,opacity:r,effectList:i,key:s}=this,{sizeRampElement:n,colorRampElement:o}=FZ(e,r,"horizontal");if(!n)return null;const a=AL(n,"full",!0,"horizontal"),l=Tm(n,"above",!0,"horizontal"),u=Tm(n,"below",!0,"horizontal"),h=12,p=this.messages?.previewColorRampAriaLabel,m=Mm(o,{width:l,height:h,rampAlignment:"horizontal",opacity:r,type:"above",effectList:i,ariaLabel:p}),y=Mm(o,{width:u,height:h,rampAlignment:"horizontal",opacity:r,type:"below",effectList:i,ariaLabel:p}),g=rx(n,"card"),v=n.infos.map((P=>P.label)),_=v.length-1,b=v.map(((P,R)=>R===0||R===_?L("div",{key:R},P):null)),S={display:"flex",flexDirection:"column"},$={display:"flex",flexDirection:"row"},T={marginTop:"3px",display:"flex"};k2(this.container)?T.marginRight=`${g}px`:T.marginLeft=`${g}px`;const I={width:`${a}px`,display:"flex",flexDirection:"row",justifyContent:"space-between"};return L("div",{class:be.layerRow,key:`${s}-container`,styles:S},L("div",{class:this.classes(be.symbolContainer,be.sizeRampHorizontal),styles:$},n.infos.map(((P,R)=>L("div",{afterCreate:Dt,bind:P.preview,class:be.symbol,key:R})))),m?L("div",{class:be.univariateAboveAndBelowColorRamp,key:"color-ramp-preview",styles:T},L("div",{afterCreate:Dt,bind:m}),L("div",{afterCreate:Dt,bind:y})):null,L("div",{class:be.layerInfo},L("div",{class:be.rampLabelsContainer,styles:I},b)))}};c([d()],fh.prototype,"effectList",void 0),c([d()],fh.prototype,"legendElement",void 0),c([d()],fh.prototype,"messages",void 0),c([d()],fh.prototype,"opacity",void 0),fh=c([C("esri.widgets.Legend.styles.card.UnivariateAboveAndBelowRamp")],fh);let mh=class extends Lr{constructor(e,r){super(e,r),this.effectList=null,this.legendElement=null,this.opacity=1}render(){const{legendElement:e,opacity:r,effectList:i,key:s}=this,{sizeRampElement:n,colorRampElement:o}=DZ(e,"horizontal");if(!n)return null;const a=AL(n,"full",!1,"horizontal"),l=Tm(n,"full",!1,"horizontal"),u=Mm(o,{width:l,height:12,rampAlignment:"horizontal",opacity:r,type:"full",effectList:i,ariaLabel:this.messages?.previewColorRampAriaLabel}),h=rx(n,"card"),p=n.infos.length-1,m=n.infos.map(((b,S)=>S===0||S===p?L("div",{key:S},b.label):null)),y={display:"flex",flexDirection:"column"},g={display:"flex",flexDirection:"row"},v={marginTop:"3px",display:"flex"};k2(this.container)?v.marginRight=`${h}px`:v.marginLeft=`${h}px`;const _={width:`${a}px`,display:"flex",flexDirection:"row",justifyContent:"space-between"};return L("div",{class:be.layerRow,key:`${s}-container`,styles:y},L("div",{class:this.classes(be.symbolContainer,be.sizeRampHorizontal),styles:g},n.infos.map(((b,S)=>L("div",{afterCreate:Dt,bind:b.preview,class:be.symbol,key:S})))),L("div",{class:be.univariateAboveAndBelowColorRamp,key:"color-ramp-preview",styles:v},L("div",{afterCreate:Dt,bind:u})),L("div",{class:be.layerInfo},L("div",{class:be.rampLabelsContainer,styles:_},m)))}};c([d()],mh.prototype,"effectList",void 0),c([d()],mh.prototype,"legendElement",void 0),c([d()],mh.prototype,"messages",void 0),c([d()],mh.prototype,"opacity",void 0),mh=c([C("esri.widgets.Legend.styles.card.UnivariateColorSizeRamp")],mh);function Ob({level:t,class:e,...r},i){const s=VZ(t);return L(`h${s}`,{...r,"aria-level":String(s),class:ef(Hr.heading,e),role:"heading"},i)}function VZ(t){return $i(Math.ceil(t),1,6)}function PCe(t,e=1){return VZ(t+e)}var ZC;let Ys=ZC=class extends Lr{constructor(t,e){super(t,e),this.effectList=null,this.hasIndicators=!1,this.headingLevel=3,this.isChild=!1,this.legendElement=null}render(){const t=this._renderLegendElement(),e=LZ(this.legendElement,this.messages),r=this.hasIndicators&&!this.isChild?L("div",null,L(Ob,{class:be.carouselTitle,level:this.headingLevel},this.activeLayerInfo.title),L(Ob,{class:be.layerCaption,level:PCe(this.headingLevel)},e)):e?L(Ob,{class:be.layerCaption,level:this.headingLevel},e):null;return L("section",{"aria-labelledby":this.key,class:be.section,id:`${this.key}-panel`,key:this.key,role:"tabpanel",tabIndex:0},r,t)}_renderLegendElement(){switch(this.legendElement.type){case"symbol-table":return this._renderSymbolTable(this.legendElement);case"size-ramp":return L(ph,{hasIndicators:this.hasIndicators,key:this.key,legendElement:this.legendElement,messages:this.messages,opacity:this.layer.opacity});case"color-ramp":case"opacity-ramp":case"heatmap-ramp":case"stretch-ramp":return L(dh,{effectList:this.effectList,key:this.key,legendElement:this.legendElement,messages:this.messages,opacity:this.layer.opacity});case"relationship-ramp":return cW(this.legendElement,this.id,{opacity:this.layer.opacity,effectList:this.effectList,ariaLabel:this.messages.previewRelationshipRampAriaLabel,key:this.key});case"pie-chart-ramp":return L("div",{afterCreate:Dt,bind:this.legendElement.preview,class:be.pieChartRampPreview,key:`${this.key}-preview`});case"univariate-above-and-below-ramp":return L(fh,{effectList:this.effectList,key:this.key,legendElement:this.legendElement,messages:this.messages,opacity:this.layer.opacity});case"univariate-color-size-ramp":return L(mh,{effectList:this.effectList,key:this.key,legendElement:this.legendElement,messages:this.messages,opacity:this.layer.opacity});default:return null}}_renderSymbolTable(t){const e=t.infos.map((n=>this._renderElementInfo(n,t.legendType))).filter(Boolean);if(!e.length)return null;const r=this.activeLayerInfo.legendElements.some((({type:n})=>n==="relationship-ramp")),i=e[0]?.properties?.classes?.[be.symbolRow],s={[be.labelContainer]:!i&&!r,[be.relationshipLabelContainer]:r};return L("div",{class:this.classes(s)},e)}_renderElementInfo(t,e){const{layer:r}=this,i="label"in t?t.label:null,s=`${this.key}-${i}`;if("type"in t&&t.type)return L(ZC,{activeLayerInfo:this.activeLayerInfo,effectList:this.effectList,hasIndicators:this.hasIndicators,headingLevel:this.headingLevel,isChild:!0,key:s,layer:r,legendElement:t,messages:this.messages});if(!("preview"in t&&t.preview||"src"in t&&t.src))return null;const n=PZ(r,e),o=$m(this.messages,i,!1)||"";if("src"in t&&t.src)return L("div",{class:be.layerRow,key:`${s}-row`},this._renderImage(t,r,n),L("div",{class:be.imageLabel},o));if("symbol"in t&&t.preview){if(!t.symbol?.type.includes("simple-fill")){if(!t.label)return L("div",{afterCreate:Dt,bind:t.preview,key:`${s}-row`});const a={[be.symbolCell]:this.hasIndicators};return L("div",{class:this.classes(be.layerRow,{[be.symbolRow]:this.hasIndicators}),key:`${s}-row`},L("div",{afterCreate:Dt,bind:t.preview,class:this.classes(a)}),L("div",{class:this.classes(be.imageLabel,{[be.labelCell]:this.hasIndicators})},o))}return L("div",{class:be.layerRow,key:`${s}-row`},L("div",{class:be.labelElement,styles:this._getBackgroundStyles(t)},o))}return null}_getBackgroundStyles(t){const e=t.symbol,r=e.color,i=!!r?.a,s="outline"in e?e.outline:null,n=!!s?.color?.a,o=new Q(i&&r?[r.r,r.g,r.b,r.a*this.layer.opacity]:[255,255,255,0]),a=n&&s.color?new Q([s.color.r,s.color.g,s.color.b,s.color.a*this.layer.opacity]):new Q([255,255,255,0]),l=t.symbol.color?.isBright??!0,u=l?"black":"white",h=l?"rgba(255, 255, 255, .6)":"rgba(0, 0, 0, .6)";return{background:i?o.toCss(!0):"none",color:u,textShadow:`-1px -1px 0 ${h},
                  1px -1px 0 ${h},
                  -1px 1px 0 ${h},
                  1px 1px 0 ${h}`,border:n?`1px solid ${a.toCss(!0)}`:"none",filter:Wv(this.effectList)??void 0}}_renderImage(t,e,r){const{label:i,src:s,opacity:n}=t,o={[be.imageryLayerStretchedImage]:r,[be.symbol]:!r},a={opacity:`${n??e.opacity}`},l=$m(this.messages,i,!1);return L("img",{alt:l,"aria-label":l,border:0,class:this.classes(o),height:t.height,src:s,styles:a,width:t.width})}};c([d()],Ys.prototype,"activeLayerInfo",void 0),c([d()],Ys.prototype,"effectList",void 0),c([d()],Ys.prototype,"hasIndicators",void 0),c([d()],Ys.prototype,"headingLevel",void 0),c([d()],Ys.prototype,"isChild",void 0),c([d()],Ys.prototype,"layer",void 0),c([d()],Ys.prototype,"legendElement",void 0),c([d()],Ys.prototype,"messages",void 0),Ys=ZC=c([C("esri.widgets.Legend.styles.card.LegendElement")],Ys);const ACe=768;let Ks=class extends Lr{constructor(e,r){super(e,r),this._hasIndicators=!1,this.activeLayerInfos=null,this.headingLevel=3,this.layout="stack",this.messages=null,this.messagesCommon=null,this.type="card",this.view=null}loadDependencies(){return Uv({carousel:()=>J(()=>import("./index-CPI-i8d7.js"),__vite__mapDeps([262,252,253,254,263,255,250,258,260,264,251])),"carousel-item":()=>J(()=>import("./index-Bt0t3P1G.js"),__vite__mapDeps([265,250]))})}render(){this._hasIndicators=this.layout==="auto"&&this.view&&this.view.container.clientWidth<=ACe||this.layout==="stack";const e=this._hasIndicators?this._renderCarousel():this._renderLayers(),r={[be.stacked]:this._hasIndicators};return L("div",{class:this.classes(be.base,r)},e||L("div",{class:be.message},this.messages.noLegend))}_renderCarousel(){const e=[],r=this.activeLayerInfos;if(r)for(const i of r)this._renderSections(i,e);return e?.length?L("calcite-carousel",{class:be.carousel,label:this.messages.carousel},e.map(((i,s)=>L("calcite-carousel-item",{class:be.carouselItem,key:s,label:Sw(this.messagesCommon.pagination.pageText,{index:s+1,total:e.length})},i)))):null}_renderLayers(){const e=this.activeLayerInfos,r=e?.toArray()?.map((i=>this._renderLegendForLayer(i))).filter(Boolean);return r?.length?r:null}_renderLegendForLayer(e){if(!e.ready)return null;if(e.children.length){const r=e.children.toArray().map(this._renderLegendForLayer,this);return L("section",{class:this.classes(be.service,be.groupLayer),key:e.layer.uid},L("div",{class:be.serviceCaptionContainer},e.title),r)}return this._renderLegendElementsForLayer(e)}_renderLegendElementsForLayer(e){const r=e.legendElements?.filter(Boolean);if(!r?.length)return null;const i=r.map((n=>L(Ys,{activeLayerInfo:e,effectList:e.effectList,hasIndicators:this._hasIndicators,headingLevel:this.headingLevel,isChild:!1,key:`${e.layer.uid}-${n.type}`,layer:e.layer,legendElement:n,messages:this.messages}))),s={[be.groupLayerChild]:!!e.parent};return L("section",{class:this.classes(be.service,s),key:e.layer.uid},L("div",{class:be.serviceCaptionContainer},L("div",{class:be.serviceCaptionText},e.title)),L("div",{class:be.serviceContent},i))}_renderSections(e,r){if(!e.ready)return;if(e.children.length)for(const s of e.children)this._renderSections(s,r);const i=e.legendElements;if(i?.length)for(const s of i){const n=L(Ys,{activeLayerInfo:e,effectList:e.effectList,hasIndicators:this._hasIndicators,headingLevel:this.headingLevel,isChild:!1,key:`${e.layer.uid}-${s.type}`,layer:e.layer,legendElement:s,messages:this.messages});n&&r.push(n)}}};c([d()],Ks.prototype,"activeLayerInfos",void 0),c([d()],Ks.prototype,"headingLevel",void 0),c([d()],Ks.prototype,"layout",void 0),c([d(),Ea("esri/widgets/Legend/t9n/Legend")],Ks.prototype,"messages",void 0),c([d(),Ea("esri/t9n/common")],Ks.prototype,"messagesCommon",void 0),c([d({readOnly:!0})],Ks.prototype,"type",void 0),c([d()],Ks.prototype,"view",void 0),Ks=c([C("esri.widgets.Legend.styles.card.CardView")],Ks);const vt="esri-legend",Se={service:`${vt}__service`,label:`${vt}__service-label`,layer:`${vt}__layer`,groupLayer:`${vt}__group-layer`,groupLayerChild:`${vt}__group-layer-child`,layerTable:`${vt}__layer-table`,layerTableSizeRamp:`${vt}__layer-table--size-ramp`,layerChildTable:`${vt}__layer-child-table`,layerCaption:`${vt}__layer-caption`,layerBody:`${vt}__layer-body`,layerRow:`${vt}__layer-row`,layerInfo:`${vt}__layer-cell ${vt}__layer-cell--info`,imageryLayerStretchedImage:`${vt}__imagery-layer-image--stretched`,imageryLayerInfoStretched:`${vt}__imagery-layer-info--stretched`,symbolContainer:`${vt}__layer-cell ${vt}__layer-cell--symbols`,symbol:`${vt}__symbol`,rampContainer:`${vt}__ramps`,sizeRamp:`${vt}__size-ramp`,colorRamp:`${vt}__color-ramp`,opacityRamp:`${vt}__opacity-ramp`,rampLabelsContainer:`${vt}__ramp-labels`,rampLabel:`${vt}__ramp-label`,message:`${vt}__message`,univariateAboveAndBelowLabel:"esri-univariate-above-and-below-ramp__label"},LCe=24;let yh=class extends Lr{constructor(e,r){super(e,r),this.legendElement=null,this.opacity=1}get _preview(){const e=this.legendElement.preview;if(!e)return null;const r=this.legendElement.type==="opacity-ramp"?Se.opacityRamp:"";return e.className=`${Se.colorRamp} ${r}`,this.opacity!=null&&(e.style.opacity=this.opacity.toString()),e}render(){const{legendElement:e,_preview:r}=this;if(!r)return null;const i={width:`${LCe}px`},s={height:r.style.height};return L("div",{class:Se.layerRow,key:`${this.key}-row`},L("div",{class:Se.symbolContainer,styles:i},L("div",{afterCreate:Dt,bind:r,class:Se.rampContainer})),L("div",{class:Se.layerInfo},L("div",{class:Se.rampLabelsContainer,styles:s},e.infos.map(((n,o)=>this._renderRampLabel(n,o,e.type))))))}_renderRampLabel(e,r,i){return L("div",{class:e.label?Se.rampLabel:void 0,key:`${this.key}-stop-${e.label??r}-label`},AZ(e,i,this.messages))}};c([d()],yh.prototype,"_preview",null),c([d()],yh.prototype,"legendElement",void 0),c([d()],yh.prototype,"messages",void 0),c([d()],yh.prototype,"opacity",void 0),yh=c([C("esri.widgets.Legend.styles.classic.ColorRamp")],yh);let kg=class extends Lr{constructor(e,r){super(e,r),this.legendElement=null}render(){const e=this.legendElement.infos.map((r=>this._renderRow(r))).filter(Boolean);return e.length?this.legendElement.theme==="spike"?kZ(this.legendElement):L("div",{class:Se.layerBody},e):null}_renderRow(e){return e.preview?L("div",{class:Se.layerRow,key:`${this.key}-${e.label}-row`},L("div",{class:this.classes(Se.symbolContainer,Se.sizeRamp)},L("div",{afterCreate:Dt,bind:e.preview,class:Se.symbol})),L("div",{class:Se.layerInfo},$m(this.messages,e.label,!1)||"")):null}};c([d()],kg.prototype,"legendElement",void 0),c([d()],kg.prototype,"messages",void 0),kg=c([C("esri.widgets.Legend.styles.classic.SizeRamp")],kg);let gh=class extends Lr{constructor(e,r){super(e,r),this.effectList=null,this.legendElement=null,this.opacity=1}render(){const{legendElement:e,opacity:r,effectList:i,key:s}=this,{sizeRampElement:n,colorRampElement:o}=FZ(e,r);if(!n)return null;const a=this.messages.previewColorRampAriaLabel,l=Tm(n,"above",!0),u=Tm(n,"below",!0),h=12,p=Mm(o,{width:h,height:l,rampAlignment:"vertical",opacity:r,type:"above",effectList:i,ariaLabel:a}),m=Mm(o,{width:h,height:u,rampAlignment:"vertical",opacity:r,type:"below",effectList:i,ariaLabel:a}),y=rx(n),g=n.infos.map((R=>R.label)),v=g.map(((R,D)=>D===0?L("div",{class:R?p?Se.univariateAboveAndBelowLabel:Se.rampLabel:void 0,key:`${s}-color-ramp-above-label-${R??D}`},R):D===2?L("div",null):null)),_=g.length-1,b=Math.floor(g.length/2),S=g.map(((R,D)=>D===b||D===_?L("div",{class:R?p?Se.univariateAboveAndBelowLabel:Se.rampLabel:void 0,key:`${s}-color-ramp-below-label-${R??D}`},R):null)),$={display:"table-cell",verticalAlign:"middle"},T={marginTop:`${y}px`},I={height:`${l}px`},P={height:`${u}px`};return L("div",{key:`${s}-container`,styles:zZ},L("div",{class:Se.layerBody},n.infos.map(((R,D)=>L("div",{class:this.classes(Se.layerRow,Se.sizeRamp),key:`${s}-row-${D}`},L("div",{afterCreate:Dt,bind:R.preview,class:Se.symbol,styles:$}),p||D%2!=0?null:L("div",{class:Se.layerInfo},g[D]))))),p?L("div",{styles:T},L("div",{styles:WC},L("div",{styles:cf},L("div",{afterCreate:Dt,bind:p,class:Se.rampContainer})),L("div",{styles:cf},L("div",{class:Se.rampLabelsContainer,styles:I},v))),L("div",{styles:WC},L("div",{styles:cf},L("div",{afterCreate:Dt,bind:m,class:Se.rampContainer})),L("div",{styles:cf},L("div",{class:Se.rampLabelsContainer,styles:P},S)))):null)}};c([d()],gh.prototype,"effectList",void 0),c([d()],gh.prototype,"legendElement",void 0),c([d()],gh.prototype,"messages",void 0),c([d()],gh.prototype,"opacity",void 0),gh=c([C("esri.widgets.Legend.styles.classic.UnivariateAboveAndBelowRamp")],gh);let vh=class extends Lr{constructor(e,r){super(e,r),this.effectList=null,this.legendElement=null,this.opacity=1}render(){const{legendElement:e,opacity:r,effectList:i,key:s}=this,{sizeRampElement:n,colorRampElement:o}=DZ(e);if(!n)return null;const a=rx(n),l=12,u=Tm(n,"full",!1),h=Mm(o,{width:l,height:u,rampAlignment:"vertical",opacity:r,type:"full",effectList:i,ariaLabel:this.messages?.previewColorRampAriaLabel}),p=n.infos.length-1,m=n.infos.map(((_,b)=>b===0||b===p?L("div",{class:_.label?o?Se.univariateAboveAndBelowLabel:Se.rampLabel:void 0,key:`${s}-color-ramp-label-${_.label??b}`},_.label):null)),y={display:"table-cell",verticalAlign:"middle"},g={marginTop:`${a}px`},v={height:`${u}px`};return L("div",{key:`${s}-container`,styles:zZ},L("div",{class:Se.layerBody},n.infos.map(((_,b)=>L("div",{class:this.classes(Se.layerRow,Se.sizeRamp),key:`${s}-row-${b}`},L("div",{afterCreate:Dt,bind:_.preview,class:Se.symbol,styles:y}))))),L("div",{styles:g},L("div",{styles:WC},L("div",{styles:cf},L("div",{afterCreate:Dt,bind:h,class:Se.rampContainer})),L("div",{styles:cf},L("div",{class:Se.rampLabelsContainer,styles:v},m)))))}};c([d()],vh.prototype,"effectList",void 0),c([d()],vh.prototype,"legendElement",void 0),c([d()],vh.prototype,"messages",void 0),c([d()],vh.prototype,"opacity",void 0),vh=c([C("esri.widgets.Legend.styles.classic.UnivariateColorSizeRamp")],vh);var JC;let $u=JC=class extends Lr{constructor(t,e){super(t,e),this.effectList=null,this.isChild=!1,this.legendElement=null}render(){const t=this._renderLegendElement(),e=LZ(this.legendElement,this.messages),r=this.isChild?Se.layerChildTable:Se.layerTable,i=e?L("div",{class:Se.layerCaption},e):null,s={[Se.layerTableSizeRamp]:this.legendElement.type==="size-ramp"||!this.isChild};return L("section",{class:this.classes(r,s),key:`${this.key}-table`},i,t)}_renderLegendElement(){switch(this.legendElement.type){case"symbol-table":return this._renderSymbolTable(this.legendElement);case"size-ramp":return L(kg,{key:this.key,legendElement:this.legendElement,messages:this.messages});case"color-ramp":case"opacity-ramp":case"heatmap-ramp":case"stretch-ramp":return L(yh,{key:this.key,legendElement:this.legendElement,messages:this.messages,opacity:this.layer.opacity});case"relationship-ramp":return cW(this.legendElement,this.id,{opacity:this.layer.opacity,effectList:this.effectList,ariaLabel:this.messages.previewRelationshipRampAriaLabel,key:this.key});case"pie-chart-ramp":return L("div",{afterCreate:Dt,bind:this.legendElement.preview,key:`${this.key}-preview`});case"univariate-above-and-below-ramp":return L(gh,{effectList:this.effectList,key:this.key,legendElement:this.legendElement,messages:this.messages,opacity:this.layer.opacity});case"univariate-color-size-ramp":return L(vh,{effectList:this.effectList,key:this.key,legendElement:this.legendElement,messages:this.messages,opacity:this.layer.opacity});default:return null}}_renderSymbolTable(t){const e=t.infos.map((r=>this._renderElementInfo(r,t.legendType))).filter(Boolean);return e.length?L("div",{class:Se.layerBody},e):null}_renderElementInfo(t,e){const{layer:r}=this,i="label"in t?t.label:null,s=`${this.key}-${i}`;if("type"in t&&t.type)return L(JC,{effectList:this.effectList,isChild:!0,key:s,layer:r,legendElement:t,messages:this.messages});if(!("preview"in t&&t.preview||"src"in t&&t.src))return null;const n=PZ(r,e),o={[Se.imageryLayerInfoStretched]:n},a={[Se.imageryLayerInfoStretched]:n};return L("div",{class:Se.layerRow,key:`${s}-row`},L("div",{class:this.classes(Se.symbolContainer,a)},this._renderPreview(t,n)),L("div",{class:this.classes(Se.layerInfo,o)},$m(this.messages,i,!1)||""))}_renderPreview(t,e){const{layer:r}=this;return"preview"in t&&t.preview?L("div",{afterCreate:Dt,bind:t.preview,class:Se.symbol}):"src"in t&&t.src?this._renderImage(t,r,e):null}_renderImage(t,e,r){const{label:i,src:s,opacity:n}=t,o={[Se.imageryLayerStretchedImage]:r,[Se.symbol]:!r},a={opacity:`${n??e.opacity}`},l=$m(this.messages,i,!1);return L("img",{alt:l,"aria-label":l,border:0,class:this.classes(o),height:t.height,src:s,styles:a,width:t.width})}};c([d()],$u.prototype,"effectList",void 0),c([d()],$u.prototype,"isChild",void 0),c([d()],$u.prototype,"layer",void 0),c([d()],$u.prototype,"legendElement",void 0),c([d()],$u.prototype,"messages",void 0),$u=JC=c([C("esri.widgets.Legend.styles.classic.LegendElement")],$u);const RCe=`${vt}__`;let sn=class extends Lr{constructor(e,r){super(e,r),this.activeLayerInfos=null,this.headingLevel=3,this.messages=null,this.type="classic"}render(){const e=this.activeLayerInfos,r=e?.toArray().map((i=>this._renderLegendForLayer(i))).filter(Boolean);return r?.length?L("section",null,r):L("div",{class:Se.message,key:"no-legend"},this.messages.noLegend)}_renderLegendForLayer(e,r){if(!e.ready)return null;const i=`${e.layer.uid}-version-${e.version}`,s=`${RCe}${r?`${r}-`:""}${i}`,n=e.title?Ob({level:this.headingLevel,class:this.classes(Hr.heading,Se.label)},e.title):null;if(e.children.length){const o=e.children.toArray().map((a=>this._renderLegendForLayer(a,i)));return L("section",{class:this.classes(Se.service,Se.groupLayer),key:s},n,o)}return this._renderLegendElementsForLayer(e,n,s)}_renderLegendElementsForLayer(e,r,i){const s=e.legendElements?.filter(Boolean);if(!s?.length)return null;const n=s.map((a=>L($u,{effectList:e.effectList,isChild:!1,key:`${i}-${a.type}`,layer:e.layer,legendElement:a,messages:this.messages}))),o={[Se.groupLayerChild]:!!e.parent};return L("section",{class:this.classes(Se.service,o),key:i},r,L("div",{class:Se.layer},n))}};c([d()],sn.prototype,"activeLayerInfos",void 0),c([d()],sn.prototype,"headingLevel",void 0),c([d(),Ea("esri/widgets/Legend/t9n/Legend")],sn.prototype,"messages",void 0),c([d({readOnly:!0})],sn.prototype,"type",void 0),sn=c([C("esri.widgets.Legend.styles.classic.ClassicView")],sn);const kCe={base:"esri-legend"};let xr=class extends Lr{constructor(e,r){super(e,r),this.headingLevel=3,this.messages=null,this.viewModel=new $s,this.style=new sn}initialize(){this.addHandles([so((()=>this.view),"resize",(()=>this.scheduleRender())),so((()=>this.activeLayerInfos),"change",(()=>this._refreshActiveLayerInfos(this.activeLayerInfos))),ie((()=>this.headingLevel),(e=>{const{style:r}=this;r&&(r.headingLevel=e)})),ie((()=>this.style),((e,r)=>{r&&e!==r&&r.destroy(),e&&(e.activeLayerInfos=this.activeLayerInfos,e.type==="card"&&(e.view=this.view),e.headingLevel=this.headingLevel)}),Ft)])}destroy(){this.style?.destroy()}get activeLayerInfos(){return this.viewModel.activeLayerInfos}set activeLayerInfos(e){this.viewModel.activeLayerInfos=e}get basemapLegendVisible(){return this.viewModel.basemapLegendVisible}set basemapLegendVisible(e){this.viewModel.basemapLegendVisible=e}get groundLegendVisible(){return this.viewModel.groundLegendVisible}set groundLegendVisible(e){this.viewModel.groundLegendVisible=e}get hideLayersNotInCurrentView(){return this.viewModel.hideLayersNotInCurrentView}set hideLayersNotInCurrentView(e){this.viewModel.hideLayersNotInCurrentView=e}get keepCacheOnDestroy(){return this.viewModel.keepCacheOnDestroy}set keepCacheOnDestroy(e){this.viewModel.keepCacheOnDestroy=e}get respectLayerDefinitionExpression(){return this.viewModel.respectLayerDefinitionExpression}set respectLayerDefinitionExpression(e){this.viewModel.respectLayerDefinitionExpression=e}get respectLayerVisibility(){return this.viewModel.respectLayerVisibility}set respectLayerVisibility(e){this.viewModel.respectLayerVisibility=e}get icon(){return"legend"}set icon(e){this._overrideIfSome("icon",e)}get label(){return this.messages?.widgetLabel??""}set label(e){this._overrideIfSome("label",e)}get layerInfos(){return this.viewModel.layerInfos}set layerInfos(e){this.viewModel.layerInfos=e}set style(e){const r=this._get("style");e!==r&&r?.destroy(),this._set("style",e)}castStyle(e){if(e instanceof Ks||e instanceof sn)return e;if(typeof e=="string")return e==="card"?new Ks:new sn;if(e&&typeof e.type=="string"){const r={...e};return delete r.type,e.type==="card"?new Ks(r):new sn(r)}return new sn}get view(){return this.viewModel.view}set view(e){this.viewModel.view=e}render(){return L("div",{class:this.classes(kCe.base,Hr.widget,this.style instanceof sn?Hr.panel:null)},this.style.render())}_refreshActiveLayerInfos(e){e.forEach((r=>{this.removeHandles(`version_${r.layer.uid}`),this._renderOnActiveLayerInfoChange(r)})),this.scheduleRender()}_renderOnActiveLayerInfoChange(e){const r=ie((()=>e.version),(()=>this.scheduleRender()));this.addHandles(r,`version_${e.layer.uid}`);const i=so((()=>e.children),"change",(()=>e.children.forEach((s=>this._renderOnActiveLayerInfoChange(s)))),Ft);this.addHandles(i,`version_${e.layer.uid}`),e.children.forEach((s=>this._renderOnActiveLayerInfoChange(s)))}};c([d()],xr.prototype,"activeLayerInfos",null),c([d()],xr.prototype,"basemapLegendVisible",null),c([d()],xr.prototype,"groundLegendVisible",null),c([d()],xr.prototype,"headingLevel",void 0),c([d()],xr.prototype,"hideLayersNotInCurrentView",null),c([d()],xr.prototype,"keepCacheOnDestroy",null),c([d()],xr.prototype,"respectLayerDefinitionExpression",null),c([d()],xr.prototype,"respectLayerVisibility",null),c([d()],xr.prototype,"icon",null),c([d()],xr.prototype,"label",null),c([d()],xr.prototype,"layerInfos",null),c([d(),Ea("esri/widgets/Legend/t9n/Legend")],xr.prototype,"messages",void 0),c([d()],xr.prototype,"style",null),c([We("style")],xr.prototype,"castStyle",null),c([d()],xr.prototype,"view",null),c([d()],xr.prototype,"viewModel",void 0),xr=c([C("esri.widgets.Legend")],xr);const OCe=xr;let NCe=class jZ{constructor(){this._propertyOriginMap=new Map,this._originStores=new Array($M),this._values=new Map,this.multipleOriginsSupported=!0}clone(e){const r=new jZ,i=this._originStores[xe.DEFAULTS];i&&i.forEach(((s,n)=>{r.set(n,k(s),xe.DEFAULTS)}));for(let s=xe.SERVICE;s<$M;s++){const n=this._originStores[s];n&&n.forEach(((o,a)=>{e&&e.has(a)||r.set(a,k(o),s)}))}return r}get(e,r){const i=r===void 0?this._values:this._originStores[r];return i?i.get(e):void 0}keys(e){const r=e==null?this._values:this._originStores[e];return r?[...r.keys()]:[]}set(e,r,i=xe.USER){let s=this._originStores[i];if(s||(s=new Map,this._originStores[i]=s),s.set(e,r),!this._values.has(e)||this._propertyOriginMap.get(e)<=i){const n=this._values.get(e);return this._values.set(e,r),this._propertyOriginMap.set(e,i),n!==r}return!1}delete(e,r=xe.USER){const i=this._originStores[r];if(!i)return;const s=i.get(e);if(i.delete(e),this._values.has(e)&&this._propertyOriginMap.get(e)===r){this._values.delete(e);for(let n=r-1;n>=0;n--){const o=this._originStores[n];if(o&&o.has(e)){this._values.set(e,o.get(e)),this._propertyOriginMap.set(e,n);break}}}return s}has(e,r){const i=r===void 0?this._values:this._originStores[r];return!!i&&i.has(e)}revert(e,r){for(;r>0&&!this.has(e,r);)--r;const i=this._originStores[r],s=i?.get(e),n=this._values.get(e);return this._values.set(e,s),this._propertyOriginMap.set(e,r),n!==s}originOf(e){return this._propertyOriginMap.get(e)||xe.DEFAULTS}isAtOrigin(e,r){return this.has(e,r)&&this.originOf(e)===r}isBelowOrigin(e,r){return!this.has(e)||this.originOf(e)<r}forEach(e){this._values.forEach(e)}};const UZ=t=>{let e=class extends t{constructor(...r){super(...r);const i=qi(this),s=i.store,n=new NCe;i.store=n,NV(i,s,n)}read(r,i){DV(this,r,i)}getAtOrigin(r,i){const s=J$(this),n=Ml(i);if(typeof r=="string")return s.get(r,n);const o={};return r.forEach((a=>{o[a]=s.get(a,n)})),o}originOf(r){return I0(this.originIdOf(r))}originIdOf(r){return J$(this).originOf(r)}revert(r,i){const s=J$(this),n=Ml(i),o=qi(this);let a;a=typeof r=="string"?r==="*"?s.keys(n):[r]:r,a.forEach((l=>{o.invalidate(l),s.revert(l,n),o.commit(l)}))}};return e=c([C("esri.core.ReadOnlyMultiOriginJSONSupport")],e),e};function J$(t){return qi(t).store}let i6=class extends UZ(ce){};i6=c([C("esri.core.ReadOnlyMultiOriginJSONSupport")],i6);const FCe=t=>{let e=class extends t{constructor(...r){super(...r)}clear(r,i="user"){qi(this).clearOrigin(r,Ml(i))}write(r,i){return VV(this,r=r||{},i),r}setAtOrigin(r,i,s){qi(this).setAtOrigin(r,i,Ml(s))}removeOrigin(r){const i=s6(this),s=Ml(r),n=i.keys(s);for(const o of n)i.originOf(o)===s&&i.set(o,i.get(o,s),xe.USER)}updateOrigin(r,i){const s=s6(this),n=Ml(i),o=un(this,r);for(let a=n+1;a<$M;++a)s.delete(r,a);s.set(r,o,n)}toJSON(r){return this.write({},r)}};return e=c([C("esri.core.MultiOriginJSONSupport.WriteableMultiOriginJSONSupport")],e),e.prototype.toJSON.isDefaultToJSON=!0,e};function s6(t){return qi(t).store}const GZ=t=>{let e=class extends FCe(UZ(t)){constructor(...r){super(...r)}};return e=c([C("esri.core.MultiOriginJSONSupport")],e),e};let n6=class extends GZ(ce){};n6=c([C("esri.core.MultiOriginJSONSupport")],n6);const ft=(t=>t)(["operational-layers","basemap","ground"]);var YC;let _h=YC=class extends W{constructor(t){super(t),this.expression=null,this.name=null,this.returnType="boolean",this.title=null}clone(){return new YC({name:this.name,title:this.title,expression:this.expression,returnType:this.returnType})}};c([d({type:String,json:{write:!0}})],_h.prototype,"expression",void 0),c([d({type:String,json:{write:!0}})],_h.prototype,"name",void 0),c([d({type:["boolean","date","number","string"],json:{write:!0}})],_h.prototype,"returnType",void 0),c([d({type:String,json:{write:!0}})],_h.prototype,"title",void 0),_h=YC=c([C("esri.form.ExpressionInfo")],_h);const DCe=_h;let bh=class extends W{constructor(e){super(e),this.description=null,this.label=null,this.type=null,this.visibilityExpression=null}};c([d({type:String,json:{write:!0}})],bh.prototype,"description",void 0),c([d({type:String,json:{write:!0}})],bh.prototype,"label",void 0),c([d()],bh.prototype,"type",void 0),c([d({type:String,json:{write:!0}})],bh.prototype,"visibilityExpression",void 0),bh=c([C("esri.form.elements.Element")],bh);const mc=bh;let Nb=class extends Ce.ClonableMixin(W){constructor(e){super(e),this.type=null}};c([d()],Nb.prototype,"type",void 0),Nb=c([C("esri.form.elements.inputs.attachments.Input")],Nb);const yc=Nb,ix=["any","capture","upload"];let Ap=class extends yc{constructor(e){super(e),this.type="audio",this.inputMethod="any",this.maxDuration=null}};c([d({type:["audio"],readOnly:!0,json:{write:!0}})],Ap.prototype,"type",void 0),c([d({type:ix,json:{write:!0}})],Ap.prototype,"inputMethod",void 0),c([d({type:Number,json:{write:!0}})],Ap.prototype,"maxDuration",void 0),Ap=c([C("esri.form.elements.inputs.attachments.AudioInput")],Ap);const o6=Ap;let Og=class extends yc{constructor(e){super(e),this.type="document",this.maxFileSize=null}};c([d({type:["document"],readOnly:!0,json:{write:!0}})],Og.prototype,"type",void 0),c([d({type:Number,json:{write:!0}})],Og.prototype,"maxFileSize",void 0),Og=c([C("esri.form.elements.inputs.attachments.DocumentInput")],Og);const a6=Og;let Lp=class extends yc{constructor(e){super(e),this.type="image",this.inputMethod="any",this.maxImageSize=null}};c([d({type:["image"],readOnly:!0,json:{write:!0}})],Lp.prototype,"type",void 0),c([d({type:ix,json:{write:!0}})],Lp.prototype,"inputMethod",void 0),c([d({type:Number,json:{write:!0}})],Lp.prototype,"maxImageSize",void 0),Lp=c([C("esri.form.elements.inputs.attachments.ImageInput")],Lp);const l6=Lp;let Ng=class extends yc{constructor(e){super(e),this.type="signature",this.inputMethod="any"}};c([d({type:["signature"],readOnly:!0,json:{write:!0}})],Ng.prototype,"type",void 0),c([d({type:ix,json:{write:!0}})],Ng.prototype,"inputMethod",void 0),Ng=c([C("esri.form.elements.inputs.attachments.SignatureInput")],Ng);const u6=Ng;let Rp=class extends yc{constructor(e){super(e),this.type="video",this.inputMethod="any",this.maxDuration=null}};c([d({type:["video"],readOnly:!0,json:{write:!0}})],Rp.prototype,"type",void 0),c([d({type:ix,json:{write:!0}})],Rp.prototype,"inputMethod",void 0),c([d({type:Number,json:{write:!0}})],Rp.prototype,"maxDuration",void 0),Rp=c([C("esri.form.elements.inputs.attachments.VideoInput")],Rp);const c6=Rp;function BZ(t){return{nestableTypes:{base:yc,key:"type",typeMap:{audio:o6,document:a6,image:l6,signature:u6,video:c6}},allTypes:{base:yc,key:"type",typeMap:{attachment:t,audio:o6,document:a6,image:l6,signature:u6,video:c6}}}}function zCe(t,e,r){return t?t.map((i=>xa(e.nestableTypes,i))):null}function VCe(t,e,r){if(!t)return null;const i=e.nestableTypes.typeMap;return t.filter((s=>i[s.type])).map((s=>i[s.type].fromJSON(s)))}function jCe(t,e,r){if(!t)return null;const i=e.nestableTypes.typeMap;return t.filter((s=>i[s.type])).map((s=>s.toJSON()))}let Po=class extends yc{constructor(e){super(e),this.type="attachment",this.attachmentAssociationType="exact",this.inputTypes=null}castInputs(e){return zCe(e,Y$)}readInputs(e,r){return VCe(r.inputTypes,Y$)}writeInputs(e,r){r.inputTypes=jCe(e,Y$)}};c([d({type:["attachment"],readOnly:!0,json:{write:!0}})],Po.prototype,"type",void 0),c([d({type:["any","exact","exactOrNone"],json:{write:!0}})],Po.prototype,"attachmentAssociationType",void 0),c([d({json:{write:{isRequired:!0}}})],Po.prototype,"inputTypes",void 0),c([We("inputTypes")],Po.prototype,"castInputs",null),c([K("inputTypes")],Po.prototype,"readInputs",null),c([re("inputTypes")],Po.prototype,"writeInputs",null),Po=c([C("esri.form.elements.inputs.attachments.AttachmentInput")],Po);const Y$=BZ(Po),UCe=Po;var XC;const GCe=BZ(UCe);let Ms=XC=class extends mc{constructor(t){super(t),this.allowUserRename=!0,this.attachmentKeyword=null,this.displayFilename=!1,this.editableExpression=null,this.filenameExpression="{attachmentKeyword}_{now}",this.input=null,this.maxAttachmentCount=null,this.minAttachmentCount=null,this.type="attachment",this.useOriginalFilename=!0}clone(){return new XC({allowUserRename:this.allowUserRename,attachmentKeyword:this.attachmentKeyword,description:this.description,displayFilename:this.displayFilename,editableExpression:this.editableExpression,filenameExpression:this.filenameExpression,input:this.input?.clone(),label:this.label,maxAttachmentCount:this.maxAttachmentCount,minAttachmentCount:this.minAttachmentCount,useOriginalFilename:this.useOriginalFilename,visibilityExpression:this.visibilityExpression})}};c([d({type:Boolean,json:{write:!0}})],Ms.prototype,"allowUserRename",void 0),c([d({type:String,json:{write:{isRequired:!0}}})],Ms.prototype,"attachmentKeyword",void 0),c([d({type:Boolean,json:{write:!0}})],Ms.prototype,"displayFilename",void 0),c([d({type:String,json:{write:!0}})],Ms.prototype,"editableExpression",void 0),c([d({type:String,json:{write:!0}})],Ms.prototype,"filenameExpression",void 0),c([d({types:GCe.allTypes,json:{read:{source:"inputType"},write:{target:"inputType",isRequired:!0}}})],Ms.prototype,"input",void 0),c([d({type:Number,json:{write:!0}})],Ms.prototype,"maxAttachmentCount",void 0),c([d({type:Number,json:{write:!0}})],Ms.prototype,"minAttachmentCount",void 0),c([d({type:["attachment"],readOnly:!0,json:{read:!1,write:!0}})],Ms.prototype,"type",void 0),c([d({type:Boolean,json:{write:!0}})],Ms.prototype,"useOriginalFilename",void 0),Ms=XC=c([C("esri.form.elements.AttachmentElement")],Ms);const h6=Ms;let Fb=class extends W{constructor(e){super(e),this.type=null}};c([d()],Fb.prototype,"type",void 0),Fb=c([C("esri.form.elements.inputs.Input")],Fb);const Wl=Fb;let Fg=class extends Wl{constructor(e){super(e),this.maxLength=null,this.minLength=0}};c([d({type:Number,json:{write:!0}})],Fg.prototype,"maxLength",void 0),c([d({type:Number,json:{write:!0}})],Fg.prototype,"minLength",void 0),Fg=c([C("esri.form.elements.inputs.TextInput")],Fg);const LL=Fg;var KC;let Db=KC=class extends LL{constructor(t){super(t),this.type="barcode-scanner"}clone(){return new KC({maxLength:this.maxLength,minLength:this.minLength})}};c([d({type:["barcode-scanner"],json:{read:!1,write:!0}})],Db.prototype,"type",void 0),Db=KC=c([C("esri.form.elements.inputs.BarcodeScannerInput")],Db);const BCe=Db;var QC;let kp=QC=class extends Wl{constructor(t){super(t),this.noValueOptionLabel=null,this.showNoValueOption=!0,this.type="combo-box"}clone(){return new QC({showNoValueOption:this.showNoValueOption,noValueOptionLabel:this.noValueOptionLabel})}};c([d({type:String,json:{write:!0}})],kp.prototype,"noValueOptionLabel",void 0),c([d({type:Boolean,json:{write:!0}})],kp.prototype,"showNoValueOption",void 0),c([d({type:["combo-box"],json:{read:!1,write:!0}})],kp.prototype,"type",void 0),kp=QC=c([C("esri.form.elements.inputs.ComboBoxInput")],kp);const qCe=kp;var eP;function d6(t){return t??null}function p6(t){return t??null}let To=eP=class extends Wl{constructor(t){super(t),this.max=null,this.min=null,this.type="date-picker"}readMax(t,e){return d6(e.max)}writeMax(t,e){e.max=p6(t)}readMin(t,e){return d6(e.min)}writeMin(t,e){e.min=p6(t)}clone(){return new eP({max:this.max,min:this.min})}};c([d({type:String,json:{type:String,write:!0}})],To.prototype,"max",void 0),c([K("max")],To.prototype,"readMax",null),c([re("max")],To.prototype,"writeMax",null),c([d({type:String,json:{type:String,write:!0}})],To.prototype,"min",void 0),c([K("min")],To.prototype,"readMin",null),c([re("min")],To.prototype,"writeMin",null),c([d({type:["date-picker"],json:{read:!1,write:!0}})],To.prototype,"type",void 0),To=eP=c([C("esri.form.elements.inputs.DatePickerInput")],To);const HCe=To;var tP;function X$(t){return t??null}function K$(t){return t??null}let Ki=tP=class extends Wl{constructor(t){super(t),this.includeTimeOffset=!0,this.max=null,this.min=null,this.timeResolution="minutes",this.type="datetimeoffset-picker"}readMax(t,e){return X$(e.max)}writeMax(t,e){e.max=K$(t)}readMin(t,e){return X$(e.min)}writeMin(t,e){e.min=K$(t)}readTimeResolution(t,e){return X$(e.timeResolution)}writeTimeResolution(t,e){e.timeResolution=K$(t)}clone(){return new tP({includeTimeOffset:this.includeTimeOffset,max:this.max,min:this.min,timeResolution:this.timeResolution})}};c([d({type:Boolean,json:{write:!0}})],Ki.prototype,"includeTimeOffset",void 0),c([d({type:String,json:{type:String,write:!0}})],Ki.prototype,"max",void 0),c([K("max")],Ki.prototype,"readMax",null),c([re("max")],Ki.prototype,"writeMax",null),c([d({type:String,json:{type:String,write:!0}})],Ki.prototype,"min",void 0),c([K("min")],Ki.prototype,"readMin",null),c([re("min")],Ki.prototype,"writeMin",null),c([d({type:String,json:{type:String,write:!0}})],Ki.prototype,"timeResolution",void 0),c([K("timeResolution")],Ki.prototype,"readTimeResolution",null),c([re("timeResolution")],Ki.prototype,"writeTimeResolution",null),c([d({type:["datetimeoffset-picker"],json:{read:!1,write:!0}})],Ki.prototype,"type",void 0),Ki=tP=c([C("esri.form.elements.inputs.DateTimeOffsetPickerInput")],Ki);const WCe=Ki;var rP;function f6(t){return t!=null?new Date(t):null}function m6(t){return t?t.getTime():null}let zn=rP=class extends Wl{constructor(t){super(t),this.includeTime=!1,this.max=null,this.min=null,this.type="datetime-picker"}readMax(t,e){return f6(e.max)}writeMax(t,e){e.max=m6(t)}readMin(t,e){return f6(e.min)}writeMin(t,e){e.min=m6(t)}clone(){return new rP({includeTime:this.includeTime,max:this.max,min:this.min})}};c([d({type:Boolean,json:{write:!0}})],zn.prototype,"includeTime",void 0),c([d({type:Date,json:{type:Number,write:!0}})],zn.prototype,"max",void 0),c([K("max")],zn.prototype,"readMax",null),c([re("max")],zn.prototype,"writeMax",null),c([d({type:Date,json:{type:Number,write:!0}})],zn.prototype,"min",void 0),c([K("min")],zn.prototype,"readMin",null),c([re("min")],zn.prototype,"writeMin",null),c([d({type:["datetime-picker"],json:{read:!1,write:!0}})],zn.prototype,"type",void 0),zn=rP=c([C("esri.form.elements.inputs.DateTimePickerInput")],zn);const ZCe=zn;var iP;let Op=iP=class extends Wl{constructor(t){super(t),this.noValueOptionLabel=null,this.showNoValueOption=!0,this.type="radio-buttons"}clone(){return new iP({noValueOptionLabel:this.noValueOptionLabel,showNoValueOption:this.showNoValueOption})}};c([d({type:String,json:{write:!0}})],Op.prototype,"noValueOptionLabel",void 0),c([d({type:Boolean,json:{write:!0}})],Op.prototype,"showNoValueOption",void 0),c([d({type:["radio-buttons"],json:{read:!1,write:!0}})],Op.prototype,"type",void 0),Op=iP=c([C("esri.form.elements.inputs.RadioButtonsInput")],Op);const JCe=Op;var sP;let Np=sP=class extends Wl{constructor(t){super(t),this.offValue=null,this.onValue=null,this.type="switch"}clone(){return new sP({offValue:this.offValue,onValue:this.onValue})}};c([d({type:[String,Number],json:{write:!0}})],Np.prototype,"offValue",void 0),c([d({type:[String,Number],json:{write:!0}})],Np.prototype,"onValue",void 0),c([d({type:["switch"],json:{read:!1,write:!0}})],Np.prototype,"type",void 0),Np=sP=c([C("esri.form.elements.inputs.SwitchInput")],Np);const YCe=Np;var nP;let zb=nP=class extends LL{constructor(t){super(t),this.type="text-area"}clone(){return new nP({maxLength:this.maxLength,minLength:this.minLength})}};c([d({type:["text-area"],json:{read:!1,write:!0}})],zb.prototype,"type",void 0),zb=nP=c([C("esri.form.elements.inputs.TextAreaInput")],zb);const XCe=zb;var oP;let Vb=oP=class extends LL{constructor(t){super(t),this.type="text-box"}clone(){return new oP({maxLength:this.maxLength,minLength:this.minLength})}};c([d({type:["text-box"],json:{read:!1,write:!0}})],Vb.prototype,"type",void 0),Vb=oP=c([C("esri.form.elements.inputs.TextBoxInput")],Vb);const KCe=Vb;var aP;function Q$(t){return t??null}function eM(t){return t??null}let Ts=aP=class extends Wl{constructor(t){super(t),this.max=null,this.min=null,this.timeResolution="minutes",this.type="time-picker"}readMax(t,e){return Q$(e.max)}writeMax(t,e){e.max=eM(t)}readMin(t,e){return Q$(e.min)}writeMin(t,e){e.min=eM(t)}readTimeResolution(t,e){return Q$(e.timeResolution)}writeTimeResolution(t,e){e.timeResolution=eM(t)}clone(){return new aP({max:this.max,min:this.min,timeResolution:this.timeResolution})}};c([d({type:String,json:{type:String,write:!0}})],Ts.prototype,"max",void 0),c([K("max")],Ts.prototype,"readMax",null),c([re("max")],Ts.prototype,"writeMax",null),c([d({type:String,json:{type:String,write:!0}})],Ts.prototype,"min",void 0),c([K("min")],Ts.prototype,"readMin",null),c([re("min")],Ts.prototype,"writeMin",null),c([d({type:String,json:{type:String,write:!0}})],Ts.prototype,"timeResolution",void 0),c([K("timeResolution")],Ts.prototype,"readTimeResolution",null),c([re("timeResolution")],Ts.prototype,"writeTimeResolution",null),c([d({type:["time-picker"],json:{read:!1,write:!0}})],Ts.prototype,"type",void 0),Ts=aP=c([C("esri.form.elements.inputs.TimePickerInput")],Ts);const QCe=Ts,ePe={base:Wl,key:"type",typeMap:{"barcode-scanner":BCe,"combo-box":qCe,"date-picker":HCe,"datetime-picker":ZCe,"datetimeoffset-picker":WCe,"radio-buttons":JCe,switch:YCe,"text-area":XCe,"text-box":KCe,"time-picker":QCe}};var lP;let Js=lP=class extends mc{constructor(t){super(t),this.domain=null,this.editable=null,this.editableExpression=null,this.fieldName=null,this.hint=null,this.input=null,this.requiredExpression=null,this.type="field",this.valueExpression=null}clone(){return new lP({description:this.description,domain:this.domain,editable:this.editable,editableExpression:this.editableExpression,fieldName:this.fieldName,hint:this.hint,input:this.input,label:this.label,requiredExpression:this.requiredExpression,valueExpression:this.valueExpression,visibilityExpression:this.visibilityExpression})}};c([d({types:zG,json:{read:{reader:T2},write:!0}})],Js.prototype,"domain",void 0),c([d({type:Boolean,json:{write:!0}})],Js.prototype,"editable",void 0),c([d({type:String,json:{write:!0}})],Js.prototype,"editableExpression",void 0),c([d({type:String,json:{write:!0}})],Js.prototype,"fieldName",void 0),c([d({type:String,json:{write:!0}})],Js.prototype,"hint",void 0),c([d({types:ePe,json:{read:{source:"inputType"},write:{target:"inputType"}}})],Js.prototype,"input",void 0),c([d({type:String,json:{write:!0}})],Js.prototype,"requiredExpression",void 0),c([d({type:String,json:{read:!1,write:!0}})],Js.prototype,"type",void 0),c([d({type:String,json:{write:!0}})],Js.prototype,"valueExpression",void 0),Js=lP=c([C("esri.form.elements.FieldElement")],Js);const y6=Js;var uP;let sl=uP=class extends mc{constructor(t){super(t),this.displayCount=null,this.displayType="list",this.editableExpression=null,this.orderByFields=null,this.relationshipId=null,this.type="relationship"}clone(){return new uP({description:this.description,displayCount:this.displayCount,displayType:this.displayType,editableExpression:this.editableExpression,label:this.label,orderByFields:k(this.orderByFields),relationshipId:this.relationshipId,visibilityExpression:this.visibilityExpression})}};c([d({type:Number,json:{write:!0}})],sl.prototype,"displayCount",void 0),c([d({type:["list"],json:{write:!0}})],sl.prototype,"displayType",void 0),c([d({type:String,json:{write:!0}})],sl.prototype,"editableExpression",void 0),c([d({type:[dA],json:{write:!0}})],sl.prototype,"orderByFields",void 0),c([d({type:Number,json:{write:!0}})],sl.prototype,"relationshipId",void 0),c([d({type:["relationship"],json:{read:!1,write:!0}})],sl.prototype,"type",void 0),sl=uP=c([C("esri.form.elements.RelationshipElement")],sl);const g6=sl;var cP;let Fp=cP=class extends mc{constructor(t){super(t),this.text=null,this.textFormat="plain-text",this.type="text"}clone(){return new cP({text:this.text,textFormat:this.textFormat,visibilityExpression:this.visibilityExpression})}};c([d({type:String,json:{write:!0}})],Fp.prototype,"text",void 0),c([d({type:String,json:{write:!0}})],Fp.prototype,"textFormat",void 0),c([d({type:["text"],readOnly:!0,json:{read:!1,write:!0}})],Fp.prototype,"type",void 0),Fp=cP=c([C("esri.form.elements.TextElement")],Fp);const v6=Fp;let Dp=class extends Ce.ClonableMixin(mc){constructor(e){super(e),this.associationTypes=null,this.editableExpression=null,this.type="utilityNetworkAssociations"}};c([d({type:[fG],json:{write:{isRequired:!0}}})],Dp.prototype,"associationTypes",void 0),c([d({type:String,json:{write:!0}})],Dp.prototype,"editableExpression",void 0),c([d({type:["utilityNetworkAssociations"],json:{read:!1,write:!0}})],Dp.prototype,"type",void 0),Dp=c([C("esri.form.elements.UtilityNetworkAssociationsElement")],Dp);const _6=Dp,tPe=t=>t.type==="field",rPe=t=>t.type==="group",iPe=t=>t.type==="text";function qZ(t){return{typesWithGroup:{base:mc,key:"type",typeMap:{attachment:h6,field:y6,group:t,relationship:g6,text:v6,utilityNetworkAssociations:_6}},typesWithoutGroup:{base:mc,key:"type",typeMap:{attachment:h6,field:y6,relationship:g6,text:v6,utilityNetworkAssociations:_6}}}}function HZ(t,e,r=!0){if(!t)return null;const i=r?e.typesWithGroup.typeMap:e.typesWithoutGroup.typeMap;return t.filter((s=>i[s.type])).map((s=>i[s.type].fromJSON(s)))}function WZ(t,e,r=!0){if(!t)return null;const i=r?e.typesWithGroup.typeMap:e.typesWithoutGroup.typeMap;return t.filter((s=>i[s.type])).map((s=>s.toJSON()))}function ZZ(t,e,r=!0){return t?t.map((i=>xa(r?e.typesWithGroup:e.typesWithoutGroup,i))):null}var hP;let Ao=hP=class extends mc{constructor(t){super(t),this.elements=null,this.initialState="expanded",this.type="group"}castElements(t){return ZZ(t,tM,!1)}readElements(t,e){return HZ(e.formElements,tM,!1)}writeElements(t,e){e.formElements=WZ(t,tM,!1)}clone(){return new hP({description:this.description,elements:k(this.elements),initialState:this.initialState,label:this.label,visibilityExpression:this.visibilityExpression})}};c([d({json:{write:!0}})],Ao.prototype,"elements",void 0),c([We("elements")],Ao.prototype,"castElements",null),c([K("elements",["formElements"])],Ao.prototype,"readElements",null),c([re("elements")],Ao.prototype,"writeElements",null),c([d({type:["collapsed","expanded"],json:{write:!0}})],Ao.prototype,"initialState",void 0),c([d({type:String,json:{read:!1,write:!0}})],Ao.prototype,"type",void 0),Ao=hP=c([C("esri.form.elements.GroupElement")],Ao);const tM=qZ(Ao),sPe=Ao;var dP;const rM=qZ(sPe);let Vn=dP=class extends W{constructor(t){super(t),this.description=null,this.elements=null,this.expressionInfos=null,this.preserveFieldValuesWhenHidden=!1,this.title=null}castElements(t){return ZZ(t,rM)}readElements(t,e){return HZ(e.formElements,rM)}writeElements(t,e){e.formElements=WZ(t,rM)}clone(){return new dP({description:this.description,expressionInfos:k(this.expressionInfos),elements:k(this.elements),title:this.title,preserveFieldValuesWhenHidden:this.preserveFieldValuesWhenHidden})}async getFieldsUsed(t,e){const r=new Set,{description:i,elements:s,expressionInfos:n,title:o}=this;if(S0(r,t,i),S0(r,t,o),!s)return[];const a=nPe(s,n).map((l=>si(r,t,l)));await Promise.all(a);for(const l of s)JZ(r,{fieldsIndex:t,relationships:e},l);return Array.from(r).sort()}};function JZ(t,e,r){const{fieldsIndex:i}=e;if(!i||i.fields.length!==t.size)switch(S0(t,i,r.label),S0(t,i,r.description),r.type){case"field":Bi(t,i,r.fieldName);break;case"group":r.elements.forEach((s=>JZ(t,e,s)));break;case"relationship":if(e.relationships){const s=e.relationships.find((n=>n.id===r.relationshipId));s&&Bi(t,i,s.keyField)}dc(t,i,r.orderByFields?.map((s=>s.field)));break;case"text":S0(t,i,r.text)}}function nPe(t,e){if(!e||e.length===0)return[];const r=YZ(t),i=[];for(const s of e)r.has(s.name)&&i.push(s.expression);return i}function YZ(t){const e=new Set;for(const r of t)if(IR(e,r.visibilityExpression),!iPe(r)){if(rPe(r))tw(e,YZ(r.elements));else if(IR(e,r.editableExpression),tPe(r)){const{requiredExpression:i,valueExpression:s}=r;tw(e,[i,s])}}return e}function S0(t,e,r){dc(t,e,uA(r))}c([d({type:String,json:{write:!0}})],Vn.prototype,"description",void 0),c([d({json:{write:!0}})],Vn.prototype,"elements",void 0),c([We("elements")],Vn.prototype,"castElements",null),c([K("elements",["formElements"])],Vn.prototype,"readElements",null),c([re("elements")],Vn.prototype,"writeElements",null),c([d({type:[DCe],json:{write:!0}})],Vn.prototype,"expressionInfos",void 0),c([d({type:Boolean,json:{default:!1,write:!0}})],Vn.prototype,"preserveFieldValuesWhenHidden",void 0),c([d({type:String,json:{write:!0}})],Vn.prototype,"title",void 0),Vn=dP=c([C("esri.form.FormTemplate")],Vn);const oPe=Vn;function b6(t,e,r){if(t.hasM==null||t.hasZ)for(const i of e)for(const s of i)s.length>2&&(s[2]*=r)}function aPe(t,e,r){if(!t&&!e||!r)return;const i=fw(r);w6(t,r,i),w6(e,r,i)}function w6(t,e,r){if(t)for(const i of t)lPe(i.geometry,e,r)}function lPe(t,e,r){if(!t?.spatialReference||mr(t.spatialReference,e))return;const i=fw(t.spatialReference)/r;if(i!==1){if("x"in t)t.z!=null&&(t.z*=i);else if("rings"in t)b6(t,t.rings,i);else if("paths"in t)b6(t,t.paths,i);else if("points"in t&&(t.hasM==null||t.hasZ))for(const s of t.points)s.length>2&&(s[2]*=i)}}function S6(t,e,r){if(!r?.features||!r.hasZ)return;const i=IU(r.geometryType,e,t.outSpatialReference);if(i!=null)for(const s of r.features)i(s.geometry)}var pP;const fP=new De({esriGeometryPoint:"point",esriGeometryMultipoint:"multipoint",esriGeometryPolyline:"polyline",esriGeometryPolygon:"polygon",esriGeometryEnvelope:"extent",mesh:"mesh","":null});let Tr=pP=class extends W{constructor(t){super(t),this.displayFieldName=null,this.exceededTransferLimit=!1,this.features=[],this.fields=null,this.geometryType=null,this.hasM=!1,this.hasZ=!1,this.queryGeometry=null,this.spatialReference=null}readFeatures(t,e){return this.readFeaturesWithClass(t,e,dr)}writeGeometryType(t,e,r,i){if(t)return void fP.write(t,e,r,i);const{features:s}=this;if(s){for(const n of s)if(n?.geometry!=null)return void fP.write(n.geometry.type,e,r,i)}}readQueryGeometry(t,e){if(!t)return null;const r=!!t.spatialReference,i=hc(t);return i&&!r&&e.spatialReference&&(i.spatialReference=ne.fromJSON(e.spatialReference)),i}writeSpatialReference(t,e){if(t)return void(e.spatialReference=t.toJSON());const{features:r}=this;if(r){for(const i of r)if(i&&i.geometry!=null&&i.geometry.spatialReference)return void(e.spatialReference=i.geometry.spatialReference.toJSON())}}clone(){return new pP(this.cloneProperties())}cloneProperties(){return k({displayFieldName:this.displayFieldName,exceededTransferLimit:this.exceededTransferLimit,features:this.features,fields:this.fields,geometryType:this.geometryType,hasM:this.hasM,hasZ:this.hasZ,queryGeometry:this.queryGeometry,spatialReference:this.spatialReference,transform:this.transform})}toJSON(t){const e=this.write();if(e.features&&Array.isArray(t)&&t.length>0)for(let r=0;r<e.features.length;r++){const i=e.features[r];if(i.geometry){const s=t?.[r];i.geometry=s?.toJSON()||i.geometry}}return e}quantize(t){const{scale:[e,r],translate:[i,s]}=t,n=u=>Math.round((u-i)/e),o=u=>Math.round((s-u)/r),a=this.features,l=this._getQuantizationFunction(this.geometryType,n,o);for(let u=0,h=a.length;u<h;u++)l?.(a[u].geometry)||(a.splice(u,1),u--,h--);return this.transform=t,this}unquantize(){const{geometryType:t,features:e,transform:r}=this;if(!r)return this;const{translate:[i,s],scale:[n,o]}=r,a=m=>m*n+i,l=m=>s-m*o;let u=null,h=null;if(this.hasZ&&r?.scale?.[2]!=null){const{translate:[,,m],scale:[,,y]}=r;u=g=>g*y+m}if(this.hasM&&r?.scale?.[3]!=null){const{translate:[,,,m],scale:[,,,y]}=r;h=g=>g==null?g:g*y+m}const p=this._getHydrationFunction(t,a,l,u,h);for(const{geometry:m}of e)m!=null&&p&&p(m);return this.transform=null,this}readFeaturesWithClass(t,e,r){const i=ne.fromJSON(e.spatialReference),s=[];for(let n=0;n<t.length;n++){const o=t[n],a=r.fromJSON(o),l=o.geometry?.spatialReference;a.geometry==null||l||(a.geometry.spatialReference=i);const u=o.aggregateGeometries,h=a.aggregateGeometries;if(u&&h!=null)for(const p in h){const m=h[p],y=u[p],g=y?.spatialReference;m==null||g||(m.spatialReference=i)}s.push(a)}return s}_quantizePoints(t,e,r){let i,s;const n=[];for(let o=0,a=t.length;o<a;o++){const l=t[o];if(o>0){const u=e(l[0]),h=r(l[1]);u===i&&h===s||(n.push([u-i,h-s]),i=u,s=h)}else i=e(l[0]),s=r(l[1]),n.push([i,s])}return n.length>0?n:null}_getQuantizationFunction(t,e,r){return t==="point"?i=>(i.x=e(i.x),i.y=r(i.y),i):t==="polyline"||t==="polygon"?i=>{const s=rr(i)?i.rings:i.paths,n=[];for(let o=0,a=s.length;o<a;o++){const l=s[o],u=this._quantizePoints(l,e,r);u&&n.push(u)}return n.length>0?(rr(i)?i.rings=n:i.paths=n,i):null}:t==="multipoint"?i=>{const s=this._quantizePoints(i.points,e,r);return s&&s.length>0?(i.points=s,i):null}:t==="extent"?i=>i:null}_getHydrationFunction(t,e,r,i,s){return t==="point"?n=>{n.x=e(n.x),n.y=r(n.y),i&&(n.z=i(n.z))}:t==="polyline"||t==="polygon"?n=>{const o=rr(n)?n.rings:n.paths;let a,l;for(let u=0,h=o.length;u<h;u++){const p=o[u];for(let m=0,y=p.length;m<y;m++){const g=p[m];m>0?(a+=g[0],l+=g[1]):(a=g[0],l=g[1]),g[0]=e(a),g[1]=r(l)}}if(i&&s)for(let u=0,h=o.length;u<h;u++){const p=o[u];for(let m=0,y=p.length;m<y;m++){const g=p[m];g[2]=i(g[2]),g[3]=s(g[3])}}else if(i)for(let u=0,h=o.length;u<h;u++){const p=o[u];for(let m=0,y=p.length;m<y;m++){const g=p[m];g[2]=i(g[2])}}else if(s)for(let u=0,h=o.length;u<h;u++){const p=o[u];for(let m=0,y=p.length;m<y;m++){const g=p[m];g[2]=s(g[2])}}}:t==="extent"?n=>{n.xmin=e(n.xmin),n.ymin=r(n.ymin),n.xmax=e(n.xmax),n.ymax=r(n.ymax),i&&n.zmax!=null&&n.zmin!=null&&(n.zmax=i(n.zmax),n.zmin=i(n.zmin)),s&&n.mmax!=null&&n.mmin!=null&&(n.mmax=s(n.mmax),n.mmin=s(n.mmin))}:t==="multipoint"?n=>{const o=n.points;let a,l;for(let u=0,h=o.length;u<h;u++){const p=o[u];u>0?(a+=p[0],l+=p[1]):(a=p[0],l=p[1]),p[0]=e(a),p[1]=r(l)}if(i&&s)for(let u=0,h=o.length;u<h;u++){const p=o[u];p[2]=i(p[2]),p[3]=s(p[3])}else if(i)for(let u=0,h=o.length;u<h;u++){const p=o[u];p[2]=i(p[2])}else if(s)for(let u=0,h=o.length;u<h;u++){const p=o[u];p[2]=s(p[2])}}:null}};c([d({type:String,json:{write:!0}})],Tr.prototype,"displayFieldName",void 0),c([d({type:Boolean,json:{write:{overridePolicy:t=>({enabled:t})}}})],Tr.prototype,"exceededTransferLimit",void 0),c([d({type:[dr],json:{write:!0}})],Tr.prototype,"features",void 0),c([K("features")],Tr.prototype,"readFeatures",null),c([d({type:[Vr],json:{write:!0}})],Tr.prototype,"fields",void 0),c([d({type:["point","multipoint","polyline","polygon","extent","mesh"],json:{read:{reader:fP.read}}})],Tr.prototype,"geometryType",void 0),c([re("geometryType")],Tr.prototype,"writeGeometryType",null),c([d({type:Boolean,json:{write:{overridePolicy:t=>({enabled:t})}}})],Tr.prototype,"hasM",void 0),c([d({type:Boolean,json:{write:{overridePolicy:t=>({enabled:t})}}})],Tr.prototype,"hasZ",void 0),c([d({types:Av,json:{write:!0}})],Tr.prototype,"queryGeometry",void 0),c([K("queryGeometry")],Tr.prototype,"readQueryGeometry",null),c([d({type:ne,json:{write:!0}})],Tr.prototype,"spatialReference",void 0),c([re("spatialReference")],Tr.prototype,"writeSpatialReference",null),c([d({json:{write:!0}})],Tr.prototype,"transform",void 0),Tr=pP=c([C("esri.rest.support.FeatureSet")],Tr),Tr.prototype.toJSON.isDefaultToJSON=!0;let uPe=0,yl=class extends Ls.LoadableMixin(Tl.EsriPromiseMixin(se)){constructor(e){super(e),this._idToClientGeometry=null,this.type="memory"}load(e){const r=e!=null?e.signal:null;return this.addResolvingPromise(this._startWorker(r)),Promise.resolve(this)}destroy(){this._connection?.close(),this._connection=null}get _workerGeometryType(){const e=this.layer?.geometryType;return e?this._geometryTypeRequiresClientGraphicMapping(e)?"polygon":e:null}applyEdits(e){return this.load().then((()=>this._applyEdits(e)))}openPorts(){return this.load().then((()=>this._connection.openPorts()))}async queryFeatures(e,r={}){await this.load(r);const i=await this._connection.invoke("queryFeatures",e?e.toJSON():null,r);S6(e,this.layer.spatialReference,i);const s=Tr.fromJSON(i);if(!this._requiresClientGraphicMapping()||!this._idToClientGeometry)return s;const n=this.layer.objectIdField;for(const o of s.features){const a=o.attributes[n],l=this._idToClientGeometry.get(a);l!==void 0&&(o.geometry=l)}return s.geometryType=this.layer.geometryType,s}async queryFeaturesJSON(e,r={}){if(this._requiresClientGraphicMapping())throw new F("query-features-json:unsupported","Cannot query in JSON format for client only geometry types (mesh and extent)");await this.load(r);const i=await this._connection.invoke("queryFeatures",e?e.toJSON():null,r);return S6(e,this.layer.spatialReference,i),i}queryFeatureCount(e,r={}){return this.load(r).then((()=>this._connection.invoke("queryFeatureCount",e?e.toJSON():null,r)))}queryObjectIds(e,r={}){return this.load(r).then((()=>this._connection.invoke("queryObjectIds",e?e.toJSON():null,r)))}queryExtent(e,r={}){return this.load(r).then((()=>this._connection.invoke("queryExtent",e?e.toJSON():null,r))).then((i=>({count:i.count,extent:Le.fromJSON(i.extent)})))}querySnapping(e,r={}){return this.load(r).then((()=>this._connection.invoke("querySnapping",e,r)))}async queryAttributeBins(e,r={}){return await this.load(),this._connection.invoke("queryAttributeBins",e?.toJSON(),r)}async _applyEdits(e){if(!this._connection)throw new F("feature-layer-source:edit-failure","Memory source not loaded");const r=this.layer.objectIdField;let i=null;const s=[],n=[];await Promise.all([this._prepareClientMapping(e.addFeatures,null),this._prepareClientMapping(e.updateFeatures,null)]);const o=h=>"objectId"in h&&h.objectId!=null?h.objectId:"attributes"in h&&h.attributes[r]!=null?h.attributes[r]:null;if(e.addFeatures&&(i=this._prepareAddFeatures(e.addFeatures)),e.deleteFeatures)for(const h of e.deleteFeatures){const p=o(h);p!=null&&s.push(p)}const a=e.updateFeatures&&this._idToClientGeometry?new Map:null;if(e.updateFeatures){for(const h of e.updateFeatures)if(n.push(this._serializeFeature(h)),a&&h.geometry!=null){const p=o(h);p!=null&&a.set(p,h)}}aPe(i?i.features:null,n,this.layer.spatialReference);const{fullExtent:l,featureEditResults:u}=await this._connection.invoke("applyEdits",{adds:i?i.features:[],updates:n,deletes:s});return this.fullExtent=l,i&&i.finish(u.uidToObjectId),this._updateIdToClientGeometries(a,u),this._createEditsResult(u)}async _prepareClientMapping(e,r){if(this._layerOrSourceGeometryType!=="mesh"||e==null)return;const i=[];for(const{geometry:s}of e)s==null||s.type!=="mesh"||s.hasExtent||s.loaded||i.push(s.load({signal:r}));i.length&&await Promise.all(i)}_updateIdToClientGeometries(e,r){if(this._idToClientGeometry){if(e)for(const i of r.updateResults){if(!i.success)continue;const s=e.get(i.objectId);s!=null&&this._addIdToClientGeometry(s)}for(const i of r.deleteResults)i.success&&this._idToClientGeometry.delete(i.objectId)}}_createEditsResult(e){return{addFeatureResults:e.addResults?e.addResults.map(this._createFeatureEditResult,this):[],updateFeatureResults:e.updateResults?e.updateResults.map(this._createFeatureEditResult,this):[],deleteFeatureResults:e.deleteResults?e.deleteResults.map(this._createFeatureEditResult,this):[],addAttachmentResults:[],updateAttachmentResults:[],deleteAttachmentResults:[]}}_createFeatureEditResult(e){const r=e.success===!0?null:e.error||{code:void 0,description:""};return{objectId:e.objectId,globalId:e.globalId,error:r?new F("feature-layer-source:edit-failure",r.description,{code:r.code}):null}}_prepareAddFeatures(e){const r=new Map,i=new Array(e.length);let s=null;for(let o=0;o<e.length;o++){const a=e[o],l=this._serializeFeature(a);s||a.geometry==null||(s=a.geometry.type),i[o]=l,r.set(`${l.uid}`,a)}const n=this;return{features:i,inferredGeometryType:s,finish(o){const a=n.sourceJSON.objectIdField;for(const l in o){const u=o[l],h=r.get(l);h&&(h.attributes||(h.attributes={}),u===-1?delete h.attributes[a]:h.attributes[a]=u,n._addIdToClientGeometry(h))}}}}_addIdToClientGeometry(e){if(!this._idToClientGeometry)return;const r=this.sourceJSON.objectIdField,i=e.attributes?.[r];i!=null&&this._idToClientGeometry.set(i,e.geometry??null)}get _layerOrSourceGeometryType(){return this.layer?.geometryType??this.sourceJSON?.geometryType}_requiresClientGraphicMapping(){return this._geometryTypeRequiresClientGraphicMapping(this._layerOrSourceGeometryType)}_geometryRequiresClientGraphicMapping(e){return this._geometryTypeRequiresClientGraphicMapping(e.type)}_geometryTypeRequiresClientGraphicMapping(e){return e==="mesh"||e==="multipatch"||e==="extent"}_serializeFeature(e){const{attributes:r}=e,i=this._geometryForSerialization(e),s=(uPe++).toString();return i?{uid:s,geometry:i.toJSON(),attributes:r}:{uid:s,attributes:r}}_geometryForSerialization(e){const{geometry:r}=e;return r==null?null:this._geometryRequiresClientGraphicMapping(r)?r.extent?yt.fromExtent(r.extent):null:r}async _startWorker(e){this._connection=await yle("MemorySourceWorker",{strategy:z("feature-layers-workers")?"dedicated":"local",signal:e,registryTarget:this});const{fields:r,spatialReference:i,objectIdField:s,hasM:n,hasZ:o,timeInfo:a,dateFieldsTimeZone:l}=this.layer,u=this.layer.originOf("spatialReference")==="defaults";await this._prepareClientMapping(this.items,e);const h=this._prepareAddFeatures(this.items);this.addHandles(this.on("before-changes",(g=>{q.getLogger(this).error("Source modifications will not propagate after layer has been loaded. Please use .applyEdits() instead"),g.preventDefault()})));const p={features:h.features,fields:r?.map((g=>g.toJSON())),geometryType:cO.toJSON(this._workerGeometryType),hasM:this._layerOrSourceGeometryType!=="mesh"&&n,hasZ:this._layerOrSourceGeometryType==="mesh"||o,objectIdField:s,spatialReference:u?null:i&&i.toJSON(),timeInfo:a?.toJSON()??null,dateFieldsTimeZone:l},m=await this._connection.invoke("load",p,{signal:e});for(const g of m.warnings)q.getLogger(this.layer).warn("#load()",`${g.message} (title: '${this.layer.title||"no title"}', id: '${this.layer.id??"no id"}')`,{warning:g});m.featureErrors.length&&q.getLogger(this.layer).warn("#load()",`Encountered ${m.featureErrors.length} validation errors while loading features. (title: '${this.layer.title||"no title"}', id: '${this.layer.id??"no id"}')`,{errors:m.featureErrors});const y=m.layerDefinition;this._geometryTypeRequiresClientGraphicMapping(h.inferredGeometryType)&&(y.geometryType=cO.toJSON(h.inferredGeometryType)),this.sourceJSON=y,this._requiresClientGraphicMapping()&&(this._idToClientGeometry=new Map),h.finish(m.assignedObjectIds)}};c([p3({Type:dr,ensureType:br(dr)})],yl.prototype,"itemType",void 0),c([d()],yl.prototype,"type",void 0),c([d({constructOnly:!0})],yl.prototype,"layer",void 0),c([d({readOnly:!0})],yl.prototype,"_workerGeometryType",null),c([d()],yl.prototype,"sourceJSON",void 0),yl=c([C("esri.layers.graphics.sources.MemorySource")],yl);function cPe(t){return"portalItem"in t}const hPe=t=>{let e=class extends t{get apiKey(){return this._isOverridden("apiKey")?this._get("apiKey"):cPe(this)?this.portalItem?.apiKey:null}set apiKey(r){r!=null?this._override("apiKey",r):(this._clearOverride("apiKey"),this.clear("apiKey","user"))}};return c([d({type:String})],e.prototype,"apiKey",null),e=c([C("esri.layers.mixins.APIKeyMixin")],e),e},dPe=t=>{let e=class extends t{get title(){if(this._get("title")&&this.originOf("title")!=="defaults")return this._get("title");if(this.url){const r=vc(this.url);if(r?.title)return r.title}return this._get("title")||""}set title(r){this._set("title",r)}set url(r){this._set("url",OX(r,q.getLogger(this)))}};return c([d()],e.prototype,"title",null),c([d({type:String})],e.prototype,"url",null),e=c([C("esri.layers.mixins.ArcGISService")],e),e},pPe={type:["average","color-burn","color-dodge","color","darken","destination-atop","destination-in","destination-out","destination-over","difference","exclusion","hard-light","hue","invert","lighten","lighter","luminosity","minus","multiply","normal","overlay","plus","reflect","saturation","screen","soft-light","source-atop","source-in","source-out","vivid-light","xor"],nonNullable:!0,json:{read:!1,write:!1,origins:{"web-map":{read:!0,write:{layerContainerTypes:ft}},"portal-item":{read:!0,write:{layerContainerTypes:ft}}}}},x6={read:{reader:K0},write:{allowNull:!0,writer:Q0,layerContainerTypes:ft}},fPe={json:{read:!1,write:!1,origins:{"web-map":x6,"portal-item":x6}}},mPe=t=>{let e=class extends t{constructor(){super(...arguments),this.blendMode="normal",this.effect=null}};return c([d(pPe)],e.prototype,"blendMode",void 0),c([d(fPe)],e.prototype,"effect",void 0),e=c([C("esri.layers.mixins.BlendLayer")],e),e},yPe=t=>{let e=class extends t{constructor(){super(...arguments),this.customParameters=null}};return c([d({type:Object,json:{write:{overridePolicy:r=>({enabled:!!(r&&Object.keys(r).length>0)})}}})],e.prototype,"customParameters",void 0),e=c([C("esri.layers.mixins.CustomParametersMixin")],e),e},$6={write:{overridePolicy:(t,e,r)=>({enabled:!r||r.filterMode==="scale"})}};let gl=class extends Ce.ClonableMixin(W){constructor(e){super(e),this.id=jm(),this.maxScale=0,this.minScale=0,this.title="",this.where=null}};c([d({type:String,json:{write:!0}})],gl.prototype,"id",void 0),c([d({type:Number,json:$6})],gl.prototype,"maxScale",void 0),c([d({type:Number,json:$6})],gl.prototype,"minScale",void 0),c([d({type:String,json:{write:!0}})],gl.prototype,"title",void 0),c([d({type:String,json:{write:!0}})],gl.prototype,"where",void 0),gl=c([C("esri.layers.support.DisplayFilter")],gl);let wh=class extends Ce.ClonableMixin(W){constructor(e){super(e),this.activeFilterId=null,this.filters=new(se.ofType(gl)),this.mode="manual"}writeFilters(e,r,i,s){const n=e.toArray();this.mode==="scale"&&n.sort(((o,a)=>{const l=ybe(a.minScale,o.minScale),u=o.maxScale-a.maxScale;return l===0?u:l})),r[i]=n.map((o=>o.toJSON(s)))}write(e,r){return super.write(e,lbe(this,r))}};c([d({type:String,json:{write:{overridePolicy:(t,e,r)=>({enabled:r.filterMode==="manual",isRequired:!0})}}})],wh.prototype,"activeFilterId",void 0),c([d({type:se.ofType(gl),nonNullable:!0,json:{write:!0}})],wh.prototype,"filters",void 0),c([re("filters")],wh.prototype,"writeFilters",null),c([d({type:["manual","scale"],nonNullable:!0,json:{name:"filterMode",write:!0}})],wh.prototype,"mode",void 0),wh=c([C("esri.layers.support.DisplayFilterInfo")],wh);const gPe=t=>{let e=class extends t{constructor(){super(...arguments),this.displayFilterEnabled=!0,this.displayFilterInfo=null}};return c([d(vPe)],e.prototype,"displayFilterEnabled",void 0),c([d(_Pe)],e.prototype,"displayFilterInfo",void 0),e=c([C("esri.layers.mixins.DisplayFilteredLayer")],e),e},vPe={type:Boolean,json:{name:"layerDefinition.disableDisplayFilter",read:{reader:t=>!t},write:{layerContainerTypes:ft,writer(t,e,r){Cr(r,!t,e)}},origins:{"web-scene":{write:!1,read:!1}}}},_Pe={type:wh,json:{name:"layerDefinition.displayFilterInfo",write:{enabled:!0,allowNull:!0,layerContainerTypes:ft},origins:{"web-scene":{write:!1,read:!1}}}},bPe=Mse(),XZ=new Map,KZ=new Map;async function Fje(t,e,r){if(!t||!r)return!1;if(!e)return!0;const i=new URL(t).host;let s=XZ.get(i);if(!s){const n=t.replace(/\/FeatureServer/i,"/VersionManagementServer").replace(/\/\d*$/,"");s=(await et(n,{responseType:"json",query:{f:"json"}})).data.defaultVersionName}return s===e}async function Dje(t,e,r=!1){if(!t||!e)return!0;const i=t.replace(/\/FeatureServer/i,"/VersionManagementServer").replace(/\/\d*$/,""),s=KZ.get(i)?.entries();if(s){for(const[n,o]of s)if(o.name===e){const a=!o.stack?.hasForwardEdits();if(!a&&r){const[{deleteForwardEdits:l},{default:u}]=await Promise.all([J(()=>import("./deleteForwardEdits-Cbu8OpAS.js"),[]),J(()=>import("./DeleteForwardEditsParameters-DXKToi87.js"),[])]),h=await l(i,n,new u({sessionId:bPe,moment:o.moment}));return h.success&&o.stack?.clearForwardEdits(),h.success}return a}}return!0}function wPe(t,e){if(!t)return!1;const r=t.replace(/\/FeatureServer/i,"/VersionManagementServer").replace(/\/\d*$/,""),i=KZ.get(r)?.entries();if(i){for(const[s,n]of i)if(n.name===e)return n.lockType==="edit"}return!1}const RL=new Ca.EventEmitter;function SPe(t){return RL.on("apply-edits",new WeakRef(t))}function xPe(t){return RL.on("update-moment",new WeakRef(t))}function zje(t,e,r=null,i=!1){const s=Ns();return i=e==null||i,RL.emit("apply-edits",{serviceUrl:t,layerId:e,gdbVersion:r,mayReceiveServiceEdits:i,result:s.promise}),s}const QZ=Symbol();function Vje(t){return t!=null&&typeof t=="object"&&QZ in t}function Dy(t){return t!=null&&typeof t=="object"&&"gdbVersion"in t}function iM(t,e,r){const i=new URL(t).host,s=XZ.get(i),n=o=>!o||o===s;return n(e)&&n(r)||e===r}const $Pe=t=>{var i;var e;let r=(i=class extends t{constructor(...s){super(...s),this[e]=!0,this._applyEditsHandler=n=>{const{serviceUrl:o,layerId:a,gdbVersion:l,mayReceiveServiceEdits:u,result:h}=n,p=o===this.url,m=a!=null&&this.layerId!=null&&a===this.layerId,y=Dy(this),g=Dy(this)&&iM(o,l,this.gdbVersion);if(!p||y&&!g||!m&&!u)return;const v=h.then((_=>{if(this.lastEditsEventDate=new Date,m&&(_.addedFeatures.length||_.updatedFeatures.length||_.deletedFeatures.length||_.addedAttachments.length||_.updatedAttachments.length||_.deletedAttachments.length))return this.emit("edits",k(_)),_;const b=_.editedFeatures?.find((({layerId:$})=>$===this.layerId));if(b){const{adds:$,updates:T,deletes:I}=b.editedFeatures,P={edits:null,addedAttachments:[],deletedAttachments:[],updatedAttachments:[],addedFeatures:$?$.map((({attributes:R})=>({objectId:this.objectIdField&&R[this.objectIdField],globalId:this.globalIdField&&R[this.globalIdField]}))):[],deletedFeatures:I?I.map((({attributes:R})=>({objectId:this.objectIdField&&R[this.objectIdField],globalId:this.globalIdField&&R[this.globalIdField]}))):[],updatedFeatures:T?T.map((({current:{attributes:R}})=>({objectId:this.objectIdField&&R[this.objectIdField],globalId:this.globalIdField&&R[this.globalIdField]}))):[],editedFeatures:k(_.editedFeatures),exceededTransferLimit:!1,historicMoment:k(_.historicMoment)};return this.emit("edits",P),P}const S={edits:null,addedAttachments:[],deletedAttachments:[],updatedAttachments:[],addedFeatures:[],deletedFeatures:[],updatedFeatures:[],editedFeatures:k(_.editedFeatures),exceededTransferLimit:!1,historicMoment:k(_.historicMoment)};return"historicMoment"in this&&this._shouldUpdateHistoricMoment(o,l,S.historicMoment)&&this.emit("edits",S),S})).then((_=>("historicMoment"in this&&this._shouldUpdateHistoricMoment(o,l,_.historicMoment)&&(this.historicMoment=_.historicMoment),_)));this.emit("apply-edits",{result:v})},this._updateMomentHandler=n=>{const{serviceUrl:o,gdbVersion:a,moment:l}=n,u=o===this.url,h=Dy(this),p=Dy(this)&&iM(o,a,this.gdbVersion),m=Dy(this)&&!iM(o,this.gdbVersion,null);u&&h&&p&&m&&"historicMoment"in this&&this.historicMoment!==l&&(this.historicMoment=l)},this.when().then((()=>{this.addHandles(SPe(this._applyEditsHandler)),"historicMoment"in this&&this.addHandles(xPe(this._updateMomentHandler))}),(()=>{}))}_shouldUpdateHistoricMoment(s,n,o){return"historicMoment"in this&&this.historicMoment!==o&&wPe(s,n)}},e=QZ,i);return c([d()],r.prototype,"lastEditsEventDate",void 0),r=c([C("esri.layers.mixins.EditBusLayer")],r),r};var mP;const sM=new De({esriSpatialRelIntersects:"intersects",esriSpatialRelContains:"contains",esriSpatialRelCrosses:"crosses",esriSpatialRelDisjoint:"disjoint",esriSpatialRelEnvelopeIntersects:"envelope-intersects",esriSpatialRelIndexIntersects:"index-intersects",esriSpatialRelOverlaps:"overlaps",esriSpatialRelTouches:"touches",esriSpatialRelWithin:"within",esriSpatialRelRelation:"relation"}),nM=new De({esriSRUnit_Meter:"meters",esriSRUnit_Kilometer:"kilometers",esriSRUnit_Foot:"feet",esriSRUnit_StatuteMile:"miles",esriSRUnit_NauticalMile:"nautical-miles",esriSRUnit_USNauticalMile:"us-nautical-miles"});let Eo=mP=class extends W{constructor(t){super(t),this.where=null,this.geometry=null,this.spatialRelationship="intersects",this.distance=void 0,this.objectIds=null,this.units=null,this.timeExtent=null}createQuery(t={}){const{where:e,geometry:r,spatialRelationship:i,timeExtent:s,objectIds:n,units:o,distance:a}=this;return new me({geometry:k(r),objectIds:k(n),spatialRelationship:i,timeExtent:k(s),where:e,units:o,distance:a,...t})}clone(){const{where:t,geometry:e,spatialRelationship:r,timeExtent:i,objectIds:s,units:n,distance:o}=this;return new mP({geometry:k(e),objectIds:k(s),spatialRelationship:r,timeExtent:k(i),where:t,units:n,distance:o})}};c([d({type:String,json:{write:!0}})],Eo.prototype,"where",void 0),c([d({types:Av,json:{write:!0}})],Eo.prototype,"geometry",void 0),c([d({type:sM.apiValues,json:{name:"spatialRel",read:{reader:sM.read},write:{allowNull:!1,writer:sM.write,overridePolicy(){return{enabled:this.geometry!=null}}}}})],Eo.prototype,"spatialRelationship",void 0),c([d({type:Number,json:{write:{overridePolicy(t){return{enabled:t!=null&&this.geometry!=null}}}}})],Eo.prototype,"distance",void 0),c([d({type:[Number],json:{write:!0}})],Eo.prototype,"objectIds",void 0),c([d({type:nM.apiValues,json:{read:nM.read,write:{writer:nM.write,overridePolicy(t){return{enabled:t!=null&&this.geometry!=null}}}}})],Eo.prototype,"units",void 0),c([d({type:fr,json:{write:!0}})],Eo.prototype,"timeExtent",void 0),Eo=mP=c([C("esri.layers.support.FeatureFilter")],Eo);const MPe=Eo;var yP;const M6={read:{reader:K0},write:{writer:Q0,overridePolicy(){return{allowNull:this.excludedEffect!=null,isRequired:this.excludedEffect==null}}}},T6={read:{reader:K0},write:{writer:Q0,overridePolicy(){return{allowNull:this.includedEffect!=null,isRequired:this.includedEffect==null}}}},E6={name:"showExcludedLabels",default:!0};let Sh=yP=class extends W{constructor(t){super(t),this.filter=null,this.includedEffect=null,this.excludedEffect=null,this.excludedLabelsVisible=!1}write(t,e){const r=super.write(t,e);if(e?.origin){if(r.filter){const i=Object.keys(r.filter);if(i.length>1||i[0]!=="where")return e.messages?.push(new F("web-document-write:unsupported-feature-effect","Invalid feature effect 'filter'. A filter can only contain a 'where' property",{layer:e.layer,effect:this})),null}if("showExcludedLabels"in r)return e.messages?.push(new F("web-document-write:unsupported-feature-effect","Invalid value for property 'excludedLabelsVisible' which should always be 'true'",{layer:e.layer,effect:this})),null}return r}clone(){return new yP({filter:this.filter!=null?this.filter.clone():null,includedEffect:this.includedEffect,excludedEffect:this.excludedEffect,excludedLabelsVisible:this.excludedLabelsVisible})}};c([d({type:MPe,json:{write:{allowNull:!0,writer(t,e,r,i){const s=t?.write({},i);s&&Object.keys(s).length!==0?Cr(r,s,e):Cr(r,null,e)}}}})],Sh.prototype,"filter",void 0),c([d({json:{read:K0,write:{writer:Q0,allowNull:!0},origins:{"web-map":M6,"portal-item":M6}}})],Sh.prototype,"includedEffect",void 0),c([d({json:{read:K0,write:{writer:Q0,allowNull:!0},origins:{"web-map":T6,"portal-item":T6}}})],Sh.prototype,"excludedEffect",void 0),c([d({type:Boolean,json:{write:!0,name:"showExcludedLabels",origins:{"web-map":E6,"portal-item":E6}}})],Sh.prototype,"excludedLabelsVisible",void 0),Sh=yP=c([C("esri.layers.support.FeatureEffect")],Sh);const I6={write:{allowNull:!0}},TPe={type:Sh,json:{origins:{"web-map":I6,"portal-item":I6}}},EPe=t=>{let e=class extends t{constructor(){super(...arguments),this.featureEffect=null}};return c([d(TPe)],e.prototype,"featureEffect",void 0),e=c([C("esri.layers.mixins.FeatureEffectLayer")],e),e};var gP;let Dg=gP=class extends W{constructor(t){super(t)}async collectRequiredFields(t,e){return si(t,e,this.expression)}clone(){return new gP({expression:this.expression,title:this.title})}equals(t){return this.expression===t.expression&&this.title===t.title}};c([d({type:String,json:{write:{isRequired:!0}}})],Dg.prototype,"expression",void 0),c([d({type:String,json:{write:!0}})],Dg.prototype,"title",void 0),Dg=gP=c([C("esri.symbols.support.FeatureExpressionInfo")],Dg);const C6=Dg;function jje(t){return!!t&&j2[t]!=null}function Uje(t){return 1/(j2[t]||1)}function IPe(){const t=Object.keys(j2);return OP(t,"decimal-degrees"),t.sort(),t}const CPe=IPe();var vP;const u1=Wr()({onTheGround:"on-the-ground",relativeToGround:"relative-to-ground",relativeToScene:"relative-to-scene",absoluteHeight:"absolute-height"}),P6=new De({foot:"feet",kilometer:"kilometers",meter:"meters",mile:"miles","us-foot":"us-feet",yard:"yards"});var Jf;let nl=(Jf=class extends W{constructor(e){super(e),this.featureExpressionInfo=void 0,this.offset=null}readFeatureExpressionInfo(e,r){return e!=null?e.expression?e:void 0:r.featureExpression&&r.featureExpression.value===0?{expression:"0"}:void 0}writeFeatureExpressionInfo(e,r,i,s){r[i]=e.write({},s),e.expression==="0"&&(r.featureExpression={value:0})}get mode(){const{offset:e,featureExpressionInfo:r}=this;return this._isOverridden("mode")?this._get("mode"):e!=null||r?"relative-to-ground":"on-the-ground"}set mode(e){this._override("mode",e)}set unit(e){this._set("unit",e)}write(e,r){return this.offset||this.mode||this.featureExpressionInfo||this.unit?super.write(e,r):null}clone(){return new vP({mode:this.mode,offset:this.offset,featureExpressionInfo:this.featureExpressionInfo?this.featureExpressionInfo.clone():void 0,unit:this.unit})}equals(e){return this.mode===e.mode&&this.offset===e.offset&&this.unit===e.unit&&TX(this.featureExpressionInfo,e.featureExpressionInfo)}},vP=Jf,Jf);c([d({type:C6,json:{write:!0}})],nl.prototype,"featureExpressionInfo",void 0),c([K("featureExpressionInfo",["featureExpressionInfo","featureExpression"])],nl.prototype,"readFeatureExpressionInfo",null),c([re("featureExpressionInfo",{featureExpressionInfo:{type:C6},"featureExpression.value":{type:[0]}})],nl.prototype,"writeFeatureExpressionInfo",null),c([d({type:u1.apiValues,nonNullable:!0,json:{type:u1.jsonValues,read:u1.read,write:{writer:u1.write,isRequired:!0}}})],nl.prototype,"mode",null),c([d({type:Number,json:{write:!0}})],nl.prototype,"offset",void 0),c([d({type:CPe,json:{type:String,read:P6.read,write:P6.write}})],nl.prototype,"unit",null),nl=vP=c([C("esri.symbols.support.ElevationInfo")],nl);let zp=class extends W{constructor(e){super(e),this.description=null,this.label=null,this.type=null}};c([d({type:String,json:{write:!0}})],zp.prototype,"description",void 0),c([d({type:String,json:{write:!0}})],zp.prototype,"label",void 0),c([d()],zp.prototype,"type",void 0),zp=c([C("esri.tables.elements.AttributeTableElement")],zp);const Xm=zp;let zg=class extends Ce.ClonableMixin(Xm){constructor(e){super(e),this.displayType="auto",this.type="attachment"}clone(){return super.clone()}};c([d({type:["auto"],json:{write:!0}})],zg.prototype,"displayType",void 0),c([d({type:["attachment"],readOnly:!0,json:{read:!1,write:{enabled:!0,isRequired:!0}}})],zg.prototype,"type",void 0),zg=c([C("esri.tables.elements.AttributeTableAttachmentElement")],zg);const eJ=zg;let xh=class extends Ce.ClonableMixin(Xm){constructor(e){super(e),this.description=null,this.fieldName=null,this.label=null,this.type="field"}clone(){return super.clone()}};c([d({type:String,json:{read:!1,write:!1}})],xh.prototype,"description",void 0),c([d({type:String,json:{write:{enabled:!0,isRequired:!0}}})],xh.prototype,"fieldName",void 0),c([d({type:String,json:{read:!1,write:!1}})],xh.prototype,"label",void 0),c([d({type:["field"],readOnly:!0,json:{read:!1,write:{enabled:!0,isRequired:!0}}})],xh.prototype,"type",void 0),xh=c([C("esri.tables.elements.AttributeTableFieldElement")],xh);const tJ=xh;let Vg=class extends Ce.ClonableMixin(Xm){constructor(e){super(e),this.relationshipId=null,this.type="relationship"}clone(){return super.clone()}};c([d({type:Number,json:{type:qe,write:{enabled:!0,isRequired:!0}}})],Vg.prototype,"relationshipId",void 0),c([d({type:["relationship"],readOnly:!0,json:{read:!1,write:{enabled:!0,isRequired:!0}}})],Vg.prototype,"type",void 0),Vg=c([C("esri.tables.elements.AttributeTableRelationshipElement")],Vg);const rJ=Vg,iJ={base:Xm,key:"type",typeMap:{attachment:eJ,field:tJ,relationship:rJ}};function PPe(t){return{typesWithGroup:{base:Xm,key:"type",typeMap:{attachment:eJ,field:tJ,group:t,relationship:rJ}},typesWithoutGroup:iJ}}let jg=class extends Ce.ClonableMixin(Xm){constructor(e){super(e),this.elements=null,this.type="group"}clone(){return super.clone()}};c([d({types:[iJ],json:{name:"attributeTableElements",write:!0}})],jg.prototype,"elements",void 0),c([d({type:["group"],readOnly:!0,json:{read:!1,write:{enabled:!0,isRequired:!0}}})],jg.prototype,"type",void 0),jg=c([C("esri.tables.elements.AttributeTableGroupElement")],jg);const APe=jg;let Ug=class extends Ce.ClonableMixin(W){constructor(e){super(e),this.field=null,this.order=null}};c([d({type:String,json:{write:!0}})],Ug.prototype,"field",void 0),c([d({type:["asc","desc"],json:{write:!0}})],Ug.prototype,"order",void 0),Ug=c([C("esri.tables.support.FieldOrder")],Ug);const LPe=Ug;var _P;const RPe=PPe(APe);let Gg=_P=class extends W{constructor(t){super(t),this.elements=null,this.orderByFields=null}clone(){return new _P({elements:k(this.elements),orderByFields:k(this.orderByFields)})}};c([d({types:[RPe.typesWithGroup],json:{name:"attributeTableElements",write:!0}})],Gg.prototype,"elements",void 0),c([d({type:[LPe],json:{write:!0}})],Gg.prototype,"orderByFields",void 0),Gg=_P=c([C("esri.tables.AttributeTableTemplate")],Gg);const kPe=Gg,OPe={type:Boolean,value:!0,json:{origins:{service:{read:!1,write:!1},"web-map":{read:!1,write:!1}},name:"screenSizePerspective",write:{enabled:!0,layerContainerTypes:ft}}},sx={type:Boolean,value:!0,json:{name:"disablePopup",read:{reader:(t,e)=>!e.disablePopup},write:{enabled:!0,writer(t,e,r){e[r]=!t}}}},nx={type:Boolean,value:!0,nonNullable:!0,json:{name:"showLabels",write:{enabled:!0,layerContainerTypes:ft}}},NPe={type:String,json:{origins:{"portal-item":{write:!1}},write:{isRequired:!0,ignoreOrigin:!0,writer:hd}}},FPe={type:Boolean,value:!0,nonNullable:!0,json:{origins:{service:{read:{enabled:!1}}},name:"showLegend",write:{enabled:!0,layerContainerTypes:ft}}},DPe={value:null,type:nl,json:{origins:{service:{name:"elevationInfo",write:!0}},name:"layerDefinition.elevationInfo",write:{enabled:!0,layerContainerTypes:ft}}};function Jje(t){return{type:t,readOnly:!0,json:{origins:{service:{read:!0}},read:!1}}}const sJ={write:{enabled:!0,layerContainerTypes:ft},read:!0},bP={type:Number,json:{origins:{"web-document":sJ,"portal-item":{write:{layerContainerTypes:ft}}}}},zPe={...bP,json:{...bP.json,origins:{"web-document":{...sJ,write:{enabled:!0,layerContainerTypes:ft,target:{opacity:{type:Number},"layerDefinition.drawingInfo.transparency":{type:Number}}}}},read:{source:["layerDefinition.drawingInfo.transparency","drawingInfo.transparency"],reader:(t,e,r)=>r&&r.origin!=="service"||!e.drawingInfo||e.drawingInfo.transparency===void 0?e.layerDefinition?.drawingInfo&&e.layerDefinition.drawingInfo.transparency!==void 0?k0(e.layerDefinition.drawingInfo.transparency):void 0:k0(e.drawingInfo.transparency)}}},Yje={type:Le,readOnly:!0,json:{origins:{service:{read:{source:["fullExtent","spatialReference"],reader:(t,e)=>{const r=Le.fromJSON(t);return e.spatialReference!=null&&typeof e.spatialReference=="object"&&(r.spatialReference=ne.fromJSON(e.spatialReference)),r}}}},read:!1}},VPe={type:String,json:{origins:{service:{read:!1},"portal-item":{read:!1}}}},jPe={type:Number,json:{origins:{service:{write:{enabled:!1}}},name:"layerDefinition.minScale",write:{layerContainerTypes:ft}}},UPe={type:Number,json:{origins:{service:{write:{enabled:!1}}},name:"layerDefinition.maxScale",write:{layerContainerTypes:ft}}},nJ={json:{write:{ignoreOrigin:!0,layerContainerTypes:ft},origins:{"web-map":{read:!1,write:!1}}}},GPe={type:kPe,json:{name:"attributeTableInfo",write:!0}};let ol=class extends Ce.ClonableMixin(W){constructor(e){super(e),this.creatorField=null,this.creationDateField=null,this.editorField=null,this.editDateField=null,this.realm=null,this.timeZone=null}};c([d()],ol.prototype,"creatorField",void 0),c([d()],ol.prototype,"creationDateField",void 0),c([d()],ol.prototype,"editorField",void 0),c([d()],ol.prototype,"editDateField",void 0),c([d()],ol.prototype,"realm",void 0),c([d(ww("dateFieldsTimeReference",!0))],ol.prototype,"timeZone",void 0),ol=c([C("esri.layers.support.EditFieldsInfo")],ol);let Lo=class extends Ce.ClonableMixin(W){constructor(e){super(e)}};c([d({constructOnly:!0,json:{write:!0}})],Lo.prototype,"name",void 0),c([d({constructOnly:!0,json:{write:!0}})],Lo.prototype,"fields",void 0),c([d({constructOnly:!0,json:{write:!0}})],Lo.prototype,"isAscending",void 0),c([d({constructOnly:!0,json:{write:!0}})],Lo.prototype,"indexType",void 0),c([d({constructOnly:!0,json:{write:!0}})],Lo.prototype,"isUnique",void 0),c([d({constructOnly:!0,json:{write:!0}})],Lo.prototype,"description",void 0),Lo=c([C("esri.layers.support.FeatureIndex")],Lo);async function BPe(t,e,r){e=e.clone(),t.capabilities.query.supportsMaxRecordCountFactor&&(e.maxRecordCountFactor=oJ(t));const i=qPe(t),s=t.capabilities.query.supportsPagination;e.start=0,e.num=i;let n=null;for(;;){const o=await t.source.queryFeaturesJSON(e,r);if(n==null?n=o:n.features=n.features.concat(o.features),n.exceededTransferLimit=o.exceededTransferLimit,!s||!o.exceededTransferLimit)break;e.start+=i}return n}function qPe(t){return oJ(t)*HPe(t)}function HPe(t){return t.capabilities.query.maxRecordCount||2e3}function oJ(t){return t.capabilities.query.supportsMaxRecordCountFactor?me.MAX_MAX_RECORD_COUNT_FACTOR:1}var wP,Yf;let $r=(Yf=class extends W{constructor(e){super(e),this.attachmentTypes=null,this.attachmentsWhere=null,this.cacheHint=void 0,this.keywords=null,this.globalIds=null,this.name=null,this.num=null,this.objectIds=null,this.orderByFields=null,this.returnMetadata=!1,this.size=null,this.start=null,this.where=null}writeStart(e,r){r.resultOffset=this.start,r.resultRecordCount=this.num||10}clone(){return new wP(k({attachmentTypes:this.attachmentTypes,attachmentsWhere:this.attachmentsWhere,cacheHint:this.cacheHint,keywords:this.keywords,where:this.where,globalIds:this.globalIds,name:this.name,num:this.num,objectIds:this.objectIds,orderByFields:this.orderByFields,returnMetadata:this.returnMetadata,size:this.size,start:this.start}))}},wP=Yf,Yf);c([d({type:[String],json:{write:!0}})],$r.prototype,"attachmentTypes",void 0),c([d({type:String,json:{read:{source:"attachmentsDefinitionExpression"},write:{target:"attachmentsDefinitionExpression"}}})],$r.prototype,"attachmentsWhere",void 0),c([d({type:Boolean,json:{write:!0}})],$r.prototype,"cacheHint",void 0),c([d({type:[String],json:{write:!0}})],$r.prototype,"keywords",void 0),c([d({type:[String],json:{write:!0}})],$r.prototype,"globalIds",void 0),c([d({json:{write:!0}})],$r.prototype,"name",void 0),c([d({type:Number,json:{read:{source:"resultRecordCount"}}})],$r.prototype,"num",void 0),c([d({type:[Number],json:{write:!0}})],$r.prototype,"objectIds",void 0),c([d({type:[String],json:{write:!0}})],$r.prototype,"orderByFields",void 0),c([d({type:Boolean,json:{default:!1,write:!0}})],$r.prototype,"returnMetadata",void 0),c([d({type:[Number],json:{write:!0}})],$r.prototype,"size",void 0),c([d({type:Number,json:{read:{source:"resultOffset"}}})],$r.prototype,"start",void 0),c([re("start"),re("num")],$r.prototype,"writeStart",null),c([d({type:String,json:{read:{source:"definitionExpression"},write:{target:"definitionExpression"}}})],$r.prototype,"where",void 0),$r=wP=c([C("esri.rest.support.AttachmentQuery")],$r),$r.from=br($r);const aJ=Wr()({naturalLog:"natural-log",squareRoot:"square-root",percentOfTotal:"percent-of-total",log:"log",field:"field"}),A6="percent-of-total",L6="field",Qje=t=>{let e=class extends t{constructor(){super(...arguments),this.normalizationField=null,this.normalizationMaxValue=null,this.normalizationMinValue=null,this.normalizationTotal=null}get normalizationType(){let r=this._get("normalizationType");const i=!!this.normalizationField,s=this.normalizationTotal!=null;return i||s?(r=i&&L6||s&&A6||null,i&&s&&q.getLogger(this).warn("warning: both normalizationField and normalizationTotal are set!")):r!==L6&&r!==A6||(r=null),r}set normalizationType(r){this._set("normalizationType",r)}};return c([d({type:String,json:{name:"parameters.normalizationField",write:!0}})],e.prototype,"normalizationField",void 0),c([d({type:Number,json:{name:"parameters.normalizationMaxValue",write:!0}})],e.prototype,"normalizationMaxValue",void 0),c([d({type:Number,json:{name:"parameters.normalizationMinValue",write:!0}})],e.prototype,"normalizationMinValue",void 0),c([d({type:Number,json:{name:"parameters.normalizationTotal",write:!0}})],e.prototype,"normalizationTotal",void 0),c([ye(aJ,{name:"parameters.normalizationType"})],e.prototype,"normalizationType",null),e=c([C("esri.rest.support.NormalizationBinParametersMixin")],e),e};var SP,Xf;let bt=(Xf=class extends W{constructor(e){super(e),this.cacheHint=void 0,this.dynamicDataSource=void 0,this.gdbVersion=null,this.geometryPrecision=void 0,this.historicMoment=null,this.maxAllowableOffset=void 0,this.objectIds=null,this.orderByFields=null,this.outFields=null,this.outSpatialReference=null,this.relationshipId=void 0,this.start=void 0,this.num=void 0,this.returnGeometry=!1,this.returnM=void 0,this.returnZ=void 0,this.where=null}_writeHistoricMoment(e,r){r.historicMoment=e&&e.getTime()}writeStart(e,r){r.resultOffset=this.start,r.resultRecordCount=this.num||10,this.start>0&&this.where==null&&(r.definitionExpression="1=1")}clone(){return new SP(k({cacheHint:this.cacheHint,dynamicDataSource:this.dynamicDataSource,gdbVersion:this.gdbVersion,geometryPrecision:this.geometryPrecision,historicMoment:this.historicMoment&&new Date(this.historicMoment.getTime()),maxAllowableOffset:this.maxAllowableOffset,objectIds:this.objectIds,orderByFields:this.orderByFields,outFields:this.outFields,outSpatialReference:this.outSpatialReference,relationshipId:this.relationshipId,start:this.start,num:this.num,returnGeometry:this.returnGeometry,where:this.where,returnZ:this.returnZ,returnM:this.returnM}))}},SP=Xf,Xf);c([d({type:Boolean,json:{write:!0}})],bt.prototype,"cacheHint",void 0),c([d({type:Hn,json:{write:!0}})],bt.prototype,"dynamicDataSource",void 0),c([d({type:String,json:{write:!0}})],bt.prototype,"gdbVersion",void 0),c([d({type:Number,json:{write:!0}})],bt.prototype,"geometryPrecision",void 0),c([d({type:Date})],bt.prototype,"historicMoment",void 0),c([re("historicMoment")],bt.prototype,"_writeHistoricMoment",null),c([d({type:Number,json:{write:!0}})],bt.prototype,"maxAllowableOffset",void 0),c([d({json:{write:!0}})],bt.prototype,"objectIds",void 0),c([d({type:[String],json:{write:!0}})],bt.prototype,"orderByFields",void 0),c([d({type:[String],json:{write:!0}})],bt.prototype,"outFields",void 0),c([d({type:ne,json:{read:{source:"outSR"},write:{target:"outSR"}}})],bt.prototype,"outSpatialReference",void 0),c([d({json:{write:!0}})],bt.prototype,"relationshipId",void 0),c([d({type:Number,json:{read:{source:"resultOffset"}}})],bt.prototype,"start",void 0),c([re("start"),re("num")],bt.prototype,"writeStart",null),c([d({type:Number,json:{read:{source:"resultRecordCount"}}})],bt.prototype,"num",void 0),c([d({json:{write:!0}})],bt.prototype,"returnGeometry",void 0),c([d({type:Boolean,json:{write:{overridePolicy:t=>({enabled:t})}}})],bt.prototype,"returnM",void 0),c([d({type:Boolean,json:{write:{overridePolicy:t=>({enabled:t})}}})],bt.prototype,"returnZ",void 0),c([d({type:String,json:{read:{source:"definitionExpression"},write:{target:"definitionExpression"}}})],bt.prototype,"where",void 0),bt=SP=c([C("esri.rest.support.RelationshipQuery")],bt),bt.from=br(bt);const e8e=Object.freeze(Object.defineProperty({__proto__:null,get default(){return bt}},Symbol.toStringTag,{value:"Module"})),xP=new De({esriGeometryPoint:"point",esriGeometryMultipoint:"multipoint",esriGeometryPolyline:"polyline",esriGeometryPolygon:"polygon",esriGeometryMultiPatch:"multipatch"});async function WPe(t,e,r,i){const s=await $c(t);if(await kL(t,e,i),!s.addAttachment)throw new F(i,"Layer source does not support addAttachment capability");return s.addAttachment(e,r)}function kL(t,e,r){const{attributes:i}=e,{objectIdField:s}=t;return t.capabilities?.data?.supportsAttachment?e?i?s&&i[s]?Promise.resolve():Promise.reject(new F(r,`feature is missing the identifying attribute ${s}`)):Promise.reject(new F(r,"'attributes' are required on a feature to query attachments")):Promise.reject(new F(r,"A feature is required to add/delete/update attachments")):Promise.reject(new F(r,"this layer doesn't support attachments"))}async function ZPe(t,e,r,i,s){const n=await $c(t);if(await kL(t,e,s),!n.updateAttachment)throw new F(s,"Layer source does not support updateAttachment capability");return n.updateAttachment(e,r,i)}async function JPe(t,e,r){const{applyEdits:i}=await J(()=>import("./editingSupport-DzVNRpoc.js"),[]),s=await t.load();let n=r;return s.type==="feature"&&s.infoFor3D&&e.deleteFeatures!=null&&s.globalIdField!=null&&(n={...n,globalIdToObjectId:await g3e(s,e.deleteFeatures,s.globalIdField)}),i(s,s.source,e,r)}async function YPe(t,e,r){const{uploadAssets:i}=await J(()=>import("./editingSupport-DzVNRpoc.js"),[]),s=await t.load();return i(s,s.source,e,r)}async function XPe(t,e,r,i){const s=await $c(t);if(await kL(t,e,i),!s.deleteAttachments)throw new F(i,"Layer source does not support deleteAttachments capability");return s.deleteAttachments(e,r)}async function KPe(t,e,r){const i=(await t.load({signal:e?.signal})).source;if(!i.fetchRecomputedExtents)throw new F(r,"Layer source does not support fetchUpdates capability");return i.fetchRecomputedExtents(e)}async function QPe(t,e,r,i){e=$r.from(e),await t.load();const s=t.source,n=t.capabilities;if(!n?.data?.supportsAttachment)throw new F(i,"this layer doesn't support attachments");const{attachmentTypes:o,objectIds:a,globalIds:l,num:u,size:h,start:p,where:m}=e;if(!n?.operations?.supportsQueryAttachments&&(o?.length>0||l?.length>0||h?.length>0||u||p||m))throw new F(i,"when 'capabilities.operations.supportsQueryAttachments' is false, only objectIds is supported",e);if(!(a?.length||l?.length||m))throw new F(i,"'objectIds', 'globalIds', or 'where' are required to perform attachment query",e);if(!s.queryAttachments)throw new F(i,"Layer source does not support queryAttachments capability",e);return!n?.attachment?.supportsOrderByFields&&e.orderByFields?.length&&((e=e.clone()).orderByFields=null),s.queryAttachments(e)}async function e3e(t,e,r,i){const s=await $c(t);if(!s.queryObjectIds)throw new F(i,"Layer source does not support queryObjectIds capability");return s.queryObjectIds(me.from(e)??t.createQuery(),r)}async function t3e(t,e,r,i){const s=await $c(t);if(!s.queryFeatureCount)throw new F(i,"Layer source does not support queryFeatureCount capability");return s.queryFeatureCount(me.from(e)??t.createQuery(),r)}async function r3e(t,e,r,i){const s=await $c(t);if(!s.queryExtent)throw new F(i,"Layer source does not support queryExtent capability");return s.queryExtent(me.from(e)??t.createQuery(),r)}async function i3e(t,e,r,i){const s=await $c(t);if(!s.queryRelatedFeatures)throw new F(i,"Layer source does not support queryRelatedFeatures capability");return s.queryRelatedFeatures(bt.from(e),r)}async function s3e(t,e,r,i){const s=await $c(t);if(!s.queryRelatedFeaturesCount)throw new F(i,"Layer source does not support queryRelatedFeaturesCount capability");return s.queryRelatedFeaturesCount(bt.from(e),r)}async function n3e(t){const e=t.source;if(e?.refresh)try{const{dataChanged:r,updates:i}=await e.refresh();if(i!=null&&(t.sourceJSON={...t.sourceJSON,...i},t.read(i,{origin:"service",url:t.parsedUrl})),r)return!0}catch{}if(t.definitionExpression)try{return(await oA(t.definitionExpression,t.fieldsIndex)).hasDateFunctions}catch{}return!1}function o3e(t){const e=new me;e.historicMoment=t.historicMoment,e.gdbVersion=t.gdbVersion,e.returnGeometry=!0,e.outFields=["*"],e.multipatchOption=t.geometryType==="multipatch"?"xyFootprint":null;const r=t.capabilities?.query;r&&(e.compactGeometryEnabled=r.supportsCompactGeometry,e.defaultSpatialReferenceEnabled=r.supportsDefaultSpatialReference);const i=t.capabilities?.data;i?.supportsZ&&t.returnZ!=null&&(e.returnZ=t.returnZ),i?.supportsM&&t.returnM!=null&&(e.returnM=t.returnM);const{timeOffset:s,timeExtent:n}=t;return e.timeExtent=s!=null&&n!=null?n.offset(-s.value,s.unit):n||null,e}function lJ(t){const{globalIdField:e,fields:r}=t;if(e)return e;if(r){for(const i of r)if(i.type==="esriFieldTypeGlobalID")return i.name}}function uJ(t){const{objectIdField:e,fields:r}=t;if(e)return e;if(r){for(const i of r)if(i.type==="esriFieldTypeOID")return i.name}}function a3e(t){return t.currentVersion?t.currentVersion:t.hasOwnProperty("capabilities")||t.hasOwnProperty("drawingInfo")||t.hasOwnProperty("hasAttachments")||t.hasOwnProperty("htmlPopupType")||t.hasOwnProperty("relationships")||t.hasOwnProperty("timeInfo")||t.hasOwnProperty("typeIdField")||t.hasOwnProperty("types")?10:9.3}function l3e(t,e,r,i){const s=r?.feature,n=!!t.subtypes?.length;if(n&&!r?.excludeImpliedDomains){const l=c3e(t,e);if(l)return l}const o=n&&u3e(t,s);if(o){const l=o?.domains?.[e];return l?.type==="inherited"?i:l}const a=dJ(t.types,t.typeIdField,s);if(a){const l=a.domains&&a.domains[e];if(l&&l?.type!=="inherited")return l}if(i)return i;if(!r?.excludeImpliedDomains){const l=h3e(t,e);if(l)return l}return null}function u3e(t,e){const{subtypes:r,subtypeField:i}=t;if(!e?.attributes||!r?.length||!i)return null;const s=e.attributes[i];return s==null?null:r.find((n=>n.code===s))}function c3e(t,e){const{fieldsIndex:r,subtypeField:i}=t,{name:s,type:n}=r.get(e)??{};if(!s)return null;if((i&&r.get(i)?.name)===s&&t.subtypes?.length){const o=t.subtypes.map((a=>new Vh({code:cJ(a.code,n),name:a.name})));if(o?.length)return new Ju({codedValues:o})}return null}function h3e(t,e){const{fieldsIndex:r}=t,{name:i,type:s}=r.get(e)??{};if(!i)return null;if(("typeIdField"in t?r.get(t.typeIdField)?.name:null)===i&&"types"in t&&t.types?.length){const n=t.types.map((o=>new Vh({code:cJ(o.id,s),name:o.name})));return new Ju({codedValues:n})}return null}function cJ(t,e){return e?oG({type:e})&&typeof t=="number"?`${t}`:Oce({type:e})&&typeof t=="string"?Number.parseInt(t,10):t:t}async function $c(t){return(await t.load()).source}async function t8e(t,e){if(!Ve)return;const r=Ve.findCredential(t);if(r)return r.userId;let i;try{const s=await z3(t,e);s&&(i=await Ve.checkSignInStatus(`${s}/sharing`))}catch{}return i?i.userId:null}async function hJ(t,e){if(!Ve||Ve.findCredential(t))return;let r;try{const i=await z3(t,e);i&&(r=await Ve.checkSignInStatus(`${i}/sharing`))}catch{}if(r)try{const i=e!=null?e.signal:null;await Ve.getCredential(t,{signal:i})}catch{}}async function d3e(t,e,r){const i=t.parsedUrl?.path;i&&t.authenticationTriggerEvent===e&&await hJ(i,r)}async function r8e(t){const e=t.parsedUrl?.path;e&&p3e(t)&&await hJ(e)}function p3e(t){return f3e(t)&&("serviceDefinitionExpression"in t&&OS(t.serviceDefinitionExpression)||"definitionExpression"in t&&OS(t.definitionExpression))}function f3e(t){return!(!R8(t)||!t.capabilities?.query.supportsCurrentUser)}function OS(t){return!!t?.toLowerCase().includes("current_user")}function m3e(t){return!jb(t)&&(t.userHasUpdateItemPrivileges||t.editingEnabled)}const oM=Om({types:NG});function OL(t,e){if(t.defaultSymbol)return t.types?.length?new mt({defaultSymbol:oM(t.defaultSymbol,t,e),field:t.typeIdField,uniqueValueInfos:t.types.map((r=>({id:r.id,symbol:oM(r.symbol,r,e)})))}):new ji({symbol:oM(t.defaultSymbol,t,e)})}function y3e(t){let e=t.sourceJSON?.cacheMaxAge;if(!e)return!1;const r=t.editingInfo?.lastEditDate?.getTime();return r==null||(e*=1e3,Date.now()-r<e)}async function g3e(t,e,r){if(e==null)return null;const i=[],{objectIdField:s}=t;if(e.forEach((u=>{let h=null;if("attributes"in u){const{attributes:p}=u;h={globalId:p[r],objectId:p[s]!=null&&p[s]!==-1?p[s]:null}}else h={globalId:u.globalId,objectId:u.objectId!=null&&u.objectId!==-1?u.objectId:null};h.globalId!=null&&(h.objectId!=null&&h.objectId!==-1||i.push(h.globalId))})),i.length===0)return null;const n=t.createQuery();n.where=i.map((u=>`${r}='${u}'`)).join(" OR "),n.returnGeometry=!1,n.outFields=[s,r],n.cacheHint=!1;const o=await lee(BPe(t,n));if(!o.ok)return null;const a=new Map,l=o.value.features;for(const u of l){const h=u.attributes[r],p=u.attributes[s];h!=null&&p!=null&&p!==-1&&a.set(Tse(h),p)}return a}function dJ(t,e,r){if(!e||!r||!t)return null;const i=r.getAttribute(e);return i==null?null:t.find((s=>{const{id:n}=s;return n!=null&&n.toString()===i.toString()}))??null}function jb(t){return t.sourceJSON?.isMultiServicesView||v3e(t)}function v3e(t){return!!t.sourceJSON?.capabilities?.toLowerCase().split(",").map((e=>e.trim())).includes("map")}function _3e(t,e,r){const i=e?.queryAttributeBins;if(!e?.operations?.supportsQueryBins||!i)throw new F(r,"Layer source does not support binning");switch(t.binParameters.type){case"auto-interval":if(!i.supportsAutoInterval)throw new F(r,"Layer source does not support auto-interval binning");if(t.binParameters.normalizationType&&(!i.supportsNormalization||!R6(t.binParameters.normalizationType,i.supportedNormalizationTypes)))throw new F(r,"Layer source does not support normalization binning");break;case"date":if(!i.supportsDate)throw new F(r,"Layer source does not support date binning");if(t.binParameters.snapToData&&!i.supportsSnapToData)throw new F(r,"Layer source does not support snapToData binning");if(t.binParameters.returnFullIntervalBin&&!i.supportsReturnFullIntervalBin)throw new F(r,"Layer source does not support returnFullIntervalBin binning");break;case"fixed-boundaries":if(!i.supportsFixedBoundaries)throw new F(r,"Layer source does not support fixed-boundaries binning");break;case"fixed-interval":if(!i.supportsFixedInterval)throw new F(r,"Layer source does not support fixed-interval binning");if(t.binParameters.normalizationType&&(!i.supportsNormalization||!R6(t.binParameters.normalizationType,i.supportedNormalizationTypes)))throw new F(r,"Layer source does not support normalization binning")}if(t.binParameters.stackBy&&!i.supportsStackBy)throw new F(r,"Layer source does not support stackBy binning");if(t.binParameters.splitBy&&!i.supportsSplitBy)throw new F(r,"Layer source does not support splitBy binning");if(t.binParameters.firstDayOfWeek&&!i.supportsFirstDayOfWeek)throw new F(r,"Layer source does not support firstDayOfWeek binning");const s=i?.supportedStatistics;if(t.outStatistics&&s){const n=new Map([["count","count"],["sum","sum"],["min","min"],["max","max"],["avg","avg"],["stddev","stddev"],["var","var"],["percentile-continuous","percentileContinuous"],["percentile-discrete","percentileDiscrete"],["centroid-aggregate","centroid"],["convex-hull-aggregate","convexHull"],["envelope-aggregate","envelope"]]);for(const{statisticType:o}of t.outStatistics){const a=n.get(o);if(a&&!s[a])throw new F(r,`Layer source does not support ${o} statistic type`)}}}function R6(t,e){return t!=null&&!!e?.[aJ.toJSON(t)]}let Vp=class extends Ce.ClonableMixin(W){constructor(e){super(e),this.shapeAreaField=null,this.shapeLengthField=null,this.units=null}};c([d({type:String,json:{read:{source:"shapeAreaFieldName"}}})],Vp.prototype,"shapeAreaField",void 0),c([d({type:String,json:{read:{source:"shapeLengthFieldName"}}})],Vp.prototype,"shapeLengthField",void 0),c([d({type:String,json:{read:t=>Uee.read(t)||Gee.read(t)}})],Vp.prototype,"units",void 0),Vp=c([C("esri.layers.support.GeometryFieldsInfo")],Vp);var $P;let jp=$P=class extends W{constructor(t){super(t),this.floorField=null,this.viewAllMode=!1,this.viewAllLevelIds=new se}clone(){return new $P({floorField:this.floorField,viewAllMode:this.viewAllMode,viewAllLevelIds:this.viewAllLevelIds})}};c([d({type:String,json:{write:{isRequired:!0}}})],jp.prototype,"floorField",void 0),c([d({json:{read:!1,write:!1}})],jp.prototype,"viewAllMode",void 0),c([d({json:{read:!1,write:!1}})],jp.prototype,"viewAllLevelIds",void 0),jp=$P=c([C("esri.layers.support.LayerFloorInfo")],jp);const k6=new De({esriRelCardinalityOneToOne:"one-to-one",esriRelCardinalityOneToMany:"one-to-many",esriRelCardinalityManyToMany:"many-to-many"}),O6=new De({esriRelRoleOrigin:"origin",esriRelRoleDestination:"destination"});let Es=class extends Ce.ClonableMixin(W){constructor(e){super(e),this.cardinality=null,this.catalogId=null,this.composite=null,this.id=null,this.keyField=null,this.keyFieldInRelationshipTable=null,this.name=null,this.relatedTableId=null,this.relationshipTableId=null,this.role=null}};c([d({json:{read:k6.read,write:k6.write}})],Es.prototype,"cardinality",void 0),c([d({json:{name:"catalogID"}})],Es.prototype,"catalogId",void 0),c([d({json:{read:!0,write:!0}})],Es.prototype,"composite",void 0),c([d({json:{read:!0,write:!0}})],Es.prototype,"id",void 0),c([d({json:{read:!0,write:!0}})],Es.prototype,"keyField",void 0),c([d({json:{read:!0,write:!0}})],Es.prototype,"keyFieldInRelationshipTable",void 0),c([d({json:{read:!0,write:!0}})],Es.prototype,"name",void 0),c([d({json:{read:!0,write:!0}})],Es.prototype,"relatedTableId",void 0),c([d({json:{read:!0,write:!0}})],Es.prototype,"relationshipTableId",void 0),c([d({json:{read:O6.read,write:O6.write}})],Es.prototype,"role",void 0),Es=c([C("esri.layers.support.Relationship")],Es);const b3e=[["binary","application/octet-stream","bin",""]];function n8e(t,e){return yJ(e.name,t?.supportedFormats??[])!=null}function o8e(t,e){if(!t)return!1;const r=w3e(e,t.supportedFormats??[]);return r!=null&&t.editFormats.includes(r)}function pJ(t,e){return FL(M3e(t,e))}function fJ(t,e){return FL(yJ(t,e))}function a8e(t,e){return gJ($3e(t,e))}function w3e(t,e){return fJ(t.name,e)??pJ(t.type,e)}function ox(t,e,r){return pJ(t,r)??fJ(e,r)}function mJ({supportedFormats:t}){return ox("model/gltf-binary","glb",t)}function l8e(t){const e=mJ(t);return e!=null&&t.editFormats.includes(e)}function S3e({supportedFormats:t}){return ox("model/gltf+json","gltf",t)}function x3e(t){if(!t)return null;const e=mJ(t),r=S3e(t);let i=null;for(const s of t.queryFormats){if(s===e)return s;s===r&&(i=s)}return i}function u8e({supportedFormats:t}){return ox("application/esri3do-SR_world","wld",t)}function c8e({supportedFormats:t}){return ox("application/esri3do-SR_prj","prj",t)}function NL(t){return[...b3e,...t]}function $3e(t,e){return NL(e).find((r=>FL(r)===t))}function M3e(t,e){const r=t.toLowerCase();return NL(e).find((i=>gJ(i)===r))}function yJ(t,e){const r=t.toLowerCase();return NL(e).find((i=>T3e(i).some((s=>r.endsWith(s)))))}function FL(t){return t?.[0]}function gJ(t){return t?.[1].toLowerCase()}function T3e(t){return t?.[2].split(",").map((e=>e.toLowerCase()))??[]}function h8e(t){return t.tables?.find((e=>e.role==="assetMaps"))}function oe(t,e,r){return!!vJ(t,e,r)}function Up(t,e,r){return vJ(t,e,r)}function vJ(t,e,r){return t&&t.hasOwnProperty(e)?t[e]:r}const E3e={name:"supportsName",size:"supportsSize",contentType:"supportsContentType",keywords:"supportsKeywords",exifInfo:"supportsExifInfo"};function I3e(t){const e=t?.supportedSpatialAggregationStatistics?.map((r=>r.toLowerCase()));return{envelope:!!e?.includes("envelopeaggregate"),centroid:!!e?.includes("centroidaggregate"),convexHull:!!e?.includes("convexhullaggregate")}}function Xv(t,e){return!!t?.supportedOperationsWithCacheHint?.map((i=>i.toLowerCase()))?.includes(e.toLowerCase())}function C3e(t){const e=t?.supportedStatisticTypes?.map((r=>r.toLowerCase()));return{count:!!e?.includes("count"),sum:!!e?.includes("sum"),min:!!e?.includes("min"),max:!!e?.includes("max"),avg:!!e?.includes("avg"),var:!!e?.includes("var"),stddev:!!e?.includes("stddev"),percentileContinuous:!!e?.includes("percentile_cont"),percentileDiscrete:!!e?.includes("percentile_disc"),envelope:!!e?.includes("envelopeaggregate"),centroid:!!e?.includes("centroidaggregate"),convexHull:!!e?.includes("convexhullaggregate")}}function P3e(t){const e=t?.supportedNormalizationTypes?.map((r=>r.toLowerCase()));return{field:!!e?.includes("field"),log:!!e?.includes("log"),naturalLog:!!e?.includes("naturallog"),percentOfTotal:!!e?.includes("percentoftotal"),squareRoot:!!e?.includes("squareroot")}}function _J(t,e){return{analytics:A3e(t),attachment:L3e(t),data:R3e(t),metadata:k3e(t),operations:O3e(t.capabilities,t,e),query:N3e(t,e),queryAttributeBins:z3e(t),queryRelated:F3e(t),queryTopFeatures:D3e(t),editing:V3e(t)}}function A3e(t){return{supportsCacheHint:Xv(t.advancedQueryCapabilities,"queryAnalytics")}}function L3e(t){const e=t.attachmentProperties,r={supportsName:!1,supportsSize:!1,supportsContentType:!1,supportsKeywords:!1,supportsExifInfo:!1,supportsCacheHint:Xv(t.advancedQueryCapabilities,"queryAttachments"),supportsOrderByFields:oe(t.advancedQueryCapabilities,"supportsQueryAttachmentOrderByFields",!1),supportsResize:oe(t,"supportsAttachmentsResizing",!1)};return e&&Array.isArray(e)&&e.forEach((i=>{const s=E3e[i.name];s&&(r[s]=!!i.isEnabled)})),r}function R3e(t){return{isVersioned:oe(t,"isDataVersioned",!1),isBranchVersioned:oe(t,"isDataBranchVersioned",!1),supportsAttachment:oe(t,"hasAttachments",!1),supportsM:oe(t,"hasM",!1),supportsZ:oe(t,"hasZ",!1)}}function k3e(t){return{supportsAdvancedFieldProperties:oe(t,"supportsFieldDescriptionProperty",!1)}}function O3e(t,e,r){const i=t?.toLowerCase().split(",").map((m=>m.trim()))??[],s=r?vc(r):null,n=i.includes(s?.serverType==="MapServer"?"data":"query"),o=i.includes("editing")&&!e.datesInUnknownTimezone&&e.uniqueIdInfo?.OIDFieldContainsHashValue!==!0;let a=o&&i.includes("create"),l=o&&i.includes("delete"),u=o&&i.includes("update");const h=i.includes("changetracking"),p=e.advancedQueryCapabilities;return o&&!(a||l||u)&&(a=l=u=!0),{supportsCalculate:oe(e,"supportsCalculate",!1),supportsTruncate:oe(e,"supportsTruncate",!1),supportsValidateSql:oe(e,"supportsValidateSql",!1),supportsAdd:a,supportsDelete:l,supportsEditing:o,supportsChangeTracking:h,supportsQuery:n,supportsQueryAnalytics:oe(p,"supportsQueryAnalytic",!1),supportsQueryAttachments:oe(p,"supportsQueryAttachments",!1),supportsQueryBins:oe(p,"supportsQueryBins",!1)||!!e.queryBinsCapabilities,supportsQueryTopFeatures:oe(p,"supportsTopFeaturesQuery",!1),supportsResizeAttachments:oe(e,"supportsAttachmentsResizing",!1),supportsSync:i.includes("sync"),supportsUpdate:u,supportsExceedsLimitStatistics:oe(e,"supportsExceedsLimitStatistics",!1),supportsAsyncConvert3D:oe(e,"supportsAsyncConvert3D",!1)}}function N3e(t,e){const r=t.advancedQueryCapabilities,i=t.ownershipBasedAccessControlForFeatures,s=t.archivingInfo,n=t.currentVersion,o=e?.includes("MapServer"),a=!o||n>=z("mapserver-pbf-version-support"),l=qb(e),u=new Set((t.supportedQueryFormats??"").split(",").map((h=>h.toLowerCase().trim())));return{maxRecordCount:Up(t,"maxRecordCount",void 0),maxRecordCountFactor:Up(t,"maxRecordCountFactor",void 0),maxUniqueIDCount:Up(t,"maxUniqueIDCount",void 0),standardMaxRecordCount:Up(t,"standardMaxRecordCount",void 0),supportedSpatialAggregationStatistics:I3e(r),supportsCacheHint:oe(r,"supportsQueryWithCacheHint",!1)||Xv(r,"query"),supportsCentroid:oe(r,"supportsReturningGeometryCentroid",!1),supportsCompactGeometry:l,supportsCurrentUser:oe(r,"supportsCurrentUserQueries",!1),supportsDefaultSpatialReference:oe(r,"supportsDefaultSR",!1),supportsDisjointSpatialRelationship:oe(r,"supportsDisjointSpatialRel",!1),supportsDistance:oe(r,"supportsQueryWithDistance",!1),supportsDistinct:oe(r,"supportsDistinct",t.supportsAdvancedQueries),supportsExtent:oe(r,"supportsReturningQueryExtent",!1),supportsFormatPBF:a&&u.has("pbf"),supportsFullTextSearch:oe(r,"supportsFullTextSearch",!1),supportsGeometryProperties:oe(r,"supportsReturningGeometryProperties",!1),supportsHavingClause:oe(r,"supportsHavingClause",!1),supportsHistoricMoment:oe(s,"supportsQueryWithHistoricMoment",!1),supportsMaxRecordCountFactor:oe(r,"supportsMaxRecordCountFactor",!1),supportsOrderBy:oe(r,"supportsOrderBy",t.supportsAdvancedQueries),supportsPagination:oe(r,"supportsPagination",!1),supportsPaginationOnAggregatedQueries:oe(r,"supportsPaginationOnAggregatedQueries",!1),supportsPercentileStatistics:oe(r,"supportsPercentileStatistics",!1),supportsQuantization:oe(t,"supportsCoordinatesQuantization",!1),supportsQuantizationEditMode:oe(t,"supportsQuantizationEditMode",!1),supportsQueryByAnonymous:oe(i,"allowAnonymousToQuery",!0),supportsQueryByOthers:oe(i,"allowOthersToQuery",!0),supportsQueryGeometry:oe(t,"supportsReturningQueryGeometry",!1),supportsResultType:oe(r,"supportsQueryWithResultType",!1),supportsReturnMesh:!!x3e(t.infoFor3D),supportsSpatialAggregationStatistics:oe(r,"supportsSpatialAggregationStatistics",!1),supportsSqlExpression:oe(r,"supportsSqlExpression",!1),supportsStandardizedQueriesOnly:oe(t,"useStandardizedQueries",!1),supportsStatistics:oe(r,"supportsStatistics",t.supportsStatistics),supportsTopFeaturesQuery:oe(r,"supportsTopFeaturesQuery",!1),supportsTrueCurve:oe(r,"supportsTrueCurve",!1),tileMaxRecordCount:Up(t,"tileMaxRecordCount",void 0)}}function F3e(t){const e=t.advancedQueryCapabilities,r=oe(e,"supportsAdvancedQueryRelated",!1);return{supportsPagination:oe(e,"supportsQueryRelatedPagination",!1),supportsCount:r,supportsOrderBy:r,supportsCacheHint:Xv(e,"queryRelated")}}function D3e(t){return{supportsCacheHint:Xv(t.advancedQueryCapabilities,"queryTopFilter")}}function z3e(t){const e=t?t.queryBinsCapabilities:void 0;return{supportsDate:oe(e,"supportsDateBin",!1),supportsFixedInterval:oe(e,"supportsFixedIntervalBin",!1),supportsAutoInterval:oe(e,"supportsAutoIntervalBin",!1),supportsFixedBoundaries:oe(e,"supportsFixedBoundariesBin",!1),supportsStackBy:oe(e,"supportsStackBy",!1),supportsSplitBy:oe(e,"supportsSplitBy",!1),supportsSnapToData:oe(e,"supportsSnapToData",!1),supportsReturnFullIntervalBin:oe(e,"supportsReturnFullIntervalBin",!1),supportsFirstDayOfWeek:oe(e,"supportsFirstDayOfWeek",!1),supportsNormalization:oe(e,"supportsNormalization",!1),supportedStatistics:C3e(e),supportedNormalizationTypes:P3e(e)}}function V3e(t){const e=t.ownershipBasedAccessControlForFeatures,r=t?t.advancedEditingCapabilities:void 0;return{supportsGeometryUpdate:oe(t,"allowGeometryUpdates",!0),supportsGlobalId:oe(t,"supportsApplyEditsWithGlobalIds",!1),supportsReturnServiceEditsInSourceSpatialReference:oe(t,"supportsReturnServiceEditsInSourceSR",!1),supportsRollbackOnFailure:oe(t,"supportsRollbackOnFailureParameter",!1),supportsUpdateWithoutM:oe(t,"allowUpdateWithoutMValues",!1),supportsUploadWithItemId:oe(t,"supportsAttachmentsByUploadId",!1),supportsDeleteByAnonymous:oe(e,"allowAnonymousToDelete",!0),supportsDeleteByOthers:oe(e,"allowOthersToDelete",!0),supportsUpdateByAnonymous:oe(e,"allowAnonymousToUpdate",!0),supportsUpdateByOthers:oe(e,"allowOthersToUpdate",!0),supportsAsyncApplyEdits:oe(r,"supportsAsyncApplyEdits",!1),zDefault:Up(t,"zDefault",void 0)}}function d8e(t){return{operations:{supportsAppend:oe(t,"supportsAppend",!1),supportsCoverageQuery:t?.playbackInfo?.klv["0601"]??!1,supportsExportClip:oe(t,"supportsExportClip",!1),supportsExportFrameset:oe(t,"supportsExportFrameset",!1),supportsMensuration:oe(t,"supportsMensuration",!1),supportsPreviews:oe(t,"supportsPreviews",!1),supportsUpdate:oe(t,"supportsUpdate",!1)}}}let al=class extends Ce.ClonableMixin(W){constructor(e){super(e),this.code=null,this.defaultValues={},this.domains=null,this.name=null}readDomains(e){if(!e)return null;const r={};for(const i of Object.keys(e))r[i]=T2(e[i]);return r}writeDomains(e,r){if(!e)return;const i={};for(const s of Object.keys(e))e[s]&&(i[s]=e[s]?.toJSON());r.domains=i}};c([d({type:Number,json:{write:!0}})],al.prototype,"code",void 0),c([d({type:Object,json:{write:!0}})],al.prototype,"defaultValues",void 0),c([d({json:{write:!0}})],al.prototype,"domains",void 0),c([K("domains")],al.prototype,"readDomains",null),c([re("domains")],al.prototype,"writeDomains",null),c([d({type:String,json:{write:!0}})],al.prototype,"name",void 0),al=c([C("esri.layers.support.Subtype")],al);async function j3e(t){const e=t.spatialReference;if(e.isWGS84)return t.clone();if(e.isWebMercator)return Oh(t);const r=ne.WGS84;return await Y3(e,r),bc(t,r)}function U3e(t,e){if(!DL(t,e)){const r=t.typeKeywords;r?r.push(e):t.typeKeywords=[e]}}function DL(t,e){return!!t.typeKeywords?.includes(e)}function f8e(t){return DL(t,bJ.HOSTED_SERVICE)}function G3e(t,e){const r=t.typeKeywords;if(r){const i=r.indexOf(e);i>-1&&r.splice(i,1)}}function m8e(t,e,r){r?U3e(t,e):G3e(t,e)}async function y8e(t){const e=t.clone().normalize();let r;if(e.length>1)for(const i of e)r?i.width>r.width&&(r=i):r=i;else r=e[0];return j3e(r)}const bJ={CHARTS:"Charts",DYNAMIC:"Dynamic",GROUP_LAYER_MAP:"Map",HOSTED_SERVICE:"Hosted Service",JSAPI:"ArcGIS API for JavaScript",METADATA:"Metadata",MULTI_LAYER:"Multilayer",ORIENTED_IMAGERY_LAYER:"OrientedImageryLayer",SINGLE_LAYER:"Singlelayer",SUBTYPE_GROUP_LAYER:"SubtypeGroupLayer",SUBTYPE_GROUP_TABLE:"SubtypeGroupTable",TABLE:"Table",TILED_IMAGERY:"Tiled Imagery"};function B3e(t){const{portal:e,isOrgItem:r,itemControl:i}=t,s=e.user?.privileges;let n=!s||s.includes("features:user:edit"),o=!!r&&!!s?.includes("features:user:fullEdit");const a=i==="update"||i==="admin";return a?o=n=!0:o&&(n=!0),{features:{edit:n,fullEdit:o},content:{updateItem:a}}}const q3e=t=>{let e=class extends t{constructor(){super(...arguments),this.copyright=null,this.capabilities=null,this.dateFieldsTimeZone=null,this.datesInUnknownTimezone=!1,this.definitionExpression=null,this.displayField=null,this.editFieldsInfo=null,this.editingInfo=null,this.elevationInfo=null,this.fieldsIndex=null,this.floorInfo=null,this.fullExtent=null,this.gdbVersion=null,this.geometryFieldsInfo=null,this.geometryType=null,this.globalIdField=null,this.hasM=void 0,this.hasZ=void 0,this.heightModelInfo=null,this.historicMoment=null,this.indexes=new(se.ofType(Lo)),this.isTable=!1,this.layerId=void 0,this.maxScale=0,this.minScale=0,this.objectIdField=null,this.preferredTimeZone=null,this.relationships=null,this.returnM=void 0,this.returnZ=void 0,this.serviceDefinitionExpression=null,this.serviceItemId=null,this.sourceJSON=null,this.spatialReference=ne.WGS84,this.subtypeField=null,this.subtypes=null,this.trackIdField=null,this.uniqueIdFields=null,this.version=void 0,this._isUrlHostModified=!1,this._isUrlHostModificationEnabled=!1}getFieldDomain(){throw new Error("Not implemented")}getField(r){return this.fieldsIndex.get(r)}get authenticationTriggerEvent(){if(!this.url)return null;const{capabilities:r}=this;if(r){const{query:s,operations:n,editing:o}=r;if(!s.supportsQueryByOthers||!s.supportsQueryByAnonymous||n.supportsEditing&&!(o.supportsUpdateByOthers&&o.supportsUpdateByAnonymous&&o.supportsDeleteByOthers&&o.supportsDeleteByAnonymous))return"load"}if(OS(this.serviceDefinitionExpression)||OS(this.definitionExpression))return"load";if(this.userHasUpdateItemPrivileges){if(y3e(this))return"load";if(this.hasUpdateItemRestrictions)return r.operations.supportsQuery?"editing":"load"}if(this.userHasFullEditingPrivileges&&this.hasFullEditingRestrictions)return"editing";const i=this.editFieldsInfo;return(i?.creatorField||i?.editorField)&&r?.operations.supportsEditing?"editing":null}readCapabilitiesFromService(r,i){return _J(i,this.url)}readEditingInfo(r,i){const{editingInfo:s}=i;return s?{lastEditDate:s.lastEditDate!=null?new Date(s.lastEditDate):null}:null}get effectiveCapabilities(){const r=this.capabilities;if(!r)return null;const i=k(r),{operations:s,editing:n}=i;return jb(this)?(this.userHasUpdateItemPrivileges&&(s.supportsQuery=!0),i):this.userHasUpdateItemPrivileges?(s.supportsAdd=s.supportsDelete=s.supportsEditing=s.supportsQuery=s.supportsUpdate=n.supportsDeleteByOthers=n.supportsGeometryUpdate=n.supportsUpdateByOthers=!0,i):(this.userHasFullEditingPrivileges&&s.supportsEditing&&(s.supportsAdd=s.supportsDelete=s.supportsUpdate=n.supportsGeometryUpdate=!0),i)}get effectiveEditingEnabled(){return!1}readGlobalIdFieldFromService(r,i){return lJ(i)}get hasFullEditingRestrictions(){const r=this.capabilities;if(!r||jb(this))return!1;const{operations:i,editing:s}=r;return i.supportsEditing&&!(i.supportsAdd&&i.supportsDelete&&i.supportsUpdate&&s.supportsGeometryUpdate)}get hasUpdateItemRestrictions(){const r=this.capabilities;if(!r)return!1;const{operations:i,editing:s}=r;return jb(this)?!i.supportsQuery:!(i.supportsAdd&&i.supportsDelete&&i.supportsEditing&&i.supportsQuery&&i.supportsUpdate&&s.supportsDeleteByOthers&&s.supportsGeometryUpdate&&s.supportsUpdateByOthers)}readIsTableFromService(r,i){return i.type==="Table"}readMaxScale(r,i){return i.effectiveMaxScale||r||0}readMinScale(r,i){return i.effectiveMinScale||r||0}readObjectIdFieldFromService(r,i){return uJ(i)}readServiceDefinitionExpression(r,i){return i.definitionQuery||i.definitionExpression}readUniqueIdFields(r,i){return i.uniqueIdInfo?.OIDFieldContainsHashValue?i.uniqueIdInfo.fields:null}set url(r){if(r==null)return void this._set("url",r);const i=NX({layer:this,url:r,nonStandardUrlAllowed:!0,logger:q.getLogger(this)});this._set("url",i.url),i.layerId!=null&&this._set("layerId",i.layerId)}writeUrl(r,i,s,n){FX(this,r,null,i,n)}readVersion(r,i){return a3e(i)}get isUrlHostModified(){const{loaded:r,url:i,_isUrlHostModified:s}=this;if(s)return!0;if(!r||!i||this.originIdOf("url")<xe.USER)return!1;const n=this.sourceJSON?.preferredHost;if(!n||!va(i,`https://${n}`,!0))return!1;for(let o=xe.USER-1;o>=xe.PORTAL_ITEM;o--){const a=this.getAtOrigin("url",I0(o));if(a)return!va(i,a,!0)}return!1}applyPreferredHost(r){const{url:i,portalItem:s}=this;!i||pT(s)}applyHostFromPortalItem(){const{url:r,portalItem:i}=this;if(!r||this.originIdOf("url")===xe.USER||!i?.url||!pT(i)||!DL(i,bJ.HOSTED_SERVICE)||va(r,i.url,!0)||!this._isUrlHostModificationEnabled)return;const s=mX(i.url);this._set("url",Ez(r,s)),this._isUrlHostModified=!0}};return c([d({readOnly:!0})],e.prototype,"authenticationTriggerEvent",null),c([d({type:String,json:{origins:{service:{read:{source:"copyrightText"}}}}})],e.prototype,"copyright",void 0),c([d({readOnly:!0,json:{read:!1,origins:{service:{read:{source:["advancedQueryCapabilities","allowGeometryUpdates","allowUpdateWithoutMValues","archivingInfo","capabilities","datesInUnknownTimezone","hasAttachments","hasM","hasZ","isDataBranchVersioned","isDataVersioned","maxRecordCount","maxRecordCountFactor","maxUniqueIDCount","ownershipBasedAccessControlForFeatures","standardMaxRecordCount","supportedQueryFormats","supportsAdvancedQueries","supportsApplyEditsWithGlobalIds","supportsAttachmentsByUploadId","supportsAttachmentsResizing","supportsCalculate","supportsCoordinatesQuantization","supportsExceedsLimitStatistics","supportsFieldDescriptionProperty","supportsQuantizationEditMode","supportsRollbackOnFailureParameter","supportsStatistics","supportsTruncate","supportsValidateSql","tileMaxRecordCount","useStandardizedQueries"]}}}}})],e.prototype,"capabilities",void 0),c([K("service","capabilities")],e.prototype,"readCapabilitiesFromService",null),c([d(ww("dateFieldsTimeReference"))],e.prototype,"dateFieldsTimeZone",void 0),c([d({type:Boolean})],e.prototype,"datesInUnknownTimezone",void 0),c([d({type:String,json:{origins:{service:{read:!1,write:!1}},name:"layerDefinition.definitionExpression",write:{enabled:!0,allowNull:!0}}})],e.prototype,"definitionExpression",void 0),c([d({type:String,json:{origins:{service:{read:{source:"displayField"}}}}})],e.prototype,"displayField",void 0),c([d({readOnly:!0,type:ol})],e.prototype,"editFieldsInfo",void 0),c([d({readOnly:!0})],e.prototype,"editingInfo",void 0),c([K("editingInfo")],e.prototype,"readEditingInfo",null),c([d({readOnly:!0})],e.prototype,"effectiveCapabilities",null),c([d()],e.prototype,"effectiveEditingEnabled",null),c([d((()=>{const r=k(DPe),i=r.json.origins;return i["web-map"]={read:!1,write:!1},i["portal-item"]={read:!1,write:!1},r})())],e.prototype,"elevationInfo",void 0),c([d()],e.prototype,"fieldsIndex",void 0),c([d({type:jp,json:{name:"layerDefinition.floorInfo",write:{layerContainerTypes:ft}}})],e.prototype,"floorInfo",void 0),c([d({type:Le,json:{origins:{service:{read:{source:"extent"}}}}})],e.prototype,"fullExtent",void 0),c([d()],e.prototype,"gdbVersion",void 0),c([d({readOnly:!0,type:Vp,json:{read:{source:"geometryProperties"}}})],e.prototype,"geometryFieldsInfo",void 0),c([d({type:["point","polygon","polyline","multipoint","multipatch","mesh"],json:{origins:{service:{read:xP.read}}}})],e.prototype,"geometryType",void 0),c([d({type:String})],e.prototype,"globalIdField",void 0),c([K("service","globalIdField",["globalIdField","fields"])],e.prototype,"readGlobalIdFieldFromService",null),c([d({readOnly:!0})],e.prototype,"hasFullEditingRestrictions",null),c([d({type:Boolean,json:{origins:{service:{read:!0}}}})],e.prototype,"hasM",void 0),c([d({readOnly:!0})],e.prototype,"hasUpdateItemRestrictions",null),c([d({type:Boolean,json:{origins:{service:{read:!0}}}})],e.prototype,"hasZ",void 0),c([d({readOnly:!0,type:Ai})],e.prototype,"heightModelInfo",void 0),c([d({type:Date})],e.prototype,"historicMoment",void 0),c([d({type:se.ofType(Lo),readOnly:!0})],e.prototype,"indexes",void 0),c([d({readOnly:!0})],e.prototype,"isTable",void 0),c([K("service","isTable",["type"])],e.prototype,"readIsTableFromService",null),c([d({type:Number,json:{origins:{service:{read:{source:"id"}},"portal-item":{read:!1,write:{target:"id"}}},read:!1}})],e.prototype,"layerId",void 0),c([d(UPe)],e.prototype,"maxScale",void 0),c([K("service","maxScale",["maxScale","effectiveMaxScale"])],e.prototype,"readMaxScale",null),c([d(jPe)],e.prototype,"minScale",void 0),c([K("service","minScale",["minScale","effectiveMinScale"])],e.prototype,"readMinScale",null),c([d({type:String})],e.prototype,"objectIdField",void 0),c([K("service","objectIdField",["objectIdField","fields"])],e.prototype,"readObjectIdFieldFromService",null),c([d(ww("preferredTimeReference"))],e.prototype,"preferredTimeZone",void 0),c([d({type:[Es],readOnly:!0})],e.prototype,"relationships",void 0),c([d({type:Boolean})],e.prototype,"returnM",void 0),c([d({type:Boolean})],e.prototype,"returnZ",void 0),c([d({readOnly:!0,json:{write:!1}})],e.prototype,"serverGens",void 0),c([d({readOnly:!0})],e.prototype,"serviceDefinitionExpression",void 0),c([K("service","serviceDefinitionExpression",["definitionQuery","definitionExpression"])],e.prototype,"readServiceDefinitionExpression",null),c([d({type:String,readOnly:!0,json:{read:!1,origins:{service:{read:!0}}}})],e.prototype,"serviceItemId",void 0),c([d()],e.prototype,"sourceJSON",void 0),c([d({type:ne,json:{origins:{service:{read:{source:"extent.spatialReference"}}}}})],e.prototype,"spatialReference",void 0),c([d({type:String,readOnly:!0,json:{origins:{service:{read:!0}}}})],e.prototype,"subtypeField",void 0),c([d({type:[al],readOnly:!0,json:{read:!1,origins:{service:{read:!0}}}})],e.prototype,"subtypes",void 0),c([d({type:String,json:{read:{source:"timeInfo.trackIdField"}}})],e.prototype,"trackIdField",void 0),c([d({type:[String],readOnly:!0})],e.prototype,"uniqueIdFields",void 0),c([K("service","uniqueIdFields",["uniqueIdInfo.OIDFieldContainsHashValue","uniqueIdInfo.fields"])],e.prototype,"readUniqueIdFields",null),c([d(NPe)],e.prototype,"url",null),c([re("url")],e.prototype,"writeUrl",null),c([d({json:{origins:{service:{read:!0}},read:!1}})],e.prototype,"version",void 0),c([K("service","version",["currentVersion","capabilities","drawingInfo","hasAttachments","htmlPopupType","relationships","timeInfo","typeIdField","types"])],e.prototype,"readVersion",null),c([d({readOnly:!0})],e.prototype,"isUrlHostModified",null),e=c([C("esri.layers.mixins.FeatureLayerBase")],e),e};let ju=class extends Ce.ClonableMixin(W){constructor(e){super(e),this.expression=null,this.title=null,this.returnType=null}};c([d({type:String,json:{write:!0}})],ju.prototype,"expression",void 0),c([d({type:String,json:{write:!0}})],ju.prototype,"title",void 0),c([d({type:String,json:{write:!0}})],ju.prototype,"returnType",void 0),ju=c([C("esri.layers.support.ExpressionInfo")],ju);var MP,Kf;let yi=(Kf=class extends W{constructor(e){super(e),this.isAutoGenerated=!1,this.name=null,this.alias=null,this.onStatisticField=null,this.onStatisticExpression=null,this.statisticType=null}clone(){return new MP({name:this.name,alias:this.alias,isAutoGenerated:this.isAutoGenerated,onStatisticExpression:k(this.onStatisticExpression),onStatisticField:this.onStatisticField,statisticType:this.statisticType})}},MP=Kf,Kf);c([d({type:Boolean,json:{write:!0}})],yi.prototype,"isAutoGenerated",void 0),c([d({type:String,json:{write:!0}})],yi.prototype,"name",void 0),c([d({type:String,json:{write:!0}})],yi.prototype,"alias",void 0),c([d({type:String,json:{write:!0}})],yi.prototype,"onStatisticField",void 0),c([d({type:ju,json:{write:!0}})],yi.prototype,"onStatisticExpression",void 0),c([d({type:String,json:{write:!0}})],yi.prototype,"statisticType",void 0),yi=MP=c([C("esri.layers.support.AggregateField")],yi);let rc=class extends W{constructor(){super(...arguments),this.type=null}};c([d({type:["selection","cluster","binning"],readOnly:!0,json:{read:!1,write:!0}})],rc.prototype,"type",void 0),rc=c([C("esri.layers.support.FeatureReduction")],rc);const zL="__begin__",VL="__end__",H3e=new RegExp(zL,"ig"),W3e=new RegExp(VL,"ig"),N6=new RegExp("^"+zL,"i"),F6=new RegExp(VL+"$","i"),NS='"',Z3e=NS+" + ",J3e=" + "+NS;function Y3e(t){return t.replaceAll(new RegExp("\\[","g"),"{").replaceAll(new RegExp("\\]","g"),"}")}function X3e(t){return t.replaceAll(new RegExp("\\{","g"),"[").replaceAll(new RegExp("\\}","g"),"]")}function jL(t){const e={expression:"",type:"none"};return t.labelExpressionInfo?t.labelExpressionInfo.value?(e.expression=t.labelExpressionInfo.value,e.type="conventional"):t.labelExpressionInfo.expression&&(e.expression=t.labelExpressionInfo.expression,e.type="arcade"):t.labelExpression!=null&&(e.expression=Y3e(t.labelExpression),e.type="conventional"),e}function K3e(t){const e=jL(t);if(!e)return null;switch(e.type){case"conventional":return TP(e.expression);case"arcade":return e.expression}return null}function Q3e(t){const e=jL(t);if(!e)return null;switch(e.type){case"conventional":return tAe(e.expression);case"arcade":return wJ(e.expression)}return null}function TP(t){let e;return t?(e=gc(t,(r=>zL+'$feature["'+r+'"]'+VL)),e=N6.test(e)?e.replace(N6,""):NS+e,e=F6.test(e)?e.replace(F6,""):e+NS,e=e.replaceAll(H3e,Z3e).replaceAll(W3e,J3e)):e='""',e}const eAe=/^\s*\{([^}]+)\}\s*$/i;function tAe(t){return t?.match(eAe)?.[1].trim()||null}const rAe=/^\s*(?:(?:\$feature\.(\w+))|(?:\$feature\[(["'])(.+)(\2)\]));?\s*$/i,iAe=/^\s*(?:(?:\$feature\.(\w+))|(?:\$feature\[(["'])(.+)(\2)\]));?\s*(?:DomainName\(\s*\$feature\s*,\s*(["'])(\1|\3)(\5)\s*\));?\s*$/i,sAe=/^\s*(?:DomainName\(\s*\$feature\s*,\s*(["'])(.+)(\1)\s*\));?\s*$/i;function wJ(t){if(!t)return null;let e=rAe.exec(t)||iAe.exec(t);return e?e[1]||e[3]:(e=sAe.exec(t),e?e[2]:null)}var EP,Qf;let vl=(Qf=class extends W{constructor(){super(...arguments),this.expression=null,this.title=null,this.value=null}readExpression(e,r){return r.value?TP(r.value):e}writeExpression(e,r,i){this.value!=null&&(e=TP(this.value)),e!=null&&(r[i]=e)}clone(){return new EP({expression:this.expression,title:this.title,value:this.value})}},EP=Qf,Qf);c([d({type:String,json:{write:{writerEnsuresNonNull:!0}}})],vl.prototype,"expression",void 0),c([K("expression",["expression","value"])],vl.prototype,"readExpression",null),c([re("expression")],vl.prototype,"writeExpression",null),c([d({type:String,json:{write:!0,origins:{"web-scene":{write:!1}}}})],vl.prototype,"title",void 0),c([d({json:{read:!1,write:!1}})],vl.prototype,"value",void 0),vl=EP=c([C("esri.layers.support.LabelExpressionInfo")],vl);var IP;const c1=new De({esriServerPointLabelPlacementAboveCenter:"above-center",esriServerPointLabelPlacementAboveLeft:"above-left",esriServerPointLabelPlacementAboveRight:"above-right",esriServerPointLabelPlacementBelowCenter:"below-center",esriServerPointLabelPlacementBelowLeft:"below-left",esriServerPointLabelPlacementBelowRight:"below-right",esriServerPointLabelPlacementCenterCenter:"center-center",esriServerPointLabelPlacementCenterLeft:"center-left",esriServerPointLabelPlacementCenterRight:"center-right",esriServerLinePlacementAboveAfter:"above-after",esriServerLinePlacementAboveAlong:"above-along",esriServerLinePlacementAboveBefore:"above-before",esriServerLinePlacementAboveStart:"above-start",esriServerLinePlacementAboveEnd:"above-end",esriServerLinePlacementBelowAfter:"below-after",esriServerLinePlacementBelowAlong:"below-along",esriServerLinePlacementBelowBefore:"below-before",esriServerLinePlacementBelowStart:"below-start",esriServerLinePlacementBelowEnd:"below-end",esriServerLinePlacementCenterAfter:"center-after",esriServerLinePlacementCenterAlong:"center-along",esriServerLinePlacementCenterBefore:"center-before",esriServerLinePlacementCenterStart:"center-start",esriServerLinePlacementCenterEnd:"center-end",esriServerPolygonPlacementAlwaysHorizontal:"always-horizontal"},{ignoreUnknown:!0});function h1(t,e,r){return{enabled:!dT(r?.layer)}}function SJ(t){return!t||t.origin!=="service"&&t.layer?.type!=="map-image"}function nAe(t){return t?.type==="map-image"}function xJ(t){return!!nAe(t)&&!!t.capabilities?.exportMap?.supportsArcadeExpressionForLabeling}function oAe(t){return SJ(t)||xJ(t?.layer)}var em;let wt=(em=class extends W{static evaluateWhere(e,r){const i=(s,n,o)=>{switch(n){case"=":return s==o;case"<>":return s!=o;case">":return s>o;case">=":return s>=o;case"<":return s<o;case"<=":return s<=o}return!1};try{if(e==null)return!0;const s=e.split(" ");if(s.length===3)return i(r[s[0]],s[1],s[2]);if(s.length===7){const n=i(r[s[0]],s[1],s[2]),o=s[3],a=i(r[s[4]],s[5],s[6]);switch(o){case"AND":return n&&a;case"OR":return n||a}}return!1}catch{}}constructor(e){super(e),this.type="label",this.name=null,this.allowOverrun=!1,this.deconflictionStrategy="static",this.labelExpression=null,this.labelExpressionInfo=null,this.labelPlacement=null,this.labelPosition="curved",this.maxScale=0,this.minScale=0,this.repeatLabel=!0,this.repeatLabelDistance=null,this.symbol=hwe,this.useCodedValues=void 0,this.where=null}readLabelExpression(e,r){const i=r.labelExpressionInfo;if(!i||!i.value&&!i.expression)return e}writeLabelExpression(e,r,i){if(this.labelExpressionInfo){if(this.labelExpressionInfo.value!=null)e=X3e(this.labelExpressionInfo.value);else if(this.labelExpressionInfo.expression!=null){const s=wJ(this.labelExpressionInfo.expression);s&&(e="["+s+"]")}}e!=null&&(r[i]=e)}writeLabelExpressionInfo(e,r,i,s){if(e==null&&this.labelExpression!=null&&SJ(s))e=new vl({expression:this.getLabelExpressionArcade()});else if(!e)return;const n=e.toJSON(s);n.expression&&(r[i]=n)}writeMaxScale(e,r){(e||this.minScale)&&(r.maxScale=e)}writeMinScale(e,r){(e||this.maxScale)&&(r.minScale=e)}getLabelExpression(){return jL(this)}getLabelExpressionArcade(){return K3e(this)}getLabelExpressionSingleField(){return Q3e(this)}hash(){return JSON.stringify(this)}clone(){return new IP({allowOverrun:this.allowOverrun,deconflictionStrategy:this.deconflictionStrategy,labelExpression:this.labelExpression,labelExpressionInfo:k(this.labelExpressionInfo),labelPosition:this.labelPosition,labelPlacement:this.labelPlacement,maxScale:this.maxScale,minScale:this.minScale,name:this.name,repeatLabel:this.repeatLabel,repeatLabelDistance:this.repeatLabelDistance,symbol:k(this.symbol),where:this.where,useCodedValues:this.useCodedValues})}},IP=em,em);c([d({type:String,json:{write:!0}})],wt.prototype,"name",void 0),c([d({type:Boolean,json:{write:!0,default:!1,origins:{"web-scene":{write:!1},"portal-item":{default:!1,write:{overridePolicy:h1}}}}})],wt.prototype,"allowOverrun",void 0),c([d({type:String,json:{write:!0,default:"static",origins:{"web-scene":{write:!1},"portal-item":{default:"static",write:{overridePolicy:h1}}}}})],wt.prototype,"deconflictionStrategy",void 0),c([d({type:String,json:{write:{overridePolicy(t,e,r){return this.labelExpressionInfo&&r?.origin==="service"&&xJ(r.layer)?{enabled:!1}:{allowNull:!0}}}}})],wt.prototype,"labelExpression",void 0),c([K("labelExpression")],wt.prototype,"readLabelExpression",null),c([re("labelExpression")],wt.prototype,"writeLabelExpression",null),c([d({type:vl,json:{write:{overridePolicy:(t,e,r)=>oAe(r)?{allowNull:!0}:{enabled:!1}}}})],wt.prototype,"labelExpressionInfo",void 0),c([re("labelExpressionInfo")],wt.prototype,"writeLabelExpressionInfo",null),c([d({type:c1.apiValues,json:{type:c1.jsonValues,read:c1.read,write:c1.write}})],wt.prototype,"labelPlacement",void 0),c([d({type:["curved","parallel"],json:{write:!0,origins:{"web-map":{write:!1},"web-scene":{write:!1},"portal-item":{write:!1}}}})],wt.prototype,"labelPosition",void 0),c([d({type:Number})],wt.prototype,"maxScale",void 0),c([re("maxScale")],wt.prototype,"writeMaxScale",null),c([d({type:Number})],wt.prototype,"minScale",void 0),c([re("minScale")],wt.prototype,"writeMinScale",null),c([d({type:Boolean,json:{write:!0,origins:{"web-scene":{write:!1},"portal-item":{write:{overridePolicy:h1}}}}})],wt.prototype,"repeatLabel",void 0),c([d({type:Number,cast:Be,json:{write:!0,origins:{"web-scene":{write:!1},"portal-item":{write:{overridePolicy:h1}}}}})],wt.prototype,"repeatLabelDistance",void 0),c([d({types:Khe,json:{origins:{"web-scene":{types:Qhe,write:XF,default:null}},write:XF,default:null}})],wt.prototype,"symbol",void 0),c([d({type:Boolean,json:{write:!0}})],wt.prototype,"useCodedValues",void 0),c([d({type:String,json:{write:!0}})],wt.prototype,"where",void 0),wt=IP=c([C("esri.layers.support.LabelClass")],wt);var CP;let Xr=CP=class extends rc{constructor(t){super(t),this.type="binning",this.binType="geohash",this.fixedBinLevel=null,this.labelingInfo=null,this.labelsVisible=!0,this.maxScale=0,this.popupEnabled=!0,this.popupTemplate=null,this.size=Be("12px"),this.fields=[],this.renderer=null}writeFields(t,e,r){const i=t.filter((s=>s.statisticType!=="avg_angle")).map((s=>s.toJSON()));Cr(r,i,e)}readRenderer(t,e,r){const i=e.drawingInfo?.renderer;return i?rv(i,e,r)??void 0:OL(e,r)}clone(){return new CP({fields:k(this.fields),fixedBinLevel:this.fixedBinLevel,labelingInfo:k(this.labelingInfo),labelsVisible:this.labelsVisible,maxScale:this.maxScale,popupEnabled:this.popupEnabled,popupTemplate:k(this.popupTemplate),renderer:k(this.renderer),binType:k(this.binType),size:this.size})}};c([ye({binning:"binning"})],Xr.prototype,"type",void 0),c([ye({geohash:"geohash",square:"square"}),d({type:["geohash","square"]})],Xr.prototype,"binType",void 0),c([d({type:Number,json:{write:!0}})],Xr.prototype,"fixedBinLevel",void 0),c([d({type:[wt],json:{read:{source:"drawingInfo.labelingInfo"},write:{target:"drawingInfo.labelingInfo"}}})],Xr.prototype,"labelingInfo",void 0),c([d(nx)],Xr.prototype,"labelsVisible",void 0),c([d({type:Number,json:{default:0,name:"visibilityInfo.maxScale"}})],Xr.prototype,"maxScale",void 0),c([d(sx)],Xr.prototype,"popupEnabled",void 0),c([d({type:Gm,json:{name:"popupInfo",write:!0}})],Xr.prototype,"popupTemplate",void 0),c([d({cast:t=>t==="auto"?t:Di(Be(t))})],Xr.prototype,"size",void 0),c([d({type:[yi],json:{write:!0}})],Xr.prototype,"fields",void 0),c([re("fields")],Xr.prototype,"writeFields",null),c([d({types:Hv,json:{write:{target:"drawingInfo.renderer"}}})],Xr.prototype,"renderer",void 0),c([K("renderer",["drawingInfo.renderer"])],Xr.prototype,"readRenderer",null),Xr=CP=c([C("esri.layers.support.FeatureReductionBinning")],Xr);var PP;function D6(t){return t.type==="simple"&&!t.visualVariables?.length}let cr=PP=class extends W{constructor(t){super(t),this.type="cluster",this.clusterRadius=Be("80px"),this.clusterMinSize=Be("12px"),this.clusterMaxSize=Be("50px"),this.maxScale=0,this.popupEnabled=!0,this.popupTemplate=null,this.renderer=null,this.symbol=null,this.labelingInfo=null,this.labelsVisible=!0,this.fields=[]}readRenderer(t,e,r){const i=e.drawingInfo?.renderer;return i?.authoringInfo?.isAutoGenerated?null:i?D6(i)?null:rv(i,e,r)??void 0:OL(e,r)}readSymbol(t,e,r){const i=e.drawingInfo?.renderer;return i?.authoringInfo?.isAutoGenerated?null:i&&D6(i)?rv(i,e,r)?.symbol:null}writeSymbol(t,e,r,i){const s=this.renderer?.authoringInfo?.isAutoGenerated;if(!this.renderer||s){const n=new ji({symbol:t});e.drawingInfo={renderer:n.write({},i)}}}writeFields(t,e,r){const i=t.filter((s=>s.statisticType!=="avg_angle")).map((s=>s.toJSON()));Cr(r,i,e)}readFields(t,e,r){return t.filter((i=>!i.isAutoGenerated)).map((i=>yi.fromJSON(i)))}clone(){return new PP({clusterRadius:this.clusterRadius,clusterMinSize:this.clusterMinSize,clusterMaxSize:this.clusterMaxSize,labelingInfo:k(this.labelingInfo),labelsVisible:this.labelsVisible,fields:k(this.fields),maxScale:this.maxScale,renderer:k(this.renderer),symbol:k(this.symbol),popupEnabled:this.popupEnabled,popupTemplate:k(this.popupTemplate)})}};c([d({type:["cluster"],readOnly:!0,json:{write:!0}})],cr.prototype,"type",void 0),c([d({cast:t=>t==="auto"?t:Di(Be(t)),json:{write:!0}})],cr.prototype,"clusterRadius",void 0),c([d({type:Number,cast:Be,json:{write:!0}})],cr.prototype,"clusterMinSize",void 0),c([d({type:Number,cast:Be,json:{write:!0}})],cr.prototype,"clusterMaxSize",void 0),c([d({type:Number,json:{default:0,name:"visibilityInfo.maxScale"}})],cr.prototype,"maxScale",void 0),c([d(sx)],cr.prototype,"popupEnabled",void 0),c([d({type:Gm,json:{read:{source:"popupInfo"},write:{target:"popupInfo"}}})],cr.prototype,"popupTemplate",void 0),c([d({types:Hv,json:{write:{target:"drawingInfo.renderer"}}})],cr.prototype,"renderer",void 0),c([K("renderer",["drawingInfo.renderer"])],cr.prototype,"readRenderer",null),c([d({types:Yhe})],cr.prototype,"symbol",void 0),c([K("symbol",["drawingInfo.renderer"])],cr.prototype,"readSymbol",null),c([re("symbol")],cr.prototype,"writeSymbol",null),c([d({type:[wt],json:{read:{source:"drawingInfo.labelingInfo"},write:{target:"drawingInfo.labelingInfo"}}})],cr.prototype,"labelingInfo",void 0),c([d(nx)],cr.prototype,"labelsVisible",void 0),c([d({type:[yi],json:{write:!0}})],cr.prototype,"fields",void 0),c([re("fields")],cr.prototype,"writeFields",null),c([K("fields")],cr.prototype,"readFields",null),cr=PP=c([C("esri.layers.support.FeatureReductionCluster")],cr);var AP;let x0=AP=class extends rc{constructor(t){super(t),this.type="selection"}clone(){return new AP}};c([d({type:["selection"]})],x0.prototype,"type",void 0),x0=AP=c([C("esri.layers.support.FeatureReductionSelection")],x0);const z6={key:"type",base:rc,typeMap:{cluster:cr,binning:Xr}},aAe={types:{key:"type",base:rc,typeMap:{selection:x0,cluster:cr,binning:Xr}},json:{name:"layerDefinition.featureReduction",write:{allowNull:!0},origins:{"web-map":{types:z6},"portal-item":{types:z6},"web-scene":{types:{key:"type",base:rc,typeMap:{selection:x0}},name:"layerDefinition.featureReduction",write:{layerContainerTypes:ft}}}}},lAe=()=>q.getLogger("esri.views.2d.layers.support.clusterUtils");z.add("esri-cluster-arcade-enabled",!0);const uAe=z("esri-cluster-arcade-enabled"),cAe=new Set(["simple-line","simple-fill","picture-fill"]);function V6(t,e){let r=e.clone();if(!hAe(r))return r;if(e.symbols.some((i=>cAe.has(i.type)))&&(r=new ji({symbol:new Pt})),r.authoringInfo||(r.authoringInfo=new Tt),r.authoringInfo.isAutoGenerated=!0,"visualVariables"in r){const i=(r.visualVariables||[]).filter((s=>s.valueExpression!=="$view.scale"));i.forEach((s=>{s.type==="rotation"?s.field?s.field=zc(t,s.field,"avg_angle","number"):s.valueExpression&&(s.field=zy(t,s.valueExpression,"avg_angle","number"),s.valueExpression=null):s.normalizationField?(s.field=zc(t,s.field,"avg_norm","number",s.normalizationField),s.normalizationField=null):s.field?s.field=zc(t,s.field,"avg","number"):s.valueExpression&&(s.field=zy(t,s.valueExpression,"avg","number"),s.valueExpression=null)})),r.visualVariables=i}switch(r.type){case"simple":break;case"pie-chart":for(const i of r.attributes)i.field?i.field=zc(t,i.field,"sum","number"):i.valueExpression&&(i.field=zy(t,i.valueExpression,"sum","number"),i.valueExpression=null);break;case"unique-value":r.field?r.field=zc(t,r.field,"mode","string"):r.valueExpression&&(r.field=zy(t,r.valueExpression,"mode","string"),r.valueExpression=null);break;case"class-breaks":r.normalizationField?(r.field=zc(t,r.field,"avg_norm","number",r.normalizationField),r.normalizationField=null):r.field?r.field=zc(t,r.field,"avg","number"):r.valueExpression&&(r.field=zy(t,r.valueExpression,"avg","number"),r.valueExpression=null)}return r}const hAe=t=>{const e=r=>lAe().error(new F("Unsupported-renderer",r,{renderer:t}));if(!t)return!1;switch(t.type){case"unique-value":if(t.field2||t.field3)return e("FeatureReductionCluster does not support multi-field UniqueValueRenderers"),!1;break;case"class-breaks":if(t.normalizationField){const r=t.normalizationType;if(r!=="field")return e(`FeatureReductionCluster does not support a normalizationType of ${r}`),!1}break;case"simple":case"pie-chart":break;default:return e(`FeatureReductionCluster does not support renderers of type ${t.type}`),!1}if(!uAe){if("valueExpression"in t&&t.valueExpression)return e("FeatureReductionCluster does not currently support renderer.valueExpression. Support will be added in a future release"),!1;if(("visualVariables"in t&&t.visualVariables||[]).some((r=>!(!("valueExpression"in r)||!r.valueExpression))))return e("FeatureReductionCluster does not currently support visualVariables with a valueExpression. Support will be added in a future release"),!1}return!0};function dAe(t,e,r){switch(t){case"sum":return`cluster_sum_${e}`;case"avg":case"avg_angle":return`cluster_avg_${e}`;case"mode":return`cluster_type_${e}`;case"avg_norm":{const i=r,s="field",n=e.toLowerCase()+",norm:"+s+","+i.toLowerCase();return"cluster_avg_"+j3(n)}}}function zy(t,e,r,i){const s=j3(e),n=r==="mode"?`cluster_type_${s}`:r==="sum"?`cluster_sum_${s}`:`cluster_avg_${s}`;return t.some((o=>o.name===n))||t.push(new yi({name:n,isAutoGenerated:!0,onStatisticExpression:new ju({expression:e,returnType:i}),statisticType:r})),n}function zc(t,e,r,i,s){if(e==="cluster_count"||t.some((o=>o.name===e)))return e;const n=dAe(r,e,s);return t.some((o=>o.name===n))||(r==="avg_norm"?t.push(new yi({name:n,isAutoGenerated:!0,onStatisticExpression:new ju({expression:`$feature.${e} / $feature.${s}`,returnType:i}),statisticType:"avg"})):t.push(new yi({name:n,isAutoGenerated:!0,onStatisticField:e,statisticType:r}))),n}const pAe=t=>{let e=class extends t{constructor(...r){super(...r),this.addHandles(ie((()=>this.renderer),(()=>{if(this.featureReduction){const i=this._normalizeFeatureReduction(this.featureReduction);this._set("featureReduction",i)}}),Ma))}set featureReduction(r){const i=this._normalizeFeatureReduction(r);this._set("featureReduction",i)}set renderer(r){}_withClusterVariable(r,i,s){const n=r.clone();return"visualVariables"in n&&(n.visualVariables||(n.visualVariables=[]),n.visualVariables.some((o=>o.type==="size"))||n.visualVariables.push(new Ue({field:"cluster_count",stops:[new Zn({value:1}),new Zn({useMinValue:!0,size:i}),new Zn({useMaxValue:!0,size:s})]}))),n}_normalizeFeatureReduction(r){if(r?.type!=="cluster")return r;const i=r.clone(),s=[new yi({name:"cluster_count",alias:"cluster_count",isAutoGenerated:!0,statisticType:"count"})],n=(i.fields??[]).filter((p=>!p.isAutoGenerated)),o=r.renderer&&!r.renderer.authoringInfo?.isAutoGenerated,{clusterMinSize:a,clusterMaxSize:l}=i;if(o){i.fields=[...s,...n];const p=this._withClusterVariable(i.renderer,a,l);return i.effectiveFeatureRenderer=p,i.effectiveClusterRenderer=p,i}if(r.symbol){if(i.fields=[...s,...n],i.renderer=null,!this.renderer)return i.effectiveFeatureRenderer=null,i.effectiveClusterRenderer=null,i;const p=V6(s,this.renderer),m=this._withClusterVariable(p,a,l),y="visualVariables"in m&&m.visualVariables?m.visualVariables:[],g=new ji({symbol:r.symbol,visualVariables:y});return i.fields=[...s,...n],i.effectiveFeatureRenderer=m,i.effectiveClusterRenderer=g,i}if(!this.renderer)return r;const u=V6(s,this.renderer);i.fields=[...s,...n],i.renderer=u;const h=this._withClusterVariable(u,a,l);return i.effectiveFeatureRenderer=h,i.effectiveClusterRenderer=h,i}};return c([d(aAe)],e.prototype,"featureReduction",null),e=c([C("esri.layers.mixins.FeatureReductionLayer")],e),e},j6={ArcGISAnnotationLayer:!0,ArcGISDimensionLayer:!0,ArcGISFeatureLayer:!0,ArcGISImageServiceLayer:!0,ArcGISImageServiceVectorLayer:!0,ArcGISMapServiceLayer:!0,ArcGISStreamLayer:!0,ArcGISTiledImageServiceLayer:!0,ArcGISTiledMapServiceLayer:!0,ArcGISVideoLayer:!0,BingMapsAerial:!0,BingMapsHybrid:!0,BingMapsRoad:!0,CatalogLayer:!0,CSV:!0,GeoJSON:!0,GeoRSS:!0,GroupLayer:!0,KML:!0,KnowledgeGraphLayer:!0,MediaLayer:!0,OGCFeatureLayer:!0,OrientedImageryLayer:!0,SubtypeGroupLayer:!0,VectorTileLayer:!0,WCS:!0,WFS:!0,WMS:!0,WebTiledLayer:!0},U6={ArcGISImageServiceLayer:!0,ArcGISImageServiceVectorLayer:!0,ArcGISMapServiceLayer:!0,ArcGISTiledImageServiceLayer:!0,ArcGISTiledMapServiceLayer:!0,BingMapsAerial:!0,BingMapsHybrid:!0,BingMapsRoad:!0,OpenStreetMap:!0,VectorTileLayer:!0,WCS:!0,WMS:!0,WebTiledLayer:!0},G6={ArcGISFeatureLayer:!0,SubtypeGroupTable:!0},fAe={"web-scene/operational-layers":{ArcGISDimensionLayer:!0,ArcGISFeatureLayer:!0,ArcGISImageServiceLayer:!0,ArcGISMapServiceLayer:!0,ArcGISSceneServiceLayer:!0,ArcGISTiledElevationServiceLayer:!0,ArcGISTiledImageServiceLayer:!0,ArcGISTiledMapServiceLayer:!0,BuildingSceneLayer:!0,CatalogLayer:!0,CSV:!0,GeoJSON:!0,GroupLayer:!0,IntegratedMesh3DTilesLayer:!0,Object3DTilesLayer:!0,IntegratedMeshLayer:!0,KML:!0,LineOfSightLayer:!0,MediaLayer:!0,OGCFeatureLayer:!0,OrientedImageryLayer:!0,PointCloudLayer:!0,RasterDataLayer:!0,VectorTileLayer:!0,ViewshedLayer:!0,Voxel:!0,WCS:!0,WFS:!0,WMS:!0,WebTiledLayer:!0},"web-scene/basemap":{ArcGISImageServiceLayer:!0,ArcGISMapServiceLayer:!0,ArcGISSceneServiceLayer:!0,ArcGISTiledImageServiceLayer:!0,ArcGISTiledMapServiceLayer:!0,OpenStreetMap:!0,VectorTileLayer:!0,WCS:!0,WMS:!0,WebTiledLayer:!0},"web-scene/ground":{ArcGISTiledElevationServiceLayer:!0,RasterDataElevationLayer:!0},"web-scene/tables":{ArcGISFeatureLayer:!0},"web-map/operational-layers":j6,"web-map/basemap":U6,"web-map/tables":G6,"link-chart/operational-layers":{...j6,LinkChartLayer:!0},"link-chart/basemap":U6,"link-chart/tables":G6,"portal-item/operational-layers":{ArcGISFeatureLayer:!0,ArcGISImageServiceLayer:!0,ArcGISMapServiceLayer:!0,ArcGISSceneServiceLayer:!0,ArcGISStreamLayer:!0,ArcGISTiledImageServiceLayer:!0,BuildingSceneLayer:!0,IntegratedMesh3DTilesLayer:!0,IntegratedMeshLayer:!0,MediaLayer:!0,OrientedImageryLayer:!0,PointCloudLayer:!0,SubtypeGroupLayer:!0,WCS:!0},"portal-item/tables":{ArcGISFeatureLayer:!0,SubtypeGroupTable:!0}},mAe=t=>{let e=class extends t{constructor(){super(...arguments),this.persistenceEnabled=!0,this.title=null}readId(r,i,s){return s?.portalItem?.type==="Group Layer"?void 0:r}writeListMode(r,i,s,n){(n&&n.layerContainerType==="ground"||r&&KQ(this,s,{},n))&&(i[s]=r)}writeOperationalLayerType(r,i,s){r&&(i[s]=r)}writeTitle(r,i){i.title=r??"Layer"}readVisibilityTimeExtent(r){return r?fr.fromArray(r):null}writeVisibilityTimeExtent(r,i,s,n){r&&n.layerContainerType!=="tables"&&(r.isEmpty?n?.messages&&n.messages.push(new F("layer:invalid-visibilityTimeExtent","visibilityTimeExtent cannot be empty")):i[s]=r.toArray())}read(r,i){i&&(i.layer=this),JQ(this,r,(s=>super.read(r,s)),i)}write(r,i){if(!this.persistenceEnabled&&!i?.ignorePersistenceEnabled)return null;if(i?.origin){const o=`${i.origin}/${i.layerContainerType||"operational-layers"}`;let l=!!fAe[o]?.[this.operationalLayerType];if(this.operationalLayerType==="ArcGISTiledElevationServiceLayer"&&o==="web-scene/operational-layers"&&(l=!1),this.operationalLayerType==="ArcGISDimensionLayer"&&o==="web-map/operational-layers"&&(l=!1),!l)return i.messages?.push(new F("layer:unsupported",`Layers (${this.title}, ${this.id}) of type '${this.declaredClass}' are not supported in the context of '${o}'`,{layer:this})),null}const s=super.write(r,{...i,layer:this}),n=!!i&&!!i.messages&&!!i.messages.filter((o=>o instanceof F&&o.name==="web-document-write:property-required")).length;return Cm(s?.url)?(i?.messages?.push(new F("layer:invalid-url",`Layer (${this.title}, ${this.id}) of type '${this.declaredClass}' using a Blob URL cannot be written to web scenes and web maps`,{layer:this})),null):!this.url&&n?null:s}beforeSave(){}};return c([d({type:String,json:{write:{ignoreOrigin:!0},origins:{"web-scene":{write:{isRequired:!0,ignoreOrigin:!0}},"portal-item":{write:!1}}}})],e.prototype,"id",void 0),c([K("id",["id"])],e.prototype,"readId",null),c([d(nJ)],e.prototype,"listMode",void 0),c([re("listMode")],e.prototype,"writeListMode",null),c([d({type:String,readOnly:!0,json:{read:!1,write:{target:"layerType",ignoreOrigin:!0},origins:{"portal-item":{write:!1},"web-scene":{name:"layerType",read:!1,write:{enabled:!0,ignoreOrigin:!0,layerContainerTypes:ft,isRequired:!0}}}}})],e.prototype,"operationalLayerType",void 0),c([re("operationalLayerType")],e.prototype,"writeOperationalLayerType",null),c([d(bP)],e.prototype,"opacity",void 0),c([d({type:Boolean,readOnly:!1})],e.prototype,"persistenceEnabled",void 0),c([d({type:String,json:{write:{ignoreOrigin:!0,writerEnsuresNonNull:!0},origins:{"web-scene":{write:{isRequired:!0,ignoreOrigin:!0,writerEnsuresNonNull:!0}},"portal-item":{write:!1}}},value:"Layer"})],e.prototype,"title",void 0),c([re("title"),re(["web-scene"],"title")],e.prototype,"writeTitle",null),c([d({type:fr,json:{origins:{"web-scene":{write:{layerContainerTypes:ft}}}}})],e.prototype,"visibilityTimeExtent",void 0),c([K("visibilityTimeExtent")],e.prototype,"readVisibilityTimeExtent",null),c([re(["portal-item","web-map","web-scene"],"visibilityTimeExtent",{visibilityTimeExtent:{type:[[qe,ZS]]}})],e.prototype,"writeVisibilityTimeExtent",null),c([d({type:Boolean,json:{name:"visibility",write:{layerContainerTypes:ft}}})],e.prototype,"visible",void 0),e=c([C("esri.layers.mixins.OperationalLayer")],e),e};var LP;const d1=new De({asc:"ascending",desc:"descending"});var tm;let kh=(tm=class extends W{constructor(e){super(e),this.field=null,this.valueExpression=null,this.order="ascending"}clone(){return new LP({field:this.field,valueExpression:this.valueExpression,order:this.order})}},LP=tm,tm);c([d({type:String,json:{write:!0}})],kh.prototype,"field",void 0),c([d({type:String,json:{write:!0,origins:{"web-scene":{read:!1,write:!1}}}})],kh.prototype,"valueExpression",void 0),c([d({type:d1.apiValues,json:{type:d1.jsonValues,read:d1.read,write:d1.write}})],kh.prototype,"order",void 0),kh=LP=c([C("esri.layers.support.OrderByInfo")],kh);function yAe(t,e,r){if(!t)return null;const i=t.find((n=>!!n.field));if(!i)return null;const s=new kh;return s.read(i,r),[s]}function gAe(t,e,r,i){const s=t.find((n=>!!n.field));s&&Cr(r,[s.toJSON()],e)}const vAe={type:[kh],json:{origins:{"web-scene":{write:!1,read:!1}},name:"layerDefinition.orderBy",read:{reader:yAe},write:{writer:gAe}}},_Ae=t=>{let e=class extends t{constructor(){super(...arguments),this.orderBy=null}};return c([d(vAe)],e.prototype,"orderBy",void 0),e=c([C("esri.layers.mixins.OrderedLayer")],e),e},bAe=t=>{let e=class extends t{constructor(){super(...arguments),this.resourceReferences={portalItem:null,paths:[]},this.userHasEditingPrivileges=!0,this.userHasFullEditingPrivileges=!1,this.userHasUpdateItemPrivileges=!1}destroy(){this.portalItem=At(this.portalItem),this.resourceReferences.portalItem=null,this.resourceReferences.paths.length=0}set portalItem(r){r!==this._get("portalItem")&&(this.removeOrigin("portal-item"),this._set("portalItem",r))}readPortalItem(r,i,s){if(i.itemId)return new Ee({id:i.itemId,portal:s?.portal})}writePortalItem(r,i){r?.id&&(i.itemId=r.id)}async loadFromPortal(r,i){if(this.portalItem?.id)try{const{load:s}=await J(()=>import("./layersLoader-4g6LI2h-.js"),__vite__mapDeps([266,8,7,9,267]));return xt(i),await s({instance:this,supportedTypes:r.supportedTypes,validateItem:r.validateItem,supportsData:r.supportsData,layerModuleTypeMap:r.layerModuleTypeMap,populateGroupLayer:r.populateGroupLayer},i)}catch(s){throw xi(s)||q.getLogger(this).warn(`Failed to load layer (${this.title}, ${this.id}) portal item (${this.portalItem.id})
  ${s}`),s}}async finishLoadEditablePortalLayer(r){this._set("userHasEditingPrivileges",await this._fetchUserHasEditingPrivileges(r).catch((i=>(Do(i),!0))))}async setUserPrivileges(r,i){if(!Ge.userPrivilegesApplied)return this.finishLoadEditablePortalLayer(i);if(this.url)try{const{features:{edit:s,fullEdit:n},content:{updateItem:o}}=await this._fetchUserPrivileges(r,i);this._set("userHasEditingPrivileges",s),this._set("userHasFullEditingPrivileges",n),this._set("userHasUpdateItemPrivileges",o)}catch(s){Do(s)}}async _fetchUserPrivileges(r,i){let s=this.portalItem;if(!r||!s||!s.loaded||s.sourceUrl)return this._fetchFallbackUserPrivileges(i);const n=!Ve?.findCredential(this.url),o=r===s.id;if(o&&s.portal.user)return this._getUserPrivileges(s,n);let a,l;if(o)a=s.portal.url;else try{a=await z3(this.url,i)}catch(m){Do(m)}if(!a||!tX(a,s.portal.url))return this._fetchFallbackUserPrivileges(i);try{const m=i!=null?i.signal:null;l=await Ve?.getCredential(`${a}/sharing`,{prompt:!1,signal:m})}catch(m){Do(m)}const u=!0,h=!1,p=!1;if(!l)return{features:{edit:u,fullEdit:h},content:{updateItem:p}};try{if(o?await s.reload():(s=new Ee({id:r,portal:{url:a}}),await s.load(i)),s.portal.user)return this._getUserPrivileges(s,n)}catch(m){Do(m)}return{features:{edit:u,fullEdit:h},content:{updateItem:p}}}_getUserPrivileges(r,i){const s=B3e(r);return i&&(s.features.edit=!0),s}async _fetchFallbackUserPrivileges(r){let i=!0;try{i=await this._fetchUserHasEditingPrivileges(r)}catch(s){Do(s)}return{features:{edit:i,fullEdit:!1},content:{updateItem:!1}}}async _fetchUserHasEditingPrivileges(r){const i=this.url?Ve?.findCredential(this.url):null;if(!i)return!0;const s=p1.credential===i?p1.user:await this._fetchEditingUser(r);return p1.credential=i,p1.user=s,s?.privileges==null||s.privileges.includes("features:user:edit")}async _fetchEditingUser(r){const i=this.portalItem?.portal?.user;if(i)return i;const s=Ve?.findServerInfo(this.url??"");if(!s?.owningSystemUrl)return null;const n=`${s.owningSystemUrl}/sharing/rest`,o=Y.getDefault();if(o&&o.loaded&&fn(o.restUrl)===fn(n))return o.user;const a=`${n}/community/self`,l=r!=null?r.signal:null,u=await JS(et(a,{authMode:"no-prompt",query:{f:"json"},signal:l}));return u.ok?at.fromJSON(u.value.data):null}read(r,i){i&&(i.layer=this),super.read(r,i)}write(r,i){const s=i?.portal,n=this.portalItem?.id&&(this.portalItem.portal||Y.getDefault());return s&&n&&!$z(n.restUrl,s.restUrl)?(i.messages&&i.messages.push(new F("layer:cross-portal",`The layer '${this.title} (${this.id})' cannot be persisted because it refers to an item on a different portal than the one being saved to. To save, set layer.portalItem to null or save to the same portal as the item associated with the layer`,{layer:this})),null):super.write(r,{...i,layer:this})}};return c([d({type:Ee})],e.prototype,"portalItem",null),c([K("web-document","portalItem",["itemId"])],e.prototype,"readPortalItem",null),c([re("web-document","portalItem",{itemId:{type:String}})],e.prototype,"writePortalItem",null),c([d({clonable:!1})],e.prototype,"resourceReferences",void 0),c([d({type:Boolean,readOnly:!0})],e.prototype,"userHasEditingPrivileges",void 0),c([d({type:Boolean,readOnly:!0})],e.prototype,"userHasFullEditingPrivileges",void 0),c([d({type:Boolean,readOnly:!0})],e.prototype,"userHasUpdateItemPrivileges",void 0),e=c([C("esri.layers.mixins.PortalLayer")],e),e},p1={credential:null,user:null};let Bg=class extends ce{constructor(){super(...arguments),this.updating=!1,this.status="unknown"}};c([d()],Bg.prototype,"updating",void 0),c([d()],Bg.prototype,"status",void 0),Bg=c([C("esri.layers.support.PublishingInfo")],Bg);const wAe=Symbol(),SAe=t=>{var i;var e;let r=(i=class extends t{constructor(){super(...arguments),this[e]=!0}get publishingInfo(){if(this.destroyed)return null;const s=this._get("publishingInfo");if(s)return s;const n=new Bg;return this._checkPublishingStatus(n),n}_checkPublishingStatus(s){let a=0;const l=async h=>{let p;s.updating=!0;try{p=await this.fetchPublishingStatus()}catch{p="unavailable"}p!=="published"&&p!=="unavailable"||(s.status==="publishing"&&this.refresh(),u.remove()),s.status=p,s.updating=!1,u.removed||(a=setTimeout(l,h,h+125))},u={removed:!1,remove(){this.removed=!0,clearTimeout(a)}};this.when().catch((()=>u.remove())),l(250),this.addHandles(u)}},e=wAe,i);return c([d({readOnly:!0,clonable:!1})],r.prototype,"publishingInfo",null),r=c([C("esri.layers.mixins.PublishableLayer")],r),r},Xu=new se,$0=new WeakMap;function xAe(t){MAe(t)&&Xu.push(new WeakRef(t))}function $Ae(t){const e=Xu.find((r=>r.deref()===t));e&&Xu.remove(e)}function MAe(t){return t!=null&&typeof t=="object"&&"refreshInterval"in t&&"refresh"in t}function $J(t,e){return Number.isFinite(t)&&Number.isFinite(e)?e<=0?t:$J(e,t%e):0}let aM=0,f1=0;function TAe(){const t=Date.now();let e=!1;for(const r of Xu){const i=r.deref();i?i.refreshInterval&&t-($0.get(i)??0)+5>=6e4*i.refreshInterval&&($0.set(i,t),i.refresh(t)):e=!0}if(e)for(let r=Xu.length-1;r>=0;r--)Xu.at(r).deref()||Xu.removeAt(r)}yV((()=>{const t=Date.now();let e=0;for(const r of Xu){const i=r.deref();i&&(e=$J(Math.round(6e4*i.refreshInterval),e),i.refreshInterval?$0.get(i)||$0.set(i,t):$0.delete(i))}if(e!==f1){if(f1=e,clearInterval(aM),f1===0)return void(aM=0);aM=setInterval(TAe,f1)}}),Ma);const B6=.1,EAe=t=>{let e=class extends t{constructor(...r){super(...r),this.refreshInterval=0,this.refreshTimestamp=0,this._debounceHasDataChanged=US((()=>this.hasDataChanged())),this.when().then((()=>{this.destroyed||xAe(this)}),(()=>{}))}destroy(){$Ae(this)}castRefreshInterval(r){return r>=B6?r:r<=0?0:B6}get refreshParameters(){return{_ts:this.refreshTimestamp||null}}refresh(r=Date.now()){gM(this._debounceHasDataChanged()).then((i=>{i&&this._set("refreshTimestamp",r),this.emit("refresh",{dataChanged:i})}),(i=>{q.getLogger(this).error(i),this.emit("refresh",{dataChanged:!1,error:i})}))}async hasDataChanged(){return!0}get test(){}};return c([d({type:Number,json:{write:!0,origins:{"web-scene":{write:{enabled:!0,layerContainerTypes:ft}}}}})],e.prototype,"refreshInterval",void 0),c([We("refreshInterval")],e.prototype,"castRefreshInterval",null),c([d({readOnly:!0})],e.prototype,"refreshTimestamp",void 0),c([d({readOnly:!0})],e.prototype,"refreshParameters",null),e=c([C("esri.layers.mixins.RefreshableLayer")],e),e},IAe=t=>{let e=class extends t{constructor(){super(...arguments),this.minScale=0,this.maxScale=0}get effectiveScaleRange(){const r={minScale:this.minScale,maxScale:this.maxScale},i=this.parent;i&&"effectiveScaleRange"in i&&CAe(r,i.effectiveScaleRange);const s=this._get("effectiveScaleRange");return s&&s.minScale===r.minScale&&s.maxScale===r.maxScale?s:r}};return c([d({type:Number,nonNullable:!0,json:{write:!0}})],e.prototype,"minScale",void 0),c([d({type:Number,nonNullable:!0,json:{write:!0}})],e.prototype,"maxScale",void 0),c([d({readOnly:!0})],e.prototype,"effectiveScaleRange",null),e=c([C("esri.layers.mixins.ScaleRangeLayer")],e),e};function CAe(t,e){return t.minScale=t.minScale>0?e.minScale>0?Math.min(t.minScale,e.minScale):t.minScale:e.minScale,t.maxScale=t.maxScale>0?e.maxScale>0?Math.max(t.maxScale,e.maxScale):t.maxScale:e.maxScale,t}const MJ=Wr()({esriTimeUnitsMilliseconds:"milliseconds",esriTimeUnitsSeconds:"seconds",esriTimeUnitsMinutes:"minutes",esriTimeUnitsHours:"hours",esriTimeUnitsDays:"days",esriTimeUnitsWeeks:"weeks",esriTimeUnitsMonths:"months",esriTimeUnitsYears:"years",esriTimeUnitsDecades:"decades",esriTimeUnitsCenturies:"centuries",esriTimeUnitsUnknown:void 0});let Ll=class extends Ce.ClonableMixin(W){constructor(e){super(e),this.unit="milliseconds",this.value=0}toMilliseconds(){return p9(this.value,this.unit,"milliseconds")}};c([ye(MJ,{nonNullable:!0})],Ll.prototype,"unit",void 0),c([d({type:Number,json:{write:!0},nonNullable:!0})],Ll.prototype,"value",void 0),Ll=c([C("esri.time.TimeInterval")],Ll);function q6(t,e){return Ll.fromJSON({value:t,unit:e})}let Dr=class extends Ce.ClonableMixin(W){constructor(e){super(e),this.cumulative=!1,this.endField=null,this.fullTimeExtent=null,this.hasLiveData=!1,this.interval=null,this.startField=null,this.timeZone=null,this.trackIdField=null,this.useTime=!0,this.stops=null}readFullTimeExtent(e,r){return r.timeExtent&&Array.isArray(r.timeExtent)&&r.timeExtent.length===2?fr.fromArray(r.timeExtent):null}writeFullTimeExtent(e,r){e?.start!=null&&e.end!=null?r.timeExtent=e.toArray():r.timeExtent=null}readInterval(e,r){return r.timeInterval&&r.timeIntervalUnits?q6(r.timeInterval,r.timeIntervalUnits):r.defaultTimeInterval&&r.defaultTimeIntervalUnits?q6(r.defaultTimeInterval,r.defaultTimeIntervalUnits):null}writeInterval(e,r){r.timeInterval=e?.toJSON().value??null,r.timeIntervalUnits=e?.toJSON().unit??null}};c([d({type:Boolean,json:{name:"exportOptions.timeDataCumulative",write:!0}})],Dr.prototype,"cumulative",void 0),c([d({type:String,json:{name:"endTimeField",write:{enabled:!0,allowNull:!0}}})],Dr.prototype,"endField",void 0),c([d({type:fr,json:{write:{enabled:!0,allowNull:!0}}})],Dr.prototype,"fullTimeExtent",void 0),c([K("fullTimeExtent",["timeExtent"])],Dr.prototype,"readFullTimeExtent",null),c([re("fullTimeExtent")],Dr.prototype,"writeFullTimeExtent",null),c([d({type:Boolean,json:{write:!0}})],Dr.prototype,"hasLiveData",void 0),c([d({type:Ll,json:{write:{enabled:!0,allowNull:!0}}})],Dr.prototype,"interval",void 0),c([K("interval",["timeInterval","timeIntervalUnits","defaultTimeInterval","defaultTimeIntervalUnits"])],Dr.prototype,"readInterval",null),c([re("interval")],Dr.prototype,"writeInterval",null),c([d({type:String,json:{name:"startTimeField",write:{enabled:!0,allowNull:!0}}})],Dr.prototype,"startField",void 0),c([d(ww("timeReference",!0))],Dr.prototype,"timeZone",void 0),c([d({type:String,json:{write:{enabled:!0,allowNull:!0}}})],Dr.prototype,"trackIdField",void 0),c([d({type:Boolean,json:{name:"exportOptions.useTime",write:!0}})],Dr.prototype,"useTime",void 0),c([d({type:[Date],json:{read:!1}})],Dr.prototype,"stops",void 0),Dr=c([C("esri.layers.support.TimeInfo")],Dr);const PAe={type:Boolean,json:{read:{source:"timeAnimation"},write:{target:"timeAnimation",layerContainerTypes:ft}}},AAe=t=>{let e=class extends t{constructor(){super(...arguments),this.timeExtent=null,this.timeOffset=null,this.useViewTime=!0}readOffset(r,i){const s=i.timeInfo.exportOptions;if(!s)return null;const n=s.timeOffset,o=MJ.fromJSON(s.timeOffsetUnits);return n&&o?new Ll({value:n,unit:o}):null}set timeInfo(r){X9(r,this.fieldsIndex),this._set("timeInfo",r)}};return c([d({type:fr,json:{write:!1}})],e.prototype,"timeExtent",void 0),c([d({type:Ll})],e.prototype,"timeOffset",void 0),c([K("service","timeOffset",["timeInfo.exportOptions"])],e.prototype,"readOffset",null),c([d({value:null,type:Dr,json:{write:!0,origins:{"web-document":{read:!1,write:!1},"portal-item":{read:!1,write:!1}}}})],e.prototype,"timeInfo",null),c([d(PAe)],e.prototype,"useViewTime",void 0),e=c([C("esri.layers.mixins.TemporalLayer")],e),e};let nn=class extends Ce.ClonableMixin(W){constructor(e){super(e),this.labelingInfo=null,this.labelsVisible=!0,this.renderer=null,this.visible=!0}};c([d({type:[wt],json:{write:!0}})],nn.prototype,"labelingInfo",void 0),c([d(nx)],nn.prototype,"labelsVisible",void 0),c([d({types:Hv,json:{write:!0}})],nn.prototype,"renderer",void 0),c([d({type:Boolean,json:{write:!0}})],nn.prototype,"visible",void 0),nn=c([C("esri.layers.support.TrackPartInfo")],nn);let Qi=class extends Ce.ClonableMixin(W){constructor(e){super(e),this.enabled=!0,this.fields=[],this.latestObservations=new nn({renderer:new ji({symbol:pS.clone()})}),this.maxDisplayDuration=null,this.maxDisplayObservationsPerTrack=0,this.popupEnabled=!0,this.popupTemplate=null,this.previousObservations=new nn({renderer:new ji({symbol:pS.clone()})}),this.trackLines=new nn({renderer:new ji({symbol:q2.clone()})}),this.timeField="startTimeField"}writeFields(e,r,i){const s=e.filter((n=>n.statisticType!=="avg_angle")).map((n=>n.toJSON()));Cr(i,s,r)}};c([d({type:Boolean,json:{write:!0}})],Qi.prototype,"enabled",void 0),c([d({type:[yi],json:{write:!0}})],Qi.prototype,"fields",void 0),c([re("fields")],Qi.prototype,"writeFields",null),c([d({type:nn,json:{write:!0}})],Qi.prototype,"latestObservations",void 0),c([d({type:Ll,json:{write:!0}})],Qi.prototype,"maxDisplayDuration",void 0),c([d({type:Number,json:{write:!0}})],Qi.prototype,"maxDisplayObservationsPerTrack",void 0),c([d(sx)],Qi.prototype,"popupEnabled",void 0),c([d({type:Gm,json:{name:"popupInfo",write:!0}})],Qi.prototype,"popupTemplate",void 0),c([d({type:nn,json:{write:!0}})],Qi.prototype,"previousObservations",void 0),c([d({type:nn,json:{write:!0}})],Qi.prototype,"trackLines",void 0),c([d({type:["timeReceived","startTimeField","endTimeField"],json:{read:!0,write:!0}})],Qi.prototype,"timeField",void 0),Qi=c([C("esri.layers.support.TrackInfo")],Qi);const LAe=t=>{let e=class extends t{constructor(){super(...arguments),this.trackInfo=null}};return c([d({type:Qi})],e.prototype,"trackInfo",void 0),e=c([C("esri.layers.mixins.TrackableLayer")],e),e},H6=new De({esriFeatureEditToolAutoCompletePolygon:"auto-complete-polygon",esriFeatureEditToolCircle:"circle",esriFeatureEditToolEllipse:"ellipse",esriFeatureEditToolFreehand:"freehand",esriFeatureEditToolLine:"line",esriFeatureEditToolNone:"none",esriFeatureEditToolPoint:"point",esriFeatureEditToolPolygon:"polygon",esriFeatureEditToolRectangle:"rectangle",esriFeatureEditToolArrow:"arrow",esriFeatureEditToolTriangle:"triangle",esriFeatureEditToolLeftArrow:"left-arrow",esriFeatureEditToolRightArrow:"right-arrow",esriFeatureEditToolUpArrow:"up-arrow",esriFeatureEditToolDownArrow:"down-arrow"});let No=class extends Ce.ClonableMixin(W){constructor(e){super(e),this.name=null,this.description=null,this.drawingTool=null,this.prototype=null,this.thumbnail=null}};c([d({json:{write:!0}})],No.prototype,"name",void 0),c([d({json:{write:!0}})],No.prototype,"description",void 0),c([d({json:{read:H6.read,write:H6.write}})],No.prototype,"drawingTool",void 0),c([d({json:{write:!0}})],No.prototype,"prototype",void 0),c([d({json:{write:!0}})],No.prototype,"thumbnail",void 0),No=c([C("esri.layers.support.FeatureTemplate")],No);let Ro=class extends Ce.ClonableMixin(W){constructor(e){super(e),this.id=null,this.name=null,this.domains=null,this.templates=null}readDomains(e){const r={};for(const i of Object.keys(e))r[i]=T2(e[i]);return r}writeDomains(e,r){const i={};for(const s of Object.keys(e))e[s]&&(i[s]=e[s]?.toJSON());r.domains=i}};c([d({json:{write:!0}})],Ro.prototype,"id",void 0),c([d({json:{write:!0}})],Ro.prototype,"name",void 0),c([d({json:{write:!0}})],Ro.prototype,"domains",void 0),c([K("domains")],Ro.prototype,"readDomains",null),c([re("domains")],Ro.prototype,"writeDomains",null),c([d({type:[No],json:{write:!0}})],Ro.prototype,"templates",void 0),Ro=c([C("esri.layers.support.FeatureType")],Ro);function RAe(){return{fields:{type:[Vr],value:null,set:function(t){if(t&&z("big-integer-warning-enabled")){const e=t.filter((r=>r.type==="big-integer"||r.type==="oid"&&(r.length||0)>=8));if(e.length){const r=e.map((i=>`'${i.name}'`)).join(", ");q.getLogger(this).warn("#fields",`Layer (title: '${this.title??"no title"}', id: '${this.id??"no id"}') references big-integer field(s): ${r}, support for which is experimental. Only integers less than ${Number.MAX_SAFE_INTEGER} (Number.MAX_SAFE_INTEGER) are supported.`)}}this._set("fields",t)}},fieldsIndex:{readOnly:!0,get(){return tv.fromLayer(this)}},outFields:{type:[String],json:{read:!1},set:function(t){this._userOutFields=t,this.notifyChange("outFields")},get:function(){const t=this._userOutFields;if(!t?.length)return null;if(t.includes("*"))return["*"];if(!this.fields)return t;for(const e of t)this.fieldsIndex?.has(e)||q.getLogger("esri.layers.support.fieldProperties").error("field-attributes-layer:invalid-field",`Invalid field ${e} found in outFields`,{layer:this,outFields:t});return w2(this.fieldsIndex,t)}}}}const lM=()=>q.getLogger("esri.layers.support.labelingInfo"),kAe=/\[([^[\]]+)\]/gi;function W6(t,e,r){return t?t.map((i=>{const s=new wt;if(s.read(i,r),s.labelExpression){const n=e.fields||e.layerDefinition?.fields||this.fields;s.labelExpression=s.labelExpression.replaceAll(kAe,((o,a)=>`[${OAe(a,n)}]`))}return s})):null}function OAe(t,e){if(!e)return t;const r=t.toLowerCase();for(let i=0;i<e.length;i++){const s=e[i].name;if(s.toLowerCase()===r)return s}return t}const Z6=["above-right","above-center","above-left","center-center","center-left","center-right","below-center","below-left","below-right"],NAe={esriGeometryPoint:Z6,esriGeometryMultiPatch:["always-horizontal"],esriGeometryPolygon:["always-horizontal"],esriGeometryPolyline:["center-along","above-along","below-along"],esriGeometryMultipoint:Z6,esriGeometryEnvelope:null};function T8e(t,e){const r=[];for(const i of t){const s=i.labelPlacement,n=NAe[e];if(!i.symbol)return lM().warn("No ILabelClass symbol specified."),[];if(!n)return lM().error(new F("labeling:unsupported-geometry-type",`Unable to create labels for layer, geometry type '${e}' is not supported`)),[];if(n.includes(s))r.push(i);else{const o=n[0];s&&lM().warn(`Found invalid label placement type ${s} for ${e}. Defaulting to ${o}`);const a=i.clone();a.labelPlacement=o,r.push(a)}}return r}const FAe="relationships/",DAe="expression/";let Ci=class extends ce{constructor(t){super(t),this._featureUtils=null,this.effectivePopupTemplate=null}get _arcadeTask(){return this.expressionsUsedInTitle.length>0?this._get("_arcadeTask")||YS((()=>jl())):null}get featureUtilsPromise(){return this._get("featureUtilsPromise")??J(()=>import("./featureUtils-DZAb1560.js"),[]).then((t=>this._featureUtils=t))}get calculatedExpressions(){const t=new se;if(!this.expressionsUsedInTitle.length)return t;if(!this._arcadeTask?.value){for(const e of this.expressionsUsedInTitle??[])t.push({name:e.name,invalid:!0});return t}for(const e of this.expressionsUsedInTitle)try{const r=this._arcadeTask.value.arcade.parseScript(e.expression,["$layer","$map","$datastore"]);if(r.isAsync){t.push({name:e.name,invalid:!0});break}t.push({name:e.name,syntax:r,invalid:!1,func:this._arcadeTask.value.arcade.compileScript(r,{vars:{$feature:"any"}})})}catch{t.push({name:e.name,invalid:!0});break}return t}get expressionsUsedInTitle(){let t=this.effectivePopupTemplate?.title??"";return typeof t!="string"?[]:(t=t.toLowerCase(),this.effectivePopupTemplate?.expressionInfos?.filter((e=>t.includes(`{expression/${e.name.toLowerCase()}}`)))??[])}get fieldInfoMap(){return this._featureUtils?this._createFieldInfoMap(this._featureUtils.getAllFieldInfos(this.effectivePopupTemplate)):null}get hasBadExpressions(){return this.calculatedExpressions.some((t=>t.invalid===!0))}get requiredFields(){const t=new Set;if(this._arcadeTask?.value&&!this.hasBadExpressions)for(const r of this.calculatedExpressions?.toArray()??[])try{const i=this._arcadeTask.value.arcade.extractFieldLiterals(r.syntax);for(const s of i){const n=s.split("."),o=this.fieldsIndex.get(n.at(-1)??"");o&&t.add(o.name)}}catch{}const e=this._extractFieldNames(this.workingTitle);for(const r of e){const i=this.fieldsIndex.get(r);i&&t.add(i.name)}return this.objectIdField!=null&&t.add(this.objectIdField),t}get titleFromDisplayField(){let t="";return this.displayField&&(t=this.fieldsIndex.get(this.displayField)?.name??""),t||(t=this.fieldsIndex.get(this.objectIdField)?.name??""),t?`{${t}}`:""}get workingTitle(){const t=this.effectivePopupTemplate?this.effectivePopupTemplate.title:"";return t===""||t==null||this.hasBadExpressions||typeof t!="string"?this.titleFromDisplayField:t}async getTitle(t,e,r){const i=e.getObjectId()??e.attributes[t.objectIdField];return(await this.getTitles(t,[e],r)).get(i)??""}async getTitles(t,e,r){const i=new Map,s=r?.timeZone??"system";try{const[{substituteFieldsInLinksAndAttributes:n}]=await Promise.all([this.featureUtilsPromise,this._arcadeTask?.promise]);r?.fetchMissingFields&&(e=await this._checkAndReQueryGraphics(t,e));const{fieldInfoMap:o,workingTitle:a}=this,l=a&&o;e.forEach((u=>{const h=u.getObjectId()??u.attributes[t.objectIdField],p=l?n({attributes:u.attributes,expressionAttributes:null,fieldInfoMap:o,globalAttributes:this._createFormattedAttributes(t,u,s).global,layer:t,text:a}):"";i.set(h,p)}))}catch{}return i}async _checkAndReQueryGraphics(t,e){const r=e.map((i=>i.getObjectId()??i.attributes[t.objectIdField])).filter(ii);if(r.length!==e.length)return e;if(e.some((i=>!qce(i,this.requiredFields)))){const i=t.createQuery();i.where="1=1",i.outFields=[...this.requiredFields],i.objectIds=r;const s=await t.queryFeatures(i);if(s?.features.length===e.length)return s.features}return e}_createFieldInfoMap(t){const e=new Map;if(!t)return e;for(const r of t){if(!r.fieldName)continue;const i=this.fieldsIndex.get(r.fieldName),s=i?.name??r.fieldName;r.fieldName=s,e.set(s.toLowerCase(),r)}return e}_createFormattedAttributes(t,e,r="system"){const i=this.effectivePopupTemplate?.fieldInfos??[],s={};if(!this._featureUtils)return{};if(!this.hasBadExpressions&&this.calculatedExpressions.length>0&&this._arcadeTask?.value){const o=this._arcadeTask.value.Feature.createFromGraphicLikeObject(e.geometry,e.attributes,t,null);for(const a of this.calculatedExpressions)try{s[`expression/${a.name}`]=a.func({vars:{$feature:o}})}catch{}}const n={...e.attributes,...s};return{global:this._featureUtils.formatAttributes({fieldInfos:i,attributes:n,graphic:e,timeZone:r,layer:t,fieldInfoMap:this.fieldInfoMap}),content:[]}}_extractFieldNames(t){return uA(t).filter((e=>!(e.indexOf(FAe)===0||e.indexOf(DAe)===0)))}};c([d({readOnly:!0})],Ci.prototype,"_arcadeTask",null),c([d()],Ci.prototype,"_featureUtils",void 0),c([d({readOnly:!0})],Ci.prototype,"featureUtilsPromise",null),c([d({readOnly:!0})],Ci.prototype,"calculatedExpressions",null),c([d()],Ci.prototype,"displayField",void 0),c([d()],Ci.prototype,"effectivePopupTemplate",void 0),c([d()],Ci.prototype,"expressionsUsedInTitle",null),c([d()],Ci.prototype,"fieldsIndex",void 0),c([d()],Ci.prototype,"fieldInfoMap",null),c([d()],Ci.prototype,"fields",void 0),c([d()],Ci.prototype,"objectIdField",void 0),c([d()],Ci.prototype,"requiredFields",null),Ci=c([C("esri.layers.support.TitleCreator")],Ci);const Gp=[];function zAe(t,e){if(qb(t.url??""))return!0;const{wkid:r}=e;for(const i of Gp){if((t.version??0)>=i[0])return!0;if(typeof i[1]=="function"&&(i[1]=i[1]()),i[1].has(r))return!1}return!0}Gp.push([10.91,()=>{const t=new Set([9709,9716,9741,9761,9766]);for(let e=9712;e<=9713;e++)t.add(e);for(let e=9748;e<=9749;e++)t.add(e);for(let e=20904;e<=20932;e++)t.add(e);for(let e=21004;e<=21032;e++)t.add(e);for(let e=21207;e<=21264;e++)t.add(e);for(let e=21307;e<=21364;e++)t.add(e);for(let e=23301;e<=23333;e++)t.add(e);for(let e=102759;e<=102760;e++)t.add(e);for(let e=102934;e<=102955;e++)t.add(e);return t}]),Gp.push([10.9,()=>{const t=new Set([9300,9354,9364,9367,9373,9377,9387,9456,9473,9498,9678,9680,29874,103599,103872,104028]);for(let e=9356;e<=9360;e++)t.add(e);for(let e=9404;e<=9407;e++)t.add(e);for(let e=9476;e<=9482;e++)t.add(e);for(let e=9487;e<=9494;e++)t.add(e);for(let e=9697;e<=9699;e++)t.add(e);return t}]),Gp.push([10.81,()=>{const t=new Set([9265,9333,103598,103699]);for(let e=9248;e<=9254;e++)t.add(e);for(let e=9271;e<=9273;e++)t.add(e);for(let e=9284;e<=9285;e++)t.add(e);for(let e=21453;e<=21463;e++)t.add(e);return t}]),Gp.push([10.8,()=>{const t=new Set([8088,8395,8428,8433,8531,8687,8692,8694,8699,8900,9003,9006,9009,9012,9017,9191]);for(let e=8035;e<=8036;e++)t.add(e);for(let e=8455;e<=8456;e++)t.add(e);for(let e=8518;e<=8529;e++)t.add(e);for(let e=8533;e<=8536;e++)t.add(e);for(let e=8538;e<=8540;e++)t.add(e);for(let e=8677;e<=8679;e++)t.add(e);for(let e=8902;e<=8903;e++)t.add(e);for(let e=8907;e<=8910;e++)t.add(e);for(let e=8949;e<=8951;e++)t.add(e);for(let e=8972;e<=8987;e++)t.add(e);for(let e=9039;e<=9040;e++)t.add(e);for(let e=9068;e<=9069;e++)t.add(e);for(let e=9140;e<=9141;e++)t.add(e);for(let e=9148;e<=9150;e++)t.add(e);for(let e=9153;e<=9159;e++)t.add(e);for(let e=9205;e<=9218;e++)t.add(e);for(let e=9221;e<=9222;e++)t.add(e);for(let e=54098;e<=54101;e++)t.add(e);return t}]),Gp.push([10.71,()=>{const t=new Set([6316]);for(let e=8351;e<=8353;e++)t.add(e);for(let e=9294;e<=9297;e++)t.add(e);for(let e=22619;e<=22621;e++)t.add(e);for(let e=103586;e<=103594;e++)t.add(e);return t}]);async function VAe(t,e,r){const i=t&&t.getAtOrigin&&t.getAtOrigin("renderer",e.origin);if(i&&i.type==="unique-value"&&i.styleOrigin){const s=await JS(i.populateFromStyle());if(xt(r),s.ok===!1){const n=s.error;e?.messages&&e.messages.push(new Fs("renderer:style-reference",`Failed to create unique value renderer from style reference: ${n.message}`,{error:n,context:e})),t.clear("renderer",e?.origin)}}}function jAe({displayField:t,editFieldsInfo:e,fields:r,objectIdField:i,title:s},n){if(!r)return null;const o=qAe({editFieldsInfo:e,fields:r,objectIdField:i},n);if(!o.length)return null;const a=ZAe({titleBase:s,fields:r,displayField:t}),l=WAe();return new Gm({title:a,content:l,fieldInfos:o})}const UAe=(t,e)=>e.visibleFieldNames?e.visibleFieldNames.has(t.name):$ce(t,e);function GAe({fields:t,ignoreFieldTypes:e,sortDisabled:r}){const i=t;return e&&(t=t.filter((s=>!e.includes(s.type)))),t===i&&(t=t.slice()),r!==!0&&t.sort(BAe),t}function BAe(t,e){return t.type==="oid"?-1:e.type==="oid"?1:J6(t)?-1:J6(e)?1:(t.alias||t.name).toLocaleLowerCase().localeCompare((e.alias||e.name).toLocaleLowerCase())}function qAe(t,e){const r=e?.visibleFieldNames;return GAe({fields:t.fields??[],ignoreFieldTypes:e?.ignoreFieldTypes||JAe,sortDisabled:e?.sortDisabled}).map((i=>new cA({fieldName:i.name,isEditable:xce(i,t),label:i.alias,format:HAe(i),visible:UAe(i,{...t,visibleFieldNames:r})})))}function HAe(t){switch(t.type){case"small-integer":case"integer":case"single":return new B1({digitSeparator:!0,places:0});case"double":return new B1({digitSeparator:!0,places:2});case"string":return Wce(t.name)?new B1({digitSeparator:!0,places:0}):void 0;default:return}}function WAe(){return[new _m,new vm]}function ZAe(t){const e=fce(t),{titleBase:r}=t;return e?`${r}: {${e.trim()}}`:r??""}function J6(t){return(t.name&&t.name.toLowerCase())==="name"?!0:t.alias?.toLowerCase()==="name"}const JAe=["geometry","blob","raster","guid","xml"];var hf;(function(t){t[t.SAVE=0]="SAVE",t[t.SAVE_AS=1]="SAVE_AS"})(hf||(hf={}));const Jr="FeatureLayer";function m1(t,e){return new F("layer:unsupported",`Layer (${t.title}, ${t.id}) of type '${t.declaredClass}' ${e}`,{layer:t})}function Y6(t){return t&&t instanceof se}const uM=RAe();function cM(t,e,r){const i=!!r?.writeLayerSchema;return{enabled:i,ignoreOrigin:i}}let de=class extends q3e(pAe(EPe(SAe($Pe(gPe(mPe(_Ae(AAe(LAe(IAe(EAe(dPe(mAe(bAe(GZ(yPe(hPe(Ce.ClonableMixin(kt))))))))))))))))))){constructor(...t){super(...t),this.attributeTableTemplate=null,this.charts=null,this.copyright=null,this.displayField=null,this.dynamicDataSource=null,this.fields=null,this.fieldsIndex=null,this.formTemplate=null,this.fullExtent=null,this.geometryType=null,this.hasM=void 0,this.hasZ=void 0,this.infoFor3D=null,this.isTable=!1,this.labelsVisible=!0,this.labelingInfo=null,this.legendEnabled=!0,this.objectIdField=null,this.operationalLayerType="ArcGISFeatureLayer",this.outFields=null,this.path=null,this.popupEnabled=!0,this.popupTemplate=null,this.resourceInfo=null,this.screenSizePerspectiveEnabled=!0,this.spatialReference=ne.WGS84,this.subtypeCode=null,this.supportedSourceTypes=new Set(["Feature Layer","Oriented Imagery Layer","Table","Catalog Layer"]),this.templates=null,this.timeInfo=null,this.title=null,this.sublayerTitleMode="item-title",this.type="feature",this.typeIdField=null,this.types=null,this.visible=!0,this._debouncedSaveOperations=US((async(e,r,i)=>{const{save:s,saveAs:n}=await J(()=>import("./featureLayerUtils-BHYhyg6k.js"),__vite__mapDeps([268,269,270,267,271,8]));switch(e){case hf.SAVE:return s(this,r);case hf.SAVE_AS:return n(this,i,r)}}))}destroy(){this.source?.destroy()}normalizeCtorArgs(t,e){return typeof t=="string"?{url:t,...e}:t}load(t){const e=t!=null?t.signal:null;if(this.portalItem?.loaded&&this.source)return this.addResolvingPromise(this.createGraphicsSource(e).then((i=>this.initLayerProperties(i)))),Promise.resolve(this);const r=this.loadFromPortal({supportedTypes:["Feature Service","Feature Collection","Scene Service"]},t).catch(Do).then((async()=>{if(this.url&&this.layerId==null&&/FeatureServer|MapServer\/*$/i.test(this.url)){const i=await this._fetchFirstValidLayerId(e);i!=null&&(this.layerId=i)}if(!this.url&&!this._hasMemorySource())throw new F("feature-layer:missing-url-or-source","Feature layer must be created with either a url or a source");return this.initLayerProperties(await this.createGraphicsSource(e))})).then((()=>d3e(this,"load",t)));return this.addResolvingPromise(r),Promise.resolve(this)}get _titleCreator(){const t=this._get("_titleCreator");return At(t),new Ci({fieldsIndex:this.fieldsIndex,objectIdField:this.objectIdField,fields:this.fields,displayField:this.displayField,effectivePopupTemplate:this.popupTemplate??this.defaultPopupTemplate})}readCapabilities(t,e){return e=e.layerDefinition||e,_J(e,this.url)}get createQueryVersion(){return this.commitProperty("definitionExpression"),this.commitProperty("dynamicDataSource"),this.commitProperty("timeExtent"),this.commitProperty("timeOffset"),this.commitProperty("geometryType"),this.commitProperty("gdbVersion"),this.commitProperty("historicMoment"),this.commitProperty("returnZ"),this.commitProperty("capabilities"),this.commitProperty("returnM"),(this._get("createQueryVersion")??0)+1}get editingEnabled(){return!(this.loaded&&!this.capabilities?.operations.supportsEditing)&&(this._isOverridden("editingEnabled")?this._get("editingEnabled"):this._hasMemorySource()||this.userHasEditingPrivileges)}set editingEnabled(t){this._overrideIfSome("editingEnabled",t)}readEditingEnabled(t,e){return this._readEditingEnabled(e,!1)}readEditingEnabledFromWebMap(t,e,r){return this._readEditingEnabled(e,!0,r)}writeEditingEnabled(t,e){this._writeEditingEnabled(t,e,!1)}writeEditingEnabledToWebMap(t,e,r,i){this._writeEditingEnabled(t,e,!0,i)}get effectiveEditingEnabled(){return m3e(this)}get featureTitleFields(){return[...this._titleCreator.requiredFields]}readIsTable(t,e){return(e=e?.layerDefinition??e).type==="Table"||!e.geometryType}writeIsTable(t,e,r,i){i?.writeLayerSchema&&Cr(r,t?"Table":"Feature Layer",e)}readGlobalIdField(t,e){return lJ(e.layerDefinition||e)}readObjectIdField(t,e){return uJ(e.layerDefinition||e)}get parsedUrl(){const t=Pr(this.url);return t!=null&&(this.dynamicDataSource!=null?t.path=ud(t.path,"dynamicLayer"):this.layerId!=null&&(t.path=ud(t.path,this.layerId.toString()))),t}get defaultPopupTemplate(){return this.createPopupTemplate()}set renderer(t){VO(t,this.fieldsIndex),this._set("renderer",t)}readRenderer(t,e,r){e=e.layerDefinition||e;const i=e.drawingInfo?.renderer;if(i){const s=rv(i,e,r)??void 0;return s||q.getLogger(this).error("Failed to create renderer",{rendererDefinition:e.drawingInfo.renderer,layer:this,context:r}),s}return OL(e,r)}set source(t){const e=this._get("source");e!==t&&(Y6(e)&&this._resetMemorySource(e),Y6(t)&&this._initMemorySource(t),this._set("source",t))}castSource(t){return t?Array.isArray(t)||t instanceof se?new yl({layer:this,items:t}):t:null}readSource(t,e){const r=Tr.fromJSON(e.featureSet);return new yl({layer:this,items:r?.features??[]})}readTemplates(t,e){const r=e.editFieldsInfo,i=r?.creatorField,s=r?.editorField;return t=t?.map((n=>No.fromJSON(n))),this._fixTemplates(t,i),this._fixTemplates(t,s),t}readTitle(t,e){const r=e.layerDefinition?.name??e.name,i=e.title||e.layerDefinition?.title;if(r){const s=this.portalItem?.title;if(this.sublayerTitleMode==="item-title")return this.url?kX(this.url,r):r;let n=r;if(!n&&this.url){const o=vc(this.url);o!=null&&(n=o.title)}return n?(this.sublayerTitleMode==="item-title-and-service-name"&&s&&s!==n&&(n=s+" - "+n),e3(n)):void 0}if(this.sublayerTitleMode==="item-title"&&i)return i}readTitleFromWebMap(t,e){return e.title||e.layerDefinition?.name}readTypeIdField(t,e){let r=(e=e.layerDefinition||e).typeIdField;if(r&&e.fields){r=r.toLowerCase();const i=e.fields.find((s=>s.name.toLowerCase()===r));i&&(r=i.name)}return r}readTypes(t,e){t=(e=e.layerDefinition||e).types;const r=e.editFieldsInfo,i=r?.creatorField,s=r?.editorField;return t?.map((n=>(n=Ro.fromJSON(n),this._fixTemplates(n.templates,i),this._fixTemplates(n.templates,s),n)))}readVisible(t,e){return e.layerDefinition?.defaultVisibility!=null?!!e.layerDefinition.defaultVisibility:e.visibility!=null?!!e.visibility:void 0}async addAttachment(t,e){const r=await WPe(this,t,e,Jr);return this.lastEditsEventDate=new Date,r}async updateAttachment(t,e,r){const i=await ZPe(this,t,e,r,Jr);return this.lastEditsEventDate=new Date,i}async applyEdits(t,e){return JPe(this,t,e)}async uploadAssets(t,e){return YPe(this,t,e)}on(t,e){return super.on(t,e)}createPopupTemplate(t){return jAe(this,t)}async createGraphicsSource(t){if(this._hasMemorySource()&&this.source)return this.source.load({signal:t});const{default:e}=await Fz(J(()=>import("./FeatureLayerSource-VqjKXT1y.js"),__vite__mapDeps([272,55,62,273,274,58,98,57,99,275,276,41,33,277,278,69,67,68,24,29,158,28])),t);return new e({layer:this,supportedSourceTypes:this.supportedSourceTypes}).load({signal:t})}createQuery(){const t=o3e(this);t.dynamicDataSource=this.dynamicDataSource;const e=this.subtypeCode!=null?`${this.subtypeField} = ${this.subtypeCode}`:null,r=H9(this.definitionExpression,e);return t.where=r||"1=1",t}async deleteAttachments(t,e){const r=await XPe(this,t,e,Jr);return this.lastEditsEventDate=new Date,r}async fetchRecomputedExtents(t){return KPe(this,t,Jr)}async getFeatureTitle(t,e){return this._titleCreator.getTitle(this,t,e)}async getFeatureTitles(t,e){return this._titleCreator.getTitles(this,t,e)}getFeatureType(t){return dJ(this.types,this.typeIdField,t)}getFieldDomain(t,e){return l3e(this,t,e,this.getField(t)?.domain??null)}async queryAttachments(t,e){return QPe(this,t,e,Jr)}async queryFeatures(t,e){const r=await this.load(),i=await r.source.queryFeatures(me.from(t)??r.createQuery(),e);if(i?.features)for(const s of i.features)s.layer=s.sourceLayer=r;return i}async queryObjectIds(t,e){return await e3e(this,t,e,Jr)}async queryFeatureCount(t,e){return t3e(this,t,e,Jr)}async queryExtent(t,e){return r3e(this,t,e,Jr)}async queryRelatedFeatures(t,e){return i3e(this,t,e,Jr)}async queryRelatedFeaturesCount(t,e){return s3e(this,t,e,Jr)}async queryTopFeatures(t,e){const{source:r,capabilities:i}=await this.load();if(!r.queryTopFeatures||!i?.query?.supportsTopFeaturesQuery)throw new F(Jr,"Layer source does not support queryTopFeatures capability");const s=await J(()=>import("./TopFeaturesQuery-CWmBvzT8.js"),[]),n=await r.queryTopFeatures(s.default.from(t),e);if(n?.features)for(const o of n.features)o.layer=o.sourceLayer=this;return n}async queryAttributeBins(t,e){const{source:r,capabilities:i}=await this.load();if(!r.queryAttributeBins)throw new F(Jr,"Layer source does not support queryAttributeBins capability");_3e(t,i,Jr);const s=await J(()=>import("./AttributeBinsQuery-HwAtokxK.js"),__vite__mapDeps([209,26,21,35])),n=await r.queryAttributeBins(s.default.from(t),e);if(n.features)for(const o of n.features)o.layer=o.sourceLayer=this;return n}async queryTopObjectIds(t,e){const{source:r,capabilities:i}=await this.load();if(!r.queryTopObjectIds||!i?.query.supportsTopFeaturesQuery)throw new F(Jr,"Layer source does not support queryTopObjectIds capability");const s=await J(()=>import("./TopFeaturesQuery-CWmBvzT8.js"),[]);return(await r.queryTopObjectIds(s.default.from(t),e)).filter(_d)}async queryTopFeaturesExtent(t,e){const{source:r,capabilities:i}=await this.load();if(!r.queryTopExtents||!i?.query?.supportsTopFeaturesQuery)throw new F(Jr,"Layer source does not support queryTopExtents capability");const s=await J(()=>import("./TopFeaturesQuery-CWmBvzT8.js"),[]);return r.queryTopExtents(s.default.from(t),e)}async queryTopFeatureCount(t,e){const{source:r,capabilities:i}=await this.load();if(!r.queryTopCount||!i?.query?.supportsTopFeaturesQuery)throw new F(Jr,"Layer source does not support queryFeatureCount capability");const s=await J(()=>import("./TopFeaturesQuery-CWmBvzT8.js"),[]);return r.queryTopCount(s.default.from(t),e)}read(t,e){const r=t.featureCollection;if((r||t.type==="Feature Collection")&&(this.resourceInfo=t),r){const{layers:i,showLegend:s}=r;i?.length===1&&(super.read(i[0],e),s!=null&&super.read({showLegend:s},e))}super.read(t,e),e&&e.origin==="service"&&(this.revert(["objectIdField","fields","timeInfo","dateFieldsTimeZone"],"service"),this.spatialReference||this.revert(["spatialReference"],"service"))}write(t,e){e={...e,origin:e?.origin??void 0,writeLayerSchema:e?.writeLayerSchema??this._hasMemorySource()};const{origin:r,layerContainerType:i,messages:s}=e;if(this.dynamicDataSource)return s?.push(m1(this,"using a dynamic data source cannot be written to web scenes, web maps and feature service items")),null;if(this.isTable){if((r==="web-map"||r==="web-scene")&&i!=="tables")return s?.push(m1(this,`a table source can only be written to tables, not ${i}`)),null;if(this._hasMemorySource())return s?.push(m1(this,"using an in-memory table source cannot be written to web scenes and web maps")),null}else if(this.loaded&&(r==="web-map"||r==="web-scene")&&i==="tables")return s?.push(m1(this,"using a non-table source cannot be written to tables in web maps or web scenes")),null;return super.write(t,e)}clone(){if(this._hasMemorySource())throw new F(Jr,`FeatureLayer (title: ${this.title}, id: ${this.id}) created using in-memory source cannot be cloned`);return super.clone()}serviceSupportsSpatialReference(t){return!!this.loaded&&(this.source?.type==="memory"||zAe(this,t))}async save(t){return this._debouncedSaveOperations(hf.SAVE,t)}async saveAs(t,e){return this._debouncedSaveOperations(hf.SAVE_AS,e,t)}_readEditingEnabled(t,e,r){let i=t.layerDefinition?.capabilities;return i?this._hasEditingCapability(i):(i=t.capabilities,e&&r?.origin==="web-map"&&!this._hasMemorySource()&&i?this._hasEditingCapability(i):void 0)}_hasEditingCapability(t){return t.toLowerCase().split(",").map((e=>e.trim())).includes("editing")}_writeEditingEnabled(t,e,r,i){if(!t){const s=this.capabilities?.operations?.supportsSync?"Query,Sync":"Query";Cr("layerDefinition.capabilities",s,e),r&&!i?.writeLayerSchema&&(e.capabilities=s)}}_fetchFirstValidLayerId(t){return et(this.url??"",{query:{f:"json",...this.customParameters,token:this.apiKey},responseType:"json",signal:t}).then((e=>{const r=e.data;if(r)return this.applyPreferredHost(r),this.findFirstValidLayerId(r)}))}async initLayerProperties(t){return this._set("source",t),t.sourceJSON&&(this.sourceJSON=t.sourceJSON,this.read(t.sourceJSON,{origin:"service",portalItem:this.portalItem,portal:this.portalItem?.portal,url:this.parsedUrl})),this._verifySource(),this._verifyFields(),VO(this.renderer,this.fieldsIndex),X9(this.timeInfo,this.fieldsIndex),this._hasMemorySource()&&this.geometryType==="mesh"&&(this.capabilities.query.supportsReturnMesh=!0),VAe(this,{origin:"service"})}async hasDataChanged(){return n3e(this)}async fetchPublishingStatus(){const t=this.source;return t?.fetchPublishingStatus?t.fetchPublishingStatus():"unavailable"}_verifyFields(){const t=this.parsedUrl?.path??"undefined";this.objectIdField||console.log("FeatureLayer: 'objectIdField' property is not defined (url: "+t+")"),this.isTable||this._hasMemorySource()||t.search(/\/FeatureServer\//i)!==-1||this.fields?.some((e=>e.type==="geometry"))||console.log("FeatureLayer: unable to find field of type 'geometry' in the layer 'fields' list. If you are using a map service layer, features will not have geometry (url: "+t+")")}_fixTemplates(t,e){t&&t.forEach((r=>{const i=r.prototype?.attributes;i&&e&&delete i[e]}))}_verifySource(){if(this._hasMemorySource()){if(this.url)throw new F("feature-layer:mixed-source-and-url","FeatureLayer cannot be created with both an in-memory source and a url")}else if(!this.url)throw new F("feature-layer:source-or-url-required","FeatureLayer requires either a url, a valid portal item or a source")}_initMemorySource(t){t.forEach((e=>{e.layer=this,e.sourceLayer=this})),this.addHandles([t.on("after-add",(e=>{e.item.layer=this,e.item.sourceLayer=this})),t.on("after-remove",(e=>{e.item.layer=null,e.item.sourceLayer=null}))],"fl-source")}_resetMemorySource(t){t.forEach((e=>{e.layer=null,e.sourceLayer=null})),this.removeHandles("fl-source")}_hasMemorySource(){return!(this.url||!this.source)}findFirstValidLayerId(t){return Array.isArray(t.layers)&&t.layers.length>0?t.layers[0].id:Array.isArray(t.tables)&&t.tables.length>0?t.tables[0].id:void 0}};c([d({clonable:!1,readOnly:!0})],de.prototype,"_titleCreator",null),c([d(GPe)],de.prototype,"attributeTableTemplate",void 0),c([K("service","capabilities")],de.prototype,"readCapabilities",null),c([d({json:{origins:{"web-scene":{write:!1}},write:!0}})],de.prototype,"charts",void 0),c([d({readOnly:!0})],de.prototype,"createQueryVersion",null),c([d({json:{read:{source:"layerDefinition.copyrightText"}}})],de.prototype,"copyright",void 0),c([d({json:{read:{source:"layerDefinition.displayField"}}})],de.prototype,"displayField",void 0),c([d({types:Wu,readOnly:!0})],de.prototype,"defaultSymbol",void 0),c([d({type:Hn})],de.prototype,"dynamicDataSource",void 0),c([d({type:Boolean})],de.prototype,"editingEnabled",null),c([K(["portal-item","web-scene"],"editingEnabled",["layerDefinition.capabilities"])],de.prototype,"readEditingEnabled",null),c([K("web-map","editingEnabled",["capabilities","layerDefinition.capabilities"])],de.prototype,"readEditingEnabledFromWebMap",null),c([re(["portal-item","web-scene"],"editingEnabled",{"layerDefinition.capabilities":{type:String}})],de.prototype,"writeEditingEnabled",null),c([re("web-map","editingEnabled",{capabilities:{type:String},"layerDefinition.capabilities":{type:String}})],de.prototype,"writeEditingEnabledToWebMap",null),c([d({readOnly:!0})],de.prototype,"effectiveEditingEnabled",null),c([d({clonable:!1,readOnly:!0})],de.prototype,"featureTitleFields",null),c([d({...uM.fields,json:{read:{source:"layerDefinition.fields"},origins:{service:{name:"fields"},"web-map":{write:{target:"layerDefinition.fields",overridePolicy:cM}}}}})],de.prototype,"fields",void 0),c([d(uM.fieldsIndex)],de.prototype,"fieldsIndex",void 0),c([d({type:oPe,json:{name:"formInfo",write:!0,origins:{"web-scene":{read:!1,write:!1}}}})],de.prototype,"formTemplate",void 0),c([d({json:{read:{source:"layerDefinition.extent"}}})],de.prototype,"fullExtent",void 0),c([d({json:{origins:{"web-map":{write:{target:"layerDefinition.geometryType",overridePolicy:cM,writer(t,e,r){const i=t?xP.toJSON(t):null;i&&Cr(r,i,e)}}}},read:{source:"layerDefinition.geometryType",reader:xP.read}}})],de.prototype,"geometryType",void 0),c([d({json:{read:{source:"layerDefinition.hasM"}}})],de.prototype,"hasM",void 0),c([d({json:{read:{source:"layerDefinition.hasZ"}}})],de.prototype,"hasZ",void 0),c([d(VPe)],de.prototype,"id",void 0),c([d({readOnly:!0,json:{origins:{service:{read:!0}},read:!1}})],de.prototype,"infoFor3D",void 0),c([d({json:{origins:{"web-map":{write:{target:"layerDefinition.type"}}}}})],de.prototype,"isTable",void 0),c([K("service","isTable",["type","geometryType"]),K("isTable",["layerDefinition.type","layerDefinition.geometryType"])],de.prototype,"readIsTable",null),c([re("web-map","isTable")],de.prototype,"writeIsTable",null),c([d(nx)],de.prototype,"labelsVisible",void 0),c([d({type:[wt],json:{origins:{service:{name:"drawingInfo.labelingInfo",read:W6,write:!1}},name:"layerDefinition.drawingInfo.labelingInfo",read:W6,write:{layerContainerTypes:ft}}})],de.prototype,"labelingInfo",void 0),c([d((()=>{const t=k(zPe);return t.json.origins["portal-item"]={write:{target:"layerDefinition.drawingInfo.transparency",writer(e,r,i){Cr(i,l2(e),r)}}},t})())],de.prototype,"opacity",void 0),c([d(FPe)],de.prototype,"legendEnabled",void 0),c([d({type:["show","hide"],json:(()=>{const t=k(nJ.json);return t.origins["portal-item"]={read:!1,write:!1},t})()})],de.prototype,"listMode",void 0),c([K("globalIdField",["layerDefinition.globalIdField","layerDefinition.fields"])],de.prototype,"readGlobalIdField",null),c([d({json:{origins:{"web-map":{write:{target:"layerDefinition.objectIdField",overridePolicy:cM}}}}})],de.prototype,"objectIdField",void 0),c([K("objectIdField",["layerDefinition.objectIdField","layerDefinition.fields"])],de.prototype,"readObjectIdField",null),c([d({type:["ArcGISFeatureLayer"],json:{write:{target:"layerType",ignoreOrigin:!0,layerContainerTypes:ft}}})],de.prototype,"operationalLayerType",void 0),c([d(uM.outFields)],de.prototype,"outFields",void 0),c([d({readOnly:!0})],de.prototype,"parsedUrl",null),c([d({type:String,json:{origins:{"web-scene":{read:!0,write:!0}},read:!1}})],de.prototype,"path",void 0),c([d(sx)],de.prototype,"popupEnabled",void 0),c([d({type:Gm,json:{name:"popupInfo",write:!0}})],de.prototype,"popupTemplate",void 0),c([d({readOnly:!0})],de.prototype,"defaultPopupTemplate",null),c([d({types:Hv,json:{origins:{service:{write:{target:"drawingInfo.renderer",enabled:!1}},"web-scene":{types:h2e,name:"layerDefinition.drawingInfo.renderer",write:{layerContainerTypes:ft,overridePolicy:(t,e,r)=>({ignoreOrigin:r?.writeLayerSchema,layerContainerTypes:ft})}}},write:{target:"layerDefinition.drawingInfo.renderer",overridePolicy:(t,e,r)=>({ignoreOrigin:r?.writeLayerSchema,layerContainerTypes:ft})}}})],de.prototype,"renderer",null),c([K("service","renderer",["drawingInfo.renderer","defaultSymbol"]),K("renderer",["layerDefinition.drawingInfo.renderer","layerDefinition.defaultSymbol"])],de.prototype,"readRenderer",null),c([d()],de.prototype,"resourceInfo",void 0),c([d((()=>{const t=k(OPe);return t.json.origins["portal-item"]={read:!1,write:!1},t})())],de.prototype,"screenSizePerspectiveEnabled",void 0),c([d({clonable:!1})],de.prototype,"source",null),c([We("source")],de.prototype,"castSource",null),c([K("portal-item","source",["featureSet"]),K("web-map","source",["featureSet"])],de.prototype,"readSource",null),c([d({json:{read:{source:"layerDefinition.extent.spatialReference"}}})],de.prototype,"spatialReference",void 0),c([d({type:Number})],de.prototype,"subtypeCode",void 0),c([d({type:[No]})],de.prototype,"templates",void 0),c([K("templates",["editFieldsInfo","creatorField","editorField","templates"])],de.prototype,"readTemplates",null),c([d({type:Dr})],de.prototype,"timeInfo",void 0),c([d()],de.prototype,"title",void 0),c([K("service","title",["name"]),K("portal-item","title",["layerDefinition.title","layerDefinition.name","title"])],de.prototype,"readTitle",null),c([K("web-map","title",["layerDefinition.name","title"])],de.prototype,"readTitleFromWebMap",null),c([d({type:String})],de.prototype,"sublayerTitleMode",void 0),c([d({json:{read:!1}})],de.prototype,"type",void 0),c([d({type:String})],de.prototype,"typeIdField",void 0),c([K("service","typeIdField"),K("typeIdField",["layerDefinition.typeIdField"])],de.prototype,"readTypeIdField",null),c([d({type:[Ro]})],de.prototype,"types",void 0),c([K("service","types",["types"]),K("types",["layerDefinition.types"])],de.prototype,"readTypes",null),c([d({type:Boolean,json:{origins:{"portal-item":{write:{target:"layerDefinition.defaultVisibility",layerContainerTypes:ft}}}}})],de.prototype,"visible",void 0),c([K("portal-item","visible",["visibility","layerDefinition.defaultVisibility"])],de.prototype,"readVisible",null),de=c([C("esri.layers.FeatureLayer")],de);const E8e=Object.freeze(Object.defineProperty({__proto__:null,get default(){return de}},Symbol.toStringTag,{value:"Module"}));class YAe{constructor(e){this.containerId=e}async init(){const e=new m9({basemap:"streets-navigation-vector"}),r=new x1e({container:this.containerId,map:e,center:[138.6007,-34.9285],zoom:11});r.when(()=>{this.addFeatureLayer(e),this.addWidgets(r)})}addFeatureLayer(e){const r=[{geometry:{type:"point",longitude:138.6007,latitude:-34.9285},attributes:{ObjectID:1,Category:"Adelaide City Centre",ImageUrl:"https://upload.wikimedia.org/wikipedia/commons/c/c3/Adelaide_-_SA_%2825091207887%29.jpg",Description:"Adelaide!"}},{geometry:{type:"point",longitude:138.605,latitude:-34.92},attributes:{ObjectID:2,Category:"Second Marker",ImageUrl:"",Description:"This is a second location with a distinct symbol."}},{geometry:{type:"point",longitude:138.7836,latitude:-34.92896},attributes:{ObjectID:3,Category:"Home",ImageUrl:"",Description:"192 Blockers Road!"}}],i=new de({source:r,objectIdField:"ObjectID",fields:[{name:"ObjectID",type:"oid"},{name:"Category",type:"string"},{name:"ImageUrl",type:"string"},{name:"Description",type:"string"}],renderer:{type:"unique-value",field:"Category",uniqueValueInfos:[{value:"Adelaide City Centre",symbol:{type:"simple-marker",color:"blue",size:12},label:"Adelaide City Centre"},{value:"Second Marker",symbol:{type:"simple-marker",color:"red",size:14,style:"diamond"},label:"Second Marker"},{value:"Home",symbol:{type:"simple-marker",color:"yellow",size:20},label:"Home"}]},popupTemplate:{title:"{Category}",content:`
          <div>
            {Description}<br>
            <img src='{ImageUrl}' width='250'>
          </div>
        `}});e.add(i),this.featureLayer=i}addWidgets(e){e.ui.add(new $1e({view:e,nextBasemap:"satellite"}),"bottom-right"),e.ui.add(new N1e({view:e,unit:"metric"}),"bottom-left"),e.ui.add(new OCe({view:e,layerInfos:[{layer:this.featureLayer,title:"Point Markers"}]}),"top-right")}}const XAe=new YAe("viewDiv");XAe.init();export{x$e as $,dke as A,rke as B,Y as C,q as D,ir as E,tse as F,pT as G,pke as H,Pr as I,qce as J,gc as K,sF as L,jl as M,cy as N,z as O,Wce as P,h0 as Q,kge as R,kFe as S,aG as T,Re as U,NFe as V,He as W,ZG as X,mr as Y,xi as Z,J as _,w4e as a,Hoe as a$,qm as a0,cR as a1,c as a2,d as a3,C as a4,Rse as a5,Ee as a6,U3e as a7,ge as a8,oye as a9,Eke as aA,rm as aB,l8e as aC,rNe as aD,Td as aE,fd as aF,lo as aG,Gi as aH,fSe as aI,ASe as aJ,K7 as aK,MSe as aL,Hme as aM,fye as aN,wI as aO,TH as aP,wSe as aQ,EH as aR,MH as aS,LSe as aT,TSe as aU,dSe as aV,mSe as aW,y2 as aX,Lme as aY,U8 as aZ,Vm as a_,et as aa,xt as ab,w3e as ac,ox as ad,swe as ae,nwe as af,owe as ag,k as ah,Tr as ai,rfe as aj,me as ak,W as al,_c as am,Mne as an,Um as ao,xne as ap,Woe as aq,BU as ar,aae as as,Vje as at,zje as au,Ns as av,se as aw,pfe as ax,dr as ay,ise as az,ii as b,S4e as b$,Ene as b0,Ine as b1,Cne as b2,sye as b3,N0 as b4,PS as b5,rr as b6,ri as b7,Mf as b8,WO as b9,Kge as bA,_Ee as bB,GW as bC,y5 as bD,m5 as bE,f5 as bF,p5 as bG,nb as bH,gm as bI,F0 as bJ,Lt as bK,ao as bL,XP as bM,St as bN,bv as bO,Ia as bP,Si as bQ,T0 as bR,T_ as bS,G3 as bT,y7 as bU,nr as bV,jh as bW,Jse as bX,lC as bY,aRe as bZ,cB as b_,qNe as ba,ane as bb,mNe as bc,mv as bd,NW as be,Md as bf,Ce as bg,Rie as bh,De as bi,ye as bj,ne as bk,hc as bl,Av as bm,On as bn,ude as bo,fr as bp,br as bq,Do as br,Ve as bs,A5 as bt,sS as bu,HDe as bv,lD as bw,aD as bx,Ni as by,cDe as bz,A4e as c,Oi as c$,T4e as c0,Xq as c1,K as c2,Yr as c3,yle as c4,OP as c5,ud as c6,Cz as c7,Le as c8,Bn as c9,ji as cA,fs as cB,At as cC,vn as cD,DM as cE,Ct as cF,dw as cG,N1 as cH,FM as cI,VM as cJ,fB as cK,fe as cL,W0 as cM,Ot as cN,eS as cO,m0e as cP,pr as cQ,y1 as cR,Ge as cS,Rv as cT,_E as cU,Bke as cV,ENe as cW,WNe as cX,zl as cY,kV as cZ,Vo as c_,er as ca,yt as cb,Sv as cc,we as cd,Vr as ce,ue as cf,Dwe as cg,Il as ch,Fwe as ci,jae as cj,DRe as ck,ut as cl,VRe as cm,zRe as cn,jRe as co,URe as cp,GRe as cq,$i as cr,WM as cs,so as ct,KOe as cu,w2 as cv,ie as cw,Ft as cx,Gm as cy,y2e as cz,F as d,tv as d$,Wr as d0,Wg as d1,hM as d2,nLe as d3,zge as d4,K6 as d5,mPe as d6,IAe as d7,kt as d8,nl as d9,kNe as dA,JNe as dB,vee as dC,ije as dD,ize as dE,IT as dF,rze as dG,yv as dH,Ca as dI,BNe as dJ,dne as dK,Io as dL,yke as dM,oz as dN,nz as dO,wee as dP,XS as dQ,KS as dR,_3 as dS,b3 as dT,bee as dU,gn as dV,Cv as dW,O0 as dX,Y3 as dY,mke as dZ,ej as d_,OO as da,ce as db,V5e as dc,ife as dd,km as de,hs as df,_Le as dg,BLe as dh,Pm as di,Zxe as dj,Fe as dk,Bt as dl,ixe as dm,iv as dn,Q as dp,YH as dq,b0 as dr,eW as ds,pze as dt,Zm as du,sje as dv,nje as dw,sxe as dx,EMe as dy,jhe as dz,DL as e,FPe as e$,sde as e0,Mce as e1,tNe as e2,$a as e3,YS as e4,v2 as e5,hce as e6,nG as e7,Dce as e8,sNe as e9,Sc as eA,Kme as eB,Doe as eC,Rme as eD,J7 as eE,lye as eF,_ke as eG,Tw as eH,DS as eI,zS as eJ,Oz as eK,We as eL,a8e as eM,MLe as eN,_X as eO,S6 as eP,XV as eQ,HRe as eR,Uje as eS,jm as eT,ULe as eU,KP as eV,EAe as eW,mAe as eX,bAe as eY,GZ as eZ,VPe as e_,as as ea,iNe as eb,oG as ec,lA as ed,Ske as ee,qV as ef,g3 as eg,pee as eh,on as ei,QS as ej,q7 as ek,X7 as el,kme as em,Z7 as en,Y7 as eo,_d as ep,Fs as eq,cK as er,YLe as es,oX as et,va as eu,ZP as ev,bc as ew,qLe as ex,qae as ey,B7 as ez,bJ as f,Gr as f$,jt as f0,sr as f1,Pt as f2,Li as f3,Vi as f4,NPe as f5,dPe as f6,yPe as f7,hPe as f8,Fl as f9,lne as fA,Gke as fB,Cr as fC,Bl as fD,Vl as fE,qk as fF,ti as fG,E0 as fH,qb as fI,eq as fJ,tq as fK,a4e as fL,_4e as fM,$3 as fN,tLe as fO,nc as fP,Xh as fQ,FLe as fR,kl as fS,NLe as fT,Rwe as fU,Pe as fV,UOe as fW,VOe as fX,R6e as fY,jOe as fZ,Lv as f_,zme as fa,Vme as fb,uye as fc,Ma as fd,Fse as fe,DPe as ff,xe as fg,I0 as fh,Ml as fi,cd as fj,cs as fk,re as fl,AAe as fm,Zs as fn,US as fo,a6e as fp,s6e as fq,BV as fr,hf as fs,zAe as ft,ww as fu,qe as fv,lt as fw,de as fx,Oke as fy,noe as fz,G3e as g,VLe as g$,F6e as g0,Oh as g1,GOe as g2,Jh as g3,rLe as g4,iLe as g5,kRe as g6,ORe as g7,B0 as g8,Ut as g9,bPe as gA,Dz as gB,h8e as gC,Oze as gD,x1 as gE,MT as gF,Bp as gG,e2 as gH,qke as gI,Ed as gJ,Gv as gK,v7 as gL,C1e as gM,sDe as gN,Et as gO,mL as gP,LMe as gQ,UNe as gR,PNe as gS,Nke as gT,Dx as gU,$d as gV,gM as gW,MPe as gX,Ne as gY,Rm as gZ,Lm as g_,u7 as ga,gi as gb,tt as gc,pn as gd,us as ge,Cke as gf,dm as gg,PU as gh,$A as gi,n6e as gj,iye as gk,lm as gl,Fz as gm,H9 as gn,EX as go,PY as gp,$ze as gq,uoe as gr,BRe as gs,PLe as gt,Ls as gu,d3e as gv,aPe as gw,Dje as gx,wPe as gy,Fje as gz,FS as h,h2e as h$,or as h0,dze as h1,Wu as h2,Qme as h3,YRe as h4,Zfe as h5,xke as h6,kfe as h7,BR as h8,KV as h9,bt as hA,gle as hB,JLe as hC,Ai as hD,kX as hE,e3 as hF,NX as hG,FX as hH,hd as hI,GS as hJ,Pv as hK,_Ae as hL,gPe as hM,pAe as hN,EPe as hO,LAe as hP,VO as hQ,X9 as hR,jAe as hS,_3e as hT,GPe as hU,RAe as hV,nx as hW,W6 as hX,wt as hY,bP as hZ,sx as h_,QV as ha,Gt as hb,bke as hc,Aoe as hd,GU as he,Bme as hf,qU as hg,yee as hh,Dne as hi,j as hj,Noe as hk,Fne as hl,g2 as hm,IU as hn,sLe as ho,b1 as hp,pLe as hq,eye as hr,Gme as hs,xF as ht,afe as hu,fw as hv,xNe as hw,SNe as hx,bhe as hy,eU as hz,s4e as i,Fn as i$,Hv as i0,OPe as i1,No as i2,Vae as i3,Dae as i4,Lae as i5,Dk as i6,qi as i7,FU as i8,Ev as i9,g4e as iA,m_e as iB,v4e as iC,g_e as iD,kve as iE,r4e as iF,$g as iG,y4e as iH,L4e as iI,f4e as iJ,QB as iK,l0e as iL,iS as iM,rS as iN,IDe as iO,an as iP,_5 as iQ,tS as iR,g5 as iS,EI as iT,pB as iU,PI as iV,RDe as iW,bm as iX,ADe as iY,ed as iZ,LDe as i_,DY as ia,cO as ib,Ro as ic,df as id,hX as ie,Sa as ig,fn as ih,rv as ii,OL as ij,UPe as ik,jPe as il,zPe as im,aj as io,Tee as ip,cj as iq,E4e as ir,D6e as is,w6e as it,iOe as iu,zw as iv,Kke as iw,jLe as ix,l_e as iy,u_e as iz,QL as j,$r as j$,lb as j0,d5 as j1,U5e as j2,L7 as j3,CA as j4,pI as j5,bd as j6,Vfe as j7,R7 as j8,N5 as j9,ISe as jA,TU as jB,gee as jC,$ee as jD,Dw as jE,Dme as jF,H7 as jG,Qb as jH,Ld as jI,Zme as jJ,jr as jK,kh as jL,bX as jM,oPe as jN,q3e as jO,$Pe as jP,JPe as jQ,dJ as jR,n3e as jS,gz as jT,$z as jU,_q as jV,f8e as jW,_J as jX,l3 as jY,Pa as jZ,pp as j_,c5 as ja,DK as jb,yn as jc,im as jd,GP as je,vX as jf,kke as jg,tr as jh,Nfe as ji,Dfe as jj,A7 as jk,eLe as jl,f0 as jm,II as jn,M7 as jo,K3 as jp,E as jq,Mb as jr,pz as js,Tne as jt,$ne as ju,Fme as jv,pye as jw,mye as jx,Hfe as jy,Z2 as jz,hke as k,JFe as k$,T8e as k0,kPe as k1,jp as k2,yAe as k3,Es as k4,Hn as k5,l6e as k6,Om as k7,ur as k8,mt as k9,Di as kA,AU as kB,n6 as kC,_r as kD,HLe as kE,F9 as kF,KQ as kG,I4e as kH,mLe as kI,yLe as kJ,fLe as kK,iX as kL,xd as kM,JS as kN,tz as kO,So as kP,DLe as kQ,Nk as kR,o6e as kS,Kie as kT,cne as kU,hne as kV,fc as kW,x3e as kX,u5 as kY,XFe as kZ,YFe as k_,Rs as ka,xze as kb,Sze as kc,jH as kd,A$ as ke,Ci as kf,o3e as kg,c3e as kh,Wq as ki,q2 as kj,pS as kk,ft as kl,m3e as km,WPe as kn,ZPe as ko,XPe as kp,KPe as kq,u3e as kr,QPe as ks,e3e as kt,t3e as ku,r3e as kv,i3e as kw,s3e as kx,Dr as ky,TX as kz,y8e as l,fv as l$,ZFe as l0,QFe as l1,KFe as l2,WFe as l3,HFe as l4,jfe as l5,uR as l6,qFe as l7,_Re as l8,x3 as l9,oke as lA,Zse as lB,Q8 as lC,v5e as lD,sz as lE,ste as lF,hte as lG,xv as lH,XRe as lI,dS as lJ,jk as lK,RP as lL,lee as lM,Vke as lN,o3 as lO,fRe as lP,pRe as lQ,Tse as lR,BK as lS,GK as lT,Dke as lU,USe as lV,lLe as lW,kMe as lX,WDe as lY,Be as lZ,RRe as l_,ate as la,FP as lb,gLe as lc,DP as ld,vLe as le,vse as lf,AK as lg,lRe as lh,c8e as li,u8e as lj,mJ as lk,pJ as ll,OX as lm,f6e as ln,yA as lo,CNe as lp,TNe as lq,ume as lr,cme as ls,p4 as lt,W7 as lu,Dpe as lv,IR as lw,Mze as lx,lp as ly,lke as lz,$4e as m,Tl as m$,Lr as m0,Uv as m1,L as m2,Sw as m3,Ea as m4,k4e as m5,Hr as m6,uve as m7,mve as m8,RY as m9,v5 as mA,kDe as mB,E5 as mC,ODe as mD,rt as mE,xVe as mF,ya as mG,Qp as mH,fVe as mI,pVe as mJ,RLe as mK,C2 as mL,Ol as mM,ba as mN,vi as mO,Lg as mP,fDe as mQ,wA as mR,hI as mS,i7 as mT,Dv as mU,z6e as mV,ec as mW,E0e as mX,C0e as mY,P0e as mZ,A1e as m_,TLe as ma,yz as mb,VS as mc,ALe as md,gbe as me,VF as mf,dc as mg,Nce as mh,Fce as mi,rje as mj,vU as mk,rU as ml,Rke as mm,_G as mn,AA as mo,LU as mp,I2 as mq,pOe as mr,dOe as ms,l7 as mt,o7 as mu,mpe as mv,gpe as mw,Lc as mx,iz as my,uLe as mz,RX as n,Q0e as n$,Ll as n0,t0 as n1,l3e as n2,qOe as n3,g3e as n4,o8e as n5,n8e as n6,x0 as n7,rc as n8,k0 as n9,Bhe as nA,yme as nB,jSe as nC,Tf as nD,GSe as nE,zv as nF,Spe as nG,MU as nH,VSe as nI,BSe as nJ,coe as nK,Pke as nL,Wse as nM,Qse as nN,kv as nO,Ov as nP,Nv as nQ,Ooe as nR,Roe as nS,koe as nT,rz as nU,Tz as nV,JP as nW,$Le as nX,tj as nY,oR as nZ,jz as n_,PAe as na,WLe as nb,d8e as nc,Xz as nd,fPe as ne,fS as nf,C4e as ng,O6e as nh,zOe as ni,Qje as nj,JVe as nk,ome as nl,iDe as nm,Jge as nn,L5 as no,UFe as np,o0e as nq,rhe as nr,zoe as ns,Poe as nt,Loe as nu,Wy as nv,zi as nw,cl as nx,Du as ny,Er as nz,uke as o,Qw as o$,C6e as o0,Cd as o1,zo as o2,Ewe as o3,$ke as o4,MNe as o5,$Ne as o6,HP as o7,Zoe as o8,qoe as o9,oA,vl as oB,ym as oC,pPe as oD,vPe as oE,_Pe as oF,TPe as oG,aAe as oH,vAe as oI,j3 as oJ,Ud as oK,CY as oL,b5 as oM,Lu as oN,K0e as oO,EDe as oP,h5 as oQ,a0e as oR,M5 as oS,$5 as oT,no as oU,zfe as oV,wke as oW,DVe as oX,d2 as oY,p2 as oZ,zVe as o_,qme as oa,Boe as ob,$he as oc,Ffe as od,gke as oe,O0e as of,zz as og,sm as oh,Cm as oi,ELe as oj,vT as ok,B9 as ol,mze as om,S5e as on,w5e as oo,zpe as op,EEe as oq,EVe as or,RA as os,HVe as ot,r2e as ou,t2e as ov,XA as ow,Fbe as ox,h6e as oy,LRe as oz,vc as p,B5e as p$,FVe as p0,nU as p1,QVe as p2,Yge as p3,nDe as p4,oDe as p5,KVe as p6,rn as p7,x6e as p8,$6e as p9,uee as pA,gG as pB,Yje as pC,n5e as pD,o5e as pE,a5e as pF,un as pG,Cze as pH,Pze as pI,Vh as pJ,Ju as pK,Ize as pL,N3 as pM,GLe as pN,Eze as pO,Tze as pP,Au as pQ,hLe as pR,$7 as pS,u1e as pT,mn as pU,A2 as pV,x7 as pW,T7 as pX,vfe as pY,G5e as pZ,Efe as p_,S6e as pa,SL as pb,Ufe as pc,qVe as pd,fze as pe,Rd as pf,Y2e as pg,gy as ph,Yn as pi,fke as pj,XVe as pk,YVe as pl,ZVe as pm,WVe as pn,jVe as po,bL as pp,s1 as pq,nZ as pr,UVe as ps,VVe as pt,Fi as pu,rMe as pv,BVe as pw,FMe as px,zze as py,Jje as pz,ILe as q,yoe as q$,Wm as q0,Tt as q1,Rbe as q2,Lbe as q3,Ue as q4,Ou as q5,Nxe as q6,Xbe as q7,Fxe as q8,Bq as q9,$$ as qA,_5e as qB,x$ as qC,aOe as qD,Vw as qE,Fpe as qF,aye as qG,Mpe as qH,ns as qI,pw as qJ,qRe as qK,Vwe as qL,BOe as qM,Y3e as qN,Wwe as qO,B6e as qP,Ul as qQ,Gl as qR,uo as qS,lc as qT,QTe as qU,SDe as qV,dj as qW,Npe as qX,Tpe as qY,Epe as qZ,Lke as q_,Jn as qa,sf as qb,Kn as qc,Moe as qd,oOe as qe,J2 as qf,ei as qg,ls as qh,zr as qi,Bk as qj,Phe as qk,Ohe as ql,ZNe as qm,AMe as qn,zK as qo,zLe as qp,OW as qq,DW as qr,kd as qs,wc as qt,Q3 as qu,K4e as qv,Pq as qw,Cq as qx,xpe as qy,Vpe as qz,Lie as r,Vv as r$,ake as r0,WRe as r1,Y4e as r2,El as r3,ki as r4,cke as r5,kLe as r6,Upe as r7,jo as r8,F5 as r9,FRe as rA,NRe as rB,kee as rC,ef as rD,JG as rE,VK as rF,k2 as rG,cve as rH,Xke as rI,oEe as rJ,J4 as rK,nEe as rL,VMe as rM,c2 as rN,GVe as rO,vS as rP,hB as rQ,Y6e as rR,r0e as rS,t0e as rT,lB as rU,KW as rV,AVe as rW,LVe as rX,uB as rY,uD as rZ,yL as r_,wB as ra,vDe as rb,_De as rc,bDe as rd,wDe as re,aDe as rf,uDe as rg,gse as rh,q0 as ri,lDe as rj,I0e as rk,Oee as rl,wa as rm,Qpe as rn,SA as ro,Xse as rp,Ake as rq,G0 as rr,yV as rs,SN as rt,dpe as ru,ppe as rv,GM as rw,ike as rx,b5e as ry,M1e as rz,M4e as s,dDe as s$,pc as s0,Ir as s1,j2 as s2,OF as s3,tze as s4,jFe as s5,UC as s6,PVe as s7,Sh as s8,ube as s9,UH as sA,G6e as sB,pH as sC,W2 as sD,J6e as sE,$Ve as sF,Z6e as sG,Me as sH,uSe as sI,sSe as sJ,W6e as sK,wS as sL,v0 as sM,bS as sN,yH as sO,mH as sP,IMe as sQ,tSe as sR,eSe as sS,mC as sT,pDe as sU,iSe as sV,qv as sW,e0e as sX,MVe as sY,oSe as sZ,TVe as s_,t8e as sa,eNe as sb,WOe as sc,YOe as sd,ZOe as se,XOe as sf,JOe as sg,QOe as sh,Bi as si,Wue as sj,DOe as sk,BDe as sl,r8e as sm,rR as sn,HOe as so,Gee as sp,Uee as sq,ZRe as sr,uQ as ss,Yz as st,X6e as su,uC as sv,K6e as sw,H6e as sx,ar as sy,aSe as sz,VAe as t,rj as t$,IVe as t0,q6e as t1,xEe as t2,SEe as t3,ZW as t4,f0e as t5,nIe as t6,hDe as t7,k5 as t8,GFe as t9,Xce as tA,FB as tB,V0 as tC,U0 as tD,_m as tE,Yce as tF,bLe as tG,BPe as tH,she as tI,nhe as tJ,fA as tK,d1e as tL,Uke as tM,T5e as tN,eae as tO,a7 as tP,wU as tQ,pV as tR,Qoe as tS,jne as tT,Ape as tU,p6e as tV,d6e as tW,$be as tX,yOe as tY,Uwe as tZ,Bge as t_,BFe as ta,CMe as tb,MMe as tc,mDe as td,yDe as te,xDe as tf,$De as tg,eDe as th,MDe as ti,TDe as tj,Zge as tk,i0e as tl,Xge as tm,RB as tn,om as to,gDe as tp,Dge as tq,CLe as tr,Gfe as ts,w4 as tt,k$e as tu,Zce as tv,QDe as tw,e4e as tx,Ob as ty,cA as tz,m8e as u,GNe as u$,jke as u0,Jy as u1,i6e as u2,rle as u3,aze as u4,oze as u5,l5 as u6,c6e as u7,qDe as u8,UDe as u9,P4e as uA,ko as uB,j5e as uC,x4e as uD,A6e as uE,L6e as uF,k6e as uG,mS as uH,Yoe as uI,lae as uJ,$H as uK,Qke as uL,jje as uM,Xde as uN,R5e as uO,Ybe as uP,HNe as uQ,RNe as uR,FNe as uS,ONe as uT,wLe as uU,t5e as uV,e5e as uW,dLe as uX,see as uY,ANe as uZ,Fke as u_,GDe as ua,jDe as ub,VDe as uc,M0e as ud,bB as ue,rDe as uf,tDe as ug,S0e as uh,U$ as ui,pEe as uj,VFe as uk,lf as ul,VX as um,LY as un,dye as uo,CDe as up,PDe as uq,VNe as ur,jNe as us,Wfe as ut,cae as uu,uae as uv,bU as uw,CH as ux,Yue as uy,mB as uz,to as v,wze as v$,Sm as v0,Due as v1,mme as v2,z7 as v3,LLe as v4,B_ as v5,tO as v6,sOe as v7,qn as v8,M6e as v9,_pe as vA,whe as vB,kze as vC,uRe as vD,M3 as vE,gze as vF,IC as vG,E3 as vH,rOe as vI,vze as vJ,_ze as vK,DNe as vL,tOe as vM,nN as vN,eOe as vO,zke as vP,sN as vQ,Z3 as vR,Rz as vS,OLe as vT,zNe as vU,joe as vV,Foe as vW,bze as vX,yze as vY,Y2 as vZ,iN as v_,Ur as va,FH as vb,hze as vc,sC as vd,k5e as ve,Fw as vf,NNe as vg,Eoe as vh,INe as vi,$xe as vj,U6e as vk,zH as vl,Zp as vm,She as vn,vNe as vo,OH as vp,yW as vq,gW as vr,o2e as vs,aLe as vt,IY as vu,oLe as vv,LNe as vw,NDe as vx,kpe as vy,vke as vz,$$e as w,Joe as w0,Hke as w1,Zke as w2,ZDe as w3,Ad as w4,oje as w5,$Ie as w6,lje as w7,e8e as w8,E8e as w9,o4e as x,uc as y,sse as z};
