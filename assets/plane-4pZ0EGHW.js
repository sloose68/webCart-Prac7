import{eQ as h,bp as p,br as l,bn as T,cU as z,eB as L,eC as v,b4 as D,a$ as P,ez as E}from"./ScaleRangeLayer-CkcnxI7v.js";import{r as H,c as i,a as X}from"./vectorStacks-DnnGOwOV.js";function Y(r){const n=r[0]*r[0]+r[4]*r[4]+r[8]*r[8],u=r[1]*r[1]+r[5]*r[5]+r[9]*r[9],I=r[2]*r[2]+r[6]*r[6]+r[10]*r[10];return Math.sqrt(Math.max(n,u,I))}function Z(r,n){const u=Math.sqrt(n[0]*n[0]+n[4]*n[4]+n[8]*n[8]),I=Math.sqrt(n[1]*n[1]+n[5]*n[5]+n[9]*n[9]),e=Math.sqrt(n[2]*n[2]+n[6]*n[6]+n[10]*n[10]);return h(r,u,I,e),r}function Q(r,n,u){Math.abs(r[0])>Math.abs(r[1])?h(n,0,1,0):h(n,1,0,0),p(u,r,n),p(n,u,r),l(u,u),l(n,n)}function x(r=_){return[r[0],r[1],r[2],r[3]]}function rr(r=_[0],n=_[1],u=_[2],I=_[3]){return d(r,n,u,I,H.get())}function j(r,n){return d(n[0],n[1],n[2],n[3],r)}function nr(r){return r}function d(r,n,u,I,e=x()){return e[0]=r,e[1]=n,e[2]=u,e[3]=I,e}function k(r,n,u){const I=n[0]*n[0]+n[1]*n[1]+n[2]*n[2],e=Math.abs(I-1)>1e-5&&I>1e-12?1/Math.sqrt(I):1;return u[0]=n[0]*e,u[1]=n[1]*e,u[2]=n[2]*e,u[3]=-(u[0]*r[0]+u[1]*r[1]+u[2]*r[2]),u}function w(r,n,u,I=x()){const e=u[0]-n[0],c=u[1]-n[1],o=u[2]-n[2],t=r[0]-n[0],g=r[1]-n[1],O=r[2]-n[2],S=c*O-o*g,F=o*t-e*O,R=e*g-c*t,q=S*S+F*F+R*R,m=Math.abs(q-1)>1e-5&&q>1e-12?1/Math.sqrt(q):1;return I[0]=S*m,I[1]=F*m,I[2]=R*m,I[3]=-(I[0]*r[0]+I[1]*r[1]+I[2]*r[2]),I}function y(r,n,u,I=0,e=Math.floor(u*(1/3)),c=Math.floor(u*(2/3))){if(u<3)return!1;n(M,I);let o=e,t=!1;for(;o<u-1&&!t;)n(f,o),o++,t=!P(M,f);if(!t)return!1;for(o=Math.max(o,c),t=!1;o<u&&!t;)n(s,o),o++,E(U,M,f),l(U,U),E(C,f,s),l(C,C),t=!P(M,s)&&!P(f,s)&&Math.abs(T(U,C))<B;return t?(w(M,f,s,r),!0):(I!==0||e!==1||c!==2)&&y(r,n,u,0,1,2)}function ur(r,n,u=!0){const I=n.length/3;return y(r,((e,c)=>h(e,n[3*c+0],n[3*c+1],n[3*c+2])),u?I-1:I)}const B=.99619469809,M=D(),f=D(),s=D(),U=D(),C=D();function Ir(r,n,u){return n!==r&&j(r,n),r[3]=-T(r,u),r}function er(r,n){return n[0]=-r[0],n[1]=-r[1],n[2]=-r[2],n[3]=-r[3],n}function tr(r,n,u,I){return p(s,n,r),k(u,s,I)}function or(r,n,u,I){return A($(r,n,E(i.get(),u,n),J,I))}function cr(r,n,u){return n!=null&&A($(r,n.origin,n.direction,K,u))}function Nr(r,n,u){return A($(r,n.origin,n.vector,a.NONE,u))}function ar(r,n,u){return A($(r,n.origin,n.vector,a.CLAMP,u))}function ir(r,n){return b(r,n)>=0}function sr(r,n){const u=T(r,n.ray.direction),I=-b(r,n.ray.origin);if(u>-1e-6&&u<1e-6)return I>0;const e=I/u;return u>0?e<n.c1&&(n.c1=e):e>n.c0&&(n.c0=e),n.c0<=n.c1}function fr(r,n,u){const I=v(i.get(),r,-r[3]),e=G(r,E(i.get(),n,I),i.get());return L(u,e,I),u}function Er(r,n,u,I){const e=r,c=i.get(),o=i.get();Q(e,c,o);const t=E(i.get(),u,n),g=X(c,t),O=X(o,t),S=X(e,t);return h(I,g,O,S)}function G(r,n,u){const I=v(i.get(),r,T(r,n));return E(u,n,I),u}function Tr(r,n){return Math.abs(b(r,n))}function b(r,n){return T(r,n)+r[3]}var N;function A(r){return r===N.INTERSECTS_INSIDE_OUT||r===N.INTERSECTS_OUTSIDE_IN}function $(r,n,u,I,e){const c=T(r,u),o=b(r,n);if(c===0)return o>=0?N.INSIDE:N.OUTSIDE;let t=-o/c;return I&a.CLAMP&&(t=z(t,0,1)),!(I&a.INFINITE_MIN)&&t<0||!(I&a.INFINITE_MAX)&&t>1?o>=0?N.INSIDE:N.OUTSIDE:(L(e,n,v(e,u,t)),o>=0?N.INTERSECTS_INSIDE_OUT:N.INTERSECTS_OUTSIDE_IN)}(function(r){r[r.INTERSECTS_INSIDE_OUT=0]="INTERSECTS_INSIDE_OUT",r[r.INTERSECTS_OUTSIDE_IN=1]="INTERSECTS_OUTSIDE_IN",r[r.INSIDE=2]="INSIDE",r[r.OUTSIDE=3]="OUTSIDE"})(N||(N={}));const _=[0,0,1,0];var a;(function(r){r[r.NONE=0]="NONE",r[r.CLAMP=1]="CLAMP",r[r.INFINITE_MIN=4]="INFINITE_MIN",r[r.INFINITE_MAX=8]="INFINITE_MAX"})(a||(a={}));const J=a.INFINITE_MIN|a.INFINITE_MAX,K=a.INFINITE_MAX;export{ur as A,rr as D,sr as G,fr as H,Er as J,er as L,x as M,nr as O,tr as P,Tr as Q,d as U,b as V,Q as a,Z as g,j as h,or as k,k as l,Y as m,w as p,cr as q,y as v,ar as w,Nr as x,Ir as y,ir as z};
