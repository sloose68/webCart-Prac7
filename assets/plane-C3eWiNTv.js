import{eD as h,aM as v,aO as C,aK as T,cr as k,em as p,en as L,am as D,a9 as P,ek as E}from"./index-Ccrt8twN.js";import{r as H,c as i,a as X}from"./vectorStacks-Bt1UemJV.js";function Z(r){const n=r[0]*r[0]+r[4]*r[4]+r[8]*r[8],u=r[1]*r[1]+r[5]*r[5]+r[9]*r[9],I=r[2]*r[2]+r[6]*r[6]+r[10]*r[10];return Math.sqrt(Math.max(n,u,I))}function B(r,n){const u=Math.sqrt(n[0]*n[0]+n[4]*n[4]+n[8]*n[8]),I=Math.sqrt(n[1]*n[1]+n[5]*n[5]+n[9]*n[9]),e=Math.sqrt(n[2]*n[2]+n[6]*n[6]+n[10]*n[10]);return h(r,u,I,e),r}function K(r,n,u){Math.abs(r[0])>Math.abs(r[1])?h(n,0,1,0):h(n,1,0,0),v(u,r,n),v(n,u,r),C(u,u),C(n,n)}function x(r=_){return[r[0],r[1],r[2],r[3]]}function rr(r=_[0],n=_[1],u=_[2],I=_[3]){return d(r,n,u,I,H.get())}function j(r,n){return d(n[0],n[1],n[2],n[3],r)}function nr(r){return r}function d(r,n,u,I,e=x()){return e[0]=r,e[1]=n,e[2]=u,e[3]=I,e}function w(r,n,u){const I=n[0]*n[0]+n[1]*n[1]+n[2]*n[2],e=Math.abs(I-1)>1e-5&&I>1e-12?1/Math.sqrt(I):1;return u[0]=n[0]*e,u[1]=n[1]*e,u[2]=n[2]*e,u[3]=-(u[0]*r[0]+u[1]*r[1]+u[2]*r[2]),u}function z(r,n,u,I=x()){const e=u[0]-n[0],c=u[1]-n[1],o=u[2]-n[2],t=r[0]-n[0],O=r[1]-n[1],g=r[2]-n[2],M=c*g-o*O,m=o*t-e*g,R=e*O-c*t,q=M*M+m*m+R*R,b=Math.abs(q-1)>1e-5&&q>1e-12?1/Math.sqrt(q):1;return I[0]=M*b,I[1]=m*b,I[2]=R*b,I[3]=-(I[0]*r[0]+I[1]*r[1]+I[2]*r[2]),I}function y(r,n,u,I=0,e=Math.floor(u*(1/3)),c=Math.floor(u*(2/3))){if(u<3)return!1;n(S,I);let o=e,t=!1;for(;o<u-1&&!t;)n(f,o),o++,t=!P(S,f);if(!t)return!1;for(o=Math.max(o,c),t=!1;o<u&&!t;)n(s,o),o++,E(U,S,f),C(U,U),E(l,f,s),C(l,l),t=!P(S,s)&&!P(f,s)&&Math.abs(T(U,l))<G;return t?(z(S,f,s,r),!0):(I!==0||e!==1||c!==2)&&y(r,n,u,0,1,2)}function ur(r,n,u=!0){const I=n.length/3;return y(r,((e,c)=>h(e,n[3*c+0],n[3*c+1],n[3*c+2])),u?I-1:I)}const G=.99619469809,S=D(),f=D(),s=D(),U=D(),l=D();function Ir(r,n,u){return n!==r&&j(r,n),r[3]=-T(r,u),r}function er(r,n){return n[0]=-r[0],n[1]=-r[1],n[2]=-r[2],n[3]=-r[3],n}function tr(r,n,u,I){return v(s,n,r),w(u,s,I)}function or(r,n,u,I){return F($(r,n,E(i.get(),u,n),Q,I))}function cr(r,n,u){return n!=null&&F($(r,n.origin,n.direction,V,u))}function ar(r,n,u){return F($(r,n.origin,n.vector,N.NONE,u))}function Nr(r,n,u){return F($(r,n.origin,n.vector,N.CLAMP,u))}function ir(r,n){return A(r,n)>=0}function sr(r,n){const u=T(r,n.ray.direction),I=-A(r,n.ray.origin);if(u>-1e-6&&u<1e-6)return I>0;const e=I/u;return u>0?e<n.c1&&(n.c1=e):e>n.c0&&(n.c0=e),n.c0<=n.c1}function fr(r,n,u){const I=L(i.get(),r,-r[3]),e=J(r,E(i.get(),n,I),i.get());return p(u,e,I),u}function Er(r,n,u,I){const e=r,c=i.get(),o=i.get();K(e,c,o);const t=E(i.get(),u,n),O=X(c,t),g=X(o,t),M=X(e,t);return h(I,O,g,M)}function J(r,n,u){const I=L(i.get(),r,T(r,n));return E(u,n,I),u}function Tr(r,n){return Math.abs(A(r,n))}function A(r,n){return T(r,n)+r[3]}var a;function F(r){return r===a.INTERSECTS_INSIDE_OUT||r===a.INTERSECTS_OUTSIDE_IN}function $(r,n,u,I,e){const c=T(r,u),o=A(r,n);if(c===0)return o>=0?a.INSIDE:a.OUTSIDE;let t=-o/c;return I&N.CLAMP&&(t=k(t,0,1)),!(I&N.INFINITE_MIN)&&t<0||!(I&N.INFINITE_MAX)&&t>1?o>=0?a.INSIDE:a.OUTSIDE:(p(e,n,L(e,u,t)),o>=0?a.INTERSECTS_INSIDE_OUT:a.INTERSECTS_OUTSIDE_IN)}(function(r){r[r.INTERSECTS_INSIDE_OUT=0]="INTERSECTS_INSIDE_OUT",r[r.INTERSECTS_OUTSIDE_IN=1]="INTERSECTS_OUTSIDE_IN",r[r.INSIDE=2]="INSIDE",r[r.OUTSIDE=3]="OUTSIDE"})(a||(a={}));const _=[0,0,1,0];var N;(function(r){r[r.NONE=0]="NONE",r[r.CLAMP=1]="CLAMP",r[r.INFINITE_MIN=4]="INFINITE_MIN",r[r.INFINITE_MAX=8]="INFINITE_MAX"})(N||(N={}));const Q=N.INFINITE_MIN|N.INFINITE_MAX,V=N.INFINITE_MAX;export{ur as A,rr as D,sr as G,fr as H,Er as J,er as L,x as M,nr as O,tr as P,Tr as Q,d as U,A as V,K as a,B as g,j as h,or as k,w as l,Z as m,z as p,cr as q,y as v,Nr as w,ar as x,Ir as y,ir as z};
